var z6=Object.defineProperty,H6=Object.defineProperties;var G6=Object.getOwnPropertyDescriptors;var ug=Object.getOwnPropertySymbols;var f2=Object.prototype.hasOwnProperty,d2=Object.prototype.propertyIsEnumerable;var h2=(a,t,n)=>t in a?z6(a,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[t]=n,wf=(a,t)=>{for(var n in t||(t={}))f2.call(t,n)&&h2(a,n,t[n]);if(ug)for(var n of ug(t))d2.call(t,n)&&h2(a,n,t[n]);return a},Ef=(a,t)=>H6(a,G6(t));var hg=(a,t)=>{var n={};for(var i in a)f2.call(a,i)&&t.indexOf(i)<0&&(n[i]=a[i]);if(a!=null&&ug)for(var i of ug(a))t.indexOf(i)<0&&d2.call(a,i)&&(n[i]=a[i]);return n};const V6=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))i(o);new MutationObserver(o=>{for(const s of o)if(s.type==="childList")for(const c of s.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&i(c)}).observe(document,{childList:!0,subtree:!0});function n(o){const s={};return o.integrity&&(s.integrity=o.integrity),o.referrerpolicy&&(s.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?s.credentials="include":o.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(o){if(o.ep)return;o.ep=!0;const s=n(o);fetch(o.href,s)}};V6();function r_(a,t){const n=Object.create(null),i=a.split(",");for(let o=0;o<i.length;o++)n[i[o]]=!0;return t?o=>!!n[o.toLowerCase()]:o=>!!n[o]}const W6="itemscope,allowfullscreen,formnovalidate,ismap,nomodule,novalidate,readonly",j6=r_(W6);function hT(a){return!!a||a===""}function Pm(a){if(bi(a)){const t={};for(let n=0;n<a.length;n++){const i=a[n],o=Zr(i)?q6(i):Pm(i);if(o)for(const s in o)t[s]=o[s]}return t}else{if(Zr(a))return a;if(Jr(a))return a}}const X6=/;(?![^(]*\))/g,$6=/:(.+)/;function q6(a){const t={};return a.split(X6).forEach(n=>{if(n){const i=n.split($6);i.length>1&&(t[i[0].trim()]=i[1].trim())}}),t}function Ol(a){let t="";if(Zr(a))t=a;else if(bi(a))for(let n=0;n<a.length;n++){const i=Ol(a[n]);i&&(t+=i+" ")}else if(Jr(a))for(const n in a)a[n]&&(t+=n+" ");return t.trim()}function la(a){if(!a)return null;let{class:t,style:n}=a;return t&&!Zr(t)&&(a.class=Ol(t)),n&&(a.style=Pm(n)),a}function Y6(a,t){if(a.length!==t.length)return!1;let n=!0;for(let i=0;n&&i<a.length;i++)n=Yv(a[i],t[i]);return n}function Yv(a,t){if(a===t)return!0;let n=p2(a),i=p2(t);if(n||i)return n&&i?a.getTime()===t.getTime():!1;if(n=bi(a),i=bi(t),n||i)return n&&i?Y6(a,t):!1;if(n=Jr(a),i=Jr(t),n||i){if(!n||!i)return!1;const o=Object.keys(a).length,s=Object.keys(t).length;if(o!==s)return!1;for(const c in a){const u=a.hasOwnProperty(c),h=t.hasOwnProperty(c);if(u&&!h||!u&&h||!Yv(a[c],t[c]))return!1}}return String(a)===String(t)}function Q6(a,t){return a.findIndex(n=>Yv(n,t))}const Dl=a=>Zr(a)?a:a==null?"":bi(a)||Jr(a)&&(a.toString===pT||!Pi(a.toString))?JSON.stringify(a,fT,2):String(a),fT=(a,t)=>t&&t.__v_isRef?fT(a,t.value):ed(t)?{[`Map(${t.size})`]:[...t.entries()].reduce((n,[i,o])=>(n[`${i} =>`]=o,n),{})}:Kv(t)?{[`Set(${t.size})`]:[...t.values()]}:Jr(t)&&!bi(t)&&!mT(t)?String(t):t,pr={},Jf=[],da=()=>{},K6=()=>!1,Z6=/^on[^a-z]/,Qv=a=>Z6.test(a),s_=a=>a.startsWith("onUpdate:"),Js=Object.assign,o_=(a,t)=>{const n=a.indexOf(t);n>-1&&a.splice(n,1)},J6=Object.prototype.hasOwnProperty,ji=(a,t)=>J6.call(a,t),bi=Array.isArray,ed=a=>Zv(a)==="[object Map]",Kv=a=>Zv(a)==="[object Set]",p2=a=>a instanceof Date,Pi=a=>typeof a=="function",Zr=a=>typeof a=="string",a_=a=>typeof a=="symbol",Jr=a=>a!==null&&typeof a=="object",dT=a=>Jr(a)&&Pi(a.then)&&Pi(a.catch),pT=Object.prototype.toString,Zv=a=>pT.call(a),eF=a=>Zv(a).slice(8,-1),mT=a=>Zv(a)==="[object Object]",l_=a=>Zr(a)&&a!=="NaN"&&a[0]!=="-"&&""+parseInt(a,10)===a,uv=r_(",key,ref,ref_for,ref_key,onVnodeBeforeMount,onVnodeMounted,onVnodeBeforeUpdate,onVnodeUpdated,onVnodeBeforeUnmount,onVnodeUnmounted"),Jv=a=>{const t=Object.create(null);return n=>t[n]||(t[n]=a(n))},tF=/-(\w)/g,qa=Jv(a=>a.replace(tF,(t,n)=>n?n.toUpperCase():"")),nF=/\B([A-Z])/g,Od=Jv(a=>a.replace(nF,"-$1").toLowerCase()),ey=Jv(a=>a.charAt(0).toUpperCase()+a.slice(1)),Lx=Jv(a=>a?`on${ey(a)}`:""),am=(a,t)=>!Object.is(a,t),hv=(a,t)=>{for(let n=0;n<a.length;n++)a[n](t)},Sv=(a,t,n)=>{Object.defineProperty(a,t,{configurable:!0,enumerable:!1,value:n})},gT=a=>{const t=parseFloat(a);return isNaN(t)?a:t};let m2;const iF=()=>m2||(m2=typeof globalThis!="undefined"?globalThis:typeof self!="undefined"?self:typeof window!="undefined"?window:typeof global!="undefined"?global:{});let bo;class rF{constructor(t=!1){this.active=!0,this.effects=[],this.cleanups=[],!t&&bo&&(this.parent=bo,this.index=(bo.scopes||(bo.scopes=[])).push(this)-1)}run(t){if(this.active){const n=bo;try{return bo=this,t()}finally{bo=n}}}on(){bo=this}off(){bo=this.parent}stop(t){if(this.active){let n,i;for(n=0,i=this.effects.length;n<i;n++)this.effects[n].stop();for(n=0,i=this.cleanups.length;n<i;n++)this.cleanups[n]();if(this.scopes)for(n=0,i=this.scopes.length;n<i;n++)this.scopes[n].stop(!0);if(this.parent&&!t){const o=this.parent.scopes.pop();o&&o!==this&&(this.parent.scopes[this.index]=o,o.index=this.index)}this.active=!1}}}function sF(a,t=bo){t&&t.active&&t.effects.push(a)}function oF(){return bo}function aF(a){bo&&bo.cleanups.push(a)}const c_=a=>{const t=new Set(a);return t.w=0,t.n=0,t},vT=a=>(a.w&Nc)>0,yT=a=>(a.n&Nc)>0,lF=({deps:a})=>{if(a.length)for(let t=0;t<a.length;t++)a[t].w|=Nc},cF=a=>{const{deps:t}=a;if(t.length){let n=0;for(let i=0;i<t.length;i++){const o=t[i];vT(o)&&!yT(o)?o.delete(a):t[n++]=o,o.w&=~Nc,o.n&=~Nc}t.length=n}},GA=new WeakMap;let jp=0,Nc=1;const VA=30;let ha;const eh=Symbol(""),WA=Symbol("");class u_{constructor(t,n=null,i){this.fn=t,this.scheduler=n,this.active=!0,this.deps=[],this.parent=void 0,sF(this,i)}run(){if(!this.active)return this.fn();let t=ha,n=Ic;for(;t;){if(t===this)return;t=t.parent}try{return this.parent=ha,ha=this,Ic=!0,Nc=1<<++jp,jp<=VA?lF(this):g2(this),this.fn()}finally{jp<=VA&&cF(this),Nc=1<<--jp,ha=this.parent,Ic=n,this.parent=void 0,this.deferStop&&this.stop()}}stop(){ha===this?this.deferStop=!0:this.active&&(g2(this),this.onStop&&this.onStop(),this.active=!1)}}function g2(a){const{deps:t}=a;if(t.length){for(let n=0;n<t.length;n++)t[n].delete(a);t.length=0}}let Ic=!0;const xT=[];function Dd(){xT.push(Ic),Ic=!1}function Bd(){const a=xT.pop();Ic=a===void 0?!0:a}function Lo(a,t,n){if(Ic&&ha){let i=GA.get(a);i||GA.set(a,i=new Map);let o=i.get(n);o||i.set(n,o=c_()),AT(o)}}function AT(a,t){let n=!1;jp<=VA?yT(a)||(a.n|=Nc,n=!vT(a)):n=!a.has(ha),n&&(a.add(ha),ha.deps.push(a))}function kl(a,t,n,i,o,s){const c=GA.get(a);if(!c)return;let u=[];if(t==="clear")u=[...c.values()];else if(n==="length"&&bi(a))c.forEach((h,f)=>{(f==="length"||f>=i)&&u.push(h)});else switch(n!==void 0&&u.push(c.get(n)),t){case"add":bi(a)?l_(n)&&u.push(c.get("length")):(u.push(c.get(eh)),ed(a)&&u.push(c.get(WA)));break;case"delete":bi(a)||(u.push(c.get(eh)),ed(a)&&u.push(c.get(WA)));break;case"set":ed(a)&&u.push(c.get(eh));break}if(u.length===1)u[0]&&jA(u[0]);else{const h=[];for(const f of u)f&&h.push(...f);jA(c_(h))}}function jA(a,t){for(const n of bi(a)?a:[...a])(n!==ha||n.allowRecurse)&&(n.scheduler?n.scheduler():n.run())}const uF=r_("__proto__,__v_isRef,__isVue"),bT=new Set(Object.getOwnPropertyNames(Symbol).map(a=>Symbol[a]).filter(a_)),hF=h_(),fF=h_(!1,!0),dF=h_(!0),v2=pF();function pF(){const a={};return["includes","indexOf","lastIndexOf"].forEach(t=>{a[t]=function(...n){const i=sr(this);for(let s=0,c=this.length;s<c;s++)Lo(i,"get",s+"");const o=i[t](...n);return o===-1||o===!1?i[t](...n.map(sr)):o}}),["push","pop","shift","unshift","splice"].forEach(t=>{a[t]=function(...n){Dd();const i=sr(this)[t].apply(this,n);return Bd(),i}}),a}function h_(a=!1,t=!1){return function(i,o,s){if(o==="__v_isReactive")return!a;if(o==="__v_isReadonly")return a;if(o==="__v_isShallow")return t;if(o==="__v_raw"&&s===(a?t?LF:ST:t?MT:ET).get(i))return i;const c=bi(i);if(!a&&c&&ji(v2,o))return Reflect.get(v2,o,s);const u=Reflect.get(i,o,s);return(a_(o)?bT.has(o):uF(o))||(a||Lo(i,"get",o),t)?u:ds(u)?!c||!l_(o)?u.value:u:Jr(u)?a?TT(u):p_(u):u}}const mF=_T(),gF=_T(!0);function _T(a=!1){return function(n,i,o,s){let c=n[i];if(lm(c)&&ds(c)&&!ds(o))return!1;if(!a&&!lm(o)&&(CT(o)||(o=sr(o),c=sr(c)),!bi(n)&&ds(c)&&!ds(o)))return c.value=o,!0;const u=bi(n)&&l_(i)?Number(i)<n.length:ji(n,i),h=Reflect.set(n,i,o,s);return n===sr(s)&&(u?am(o,c)&&kl(n,"set",i,o):kl(n,"add",i,o)),h}}function vF(a,t){const n=ji(a,t);a[t];const i=Reflect.deleteProperty(a,t);return i&&n&&kl(a,"delete",t,void 0),i}function yF(a,t){const n=Reflect.has(a,t);return(!a_(t)||!bT.has(t))&&Lo(a,"has",t),n}function xF(a){return Lo(a,"iterate",bi(a)?"length":eh),Reflect.ownKeys(a)}const wT={get:hF,set:mF,deleteProperty:vF,has:yF,ownKeys:xF},AF={get:dF,set(a,t){return!0},deleteProperty(a,t){return!0}},bF=Js({},wT,{get:fF,set:gF}),f_=a=>a,ty=a=>Reflect.getPrototypeOf(a);function fg(a,t,n=!1,i=!1){a=a.__v_raw;const o=sr(a),s=sr(t);t!==s&&!n&&Lo(o,"get",t),!n&&Lo(o,"get",s);const{has:c}=ty(o),u=i?f_:n?g_:cm;if(c.call(o,t))return u(a.get(t));if(c.call(o,s))return u(a.get(s));a!==o&&a.get(t)}function dg(a,t=!1){const n=this.__v_raw,i=sr(n),o=sr(a);return a!==o&&!t&&Lo(i,"has",a),!t&&Lo(i,"has",o),a===o?n.has(a):n.has(a)||n.has(o)}function pg(a,t=!1){return a=a.__v_raw,!t&&Lo(sr(a),"iterate",eh),Reflect.get(a,"size",a)}function y2(a){a=sr(a);const t=sr(this);return ty(t).has.call(t,a)||(t.add(a),kl(t,"add",a,a)),this}function x2(a,t){t=sr(t);const n=sr(this),{has:i,get:o}=ty(n);let s=i.call(n,a);s||(a=sr(a),s=i.call(n,a));const c=o.call(n,a);return n.set(a,t),s?am(t,c)&&kl(n,"set",a,t):kl(n,"add",a,t),this}function A2(a){const t=sr(this),{has:n,get:i}=ty(t);let o=n.call(t,a);o||(a=sr(a),o=n.call(t,a)),i&&i.call(t,a);const s=t.delete(a);return o&&kl(t,"delete",a,void 0),s}function b2(){const a=sr(this),t=a.size!==0,n=a.clear();return t&&kl(a,"clear",void 0,void 0),n}function mg(a,t){return function(i,o){const s=this,c=s.__v_raw,u=sr(c),h=t?f_:a?g_:cm;return!a&&Lo(u,"iterate",eh),c.forEach((f,p)=>i.call(o,h(f),h(p),s))}}function gg(a,t,n){return function(...i){const o=this.__v_raw,s=sr(o),c=ed(s),u=a==="entries"||a===Symbol.iterator&&c,h=a==="keys"&&c,f=o[a](...i),p=n?f_:t?g_:cm;return!t&&Lo(s,"iterate",h?WA:eh),{next(){const{value:m,done:y}=f.next();return y?{value:m,done:y}:{value:u?[p(m[0]),p(m[1])]:p(m),done:y}},[Symbol.iterator](){return this}}}}function hc(a){return function(...t){return a==="delete"?!1:this}}function _F(){const a={get(s){return fg(this,s)},get size(){return pg(this)},has:dg,add:y2,set:x2,delete:A2,clear:b2,forEach:mg(!1,!1)},t={get(s){return fg(this,s,!1,!0)},get size(){return pg(this)},has:dg,add:y2,set:x2,delete:A2,clear:b2,forEach:mg(!1,!0)},n={get(s){return fg(this,s,!0)},get size(){return pg(this,!0)},has(s){return dg.call(this,s,!0)},add:hc("add"),set:hc("set"),delete:hc("delete"),clear:hc("clear"),forEach:mg(!0,!1)},i={get(s){return fg(this,s,!0,!0)},get size(){return pg(this,!0)},has(s){return dg.call(this,s,!0)},add:hc("add"),set:hc("set"),delete:hc("delete"),clear:hc("clear"),forEach:mg(!0,!0)};return["keys","values","entries",Symbol.iterator].forEach(s=>{a[s]=gg(s,!1,!1),n[s]=gg(s,!0,!1),t[s]=gg(s,!1,!0),i[s]=gg(s,!0,!0)}),[a,n,t,i]}const[wF,EF,MF,SF]=_F();function d_(a,t){const n=t?a?SF:MF:a?EF:wF;return(i,o,s)=>o==="__v_isReactive"?!a:o==="__v_isReadonly"?a:o==="__v_raw"?i:Reflect.get(ji(n,o)&&o in i?n:i,o,s)}const TF={get:d_(!1,!1)},CF={get:d_(!1,!0)},RF={get:d_(!0,!1)},ET=new WeakMap,MT=new WeakMap,ST=new WeakMap,LF=new WeakMap;function PF(a){switch(a){case"Object":case"Array":return 1;case"Map":case"Set":case"WeakMap":case"WeakSet":return 2;default:return 0}}function IF(a){return a.__v_skip||!Object.isExtensible(a)?0:PF(eF(a))}function p_(a){return lm(a)?a:m_(a,!1,wT,TF,ET)}function OF(a){return m_(a,!1,bF,CF,MT)}function TT(a){return m_(a,!0,AF,RF,ST)}function m_(a,t,n,i,o){if(!Jr(a)||a.__v_raw&&!(t&&a.__v_isReactive))return a;const s=o.get(a);if(s)return s;const c=IF(a);if(c===0)return a;const u=new Proxy(a,c===2?i:n);return o.set(a,u),u}function td(a){return lm(a)?td(a.__v_raw):!!(a&&a.__v_isReactive)}function lm(a){return!!(a&&a.__v_isReadonly)}function CT(a){return!!(a&&a.__v_isShallow)}function RT(a){return td(a)||lm(a)}function sr(a){const t=a&&a.__v_raw;return t?sr(t):a}function LT(a){return Sv(a,"__v_skip",!0),a}const cm=a=>Jr(a)?p_(a):a,g_=a=>Jr(a)?TT(a):a;function PT(a){Ic&&ha&&(a=sr(a),AT(a.dep||(a.dep=c_())))}function IT(a,t){a=sr(a),a.dep&&jA(a.dep)}function ds(a){return!!(a&&a.__v_isRef===!0)}function ws(a){return OT(a,!1)}function XA(a){return OT(a,!0)}function OT(a,t){return ds(a)?a:new DF(a,t)}class DF{constructor(t,n){this.__v_isShallow=n,this.dep=void 0,this.__v_isRef=!0,this._rawValue=n?t:sr(t),this._value=n?t:cm(t)}get value(){return PT(this),this._value}set value(t){t=this.__v_isShallow?t:sr(t),am(t,this._rawValue)&&(this._rawValue=t,this._value=this.__v_isShallow?t:cm(t),IT(this))}}function So(a){return ds(a)?a.value:a}const BF={get:(a,t,n)=>So(Reflect.get(a,t,n)),set:(a,t,n,i)=>{const o=a[t];return ds(o)&&!ds(n)?(o.value=n,!0):Reflect.set(a,t,n,i)}};function DT(a){return td(a)?a:new Proxy(a,BF)}function Im(a){const t=bi(a)?new Array(a.length):{};for(const n in a)t[n]=NF(a,n);return t}class FF{constructor(t,n,i){this._object=t,this._key=n,this._defaultValue=i,this.__v_isRef=!0}get value(){const t=this._object[this._key];return t===void 0?this._defaultValue:t}set value(t){this._object[this._key]=t}}function NF(a,t,n){const i=a[t];return ds(i)?i:new FF(a,t,n)}class UF{constructor(t,n,i,o){this._setter=n,this.dep=void 0,this.__v_isRef=!0,this._dirty=!0,this.effect=new u_(t,()=>{this._dirty||(this._dirty=!0,IT(this))}),this.effect.computed=this,this.effect.active=this._cacheable=!o,this.__v_isReadonly=i}get value(){const t=sr(this);return PT(t),(t._dirty||!t._cacheable)&&(t._dirty=!1,t._value=t.effect.run()),t._value}set value(t){this._setter(t)}}function kF(a,t,n=!1){let i,o;const s=Pi(a);return s?(i=a,o=da):(i=a.get,o=a.set),new UF(i,o,s||!o,n)}function Oc(a,t,n,i){let o;try{o=i?a(...i):a()}catch(s){ny(s,t,n)}return o}function pa(a,t,n,i){if(Pi(a)){const s=Oc(a,t,n,i);return s&&dT(s)&&s.catch(c=>{ny(c,t,n)}),s}const o=[];for(let s=0;s<a.length;s++)o.push(pa(a[s],t,n,i));return o}function ny(a,t,n,i=!0){const o=t?t.vnode:null;if(t){let s=t.parent;const c=t.proxy,u=n;for(;s;){const f=s.ec;if(f){for(let p=0;p<f.length;p++)if(f[p](a,c,u)===!1)return}s=s.parent}const h=t.appContext.config.errorHandler;if(h){Oc(h,null,10,[a,c,u]);return}}zF(a,n,o,i)}function zF(a,t,n,i=!0){console.error(a)}let Tv=!1,$A=!1;const Eo=[];let Pl=0;const Kp=[];let Xp=null,Wf=0;const Zp=[];let _c=null,jf=0;const BT=Promise.resolve();let v_=null,qA=null;function FT(a){const t=v_||BT;return a?t.then(this?a.bind(this):a):t}function HF(a){let t=Pl+1,n=Eo.length;for(;t<n;){const i=t+n>>>1;um(Eo[i])<a?t=i+1:n=i}return t}function NT(a){(!Eo.length||!Eo.includes(a,Tv&&a.allowRecurse?Pl+1:Pl))&&a!==qA&&(a.id==null?Eo.push(a):Eo.splice(HF(a.id),0,a),UT())}function UT(){!Tv&&!$A&&($A=!0,v_=BT.then(HT))}function GF(a){const t=Eo.indexOf(a);t>Pl&&Eo.splice(t,1)}function kT(a,t,n,i){bi(a)?n.push(...a):(!t||!t.includes(a,a.allowRecurse?i+1:i))&&n.push(a),UT()}function VF(a){kT(a,Xp,Kp,Wf)}function WF(a){kT(a,_c,Zp,jf)}function y_(a,t=null){if(Kp.length){for(qA=t,Xp=[...new Set(Kp)],Kp.length=0,Wf=0;Wf<Xp.length;Wf++)Xp[Wf]();Xp=null,Wf=0,qA=null,y_(a,t)}}function zT(a){if(Zp.length){const t=[...new Set(Zp)];if(Zp.length=0,_c){_c.push(...t);return}for(_c=t,_c.sort((n,i)=>um(n)-um(i)),jf=0;jf<_c.length;jf++)_c[jf]();_c=null,jf=0}}const um=a=>a.id==null?1/0:a.id;function HT(a){$A=!1,Tv=!0,y_(a),Eo.sort((n,i)=>um(n)-um(i));const t=da;try{for(Pl=0;Pl<Eo.length;Pl++){const n=Eo[Pl];n&&n.active!==!1&&Oc(n,null,14)}}finally{Pl=0,Eo.length=0,zT(),Tv=!1,v_=null,(Eo.length||Kp.length||Zp.length)&&HT(a)}}function jF(a,t,...n){if(a.isUnmounted)return;const i=a.vnode.props||pr;let o=n;const s=t.startsWith("update:"),c=s&&t.slice(7);if(c&&c in i){const p=`${c==="modelValue"?"model":c}Modifiers`,{number:m,trim:y}=i[p]||pr;y?o=n.map(g=>g.trim()):m&&(o=n.map(gT))}let u,h=i[u=Lx(t)]||i[u=Lx(qa(t))];!h&&s&&(h=i[u=Lx(Od(t))]),h&&pa(h,a,6,o);const f=i[u+"Once"];if(f){if(!a.emitted)a.emitted={};else if(a.emitted[u])return;a.emitted[u]=!0,pa(f,a,6,o)}}function GT(a,t,n=!1){const i=t.emitsCache,o=i.get(a);if(o!==void 0)return o;const s=a.emits;let c={},u=!1;if(!Pi(a)){const h=f=>{const p=GT(f,t,!0);p&&(u=!0,Js(c,p))};!n&&t.mixins.length&&t.mixins.forEach(h),a.extends&&h(a.extends),a.mixins&&a.mixins.forEach(h)}return!s&&!u?(i.set(a,null),null):(bi(s)?s.forEach(h=>c[h]=null):Js(c,s),i.set(a,c),c)}function iy(a,t){return!a||!Qv(t)?!1:(t=t.slice(2).replace(/Once$/,""),ji(a,t[0].toLowerCase()+t.slice(1))||ji(a,Od(t))||ji(a,t))}let Ks=null,ry=null;function Cv(a){const t=Ks;return Ks=a,ry=a&&a.type.__scopeId||null,t}function XF(a){ry=a}function $F(){ry=null}function Jp(a,t=Ks,n){if(!t||a._n)return a;const i=(...o)=>{i._d&&O2(-1);const s=Cv(t),c=a(...o);return Cv(s),i._d&&O2(1),c};return i._n=!0,i._c=!0,i._d=!0,i}function Px(a){const{type:t,vnode:n,proxy:i,withProxy:o,props:s,propsOptions:[c],slots:u,attrs:h,emit:f,render:p,renderCache:m,data:y,setupState:g,ctx:_,inheritAttrs:x}=a;let b,E;const T=Cv(a);try{if(n.shapeFlag&4){const D=o||i;b=Ua(p.call(D,D,m,s,g,y,_)),E=h}else{const D=t;b=Ua(D.length>1?D(s,{attrs:h,slots:u,emit:f}):D(s,null)),E=t.props?h:qF(h)}}catch(D){tm.length=0,ny(D,a,1),b=Kr(Uc)}let P=b;if(E&&x!==!1){const D=Object.keys(E),{shapeFlag:F}=P;D.length&&F&7&&(c&&D.some(s_)&&(E=YF(E,c)),P=hm(P,E))}return n.dirs&&(P.dirs=P.dirs?P.dirs.concat(n.dirs):n.dirs),n.transition&&(P.transition=n.transition),b=P,Cv(T),b}const qF=a=>{let t;for(const n in a)(n==="class"||n==="style"||Qv(n))&&((t||(t={}))[n]=a[n]);return t},YF=(a,t)=>{const n={};for(const i in a)(!s_(i)||!(i.slice(9)in t))&&(n[i]=a[i]);return n};function QF(a,t,n){const{props:i,children:o,component:s}=a,{props:c,children:u,patchFlag:h}=t,f=s.emitsOptions;if(t.dirs||t.transition)return!0;if(n&&h>=0){if(h&1024)return!0;if(h&16)return i?_2(i,c,f):!!c;if(h&8){const p=t.dynamicProps;for(let m=0;m<p.length;m++){const y=p[m];if(c[y]!==i[y]&&!iy(f,y))return!0}}}else return(o||u)&&(!u||!u.$stable)?!0:i===c?!1:i?c?_2(i,c,f):!0:!!c;return!1}function _2(a,t,n){const i=Object.keys(t);if(i.length!==Object.keys(a).length)return!0;for(let o=0;o<i.length;o++){const s=i[o];if(t[s]!==a[s]&&!iy(n,s))return!0}return!1}function KF({vnode:a,parent:t},n){for(;t&&t.subTree===a;)(a=t.vnode).el=n,t=t.parent}const ZF=a=>a.__isSuspense;function JF(a,t){t&&t.pendingBranch?bi(a)?t.effects.push(...a):t.effects.push(a):WF(a)}function e8(a,t){if(Ms){let n=Ms.provides;const i=Ms.parent&&Ms.parent.provides;i===n&&(n=Ms.provides=Object.create(i)),n[a]=t}}function Ix(a,t,n=!1){const i=Ms||Ks;if(i){const o=i.parent==null?i.vnode.appContext&&i.vnode.appContext.provides:i.parent.provides;if(o&&a in o)return o[a];if(arguments.length>1)return n&&Pi(t)?t.call(i.proxy):t}}function w2(a,t){return x_(a,null,t)}const E2={};function Dc(a,t,n){return x_(a,t,n)}function x_(a,t,{immediate:n,deep:i,flush:o,onTrack:s,onTrigger:c}=pr){const u=Ms;let h,f=!1,p=!1;if(ds(a)?(h=()=>a.value,f=CT(a)):td(a)?(h=()=>a,i=!0):bi(a)?(p=!0,f=a.some(td),h=()=>a.map(E=>{if(ds(E))return E.value;if(td(E))return Qu(E);if(Pi(E))return Oc(E,u,2)})):Pi(a)?t?h=()=>Oc(a,u,2):h=()=>{if(!(u&&u.isUnmounted))return m&&m(),pa(a,u,3,[y])}:h=da,t&&i){const E=h;h=()=>Qu(E())}let m,y=E=>{m=b.onStop=()=>{Oc(E,u,4)}};if(fm)return y=da,t?n&&pa(t,u,3,[h(),p?[]:void 0,y]):h(),da;let g=p?[]:E2;const _=()=>{if(!!b.active)if(t){const E=b.run();(i||f||(p?E.some((T,P)=>am(T,g[P])):am(E,g)))&&(m&&m(),pa(t,u,3,[E,g===E2?void 0:g,y]),g=E)}else b.run()};_.allowRecurse=!!t;let x;o==="sync"?x=_:o==="post"?x=()=>so(_,u&&u.suspense):x=()=>{!u||u.isMounted?VF(_):_()};const b=new u_(h,x);return t?n?_():g=b.run():o==="post"?so(b.run.bind(b),u&&u.suspense):b.run(),()=>{b.stop(),u&&u.scope&&o_(u.scope.effects,b)}}function t8(a,t,n){const i=this.proxy,o=Zr(a)?a.includes(".")?VT(i,a):()=>i[a]:a.bind(i,i);let s;Pi(t)?s=t:(s=t.handler,n=t);const c=Ms;sd(this);const u=x_(o,s.bind(i),n);return c?sd(c):ih(),u}function VT(a,t){const n=t.split(".");return()=>{let i=a;for(let o=0;o<n.length&&i;o++)i=i[n[o]];return i}}function Qu(a,t){if(!Jr(a)||a.__v_skip||(t=t||new Set,t.has(a)))return a;if(t.add(a),ds(a))Qu(a.value,t);else if(bi(a))for(let n=0;n<a.length;n++)Qu(a[n],t);else if(Kv(a)||ed(a))a.forEach(n=>{Qu(n,t)});else if(mT(a))for(const n in a)Qu(a[n],t);return a}function Om(a){return Pi(a)?{setup:a,name:a.name}:a}const Rv=a=>!!a.type.__asyncLoader,WT=a=>a.type.__isKeepAlive;function n8(a,t){jT(a,"a",t)}function i8(a,t){jT(a,"da",t)}function jT(a,t,n=Ms){const i=a.__wdc||(a.__wdc=()=>{let o=n;for(;o;){if(o.isDeactivated)return;o=o.parent}return a()});if(sy(t,i,n),n){let o=n.parent;for(;o&&o.parent;)WT(o.parent.vnode)&&r8(i,t,n,o),o=o.parent}}function r8(a,t,n,i){const o=sy(t,a,i,!0);XT(()=>{o_(i[t],o)},n)}function sy(a,t,n=Ms,i=!1){if(n){const o=n[a]||(n[a]=[]),s=t.__weh||(t.__weh=(...c)=>{if(n.isUnmounted)return;Dd(),sd(n);const u=pa(t,n,a,c);return ih(),Bd(),u});return i?o.unshift(s):o.push(s),s}}const $l=a=>(t,n=Ms)=>(!fm||a==="sp")&&sy(a,t,n),s8=$l("bm"),o8=$l("m"),a8=$l("bu"),l8=$l("u"),c8=$l("bum"),XT=$l("um"),u8=$l("sp"),h8=$l("rtg"),f8=$l("rtc");function d8(a,t=Ms){sy("ec",a,t)}let YA=!0;function p8(a){const t=qT(a),n=a.proxy,i=a.ctx;YA=!1,t.beforeCreate&&M2(t.beforeCreate,a,"bc");const{data:o,computed:s,methods:c,watch:u,provide:h,inject:f,created:p,beforeMount:m,mounted:y,beforeUpdate:g,updated:_,activated:x,deactivated:b,beforeDestroy:E,beforeUnmount:T,destroyed:P,unmounted:D,render:F,renderTracked:k,renderTriggered:W,errorCaptured:j,serverPrefetch:J,expose:de,inheritAttrs:te,components:N,directives:L,filters:M}=t;if(f&&m8(f,i,null,a.appContext.config.unwrapInjectedRef),c)for(const $ in c){const ee=c[$];Pi(ee)&&(i[$]=ee.bind(n))}if(o){const $=o.call(n,n);Jr($)&&(a.data=p_($))}if(YA=!0,s)for(const $ in s){const ee=s[$],Q=Pi(ee)?ee.bind(n,n):Pi(ee.get)?ee.get.bind(n,n):da,G=!Pi(ee)&&Pi(ee.set)?ee.set.bind(n):da,K=Ys({get:Q,set:G});Object.defineProperty(i,$,{enumerable:!0,configurable:!0,get:()=>K.value,set:Y=>K.value=Y})}if(u)for(const $ in u)$T(u[$],i,n,$);if(h){const $=Pi(h)?h.call(n):h;Reflect.ownKeys($).forEach(ee=>{e8(ee,$[ee])})}p&&M2(p,a,"c");function U($,ee){bi(ee)?ee.forEach(Q=>$(Q.bind(n))):ee&&$(ee.bind(n))}if(U(s8,m),U(o8,y),U(a8,g),U(l8,_),U(n8,x),U(i8,b),U(d8,j),U(f8,k),U(h8,W),U(c8,T),U(XT,D),U(u8,J),bi(de))if(de.length){const $=a.exposed||(a.exposed={});de.forEach(ee=>{Object.defineProperty($,ee,{get:()=>n[ee],set:Q=>n[ee]=Q})})}else a.exposed||(a.exposed={});F&&a.render===da&&(a.render=F),te!=null&&(a.inheritAttrs=te),N&&(a.components=N),L&&(a.directives=L)}function m8(a,t,n=da,i=!1){bi(a)&&(a=QA(a));for(const o in a){const s=a[o];let c;Jr(s)?"default"in s?c=Ix(s.from||o,s.default,!0):c=Ix(s.from||o):c=Ix(s),ds(c)&&i?Object.defineProperty(t,o,{enumerable:!0,configurable:!0,get:()=>c.value,set:u=>c.value=u}):t[o]=c}}function M2(a,t,n){pa(bi(a)?a.map(i=>i.bind(t.proxy)):a.bind(t.proxy),t,n)}function $T(a,t,n,i){const o=i.includes(".")?VT(n,i):()=>n[i];if(Zr(a)){const s=t[a];Pi(s)&&Dc(o,s)}else if(Pi(a))Dc(o,a.bind(n));else if(Jr(a))if(bi(a))a.forEach(s=>$T(s,t,n,i));else{const s=Pi(a.handler)?a.handler.bind(n):t[a.handler];Pi(s)&&Dc(o,s,a)}}function qT(a){const t=a.type,{mixins:n,extends:i}=t,{mixins:o,optionsCache:s,config:{optionMergeStrategies:c}}=a.appContext,u=s.get(t);let h;return u?h=u:!o.length&&!n&&!i?h=t:(h={},o.length&&o.forEach(f=>Lv(h,f,c,!0)),Lv(h,t,c)),s.set(t,h),h}function Lv(a,t,n,i=!1){const{mixins:o,extends:s}=t;s&&Lv(a,s,n,!0),o&&o.forEach(c=>Lv(a,c,n,!0));for(const c in t)if(!(i&&c==="expose")){const u=g8[c]||n&&n[c];a[c]=u?u(a[c],t[c]):t[c]}return a}const g8={data:S2,props:Gu,emits:Gu,methods:Gu,computed:Gu,beforeCreate:qs,created:qs,beforeMount:qs,mounted:qs,beforeUpdate:qs,updated:qs,beforeDestroy:qs,beforeUnmount:qs,destroyed:qs,unmounted:qs,activated:qs,deactivated:qs,errorCaptured:qs,serverPrefetch:qs,components:Gu,directives:Gu,watch:y8,provide:S2,inject:v8};function S2(a,t){return t?a?function(){return Js(Pi(a)?a.call(this,this):a,Pi(t)?t.call(this,this):t)}:t:a}function v8(a,t){return Gu(QA(a),QA(t))}function QA(a){if(bi(a)){const t={};for(let n=0;n<a.length;n++)t[a[n]]=a[n];return t}return a}function qs(a,t){return a?[...new Set([].concat(a,t))]:t}function Gu(a,t){return a?Js(Js(Object.create(null),a),t):t}function y8(a,t){if(!a)return t;if(!t)return a;const n=Js(Object.create(null),a);for(const i in t)n[i]=qs(a[i],t[i]);return n}function x8(a,t,n,i=!1){const o={},s={};Sv(s,oy,1),a.propsDefaults=Object.create(null),YT(a,t,o,s);for(const c in a.propsOptions[0])c in o||(o[c]=void 0);n?a.props=i?o:OF(o):a.type.props?a.props=o:a.props=s,a.attrs=s}function A8(a,t,n,i){const{props:o,attrs:s,vnode:{patchFlag:c}}=a,u=sr(o),[h]=a.propsOptions;let f=!1;if((i||c>0)&&!(c&16)){if(c&8){const p=a.vnode.dynamicProps;for(let m=0;m<p.length;m++){let y=p[m];if(iy(a.emitsOptions,y))continue;const g=t[y];if(h)if(ji(s,y))g!==s[y]&&(s[y]=g,f=!0);else{const _=qa(y);o[_]=KA(h,u,_,g,a,!1)}else g!==s[y]&&(s[y]=g,f=!0)}}}else{YT(a,t,o,s)&&(f=!0);let p;for(const m in u)(!t||!ji(t,m)&&((p=Od(m))===m||!ji(t,p)))&&(h?n&&(n[m]!==void 0||n[p]!==void 0)&&(o[m]=KA(h,u,m,void 0,a,!0)):delete o[m]);if(s!==u)for(const m in s)(!t||!ji(t,m)&&!0)&&(delete s[m],f=!0)}f&&kl(a,"set","$attrs")}function YT(a,t,n,i){const[o,s]=a.propsOptions;let c=!1,u;if(t)for(let h in t){if(uv(h))continue;const f=t[h];let p;o&&ji(o,p=qa(h))?!s||!s.includes(p)?n[p]=f:(u||(u={}))[p]=f:iy(a.emitsOptions,h)||(!(h in i)||f!==i[h])&&(i[h]=f,c=!0)}if(s){const h=sr(n),f=u||pr;for(let p=0;p<s.length;p++){const m=s[p];n[m]=KA(o,h,m,f[m],a,!ji(f,m))}}return c}function KA(a,t,n,i,o,s){const c=a[n];if(c!=null){const u=ji(c,"default");if(u&&i===void 0){const h=c.default;if(c.type!==Function&&Pi(h)){const{propsDefaults:f}=o;n in f?i=f[n]:(sd(o),i=f[n]=h.call(null,t),ih())}else i=h}c[0]&&(s&&!u?i=!1:c[1]&&(i===""||i===Od(n))&&(i=!0))}return i}function QT(a,t,n=!1){const i=t.propsCache,o=i.get(a);if(o)return o;const s=a.props,c={},u=[];let h=!1;if(!Pi(a)){const p=m=>{h=!0;const[y,g]=QT(m,t,!0);Js(c,y),g&&u.push(...g)};!n&&t.mixins.length&&t.mixins.forEach(p),a.extends&&p(a.extends),a.mixins&&a.mixins.forEach(p)}if(!s&&!h)return i.set(a,Jf),Jf;if(bi(s))for(let p=0;p<s.length;p++){const m=qa(s[p]);T2(m)&&(c[m]=pr)}else if(s)for(const p in s){const m=qa(p);if(T2(m)){const y=s[p],g=c[m]=bi(y)||Pi(y)?{type:y}:y;if(g){const _=L2(Boolean,g.type),x=L2(String,g.type);g[0]=_>-1,g[1]=x<0||_<x,(_>-1||ji(g,"default"))&&u.push(m)}}}const f=[c,u];return i.set(a,f),f}function T2(a){return a[0]!=="$"}function C2(a){const t=a&&a.toString().match(/^\s*function (\w+)/);return t?t[1]:a===null?"null":""}function R2(a,t){return C2(a)===C2(t)}function L2(a,t){return bi(t)?t.findIndex(n=>R2(n,a)):Pi(t)&&R2(t,a)?0:-1}const KT=a=>a[0]==="_"||a==="$stable",A_=a=>bi(a)?a.map(Ua):[Ua(a)],b8=(a,t,n)=>{const i=Jp((...o)=>A_(t(...o)),n);return i._c=!1,i},ZT=(a,t,n)=>{const i=a._ctx;for(const o in a){if(KT(o))continue;const s=a[o];if(Pi(s))t[o]=b8(o,s,i);else if(s!=null){const c=A_(s);t[o]=()=>c}}},JT=(a,t)=>{const n=A_(t);a.slots.default=()=>n},_8=(a,t)=>{if(a.vnode.shapeFlag&32){const n=t._;n?(a.slots=sr(t),Sv(t,"_",n)):ZT(t,a.slots={})}else a.slots={},t&&JT(a,t);Sv(a.slots,oy,1)},w8=(a,t,n)=>{const{vnode:i,slots:o}=a;let s=!0,c=pr;if(i.shapeFlag&32){const u=t._;u?n&&u===1?s=!1:(Js(o,t),!n&&u===1&&delete o._):(s=!t.$stable,ZT(t,o)),c=t}else t&&(JT(a,t),c={default:1});if(s)for(const u in o)!KT(u)&&!(u in c)&&delete o[u]};function E8(a,t){const n=Ks;if(n===null)return a;const i=ay(n)||n.proxy,o=a.dirs||(a.dirs=[]);for(let s=0;s<t.length;s++){let[c,u,h,f=pr]=t[s];Pi(c)&&(c={mounted:c,updated:c}),c.deep&&Qu(u),o.push({dir:c,instance:i,value:u,oldValue:void 0,arg:h,modifiers:f})}return a}function Pu(a,t,n,i){const o=a.dirs,s=t&&t.dirs;for(let c=0;c<o.length;c++){const u=o[c];s&&(u.oldValue=s[c].value);let h=u.dir[i];h&&(Dd(),pa(h,n,8,[a.el,u,a,t]),Bd())}}function eC(){return{app:null,config:{isNativeTag:K6,performance:!1,globalProperties:{},optionMergeStrategies:{},errorHandler:void 0,warnHandler:void 0,compilerOptions:{}},mixins:[],components:{},directives:{},provides:Object.create(null),optionsCache:new WeakMap,propsCache:new WeakMap,emitsCache:new WeakMap}}let M8=0;function S8(a,t){return function(i,o=null){Pi(i)||(i=Object.assign({},i)),o!=null&&!Jr(o)&&(o=null);const s=eC(),c=new Set;let u=!1;const h=s.app={_uid:M8++,_component:i,_props:o,_container:null,_context:s,_instance:null,version:Y8,get config(){return s.config},set config(f){},use(f,...p){return c.has(f)||(f&&Pi(f.install)?(c.add(f),f.install(h,...p)):Pi(f)&&(c.add(f),f(h,...p))),h},mixin(f){return s.mixins.includes(f)||s.mixins.push(f),h},component(f,p){return p?(s.components[f]=p,h):s.components[f]},directive(f,p){return p?(s.directives[f]=p,h):s.directives[f]},mount(f,p,m){if(!u){const y=Kr(i,o);return y.appContext=s,p&&t?t(y,f):a(y,f,m),u=!0,h._container=f,f.__vue_app__=h,ay(y.component)||y.component.proxy}},unmount(){u&&(a(null,h._container),delete h._container.__vue_app__)},provide(f,p){return s.provides[f]=p,h}};return h}}function ZA(a,t,n,i,o=!1){if(bi(a)){a.forEach((y,g)=>ZA(y,t&&(bi(t)?t[g]:t),n,i,o));return}if(Rv(i)&&!o)return;const s=i.shapeFlag&4?ay(i.component)||i.component.proxy:i.el,c=o?null:s,{i:u,r:h}=a,f=t&&t.r,p=u.refs===pr?u.refs={}:u.refs,m=u.setupState;if(f!=null&&f!==h&&(Zr(f)?(p[f]=null,ji(m,f)&&(m[f]=null)):ds(f)&&(f.value=null)),Pi(h))Oc(h,u,12,[c,p]);else{const y=Zr(h),g=ds(h);if(y||g){const _=()=>{if(a.f){const x=y?p[h]:h.value;o?bi(x)&&o_(x,s):bi(x)?x.includes(s)||x.push(s):y?(p[h]=[s],ji(m,h)&&(m[h]=p[h])):(h.value=[s],a.k&&(p[a.k]=h.value))}else y?(p[h]=c,ji(m,h)&&(m[h]=c)):ds(h)&&(h.value=c,a.k&&(p[a.k]=c))};c?(_.id=-1,so(_,n)):_()}}}const so=JF;function T8(a){return C8(a)}function C8(a,t){const n=iF();n.__VUE__=!0;const{insert:i,remove:o,patchProp:s,createElement:c,createText:u,createComment:h,setText:f,setElementText:p,parentNode:m,nextSibling:y,setScopeId:g=da,cloneNode:_,insertStaticContent:x}=a,b=(Pe,Be,$e,Je=null,We=null,_e=null,Ee=!1,Oe=null,Le=!!Be.dynamicChildren)=>{if(Pe===Be)return;Pe&&!Pp(Pe,Be)&&(Je=ze(Pe),we(Pe,We,_e,!0),Pe=null),Be.patchFlag===-2&&(Le=!1,Be.dynamicChildren=null);const{type:ce,ref:he,shapeFlag:ie}=Be;switch(ce){case __:E(Pe,Be,$e,Je);break;case Uc:T(Pe,Be,$e,Je);break;case Ox:Pe==null&&P(Be,$e,Je,Ee);break;case Hs:L(Pe,Be,$e,Je,We,_e,Ee,Oe,Le);break;default:ie&1?k(Pe,Be,$e,Je,We,_e,Ee,Oe,Le):ie&6?M(Pe,Be,$e,Je,We,_e,Ee,Oe,Le):(ie&64||ie&128)&&ce.process(Pe,Be,$e,Je,We,_e,Ee,Oe,Le,rt)}he!=null&&We&&ZA(he,Pe&&Pe.ref,_e,Be||Pe,!Be)},E=(Pe,Be,$e,Je)=>{if(Pe==null)i(Be.el=u(Be.children),$e,Je);else{const We=Be.el=Pe.el;Be.children!==Pe.children&&f(We,Be.children)}},T=(Pe,Be,$e,Je)=>{Pe==null?i(Be.el=h(Be.children||""),$e,Je):Be.el=Pe.el},P=(Pe,Be,$e,Je)=>{[Pe.el,Pe.anchor]=x(Pe.children,Be,$e,Je,Pe.el,Pe.anchor)},D=({el:Pe,anchor:Be},$e,Je)=>{let We;for(;Pe&&Pe!==Be;)We=y(Pe),i(Pe,$e,Je),Pe=We;i(Be,$e,Je)},F=({el:Pe,anchor:Be})=>{let $e;for(;Pe&&Pe!==Be;)$e=y(Pe),o(Pe),Pe=$e;o(Be)},k=(Pe,Be,$e,Je,We,_e,Ee,Oe,Le)=>{Ee=Ee||Be.type==="svg",Pe==null?W(Be,$e,Je,We,_e,Ee,Oe,Le):de(Pe,Be,We,_e,Ee,Oe,Le)},W=(Pe,Be,$e,Je,We,_e,Ee,Oe)=>{let Le,ce;const{type:he,props:ie,shapeFlag:V,transition:Z,patchFlag:B,dirs:S}=Pe;if(Pe.el&&_!==void 0&&B===-1)Le=Pe.el=_(Pe.el);else{if(Le=Pe.el=c(Pe.type,_e,ie&&ie.is,ie),V&8?p(Le,Pe.children):V&16&&J(Pe.children,Le,null,Je,We,_e&&he!=="foreignObject",Ee,Oe),S&&Pu(Pe,null,Je,"created"),ie){for(const X in ie)X!=="value"&&!uv(X)&&s(Le,X,null,ie[X],_e,Pe.children,Je,We,De);"value"in ie&&s(Le,"value",null,ie.value),(ce=ie.onVnodeBeforeMount)&&Ba(ce,Je,Pe)}j(Le,Pe,Pe.scopeId,Ee,Je)}S&&Pu(Pe,null,Je,"beforeMount");const R=(!We||We&&!We.pendingBranch)&&Z&&!Z.persisted;R&&Z.beforeEnter(Le),i(Le,Be,$e),((ce=ie&&ie.onVnodeMounted)||R||S)&&so(()=>{ce&&Ba(ce,Je,Pe),R&&Z.enter(Le),S&&Pu(Pe,null,Je,"mounted")},We)},j=(Pe,Be,$e,Je,We)=>{if($e&&g(Pe,$e),Je)for(let _e=0;_e<Je.length;_e++)g(Pe,Je[_e]);if(We){let _e=We.subTree;if(Be===_e){const Ee=We.vnode;j(Pe,Ee,Ee.scopeId,Ee.slotScopeIds,We.parent)}}},J=(Pe,Be,$e,Je,We,_e,Ee,Oe,Le=0)=>{for(let ce=Le;ce<Pe.length;ce++){const he=Pe[ce]=Oe?wc(Pe[ce]):Ua(Pe[ce]);b(null,he,Be,$e,Je,We,_e,Ee,Oe)}},de=(Pe,Be,$e,Je,We,_e,Ee)=>{const Oe=Be.el=Pe.el;let{patchFlag:Le,dynamicChildren:ce,dirs:he}=Be;Le|=Pe.patchFlag&16;const ie=Pe.props||pr,V=Be.props||pr;let Z;$e&&Iu($e,!1),(Z=V.onVnodeBeforeUpdate)&&Ba(Z,$e,Be,Pe),he&&Pu(Be,Pe,$e,"beforeUpdate"),$e&&Iu($e,!0);const B=We&&Be.type!=="foreignObject";if(ce?te(Pe.dynamicChildren,ce,Oe,$e,Je,B,_e):Ee||Q(Pe,Be,Oe,null,$e,Je,B,_e,!1),Le>0){if(Le&16)N(Oe,Be,ie,V,$e,Je,We);else if(Le&2&&ie.class!==V.class&&s(Oe,"class",null,V.class,We),Le&4&&s(Oe,"style",ie.style,V.style,We),Le&8){const S=Be.dynamicProps;for(let R=0;R<S.length;R++){const X=S[R],xe=ie[X],Ie=V[X];(Ie!==xe||X==="value")&&s(Oe,X,xe,Ie,We,Pe.children,$e,Je,De)}}Le&1&&Pe.children!==Be.children&&p(Oe,Be.children)}else!Ee&&ce==null&&N(Oe,Be,ie,V,$e,Je,We);((Z=V.onVnodeUpdated)||he)&&so(()=>{Z&&Ba(Z,$e,Be,Pe),he&&Pu(Be,Pe,$e,"updated")},Je)},te=(Pe,Be,$e,Je,We,_e,Ee)=>{for(let Oe=0;Oe<Be.length;Oe++){const Le=Pe[Oe],ce=Be[Oe],he=Le.el&&(Le.type===Hs||!Pp(Le,ce)||Le.shapeFlag&70)?m(Le.el):$e;b(Le,ce,he,null,Je,We,_e,Ee,!0)}},N=(Pe,Be,$e,Je,We,_e,Ee)=>{if($e!==Je){for(const Oe in Je){if(uv(Oe))continue;const Le=Je[Oe],ce=$e[Oe];Le!==ce&&Oe!=="value"&&s(Pe,Oe,ce,Le,Ee,Be.children,We,_e,De)}if($e!==pr)for(const Oe in $e)!uv(Oe)&&!(Oe in Je)&&s(Pe,Oe,$e[Oe],null,Ee,Be.children,We,_e,De);"value"in Je&&s(Pe,"value",$e.value,Je.value)}},L=(Pe,Be,$e,Je,We,_e,Ee,Oe,Le)=>{const ce=Be.el=Pe?Pe.el:u(""),he=Be.anchor=Pe?Pe.anchor:u("");let{patchFlag:ie,dynamicChildren:V,slotScopeIds:Z}=Be;Z&&(Oe=Oe?Oe.concat(Z):Z),Pe==null?(i(ce,$e,Je),i(he,$e,Je),J(Be.children,$e,he,We,_e,Ee,Oe,Le)):ie>0&&ie&64&&V&&Pe.dynamicChildren?(te(Pe.dynamicChildren,V,$e,We,_e,Ee,Oe),(Be.key!=null||We&&Be===We.subTree)&&b_(Pe,Be,!0)):Q(Pe,Be,$e,he,We,_e,Ee,Oe,Le)},M=(Pe,Be,$e,Je,We,_e,Ee,Oe,Le)=>{Be.slotScopeIds=Oe,Pe==null?Be.shapeFlag&512?We.ctx.activate(Be,$e,Je,Ee,Le):I(Be,$e,Je,We,_e,Ee,Le):U(Pe,Be,Le)},I=(Pe,Be,$e,Je,We,_e,Ee)=>{const Oe=Pe.component=G8(Pe,Je,We);if(WT(Pe)&&(Oe.ctx.renderer=rt),V8(Oe),Oe.asyncDep){if(We&&We.registerDep(Oe,$),!Pe.el){const Le=Oe.subTree=Kr(Uc);T(null,Le,Be,$e)}return}$(Oe,Pe,Be,$e,We,_e,Ee)},U=(Pe,Be,$e)=>{const Je=Be.component=Pe.component;if(QF(Pe,Be,$e))if(Je.asyncDep&&!Je.asyncResolved){ee(Je,Be,$e);return}else Je.next=Be,GF(Je.update),Je.update();else Be.component=Pe.component,Be.el=Pe.el,Je.vnode=Be},$=(Pe,Be,$e,Je,We,_e,Ee)=>{const Oe=()=>{if(Pe.isMounted){let{next:he,bu:ie,u:V,parent:Z,vnode:B}=Pe,S=he,R;Iu(Pe,!1),he?(he.el=B.el,ee(Pe,he,Ee)):he=B,ie&&hv(ie),(R=he.props&&he.props.onVnodeBeforeUpdate)&&Ba(R,Z,he,B),Iu(Pe,!0);const X=Px(Pe),xe=Pe.subTree;Pe.subTree=X,b(xe,X,m(xe.el),ze(xe),Pe,We,_e),he.el=X.el,S===null&&KF(Pe,X.el),V&&so(V,We),(R=he.props&&he.props.onVnodeUpdated)&&so(()=>Ba(R,Z,he,B),We)}else{let he;const{el:ie,props:V}=Be,{bm:Z,m:B,parent:S}=Pe,R=Rv(Be);if(Iu(Pe,!1),Z&&hv(Z),!R&&(he=V&&V.onVnodeBeforeMount)&&Ba(he,S,Be),Iu(Pe,!0),ie&&Ye){const X=()=>{Pe.subTree=Px(Pe),Ye(ie,Pe.subTree,Pe,We,null)};R?Be.type.__asyncLoader().then(()=>!Pe.isUnmounted&&X()):X()}else{const X=Pe.subTree=Px(Pe);b(null,X,$e,Je,Pe,We,_e),Be.el=X.el}if(B&&so(B,We),!R&&(he=V&&V.onVnodeMounted)){const X=Be;so(()=>Ba(he,S,X),We)}Be.shapeFlag&256&&Pe.a&&so(Pe.a,We),Pe.isMounted=!0,Be=$e=Je=null}},Le=Pe.effect=new u_(Oe,()=>NT(Pe.update),Pe.scope),ce=Pe.update=Le.run.bind(Le);ce.id=Pe.uid,Iu(Pe,!0),ce()},ee=(Pe,Be,$e)=>{Be.component=Pe;const Je=Pe.vnode.props;Pe.vnode=Be,Pe.next=null,A8(Pe,Be.props,Je,$e),w8(Pe,Be.children,$e),Dd(),y_(void 0,Pe.update),Bd()},Q=(Pe,Be,$e,Je,We,_e,Ee,Oe,Le=!1)=>{const ce=Pe&&Pe.children,he=Pe?Pe.shapeFlag:0,ie=Be.children,{patchFlag:V,shapeFlag:Z}=Be;if(V>0){if(V&128){K(ce,ie,$e,Je,We,_e,Ee,Oe,Le);return}else if(V&256){G(ce,ie,$e,Je,We,_e,Ee,Oe,Le);return}}Z&8?(he&16&&De(ce,We,_e),ie!==ce&&p($e,ie)):he&16?Z&16?K(ce,ie,$e,Je,We,_e,Ee,Oe,Le):De(ce,We,_e,!0):(he&8&&p($e,""),Z&16&&J(ie,$e,Je,We,_e,Ee,Oe,Le))},G=(Pe,Be,$e,Je,We,_e,Ee,Oe,Le)=>{Pe=Pe||Jf,Be=Be||Jf;const ce=Pe.length,he=Be.length,ie=Math.min(ce,he);let V;for(V=0;V<ie;V++){const Z=Be[V]=Le?wc(Be[V]):Ua(Be[V]);b(Pe[V],Z,$e,null,We,_e,Ee,Oe,Le)}ce>he?De(Pe,We,_e,!0,!1,ie):J(Be,$e,Je,We,_e,Ee,Oe,Le,ie)},K=(Pe,Be,$e,Je,We,_e,Ee,Oe,Le)=>{let ce=0;const he=Be.length;let ie=Pe.length-1,V=he-1;for(;ce<=ie&&ce<=V;){const Z=Pe[ce],B=Be[ce]=Le?wc(Be[ce]):Ua(Be[ce]);if(Pp(Z,B))b(Z,B,$e,null,We,_e,Ee,Oe,Le);else break;ce++}for(;ce<=ie&&ce<=V;){const Z=Pe[ie],B=Be[V]=Le?wc(Be[V]):Ua(Be[V]);if(Pp(Z,B))b(Z,B,$e,null,We,_e,Ee,Oe,Le);else break;ie--,V--}if(ce>ie){if(ce<=V){const Z=V+1,B=Z<he?Be[Z].el:Je;for(;ce<=V;)b(null,Be[ce]=Le?wc(Be[ce]):Ua(Be[ce]),$e,B,We,_e,Ee,Oe,Le),ce++}}else if(ce>V)for(;ce<=ie;)we(Pe[ce],We,_e,!0),ce++;else{const Z=ce,B=ce,S=new Map;for(ce=B;ce<=V;ce++){const mt=Be[ce]=Le?wc(Be[ce]):Ua(Be[ce]);mt.key!=null&&S.set(mt.key,ce)}let R,X=0;const xe=V-B+1;let Ie=!1,ye=0;const nt=new Array(xe);for(ce=0;ce<xe;ce++)nt[ce]=0;for(ce=Z;ce<=ie;ce++){const mt=Pe[ce];if(X>=xe){we(mt,We,_e,!0);continue}let wt;if(mt.key!=null)wt=S.get(mt.key);else for(R=B;R<=V;R++)if(nt[R-B]===0&&Pp(mt,Be[R])){wt=R;break}wt===void 0?we(mt,We,_e,!0):(nt[wt-B]=ce+1,wt>=ye?ye=wt:Ie=!0,b(mt,Be[wt],$e,null,We,_e,Ee,Oe,Le),X++)}const at=Ie?R8(nt):Jf;for(R=at.length-1,ce=xe-1;ce>=0;ce--){const mt=B+ce,wt=Be[mt],Lt=mt+1<he?Be[mt+1].el:Je;nt[ce]===0?b(null,wt,$e,Lt,We,_e,Ee,Oe,Le):Ie&&(R<0||ce!==at[R]?Y(wt,$e,Lt,2):R--)}}},Y=(Pe,Be,$e,Je,We=null)=>{const{el:_e,type:Ee,transition:Oe,children:Le,shapeFlag:ce}=Pe;if(ce&6){Y(Pe.component.subTree,Be,$e,Je);return}if(ce&128){Pe.suspense.move(Be,$e,Je);return}if(ce&64){Ee.move(Pe,Be,$e,rt);return}if(Ee===Hs){i(_e,Be,$e);for(let ie=0;ie<Le.length;ie++)Y(Le[ie],Be,$e,Je);i(Pe.anchor,Be,$e);return}if(Ee===Ox){D(Pe,Be,$e);return}if(Je!==2&&ce&1&&Oe)if(Je===0)Oe.beforeEnter(_e),i(_e,Be,$e),so(()=>Oe.enter(_e),We);else{const{leave:ie,delayLeave:V,afterLeave:Z}=Oe,B=()=>i(_e,Be,$e),S=()=>{ie(_e,()=>{B(),Z&&Z()})};V?V(_e,B,S):S()}else i(_e,Be,$e)},we=(Pe,Be,$e,Je=!1,We=!1)=>{const{type:_e,props:Ee,ref:Oe,children:Le,dynamicChildren:ce,shapeFlag:he,patchFlag:ie,dirs:V}=Pe;if(Oe!=null&&ZA(Oe,null,$e,Pe,!0),he&256){Be.ctx.deactivate(Pe);return}const Z=he&1&&V,B=!Rv(Pe);let S;if(B&&(S=Ee&&Ee.onVnodeBeforeUnmount)&&Ba(S,Be,Pe),he&6)me(Pe.component,$e,Je);else{if(he&128){Pe.suspense.unmount($e,Je);return}Z&&Pu(Pe,null,Be,"beforeUnmount"),he&64?Pe.type.remove(Pe,Be,$e,We,rt,Je):ce&&(_e!==Hs||ie>0&&ie&64)?De(ce,Be,$e,!1,!0):(_e===Hs&&ie&384||!We&&he&16)&&De(Le,Be,$e),Je&&Ke(Pe)}(B&&(S=Ee&&Ee.onVnodeUnmounted)||Z)&&so(()=>{S&&Ba(S,Be,Pe),Z&&Pu(Pe,null,Be,"unmounted")},$e)},Ke=Pe=>{const{type:Be,el:$e,anchor:Je,transition:We}=Pe;if(Be===Hs){ge($e,Je);return}if(Be===Ox){F(Pe);return}const _e=()=>{o($e),We&&!We.persisted&&We.afterLeave&&We.afterLeave()};if(Pe.shapeFlag&1&&We&&!We.persisted){const{leave:Ee,delayLeave:Oe}=We,Le=()=>Ee($e,_e);Oe?Oe(Pe.el,_e,Le):Le()}else _e()},ge=(Pe,Be)=>{let $e;for(;Pe!==Be;)$e=y(Pe),o(Pe),Pe=$e;o(Be)},me=(Pe,Be,$e)=>{const{bum:Je,scope:We,update:_e,subTree:Ee,um:Oe}=Pe;Je&&hv(Je),We.stop(),_e&&(_e.active=!1,we(Ee,Pe,Be,$e)),Oe&&so(Oe,Be),so(()=>{Pe.isUnmounted=!0},Be),Be&&Be.pendingBranch&&!Be.isUnmounted&&Pe.asyncDep&&!Pe.asyncResolved&&Pe.suspenseId===Be.pendingId&&(Be.deps--,Be.deps===0&&Be.resolve())},De=(Pe,Be,$e,Je=!1,We=!1,_e=0)=>{for(let Ee=_e;Ee<Pe.length;Ee++)we(Pe[Ee],Be,$e,Je,We)},ze=Pe=>Pe.shapeFlag&6?ze(Pe.component.subTree):Pe.shapeFlag&128?Pe.suspense.next():y(Pe.anchor||Pe.el),tt=(Pe,Be,$e)=>{Pe==null?Be._vnode&&we(Be._vnode,null,null,!0):b(Be._vnode||null,Pe,Be,null,null,null,$e),zT(),Be._vnode=Pe},rt={p:b,um:we,m:Y,r:Ke,mt:I,mc:J,pc:Q,pbc:te,n:ze,o:a};let vt,Ye;return t&&([vt,Ye]=t(rt)),{render:tt,hydrate:vt,createApp:S8(tt,vt)}}function Iu({effect:a,update:t},n){a.allowRecurse=t.allowRecurse=n}function b_(a,t,n=!1){const i=a.children,o=t.children;if(bi(i)&&bi(o))for(let s=0;s<i.length;s++){const c=i[s];let u=o[s];u.shapeFlag&1&&!u.dynamicChildren&&((u.patchFlag<=0||u.patchFlag===32)&&(u=o[s]=wc(o[s]),u.el=c.el),n||b_(c,u))}}function R8(a){const t=a.slice(),n=[0];let i,o,s,c,u;const h=a.length;for(i=0;i<h;i++){const f=a[i];if(f!==0){if(o=n[n.length-1],a[o]<f){t[i]=o,n.push(i);continue}for(s=0,c=n.length-1;s<c;)u=s+c>>1,a[n[u]]<f?s=u+1:c=u;f<a[n[s]]&&(s>0&&(t[i]=n[s-1]),n[s]=i)}}for(s=n.length,c=n[s-1];s-- >0;)n[s]=c,c=t[c];return n}const L8=a=>a.__isTeleport,em=a=>a&&(a.disabled||a.disabled===""),P2=a=>typeof SVGElement!="undefined"&&a instanceof SVGElement,JA=(a,t)=>{const n=a&&a.to;return Zr(n)?t?t(n):null:n},P8={__isTeleport:!0,process(a,t,n,i,o,s,c,u,h,f){const{mc:p,pc:m,pbc:y,o:{insert:g,querySelector:_,createText:x,createComment:b}}=f,E=em(t.props);let{shapeFlag:T,children:P,dynamicChildren:D}=t;if(a==null){const F=t.el=x(""),k=t.anchor=x("");g(F,n,i),g(k,n,i);const W=t.target=JA(t.props,_),j=t.targetAnchor=x("");W&&(g(j,W),c=c||P2(W));const J=(de,te)=>{T&16&&p(P,de,te,o,s,c,u,h)};E?J(n,k):W&&J(W,j)}else{t.el=a.el;const F=t.anchor=a.anchor,k=t.target=a.target,W=t.targetAnchor=a.targetAnchor,j=em(a.props),J=j?n:k,de=j?F:W;if(c=c||P2(k),D?(y(a.dynamicChildren,D,J,o,s,c,u),b_(a,t,!0)):h||m(a,t,J,de,o,s,c,u,!1),E)j||vg(t,n,F,f,1);else if((t.props&&t.props.to)!==(a.props&&a.props.to)){const te=t.target=JA(t.props,_);te&&vg(t,te,null,f,0)}else j&&vg(t,k,W,f,1)}},remove(a,t,n,i,{um:o,o:{remove:s}},c){const{shapeFlag:u,children:h,anchor:f,targetAnchor:p,target:m,props:y}=a;if(m&&s(p),(c||!em(y))&&(s(f),u&16))for(let g=0;g<h.length;g++){const _=h[g];o(_,t,n,!0,!!_.dynamicChildren)}},move:vg,hydrate:I8};function vg(a,t,n,{o:{insert:i},m:o},s=2){s===0&&i(a.targetAnchor,t,n);const{el:c,anchor:u,shapeFlag:h,children:f,props:p}=a,m=s===2;if(m&&i(c,t,n),(!m||em(p))&&h&16)for(let y=0;y<f.length;y++)o(f[y],t,n,2);m&&i(u,t,n)}function I8(a,t,n,i,o,s,{o:{nextSibling:c,parentNode:u,querySelector:h}},f){const p=t.target=JA(t.props,h);if(p){const m=p._lpa||p.firstChild;t.shapeFlag&16&&(em(t.props)?(t.anchor=f(c(a),t,u(a),n,i,o,s),t.targetAnchor=m):(t.anchor=c(a),t.targetAnchor=f(m,t,p,n,i,o,s)),p._lpa=t.targetAnchor&&c(t.targetAnchor))}return t.anchor&&c(t.anchor)}const O8=P8,tC="components";function th(a,t){return B8(tC,a,!0,t)||a}const D8=Symbol();function B8(a,t,n=!0,i=!1){const o=Ks||Ms;if(o){const s=o.type;if(a===tC){const u=$8(s);if(u&&(u===t||u===qa(t)||u===ey(qa(t))))return s}const c=I2(o[a]||s[a],t)||I2(o.appContext[a],t);return!c&&i?s:c}}function I2(a,t){return a&&(a[t]||a[qa(t)]||a[ey(qa(t))])}const Hs=Symbol(void 0),__=Symbol(void 0),Uc=Symbol(void 0),Ox=Symbol(void 0),tm=[];let nh=null;function wr(a=!1){tm.push(nh=a?null:[])}function F8(){tm.pop(),nh=tm[tm.length-1]||null}let Pv=1;function O2(a){Pv+=a}function nC(a){return a.dynamicChildren=Pv>0?nh||Jf:null,F8(),Pv>0&&nh&&nh.push(a),a}function fs(a,t,n,i,o,s){return nC(Yi(a,t,n,i,o,s,!0))}function rd(a,t,n,i,o){return nC(Kr(a,t,n,i,o,!0))}function iC(a){return a?a.__v_isVNode===!0:!1}function Pp(a,t){return a.type===t.type&&a.key===t.key}const oy="__vInternal",rC=({key:a})=>a!=null?a:null,fv=({ref:a,ref_key:t,ref_for:n})=>a!=null?Zr(a)||ds(a)||Pi(a)?{i:Ks,r:a,k:t,f:!!n}:a:null;function Yi(a,t=null,n=null,i=0,o=null,s=a===Hs?0:1,c=!1,u=!1){const h={__v_isVNode:!0,__v_skip:!0,type:a,props:t,key:t&&rC(t),ref:t&&fv(t),scopeId:ry,slotScopeIds:null,children:n,component:null,suspense:null,ssContent:null,ssFallback:null,dirs:null,transition:null,el:null,anchor:null,target:null,targetAnchor:null,staticCount:0,shapeFlag:s,patchFlag:i,dynamicProps:o,dynamicChildren:null,appContext:null};return u?(w_(h,n),s&128&&a.normalize(h)):n&&(h.shapeFlag|=Zr(n)?8:16),Pv>0&&!c&&nh&&(h.patchFlag>0||s&6)&&h.patchFlag!==32&&nh.push(h),h}const Kr=N8;function N8(a,t=null,n=null,i=0,o=null,s=!1){if((!a||a===D8)&&(a=Uc),iC(a)){const u=hm(a,t,!0);return n&&w_(u,n),u}if(q8(a)&&(a=a.__vccOpts),t){t=ko(t);let{class:u,style:h}=t;u&&!Zr(u)&&(t.class=Ol(u)),Jr(h)&&(RT(h)&&!bi(h)&&(h=Js({},h)),t.style=Pm(h))}const c=Zr(a)?1:ZF(a)?128:L8(a)?64:Jr(a)?4:Pi(a)?2:0;return Yi(a,t,n,i,o,c,s,!0)}function ko(a){return a?RT(a)||oy in a?Js({},a):a:null}function hm(a,t,n=!1){const{props:i,ref:o,patchFlag:s,children:c}=a,u=t?U8(i||{},t):i;return{__v_isVNode:!0,__v_skip:!0,type:a.type,props:u,key:u&&rC(u),ref:t&&t.ref?n&&o?bi(o)?o.concat(fv(t)):[o,fv(t)]:fv(t):o,scopeId:a.scopeId,slotScopeIds:a.slotScopeIds,children:c,target:a.target,targetAnchor:a.targetAnchor,staticCount:a.staticCount,shapeFlag:a.shapeFlag,patchFlag:t&&a.type!==Hs?s===-1?16:s|16:s,dynamicProps:a.dynamicProps,dynamicChildren:a.dynamicChildren,appContext:a.appContext,dirs:a.dirs,transition:a.transition,component:a.component,suspense:a.suspense,ssContent:a.ssContent&&hm(a.ssContent),ssFallback:a.ssFallback&&hm(a.ssFallback),el:a.el,anchor:a.anchor}}function sC(a=" ",t=0){return Kr(__,null,a,t)}function nd(a="",t=!1){return t?(wr(),rd(Uc,null,a)):Kr(Uc,null,a)}function Ua(a){return a==null||typeof a=="boolean"?Kr(Uc):bi(a)?Kr(Hs,null,a.slice()):typeof a=="object"?wc(a):Kr(__,null,String(a))}function wc(a){return a.el===null||a.memo?a:hm(a)}function w_(a,t){let n=0;const{shapeFlag:i}=a;if(t==null)t=null;else if(bi(t))n=16;else if(typeof t=="object")if(i&65){const o=t.default;o&&(o._c&&(o._d=!1),w_(a,o()),o._c&&(o._d=!0));return}else{n=32;const o=t._;!o&&!(oy in t)?t._ctx=Ks:o===3&&Ks&&(Ks.slots._===1?t._=1:(t._=2,a.patchFlag|=1024))}else Pi(t)?(t={default:t,_ctx:Ks},n=32):(t=String(t),i&64?(n=16,t=[sC(t)]):n=8);a.children=t,a.shapeFlag|=n}function U8(...a){const t={};for(let n=0;n<a.length;n++){const i=a[n];for(const o in i)if(o==="class")t.class!==i.class&&(t.class=Ol([t.class,i.class]));else if(o==="style")t.style=Pm([t.style,i.style]);else if(Qv(o)){const s=t[o],c=i[o];c&&s!==c&&!(bi(s)&&s.includes(c))&&(t[o]=s?[].concat(s,c):c)}else o!==""&&(t[o]=i[o])}return t}function Ba(a,t,n,i=null){pa(a,t,7,[n,i])}function eb(a,t,n,i){let o;const s=n&&n[i];if(bi(a)||Zr(a)){o=new Array(a.length);for(let c=0,u=a.length;c<u;c++)o[c]=t(a[c],c,void 0,s&&s[c])}else if(typeof a=="number"){o=new Array(a);for(let c=0;c<a;c++)o[c]=t(c+1,c,void 0,s&&s[c])}else if(Jr(a))if(a[Symbol.iterator])o=Array.from(a,(c,u)=>t(c,u,void 0,s&&s[u]));else{const c=Object.keys(a);o=new Array(c.length);for(let u=0,h=c.length;u<h;u++){const f=c[u];o[u]=t(a[f],f,u,s&&s[u])}}else o=[];return n&&(n[i]=o),o}function ca(a,t,n={},i,o){if(Ks.isCE||Ks.parent&&Rv(Ks.parent)&&Ks.parent.isCE)return Kr("slot",t==="default"?null:{name:t},i&&i());let s=a[t];s&&s._c&&(s._d=!1),wr();const c=s&&oC(s(n)),u=rd(Hs,{key:n.key||`_${t}`},c||(i?i():[]),c&&a._===1?64:-2);return!o&&u.scopeId&&(u.slotScopeIds=[u.scopeId+"-s"]),s&&s._c&&(s._d=!0),u}function oC(a){return a.some(t=>iC(t)?!(t.type===Uc||t.type===Hs&&!oC(t.children)):!0)?a:null}const tb=a=>a?aC(a)?ay(a)||a.proxy:tb(a.parent):null,Iv=Js(Object.create(null),{$:a=>a,$el:a=>a.vnode.el,$data:a=>a.data,$props:a=>a.props,$attrs:a=>a.attrs,$slots:a=>a.slots,$refs:a=>a.refs,$parent:a=>tb(a.parent),$root:a=>tb(a.root),$emit:a=>a.emit,$options:a=>qT(a),$forceUpdate:a=>()=>NT(a.update),$nextTick:a=>FT.bind(a.proxy),$watch:a=>t8.bind(a)}),k8={get({_:a},t){const{ctx:n,setupState:i,data:o,props:s,accessCache:c,type:u,appContext:h}=a;let f;if(t[0]!=="$"){const g=c[t];if(g!==void 0)switch(g){case 1:return i[t];case 2:return o[t];case 4:return n[t];case 3:return s[t]}else{if(i!==pr&&ji(i,t))return c[t]=1,i[t];if(o!==pr&&ji(o,t))return c[t]=2,o[t];if((f=a.propsOptions[0])&&ji(f,t))return c[t]=3,s[t];if(n!==pr&&ji(n,t))return c[t]=4,n[t];YA&&(c[t]=0)}}const p=Iv[t];let m,y;if(p)return t==="$attrs"&&Lo(a,"get",t),p(a);if((m=u.__cssModules)&&(m=m[t]))return m;if(n!==pr&&ji(n,t))return c[t]=4,n[t];if(y=h.config.globalProperties,ji(y,t))return y[t]},set({_:a},t,n){const{data:i,setupState:o,ctx:s}=a;return o!==pr&&ji(o,t)?(o[t]=n,!0):i!==pr&&ji(i,t)?(i[t]=n,!0):ji(a.props,t)||t[0]==="$"&&t.slice(1)in a?!1:(s[t]=n,!0)},has({_:{data:a,setupState:t,accessCache:n,ctx:i,appContext:o,propsOptions:s}},c){let u;return!!n[c]||a!==pr&&ji(a,c)||t!==pr&&ji(t,c)||(u=s[0])&&ji(u,c)||ji(i,c)||ji(Iv,c)||ji(o.config.globalProperties,c)},defineProperty(a,t,n){return n.get!=null?a._.accessCache[t]=0:ji(n,"value")&&this.set(a,t,n.value,null),Reflect.defineProperty(a,t,n)}},z8=eC();let H8=0;function G8(a,t,n){const i=a.type,o=(t?t.appContext:a.appContext)||z8,s={uid:H8++,vnode:a,type:i,parent:t,appContext:o,root:null,next:null,subTree:null,effect:null,update:null,scope:new rF(!0),render:null,proxy:null,exposed:null,exposeProxy:null,withProxy:null,provides:t?t.provides:Object.create(o.provides),accessCache:null,renderCache:[],components:null,directives:null,propsOptions:QT(i,o),emitsOptions:GT(i,o),emit:null,emitted:null,propsDefaults:pr,inheritAttrs:i.inheritAttrs,ctx:pr,data:pr,props:pr,attrs:pr,slots:pr,refs:pr,setupState:pr,setupContext:null,suspense:n,suspenseId:n?n.pendingId:0,asyncDep:null,asyncResolved:!1,isMounted:!1,isUnmounted:!1,isDeactivated:!1,bc:null,c:null,bm:null,m:null,bu:null,u:null,um:null,bum:null,da:null,a:null,rtg:null,rtc:null,ec:null,sp:null};return s.ctx={_:s},s.root=t?t.root:s,s.emit=jF.bind(null,s),a.ce&&a.ce(s),s}let Ms=null;const sd=a=>{Ms=a,a.scope.on()},ih=()=>{Ms&&Ms.scope.off(),Ms=null};function aC(a){return a.vnode.shapeFlag&4}let fm=!1;function V8(a,t=!1){fm=t;const{props:n,children:i}=a.vnode,o=aC(a);x8(a,n,o,t),_8(a,i);const s=o?W8(a,t):void 0;return fm=!1,s}function W8(a,t){const n=a.type;a.accessCache=Object.create(null),a.proxy=LT(new Proxy(a.ctx,k8));const{setup:i}=n;if(i){const o=a.setupContext=i.length>1?X8(a):null;sd(a),Dd();const s=Oc(i,a,0,[a.props,o]);if(Bd(),ih(),dT(s)){if(s.then(ih,ih),t)return s.then(c=>{D2(a,c,t)}).catch(c=>{ny(c,a,0)});a.asyncDep=s}else D2(a,s,t)}else lC(a,t)}function D2(a,t,n){Pi(t)?a.type.__ssrInlineRender?a.ssrRender=t:a.render=t:Jr(t)&&(a.setupState=DT(t)),lC(a,n)}let B2;function lC(a,t,n){const i=a.type;if(!a.render){if(!t&&B2&&!i.render){const o=i.template;if(o){const{isCustomElement:s,compilerOptions:c}=a.appContext.config,{delimiters:u,compilerOptions:h}=i,f=Js(Js({isCustomElement:s,delimiters:u},c),h);i.render=B2(o,f)}}a.render=i.render||da}sd(a),Dd(),p8(a),Bd(),ih()}function j8(a){return new Proxy(a.attrs,{get(t,n){return Lo(a,"get","$attrs"),t[n]}})}function X8(a){const t=i=>{a.exposed=i||{}};let n;return{get attrs(){return n||(n=j8(a))},slots:a.slots,emit:a.emit,expose:t}}function ay(a){if(a.exposed)return a.exposeProxy||(a.exposeProxy=new Proxy(DT(LT(a.exposed)),{get(t,n){if(n in t)return t[n];if(n in Iv)return Iv[n](a)}}))}function $8(a){return Pi(a)&&a.displayName||a.name}function q8(a){return Pi(a)&&"__vccOpts"in a}const Ys=(a,t)=>kF(a,t,fm),Y8="3.2.33",Q8="http://www.w3.org/2000/svg",Wu=typeof document!="undefined"?document:null,F2=Wu&&Wu.createElement("template"),K8={insert:(a,t,n)=>{t.insertBefore(a,n||null)},remove:a=>{const t=a.parentNode;t&&t.removeChild(a)},createElement:(a,t,n,i)=>{const o=t?Wu.createElementNS(Q8,a):Wu.createElement(a,n?{is:n}:void 0);return a==="select"&&i&&i.multiple!=null&&o.setAttribute("multiple",i.multiple),o},createText:a=>Wu.createTextNode(a),createComment:a=>Wu.createComment(a),setText:(a,t)=>{a.nodeValue=t},setElementText:(a,t)=>{a.textContent=t},parentNode:a=>a.parentNode,nextSibling:a=>a.nextSibling,querySelector:a=>Wu.querySelector(a),setScopeId(a,t){a.setAttribute(t,"")},cloneNode(a){const t=a.cloneNode(!0);return"_value"in a&&(t._value=a._value),t},insertStaticContent(a,t,n,i,o,s){const c=n?n.previousSibling:t.lastChild;if(o&&(o===s||o.nextSibling))for(;t.insertBefore(o.cloneNode(!0),n),!(o===s||!(o=o.nextSibling)););else{F2.innerHTML=i?`<svg>${a}</svg>`:a;const u=F2.content;if(i){const h=u.firstChild;for(;h.firstChild;)u.appendChild(h.firstChild);u.removeChild(h)}t.insertBefore(u,n)}return[c?c.nextSibling:t.firstChild,n?n.previousSibling:t.lastChild]}};function Z8(a,t,n){const i=a._vtc;i&&(t=(t?[t,...i]:[...i]).join(" ")),t==null?a.removeAttribute("class"):n?a.setAttribute("class",t):a.className=t}function J8(a,t,n){const i=a.style,o=Zr(n);if(n&&!o){for(const s in n)nb(i,s,n[s]);if(t&&!Zr(t))for(const s in t)n[s]==null&&nb(i,s,"")}else{const s=i.display;o?t!==n&&(i.cssText=n):t&&a.removeAttribute("style"),"_vod"in a&&(i.display=s)}}const N2=/\s*!important$/;function nb(a,t,n){if(bi(n))n.forEach(i=>nb(a,t,i));else if(n==null&&(n=""),t.startsWith("--"))a.setProperty(t,n);else{const i=eN(a,t);N2.test(n)?a.setProperty(Od(i),n.replace(N2,""),"important"):a[i]=n}}const U2=["Webkit","Moz","ms"],Dx={};function eN(a,t){const n=Dx[t];if(n)return n;let i=qa(t);if(i!=="filter"&&i in a)return Dx[t]=i;i=ey(i);for(let o=0;o<U2.length;o++){const s=U2[o]+i;if(s in a)return Dx[t]=s}return t}const k2="http://www.w3.org/1999/xlink";function tN(a,t,n,i,o){if(i&&t.startsWith("xlink:"))n==null?a.removeAttributeNS(k2,t.slice(6,t.length)):a.setAttributeNS(k2,t,n);else{const s=j6(t);n==null||s&&!hT(n)?a.removeAttribute(t):a.setAttribute(t,s?"":n)}}function nN(a,t,n,i,o,s,c){if(t==="innerHTML"||t==="textContent"){i&&c(i,o,s),a[t]=n==null?"":n;return}if(t==="value"&&a.tagName!=="PROGRESS"&&!a.tagName.includes("-")){a._value=n;const h=n==null?"":n;(a.value!==h||a.tagName==="OPTION")&&(a.value=h),n==null&&a.removeAttribute(t);return}let u=!1;if(n===""||n==null){const h=typeof a[t];h==="boolean"?n=hT(n):n==null&&h==="string"?(n="",u=!0):h==="number"&&(n=0,u=!0)}try{a[t]=n}catch{}u&&a.removeAttribute(t)}const[cC,iN]=(()=>{let a=Date.now,t=!1;if(typeof window!="undefined"){Date.now()>document.createEvent("Event").timeStamp&&(a=()=>performance.now());const n=navigator.userAgent.match(/firefox\/(\d+)/i);t=!!(n&&Number(n[1])<=53)}return[a,t]})();let ib=0;const rN=Promise.resolve(),sN=()=>{ib=0},oN=()=>ib||(rN.then(sN),ib=cC());function uC(a,t,n,i){a.addEventListener(t,n,i)}function aN(a,t,n,i){a.removeEventListener(t,n,i)}function lN(a,t,n,i,o=null){const s=a._vei||(a._vei={}),c=s[t];if(i&&c)c.value=i;else{const[u,h]=cN(t);if(i){const f=s[t]=uN(i,o);uC(a,u,f,h)}else c&&(aN(a,u,c,h),s[t]=void 0)}}const z2=/(?:Once|Passive|Capture)$/;function cN(a){let t;if(z2.test(a)){t={};let n;for(;n=a.match(z2);)a=a.slice(0,a.length-n[0].length),t[n[0].toLowerCase()]=!0}return[Od(a.slice(2)),t]}function uN(a,t){const n=i=>{const o=i.timeStamp||cC();(iN||o>=n.attached-1)&&pa(hN(i,n.value),t,5,[i])};return n.value=a,n.attached=oN(),n}function hN(a,t){if(bi(t)){const n=a.stopImmediatePropagation;return a.stopImmediatePropagation=()=>{n.call(a),a._stopped=!0},t.map(i=>o=>!o._stopped&&i&&i(o))}else return t}const H2=/^on[a-z]/,fN=(a,t,n,i,o=!1,s,c,u,h)=>{t==="class"?Z8(a,i,o):t==="style"?J8(a,n,i):Qv(t)?s_(t)||lN(a,t,n,i,c):(t[0]==="."?(t=t.slice(1),!0):t[0]==="^"?(t=t.slice(1),!1):dN(a,t,i,o))?nN(a,t,i,s,c,u,h):(t==="true-value"?a._trueValue=i:t==="false-value"&&(a._falseValue=i),tN(a,t,i,o))};function dN(a,t,n,i){return i?!!(t==="innerHTML"||t==="textContent"||t in a&&H2.test(t)&&Pi(n)):t==="spellcheck"||t==="draggable"||t==="translate"||t==="form"||t==="list"&&a.tagName==="INPUT"||t==="type"&&a.tagName==="TEXTAREA"||H2.test(t)&&Zr(n)?!1:t in a}const G2=a=>{const t=a.props["onUpdate:modelValue"];return bi(t)?n=>hv(t,n):t},pN={deep:!0,created(a,{value:t,modifiers:{number:n}},i){const o=Kv(t);uC(a,"change",()=>{const s=Array.prototype.filter.call(a.options,c=>c.selected).map(c=>n?gT(Ov(c)):Ov(c));a._assign(a.multiple?o?new Set(s):s:s[0])}),a._assign=G2(i)},mounted(a,{value:t}){V2(a,t)},beforeUpdate(a,t,n){a._assign=G2(n)},updated(a,{value:t}){V2(a,t)}};function V2(a,t){const n=a.multiple;if(!(n&&!bi(t)&&!Kv(t))){for(let i=0,o=a.options.length;i<o;i++){const s=a.options[i],c=Ov(s);if(n)bi(t)?s.selected=Q6(t,c)>-1:s.selected=t.has(c);else if(Yv(Ov(s),t)){a.selectedIndex!==i&&(a.selectedIndex=i);return}}!n&&a.selectedIndex!==-1&&(a.selectedIndex=-1)}}function Ov(a){return"_value"in a?a._value:a.value}const mN=["ctrl","shift","alt","meta"],gN={stop:a=>a.stopPropagation(),prevent:a=>a.preventDefault(),self:a=>a.target!==a.currentTarget,ctrl:a=>!a.ctrlKey,shift:a=>!a.shiftKey,alt:a=>!a.altKey,meta:a=>!a.metaKey,left:a=>"button"in a&&a.button!==0,middle:a=>"button"in a&&a.button!==1,right:a=>"button"in a&&a.button!==2,exact:(a,t)=>mN.some(n=>a[`${n}Key`]&&!t.includes(n))},vN=(a,t)=>(n,...i)=>{for(let o=0;o<t.length;o++){const s=gN[t[o]];if(s&&s(n,t))return}return a(n,...i)},yN=Js({patchProp:fN},K8);let W2;function xN(){return W2||(W2=T8(yN))}const AN=(...a)=>{const t=xN().createApp(...a),{mount:n}=t;return t.mount=i=>{const o=bN(i);if(!o)return;const s=t._component;!Pi(s)&&!s.render&&!s.template&&(s.template=o.innerHTML),o.innerHTML="";const c=n(o,!1,o instanceof SVGElement);return o instanceof Element&&(o.removeAttribute("v-cloak"),o.setAttribute("data-v-app","")),c},t};function bN(a){return Zr(a)?document.querySelector(a):a}var _N=`--------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- ---------------
--------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- ---------------
--------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- ---------------
--------------- --------------- --------------- --------------- --------------- --------------- --------------- ------AAA------ -----AAAAA----- -----AAAAA----- -----AAAAA----- -----AAAAA----- -----AAAAA----- ------AAA------ --------------- --------------- --------------- --------------- ---------------
--------------- --------------- --------------- --------------- --------------- --------------- -----AAAAA----- ----AAAAAAA---- ----AAAAAAA---- ----AAAAAAA---- ----AAAAAAA---- ----AAAAAAA---- ----AAAAAAA---- -----AAAAA----- ------AAA------ --------------- --------------- --------------- ---------------
--------------- --------------- --------------- --------------- --------------- -----AAAAA----- ----AAAAAAA---- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ----AAAAAAA---- -----AAAAA----- ------AAA------ --------------- --------------- ---------------
--------------- ------CCC------ --------------- --------------- -----AAAAA----- ----AAAAAAA---- --TAAAAAAAAAT-- --TAAAAAAAAAT-- --TAAAAAAAAAT-- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ----AAAAAAA---- -----AAAAA----- --------------- --------------- ---------------
------EEE------ -----CEEEC----- ------AAA------ -----AAAAA----- ----AAAAAAA---- ---AAAAAAAAA--- --TAAAAAAAAAT-- --SAAAAAAAAAS-- --DAAAAAAAAAD-- --BAAAAAAAAAB-- --BAAAAAAAAAB-- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAKA--- ----AAAAAAA---- -----AAAAA----- --------------- --------------- ---------------
-----EAAAE----- ----CEAAAEC---- -----AAAAA----- ----AAAAAAA---- ---AAAAAAAAA--- ---AAAAAAAAA--- --TAAAAAAAAAT-- --TAAAAAAAAAT-- --TAAAAAAAAAT-- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ----AAAAAAA---- -----AAAAA----- --------------- --------------- ---------------
-----EAAAE----- ----CEAAAEC---- -----AAAAA----- ----AAAAAAA---- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ----AAAAAAA---- -----AAAAA----- --------------- --------------- ---------------
-----EAAAE----- ----CEAAAEC---- -----AAAAA----- ----AAAAAAA---- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ----AAAAAAA---- -----AAAAA----- --------------- --------------- ---------------
------EEE------ -----CEEEC----- ------AAA------ ----AAAAAAA---- ----AAAAAAA---- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ----AAAAAAA---- ------AAA------ --------------- --------------- ---------------
------C-C------ --------------- --------------- -----AAAAA----- ----AAAAAAA---- ----AAAAAAA---- ----AAAAAAA---- ----AAAAAAA---- ----AAAAAAA---- ----AAAAAAA---- ----AAAAAAA---- ----AAAAAAA---- ----AAAAAAA---- ----AAAAAAA---- -----AAAAA----- -------A------- --------------- --------------- ---------------
--------------- --------------- --------------- ------BBB------ -----BBBBB----- ----BBBBBBB---- ----BBBBBBB---- ----ABBBBBA---- ----BBBBBBB---- ----BBBBBBB---- ----BBBBBBB---- ----AAAAAAA---- ----AAAAAAA---- -----AAAAA----- ------AAA------ --------------- --------------- --------------- ---------------
--------------- --------------- --------------- ------BBB------ -----BBBBB----- -----BMMBB----- -----BBBBB----- -----BBBBB----- -----BKBKB----- -----BKBKB----- -----BBBBB----- -----BBABB----- -----AAAAA----- ------AAA------ --------------- --------------- --------------- --------------- ---------------
--------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- ---------------
--------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- ---------------
--------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- ---------------
--------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- ---------------
--------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- ---------------
--------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- ---------------
--------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- ---------------
--------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- ---------------
`,wN=`--------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- ---------------
--------------- -------A------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- ---------------
--------------- ------AAA------ ------AAA------ ------AAA------ ------AAA------ ------AAA------ ------AAA------ -------A------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- ---------------
--------------- -------A------- ------AAA------ ------AAA------ ------AAA------ ------AAA------ -----AAAAA----- -----AAAAA----- -----AAAAA----- -----AAAAA----- -----AAAAA----- -----AAAAA----- -----AAAAA----- ------AAA------ --------------- --------------- --------------- --------------- ---------------
--------------- --------------- -------A------- ------AAA------ ------AAA------ -----AAAAA----- -----AAAAA----- ----AAAAAAA---- ----AAAAAAA---- ----AAAAAAA---- ----AAAAAAA---- ----AAAAAAA---- ----AAAAAAA---- -----AAAAA----- ------AAA------ --------------- --------------- --------------- ---------------
--------------- --------------- --------------- --------------- -----AAAAA----- -----AAAAA----- ----AAAAAAA---- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ----AAAAAAA---- -----AAAAA----- ------AAA------ --------------- --------------- ---------------
--------------- --------------- --------------- ------AAA------ -----AAAAA----- ----AAAAAAA---- --TAAAAAAAAAT-- --TAAAAAAAAAT-- --TAAAAAAAAAT-- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ----AAAAAAA---- -----AAAAA----- --------------- --------------- ---------------
------EEE------ ------EEE------ ------AAA------ -----AAAAA----- ----AAAAAAA---- ---AAAAAAAAA--- --TAAAAAAAAAT-- --SAAAAAAAAAS-- --DAAAAAAAAAD-- --BAAAAAAAAAB-- --BAAAAAAAAAB-- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ----AAAAAAA---- -----AAAAA----- --------------- --------------- ---------------
-----EAAAE----- -----EAAAE----- -----AAAAA----- ----AAAAAAA---- ---AAAAAAAAA--- ---AAAAAAAAA--- --TAAAAAAAAAT-- --TAAAAAAAAAT-- --TAAAAAAAAAT-- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ----AAAAAAA---- -----AAAAA----- --------------- --------------- ---------------
-----EAAAE----- -----EAAAE----- -----AAAAA----- ----AAAAAAA---- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ----AAAAAAA---- -----AAAAA----- --------------- --------------- ---------------
-----EAAAE----- ------EAE------ ------AAA------ ----AAAAAAA---- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ----AAAAAAA---- -----AAAAA----- --------------- --------------- ---------------
-----EAAAE----- ------AAA------ --------------- ----AAAAAAA---- ----AAAAAAA---- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ---AAAAAAAAA--- ----AAAAAAA---- ------AAA------ --------------- --------------- ---------------
-----EEAEE----- --------------- --------------- -----AAAAA----- ----AAAAAAA---- ----AAAAAAA---- ----AAAAAAA---- ----AAAAAAA---- ----AAAAAAA---- ----AAAAAAA---- ----AAAAAAA---- ----AAAAAAA---- ----AAAAAAA---- ----AAAAAAA---- -----AAAAA----- -------A------- --------------- --------------- ---------------
--------------- --------------- --------------- ------BBB------ -----BBBBB----- ----BBBBBBB---- ----BBBBBBB---- ----ABBBBBA---- ----BBBBBBB---- ---ABBBBBBBA--- ----ABBBBBA---- ----AAAAAAA---- ----AAAAAAA---- -----AAAAA----- ------AAA------ --------------- --------------- --------------- ---------------
--------------- --------------- --------------- ------BBB------ -----BBBBB----- -----BMMBB----- -----BBBBB----- -----BBBBB----- -----BKBKB----- ---A-BKBKB-A--- ----ABBBBBA---- -----ABBBA----- -----AAAAA----- ------AAA------ --------------- --------------- --------------- --------------- ---------------
--------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- ----A-----A---- -----A---A----- ------AAA------ --------------- --------------- --------------- --------------- --------------- ---------------
--------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- ---------------
--------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- ---------------
--------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- ---------------
--------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- ---------------
--------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- ---------------
--------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- ---------------
--------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- --------------- ---------------
`,_i={skellyFace:{offset:[5,5,14],dimension:[5,2,1],voxels:`
-B-B- B-B-B`},camoJacket:{offset:[5,0,7],dimension:[5,2,5],voxels:`
 EFG   FGE.
E   F F   G
F   E G   F
G   F F   E
 FGE   EFG `},camoJackette:{offset:[5,0,7],dimension:[5,2,6],voxels:`
 EFG   FGE.
E   F F   G
F   E G   F
G   F E   E
E   F F   F
FE EG      `},solanaJacket:{offset:[5,0,7],dimension:[5,2,5],voxels:`
 VVV   VVV.
V   V V   V
U   U U   U
E   E E   E
 EEE       `},solanaJackette:{offset:[5,0,7],dimension:[5,2,6],voxels:`
 VVV   VVV.
V   V V   V
U   U U   U
U   U U   U
E   E E   E
EE EE      `},shade:{offset:[2,8,7],dimension:[11,3,9],voxels:`
                        H         H
                        H         H
                        H         H
                        H         H
                        H         H
                         H       H.
                         H       H.
    B B                  H       H.
              III III    HIIIHIIIH.`},retro:{offset:[2,8,7],dimension:[11,3,9],voxels:`
                        I         I
                        I         I
                        I         I
                        I         I
                        I         I
                        I         I
             I       I   I       I.
    B B      -I     I-   -I     I-.
              -IIIII-    --IIIII--.`},laser:{offset:[2,8,12],dimension:[11,3,4],voxels:`
 H       H   H       H   H       H.
 H       H   H       H   H       H.
 -H     H-   -I     I-   -H     H-.
 --HHHHH--   --IIIII--   --HHHHH--.`},vape:{offset:[8,5,14],dimension:[1,11,7],voxels:`
J . . . . . . . . . .
J . . . . . . . . . .
J . . . . . . . . . .
J . . . . . . . . . .
J . . . . . . . . . .
L . . . . . . . . . .
. . N . N N . N N N N`},cigarette:{offset:[8,5,14],dimension:[1,11,7],voxels:`
J . . . . . . . . . .
J . . . . . . . . . .
L . . . . . . . . . .
L . . . . . . . . . .
L . . . . . . . . . .
L . . . . . . . . . .
. . N . N N . N N N N`},cigar:{offset:[8,5,14],dimension:[1,11,7],voxels:`
J . . . . . . . . . .
J . . . . . . . . . .
J . . . . . . . . . .
J . . . . . . . . . .
J . . . . . . . . . .
L . . . . . . . . . .
. . N . N N . N N N N`},pipe:{offset:[7,5,14],dimension:[3,11,9],voxels:`
 J   .   .   .   .   .   .   .   .   .   ..
 J   .   .   .   .   .   .   .   .   .   ..
 J   .   .   .   .   .   .   .   .   .   ..
 J   .   .   .   .   .   .   .   .   .   ..
 J   J   .   .   .   .   .   .   .   .   ..
 J   J   .   .   .   .   .   .   .   .   ..
 .   .   .   N   .   .   .   .   N   N   ..
 .   .   .   .   .   N   N   .  NNN NNN  N.
 .   .   .   .   .   .   .   .   N   N    .`},fedora:{offset:[1,13,1],dimension:[13,5,16],voxels:`
----OOOOO---- ------------- ------------- ------------- -------------
---OOOOOOO--- ------------- ------------- ------------- -------------
--OOO   OOO-- -----PPP----- -----OOO----- -----OOO----- ------O------
-OOO     OOO- ----P   P---- ----O   O---- ----OOOOO---- ----OOOOO----
OOO       OOO ---P     P--- ---O     O--- ---OOOOOOO--- ---OO---OO---
OO         OO --P       P-- --O       O-- --OOOOOOOOO-- ---O-OOO-O---
OO         OO --P       P-- --O       O-- --OOOOOOOOO-- ---O-OOO-O---
OO         OO --P       P-- --O       O-- --OOOOOOOOO-- ---O-OOO-O---
OO         OO --P       P-- --O       O-- --OOOOOOOOO-- ---O-OOO-O---
OO         OO --P       P-- --O       O-- --OOOOOOOOO-- ---OO-O-OO---
OO         OO --P       P-- --O       O-- ---OOOOOOO--- ----OO-OO----
OOO       OOO ---P     P--- ---O     O--- ----OOOOO---- -----OOO-----
-OOO     OOO- ----P   P---- ----O   O---- -----OOO----- ------O------
--OOO   OOO-- -----PPP----- -----OOO----- ------O------ -------------
---OOOOOOO--- ------------- ------------- ------------- -------------
----OOOOO---- ------------- ------------- ------------- -------------`},panama:{offset:[0,13,0],dimension:[15,6,18],voxels:`
-----OOOOO----- --------------- --------------- --------------- --------------- ---------------
----OOOOOOO---- --------------- --------------- --------------- --------------- ---------------
---OOOOOOOOO--- --------------- --------------- --------------- --------------- ---------------
--OOOO   OOOO-- ------PPP------ ------OOO------ ------OOO------ --------------- ---------------
-OOOO     OOOO- -----P   P----- -----O   O----- -----O   O----- ------OOO------ ---------------
-OOO       OOO- ----P     P---- ----O     O---- ----O     O---- -----OOOOO----- ------OOO------
OOO         OOO ---P       P--- ---O       O--- ---O       O--- ----OOOOOOO---- -----OOOOO-----
OOO         OOO ---Q       P--- ---O       O--- ---R       O--- ----OOOOOOO---- -----OOOOO-----
OOO         OOO ---Q       P--- ---R       O--- ---O       O--- ----OOOOOOO---- -----OOOOO-----
OOO         OOO ---P       P--- ---O       O--- ---O       O--- ----OOOOOOO---- -----OOOOO-----
OOO         OOO ---P       P--- ---O       O--- ---O       O--- ----OOOOOOO---- -----OOOOO-----
OOO         OOO ---P       P--- ---O       O--- ---O       O--- ----OOOOOOO---- -----OOOOO-----
-OOO       OOO- ----P     P---- ----O     O---- ----O     O---- -----OOOOO----- ------OOO------
-OOOO     OOOO- -----P   P----- -----O   O----- -----O   O----- ------OOO------ ---------------
--OOOO   OOOO-- ------PPP------ ------OOO------ ------OOO------ --------------- ---------------
---OOOOOOOOO--- --------------- --------------- --------------- --------------- ---------------
----OOOOOOO---- --------------- --------------- --------------- --------------- ---------------
-----OOOOO----- --------------- --------------- --------------- --------------- ---------------`},solanama:{offset:[0,13,0],dimension:[15,6,18],voxels:`
-----OOOOO----- --------------- --------------- --------------- --------------- ---------------
----OOOOOOO---- --------------- --------------- --------------- --------------- ---------------
---OOOOOOOOO--- --------------- --------------- --------------- --------------- ---------------
--OOOO   OOOO-- ------PPP------ ------RRR------ ------RRR------ --------------- ---------------
-OOOO     OOOO- -----P   P----- -----R   R----- -----R   R----- ------RRR------ ---------------
-OOO       OOO- ----P     P---- ----R     R---- ----R     R---- -----RRRRR----- ------RRR------
OOO         OOO ---P       P--- ---R       R--- ---R       R--- ----RRRRRRR---- -----RRRRR-----
OOO         OOO ---Q       P--- ---R       R--- ---R       R--- ----RRRRRRR---- -----RRRRR-----
OOO         OOO ---Q       P--- ---R       R--- ---R       R--- ----RRRRRRR---- -----RRRRR-----
OOO         OOO ---P       P--- ---R       R--- ---R       R--- ----RRRRRRR---- -----RRRRR-----
OOO         OOO ---P       P--- ---R       R--- ---R       R--- ----RRRRRRR---- -----RRRRR-----
OOO         OOO ---P       P--- ---R       R--- ---R       R--- ----RRRRRRR---- -----RRRRR-----
-OOO       OOO- ----P     P---- ----R     R---- ----R     R---- -----RRRRR----- ------RRR------
-OOOO     OOOO- -----P   P----- -----R   R----- -----R   R----- ------RRR------ ---------------
--OOOO   OOOO-- ------PPP------ ------RRR------ ------RRR------ --------------- ---------------
---OOOOOOOOO--- --------------- --------------- --------------- --------------- ---------------
----OOOOOOO---- --------------- --------------- --------------- --------------- ---------------
-----OOOOO----- --------------- --------------- --------------- --------------- ---------------`},boater:{offset:[1,13,1],dimension:[13,4,16],voxels:`
----OOOOO---- ------------- ------------- -------------
---OOOOOOO--- ------------- ------------- -------------
--OOO   OOO-- -----PPP----- -----OOO----- -----OOO-----
-OOO     OOO- ----P   P---- ----O   O---- ----OOOOO----
OOO       OOO ---P     P--- ---O     O--- ---OOOOOOO---
OO         OO --P       P-- --O       O-- --OOOOOOOOO--
OO         OO --P       P-- --O       O-- --OOOOOOOOO--
OO         OO --P       P-- --O       O-- --OOOOOOOOO--
OO         OO --P       P-- --O       O-- --OOOOOOOOO--
OO         OO --P       P-- --O       O-- --OOOOOOOOO--
OO         OO --P       P-- --O       O-- --OOOOOOOOO--
OOO       OOO ---P     P--- ---O     O--- ---OOOOOOO---
-OOO     OOO- ----P   P---- ----O   O---- ----OOOOO----
--OOO   OOO-- -----PPP----- -----OOO----- -----OOO-----
---OOOOOOO--- ------------- ------------- -------------
----OOOOO---- ------------- ------------- -------------`},beanie:{offset:[2,12,2],dimension:[11,5,14],voxels:`
---OOOOO--- ---OOOOO--- ----------- ----------- -----------
--O     O-- --O     O-- ----PPP---- ----------- -----------
-O       O- -O       O- ---P   P--- ----PPP---- -----------
O         O O         O --P     P-- ---P   P--- ----PPP----
O         O O         O -P       P- --P     P-- ---PPPPP---
O         O O         O -P       P- --P     P-- ---PPPPP---
O         O O         O -P       P- --P     P-- ---PPPPP---
O         O O         O -P       P- --P     P-- ---PPPPP---
O         O O         O -P       P- --P     P-- ---PPPPP---
O         O O         O -P       P- --P     P-- ---PPPPP---
-O       O- -O       O- --P     P-- ---P   P--- ----PPP----
-O       O- -O       O- ---P   P--- ----PPP---- -----------
--O     O-- --O     O-- ----PPP---- ----------- -----------
---OOOOO--- ---OOOOO--- ----------- ----------- -----------`},cap:{offset:[3,12,3],dimension:[9,5,16],voxels:`
--OQPOP-- --QOOPO-- ---PQP--- --------- ---------
-Q     Q- -O     P- --Q   O-- ---OPP--- ---------
P       O Q       P -P     Q- --PP OP-- ----O----
Q       P O       O O       P -OO   PO- ---PPO---
P       O Q       Q P       P -PQ   OP- ---QOP---
O       Q P       P Q       O -PO   OO- ---OQO---
Q       P O       O O       P -OP   QP- ---POP---
O       O P       P O       Q -PO   OQ- ---OPQ---
P       P Q       Q -P     P- --O   P-- ---QOO---
Q       O -P     P- -Q     Q- --PP OO-- ----O----
P       Q -Q     O- --O   O-- ---OPQ--- ---------
OP     PO --OPPOQ-- ---QOP--- --------- ---------
PQOQOPOQP --------- --------- --------- ---------
-OQOPOQP- --------- --------- --------- ---------
--QPQPO-- --------- --------- --------- ---------
---OPQ--- --------- --------- --------- ---------`},capBackwards:{offset:[3,12,0],dimension:[9,5,16],voxels:`
   QPO                                          .
  OPOPQ                                         .
 PQOPOQO                                        .
QPOPPOPQP --QOOPO-- ---PQP--- --------- ---------
OQ     QO -O     P- --O   O-- ---OPP--- ---------
P       O Q       P -P     Q- --PP OP-- ----O----
O       P P       O O       P -OO   PO- ---PPO---
P       O O       P P       P -PQ   OP- ---QOP---
O       Q P       P Q       O -PO   OO- ---OQO---
Q       P O       O O       P -OP   QP- ---POP---
O       O P       P O       Q -PO   OQ- ---OPQ---
P       P Q       Q -P     P- --O   P-- ---QOO---
 Q     O  -P     P- -Q     Q- --PP OO-- ----O----
 P     Q  -O     O- --O   O-- ---OPQ--- ---------
  POPPO   --OPQOP-- ---QOP--- --------- ---------
          --------- --------- --------- ---------`},solanaCap:{offset:[3,12,3],dimension:[9,5,16],voxels:`
--QQQQQ-- --QQQQQ-- ---QQQ--- --------- ---------
-Q     Q- -Q     Q- --Q   Q-- ---QQQ--- ---------
Q       Q Q       Q -Q     Q- --QQ QQ-- ----Q----
Q       Q Q       Q Q       Q -QQ   QQ- ---QQQ---
Q       Q Q       Q Q       Q -QQ   QQ- ---QQQ---
Q       Q Q       Q P       P -PP   PP- ---PPP---
Q       Q P       P P       P -PP   PP- ---PPP---
P       P P       P P       P -PP   PP- ---PPP---
P       P P       P -P     P- --P   P-- ---PPP---
O       O -P     P- -P     P- --PP PP-- ----P----
O       O -P     P- --P   P-- ---PPP--- ---------
OO     OO --PPPPP-- ---PPP--- --------- ---------
OOOOOOOOO --------- --------- --------- ---------
-OOOOOOO- --------- --------- --------- ---------
--OOOOO-- --------- --------- --------- ---------
---OOO--- --------- --------- --------- ---------`},solanaCapBackwards:{offset:[3,12,0],dimension:[9,5,16],voxels:`
   OOO                                          .
  OOOOO                                         .
 OOOOOOO                                        .
OOOOOOOOO --QQQQQ-- ---QQQ--- --------- ---------
OO     OO -Q     Q- --Q   Q-- ---QQQ--- ---------
O       O Q       Q -Q     Q- --QQ QQ-- ----Q----
O       O Q       Q Q       Q -QQ   QQ- ---QQQ---
Q       Q Q       Q Q       Q -QQ   QQ- ---QQQ---
Q       Q Q       Q P       P -PP   PP- ---PPP---
Q       Q P       P P       P -PP   PP- ---PPP---
P       P P       P P       P -PP   PP- ---PPP---
P       P P       P -P     P- --P   P-- ---PPP---
 P     P  -P     P- -P     P- --PP PP-- ----P----
 P     P  -P     P- --P   P-- ---PPP--- ---------
  PPPPP   --PPPPP-- ---PPP--- --------- ---------
          --------- --------- --------- ---------`}},EN="#050505",Bx="#A8AF70",j2="#054E12",X2="#40321E",MN="#2B2925",SN="#4B4945",TN="#6E6971",$2="#D4AF37",q2="#BFBFBF",Y2="#B08D57",yg="#00FEC2",Fx="#01E8EC",Nx="#FA67FF",En={BLACK:EN,CAMO1:Bx,CAMO2:j2,CAMO3:X2,BLACK_FRAME:MN,LASER_FRAME:SN,SMOKE:TN,GOLD:$2,SILVER:q2,BRONZE:Y2,SOLANA1:yg,SOLANA2:Fx,SOLANA3:Nx,face:{normal:"#EAAE75",zombie:"#30B17B",skelly:"#B6CAD7"},fur:{dark:"#3B3A3A",lbrown:"#825039",brown:"#442623",red:"#A7392C",purple:"#76428B",pink:"#CF657F",zombie:"#227A56",skelly:"#92A4AD",albino:"#FFF1D8"},clothing:{None:null,"Blue Shirt":"#0A5EF2","Blue Dress":"#0E879F","Red Shirt":"#C83C3C","Yellow Shirt":"#F8F298","Green Shirt":"#82C774","Pink Shirt":"#E46B88","Beige Shirt":"#ECC299","Camo Jacket":Bx,"Purple Suit":"#824099","Black Suit":"#333333","White Suit":"#FEFFFE","Solana Jacket":yg},shades:{purple:"#76398E",blue:"#048DB2",pink:"#EE3667",retro:"#03FFC2",bluelaser:"#38C4ED",redlaser:"#EC2025",greenlaser:"#87C540"},smoking:{vape1:"#585752",vape2:"#0C66F0",cigarette1:"#BF5D1E",cigarette2:"#D1D0D0",pipe:"#6F422A",cigar1:"#764934",cigar2:"#C43C17"},hats:{orange:["#A44323","#DC5726"],black:["#1B1C1C","#333333"],pink:["#914659","#E46B88"],blackCap:["#333333","#333333","#333333"],redCap:["#C83D3C","#C83D3C","#C83D3C"],blueCap:["#0B5EF4","#0B5EF4","#0B5EF4"],cyanCap:["#0E879F","#0E879F","#0E879F"],greenCap:["#82C774","#82C774","#82C774"],yellowCap:["#F8F298","#F8F298","#F8F298"],camo:[Bx,j2,X2],solana:[yg,Fx,Nx],blackFedora:["#333333","#FEFEFE"],purpleFedora:["#824099","#F3B93A"],pinkFedora:["#E46B88","#F9BE35"],whiteFedora:["#E2E2E3","#F3B93A"],boater:["#EBC175","#FEFEFE"],panama:["#ECC299","#663A32","#C0C0C0","#AD3232"],solanama:[yg,Nx,"#C0C0C0",Fx]},backgrounds:{"Pale Green":"#7CE3B6",Blue:"#7AD2E2",Pink:"#F68C99",Orchid:"#A7A4E5",Lime:"#B2EA8B",Yellow:"#FEFE9C"},mouth:{None:null,Gold:$2,Silver:q2,Bronze:Y2,Bubblegum:"#E56B8A",Red:"#9C1C1E",Esmeralda:"#76428B",Frost:"#81CED0",Autumn:"#F26723","Blue Blood":"#114767",Venom:"#086B37"},earrings:{None:null,Gold:null,Silver:null,"Blue Topaz":"#64BFDE",Amethyst:"#8F68AC",Emerald:"#5DBD76",Hoops:null,Diamond:"#BFE6F4"}},Q2={Brown:{furColor:En.fur.brown},"Light Brown":{furColor:En.fur.lbrown},Dark:{furColor:En.fur.dark},Red:{furColor:En.fur.red},Purple:{furColor:En.fur.purple},Pink:{furColor:En.fur.pink},Zombie:{furColor:En.fur.zombie,faceColor:En.face.zombie},Skeleton:{furColor:En.fur.skelly,faceColor:En.face.skelly,addon:_i.skellyFace},Albino:{furColor:En.fur.albino}},K2={None:{},Black:{addon:_i.shade,lensColor:En.BLACK_FRAME,lensEmission:.1},Purple:{addon:_i.shade,lensColor:En.shades.purple},Blue:{addon:_i.shade,lensColor:En.shades.blue},Pink:{addon:_i.shade,lensColor:En.shades.pink},Retro:{addon:_i.retro,lensColor:En.shades.retro},"Blue Laser":{addon:_i.laser,lensColor:En.shades.bluelaser,lensEmission:1,frameColor:En.LASER_FRAME},"Red Laser":{addon:_i.laser,lensColor:En.shades.redlaser,lensEmission:1,frameColor:En.LASER_FRAME},"Green Laser":{addon:_i.laser,lensColor:En.shades.greenlaser,lensEmission:1,frameColor:En.LASER_FRAME},Bronze:{addon:_i.shade,lensColor:En.BRONZE,frameColor:En.BRONZE,lensEmission:.2},Silver:{addon:_i.shade,lensColor:En.SILVER,frameColor:En.SILVER,lensEmission:.2},Gold:{addon:_i.shade,lensColor:En.GOLD,frameColor:En.GOLD,lensEmission:.2}},Z2={None:{},Vape:{smoking1Color:En.smoking.vape1,smoking2Color:En.smoking.vape2,smokingEmission:1,addon:_i.vape},Cigarette:{smoking1Color:En.smoking.cigarette1,smoking2Color:En.smoking.cigarette2,addon:_i.cigarette},Pipe:{smoking1Color:En.smoking.pipe,addon:_i.pipe},Cigar:{smoking1Color:En.smoking.cigar1,smoking2Color:En.smoking.cigar2,smokingEmission:1,addon:_i.cigar}},J2={None:{},"Orange Beanie":{color:En.hats.orange,addon:_i.beanie},"Black Beanie":{color:En.hats.black,addon:_i.beanie},"Pink Beanie":{color:En.hats.pink,addon:_i.beanie},"Black Cap":{color:En.hats.blackCap,addon:_i.cap},"Black Cap Backwards":{color:En.hats.blackCap,addon:_i.capBackwards},"Red Cap":{color:En.hats.redCap,addon:_i.cap},"Red Cap Backwards":{color:En.hats.redCap,addon:_i.capBackwards},"Blue Cap":{color:En.hats.blueCap,addon:_i.cap},"Blue Cap Backwards":{color:En.hats.blueCap,addon:_i.capBackwards},"Cyan Cap":{color:En.hats.cyanCap,addon:_i.cap},"Cyan Cap Backwards":{color:En.hats.cyanCap,addon:_i.capBackwards},"Yellow Cap":{color:En.hats.yellowCap,addon:_i.cap},"Yellow Cap Backwards":{color:En.hats.yellowCap,addon:_i.capBackwards},"Green Cap":{color:En.hats.greenCap,addon:_i.cap},"Green Cap Backwards":{color:En.hats.greenCap,addon:_i.capBackwards},"Camo Cap":{color:En.hats.camo,addon:_i.cap},"Camo Cap Backwards":{color:En.hats.camo,addon:_i.capBackwards},"Solana Cap":{color:En.hats.solana,addon:_i.solanaCap},"Solana Cap Backwards":{color:En.hats.solana,addon:_i.solanaCapBackwards},"White Fedora":{color:En.hats.whiteFedora,addon:_i.fedora},"Purple Fedora":{color:En.hats.purpleFedora,addon:_i.fedora},"Pink Fedora":{color:En.hats.pinkFedora,addon:_i.fedora},"Black Fedora":{color:En.hats.blackFedora,addon:_i.fedora},Boater:{color:En.hats.boater,addon:_i.boater},"Panama Hat":{color:En.hats.panama,addon:_i.panama},"Solana Panama Hat":{color:En.hats.solanama,addon:_i.solanama}},eS={None:{},Gold:{base:"Gold"},Silver:{base:"Silver"},Bronze:{base:"Bronze"},"Gold Bar":{base:"Gold",dangle:"Gold"},"Blue Topaz":{base:"Gold",dangle:En.earrings["Blue Topaz"],bling:!0},Amethyst:{base:"Gold",dangle:En.earrings.Amethyst,bling:!0},Emerald:{base:"Gold",dangle:En.earrings.Emerald,bling:!0},Hoops:{base:"Gold",hoops:"Gold"},Diamond:{base:"Gold",dangle:En.earrings.Diamond,bling:!0}},Sc={defaults:{family:"Bananos",gender:"Monkie",types:"Brown",chain:"None",earrings:"None",mouth:"None",clothing:"None",shades:"None",smoking:"None",hats:"None",background:"Pale Green"},opts:{family:["Bananos","Orangutanos","Chimplinos"],gender:["Monkie","Monkette"],types:Object.keys(Q2),chain:["None","Bronze","Silver","Gold"],earrings:Object.keys(eS),mouth:Object.keys(En.mouth),clothing:Object.keys(En.clothing),shades:Object.keys(K2),smoking:Object.keys(Z2),hats:Object.keys(J2),background:Object.keys(En.backgrounds)},randomize(a){for(const t in a){const n=this.opts[t];a[t]=n[Math.floor(Math.random()*n.length)]}},createModel(a){var t={};return t.family=a.family,t.gender=a.gender,t.background=a.background,t.hair=Q2[a.types],t.shades=K2[a.shades],t.smoking=Z2[a.smoking],t.hats=J2[a.hats],t.chain=a.chain,t.earrings=eS[a.earrings],t.mouth=a.mouth,t.mouthColor=En.mouth[a.mouth],t.clothing=a.clothing,t.clothingAddon=t.clothing==="Camo Jacket"?t.gender==="Monkette"?_i.camoJackette:_i.camoJacket:t.clothing==="Solana Jacket"?t.gender==="Monkette"?_i.solanaJackette:_i.solanaJacket:null,t}},Tr=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function ly(a){if(a.__esModule)return a;var t=Object.defineProperty({},"__esModule",{value:!0});return Object.keys(a).forEach(function(n){var i=Object.getOwnPropertyDescriptor(a,n);Object.defineProperty(t,n,i.get?i:{enumerable:!0,get:function(){return a[n]}})}),t}function $p(a){throw new Error('Could not dynamically require "'+a+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var CN={exports:{}};(function(a,t){(function(n){a.exports=n()})(function(){return function(){function n(i,o,s){function c(f,p){if(!o[f]){if(!i[f]){var m=typeof $p=="function"&&$p;if(!p&&m)return m(f,!0);if(u)return u(f,!0);var y=new Error("Cannot find module '"+f+"'");throw y.code="MODULE_NOT_FOUND",y}var g=o[f]={exports:{}};i[f][0].call(g.exports,function(_){var x=i[f][1][_];return c(x||_)},g,g.exports,n,i,o,s)}return o[f].exports}for(var u=typeof $p=="function"&&$p,h=0;h<s.length;h++)c(s[h]);return c}return n}()({1:[function(n,i,o){var s=Object.prototype.toString;i.exports=c;function c(u){return u.BYTES_PER_ELEMENT&&s.call(u.buffer)==="[object ArrayBuffer]"||Array.isArray(u)}},{}],2:[function(n,i,o){i.exports=function(c,u){return typeof c=="number"?c:typeof u=="number"?u:0}},{}],3:[function(n,i,o){o.byteLength=y,o.toByteArray=_,o.fromByteArray=E;for(var s=[],c=[],u=typeof Uint8Array!="undefined"?Uint8Array:Array,h="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",f=0,p=h.length;f<p;++f)s[f]=h[f],c[h.charCodeAt(f)]=f;c["-".charCodeAt(0)]=62,c["_".charCodeAt(0)]=63;function m(T){var P=T.length;if(P%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var D=T.indexOf("=");D===-1&&(D=P);var F=D===P?0:4-D%4;return[D,F]}function y(T){var P=m(T),D=P[0],F=P[1];return(D+F)*3/4-F}function g(T,P,D){return(P+D)*3/4-D}function _(T){for(var P,D=m(T),F=D[0],k=D[1],W=new u(g(T,F,k)),j=0,J=k>0?F-4:F,de=0;de<J;de+=4)P=c[T.charCodeAt(de)]<<18|c[T.charCodeAt(de+1)]<<12|c[T.charCodeAt(de+2)]<<6|c[T.charCodeAt(de+3)],W[j++]=P>>16&255,W[j++]=P>>8&255,W[j++]=P&255;return k===2&&(P=c[T.charCodeAt(de)]<<2|c[T.charCodeAt(de+1)]>>4,W[j++]=P&255),k===1&&(P=c[T.charCodeAt(de)]<<10|c[T.charCodeAt(de+1)]<<4|c[T.charCodeAt(de+2)]>>2,W[j++]=P>>8&255,W[j++]=P&255),W}function x(T){return s[T>>18&63]+s[T>>12&63]+s[T>>6&63]+s[T&63]}function b(T,P,D){for(var F,k=[],W=P;W<D;W+=3)F=(T[W]<<16&16711680)+(T[W+1]<<8&65280)+(T[W+2]&255),k.push(x(F));return k.join("")}function E(T){for(var P,D=T.length,F=D%3,k=[],W=16383,j=0,J=D-F;j<J;j+=W)k.push(b(T,j,j+W>J?J:j+W));return F===1?(P=T[D-1],k.push(s[P>>2]+s[P<<4&63]+"==")):F===2&&(P=(T[D-2]<<8)+T[D-1],k.push(s[P>>10]+s[P>>4&63]+s[P<<2&63]+"=")),k.join("")}},{}],4:[function(n,i,o){i.exports={createLink:function(s,c){var u=document.head||document.getElementsByTagName("head")[0],h=document.createElement("link");h.href=s,h.rel="stylesheet";for(var f in c)if(!!c.hasOwnProperty(f)){var p=c[f];h.setAttribute("data-"+f,p)}u.appendChild(h)},createStyle:function(s,c){var u=document.head||document.getElementsByTagName("head")[0],h=document.createElement("style");h.type="text/css";for(var f in c)if(!!c.hasOwnProperty(f)){var p=c[f];h.setAttribute("data-"+f,p)}h.sheet?(h.innerHTML=s,h.sheet.cssText=s,u.appendChild(h)):h.styleSheet?(u.appendChild(h),h.styleSheet.cssText=s):(h.appendChild(document.createTextNode(s)),u.appendChild(h))}}},{}],5:[function(n,i,o){var s=n("buffer").Buffer;i.exports=function(c,u){if(!!s.isBuffer(c)&&!!s.isBuffer(u)){if(typeof c.equals=="function")return c.equals(u);if(c.length!==u.length)return!1;for(var h=0;h<c.length;h++)if(c[h]!==u[h])return!1;return!0}}},{buffer:6}],6:[function(n,i,o){(function(s,g){var u=n("base64-js"),h=n("ieee754"),f=n("isarray");o.Buffer=g,o.SlowBuffer=W,o.INSPECT_MAX_BYTES=50,g.TYPED_ARRAY_SUPPORT=s.TYPED_ARRAY_SUPPORT!==void 0?s.TYPED_ARRAY_SUPPORT:p(),o.kMaxLength=m();function p(){try{var ie=new Uint8Array(1);return ie.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},ie.foo()===42&&typeof ie.subarray=="function"&&ie.subarray(1,1).byteLength===0}catch{return!1}}function m(){return g.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function y(ie,V){if(m()<V)throw new RangeError("Invalid typed array length");return g.TYPED_ARRAY_SUPPORT?(ie=new Uint8Array(V),ie.__proto__=g.prototype):(ie===null&&(ie=new g(V)),ie.length=V),ie}function g(ie,V,Z){if(!g.TYPED_ARRAY_SUPPORT&&!(this instanceof g))return new g(ie,V,Z);if(typeof ie=="number"){if(typeof V=="string")throw new Error("If encoding is specified then the first argument must be a string");return E(this,ie)}return _(this,ie,V,Z)}g.poolSize=8192,g._augment=function(ie){return ie.__proto__=g.prototype,ie};function _(ie,V,Z,B){if(typeof V=="number")throw new TypeError('"value" argument must not be a number');return typeof ArrayBuffer!="undefined"&&V instanceof ArrayBuffer?D(ie,V,Z,B):typeof V=="string"?T(ie,V,Z):F(ie,V)}g.from=function(ie,V,Z){return _(null,ie,V,Z)},g.TYPED_ARRAY_SUPPORT&&(g.prototype.__proto__=Uint8Array.prototype,g.__proto__=Uint8Array,typeof Symbol!="undefined"&&Symbol.species&&g[Symbol.species]===g&&Object.defineProperty(g,Symbol.species,{value:null,configurable:!0}));function x(ie){if(typeof ie!="number")throw new TypeError('"size" argument must be a number');if(ie<0)throw new RangeError('"size" argument must not be negative')}function b(ie,V,Z,B){return x(V),V<=0?y(ie,V):Z!==void 0?typeof B=="string"?y(ie,V).fill(Z,B):y(ie,V).fill(Z):y(ie,V)}g.alloc=function(ie,V,Z){return b(null,ie,V,Z)};function E(ie,V){if(x(V),ie=y(ie,V<0?0:k(V)|0),!g.TYPED_ARRAY_SUPPORT)for(var Z=0;Z<V;++Z)ie[Z]=0;return ie}g.allocUnsafe=function(ie){return E(null,ie)},g.allocUnsafeSlow=function(ie){return E(null,ie)};function T(ie,V,Z){if((typeof Z!="string"||Z==="")&&(Z="utf8"),!g.isEncoding(Z))throw new TypeError('"encoding" must be a valid string encoding');var B=j(V,Z)|0;ie=y(ie,B);var S=ie.write(V,Z);return S!==B&&(ie=ie.slice(0,S)),ie}function P(ie,V){var Z=V.length<0?0:k(V.length)|0;ie=y(ie,Z);for(var B=0;B<Z;B+=1)ie[B]=V[B]&255;return ie}function D(ie,V,Z,B){if(V.byteLength,Z<0||V.byteLength<Z)throw new RangeError("'offset' is out of bounds");if(V.byteLength<Z+(B||0))throw new RangeError("'length' is out of bounds");return Z===void 0&&B===void 0?V=new Uint8Array(V):B===void 0?V=new Uint8Array(V,Z):V=new Uint8Array(V,Z,B),g.TYPED_ARRAY_SUPPORT?(ie=V,ie.__proto__=g.prototype):ie=P(ie,V),ie}function F(ie,V){if(g.isBuffer(V)){var Z=k(V.length)|0;return ie=y(ie,Z),ie.length===0||V.copy(ie,0,0,Z),ie}if(V){if(typeof ArrayBuffer!="undefined"&&V.buffer instanceof ArrayBuffer||"length"in V)return typeof V.length!="number"||he(V.length)?y(ie,0):P(ie,V);if(V.type==="Buffer"&&f(V.data))return P(ie,V.data)}throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}function k(ie){if(ie>=m())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+m().toString(16)+" bytes");return ie|0}function W(ie){return+ie!=ie&&(ie=0),g.alloc(+ie)}g.isBuffer=function(V){return!!(V!=null&&V._isBuffer)},g.compare=function(V,Z){if(!g.isBuffer(V)||!g.isBuffer(Z))throw new TypeError("Arguments must be Buffers");if(V===Z)return 0;for(var B=V.length,S=Z.length,R=0,X=Math.min(B,S);R<X;++R)if(V[R]!==Z[R]){B=V[R],S=Z[R];break}return B<S?-1:S<B?1:0},g.isEncoding=function(V){switch(String(V).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},g.concat=function(V,Z){if(!f(V))throw new TypeError('"list" argument must be an Array of Buffers');if(V.length===0)return g.alloc(0);var B;if(Z===void 0)for(Z=0,B=0;B<V.length;++B)Z+=V[B].length;var S=g.allocUnsafe(Z),R=0;for(B=0;B<V.length;++B){var X=V[B];if(!g.isBuffer(X))throw new TypeError('"list" argument must be an Array of Buffers');X.copy(S,R),R+=X.length}return S};function j(ie,V){if(g.isBuffer(ie))return ie.length;if(typeof ArrayBuffer!="undefined"&&typeof ArrayBuffer.isView=="function"&&(ArrayBuffer.isView(ie)||ie instanceof ArrayBuffer))return ie.byteLength;typeof ie!="string"&&(ie=""+ie);var Z=ie.length;if(Z===0)return 0;for(var B=!1;;)switch(V){case"ascii":case"latin1":case"binary":return Z;case"utf8":case"utf-8":case void 0:return _e(ie).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Z*2;case"hex":return Z>>>1;case"base64":return Le(ie).length;default:if(B)return _e(ie).length;V=(""+V).toLowerCase(),B=!0}}g.byteLength=j;function J(ie,V,Z){var B=!1;if((V===void 0||V<0)&&(V=0),V>this.length||((Z===void 0||Z>this.length)&&(Z=this.length),Z<=0)||(Z>>>=0,V>>>=0,Z<=V))return"";for(ie||(ie="utf8");;)switch(ie){case"hex":return ge(this,V,Z);case"utf8":case"utf-8":return G(this,V,Z);case"ascii":return we(this,V,Z);case"latin1":case"binary":return Ke(this,V,Z);case"base64":return Q(this,V,Z);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return me(this,V,Z);default:if(B)throw new TypeError("Unknown encoding: "+ie);ie=(ie+"").toLowerCase(),B=!0}}g.prototype._isBuffer=!0;function de(ie,V,Z){var B=ie[V];ie[V]=ie[Z],ie[Z]=B}g.prototype.swap16=function(){var V=this.length;if(V%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var Z=0;Z<V;Z+=2)de(this,Z,Z+1);return this},g.prototype.swap32=function(){var V=this.length;if(V%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var Z=0;Z<V;Z+=4)de(this,Z,Z+3),de(this,Z+1,Z+2);return this},g.prototype.swap64=function(){var V=this.length;if(V%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var Z=0;Z<V;Z+=8)de(this,Z,Z+7),de(this,Z+1,Z+6),de(this,Z+2,Z+5),de(this,Z+3,Z+4);return this},g.prototype.toString=function(){var V=this.length|0;return V===0?"":arguments.length===0?G(this,0,V):J.apply(this,arguments)},g.prototype.equals=function(V){if(!g.isBuffer(V))throw new TypeError("Argument must be a Buffer");return this===V?!0:g.compare(this,V)===0},g.prototype.inspect=function(){var V="",Z=o.INSPECT_MAX_BYTES;return this.length>0&&(V=this.toString("hex",0,Z).match(/.{2}/g).join(" "),this.length>Z&&(V+=" ... ")),"<Buffer "+V+">"},g.prototype.compare=function(V,Z,B,S,R){if(!g.isBuffer(V))throw new TypeError("Argument must be a Buffer");if(Z===void 0&&(Z=0),B===void 0&&(B=V?V.length:0),S===void 0&&(S=0),R===void 0&&(R=this.length),Z<0||B>V.length||S<0||R>this.length)throw new RangeError("out of range index");if(S>=R&&Z>=B)return 0;if(S>=R)return-1;if(Z>=B)return 1;if(Z>>>=0,B>>>=0,S>>>=0,R>>>=0,this===V)return 0;for(var X=R-S,xe=B-Z,Ie=Math.min(X,xe),ye=this.slice(S,R),nt=V.slice(Z,B),at=0;at<Ie;++at)if(ye[at]!==nt[at]){X=ye[at],xe=nt[at];break}return X<xe?-1:xe<X?1:0};function te(ie,V,Z,B,S){if(ie.length===0)return-1;if(typeof Z=="string"?(B=Z,Z=0):Z>2147483647?Z=2147483647:Z<-2147483648&&(Z=-2147483648),Z=+Z,isNaN(Z)&&(Z=S?0:ie.length-1),Z<0&&(Z=ie.length+Z),Z>=ie.length){if(S)return-1;Z=ie.length-1}else if(Z<0)if(S)Z=0;else return-1;if(typeof V=="string"&&(V=g.from(V,B)),g.isBuffer(V))return V.length===0?-1:N(ie,V,Z,B,S);if(typeof V=="number")return V=V&255,g.TYPED_ARRAY_SUPPORT&&typeof Uint8Array.prototype.indexOf=="function"?S?Uint8Array.prototype.indexOf.call(ie,V,Z):Uint8Array.prototype.lastIndexOf.call(ie,V,Z):N(ie,[V],Z,B,S);throw new TypeError("val must be string, number or Buffer")}function N(ie,V,Z,B,S){var R=1,X=ie.length,xe=V.length;if(B!==void 0&&(B=String(B).toLowerCase(),B==="ucs2"||B==="ucs-2"||B==="utf16le"||B==="utf-16le")){if(ie.length<2||V.length<2)return-1;R=2,X/=2,xe/=2,Z/=2}function Ie(wt,Lt){return R===1?wt[Lt]:wt.readUInt16BE(Lt*R)}var ye;if(S){var nt=-1;for(ye=Z;ye<X;ye++)if(Ie(ie,ye)===Ie(V,nt===-1?0:ye-nt)){if(nt===-1&&(nt=ye),ye-nt+1===xe)return nt*R}else nt!==-1&&(ye-=ye-nt),nt=-1}else for(Z+xe>X&&(Z=X-xe),ye=Z;ye>=0;ye--){for(var at=!0,mt=0;mt<xe;mt++)if(Ie(ie,ye+mt)!==Ie(V,mt)){at=!1;break}if(at)return ye}return-1}g.prototype.includes=function(V,Z,B){return this.indexOf(V,Z,B)!==-1},g.prototype.indexOf=function(V,Z,B){return te(this,V,Z,B,!0)},g.prototype.lastIndexOf=function(V,Z,B){return te(this,V,Z,B,!1)};function L(ie,V,Z,B){Z=Number(Z)||0;var S=ie.length-Z;B?(B=Number(B),B>S&&(B=S)):B=S;var R=V.length;if(R%2!==0)throw new TypeError("Invalid hex string");B>R/2&&(B=R/2);for(var X=0;X<B;++X){var xe=parseInt(V.substr(X*2,2),16);if(isNaN(xe))return X;ie[Z+X]=xe}return X}function M(ie,V,Z,B){return ce(_e(V,ie.length-Z),ie,Z,B)}function I(ie,V,Z,B){return ce(Ee(V),ie,Z,B)}function U(ie,V,Z,B){return I(ie,V,Z,B)}function $(ie,V,Z,B){return ce(Le(V),ie,Z,B)}function ee(ie,V,Z,B){return ce(Oe(V,ie.length-Z),ie,Z,B)}g.prototype.write=function(V,Z,B,S){if(Z===void 0)S="utf8",B=this.length,Z=0;else if(B===void 0&&typeof Z=="string")S=Z,B=this.length,Z=0;else if(isFinite(Z))Z=Z|0,isFinite(B)?(B=B|0,S===void 0&&(S="utf8")):(S=B,B=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var R=this.length-Z;if((B===void 0||B>R)&&(B=R),V.length>0&&(B<0||Z<0)||Z>this.length)throw new RangeError("Attempt to write outside buffer bounds");S||(S="utf8");for(var X=!1;;)switch(S){case"hex":return L(this,V,Z,B);case"utf8":case"utf-8":return M(this,V,Z,B);case"ascii":return I(this,V,Z,B);case"latin1":case"binary":return U(this,V,Z,B);case"base64":return $(this,V,Z,B);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return ee(this,V,Z,B);default:if(X)throw new TypeError("Unknown encoding: "+S);S=(""+S).toLowerCase(),X=!0}},g.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Q(ie,V,Z){return V===0&&Z===ie.length?u.fromByteArray(ie):u.fromByteArray(ie.slice(V,Z))}function G(ie,V,Z){Z=Math.min(ie.length,Z);for(var B=[],S=V;S<Z;){var R=ie[S],X=null,xe=R>239?4:R>223?3:R>191?2:1;if(S+xe<=Z){var Ie,ye,nt,at;switch(xe){case 1:R<128&&(X=R);break;case 2:Ie=ie[S+1],(Ie&192)===128&&(at=(R&31)<<6|Ie&63,at>127&&(X=at));break;case 3:Ie=ie[S+1],ye=ie[S+2],(Ie&192)===128&&(ye&192)===128&&(at=(R&15)<<12|(Ie&63)<<6|ye&63,at>2047&&(at<55296||at>57343)&&(X=at));break;case 4:Ie=ie[S+1],ye=ie[S+2],nt=ie[S+3],(Ie&192)===128&&(ye&192)===128&&(nt&192)===128&&(at=(R&15)<<18|(Ie&63)<<12|(ye&63)<<6|nt&63,at>65535&&at<1114112&&(X=at))}}X===null?(X=65533,xe=1):X>65535&&(X-=65536,B.push(X>>>10&1023|55296),X=56320|X&1023),B.push(X),S+=xe}return Y(B)}var K=4096;function Y(ie){var V=ie.length;if(V<=K)return String.fromCharCode.apply(String,ie);for(var Z="",B=0;B<V;)Z+=String.fromCharCode.apply(String,ie.slice(B,B+=K));return Z}function we(ie,V,Z){var B="";Z=Math.min(ie.length,Z);for(var S=V;S<Z;++S)B+=String.fromCharCode(ie[S]&127);return B}function Ke(ie,V,Z){var B="";Z=Math.min(ie.length,Z);for(var S=V;S<Z;++S)B+=String.fromCharCode(ie[S]);return B}function ge(ie,V,Z){var B=ie.length;(!V||V<0)&&(V=0),(!Z||Z<0||Z>B)&&(Z=B);for(var S="",R=V;R<Z;++R)S+=We(ie[R]);return S}function me(ie,V,Z){for(var B=ie.slice(V,Z),S="",R=0;R<B.length;R+=2)S+=String.fromCharCode(B[R]+B[R+1]*256);return S}g.prototype.slice=function(V,Z){var B=this.length;V=~~V,Z=Z===void 0?B:~~Z,V<0?(V+=B,V<0&&(V=0)):V>B&&(V=B),Z<0?(Z+=B,Z<0&&(Z=0)):Z>B&&(Z=B),Z<V&&(Z=V);var S;if(g.TYPED_ARRAY_SUPPORT)S=this.subarray(V,Z),S.__proto__=g.prototype;else{var R=Z-V;S=new g(R,void 0);for(var X=0;X<R;++X)S[X]=this[X+V]}return S};function De(ie,V,Z){if(ie%1!==0||ie<0)throw new RangeError("offset is not uint");if(ie+V>Z)throw new RangeError("Trying to access beyond buffer length")}g.prototype.readUIntLE=function(V,Z,B){V=V|0,Z=Z|0,B||De(V,Z,this.length);for(var S=this[V],R=1,X=0;++X<Z&&(R*=256);)S+=this[V+X]*R;return S},g.prototype.readUIntBE=function(V,Z,B){V=V|0,Z=Z|0,B||De(V,Z,this.length);for(var S=this[V+--Z],R=1;Z>0&&(R*=256);)S+=this[V+--Z]*R;return S},g.prototype.readUInt8=function(V,Z){return Z||De(V,1,this.length),this[V]},g.prototype.readUInt16LE=function(V,Z){return Z||De(V,2,this.length),this[V]|this[V+1]<<8},g.prototype.readUInt16BE=function(V,Z){return Z||De(V,2,this.length),this[V]<<8|this[V+1]},g.prototype.readUInt32LE=function(V,Z){return Z||De(V,4,this.length),(this[V]|this[V+1]<<8|this[V+2]<<16)+this[V+3]*16777216},g.prototype.readUInt32BE=function(V,Z){return Z||De(V,4,this.length),this[V]*16777216+(this[V+1]<<16|this[V+2]<<8|this[V+3])},g.prototype.readIntLE=function(V,Z,B){V=V|0,Z=Z|0,B||De(V,Z,this.length);for(var S=this[V],R=1,X=0;++X<Z&&(R*=256);)S+=this[V+X]*R;return R*=128,S>=R&&(S-=Math.pow(2,8*Z)),S},g.prototype.readIntBE=function(V,Z,B){V=V|0,Z=Z|0,B||De(V,Z,this.length);for(var S=Z,R=1,X=this[V+--S];S>0&&(R*=256);)X+=this[V+--S]*R;return R*=128,X>=R&&(X-=Math.pow(2,8*Z)),X},g.prototype.readInt8=function(V,Z){return Z||De(V,1,this.length),this[V]&128?(255-this[V]+1)*-1:this[V]},g.prototype.readInt16LE=function(V,Z){Z||De(V,2,this.length);var B=this[V]|this[V+1]<<8;return B&32768?B|4294901760:B},g.prototype.readInt16BE=function(V,Z){Z||De(V,2,this.length);var B=this[V+1]|this[V]<<8;return B&32768?B|4294901760:B},g.prototype.readInt32LE=function(V,Z){return Z||De(V,4,this.length),this[V]|this[V+1]<<8|this[V+2]<<16|this[V+3]<<24},g.prototype.readInt32BE=function(V,Z){return Z||De(V,4,this.length),this[V]<<24|this[V+1]<<16|this[V+2]<<8|this[V+3]},g.prototype.readFloatLE=function(V,Z){return Z||De(V,4,this.length),h.read(this,V,!0,23,4)},g.prototype.readFloatBE=function(V,Z){return Z||De(V,4,this.length),h.read(this,V,!1,23,4)},g.prototype.readDoubleLE=function(V,Z){return Z||De(V,8,this.length),h.read(this,V,!0,52,8)},g.prototype.readDoubleBE=function(V,Z){return Z||De(V,8,this.length),h.read(this,V,!1,52,8)};function ze(ie,V,Z,B,S,R){if(!g.isBuffer(ie))throw new TypeError('"buffer" argument must be a Buffer instance');if(V>S||V<R)throw new RangeError('"value" argument is out of bounds');if(Z+B>ie.length)throw new RangeError("Index out of range")}g.prototype.writeUIntLE=function(V,Z,B,S){if(V=+V,Z=Z|0,B=B|0,!S){var R=Math.pow(2,8*B)-1;ze(this,V,Z,B,R,0)}var X=1,xe=0;for(this[Z]=V&255;++xe<B&&(X*=256);)this[Z+xe]=V/X&255;return Z+B},g.prototype.writeUIntBE=function(V,Z,B,S){if(V=+V,Z=Z|0,B=B|0,!S){var R=Math.pow(2,8*B)-1;ze(this,V,Z,B,R,0)}var X=B-1,xe=1;for(this[Z+X]=V&255;--X>=0&&(xe*=256);)this[Z+X]=V/xe&255;return Z+B},g.prototype.writeUInt8=function(V,Z,B){return V=+V,Z=Z|0,B||ze(this,V,Z,1,255,0),g.TYPED_ARRAY_SUPPORT||(V=Math.floor(V)),this[Z]=V&255,Z+1};function tt(ie,V,Z,B){V<0&&(V=65535+V+1);for(var S=0,R=Math.min(ie.length-Z,2);S<R;++S)ie[Z+S]=(V&255<<8*(B?S:1-S))>>>(B?S:1-S)*8}g.prototype.writeUInt16LE=function(V,Z,B){return V=+V,Z=Z|0,B||ze(this,V,Z,2,65535,0),g.TYPED_ARRAY_SUPPORT?(this[Z]=V&255,this[Z+1]=V>>>8):tt(this,V,Z,!0),Z+2},g.prototype.writeUInt16BE=function(V,Z,B){return V=+V,Z=Z|0,B||ze(this,V,Z,2,65535,0),g.TYPED_ARRAY_SUPPORT?(this[Z]=V>>>8,this[Z+1]=V&255):tt(this,V,Z,!1),Z+2};function rt(ie,V,Z,B){V<0&&(V=4294967295+V+1);for(var S=0,R=Math.min(ie.length-Z,4);S<R;++S)ie[Z+S]=V>>>(B?S:3-S)*8&255}g.prototype.writeUInt32LE=function(V,Z,B){return V=+V,Z=Z|0,B||ze(this,V,Z,4,4294967295,0),g.TYPED_ARRAY_SUPPORT?(this[Z+3]=V>>>24,this[Z+2]=V>>>16,this[Z+1]=V>>>8,this[Z]=V&255):rt(this,V,Z,!0),Z+4},g.prototype.writeUInt32BE=function(V,Z,B){return V=+V,Z=Z|0,B||ze(this,V,Z,4,4294967295,0),g.TYPED_ARRAY_SUPPORT?(this[Z]=V>>>24,this[Z+1]=V>>>16,this[Z+2]=V>>>8,this[Z+3]=V&255):rt(this,V,Z,!1),Z+4},g.prototype.writeIntLE=function(V,Z,B,S){if(V=+V,Z=Z|0,!S){var R=Math.pow(2,8*B-1);ze(this,V,Z,B,R-1,-R)}var X=0,xe=1,Ie=0;for(this[Z]=V&255;++X<B&&(xe*=256);)V<0&&Ie===0&&this[Z+X-1]!==0&&(Ie=1),this[Z+X]=(V/xe>>0)-Ie&255;return Z+B},g.prototype.writeIntBE=function(V,Z,B,S){if(V=+V,Z=Z|0,!S){var R=Math.pow(2,8*B-1);ze(this,V,Z,B,R-1,-R)}var X=B-1,xe=1,Ie=0;for(this[Z+X]=V&255;--X>=0&&(xe*=256);)V<0&&Ie===0&&this[Z+X+1]!==0&&(Ie=1),this[Z+X]=(V/xe>>0)-Ie&255;return Z+B},g.prototype.writeInt8=function(V,Z,B){return V=+V,Z=Z|0,B||ze(this,V,Z,1,127,-128),g.TYPED_ARRAY_SUPPORT||(V=Math.floor(V)),V<0&&(V=255+V+1),this[Z]=V&255,Z+1},g.prototype.writeInt16LE=function(V,Z,B){return V=+V,Z=Z|0,B||ze(this,V,Z,2,32767,-32768),g.TYPED_ARRAY_SUPPORT?(this[Z]=V&255,this[Z+1]=V>>>8):tt(this,V,Z,!0),Z+2},g.prototype.writeInt16BE=function(V,Z,B){return V=+V,Z=Z|0,B||ze(this,V,Z,2,32767,-32768),g.TYPED_ARRAY_SUPPORT?(this[Z]=V>>>8,this[Z+1]=V&255):tt(this,V,Z,!1),Z+2},g.prototype.writeInt32LE=function(V,Z,B){return V=+V,Z=Z|0,B||ze(this,V,Z,4,2147483647,-2147483648),g.TYPED_ARRAY_SUPPORT?(this[Z]=V&255,this[Z+1]=V>>>8,this[Z+2]=V>>>16,this[Z+3]=V>>>24):rt(this,V,Z,!0),Z+4},g.prototype.writeInt32BE=function(V,Z,B){return V=+V,Z=Z|0,B||ze(this,V,Z,4,2147483647,-2147483648),V<0&&(V=4294967295+V+1),g.TYPED_ARRAY_SUPPORT?(this[Z]=V>>>24,this[Z+1]=V>>>16,this[Z+2]=V>>>8,this[Z+3]=V&255):rt(this,V,Z,!1),Z+4};function vt(ie,V,Z,B,S,R){if(Z+B>ie.length)throw new RangeError("Index out of range");if(Z<0)throw new RangeError("Index out of range")}function Ye(ie,V,Z,B,S){return S||vt(ie,V,Z,4),h.write(ie,V,Z,B,23,4),Z+4}g.prototype.writeFloatLE=function(V,Z,B){return Ye(this,V,Z,!0,B)},g.prototype.writeFloatBE=function(V,Z,B){return Ye(this,V,Z,!1,B)};function Pe(ie,V,Z,B,S){return S||vt(ie,V,Z,8),h.write(ie,V,Z,B,52,8),Z+8}g.prototype.writeDoubleLE=function(V,Z,B){return Pe(this,V,Z,!0,B)},g.prototype.writeDoubleBE=function(V,Z,B){return Pe(this,V,Z,!1,B)},g.prototype.copy=function(V,Z,B,S){if(B||(B=0),!S&&S!==0&&(S=this.length),Z>=V.length&&(Z=V.length),Z||(Z=0),S>0&&S<B&&(S=B),S===B||V.length===0||this.length===0)return 0;if(Z<0)throw new RangeError("targetStart out of bounds");if(B<0||B>=this.length)throw new RangeError("sourceStart out of bounds");if(S<0)throw new RangeError("sourceEnd out of bounds");S>this.length&&(S=this.length),V.length-Z<S-B&&(S=V.length-Z+B);var R=S-B,X;if(this===V&&B<Z&&Z<S)for(X=R-1;X>=0;--X)V[X+Z]=this[X+B];else if(R<1e3||!g.TYPED_ARRAY_SUPPORT)for(X=0;X<R;++X)V[X+Z]=this[X+B];else Uint8Array.prototype.set.call(V,this.subarray(B,B+R),Z);return R},g.prototype.fill=function(V,Z,B,S){if(typeof V=="string"){if(typeof Z=="string"?(S=Z,Z=0,B=this.length):typeof B=="string"&&(S=B,B=this.length),V.length===1){var R=V.charCodeAt(0);R<256&&(V=R)}if(S!==void 0&&typeof S!="string")throw new TypeError("encoding must be a string");if(typeof S=="string"&&!g.isEncoding(S))throw new TypeError("Unknown encoding: "+S)}else typeof V=="number"&&(V=V&255);if(Z<0||this.length<Z||this.length<B)throw new RangeError("Out of range index");if(B<=Z)return this;Z=Z>>>0,B=B===void 0?this.length:B>>>0,V||(V=0);var X;if(typeof V=="number")for(X=Z;X<B;++X)this[X]=V;else{var xe=g.isBuffer(V)?V:_e(new g(V,S).toString()),Ie=xe.length;for(X=0;X<B-Z;++X)this[X+Z]=xe[X%Ie]}return this};var Be=/[^+\/0-9A-Za-z-_]/g;function $e(ie){if(ie=Je(ie).replace(Be,""),ie.length<2)return"";for(;ie.length%4!==0;)ie=ie+"=";return ie}function Je(ie){return ie.trim?ie.trim():ie.replace(/^\s+|\s+$/g,"")}function We(ie){return ie<16?"0"+ie.toString(16):ie.toString(16)}function _e(ie,V){V=V||1/0;for(var Z,B=ie.length,S=null,R=[],X=0;X<B;++X){if(Z=ie.charCodeAt(X),Z>55295&&Z<57344){if(!S){if(Z>56319){(V-=3)>-1&&R.push(239,191,189);continue}else if(X+1===B){(V-=3)>-1&&R.push(239,191,189);continue}S=Z;continue}if(Z<56320){(V-=3)>-1&&R.push(239,191,189),S=Z;continue}Z=(S-55296<<10|Z-56320)+65536}else S&&(V-=3)>-1&&R.push(239,191,189);if(S=null,Z<128){if((V-=1)<0)break;R.push(Z)}else if(Z<2048){if((V-=2)<0)break;R.push(Z>>6|192,Z&63|128)}else if(Z<65536){if((V-=3)<0)break;R.push(Z>>12|224,Z>>6&63|128,Z&63|128)}else if(Z<1114112){if((V-=4)<0)break;R.push(Z>>18|240,Z>>12&63|128,Z>>6&63|128,Z&63|128)}else throw new Error("Invalid code point")}return R}function Ee(ie){for(var V=[],Z=0;Z<ie.length;++Z)V.push(ie.charCodeAt(Z)&255);return V}function Oe(ie,V){for(var Z,B,S,R=[],X=0;X<ie.length&&!((V-=2)<0);++X)Z=ie.charCodeAt(X),B=Z>>8,S=Z%256,R.push(S),R.push(B);return R}function Le(ie){return u.toByteArray($e(ie))}function ce(ie,V,Z,B){for(var S=0;S<B&&!(S+Z>=V.length||S>=ie.length);++S)V[S+Z]=ie[S];return S}function he(ie){return ie!==ie}}).call(this,typeof Tr!="undefined"?Tr:typeof self!="undefined"?self:typeof window!="undefined"?window:{},n("buffer").Buffer)},{"base64-js":3,buffer:6,ieee754:29,isarray:35}],7:[function(n,i,o){(function(){if(typeof window!="undefined")try{var s=new window.CustomEvent("test",{cancelable:!0});if(s.preventDefault(),s.defaultPrevented!==!0)throw new Error("Could not prevent default")}catch{var c=function(h,f){var p,m;return f=f||{},f.bubbles=!!f.bubbles,f.cancelable=!!f.cancelable,p=document.createEvent("CustomEvent"),p.initCustomEvent(h,f.bubbles,f.cancelable,f.detail),m=p.preventDefault,p.preventDefault=function(){m.call(this);try{Object.defineProperty(this,"defaultPrevented",{get:function(){return!0}})}catch{this.defaultPrevented=!0}},p};c.prototype=window.Event.prototype,window.CustomEvent=c}})()},{}],8:[function(n,i,o){o=i.exports=n("./debug"),o.log=u,o.formatArgs=c,o.save=h,o.load=f,o.useColors=s,o.storage=typeof chrome!="undefined"&&typeof chrome.storage!="undefined"?chrome.storage.local:p(),o.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"];function s(){return"WebkitAppearance"in document.documentElement.style||window.console&&(console.firebug||console.exception&&console.table)||navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31}o.formatters.j=function(m){return JSON.stringify(m)};function c(){var m=arguments,y=this.useColors;if(m[0]=(y?"%c":"")+this.namespace+(y?" %c":" ")+m[0]+(y?"%c ":" "),!y)return m;var g="color: "+this.color;m=[m[0],g,"color: inherit"].concat(Array.prototype.slice.call(m,1));var _=0,x=0;return m[0].replace(/%[a-z%]/g,function(b){b!=="%%"&&(_++,b==="%c"&&(x=_))}),m.splice(x,0,g),m}function u(){return typeof console=="object"&&console.log&&Function.prototype.apply.call(console.log,console,arguments)}function h(m){try{m==null?o.storage.removeItem("debug"):o.storage.debug=m}catch{}}function f(){var m;try{m=o.storage.debug}catch{}return m}o.enable(f());function p(){try{return window.localStorage}catch{}}},{"./debug":9}],9:[function(n,i,o){o=i.exports=u,o.coerce=m,o.disable=f,o.enable=h,o.enabled=p,o.names=[],o.skips=[],o.formatters={};var s=0;function c(){return o.colors[s++%o.colors.length]}function u(y){function g(){}g.enabled=!1;function _(){var b=_;b.useColors==null&&(b.useColors=o.useColors()),b.color==null&&b.useColors&&(b.color=c());var E=Array.prototype.slice.call(arguments);E[0]=o.coerce(E[0]),typeof E[0]!="string"&&(E=["%o"].concat(E));var T=0;E[0]=E[0].replace(/%([a-z%])/g,function(D,F){if(D==="%%")return D;T++;var k=o.formatters[F];if(typeof k=="function"){var W=E[T];D=k.call(b,W),E.splice(T,1),T--}return D}),typeof o.formatArgs=="function"&&(E=o.formatArgs.apply(b,E));var P=_.log||o.log||console.log.bind(console);P.apply(b,E)}_.enabled=!0;var x=o.enabled(y)?_:g;return x.namespace=y,x}function h(y){o.save(y);for(var g=(y||"").split(/[\s,]+/),_=g.length,x=0;x<_;x++)!g[x]||(y=g[x].replace(/\*/g,".*?"),y[0]==="-"?o.skips.push(new RegExp("^"+y.substr(1)+"$")):o.names.push(new RegExp("^"+y+"$")))}function f(){o.enable("")}function p(y){var g,_;for(g=0,_=o.skips.length;g<_;g++)if(o.skips[g].test(y))return!1;for(g=0,_=o.names.length;g<_;g++)if(o.names[g].test(y))return!0;return!1}function m(y){return y instanceof Error?y.stack||y.message:y}},{}],10:[function(n,i,o){var s=n("is-obj"),c=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable;function h(m){if(m==null)throw new TypeError("Sources cannot be null or undefined");return Object(m)}function f(m,y,g){var _=y[g];if(_!=null){if(c.call(m,g)&&(m[g]===void 0||m[g]===null))throw new TypeError("Cannot convert undefined or null to object ("+g+")");!c.call(m,g)||!s(_)?m[g]=_:m[g]=p(Object(m[g]),y[g])}}function p(m,y){if(m===y)return m;y=Object(y);for(var g in y)c.call(y,g)&&f(m,y,g);if(Object.getOwnPropertySymbols)for(var _=Object.getOwnPropertySymbols(y),x=0;x<_.length;x++)u.call(y,_[x])&&f(m,y,_[x]);return m}i.exports=function(y){y=h(y);for(var g=1;g<arguments.length;g++)p(y,arguments[g]);return y}},{"is-obj":34}],11:[function(n,i,o){var s=n("object-keys"),c=typeof Symbol=="function"&&typeof Symbol("foo")=="symbol",u=Object.prototype.toString,h=Array.prototype.concat,f=Object.defineProperty,p=function(x){return typeof x=="function"&&u.call(x)==="[object Function]"},m=function(){var x={};try{f(x,"x",{enumerable:!1,value:x});for(var b in x)return!1;return x.x===x}catch{return!1}},y=f&&m(),g=function(x,b,E,T){b in x&&(!p(T)||!T())||(y?f(x,b,{configurable:!0,enumerable:!1,value:E,writable:!0}):x[b]=E)},_=function(x,b){var E=arguments.length>2?arguments[2]:{},T=s(b);c&&(T=h.call(T,Object.getOwnPropertySymbols(b)));for(var P=0;P<T.length;P+=1)g(x,T[P],b[T[P]],E[T[P]])};_.supportsDescriptors=!!y,i.exports=_},{"object-keys":41}],12:[function(n,i,o){/*! (C) WebReflection Mit Style License */(function(s,c,u,h){function f(ut,St){for(var Tt=0,gn=ut.length;Tt<gn;Tt++)F(ut[Tt],St)}function p(ut){for(var St=0,Tt=ut.length,gn;St<Tt;St++)gn=ut[St],Ct(gn,K[y(gn)])}function m(ut){return function(St){Ee(St)&&(F(St,ut),f(St.querySelectorAll(Y),ut))}}function y(ut){var St=ce.call(ut,"is"),Tt=ut.nodeName.toUpperCase(),gn=Ke.call(G,St?$+St.toUpperCase():U+Tt);return St&&-1<gn&&!g(Tt,St)?-1:gn}function g(ut,St){return-1<Y.indexOf(ut+'[is="'+St+'"]')}function _(ut){var St=ut.currentTarget,Tt=ut.attrChange,gn=ut.attrName,An=ut.target;ye&&(!An||An===St)&&St.attributeChangedCallback&&gn!=="style"&&ut.prevValue!==ut.newValue&&St.attributeChangedCallback(gn,Tt===ut[de]?null:ut.prevValue,Tt===ut[N]?null:ut.newValue)}function x(ut){var St=m(ut);return function(Tt){S.push(St,Tt.target)}}function b(ut){Ie&&(Ie=!1,ut.currentTarget.removeEventListener(M,b)),f((ut.target||c).querySelectorAll(Y),ut.detail===j?j:W),_e&&P()}function E(ut,St){var Tt=this;he.call(Tt,ut,St),nt.call(Tt,{target:Tt})}function T(ut,St){$e(ut,St),wt?wt.observe(ut,Z):(xe&&(ut.setAttribute=E,ut[k]=mt(ut),ut.addEventListener(I,nt)),ut.addEventListener(L,_)),ut.createdCallback&&ye&&(ut.created=!0,ut.createdCallback(),ut.created=!1)}function P(){for(var ut,St=0,Tt=Oe.length;St<Tt;St++)ut=Oe[St],we.contains(ut)||(Tt--,Oe.splice(St--,1),F(ut,j))}function D(ut){throw new Error("A "+ut+" type is already registered")}function F(ut,St){var Tt,gn=y(ut);-1<gn&&(Lt(ut,K[gn]),gn=0,St===W&&!ut[W]?(ut[j]=!1,ut[W]=!0,gn=1,_e&&Ke.call(Oe,ut)<0&&Oe.push(ut)):St===j&&!ut[j]&&(ut[W]=!1,ut[j]=!0,gn=1),gn&&(Tt=ut[St+"Callback"])&&Tt.call(ut))}if(!(h in c)){var k="__"+h+(Math.random()*1e5>>0),W="attached",j="detached",J="extends",de="ADDITION",te="MODIFICATION",N="REMOVAL",L="DOMAttrModified",M="DOMContentLoaded",I="DOMSubtreeModified",U="<",$="=",ee=/^[A-Z][A-Z0-9]*(?:-[A-Z0-9]+)+$/,Q=["ANNOTATION-XML","COLOR-PROFILE","FONT-FACE","FONT-FACE-SRC","FONT-FACE-URI","FONT-FACE-FORMAT","FONT-FACE-NAME","MISSING-GLYPH"],G=[],K=[],Y="",we=c.documentElement,Ke=G.indexOf||function(ut){for(var St=this.length;St--&&this[St]!==ut;);return St},ge=u.prototype,me=ge.hasOwnProperty,De=ge.isPrototypeOf,ze=u.defineProperty,tt=u.getOwnPropertyDescriptor,rt=u.getOwnPropertyNames,vt=u.getPrototypeOf,Ye=u.setPrototypeOf,Pe=!!u.__proto__,Be=u.create||function ut(St){return St?(ut.prototype=St,new ut):this},$e=Ye||(Pe?function(ut,St){return ut.__proto__=St,ut}:rt&&tt?function(){function ut(St,Tt){for(var gn,An=rt(Tt),un=0,Mn=An.length;un<Mn;un++)gn=An[un],me.call(St,gn)||ze(St,gn,tt(Tt,gn))}return function(St,Tt){do ut(St,Tt);while((Tt=vt(Tt))&&!De.call(Tt,St));return St}}():function(ut,St){for(var Tt in St)ut[Tt]=St[Tt];return ut}),Je=s.MutationObserver||s.WebKitMutationObserver,We=(s.HTMLElement||s.Element||s.Node).prototype,_e=!De.call(We,we),Ee=_e?function(ut){return ut.nodeType===1}:function(ut){return De.call(We,ut)},Oe=_e&&[],Le=We.cloneNode,ce=We.getAttribute,he=We.setAttribute,ie=We.removeAttribute,V=c.createElement,Z=Je&&{attributes:!0,characterData:!0,attributeOldValue:!0},B=Je||function(ut){xe=!1,we.removeEventListener(L,B)},S,R=s.requestAnimationFrame||s.webkitRequestAnimationFrame||s.mozRequestAnimationFrame||s.msRequestAnimationFrame||function(ut){setTimeout(ut,10)},X=!1,xe=!0,Ie=!0,ye=!0,nt,at,mt,wt,Lt,Ct;Ye||Pe?(Lt=function(ut,St){De.call(St,ut)||T(ut,St)},Ct=T):(Lt=function(ut,St){ut[k]||(ut[k]=u(!0),T(ut,St))},Ct=Lt),_e?(xe=!1,function(){var ut=tt(We,"addEventListener"),St=ut.value,Tt=function(un){var Mn=new CustomEvent(L,{bubbles:!0});Mn.attrName=un,Mn.prevValue=ce.call(this,un),Mn.newValue=null,Mn[N]=Mn.attrChange=2,ie.call(this,un),this.dispatchEvent(Mn)},gn=function(un,Mn){var Cn=this.hasAttribute(un),wn=Cn&&ce.call(this,un);e=new CustomEvent(L,{bubbles:!0}),he.call(this,un,Mn),e.attrName=un,e.prevValue=Cn?wn:null,e.newValue=Mn,Cn?e[te]=e.attrChange=1:e[de]=e.attrChange=0,this.dispatchEvent(e)},An=function(un){var Mn=un.currentTarget,Cn=Mn[k],wn=un.propertyName,zn;Cn.hasOwnProperty(wn)&&(Cn=Cn[wn],zn=new CustomEvent(L,{bubbles:!0}),zn.attrName=Cn.name,zn.prevValue=Cn.value||null,zn.newValue=Cn.value=Mn[wn]||null,zn.prevValue==null?zn[de]=zn.attrChange=0:zn[te]=zn.attrChange=1,Mn.dispatchEvent(zn))};ut.value=function(un,Mn,Cn){un===L&&this.attributeChangedCallback&&this.setAttribute!==gn&&(this[k]={className:{name:"class",value:this.className}},this.setAttribute=gn,this.removeAttribute=Tt,St.call(this,"propertychange",An)),St.call(this,un,Mn,Cn)},ze(We,"addEventListener",ut)}()):Je||(we.addEventListener(L,B),we.setAttribute(k,1),we.removeAttribute(k),xe&&(nt=function(ut){var St=this,Tt,gn,An;if(St===ut.target){Tt=St[k],St[k]=gn=mt(St);for(An in gn){if(!(An in Tt))return at(0,St,An,Tt[An],gn[An],de);if(gn[An]!==Tt[An])return at(1,St,An,Tt[An],gn[An],te)}for(An in Tt)if(!(An in gn))return at(2,St,An,Tt[An],gn[An],N)}},at=function(ut,St,Tt,gn,An,un){var Mn={attrChange:ut,currentTarget:St,attrName:Tt,prevValue:gn,newValue:An};Mn[un]=ut,_(Mn)},mt=function(ut){for(var St,Tt,gn={},An=ut.attributes,un=0,Mn=An.length;un<Mn;un++)St=An[un],Tt=St.name,Tt!=="setAttribute"&&(gn[Tt]=St.value);return gn})),c[h]=function(ut,St){if(Mn=ut.toUpperCase(),X||(X=!0,Je?(wt=function(wn,zn){function ai(xn,Zn){for(var Me=0,le=xn.length;Me<le;Zn(xn[Me++]));}return new Je(function(xn){for(var Zn,Me,le,be=0,q=xn.length;be<q;be++)Zn=xn[be],Zn.type==="childList"?(ai(Zn.addedNodes,wn),ai(Zn.removedNodes,zn)):(Me=Zn.target,ye&&Me.attributeChangedCallback&&Zn.attributeName!=="style"&&(le=ce.call(Me,Zn.attributeName),le!==Zn.oldValue&&Me.attributeChangedCallback(Zn.attributeName,Zn.oldValue,le)))})}(m(W),m(j)),wt.observe(c,{childList:!0,subtree:!0})):(S=[],R(function wn(){for(;S.length;)S.shift().call(null,S.shift());R(wn)}),c.addEventListener("DOMNodeInserted",x(W)),c.addEventListener("DOMNodeRemoved",x(j))),c.addEventListener(M,b),c.addEventListener("readystatechange",b),c.createElement=function(wn,zn){var ai=V.apply(c,arguments),xn=""+wn,Zn=Ke.call(G,(zn?$:U)+(zn||xn).toUpperCase()),Me=-1<Zn;return zn&&(ai.setAttribute("is",zn=zn.toLowerCase()),Me&&(Me=g(xn.toUpperCase(),zn))),ye=!c.createElement.innerHTMLHelper,Me&&Ct(ai,K[Zn]),ai},We.cloneNode=function(wn){var zn=Le.call(this,!!wn),ai=y(zn);return-1<ai&&Ct(zn,K[ai]),wn&&p(zn.querySelectorAll(Y)),zn}),-2<Ke.call(G,$+Mn)+Ke.call(G,U+Mn)&&D(ut),!ee.test(Mn)||-1<Ke.call(Q,Mn))throw new Error("The type "+ut+" is invalid");var Tt=function(){return An?c.createElement(un,Mn):c.createElement(un)},gn=St||ge,An=me.call(gn,J),un=An?St[J].toUpperCase():Mn,Mn,Cn;return An&&-1<Ke.call(G,U+un)&&D(un),Cn=G.push((An?$:U)+Mn)-1,Y=Y.concat(Y.length?",":"",An?un+'[is="'+ut.toLowerCase()+'"]':un),Tt.prototype=K[Cn]=me.call(gn,"prototype")?gn.prototype:Be(We),f(c.querySelectorAll(Y),W),Tt}}})(window,document,Object,"registerElement")},{}],13:[function(n,i,o){i.exports=function(s){switch(s){case"int8":return Int8Array;case"int16":return Int16Array;case"int32":return Int32Array;case"uint8":return Uint8Array;case"uint16":return Uint16Array;case"uint32":return Uint32Array;case"float32":return Float32Array;case"float64":return Float64Array;case"array":return Array;case"uint8_clamped":return Uint8ClampedArray}}},{}],14:[function(n,i,o){var s,c=Object.getOwnPropertyDescriptor?function(){return Object.getOwnPropertyDescriptor(arguments,"callee").get}():function(){throw new TypeError},u=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol",h=Object.getPrototypeOf||function(_){return _.__proto__},f=s,p=s,m=s,y=typeof Uint8Array=="undefined"?s:h(Uint8Array),g={"$ %Array%":Array,"$ %ArrayBuffer%":typeof ArrayBuffer=="undefined"?s:ArrayBuffer,"$ %ArrayBufferPrototype%":typeof ArrayBuffer=="undefined"?s:ArrayBuffer.prototype,"$ %ArrayIteratorPrototype%":u?h([][Symbol.iterator]()):s,"$ %ArrayPrototype%":Array.prototype,"$ %ArrayProto_entries%":Array.prototype.entries,"$ %ArrayProto_forEach%":Array.prototype.forEach,"$ %ArrayProto_keys%":Array.prototype.keys,"$ %ArrayProto_values%":Array.prototype.values,"$ %AsyncFromSyncIteratorPrototype%":s,"$ %AsyncFunction%":p,"$ %AsyncFunctionPrototype%":s,"$ %AsyncGenerator%":s,"$ %AsyncGeneratorFunction%":m,"$ %AsyncGeneratorPrototype%":s,"$ %AsyncIteratorPrototype%":s,"$ %Atomics%":typeof Atomics=="undefined"?s:Atomics,"$ %Boolean%":Boolean,"$ %BooleanPrototype%":Boolean.prototype,"$ %DataView%":typeof DataView=="undefined"?s:DataView,"$ %DataViewPrototype%":typeof DataView=="undefined"?s:DataView.prototype,"$ %Date%":Date,"$ %DatePrototype%":Date.prototype,"$ %decodeURI%":decodeURI,"$ %decodeURIComponent%":decodeURIComponent,"$ %encodeURI%":encodeURI,"$ %encodeURIComponent%":encodeURIComponent,"$ %Error%":Error,"$ %ErrorPrototype%":Error.prototype,"$ %eval%":eval,"$ %EvalError%":EvalError,"$ %EvalErrorPrototype%":EvalError.prototype,"$ %Float32Array%":typeof Float32Array=="undefined"?s:Float32Array,"$ %Float32ArrayPrototype%":typeof Float32Array=="undefined"?s:Float32Array.prototype,"$ %Float64Array%":typeof Float64Array=="undefined"?s:Float64Array,"$ %Float64ArrayPrototype%":typeof Float64Array=="undefined"?s:Float64Array.prototype,"$ %Function%":Function,"$ %FunctionPrototype%":Function.prototype,"$ %Generator%":s,"$ %GeneratorFunction%":f,"$ %GeneratorPrototype%":s,"$ %Int8Array%":typeof Int8Array=="undefined"?s:Int8Array,"$ %Int8ArrayPrototype%":typeof Int8Array=="undefined"?s:Int8Array.prototype,"$ %Int16Array%":typeof Int16Array=="undefined"?s:Int16Array,"$ %Int16ArrayPrototype%":typeof Int16Array=="undefined"?s:Int8Array.prototype,"$ %Int32Array%":typeof Int32Array=="undefined"?s:Int32Array,"$ %Int32ArrayPrototype%":typeof Int32Array=="undefined"?s:Int32Array.prototype,"$ %isFinite%":isFinite,"$ %isNaN%":isNaN,"$ %IteratorPrototype%":u?h(h([][Symbol.iterator]())):s,"$ %JSON%":JSON,"$ %JSONParse%":JSON.parse,"$ %Map%":typeof Map=="undefined"?s:Map,"$ %MapIteratorPrototype%":typeof Map=="undefined"||!u?s:h(new Map()[Symbol.iterator]()),"$ %MapPrototype%":typeof Map=="undefined"?s:Map.prototype,"$ %Math%":Math,"$ %Number%":Number,"$ %NumberPrototype%":Number.prototype,"$ %Object%":Object,"$ %ObjectPrototype%":Object.prototype,"$ %ObjProto_toString%":Object.prototype.toString,"$ %ObjProto_valueOf%":Object.prototype.valueOf,"$ %parseFloat%":parseFloat,"$ %parseInt%":parseInt,"$ %Promise%":typeof Promise=="undefined"?s:Promise,"$ %PromisePrototype%":typeof Promise=="undefined"?s:Promise.prototype,"$ %PromiseProto_then%":typeof Promise=="undefined"?s:Promise.prototype.then,"$ %Promise_all%":typeof Promise=="undefined"?s:Promise.all,"$ %Promise_reject%":typeof Promise=="undefined"?s:Promise.reject,"$ %Promise_resolve%":typeof Promise=="undefined"?s:Promise.resolve,"$ %Proxy%":typeof Proxy=="undefined"?s:Proxy,"$ %RangeError%":RangeError,"$ %RangeErrorPrototype%":RangeError.prototype,"$ %ReferenceError%":ReferenceError,"$ %ReferenceErrorPrototype%":ReferenceError.prototype,"$ %Reflect%":typeof Reflect=="undefined"?s:Reflect,"$ %RegExp%":RegExp,"$ %RegExpPrototype%":RegExp.prototype,"$ %Set%":typeof Set=="undefined"?s:Set,"$ %SetIteratorPrototype%":typeof Set=="undefined"||!u?s:h(new Set()[Symbol.iterator]()),"$ %SetPrototype%":typeof Set=="undefined"?s:Set.prototype,"$ %SharedArrayBuffer%":typeof SharedArrayBuffer=="undefined"?s:SharedArrayBuffer,"$ %SharedArrayBufferPrototype%":typeof SharedArrayBuffer=="undefined"?s:SharedArrayBuffer.prototype,"$ %String%":String,"$ %StringIteratorPrototype%":u?h(""[Symbol.iterator]()):s,"$ %StringPrototype%":String.prototype,"$ %Symbol%":u?Symbol:s,"$ %SymbolPrototype%":u?Symbol.prototype:s,"$ %SyntaxError%":SyntaxError,"$ %SyntaxErrorPrototype%":SyntaxError.prototype,"$ %ThrowTypeError%":c,"$ %TypedArray%":y,"$ %TypedArrayPrototype%":y?y.prototype:s,"$ %TypeError%":TypeError,"$ %TypeErrorPrototype%":TypeError.prototype,"$ %Uint8Array%":typeof Uint8Array=="undefined"?s:Uint8Array,"$ %Uint8ArrayPrototype%":typeof Uint8Array=="undefined"?s:Uint8Array.prototype,"$ %Uint8ClampedArray%":typeof Uint8ClampedArray=="undefined"?s:Uint8ClampedArray,"$ %Uint8ClampedArrayPrototype%":typeof Uint8ClampedArray=="undefined"?s:Uint8ClampedArray.prototype,"$ %Uint16Array%":typeof Uint16Array=="undefined"?s:Uint16Array,"$ %Uint16ArrayPrototype%":typeof Uint16Array=="undefined"?s:Uint16Array.prototype,"$ %Uint32Array%":typeof Uint32Array=="undefined"?s:Uint32Array,"$ %Uint32ArrayPrototype%":typeof Uint32Array=="undefined"?s:Uint32Array.prototype,"$ %URIError%":URIError,"$ %URIErrorPrototype%":URIError.prototype,"$ %WeakMap%":typeof WeakMap=="undefined"?s:WeakMap,"$ %WeakMapPrototype%":typeof WeakMap=="undefined"?s:WeakMap.prototype,"$ %WeakSet%":typeof WeakSet=="undefined"?s:WeakSet,"$ %WeakSetPrototype%":typeof WeakSet=="undefined"?s:WeakSet.prototype};i.exports=function(x,b){if(arguments.length>1&&typeof b!="boolean")throw new TypeError('"allowMissing" argument must be a boolean');var E="$ "+x;if(!(E in g))throw new SyntaxError("intrinsic "+x+" does not exist!");if(typeof g[E]=="undefined"&&!b)throw new TypeError("intrinsic "+x+" exists, but is not available. Please file an issue!");return g[E]}},{}],15:[function(n,i,o){var s=n("./GetIntrinsic"),c=s("%Object%"),u=s("%TypeError%"),h=s("%String%"),f=n("./helpers/assertRecord"),p=n("./helpers/isNaN"),m=n("./helpers/isFinite"),y=n("./helpers/sign"),g=n("./helpers/mod"),_=n("is-callable"),x=n("es-to-primitive/es5"),b=n("has"),E={ToPrimitive:x,ToBoolean:function(P){return!!P},ToNumber:function(P){return+P},ToInteger:function(P){var D=this.ToNumber(P);return p(D)?0:D===0||!m(D)?D:y(D)*Math.floor(Math.abs(D))},ToInt32:function(P){return this.ToNumber(P)>>0},ToUint32:function(P){return this.ToNumber(P)>>>0},ToUint16:function(P){var D=this.ToNumber(P);if(p(D)||D===0||!m(D))return 0;var F=y(D)*Math.floor(Math.abs(D));return g(F,65536)},ToString:function(P){return h(P)},ToObject:function(P){return this.CheckObjectCoercible(P),c(P)},CheckObjectCoercible:function(P,D){if(P==null)throw new u(D||"Cannot call method on "+P);return P},IsCallable:_,SameValue:function(P,D){return P===D?P===0?1/P===1/D:!0:p(P)&&p(D)},Type:function(P){if(P===null)return"Null";if(typeof P=="undefined")return"Undefined";if(typeof P=="function"||typeof P=="object")return"Object";if(typeof P=="number")return"Number";if(typeof P=="boolean")return"Boolean";if(typeof P=="string")return"String"},IsPropertyDescriptor:function(P){if(this.Type(P)!=="Object")return!1;var D={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var F in P)if(b(P,F)&&!D[F])return!1;var k=b(P,"[[Value]]"),W=b(P,"[[Get]]")||b(P,"[[Set]]");if(k&&W)throw new u("Property Descriptors may not be both accessor and data descriptors");return!0},IsAccessorDescriptor:function(P){return!(typeof P=="undefined"||(f(this,"Property Descriptor","Desc",P),!b(P,"[[Get]]")&&!b(P,"[[Set]]")))},IsDataDescriptor:function(P){return!(typeof P=="undefined"||(f(this,"Property Descriptor","Desc",P),!b(P,"[[Value]]")&&!b(P,"[[Writable]]")))},IsGenericDescriptor:function(P){return typeof P=="undefined"?!1:(f(this,"Property Descriptor","Desc",P),!this.IsAccessorDescriptor(P)&&!this.IsDataDescriptor(P))},FromPropertyDescriptor:function(P){if(typeof P=="undefined")return P;if(f(this,"Property Descriptor","Desc",P),this.IsDataDescriptor(P))return{value:P["[[Value]]"],writable:!!P["[[Writable]]"],enumerable:!!P["[[Enumerable]]"],configurable:!!P["[[Configurable]]"]};if(this.IsAccessorDescriptor(P))return{get:P["[[Get]]"],set:P["[[Set]]"],enumerable:!!P["[[Enumerable]]"],configurable:!!P["[[Configurable]]"]};throw new u("FromPropertyDescriptor must be called with a fully populated Property Descriptor")},ToPropertyDescriptor:function(P){if(this.Type(P)!=="Object")throw new u("ToPropertyDescriptor requires an object");var D={};if(b(P,"enumerable")&&(D["[[Enumerable]]"]=this.ToBoolean(P.enumerable)),b(P,"configurable")&&(D["[[Configurable]]"]=this.ToBoolean(P.configurable)),b(P,"value")&&(D["[[Value]]"]=P.value),b(P,"writable")&&(D["[[Writable]]"]=this.ToBoolean(P.writable)),b(P,"get")){var F=P.get;if(typeof F!="undefined"&&!this.IsCallable(F))throw new TypeError("getter must be a function");D["[[Get]]"]=F}if(b(P,"set")){var k=P.set;if(typeof k!="undefined"&&!this.IsCallable(k))throw new u("setter must be a function");D["[[Set]]"]=k}if((b(D,"[[Get]]")||b(D,"[[Set]]"))&&(b(D,"[[Value]]")||b(D,"[[Writable]]")))throw new u("Invalid property descriptor. Cannot both specify accessors and a value or writable attribute");return D}};i.exports=E},{"./GetIntrinsic":14,"./helpers/assertRecord":16,"./helpers/isFinite":17,"./helpers/isNaN":18,"./helpers/mod":19,"./helpers/sign":20,"es-to-primitive/es5":21,has:28,"is-callable":32}],16:[function(n,i,o){var s=n("../GetIntrinsic"),c=s("%TypeError%"),u=s("%SyntaxError%"),h=n("has"),f={"Property Descriptor":function(m,y){if(m.Type(y)!=="Object")return!1;var g={"[[Configurable]]":!0,"[[Enumerable]]":!0,"[[Get]]":!0,"[[Set]]":!0,"[[Value]]":!0,"[[Writable]]":!0};for(var _ in y)if(h(y,_)&&!g[_])return!1;var x=h(y,"[[Value]]"),b=h(y,"[[Get]]")||h(y,"[[Set]]");if(x&&b)throw new c("Property Descriptors may not be both accessor and data descriptors");return!0}};i.exports=function(m,y,g,_){var x=f[y];if(typeof x!="function")throw new u("unknown record type: "+y);if(!x(m,_))throw new c(g+" must be a "+y);console.log(x(m,_),_)}},{"../GetIntrinsic":14,has:28}],17:[function(n,i,o){var s=Number.isNaN||function(c){return c!==c};i.exports=Number.isFinite||function(c){return typeof c=="number"&&!s(c)&&c!==1/0&&c!==-1/0}},{}],18:[function(n,i,o){i.exports=Number.isNaN||function(c){return c!==c}},{}],19:[function(n,i,o){i.exports=function(c,u){var h=c%u;return Math.floor(h>=0?h:h+u)}},{}],20:[function(n,i,o){i.exports=function(c){return c>=0?1:-1}},{}],21:[function(n,i,o){var s=Object.prototype.toString,c=n("./helpers/isPrimitive"),u=n("is-callable"),h={"[[DefaultValue]]":function(f){var p;if(arguments.length>1?p=arguments[1]:p=s.call(f)==="[object Date]"?String:Number,p===String||p===Number){var m=p===String?["toString","valueOf"]:["valueOf","toString"],y,g;for(g=0;g<m.length;++g)if(u(f[m[g]])&&(y=f[m[g]](),c(y)))return y;throw new TypeError("No default value")}throw new TypeError("invalid [[DefaultValue]] hint supplied")}};i.exports=function(p){return c(p)?p:arguments.length>1?h["[[DefaultValue]]"](p,arguments[1]):h["[[DefaultValue]]"](p)}},{"./helpers/isPrimitive":22,"is-callable":32}],22:[function(n,i,o){i.exports=function(c){return c===null||typeof c!="function"&&typeof c!="object"}},{}],23:[function(n,i,o){var s=n("dtype");i.exports=c;function c(u,h,f){if(!u)throw new TypeError("must specify data as first parameter");if(f=+(f||0)|0,Array.isArray(u)&&u[0]&&typeof u[0][0]=="number"){var p=u[0].length,m=u.length*p,y,g,_,x;(!h||typeof h=="string")&&(h=new(s(h||"float32"))(m+f));var b=h.length-f;if(m!==b)throw new Error("source length "+m+" ("+p+"x"+u.length+") does not match destination length "+b);for(y=0,_=f;y<u.length;y++)for(g=0;g<p;g++)h[_++]=u[y][g]===null?NaN:u[y][g]}else if(!h||typeof h=="string"){var E=s(h||"float32");if(Array.isArray(u)||h==="array")for(h=new E(u.length+f),y=0,_=f,x=h.length;_<x;_++,y++)h[_]=u[y]===null?NaN:u[y];else f===0?h=new E(u):(h=new E(u.length+f),h.set(u,f))}else h.set(u,f);return h}},{dtype:13}],24:[function(n,i,o){var s=n("is-callable"),c=Object.prototype.toString,u=Object.prototype.hasOwnProperty,h=function(g,_,x){for(var b=0,E=g.length;b<E;b++)u.call(g,b)&&(x==null?_(g[b],b,g):_.call(x,g[b],b,g))},f=function(g,_,x){for(var b=0,E=g.length;b<E;b++)x==null?_(g.charAt(b),b,g):_.call(x,g.charAt(b),b,g)},p=function(g,_,x){for(var b in g)u.call(g,b)&&(x==null?_(g[b],b,g):_.call(x,g[b],b,g))},m=function(g,_,x){if(!s(_))throw new TypeError("iterator must be a function");var b;arguments.length>=3&&(b=x),c.call(g)==="[object Array]"?h(g,_,b):typeof g=="string"?f(g,_,b):p(g,_,b)};i.exports=m},{"is-callable":32}],25:[function(n,i,o){var s="Function.prototype.bind called on incompatible ",c=Array.prototype.slice,u=Object.prototype.toString,h="[object Function]";i.exports=function(p){var m=this;if(typeof m!="function"||u.call(m)!==h)throw new TypeError(s+m);for(var y=c.call(arguments,1),g,_=function(){if(this instanceof g){var P=m.apply(this,y.concat(c.call(arguments)));return Object(P)===P?P:this}else return m.apply(p,y.concat(c.call(arguments)))},x=Math.max(0,m.length-y.length),b=[],E=0;E<x;E++)b.push("$"+E);if(g=Function("binder","return function ("+b.join(",")+"){ return binder.apply(this,arguments); }")(_),m.prototype){var T=function(){};T.prototype=m.prototype,g.prototype=new T,T.prototype=null}return g}},{}],26:[function(n,i,o){var s=n("./implementation");i.exports=Function.prototype.bind||s},{"./implementation":25}],27:[function(n,i,o){(function(s){var c;typeof window!="undefined"?c=window:typeof s!="undefined"?c=s:typeof self!="undefined"?c=self:c={},i.exports=c}).call(this,typeof Tr!="undefined"?Tr:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],28:[function(n,i,o){var s=n("function-bind");i.exports=s.call(Function.call,Object.prototype.hasOwnProperty)},{"function-bind":26}],29:[function(n,i,o){o.read=function(s,c,u,h,f){var p,m,y=f*8-h-1,g=(1<<y)-1,_=g>>1,x=-7,b=u?f-1:0,E=u?-1:1,T=s[c+b];for(b+=E,p=T&(1<<-x)-1,T>>=-x,x+=y;x>0;p=p*256+s[c+b],b+=E,x-=8);for(m=p&(1<<-x)-1,p>>=-x,x+=h;x>0;m=m*256+s[c+b],b+=E,x-=8);if(p===0)p=1-_;else{if(p===g)return m?NaN:(T?-1:1)*(1/0);m=m+Math.pow(2,h),p=p-_}return(T?-1:1)*m*Math.pow(2,p-h)},o.write=function(s,c,u,h,f,p){var m,y,g,_=p*8-f-1,x=(1<<_)-1,b=x>>1,E=f===23?Math.pow(2,-24)-Math.pow(2,-77):0,T=h?0:p-1,P=h?1:-1,D=c<0||c===0&&1/c<0?1:0;for(c=Math.abs(c),isNaN(c)||c===1/0?(y=isNaN(c)?1:0,m=x):(m=Math.floor(Math.log(c)/Math.LN2),c*(g=Math.pow(2,-m))<1&&(m--,g*=2),m+b>=1?c+=E/g:c+=E*Math.pow(2,1-b),c*g>=2&&(m++,g/=2),m+b>=x?(y=0,m=x):m+b>=1?(y=(c*g-1)*Math.pow(2,f),m=m+b):(y=c*Math.pow(2,b-1)*Math.pow(2,f),m=0));f>=8;s[u+T]=y&255,T+=P,y/=256,f-=8);for(m=m<<f|y,_+=f;_>0;s[u+T]=m&255,T+=P,m/=256,_-=8);s[u+T-P]|=D*128}},{}],30:[function(n,i,o){typeof Object.create=="function"?i.exports=function(c,u){u&&(c.super_=u,c.prototype=Object.create(u.prototype,{constructor:{value:c,enumerable:!1,writable:!0,configurable:!0}}))}:i.exports=function(c,u){if(u){c.super_=u;var h=function(){};h.prototype=u.prototype,c.prototype=new h,c.prototype.constructor=c}}},{}],31:[function(n,i,o){/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */i.exports=function(u){return u!=null&&(s(u)||c(u)||!!u._isBuffer)};function s(u){return!!u.constructor&&typeof u.constructor.isBuffer=="function"&&u.constructor.isBuffer(u)}function c(u){return typeof u.readFloatLE=="function"&&typeof u.slice=="function"&&s(u.slice(0,0))}},{}],32:[function(n,i,o){var s=Function.prototype.toString,c=/^\s*class\b/,u=function(_){try{var x=s.call(_);return c.test(x)}catch{return!1}},h=function(_){try{return u(_)?!1:(s.call(_),!0)}catch{return!1}},f=Object.prototype.toString,p="[object Function]",m="[object GeneratorFunction]",y=typeof Symbol=="function"&&typeof Symbol.toStringTag=="symbol";i.exports=function(_){if(!_||typeof _!="function"&&typeof _!="object")return!1;if(typeof _=="function"&&!_.prototype)return!0;if(y)return h(_);if(u(_))return!1;var x=f.call(_);return x===p||x===m}},{}],33:[function(n,i,o){i.exports=c;var s=Object.prototype.toString;function c(u){var h=s.call(u);return h==="[object Function]"||typeof u=="function"&&h!=="[object RegExp]"||typeof window!="undefined"&&(u===window.setTimeout||u===window.alert||u===window.confirm||u===window.prompt)}},{}],34:[function(n,i,o){i.exports=function(s){var c=typeof s;return s!==null&&(c==="object"||c==="function")}},{}],35:[function(n,i,o){var s={}.toString;i.exports=Array.isArray||function(c){return s.call(c)=="[object Array]"}},{}],36:[function(n,i,o){var s=n("word-wrapper"),c=n("xtend"),u=n("as-number"),h=["x","e","a","o","n","s","r","c","u","m","v","w","z"],f=["m","w"],p=["H","I","N","E","F","K","L","T","U","V","W","X","Y","Z"],m="	".charCodeAt(0),y=" ".charCodeAt(0),g=0,_=1,x=2;i.exports=function(te){return new b(te)};function b(de){this.glyphs=[],this._measure=this.computeMetrics.bind(this),this.update(de)}b.prototype.update=function(de){if(de=c({measure:this._measure},de),this._opt=de,this._opt.tabSize=u(this._opt.tabSize,4),!de.font)throw new Error("must provide a valid bitmap font");var te=this.glyphs,N=de.text||"",L=de.font;this._setupSpaceGlyphs(L);var M=s.lines(N,de),I=de.width||0;te.length=0;var U=M.reduce(function(me,De){return Math.max(me,De.width,I)},0),$=0,ee=0,Q=u(de.lineHeight,L.common.lineHeight),G=L.common.base,K=Q-G,Y=de.letterSpacing||0,we=Q*M.length-K,Ke=j(this._opt.align);ee-=we,this._width=U,this._height=we,this._descender=Q-G,this._baseline=G,this._xHeight=D(L),this._capHeight=k(L),this._lineHeight=Q,this._ascender=Q-K-this._xHeight;var ge=this;M.forEach(function(me,De){for(var ze=me.start,tt=me.end,rt=me.width,vt,Ye=ze;Ye<tt;Ye++){var Pe=N.charCodeAt(Ye),Be=ge.getGlyph(L,Pe);if(Be){vt&&($+=W(L,vt.id,Be.id));var $e=$;Ke===_?$e+=(U-rt)/2:Ke===x&&($e+=U-rt),te.push({position:[$e,ee],data:Be,index:Ye,line:De}),$+=Be.xadvance+Y,vt=Be}}ee+=Q,$=0}),this._linesTotal=M.length},b.prototype._setupSpaceGlyphs=function(de){if(this._fallbackSpaceGlyph=null,this._fallbackTabGlyph=null,!(!de.chars||de.chars.length===0)){var te=P(de,y)||F(de)||de.chars[0],N=this._opt.tabSize*te.xadvance;this._fallbackSpaceGlyph=te,this._fallbackTabGlyph=c(te,{x:0,y:0,xadvance:N,id:m,xoffset:0,yoffset:0,width:0,height:0})}},b.prototype.getGlyph=function(de,te){var N=P(de,te);return N||(te===m?this._fallbackTabGlyph:te===y?this._fallbackSpaceGlyph:null)},b.prototype.computeMetrics=function(de,te,N,L){var M=this._opt.letterSpacing||0,I=this._opt.font,U=0,$=0,ee=0,Q,G;if(!I.chars||I.chars.length===0)return{start:te,end:te,width:0};N=Math.min(de.length,N);for(var K=te;K<N;K++){var Y=de.charCodeAt(K),Q=this.getGlyph(I,Y);if(Q){Q.xoffset;var we=G?W(I,G.id,Q.id):0;U+=we;var Ke=U+Q.xadvance+M,ge=U+Q.width;if(ge>=L||Ke>=L)break;U=Ke,$=ge,G=Q}ee++}return G&&($+=G.xoffset),{start:te,end:te+ee,width:$}},["width","height","descender","ascender","xHeight","baseline","capHeight","lineHeight"].forEach(E);function E(de){Object.defineProperty(b.prototype,de,{get:T(de),configurable:!0})}function T(de){return new Function(["return function "+de+"() {","  return this._"+de,"}"].join(`
`))()}function P(de,te){if(!de.chars||de.chars.length===0)return null;var N=J(de.chars,te);return N>=0?de.chars[N]:null}function D(de){for(var te=0;te<h.length;te++){var N=h[te].charCodeAt(0),L=J(de.chars,N);if(L>=0)return de.chars[L].height}return 0}function F(de){for(var te=0;te<f.length;te++){var N=f[te].charCodeAt(0),L=J(de.chars,N);if(L>=0)return de.chars[L]}return 0}function k(de){for(var te=0;te<p.length;te++){var N=p[te].charCodeAt(0),L=J(de.chars,N);if(L>=0)return de.chars[L].height}return 0}function W(de,te,N){if(!de.kernings||de.kernings.length===0)return 0;for(var L=de.kernings,M=0;M<L.length;M++){var I=L[M];if(I.first===te&&I.second===N)return I.amount}return 0}function j(de){return de==="center"?_:de==="right"?x:g}function J(de,te,N){N=N||0;for(var L=N;L<de.length;L++)if(de[L].id===te)return L;return-1}},{"as-number":2,"word-wrapper":70,xtend:73}],37:[function(n,i,o){(function(s){var c=n("xhr"),u=function(){},h=n("parse-bmfont-ascii"),f=n("parse-bmfont-xml"),p=n("parse-bmfont-binary"),m=n("./lib/is-binary"),y=n("xtend"),g=function(){return self.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}();i.exports=function(b,E){E=typeof E=="function"?E:u,typeof b=="string"?b={uri:b}:b||(b={});var T=b.binary;T&&(b=x(b)),c(b,function(P,D,F){if(P)return E(P);if(!/^2/.test(D.statusCode))return E(new Error("http status code: "+D.statusCode));if(!F)return E(new Error("no body result"));var k=!1;if(_(F)){var W=new Uint8Array(F);F=new s(W,"binary")}m(F)&&(k=!0,typeof F=="string"&&(F=new s(F,"binary"))),k||(s.isBuffer(F)&&(F=F.toString(b.encoding)),F=F.trim());var j;try{var J=D.headers["content-type"];k?j=p(F):/json/.test(J)||F.charAt(0)==="{"?j=JSON.parse(F):/xml/.test(J)||F.charAt(0)==="<"?j=f(F):j=h(F)}catch(de){E(new Error("error parsing font "+de.message)),E=u}E(null,j)})};function _(b){var E=Object.prototype.toString;return E.call(b)==="[object ArrayBuffer]"}function x(b){if(g)return y(b,{responseType:"arraybuffer"});if(typeof self.XMLHttpRequest=="undefined")throw new Error("your browser does not support XHR loading");var E=new self.XMLHttpRequest;return E.overrideMimeType("text/plain; charset=x-user-defined"),y({xhr:E},b)}}).call(this,n("buffer").Buffer)},{"./lib/is-binary":38,buffer:6,"parse-bmfont-ascii":43,"parse-bmfont-binary":44,"parse-bmfont-xml":45,xhr:71,xtend:73}],38:[function(n,i,o){(function(s){var c=n("buffer-equal"),u=new s([66,77,70,3]);i.exports=function(h){return typeof h=="string"?h.substring(0,3)==="BMF":h.length>4&&c(h.slice(0,4),u)}}).call(this,n("buffer").Buffer)},{buffer:6,"buffer-equal":5}],39:[function(n,i,o){var s=Object.getOwnPropertySymbols,c=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable;function h(p){if(p==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(p)}function f(){try{if(!Object.assign)return!1;var p=new String("abc");if(p[5]="de",Object.getOwnPropertyNames(p)[0]==="5")return!1;for(var m={},y=0;y<10;y++)m["_"+String.fromCharCode(y)]=y;var g=Object.getOwnPropertyNames(m).map(function(x){return m[x]});if(g.join("")!=="0123456789")return!1;var _={};return"abcdefghijklmnopqrst".split("").forEach(function(x){_[x]=x}),Object.keys(Object.assign({},_)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}i.exports=f()?Object.assign:function(p,m){for(var y,g=h(p),_,x=1;x<arguments.length;x++){y=Object(arguments[x]);for(var b in y)c.call(y,b)&&(g[b]=y[b]);if(s){_=s(y);for(var E=0;E<_.length;E++)u.call(y,_[E])&&(g[_[E]]=y[_[E]])}}return g}},{}],40:[function(n,i,o){var s;if(!Object.keys){var c=Object.prototype.hasOwnProperty,u=Object.prototype.toString,h=n("./isArguments"),f=Object.prototype.propertyIsEnumerable,p=!f.call({toString:null},"toString"),m=f.call(function(){},"prototype"),y=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],g=function(E){var T=E.constructor;return T&&T.prototype===E},_={$applicationCache:!0,$console:!0,$external:!0,$frame:!0,$frameElement:!0,$frames:!0,$innerHeight:!0,$innerWidth:!0,$onmozfullscreenchange:!0,$onmozfullscreenerror:!0,$outerHeight:!0,$outerWidth:!0,$pageXOffset:!0,$pageYOffset:!0,$parent:!0,$scrollLeft:!0,$scrollTop:!0,$scrollX:!0,$scrollY:!0,$self:!0,$webkitIndexedDB:!0,$webkitStorageInfo:!0,$window:!0},x=function(){if(typeof window=="undefined")return!1;for(var E in window)try{if(!_["$"+E]&&c.call(window,E)&&window[E]!==null&&typeof window[E]=="object")try{g(window[E])}catch{return!0}}catch{return!0}return!1}(),b=function(E){if(typeof window=="undefined"||!x)return g(E);try{return g(E)}catch{return!1}};s=function(T){var P=T!==null&&typeof T=="object",D=u.call(T)==="[object Function]",F=h(T),k=P&&u.call(T)==="[object String]",W=[];if(!P&&!D&&!F)throw new TypeError("Object.keys called on a non-object");var j=m&&D;if(k&&T.length>0&&!c.call(T,0))for(var J=0;J<T.length;++J)W.push(String(J));if(F&&T.length>0)for(var de=0;de<T.length;++de)W.push(String(de));else for(var te in T)!(j&&te==="prototype")&&c.call(T,te)&&W.push(String(te));if(p)for(var N=b(T),L=0;L<y.length;++L)!(N&&y[L]==="constructor")&&c.call(T,y[L])&&W.push(y[L]);return W}}i.exports=s},{"./isArguments":42}],41:[function(n,i,o){var s=Array.prototype.slice,c=n("./isArguments"),u=Object.keys,h=u?function(m){return u(m)}:n("./implementation"),f=Object.keys;h.shim=function(){if(Object.keys){var m=function(){var y=Object.keys(arguments);return y&&y.length===arguments.length}(1,2);m||(Object.keys=function(g){return c(g)?f(s.call(g)):f(g)})}else Object.keys=h;return Object.keys||h},i.exports=h},{"./implementation":40,"./isArguments":42}],42:[function(n,i,o){var s=Object.prototype.toString;i.exports=function(u){var h=s.call(u),f=h==="[object Arguments]";return f||(f=h!=="[object Array]"&&u!==null&&typeof u=="object"&&typeof u.length=="number"&&u.length>=0&&s.call(u.callee)==="[object Function]"),f}},{}],43:[function(n,i,o){i.exports=function(f){if(!f)throw new Error("no data provided");f=f.toString().trim();var p={pages:[],chars:[],kernings:[]},m=f.split(/\r\n?|\n/g);if(m.length===0)throw new Error("no data in BMFont file");for(var y=0;y<m.length;y++){var g=s(m[y],y);if(!!g)if(g.key==="page"){if(typeof g.data.id!="number")throw new Error("malformed file at line "+y+" -- needs page id=N");if(typeof g.data.file!="string")throw new Error("malformed file at line "+y+' -- needs page file="path"');p.pages[g.data.id]=g.data.file}else g.key==="chars"||g.key==="kernings"||(g.key==="char"?p.chars.push(g.data):g.key==="kerning"?p.kernings.push(g.data):p[g.key]=g.data)}return p};function s(h,f){if(h=h.replace(/\t+/g," ").trim(),!h)return null;var p=h.indexOf(" ");if(p===-1)throw new Error("no named row at line "+f);var m=h.substring(0,p);h=h.substring(p+1),h=h.replace(/letter=[\'\"]\S+[\'\"]/gi,""),h=h.split("="),h=h.map(function(b){return b.trim().match(/(".*?"|[^"\s]+)+(?=\s*|\s*$)/g)});for(var y=[],g=0;g<h.length;g++){var _=h[g];g===0?y.push({key:_[0],data:""}):g===h.length-1?y[y.length-1].data=c(_[0]):(y[y.length-1].data=c(_[0]),y.push({key:_[1],data:""}))}var x={key:m,data:{}};return y.forEach(function(b){x.data[b.key]=b.data}),x}function c(h){return!h||h.length===0?"":h.indexOf('"')===0||h.indexOf("'")===0?h.substring(1,h.length-1):h.indexOf(",")!==-1?u(h):parseInt(h,10)}function u(h){return h.split(",").map(function(f){return parseInt(f,10)})}},{}],44:[function(n,i,o){var s=[66,77,70];i.exports=function(x){if(x.length<6)throw new Error("invalid buffer length for BMFont");var b=s.every(function(F,k){return x.readUInt8(k)===F});if(!b)throw new Error("BMFont missing BMF byte header");var E=3,T=x.readUInt8(E++);if(T>3)throw new Error("Only supports BMFont Binary v3 (BMFont App v1.10)");for(var P={kernings:[],chars:[]},D=0;D<5;D++)E+=c(P,x,E);return P};function c(_,x,b){if(b>x.length-1)return 0;var E=x.readUInt8(b++),T=x.readInt32LE(b);switch(b+=4,E){case 1:_.info=u(x,b);break;case 2:_.common=h(x,b);break;case 3:_.pages=f(x,b,T);break;case 4:_.chars=p(x,b,T);break;case 5:_.kernings=m(x,b,T);break}return 5+T}function u(_,x){var b={};b.size=_.readInt16LE(x);var E=_.readUInt8(x+2);return b.smooth=E>>7&1,b.unicode=E>>6&1,b.italic=E>>5&1,b.bold=E>>4&1,E>>3&1&&(b.fixedHeight=1),b.charset=_.readUInt8(x+3)||"",b.stretchH=_.readUInt16LE(x+4),b.aa=_.readUInt8(x+6),b.padding=[_.readInt8(x+7),_.readInt8(x+8),_.readInt8(x+9),_.readInt8(x+10)],b.spacing=[_.readInt8(x+11),_.readInt8(x+12)],b.outline=_.readUInt8(x+13),b.face=g(_,x+14),b}function h(_,x){var b={};return b.lineHeight=_.readUInt16LE(x),b.base=_.readUInt16LE(x+2),b.scaleW=_.readUInt16LE(x+4),b.scaleH=_.readUInt16LE(x+6),b.pages=_.readUInt16LE(x+8),_.readUInt8(x+10),b.packed=0,b.alphaChnl=_.readUInt8(x+11),b.redChnl=_.readUInt8(x+12),b.greenChnl=_.readUInt8(x+13),b.blueChnl=_.readUInt8(x+14),b}function f(_,x,b){for(var E=[],T=y(_,x),P=T.length+1,D=b/P,F=0;F<D;F++)E[F]=_.slice(x,x+T.length).toString("utf8"),x+=P;return E}function p(_,x,b){for(var E=[],T=b/20,P=0;P<T;P++){var D={},F=P*20;D.id=_.readUInt32LE(x+0+F),D.x=_.readUInt16LE(x+4+F),D.y=_.readUInt16LE(x+6+F),D.width=_.readUInt16LE(x+8+F),D.height=_.readUInt16LE(x+10+F),D.xoffset=_.readInt16LE(x+12+F),D.yoffset=_.readInt16LE(x+14+F),D.xadvance=_.readInt16LE(x+16+F),D.page=_.readUInt8(x+18+F),D.chnl=_.readUInt8(x+19+F),E[P]=D}return E}function m(_,x,b){for(var E=[],T=b/10,P=0;P<T;P++){var D={},F=P*10;D.first=_.readUInt32LE(x+0+F),D.second=_.readUInt32LE(x+4+F),D.amount=_.readInt16LE(x+8+F),E[P]=D}return E}function y(_,x){for(var b=x;b<_.length&&_[b]!==0;b++);return _.slice(x,b)}function g(_,x){return y(_,x).toString("utf8")}},{}],45:[function(n,i,o){var s=n("./parse-attribs"),c=n("xml-parse-from-string"),u={scaleh:"scaleH",scalew:"scaleW",stretchh:"stretchH",lineheight:"lineHeight",alphachnl:"alphaChnl",redchnl:"redChnl",greenchnl:"greenChnl",bluechnl:"blueChnl"};i.exports=function(y){y=y.toString();var g=c(y),_={pages:[],chars:[],kernings:[]};["info","common"].forEach(function(F){var k=g.getElementsByTagName(F)[0];k&&(_[F]=s(h(k)))});var x=g.getElementsByTagName("pages")[0];if(!x)throw new Error("malformed file -- no <pages> element");for(var b=x.getElementsByTagName("page"),E=0;E<b.length;E++){var T=b[E],P=parseInt(T.getAttribute("id"),10),D=T.getAttribute("file");if(isNaN(P))throw new Error('malformed file -- page "id" attribute is NaN');if(!D)throw new Error('malformed file -- needs page "file" attribute');_.pages[parseInt(P,10)]=D}return["chars","kernings"].forEach(function(F){var k=g.getElementsByTagName(F)[0];if(!!k)for(var W=F.substring(0,F.length-1),j=k.getElementsByTagName(W),J=0;J<j.length;J++){var de=j[J];_[F].push(s(h(de)))}}),_};function h(m){var y=f(m);return y.reduce(function(g,_){var x=p(_.nodeName);return g[x]=_.nodeValue,g},{})}function f(m){for(var y=[],g=0;g<m.attributes.length;g++)y.push(m.attributes[g]);return y}function p(m){return u[m.toLowerCase()]||m}},{"./parse-attribs":46,"xml-parse-from-string":72}],46:[function(n,i,o){var s="chasrset";i.exports=function(h){s in h&&(h.charset=h[s],delete h[s]);for(var f in h)f==="face"||f==="charset"||(f==="padding"||f==="spacing"?h[f]=c(h[f]):h[f]=parseInt(h[f],10));return h};function c(u){return u.split(",").map(function(h){return parseInt(h,10)})}},{}],47:[function(n,i,o){var s=n("string.prototype.trim"),c=n("for-each"),u=function(h){return Object.prototype.toString.call(h)==="[object Array]"};i.exports=function(h){if(!h)return{};var f={};return c(s(h).split(`
`),function(p){var m=p.indexOf(":"),y=s(p.slice(0,m)).toLowerCase(),g=s(p.slice(m+1));typeof f[y]=="undefined"?f[y]=g:u(f[y])?f[y].push(g):f[y]=[f[y],g]}),f}},{"for-each":24,"string.prototype.trim":53}],48:[function(n,i,o){(function(s){var c=s.performance||{},u=function(){for(var h=["now","webkitNow","msNow","mozNow","oNow"];h.length;){var f=h.shift();if(f in c)return c[f].bind(c)}var p=Date.now||function(){return new Date().getTime()},m=(c.timing||{}).navigationStart||p();return function(){return p()-m}}();u.performanceNow=c.now,u.noConflict=function(){c.now=u.performanceNow},u.conflict=function(){c.now=u},u.conflict(),i.exports=u}).call(this,typeof Tr!="undefined"?Tr:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],49:[function(n,i,o){var s=i.exports={},c,u;function h(){throw new Error("setTimeout has not been defined")}function f(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?c=setTimeout:c=h}catch{c=h}try{typeof clearTimeout=="function"?u=clearTimeout:u=f}catch{u=f}})();function p(D){if(c===setTimeout)return setTimeout(D,0);if((c===h||!c)&&setTimeout)return c=setTimeout,setTimeout(D,0);try{return c(D,0)}catch{try{return c.call(null,D,0)}catch{return c.call(this,D,0)}}}function m(D){if(u===clearTimeout)return clearTimeout(D);if((u===f||!u)&&clearTimeout)return u=clearTimeout,clearTimeout(D);try{return u(D)}catch{try{return u.call(null,D)}catch{return u.call(this,D)}}}var y=[],g=!1,_,x=-1;function b(){!g||!_||(g=!1,_.length?y=_.concat(y):x=-1,y.length&&E())}function E(){if(!g){var D=p(b);g=!0;for(var F=y.length;F;){for(_=y,y=[];++x<F;)_&&_[x].run();x=-1,F=y.length}_=null,g=!1,m(D)}}s.nextTick=function(D){var F=new Array(arguments.length-1);if(arguments.length>1)for(var k=1;k<arguments.length;k++)F[k-1]=arguments[k];y.push(new T(D,F)),y.length===1&&!g&&p(E)};function T(D,F){this.fun=D,this.array=F}T.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={};function P(){}s.on=P,s.addListener=P,s.once=P,s.off=P,s.removeListener=P,s.removeAllListeners=P,s.emit=P,s.prependListener=P,s.prependOnceListener=P,s.listeners=function(D){return[]},s.binding=function(D){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(D){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},{}],50:[function(n,i,o){(function(s){(function(c){var u=setTimeout,h=typeof s=="function"&&s||function(T){u(T,1)};function f(T,P){return function(){T.apply(P,arguments)}}var p=Array.isArray||function(T){return Object.prototype.toString.call(T)==="[object Array]"};function m(T){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");if(typeof T!="function")throw new TypeError("not a function");this._state=null,this._value=null,this._deferreds=[],E(T,f(g,this),f(_,this))}function y(T){var P=this;if(this._state===null){this._deferreds.push(T);return}h(function(){var D=P._state?T.onFulfilled:T.onRejected;if(D===null){(P._state?T.resolve:T.reject)(P._value);return}var F;try{F=D(P._value)}catch(k){T.reject(k);return}T.resolve(F)})}function g(T){try{if(T===this)throw new TypeError("A promise cannot be resolved with itself.");if(T&&(typeof T=="object"||typeof T=="function")){var P=T.then;if(typeof P=="function"){E(f(P,T),f(g,this),f(_,this));return}}this._state=!0,this._value=T,x.call(this)}catch(D){_.call(this,D)}}function _(T){this._state=!1,this._value=T,x.call(this)}function x(){for(var T=0,P=this._deferreds.length;T<P;T++)y.call(this,this._deferreds[T]);this._deferreds=null}function b(T,P,D,F){this.onFulfilled=typeof T=="function"?T:null,this.onRejected=typeof P=="function"?P:null,this.resolve=D,this.reject=F}function E(T,P,D){var F=!1;try{T(function(k){F||(F=!0,P(k))},function(k){F||(F=!0,D(k))})}catch(k){if(F)return;F=!0,D(k)}}m.prototype.catch=function(T){return this.then(null,T)},m.prototype.then=function(T,P){var D=this;return new m(function(F,k){y.call(D,new b(T,P,F,k))})},m.all=function(){var T=Array.prototype.slice.call(arguments.length===1&&p(arguments[0])?arguments[0]:arguments);return new m(function(P,D){if(T.length===0)return P([]);var F=T.length;function k(j,J){try{if(J&&(typeof J=="object"||typeof J=="function")){var de=J.then;if(typeof de=="function"){de.call(J,function(te){k(j,te)},D);return}}T[j]=J,--F===0&&P(T)}catch(te){D(te)}}for(var W=0;W<T.length;W++)k(W,T[W])})},m.resolve=function(T){return T&&typeof T=="object"&&T.constructor===m?T:new m(function(P){P(T)})},m.reject=function(T){return new m(function(P,D){D(T)})},m.race=function(T){return new m(function(P,D){for(var F=0,k=T.length;F<k;F++)T[F].then(P,D)})},m._setImmediateFn=function(P){h=P},typeof i!="undefined"&&i.exports?i.exports=m:c.Promise||(c.Promise=m)})(this)}).call(this,n("timers").setImmediate)},{timers:68}],51:[function(n,i,o){var s=n("dtype"),c=n("an-array"),u=n("is-buffer"),h=[0,2,3],f=[2,1,3];i.exports=function(m,y){(!m||!(c(m)||u(m)))&&(y=m||{},m=null),typeof y=="number"?y={count:y}:y=y||{};for(var g=typeof y.type=="string"?y.type:"uint16",_=typeof y.count=="number"?y.count:1,x=y.start||0,b=y.clockwise!==!1?h:f,E=b[0],T=b[1],P=b[2],D=_*6,F=m||new(s(g))(D),k=0,W=0;k<D;k+=6,W+=4){var j=k+x;F[j+0]=W+0,F[j+1]=W+1,F[j+2]=W+2,F[j+3]=W+E,F[j+4]=W+T,F[j+5]=W+P}return F}},{"an-array":1,dtype:13,"is-buffer":31}],52:[function(n,i,o){var s=n("function-bind"),c=n("es-abstract/es5"),u=s.call(Function.call,String.prototype.replace),h=/^[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+/,f=/[\x09\x0A\x0B\x0C\x0D\x20\xA0\u1680\u180E\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200A\u202F\u205F\u3000\u2028\u2029\uFEFF]+$/;i.exports=function(){var m=c.ToString(c.CheckObjectCoercible(this));return u(u(m,h,""),f,"")}},{"es-abstract/es5":15,"function-bind":26}],53:[function(n,i,o){var s=n("function-bind"),c=n("define-properties"),u=n("./implementation"),h=n("./polyfill"),f=n("./shim"),p=s.call(Function.call,h());c(p,{getPolyfill:h,implementation:u,shim:f}),i.exports=p},{"./implementation":52,"./polyfill":54,"./shim":55,"define-properties":11,"function-bind":26}],54:[function(n,i,o){var s=n("./implementation"),c="\u200B";i.exports=function(){return String.prototype.trim&&c.trim()===c?String.prototype.trim:s}},{"./implementation":52}],55:[function(n,i,o){var s=n("define-properties"),c=n("./polyfill");i.exports=function(){var h=c();return s(String.prototype,{trim:h},{trim:function(){return String.prototype.trim!==h}}),h}},{"./polyfill":54,"define-properties":11}],56:[function(n,i,o){var s={update:null,begin:null,loopBegin:null,changeBegin:null,change:null,changeComplete:null,loopComplete:null,complete:null,loop:1,direction:"normal",autoplay:!0,timelineOffset:0},c={duration:1e3,delay:0,endDelay:0,easing:"easeOutElastic(1, .5)",round:0},u=["translateX","translateY","translateZ","rotate","rotateX","rotateY","rotateZ","scale","scaleX","scaleY","scaleZ","skew","skewX","skewY","perspective"],h={CSS:{},springs:{}};function f(Re,Ue,Xe){return Math.min(Math.max(Re,Ue),Xe)}function p(Re,Ue){return Re.indexOf(Ue)>-1}function m(Re,Ue){return Re.apply(null,Ue)}var y=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i,g=/^rgb/,_=/^hsl/,x={arr:function(Re){return Array.isArray(Re)},obj:function(Re){return p(Object.prototype.toString.call(Re),"Object")},pth:function(Re){return x.obj(Re)&&Re.hasOwnProperty("totalLength")},svg:function(Re){return Re instanceof SVGElement},inp:function(Re){return Re instanceof HTMLInputElement},dom:function(Re){return Re.nodeType||x.svg(Re)},str:function(Re){return typeof Re=="string"},fnc:function(Re){return typeof Re=="function"},und:function(Re){return typeof Re=="undefined"},hex:function(Re){return y.test(Re)},rgb:function(Re){return g.test(Re)},hsl:function(Re){return _.test(Re)},col:function(Re){return x.hex(Re)||x.rgb(Re)||x.hsl(Re)},key:function(Re){return!s.hasOwnProperty(Re)&&!c.hasOwnProperty(Re)&&Re!=="targets"&&Re!=="keyframes"}},b=/\(([^)]+)\)/;function E(Re){var Ue=b.exec(Re);return Ue?Ue[1].split(",").map(function(Xe){return parseFloat(Xe)}):[]}function T(Re,Ue){var Xe=E(Re),ft=f(x.und(Xe[0])?1:Xe[0],.1,100),it=f(x.und(Xe[1])?100:Xe[1],.1,100),xt=f(x.und(Xe[2])?10:Xe[2],.1,100),Dt=f(x.und(Xe[3])?0:Xe[3],.1,100),Kt=Math.sqrt(it/ft),Wt=xt/(2*Math.sqrt(it*ft)),bt=Wt<1?Kt*Math.sqrt(1-Wt*Wt):0,jt=1,on=Wt<1?(Wt*Kt+-Dt)/bt:-Dt+Kt;function $t(Jt){var nn=Ue?Ue*Jt/1e3:Jt;return Wt<1?nn=Math.exp(-nn*Wt*Kt)*(jt*Math.cos(bt*nn)+on*Math.sin(bt*nn)):nn=(jt+on*nn)*Math.exp(-nn*Kt),Jt===0||Jt===1?Jt:1-nn}function vn(){var Jt=h.springs[Re];if(Jt)return Jt;for(var nn=1/6,hn=0,rn=0;;)if(hn+=nn,$t(hn)===1){if(rn++,rn>=16)break}else rn=0;var Rt=hn*nn*1e3;return h.springs[Re]=Rt,Rt}return Ue?$t:vn}function P(Re,Ue){Re===void 0&&(Re=1),Ue===void 0&&(Ue=.5);var Xe=f(Re,1,10),ft=f(Ue,.1,2);return function(it){return it===0||it===1?it:-Xe*Math.pow(2,10*(it-1))*Math.sin((it-1-ft/(Math.PI*2)*Math.asin(1/Xe))*(Math.PI*2)/ft)}}function D(Re){return Re===void 0&&(Re=10),function(Ue){return Math.round(Ue*Re)*(1/Re)}}var F=function(){var Re=11,Ue=1/(Re-1);function Xe(jt,on){return 1-3*on+3*jt}function ft(jt,on){return 3*on-6*jt}function it(jt){return 3*jt}function xt(jt,on,$t){return((Xe(on,$t)*jt+ft(on,$t))*jt+it(on))*jt}function Dt(jt,on,$t){return 3*Xe(on,$t)*jt*jt+2*ft(on,$t)*jt+it(on)}function Kt(jt,on,$t,vn,Jt){var nn,hn,rn=0;do hn=on+($t-on)/2,nn=xt(hn,vn,Jt)-jt,nn>0?$t=hn:on=hn;while(Math.abs(nn)>1e-7&&++rn<10);return hn}function Wt(jt,on,$t,vn){for(var Jt=0;Jt<4;++Jt){var nn=Dt(on,$t,vn);if(nn===0)return on;var hn=xt(on,$t,vn)-jt;on-=hn/nn}return on}function bt(jt,on,$t,vn){if(!(0<=jt&&jt<=1&&0<=$t&&$t<=1))return;var Jt=new Float32Array(Re);if(jt!==on||$t!==vn)for(var nn=0;nn<Re;++nn)Jt[nn]=xt(nn*Ue,jt,$t);function hn(rn){for(var Rt=0,yt=1,Bt=Re-1;yt!==Bt&&Jt[yt]<=rn;++yt)Rt+=Ue;--yt;var Ft=(rn-Jt[yt])/(Jt[yt+1]-Jt[yt]),Zt=Rt+Ft*Ue,en=Dt(Zt,jt,$t);return en>=.001?Wt(rn,Zt,jt,$t):en===0?Zt:Kt(rn,Rt,Rt+Ue,jt,$t)}return function(rn){return jt===on&&$t===vn||rn===0||rn===1?rn:xt(hn(rn),on,vn)}}return bt}(),k=function(){var Re=["Quad","Cubic","Quart","Quint","Sine","Expo","Circ","Back","Elastic"],Ue={In:[[.55,.085,.68,.53],[.55,.055,.675,.19],[.895,.03,.685,.22],[.755,.05,.855,.06],[.47,0,.745,.715],[.95,.05,.795,.035],[.6,.04,.98,.335],[.6,-.28,.735,.045],P],Out:[[.25,.46,.45,.94],[.215,.61,.355,1],[.165,.84,.44,1],[.23,1,.32,1],[.39,.575,.565,1],[.19,1,.22,1],[.075,.82,.165,1],[.175,.885,.32,1.275],function(Dt,Kt){return function(Wt){return 1-P(Dt,Kt)(1-Wt)}}],InOut:[[.455,.03,.515,.955],[.645,.045,.355,1],[.77,0,.175,1],[.86,0,.07,1],[.445,.05,.55,.95],[1,0,0,1],[.785,.135,.15,.86],[.68,-.55,.265,1.55],function(Dt,Kt){return function(Wt){return Wt<.5?P(Dt,Kt)(Wt*2)/2:1-P(Dt,Kt)(Wt*-2+2)/2}}]},Xe={linear:[.25,.25,.75,.75]};for(var ft in Ue)for(var it=0,xt=Ue[ft].length;it<xt;it++)Xe["ease"+ft+Re[it]]=Ue[ft][it];return Xe}();function W(Re,Ue){if(x.fnc(Re))return Re;var Xe=Re.split("(")[0],ft=k[Xe],it=E(Re);switch(Xe){case"spring":return T(Re,Ue);case"cubicBezier":return m(F,it);case"steps":return m(D,it);default:return x.fnc(ft)?m(ft,it):m(F,ft)}}function j(Re){try{var Ue=document.querySelectorAll(Re);return Ue}catch{return}}var J=[];function de(Re,Ue){for(var Xe=J,ft=Re.length,it=arguments.length>=2?arguments[1]:void 0,xt=0;xt<ft;xt++)if(xt in Re){var Dt=Re[xt];Ue.call(it,Dt,xt,Re)&&Xe.push(Dt)}return J=Re,J.length=0,Xe}function te(Re,Ue){Ue||(Ue=[]);for(var Xe=0,ft=Re.length;Xe<ft;Xe++){var it=Re[Xe];Array.isArray(it)?te(it,Ue):Ue.push(it)}return Ue}function N(Re){return x.arr(Re)?Re:(x.str(Re)&&(Re=j(Re)||Re),Re instanceof NodeList||Re instanceof HTMLCollection?[].slice.call(Re):[Re])}function L(Re,Ue){return Re.some(function(Xe){return Xe===Ue})}function M(Re){var Ue={};for(var Xe in Re)Ue[Xe]=Re[Xe];return Ue}function I(Re,Ue){var Xe=M(Re);for(var ft in Re)Xe[ft]=Ue.hasOwnProperty(ft)?Ue[ft]:Re[ft];return Xe}function U(Re,Ue){var Xe=M(Re);for(var ft in Ue)Xe[ft]=x.und(Re[ft])?Ue[ft]:Re[ft];return Xe}var $=/rgb\((\d+,\s*[\d]+,\s*[\d]+)\)/g;function ee(Re){var Ue=$.exec(Re);return Ue?"rgba("+Ue[1]+",1)":Re}var Q=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,G=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i;function K(Re){var Ue=Re.replace(Q,function(Dt,Kt,Wt,bt){return Kt+Kt+Wt+Wt+bt+bt}),Xe=G.exec(Ue),ft=parseInt(Xe[1],16),it=parseInt(Xe[2],16),xt=parseInt(Xe[3],16);return"rgba("+ft+","+it+","+xt+",1)"}var Y=/hsl\((\d+),\s*([\d.]+)%,\s*([\d.]+)%\)/g,we=/hsla\((\d+),\s*([\d.]+)%,\s*([\d.]+)%,\s*([\d.]+)\)/g;function Ke(Re){var Ue=Y.exec(Re)||we.exec(Re),Xe=parseInt(Ue[1],10)/360,ft=parseInt(Ue[2],10)/100,it=parseInt(Ue[3],10)/100,xt=Ue[4]||1;function Dt($t,vn,Jt){return Jt<0&&(Jt+=1),Jt>1&&(Jt-=1),Jt<1/6?$t+(vn-$t)*6*Jt:Jt<1/2?vn:Jt<2/3?$t+(vn-$t)*(2/3-Jt)*6:$t}var Kt,Wt,bt;if(ft==0)Kt=Wt=bt=it;else{var jt=it<.5?it*(1+ft):it+ft-it*ft,on=2*it-jt;Kt=Dt(on,jt,Xe+1/3),Wt=Dt(on,jt,Xe),bt=Dt(on,jt,Xe-1/3)}return"rgba("+Kt*255+","+Wt*255+","+bt*255+","+xt+")"}function ge(Re){if(x.rgb(Re))return ee(Re);if(x.hex(Re))return K(Re);if(x.hsl(Re))return Ke(Re)}var me=/([\+\-]?[0-9#\.]+)(%|px|pt|em|rem|in|cm|mm|ex|ch|pc|vw|vh|vmin|vmax|deg|rad|turn)?$/;function De(Re){var Ue=me.exec(Re);if(Ue)return Ue[2]}function ze(Re){if(p(Re,"translate")||Re==="perspective")return"px";if(p(Re,"rotate")||p(Re,"skew"))return"deg"}function tt(Re,Ue){return x.fnc(Re)?Re(Ue.target,Ue.id,Ue.total):Re}function rt(Re,Ue){return Re.getAttribute(Ue)}function vt(Re,Ue,Xe){var ft=De(Ue);if(L([Xe,"deg","rad","turn"],ft))return Ue;var it=h.CSS[Ue+Xe];if(!x.und(it))return it;var xt=100,Dt=document.createElement(Re.tagName),Kt=Re.parentNode&&Re.parentNode!==document?Re.parentNode:document.body;Kt.appendChild(Dt),Dt.style.position="absolute",Dt.style.width=xt+Xe;var Wt=xt/Dt.offsetWidth;Kt.removeChild(Dt);var bt=Wt*parseFloat(Ue);return h.CSS[Ue+Xe]=bt,bt}function Ye(Re,Ue,Xe){if(Ue in Re.style){var ft=Ue.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase(),it=Re.style[Ue]||getComputedStyle(Re).getPropertyValue(ft)||"0";return Xe?vt(Re,it,Xe):it}}function Pe(Re,Ue){if(x.dom(Re)&&!x.inp(Re)&&(rt(Re,Ue)||x.svg(Re)&&Re[Ue]))return"attribute";if(x.dom(Re)&&L(u,Ue))return"transform";if(x.dom(Re)&&Ue!=="transform"&&Ye(Re,Ue))return"css";if(Re[Ue]!=null)return"object"}var Be=/(\w+)\(([^)]*)\)/g;function $e(Re){if(!!x.dom(Re)){for(var Ue=Re.style.transform||"",Xe=new Map,ft;ft=Be.exec(Ue);)Xe.set(ft[1],ft[2]);return Xe}}function Je(Re,Ue,Xe,ft){var it=p(Ue,"scale")?1:0+ze(Ue),xt=$e(Re).get(Ue)||it;return Xe&&(Xe.transforms.list.set(Ue,xt),Xe.transforms.last=Ue),ft?vt(Re,xt,ft):xt}function We(Re,Ue,Xe,ft){switch(Pe(Re,Ue)){case"transform":return Je(Re,Ue,ft,Xe);case"css":return Ye(Re,Ue,Xe);case"attribute":return rt(Re,Ue);default:return Re[Ue]||0}}var _e=/^(\*=|\+=|-=)/;function Ee(Re,Ue){var Xe=_e.exec(Re);if(!Xe)return Re;var ft=De(Re)||0,it=parseFloat(Ue),xt=parseFloat(Re.replace(Xe[0],""));switch(Xe[0][0]){case"+":return it+xt+ft;case"-":return it-xt+ft;case"*":return it*xt+ft}}var Oe=/\s/g;function Le(Re,Ue){if(x.col(Re))return ge(Re);var Xe=De(Re),ft=Xe?Re.substr(0,Re.length-Xe.length):Re;return Ue&&!Oe.test(Re)?ft+Ue:ft}function ce(Re,Ue){return Math.sqrt(Math.pow(Ue.x-Re.x,2)+Math.pow(Ue.y-Re.y,2))}function he(Re){return Math.PI*2*rt(Re,"r")}function ie(Re){return rt(Re,"width")*2+rt(Re,"height")*2}function V(Re){return ce({x:rt(Re,"x1"),y:rt(Re,"y1")},{x:rt(Re,"x2"),y:rt(Re,"y2")})}function Z(Re){for(var Ue=Re.points,Xe=0,ft,it=0;it<Ue.numberOfItems;it++){var xt=Ue.getItem(it);it>0&&(Xe+=ce(ft,xt)),ft=xt}return Xe}function B(Re){var Ue=Re.points;return Z(Re)+ce(Ue.getItem(Ue.numberOfItems-1),Ue.getItem(0))}function S(Re){if(Re.getTotalLength)return Re.getTotalLength();switch(Re.tagName.toLowerCase()){case"circle":return he(Re);case"rect":return ie(Re);case"line":return V(Re);case"polyline":return Z(Re);case"polygon":return B(Re)}}function R(Re){var Ue=S(Re);return Re.setAttribute("stroke-dasharray",Ue),Ue}function X(Re){for(var Ue=Re.parentNode;x.svg(Ue)&&(Ue=Ue.parentNode,!!x.svg(Ue.parentNode)););return Ue}function xe(Re,Ue){var Xe=Ue||{},ft=Xe.el||X(Re),it=ft.getBoundingClientRect(),xt=rt(ft,"viewBox"),Dt=it.width,Kt=it.height,Wt=Xe.viewBox||(xt?xt.split(" "):[0,0,Dt,Kt]);return{el:ft,viewBox:Wt,x:Wt[0]/1,y:Wt[1]/1,w:Dt/Wt[2],h:Kt/Wt[3]}}function Ie(Re,Ue){var Xe=x.str(Re)?j(Re)[0]:Re,ft=Ue||100;return function(it){return{property:it,el:Xe,svg:xe(Xe),totalLength:S(Xe)*(ft/100)}}}function ye(Re,Ue){function Xe(Kt){Kt===void 0&&(Kt=0);var Wt=Ue+Kt>=1?Ue+Kt:0;return Re.el.getPointAtLength(Wt)}var ft=xe(Re.el,Re.svg),it=Xe(),xt=Xe(-1),Dt=Xe(1);switch(Re.property){case"x":return(it.x-ft.x)*ft.w;case"y":return(it.y-ft.y)*ft.h;case"angle":return Math.atan2(Dt.y-xt.y,Dt.x-xt.x)*180/Math.PI}}var nt=/-?\d*\.?\d+/g;function at(Re,Ue){var Xe=Le(x.pth(Re)?Re.totalLength:Re,Ue)+"";return{original:Xe,numbers:Xe.match(nt)?Xe.match(nt).map(Number):[0],strings:x.str(Re)||Ue?Xe.split(nt):[]}}function mt(Re){var Ue=Re?te(x.arr(Re)?Re.map(N):N(Re)):[];return de(Ue,function(Xe,ft,it){return it.indexOf(Xe)===ft})}function wt(Re){var Ue=mt(Re);return Ue.map(function(Xe,ft){return{target:Xe,id:ft,total:Ue.length,transforms:{list:$e(Xe)}}})}var Lt=/^spring/;function Ct(Re,Ue){var Xe=M(Ue);if(Lt.test(Xe.easing)&&(Xe.duration=T(Xe.easing)),x.arr(Re)){var ft=Re.length,it=ft===2&&!x.obj(Re[0]);it?Re={value:Re}:x.fnc(Ue.duration)||(Xe.duration=Ue.duration/ft)}var xt=x.arr(Re)?Re:[Re];return xt.map(function(Dt,Kt){var Wt=x.obj(Dt)&&!x.pth(Dt)?Dt:{value:Dt};return x.und(Wt.delay)&&(Wt.delay=Kt?0:Ue.delay),x.und(Wt.endDelay)&&(Wt.endDelay=Kt===xt.length-1?Ue.endDelay:0),Wt}).map(function(Dt){return U(Dt,Xe)})}function ut(Re){for(var Ue=de(te(Re.map(function(xt){return Object.keys(xt)})),function(xt){return x.key(xt)}).reduce(function(xt,Dt){return xt.indexOf(Dt)<0&&xt.push(Dt),xt},[]),Xe={},ft=function(xt){var Dt=Ue[xt];Xe[Dt]=Re.map(function(Kt){var Wt={};for(var bt in Kt)x.key(bt)?bt==Dt&&(Wt.value=Kt[bt]):Wt[bt]=Kt[bt];return Wt})},it=0;it<Ue.length;it++)ft(it);return Xe}function St(Re,Ue){var Xe=[],ft=Ue.keyframes;ft&&(Ue=U(ut(ft),Ue));for(var it in Ue)x.key(it)&&Xe.push({name:it,tweens:Ct(Ue[it],Re)});return Xe}function Tt(Re,Ue){var Xe={};for(var ft in Re){var it=tt(Re[ft],Ue);x.arr(it)&&(it=it.map(function(xt){return tt(xt,Ue)}),it.length===1&&(it=it[0])),Xe[ft]=it}return Xe.duration=parseFloat(Xe.duration),Xe.delay=parseFloat(Xe.delay),Xe}function gn(Re,Ue){var Xe;return Re.tweens.map(function(ft){var it=Tt(ft,Ue),xt=it.value,Dt=x.arr(xt)?xt[1]:xt,Kt=De(Dt),Wt=We(Ue.target,Re.name,Kt,Ue),bt=Xe?Xe.to.original:Wt,jt=x.arr(xt)?xt[0]:bt,on=De(jt)||De(Wt),$t=Kt||on;return x.und(Dt)&&(Dt=bt),it.from=at(jt,$t),it.to=at(Ee(Dt,jt),$t),it.start=Xe?Xe.end:0,it.end=it.start+it.delay+it.duration+it.endDelay,it.easing=W(it.easing,it.duration),it.isPath=x.pth(xt),it.isColor=x.col(it.from.original),it.isColor&&(it.round=1),Xe=it,it})}var An={css:function(Re,Ue,Xe){return Re.style[Ue]=Xe},attribute:function(Re,Ue,Xe){return Re.setAttribute(Ue,Xe)},object:function(Re,Ue,Xe){return Re[Ue]=Xe},transform:function(Re,Ue,Xe,ft,it){if(ft.list.set(Ue,Xe),Ue===ft.last||it){var xt="";ft.list.forEach(function(Dt,Kt){xt+=Kt+"("+Dt+") "}),Re.style.transform=xt}}};function un(Re,Ue){for(var Xe=wt(Re),ft=0,it=Xe.length;ft<it;ft++){var xt=Xe[ft];for(var Dt in Ue){var Kt=tt(Ue[Dt],xt),Wt=xt.target,bt=De(Kt),jt=We(Wt,Dt,bt,xt),on=bt||De(jt),$t=Ee(Le(Kt,on),jt),vn=Pe(Wt,Dt);An[vn](Wt,Dt,$t,xt.transforms,!0)}}}function Mn(Re,Ue){var Xe=Pe(Re.target,Ue.name);if(Xe){var ft=gn(Ue,Re),it=ft[ft.length-1];return{type:Xe,property:Ue.name,animatable:Re,tweens:ft,duration:it.end,delay:ft[0].delay,endDelay:it.endDelay}}}function Cn(Re,Ue){return de(te(Re.map(function(Xe){return Ue.map(function(ft){return Mn(Xe,ft)})})),function(Xe){return!x.und(Xe)})}function wn(Re,Ue){var Xe=Re.length,ft=function(xt){return xt.timelineOffset?xt.timelineOffset:0},it={};return it.duration=Xe?Math.max.apply(Math,Re.map(function(xt){return ft(xt)+xt.duration})):Ue.duration,it.delay=Xe?Math.min.apply(Math,Re.map(function(xt){return ft(xt)+xt.delay})):Ue.delay,it.endDelay=Xe?it.duration-Math.max.apply(Math,Re.map(function(xt){return ft(xt)+xt.duration-xt.endDelay})):Ue.endDelay,it}var zn=0;function ai(Re){var Ue=I(s,Re),Xe=I(c,Re),ft=St(Xe,Re),it=wt(Re.targets),xt=Cn(it,ft),Dt=wn(xt,Xe),Kt=zn;return zn++,U(Ue,{id:Kt,children:[],animatables:it,animations:xt,duration:Dt.duration,delay:Dt.delay,endDelay:Dt.endDelay})}var xn=[],Zn=[],Me,le=function(){function Re(){Me=requestAnimationFrame(Ue)}function Ue(Xe){var ft=xn.length;if(ft){for(var it=0;it<ft;){var xt=xn[it];if(!xt.paused)xt.tick(Xe);else{var Dt=xn.indexOf(xt);Dt>-1&&(xn.splice(Dt,1),ft=xn.length)}it++}Re()}else Me=cancelAnimationFrame(Me)}return Re}();function be(){if(document.hidden){for(var Re=0,Ue=xn.length;Re<Ue;Re++)activeInstance[Re].pause();Zn=xn.slice(0),xn=[]}else for(var Xe=0,ft=Zn.length;Xe<ft;Xe++)Zn[Xe].play()}document.addEventListener("visibilitychange",be);function q(Re){Re===void 0&&(Re={});var Ue=0,Xe=0,ft=0,it,xt=0,Dt=null;function Kt(){return window.Promise&&new Promise(function(yt){return Dt=yt})}var Wt=Kt(),bt=ai(Re);function jt(){bt.reversed=!bt.reversed;for(var yt=0,Bt=it.length;yt<Bt;yt++)it[yt].reversed=bt.reversed}function on(yt){return bt.reversed?bt.duration-yt:yt}function $t(){Ue=0,Xe=on(bt.currentTime)*(1/q.speed)}function vn(yt,Bt){Bt&&Bt.seek(yt-Bt.timelineOffset)}function Jt(yt){if(bt.reversePlayback)for(var Ft=xt;Ft--;)vn(yt,it[Ft]);else for(var Bt=0;Bt<xt;Bt++)vn(yt,it[Bt])}function nn(yt){for(var Bt=0,Ft=bt.animations,Zt=Ft.length;Bt<Zt;){var en=Ft[Bt],Rn=en.animatable,ae=en.tweens,pe=ae.length-1,Ce=ae[pe];pe&&(Ce=de(ae,function(vi){return yt<vi.end})[0]||Ce);for(var fe=f(yt-Ce.start-Ce.delay,0,Ce.duration)/Ce.duration,He=isNaN(fe)?1:Ce.easing(fe),ot=Ce.to.strings,pt=Ce.round,Ut=[],Vt=Ce.to.numbers.length,gt=void 0,Ot=0;Ot<Vt;Ot++){var Qt=void 0,_n=Ce.to.numbers[Ot],Tn=Ce.from.numbers[Ot]||0;Ce.isPath?Qt=ye(Ce.value,He*_n):Qt=Tn+He*(_n-Tn),pt&&(Ce.isColor&&Ot>2||(Qt=Math.round(Qt*pt)/pt)),Ut.push(Qt)}var Ln=ot.length;if(!Ln)gt=Ut[0];else{gt=ot[0];for(var Xn=0;Xn<Ln;Xn++){ot[Xn];var Yn=ot[Xn+1],$n=Ut[Xn];isNaN($n)||(Yn?gt+=$n+Yn:gt+=$n+" ")}}An[en.type](Rn.target,en.property,gt,Rn.transforms),en.currentValue=gt,Bt++}}function hn(yt){bt[yt]&&!bt.passThrough&&bt[yt](bt)}function rn(){bt.remaining&&bt.remaining!==!0&&bt.remaining--}function Rt(yt){var Bt=bt.duration,Ft=bt.delay,Zt=Bt-bt.endDelay,en=on(yt);bt.progress=f(en/Bt*100,0,100),bt.reversePlayback=en<bt.currentTime,it&&Jt(en),!bt.began&&bt.currentTime>0&&(bt.began=!0,hn("begin"),hn("loopBegin")),en<=Ft&&bt.currentTime!==0&&nn(0),(en>=Zt&&bt.currentTime!==Bt||!Bt)&&nn(Bt),en>Ft&&en<Zt?(bt.changeBegan||(bt.changeBegan=!0,bt.changeCompleted=!1,hn("changeBegin")),hn("change"),nn(en)):bt.changeBegan&&(bt.changeCompleted=!0,bt.changeBegan=!1,hn("changeComplete")),bt.currentTime=f(en,0,Bt),bt.began&&hn("update"),yt>=Bt&&(Xe=0,rn(),bt.remaining?(Ue=ft,hn("loopComplete"),hn("loopBegin"),bt.direction==="alternate"&&jt()):(bt.paused=!0,bt.completed||(bt.completed=!0,hn("loopComplete"),hn("complete"),"Promise"in window&&(Dt(),Wt=Kt()))))}return bt.reset=function(){var yt=bt.direction;bt.passThrough=!1,bt.currentTime=0,bt.progress=0,bt.paused=!0,bt.began=!1,bt.changeBegan=!1,bt.completed=!1,bt.changeCompleted=!1,bt.reversePlayback=!1,bt.reversed=yt==="reverse",bt.remaining=bt.loop,it=bt.children,xt=it.length;for(var Bt=xt;Bt--;)bt.children[Bt].reset();(bt.reversed&&bt.loop!==!0||yt==="alternate"&&bt.loop===1)&&bt.remaining++,nn(0)},bt.set=function(yt,Bt){return un(yt,Bt),bt},bt.tick=function(yt){ft=yt,Ue||(Ue=ft),Rt((ft+(Xe-Ue))*q.speed)},bt.seek=function(yt){Rt(on(yt))},bt.pause=function(){bt.paused=!0,$t()},bt.play=function(){!bt.paused||(bt.paused=!1,xn.push(bt),$t(),Me||le())},bt.reverse=function(){jt(),$t()},bt.restart=function(){bt.reset(),bt.play()},bt.finished=Wt,bt.reset(),bt.autoplay&&bt.play(),bt}function Se(Re,Ue){for(var Xe=Ue.length;Xe--;)L(Re,Ue[Xe].animatable.target)&&Ue.splice(Xe,1)}function Ge(Re){for(var Ue=mt(Re),Xe=xn.length;Xe--;){var ft=xn[Xe],it=ft.animations,xt=ft.children;Se(Ue,it);for(var Dt=xt.length;Dt--;){var Kt=xt[Dt],Wt=Kt.animations;Se(Ue,Wt),!Wt.length&&!Kt.children.length&&xt.splice(Dt,1)}!it.length&&!xt.length&&ft.pause()}}function lt(Re,Ue){Ue===void 0&&(Ue={});var Xe=Ue.direction||"normal",ft=Ue.easing?W(Ue.easing):null,it=Ue.grid,xt=Ue.axis,Dt=Ue.from||0,Kt=Dt==="first",Wt=Dt==="center",bt=Dt==="last",jt=x.arr(Re),on=parseFloat(jt?Re[0]:Re),$t=jt?parseFloat(Re[1]):0,vn=De(jt?Re[1]:Re)||0,Jt=Ue.start||0+(jt?on:0),nn=[],hn=0;return function(rn,Rt,yt){if(Kt&&(Dt=0),Wt&&(Dt=(yt-1)/2),bt&&(Dt=yt-1),!nn.length){for(var Bt=0;Bt<yt;Bt++){if(!it)nn.push(Math.abs(Dt-Bt));else{var Ft=Wt?(it[0]-1)/2:Dt%it[0],Zt=Wt?(it[1]-1)/2:Math.floor(Dt/it[0]),en=Bt%it[0],Rn=Math.floor(Bt/it[0]),ae=Ft-en,pe=Zt-Rn,Ce=Math.sqrt(ae*ae+pe*pe);xt==="x"&&(Ce=-ae),xt==="y"&&(Ce=-pe),nn.push(Ce)}hn=Math.max.apply(Math,nn)}ft&&(nn=nn.map(function(He){return ft(He/hn)*hn})),Xe==="reverse"&&(nn=nn.map(function(He){return xt?He<0?He*-1:-He:Math.abs(hn-He)}))}var fe=jt?($t-on)/hn:on;return Jt+fe*(Math.round(nn[Rt]*100)/100)+vn}}function dt(Re){Re===void 0&&(Re={});var Ue=q(Re);return Ue.duration=0,Ue.add=function(Xe,ft){var it=xn.indexOf(Ue),xt=Ue.children;it>-1&&xn.splice(it,1);function Dt($t){$t.passThrough=!0}for(var Kt=0;Kt<xt.length;Kt++)Dt(xt[Kt]);var Wt=U(Xe,I(c,Re));Wt.targets=Wt.targets||Re.targets;var bt=Ue.duration;Wt.autoplay=!1,Wt.direction=Ue.direction,Wt.timelineOffset=x.und(ft)?bt:Ee(ft,bt),Dt(Ue),Ue.seek(Wt.timelineOffset);var jt=q(Wt);Dt(jt),xt.push(jt);var on=wn(xt,Re);return Ue.delay=on.delay,Ue.endDelay=on.endDelay,Ue.duration=on.duration,Ue.seek(0),Ue.reset(),Ue.autoplay&&Ue.play(),Ue},Ue}q.version="3.0.0",q.speed=1,q.running=xn,q.remove=Ge,q.get=We,q.set=un,q.convertPx=vt,q.path=Ie,q.setDashoffset=R,q.stagger=lt,q.timeline=dt,q.easing=W,q.penner=k,q.random=function(Re,Ue){return Math.floor(Math.random()*(Ue-Re+1))+Re},i.exports=q},{}],57:[function(n,i,o){/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */(function(s,c){typeof o=="object"&&typeof i!="undefined"?c(o):(s=typeof globalThis!="undefined"?globalThis:s||self,c(s.THREE={}))})(this,function(s){const c="137",u={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},h={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},f=0,p=1,m=2,y=3,g=0,_=1,x=2,b=3,E=0,T=1,P=2,D=1,F=2,k=0,W=1,j=2,J=3,de=4,te=5,N=100,L=101,M=102,I=103,U=104,$=200,ee=201,Q=202,G=203,K=204,Y=205,we=206,Ke=207,ge=208,me=209,De=210,ze=0,tt=1,rt=2,vt=3,Ye=4,Pe=5,Be=6,$e=7,Je=0,We=1,_e=2,Ee=0,Oe=1,Le=2,ce=3,he=4,ie=5,V=300,Z=301,B=302,S=303,R=304,X=306,xe=307,Ie=1e3,ye=1001,nt=1002,at=1003,mt=1004,wt=1004,Lt=1005,Ct=1005,ut=1006,St=1007,Tt=1007,gn=1008,An=1008,un=1009,Mn=1010,Cn=1011,wn=1012,zn=1013,ai=1014,xn=1015,Zn=1016,Me=1017,le=1018,be=1020,q=1021,Se=1023,Ge=1024,lt=1025,dt=1026,Re=1027,Ue=1028,Xe=1029,ft=1030,it=1031,xt=1033,Dt=33776,Kt=33777,Wt=33778,bt=33779,jt=35840,on=35841,$t=35842,vn=35843,Jt=36196,nn=37492,hn=37496,rn=37808,Rt=37809,yt=37810,Bt=37811,Ft=37812,Zt=37813,en=37814,Rn=37815,ae=37816,pe=37817,Ce=37818,fe=37819,He=37820,ot=37821,pt=36492,Ut=2200,Vt=2201,gt=2202,Ot=2300,Qt=2301,_n=2302,Tn=2400,Ln=2401,Xn=2402,Yn=2500,$n=2501,vi=0,Rr=1,jr=2,Qi=3e3,Li=3001,Cs=3200,Rs=3201,Fr=0,Ls=1,_a=0,wa=7680,Zc=7681,Jc=7682,eu=7683,tu=34055,nu=34056,iu=5386,ru=512,su=513,ou=514,au=515,Nr=516,fI=517,dI=518,Sw=519,Dh=35044,Bh=35048,pI=35040,mI=35045,gI=35049,vI=35041,yI=35046,xI=35050,AI=35042,bI="100",i1="300 es",$m=1035;class hl{addEventListener(r,l){this._listeners===void 0&&(this._listeners={});const d=this._listeners;d[r]===void 0&&(d[r]=[]),d[r].indexOf(l)===-1&&d[r].push(l)}hasEventListener(r,l){if(this._listeners===void 0)return!1;const d=this._listeners;return d[r]!==void 0&&d[r].indexOf(l)!==-1}removeEventListener(r,l){if(this._listeners===void 0)return;const v=this._listeners[r];if(v!==void 0){const w=v.indexOf(l);w!==-1&&v.splice(w,1)}}dispatchEvent(r){if(this._listeners===void 0)return;const d=this._listeners[r.type];if(d!==void 0){r.target=this;const v=d.slice(0);for(let w=0,C=v.length;w<C;w++)v[w].call(this,r);r.target=null}}}const vs=[];for(let A=0;A<256;A++)vs[A]=(A<16?"0":"")+A.toString(16);let qm=1234567;const lu=Math.PI/180,Zd=180/Math.PI;function ho(){const A=Math.random()*4294967295|0,r=Math.random()*4294967295|0,l=Math.random()*4294967295|0,d=Math.random()*4294967295|0;return(vs[A&255]+vs[A>>8&255]+vs[A>>16&255]+vs[A>>24&255]+"-"+vs[r&255]+vs[r>>8&255]+"-"+vs[r>>16&15|64]+vs[r>>24&255]+"-"+vs[l&63|128]+vs[l>>8&255]+"-"+vs[l>>16&255]+vs[l>>24&255]+vs[d&255]+vs[d>>8&255]+vs[d>>16&255]+vs[d>>24&255]).toUpperCase()}function ys(A,r,l){return Math.max(r,Math.min(l,A))}function r1(A,r){return(A%r+r)%r}function _I(A,r,l,d,v){return d+(A-r)*(v-d)/(l-r)}function wI(A,r,l){return A!==r?(l-A)/(r-A):0}function Jd(A,r,l){return(1-l)*A+l*r}function EI(A,r,l,d){return Jd(A,r,1-Math.exp(-l*d))}function MI(A,r=1){return r-Math.abs(r1(A,r*2)-r)}function SI(A,r,l){return A<=r?0:A>=l?1:(A=(A-r)/(l-r),A*A*(3-2*A))}function TI(A,r,l){return A<=r?0:A>=l?1:(A=(A-r)/(l-r),A*A*A*(A*(A*6-15)+10))}function CI(A,r){return A+Math.floor(Math.random()*(r-A+1))}function RI(A,r){return A+Math.random()*(r-A)}function LI(A){return A*(.5-Math.random())}function PI(A){return A!==void 0&&(qm=A%2147483647),qm=qm*16807%2147483647,(qm-1)/2147483646}function II(A){return A*lu}function OI(A){return A*Zd}function s1(A){return(A&A-1)===0&&A!==0}function Tw(A){return Math.pow(2,Math.ceil(Math.log(A)/Math.LN2))}function Cw(A){return Math.pow(2,Math.floor(Math.log(A)/Math.LN2))}function DI(A,r,l,d,v){const w=Math.cos,C=Math.sin,O=w(l/2),z=C(l/2),H=w((r+d)/2),ne=C((r+d)/2),re=w((r-d)/2),se=C((r-d)/2),oe=w((d-r)/2),ve=C((d-r)/2);switch(v){case"XYX":A.set(O*ne,z*re,z*se,O*H);break;case"YZY":A.set(z*se,O*ne,z*re,O*H);break;case"ZXZ":A.set(z*re,z*se,O*ne,O*H);break;case"XZX":A.set(O*ne,z*ve,z*oe,O*H);break;case"YXY":A.set(z*oe,O*ne,z*ve,O*H);break;case"ZYZ":A.set(z*ve,z*oe,O*ne,O*H);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+v)}}var Rw=Object.freeze({__proto__:null,DEG2RAD:lu,RAD2DEG:Zd,generateUUID:ho,clamp:ys,euclideanModulo:r1,mapLinear:_I,inverseLerp:wI,lerp:Jd,damp:EI,pingpong:MI,smoothstep:SI,smootherstep:TI,randInt:CI,randFloat:RI,randFloatSpread:LI,seededRandom:PI,degToRad:II,radToDeg:OI,isPowerOfTwo:s1,ceilPowerOfTwo:Tw,floorPowerOfTwo:Cw,setQuaternionFromProperEuler:DI});class pn{constructor(r=0,l=0){this.x=r,this.y=l}get width(){return this.x}set width(r){this.x=r}get height(){return this.y}set height(r){this.y=r}set(r,l){return this.x=r,this.y=l,this}setScalar(r){return this.x=r,this.y=r,this}setX(r){return this.x=r,this}setY(r){return this.y=r,this}setComponent(r,l){switch(r){case 0:this.x=l;break;case 1:this.y=l;break;default:throw new Error("index is out of range: "+r)}return this}getComponent(r){switch(r){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+r)}}clone(){return new this.constructor(this.x,this.y)}copy(r){return this.x=r.x,this.y=r.y,this}add(r,l){return l!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(r,l)):(this.x+=r.x,this.y+=r.y,this)}addScalar(r){return this.x+=r,this.y+=r,this}addVectors(r,l){return this.x=r.x+l.x,this.y=r.y+l.y,this}addScaledVector(r,l){return this.x+=r.x*l,this.y+=r.y*l,this}sub(r,l){return l!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(r,l)):(this.x-=r.x,this.y-=r.y,this)}subScalar(r){return this.x-=r,this.y-=r,this}subVectors(r,l){return this.x=r.x-l.x,this.y=r.y-l.y,this}multiply(r){return this.x*=r.x,this.y*=r.y,this}multiplyScalar(r){return this.x*=r,this.y*=r,this}divide(r){return this.x/=r.x,this.y/=r.y,this}divideScalar(r){return this.multiplyScalar(1/r)}applyMatrix3(r){const l=this.x,d=this.y,v=r.elements;return this.x=v[0]*l+v[3]*d+v[6],this.y=v[1]*l+v[4]*d+v[7],this}min(r){return this.x=Math.min(this.x,r.x),this.y=Math.min(this.y,r.y),this}max(r){return this.x=Math.max(this.x,r.x),this.y=Math.max(this.y,r.y),this}clamp(r,l){return this.x=Math.max(r.x,Math.min(l.x,this.x)),this.y=Math.max(r.y,Math.min(l.y,this.y)),this}clampScalar(r,l){return this.x=Math.max(r,Math.min(l,this.x)),this.y=Math.max(r,Math.min(l,this.y)),this}clampLength(r,l){const d=this.length();return this.divideScalar(d||1).multiplyScalar(Math.max(r,Math.min(l,d)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(r){return this.x*r.x+this.y*r.y}cross(r){return this.x*r.y-this.y*r.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(r){return Math.sqrt(this.distanceToSquared(r))}distanceToSquared(r){const l=this.x-r.x,d=this.y-r.y;return l*l+d*d}manhattanDistanceTo(r){return Math.abs(this.x-r.x)+Math.abs(this.y-r.y)}setLength(r){return this.normalize().multiplyScalar(r)}lerp(r,l){return this.x+=(r.x-this.x)*l,this.y+=(r.y-this.y)*l,this}lerpVectors(r,l,d){return this.x=r.x+(l.x-r.x)*d,this.y=r.y+(l.y-r.y)*d,this}equals(r){return r.x===this.x&&r.y===this.y}fromArray(r,l=0){return this.x=r[l],this.y=r[l+1],this}toArray(r=[],l=0){return r[l]=this.x,r[l+1]=this.y,r}fromBufferAttribute(r,l,d){return d!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=r.getX(l),this.y=r.getY(l),this}rotateAround(r,l){const d=Math.cos(l),v=Math.sin(l),w=this.x-r.x,C=this.y-r.y;return this.x=w*d-C*v+r.x,this.y=w*v+C*d+r.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}pn.prototype.isVector2=!0;class es{constructor(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(r,l,d,v,w,C,O,z,H){const ne=this.elements;return ne[0]=r,ne[1]=v,ne[2]=O,ne[3]=l,ne[4]=w,ne[5]=z,ne[6]=d,ne[7]=C,ne[8]=H,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(r){const l=this.elements,d=r.elements;return l[0]=d[0],l[1]=d[1],l[2]=d[2],l[3]=d[3],l[4]=d[4],l[5]=d[5],l[6]=d[6],l[7]=d[7],l[8]=d[8],this}extractBasis(r,l,d){return r.setFromMatrix3Column(this,0),l.setFromMatrix3Column(this,1),d.setFromMatrix3Column(this,2),this}setFromMatrix4(r){const l=r.elements;return this.set(l[0],l[4],l[8],l[1],l[5],l[9],l[2],l[6],l[10]),this}multiply(r){return this.multiplyMatrices(this,r)}premultiply(r){return this.multiplyMatrices(r,this)}multiplyMatrices(r,l){const d=r.elements,v=l.elements,w=this.elements,C=d[0],O=d[3],z=d[6],H=d[1],ne=d[4],re=d[7],se=d[2],oe=d[5],ve=d[8],Te=v[0],Fe=v[3],Ae=v[6],ue=v[1],Ve=v[4],ke=v[7],je=v[2],st=v[5],At=v[8];return w[0]=C*Te+O*ue+z*je,w[3]=C*Fe+O*Ve+z*st,w[6]=C*Ae+O*ke+z*At,w[1]=H*Te+ne*ue+re*je,w[4]=H*Fe+ne*Ve+re*st,w[7]=H*Ae+ne*ke+re*At,w[2]=se*Te+oe*ue+ve*je,w[5]=se*Fe+oe*Ve+ve*st,w[8]=se*Ae+oe*ke+ve*At,this}multiplyScalar(r){const l=this.elements;return l[0]*=r,l[3]*=r,l[6]*=r,l[1]*=r,l[4]*=r,l[7]*=r,l[2]*=r,l[5]*=r,l[8]*=r,this}determinant(){const r=this.elements,l=r[0],d=r[1],v=r[2],w=r[3],C=r[4],O=r[5],z=r[6],H=r[7],ne=r[8];return l*C*ne-l*O*H-d*w*ne+d*O*z+v*w*H-v*C*z}invert(){const r=this.elements,l=r[0],d=r[1],v=r[2],w=r[3],C=r[4],O=r[5],z=r[6],H=r[7],ne=r[8],re=ne*C-O*H,se=O*z-ne*w,oe=H*w-C*z,ve=l*re+d*se+v*oe;if(ve===0)return this.set(0,0,0,0,0,0,0,0,0);const Te=1/ve;return r[0]=re*Te,r[1]=(v*H-ne*d)*Te,r[2]=(O*d-v*C)*Te,r[3]=se*Te,r[4]=(ne*l-v*z)*Te,r[5]=(v*w-O*l)*Te,r[6]=oe*Te,r[7]=(d*z-H*l)*Te,r[8]=(C*l-d*w)*Te,this}transpose(){let r;const l=this.elements;return r=l[1],l[1]=l[3],l[3]=r,r=l[2],l[2]=l[6],l[6]=r,r=l[5],l[5]=l[7],l[7]=r,this}getNormalMatrix(r){return this.setFromMatrix4(r).invert().transpose()}transposeIntoArray(r){const l=this.elements;return r[0]=l[0],r[1]=l[3],r[2]=l[6],r[3]=l[1],r[4]=l[4],r[5]=l[7],r[6]=l[2],r[7]=l[5],r[8]=l[8],this}setUvTransform(r,l,d,v,w,C,O){const z=Math.cos(w),H=Math.sin(w);return this.set(d*z,d*H,-d*(z*C+H*O)+C+r,-v*H,v*z,-v*(-H*C+z*O)+O+l,0,0,1),this}scale(r,l){const d=this.elements;return d[0]*=r,d[3]*=r,d[6]*=r,d[1]*=l,d[4]*=l,d[7]*=l,this}rotate(r){const l=Math.cos(r),d=Math.sin(r),v=this.elements,w=v[0],C=v[3],O=v[6],z=v[1],H=v[4],ne=v[7];return v[0]=l*w+d*z,v[3]=l*C+d*H,v[6]=l*O+d*ne,v[1]=-d*w+l*z,v[4]=-d*C+l*H,v[7]=-d*O+l*ne,this}translate(r,l){const d=this.elements;return d[0]+=r*d[2],d[3]+=r*d[5],d[6]+=r*d[8],d[1]+=l*d[2],d[4]+=l*d[5],d[7]+=l*d[8],this}equals(r){const l=this.elements,d=r.elements;for(let v=0;v<9;v++)if(l[v]!==d[v])return!1;return!0}fromArray(r,l=0){for(let d=0;d<9;d++)this.elements[d]=r[d+l];return this}toArray(r=[],l=0){const d=this.elements;return r[l]=d[0],r[l+1]=d[1],r[l+2]=d[2],r[l+3]=d[3],r[l+4]=d[4],r[l+5]=d[5],r[l+6]=d[6],r[l+7]=d[7],r[l+8]=d[8],r}clone(){return new this.constructor().fromArray(this.elements)}}es.prototype.isMatrix3=!0;function Lw(A){for(let r=A.length-1;r>=0;--r)if(A[r]>65535)return!0;return!1}const BI={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function Fh(A,r){return new BI[A](r)}function ep(A){return document.createElementNS("http://www.w3.org/1999/xhtml",A)}const Pw={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},$o={h:0,s:0,l:0},Ym={h:0,s:0,l:0};function o1(A,r,l){return l<0&&(l+=1),l>1&&(l-=1),l<1/6?A+(r-A)*6*l:l<1/2?r:l<2/3?A+(r-A)*6*(2/3-l):A}function Nh(A){return A<.04045?A*.0773993808:Math.pow(A*.9478672986+.0521327014,2.4)}function a1(A){return A<.0031308?A*12.92:1.055*Math.pow(A,.41666)-.055}class Un{constructor(r,l,d){return l===void 0&&d===void 0?this.set(r):this.setRGB(r,l,d)}set(r){return r&&r.isColor?this.copy(r):typeof r=="number"?this.setHex(r):typeof r=="string"&&this.setStyle(r),this}setScalar(r){return this.r=r,this.g=r,this.b=r,this}setHex(r){return r=Math.floor(r),this.r=(r>>16&255)/255,this.g=(r>>8&255)/255,this.b=(r&255)/255,this}setRGB(r,l,d){return this.r=r,this.g=l,this.b=d,this}setHSL(r,l,d){if(r=r1(r,1),l=ys(l,0,1),d=ys(d,0,1),l===0)this.r=this.g=this.b=d;else{const v=d<=.5?d*(1+l):d+l-d*l,w=2*d-v;this.r=o1(w,v,r+1/3),this.g=o1(w,v,r),this.b=o1(w,v,r-1/3)}return this}setStyle(r){function l(v){v!==void 0&&parseFloat(v)<1&&console.warn("THREE.Color: Alpha component of "+r+" will be ignored.")}let d;if(d=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(r)){let v;const w=d[1],C=d[2];switch(w){case"rgb":case"rgba":if(v=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(C))return this.r=Math.min(255,parseInt(v[1],10))/255,this.g=Math.min(255,parseInt(v[2],10))/255,this.b=Math.min(255,parseInt(v[3],10))/255,l(v[4]),this;if(v=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(C))return this.r=Math.min(100,parseInt(v[1],10))/100,this.g=Math.min(100,parseInt(v[2],10))/100,this.b=Math.min(100,parseInt(v[3],10))/100,l(v[4]),this;break;case"hsl":case"hsla":if(v=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(C)){const O=parseFloat(v[1])/360,z=parseInt(v[2],10)/100,H=parseInt(v[3],10)/100;return l(v[4]),this.setHSL(O,z,H)}break}}else if(d=/^\#([A-Fa-f\d]+)$/.exec(r)){const v=d[1],w=v.length;if(w===3)return this.r=parseInt(v.charAt(0)+v.charAt(0),16)/255,this.g=parseInt(v.charAt(1)+v.charAt(1),16)/255,this.b=parseInt(v.charAt(2)+v.charAt(2),16)/255,this;if(w===6)return this.r=parseInt(v.charAt(0)+v.charAt(1),16)/255,this.g=parseInt(v.charAt(2)+v.charAt(3),16)/255,this.b=parseInt(v.charAt(4)+v.charAt(5),16)/255,this}return r&&r.length>0?this.setColorName(r):this}setColorName(r){const l=Pw[r.toLowerCase()];return l!==void 0?this.setHex(l):console.warn("THREE.Color: Unknown color "+r),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(r){return this.r=r.r,this.g=r.g,this.b=r.b,this}copySRGBToLinear(r){return this.r=Nh(r.r),this.g=Nh(r.g),this.b=Nh(r.b),this}copyLinearToSRGB(r){return this.r=a1(r.r),this.g=a1(r.g),this.b=a1(r.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(){return this.r*255<<16^this.g*255<<8^this.b*255<<0}getHexString(){return("000000"+this.getHex().toString(16)).slice(-6)}getHSL(r){const l=this.r,d=this.g,v=this.b,w=Math.max(l,d,v),C=Math.min(l,d,v);let O,z;const H=(C+w)/2;if(C===w)O=0,z=0;else{const ne=w-C;switch(z=H<=.5?ne/(w+C):ne/(2-w-C),w){case l:O=(d-v)/ne+(d<v?6:0);break;case d:O=(v-l)/ne+2;break;case v:O=(l-d)/ne+4;break}O/=6}return r.h=O,r.s=z,r.l=H,r}getStyle(){return"rgb("+(this.r*255|0)+","+(this.g*255|0)+","+(this.b*255|0)+")"}offsetHSL(r,l,d){return this.getHSL($o),$o.h+=r,$o.s+=l,$o.l+=d,this.setHSL($o.h,$o.s,$o.l),this}add(r){return this.r+=r.r,this.g+=r.g,this.b+=r.b,this}addColors(r,l){return this.r=r.r+l.r,this.g=r.g+l.g,this.b=r.b+l.b,this}addScalar(r){return this.r+=r,this.g+=r,this.b+=r,this}sub(r){return this.r=Math.max(0,this.r-r.r),this.g=Math.max(0,this.g-r.g),this.b=Math.max(0,this.b-r.b),this}multiply(r){return this.r*=r.r,this.g*=r.g,this.b*=r.b,this}multiplyScalar(r){return this.r*=r,this.g*=r,this.b*=r,this}lerp(r,l){return this.r+=(r.r-this.r)*l,this.g+=(r.g-this.g)*l,this.b+=(r.b-this.b)*l,this}lerpColors(r,l,d){return this.r=r.r+(l.r-r.r)*d,this.g=r.g+(l.g-r.g)*d,this.b=r.b+(l.b-r.b)*d,this}lerpHSL(r,l){this.getHSL($o),r.getHSL(Ym);const d=Jd($o.h,Ym.h,l),v=Jd($o.s,Ym.s,l),w=Jd($o.l,Ym.l,l);return this.setHSL(d,v,w),this}equals(r){return r.r===this.r&&r.g===this.g&&r.b===this.b}fromArray(r,l=0){return this.r=r[l],this.g=r[l+1],this.b=r[l+2],this}toArray(r=[],l=0){return r[l]=this.r,r[l+1]=this.g,r[l+2]=this.b,r}fromBufferAttribute(r,l){return this.r=r.getX(l),this.g=r.getY(l),this.b=r.getZ(l),r.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}}Un.NAMES=Pw,Un.prototype.isColor=!0,Un.prototype.r=1,Un.prototype.g=1,Un.prototype.b=1;let Uh;class ql{static getDataURL(r){if(/^data:/i.test(r.src)||typeof HTMLCanvasElement=="undefined")return r.src;let l;if(r instanceof HTMLCanvasElement)l=r;else{Uh===void 0&&(Uh=ep("canvas")),Uh.width=r.width,Uh.height=r.height;const d=Uh.getContext("2d");r instanceof ImageData?d.putImageData(r,0,0):d.drawImage(r,0,0,r.width,r.height),l=Uh}return l.width>2048||l.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",r),l.toDataURL("image/jpeg",.6)):l.toDataURL("image/png")}static sRGBToLinear(r){if(typeof HTMLImageElement!="undefined"&&r instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&r instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&r instanceof ImageBitmap){const l=ep("canvas");l.width=r.width,l.height=r.height;const d=l.getContext("2d");d.drawImage(r,0,0,r.width,r.height);const v=d.getImageData(0,0,r.width,r.height),w=v.data;for(let C=0;C<w.length;C++)w[C]=Nh(w[C]/255)*255;return d.putImageData(v,0,0),l}else if(r.data){const l=r.data.slice(0);for(let d=0;d<l.length;d++)l instanceof Uint8Array||l instanceof Uint8ClampedArray?l[d]=Math.floor(Nh(l[d]/255)*255):l[d]=Nh(l[d]);return{data:l,width:r.width,height:r.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),r}}let FI=0;class Xr extends hl{constructor(r=Xr.DEFAULT_IMAGE,l=Xr.DEFAULT_MAPPING,d=ye,v=ye,w=ut,C=gn,O=Se,z=un,H=1,ne=Qi){super(),Object.defineProperty(this,"id",{value:FI++}),this.uuid=ho(),this.name="",this.image=r,this.mipmaps=[],this.mapping=l,this.wrapS=d,this.wrapT=v,this.magFilter=w,this.minFilter=C,this.anisotropy=H,this.format=O,this.internalFormat=null,this.type=z,this.offset=new pn(0,0),this.repeat=new pn(1,1),this.center=new pn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new es,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=ne,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(r){return this.name=r.name,this.image=r.image,this.mipmaps=r.mipmaps.slice(0),this.mapping=r.mapping,this.wrapS=r.wrapS,this.wrapT=r.wrapT,this.magFilter=r.magFilter,this.minFilter=r.minFilter,this.anisotropy=r.anisotropy,this.format=r.format,this.internalFormat=r.internalFormat,this.type=r.type,this.offset.copy(r.offset),this.repeat.copy(r.repeat),this.center.copy(r.center),this.rotation=r.rotation,this.matrixAutoUpdate=r.matrixAutoUpdate,this.matrix.copy(r.matrix),this.generateMipmaps=r.generateMipmaps,this.premultiplyAlpha=r.premultiplyAlpha,this.flipY=r.flipY,this.unpackAlignment=r.unpackAlignment,this.encoding=r.encoding,this.userData=JSON.parse(JSON.stringify(r.userData)),this}toJSON(r){const l=r===void 0||typeof r=="string";if(!l&&r.textures[this.uuid]!==void 0)return r.textures[this.uuid];const d={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};if(this.image!==void 0){const v=this.image;if(v.uuid===void 0&&(v.uuid=ho()),!l&&r.images[v.uuid]===void 0){let w;if(Array.isArray(v)){w=[];for(let C=0,O=v.length;C<O;C++)v[C].isDataTexture?w.push(l1(v[C].image)):w.push(l1(v[C]))}else w=l1(v);r.images[v.uuid]={uuid:v.uuid,url:w}}d.image=v.uuid}return JSON.stringify(this.userData)!=="{}"&&(d.userData=this.userData),l||(r.textures[this.uuid]=d),d}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(r){if(this.mapping!==V)return r;if(r.applyMatrix3(this.matrix),r.x<0||r.x>1)switch(this.wrapS){case Ie:r.x=r.x-Math.floor(r.x);break;case ye:r.x=r.x<0?0:1;break;case nt:Math.abs(Math.floor(r.x)%2)===1?r.x=Math.ceil(r.x)-r.x:r.x=r.x-Math.floor(r.x);break}if(r.y<0||r.y>1)switch(this.wrapT){case Ie:r.y=r.y-Math.floor(r.y);break;case ye:r.y=r.y<0?0:1;break;case nt:Math.abs(Math.floor(r.y)%2)===1?r.y=Math.ceil(r.y)-r.y:r.y=r.y-Math.floor(r.y);break}return this.flipY&&(r.y=1-r.y),r}set needsUpdate(r){r===!0&&this.version++}}Xr.DEFAULT_IMAGE=void 0,Xr.DEFAULT_MAPPING=V,Xr.prototype.isTexture=!0;function l1(A){return typeof HTMLImageElement!="undefined"&&A instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&A instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&A instanceof ImageBitmap?ql.getDataURL(A):A.data?{data:Array.prototype.slice.call(A.data),width:A.width,height:A.height,type:A.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}class nr{constructor(r=0,l=0,d=0,v=1){this.x=r,this.y=l,this.z=d,this.w=v}get width(){return this.z}set width(r){this.z=r}get height(){return this.w}set height(r){this.w=r}set(r,l,d,v){return this.x=r,this.y=l,this.z=d,this.w=v,this}setScalar(r){return this.x=r,this.y=r,this.z=r,this.w=r,this}setX(r){return this.x=r,this}setY(r){return this.y=r,this}setZ(r){return this.z=r,this}setW(r){return this.w=r,this}setComponent(r,l){switch(r){case 0:this.x=l;break;case 1:this.y=l;break;case 2:this.z=l;break;case 3:this.w=l;break;default:throw new Error("index is out of range: "+r)}return this}getComponent(r){switch(r){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+r)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(r){return this.x=r.x,this.y=r.y,this.z=r.z,this.w=r.w!==void 0?r.w:1,this}add(r,l){return l!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(r,l)):(this.x+=r.x,this.y+=r.y,this.z+=r.z,this.w+=r.w,this)}addScalar(r){return this.x+=r,this.y+=r,this.z+=r,this.w+=r,this}addVectors(r,l){return this.x=r.x+l.x,this.y=r.y+l.y,this.z=r.z+l.z,this.w=r.w+l.w,this}addScaledVector(r,l){return this.x+=r.x*l,this.y+=r.y*l,this.z+=r.z*l,this.w+=r.w*l,this}sub(r,l){return l!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(r,l)):(this.x-=r.x,this.y-=r.y,this.z-=r.z,this.w-=r.w,this)}subScalar(r){return this.x-=r,this.y-=r,this.z-=r,this.w-=r,this}subVectors(r,l){return this.x=r.x-l.x,this.y=r.y-l.y,this.z=r.z-l.z,this.w=r.w-l.w,this}multiply(r){return this.x*=r.x,this.y*=r.y,this.z*=r.z,this.w*=r.w,this}multiplyScalar(r){return this.x*=r,this.y*=r,this.z*=r,this.w*=r,this}applyMatrix4(r){const l=this.x,d=this.y,v=this.z,w=this.w,C=r.elements;return this.x=C[0]*l+C[4]*d+C[8]*v+C[12]*w,this.y=C[1]*l+C[5]*d+C[9]*v+C[13]*w,this.z=C[2]*l+C[6]*d+C[10]*v+C[14]*w,this.w=C[3]*l+C[7]*d+C[11]*v+C[15]*w,this}divideScalar(r){return this.multiplyScalar(1/r)}setAxisAngleFromQuaternion(r){this.w=2*Math.acos(r.w);const l=Math.sqrt(1-r.w*r.w);return l<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=r.x/l,this.y=r.y/l,this.z=r.z/l),this}setAxisAngleFromRotationMatrix(r){let l,d,v,w;const z=r.elements,H=z[0],ne=z[4],re=z[8],se=z[1],oe=z[5],ve=z[9],Te=z[2],Fe=z[6],Ae=z[10];if(Math.abs(ne-se)<.01&&Math.abs(re-Te)<.01&&Math.abs(ve-Fe)<.01){if(Math.abs(ne+se)<.1&&Math.abs(re+Te)<.1&&Math.abs(ve+Fe)<.1&&Math.abs(H+oe+Ae-3)<.1)return this.set(1,0,0,0),this;l=Math.PI;const Ve=(H+1)/2,ke=(oe+1)/2,je=(Ae+1)/2,st=(ne+se)/4,At=(re+Te)/4,Et=(ve+Fe)/4;return Ve>ke&&Ve>je?Ve<.01?(d=0,v=.707106781,w=.707106781):(d=Math.sqrt(Ve),v=st/d,w=At/d):ke>je?ke<.01?(d=.707106781,v=0,w=.707106781):(v=Math.sqrt(ke),d=st/v,w=Et/v):je<.01?(d=.707106781,v=.707106781,w=0):(w=Math.sqrt(je),d=At/w,v=Et/w),this.set(d,v,w,l),this}let ue=Math.sqrt((Fe-ve)*(Fe-ve)+(re-Te)*(re-Te)+(se-ne)*(se-ne));return Math.abs(ue)<.001&&(ue=1),this.x=(Fe-ve)/ue,this.y=(re-Te)/ue,this.z=(se-ne)/ue,this.w=Math.acos((H+oe+Ae-1)/2),this}min(r){return this.x=Math.min(this.x,r.x),this.y=Math.min(this.y,r.y),this.z=Math.min(this.z,r.z),this.w=Math.min(this.w,r.w),this}max(r){return this.x=Math.max(this.x,r.x),this.y=Math.max(this.y,r.y),this.z=Math.max(this.z,r.z),this.w=Math.max(this.w,r.w),this}clamp(r,l){return this.x=Math.max(r.x,Math.min(l.x,this.x)),this.y=Math.max(r.y,Math.min(l.y,this.y)),this.z=Math.max(r.z,Math.min(l.z,this.z)),this.w=Math.max(r.w,Math.min(l.w,this.w)),this}clampScalar(r,l){return this.x=Math.max(r,Math.min(l,this.x)),this.y=Math.max(r,Math.min(l,this.y)),this.z=Math.max(r,Math.min(l,this.z)),this.w=Math.max(r,Math.min(l,this.w)),this}clampLength(r,l){const d=this.length();return this.divideScalar(d||1).multiplyScalar(Math.max(r,Math.min(l,d)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(r){return this.x*r.x+this.y*r.y+this.z*r.z+this.w*r.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(r){return this.normalize().multiplyScalar(r)}lerp(r,l){return this.x+=(r.x-this.x)*l,this.y+=(r.y-this.y)*l,this.z+=(r.z-this.z)*l,this.w+=(r.w-this.w)*l,this}lerpVectors(r,l,d){return this.x=r.x+(l.x-r.x)*d,this.y=r.y+(l.y-r.y)*d,this.z=r.z+(l.z-r.z)*d,this.w=r.w+(l.w-r.w)*d,this}equals(r){return r.x===this.x&&r.y===this.y&&r.z===this.z&&r.w===this.w}fromArray(r,l=0){return this.x=r[l],this.y=r[l+1],this.z=r[l+2],this.w=r[l+3],this}toArray(r=[],l=0){return r[l]=this.x,r[l+1]=this.y,r[l+2]=this.z,r[l+3]=this.w,r}fromBufferAttribute(r,l,d){return d!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=r.getX(l),this.y=r.getY(l),this.z=r.getZ(l),this.w=r.getW(l),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}nr.prototype.isVector4=!0;class fo extends hl{constructor(r,l,d={}){super(),this.width=r,this.height=l,this.depth=1,this.scissor=new nr(0,0,r,l),this.scissorTest=!1,this.viewport=new nr(0,0,r,l),this.texture=new Xr(void 0,d.mapping,d.wrapS,d.wrapT,d.magFilter,d.minFilter,d.format,d.type,d.anisotropy,d.encoding),this.texture.isRenderTargetTexture=!0,this.texture.image={width:r,height:l,depth:1},this.texture.generateMipmaps=d.generateMipmaps!==void 0?d.generateMipmaps:!1,this.texture.internalFormat=d.internalFormat!==void 0?d.internalFormat:null,this.texture.minFilter=d.minFilter!==void 0?d.minFilter:ut,this.depthBuffer=d.depthBuffer!==void 0?d.depthBuffer:!0,this.stencilBuffer=d.stencilBuffer!==void 0?d.stencilBuffer:!1,this.depthTexture=d.depthTexture!==void 0?d.depthTexture:null}setTexture(r){r.image={width:this.width,height:this.height,depth:this.depth},this.texture=r}setSize(r,l,d=1){(this.width!==r||this.height!==l||this.depth!==d)&&(this.width=r,this.height=l,this.depth=d,this.texture.image.width=r,this.texture.image.height=l,this.texture.image.depth=d,this.dispose()),this.viewport.set(0,0,r,l),this.scissor.set(0,0,r,l)}clone(){return new this.constructor().copy(this)}copy(r){return this.width=r.width,this.height=r.height,this.depth=r.depth,this.viewport.copy(r.viewport),this.texture=r.texture.clone(),this.texture.image=Object.assign({},r.texture.image),this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.depthTexture=r.depthTexture,this}dispose(){this.dispatchEvent({type:"dispose"})}}fo.prototype.isWebGLRenderTarget=!0;class Iw extends fo{constructor(r,l,d){super(r,l);const v=this.texture;this.texture=[];for(let w=0;w<d;w++)this.texture[w]=v.clone()}setSize(r,l,d=1){if(this.width!==r||this.height!==l||this.depth!==d){this.width=r,this.height=l,this.depth=d;for(let v=0,w=this.texture.length;v<w;v++)this.texture[v].image.width=r,this.texture[v].image.height=l,this.texture[v].image.depth=d;this.dispose()}return this.viewport.set(0,0,r,l),this.scissor.set(0,0,r,l),this}copy(r){this.dispose(),this.width=r.width,this.height=r.height,this.depth=r.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=r.depthBuffer,this.stencilBuffer=r.stencilBuffer,this.depthTexture=r.depthTexture,this.texture.length=0;for(let l=0,d=r.texture.length;l<d;l++)this.texture[l]=r.texture[l].clone();return this}}Iw.prototype.isWebGLMultipleRenderTargets=!0;class Qm extends fo{constructor(r,l,d={}){super(r,l,d),this.samples=4,this.ignoreDepthForMultisampleCopy=d.ignoreDepth!==void 0?d.ignoreDepth:!0,this.useRenderToTexture=d.useRenderToTexture!==void 0?d.useRenderToTexture:!1,this.useRenderbuffer=this.useRenderToTexture===!1}copy(r){return super.copy.call(this,r),this.samples=r.samples,this.useRenderToTexture=r.useRenderToTexture,this.useRenderbuffer=r.useRenderbuffer,this}}Qm.prototype.isWebGLMultisampleRenderTarget=!0;class os{constructor(r=0,l=0,d=0,v=1){this._x=r,this._y=l,this._z=d,this._w=v}static slerp(r,l,d,v){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),d.slerpQuaternions(r,l,v)}static slerpFlat(r,l,d,v,w,C,O){let z=d[v+0],H=d[v+1],ne=d[v+2],re=d[v+3];const se=w[C+0],oe=w[C+1],ve=w[C+2],Te=w[C+3];if(O===0){r[l+0]=z,r[l+1]=H,r[l+2]=ne,r[l+3]=re;return}if(O===1){r[l+0]=se,r[l+1]=oe,r[l+2]=ve,r[l+3]=Te;return}if(re!==Te||z!==se||H!==oe||ne!==ve){let Fe=1-O;const Ae=z*se+H*oe+ne*ve+re*Te,ue=Ae>=0?1:-1,Ve=1-Ae*Ae;if(Ve>Number.EPSILON){const je=Math.sqrt(Ve),st=Math.atan2(je,Ae*ue);Fe=Math.sin(Fe*st)/je,O=Math.sin(O*st)/je}const ke=O*ue;if(z=z*Fe+se*ke,H=H*Fe+oe*ke,ne=ne*Fe+ve*ke,re=re*Fe+Te*ke,Fe===1-O){const je=1/Math.sqrt(z*z+H*H+ne*ne+re*re);z*=je,H*=je,ne*=je,re*=je}}r[l]=z,r[l+1]=H,r[l+2]=ne,r[l+3]=re}static multiplyQuaternionsFlat(r,l,d,v,w,C){const O=d[v],z=d[v+1],H=d[v+2],ne=d[v+3],re=w[C],se=w[C+1],oe=w[C+2],ve=w[C+3];return r[l]=O*ve+ne*re+z*oe-H*se,r[l+1]=z*ve+ne*se+H*re-O*oe,r[l+2]=H*ve+ne*oe+O*se-z*re,r[l+3]=ne*ve-O*re-z*se-H*oe,r}get x(){return this._x}set x(r){this._x=r,this._onChangeCallback()}get y(){return this._y}set y(r){this._y=r,this._onChangeCallback()}get z(){return this._z}set z(r){this._z=r,this._onChangeCallback()}get w(){return this._w}set w(r){this._w=r,this._onChangeCallback()}set(r,l,d,v){return this._x=r,this._y=l,this._z=d,this._w=v,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(r){return this._x=r.x,this._y=r.y,this._z=r.z,this._w=r.w,this._onChangeCallback(),this}setFromEuler(r,l){if(!(r&&r.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const d=r._x,v=r._y,w=r._z,C=r._order,O=Math.cos,z=Math.sin,H=O(d/2),ne=O(v/2),re=O(w/2),se=z(d/2),oe=z(v/2),ve=z(w/2);switch(C){case"XYZ":this._x=se*ne*re+H*oe*ve,this._y=H*oe*re-se*ne*ve,this._z=H*ne*ve+se*oe*re,this._w=H*ne*re-se*oe*ve;break;case"YXZ":this._x=se*ne*re+H*oe*ve,this._y=H*oe*re-se*ne*ve,this._z=H*ne*ve-se*oe*re,this._w=H*ne*re+se*oe*ve;break;case"ZXY":this._x=se*ne*re-H*oe*ve,this._y=H*oe*re+se*ne*ve,this._z=H*ne*ve+se*oe*re,this._w=H*ne*re-se*oe*ve;break;case"ZYX":this._x=se*ne*re-H*oe*ve,this._y=H*oe*re+se*ne*ve,this._z=H*ne*ve-se*oe*re,this._w=H*ne*re+se*oe*ve;break;case"YZX":this._x=se*ne*re+H*oe*ve,this._y=H*oe*re+se*ne*ve,this._z=H*ne*ve-se*oe*re,this._w=H*ne*re-se*oe*ve;break;case"XZY":this._x=se*ne*re-H*oe*ve,this._y=H*oe*re-se*ne*ve,this._z=H*ne*ve+se*oe*re,this._w=H*ne*re+se*oe*ve;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+C)}return l!==!1&&this._onChangeCallback(),this}setFromAxisAngle(r,l){const d=l/2,v=Math.sin(d);return this._x=r.x*v,this._y=r.y*v,this._z=r.z*v,this._w=Math.cos(d),this._onChangeCallback(),this}setFromRotationMatrix(r){const l=r.elements,d=l[0],v=l[4],w=l[8],C=l[1],O=l[5],z=l[9],H=l[2],ne=l[6],re=l[10],se=d+O+re;if(se>0){const oe=.5/Math.sqrt(se+1);this._w=.25/oe,this._x=(ne-z)*oe,this._y=(w-H)*oe,this._z=(C-v)*oe}else if(d>O&&d>re){const oe=2*Math.sqrt(1+d-O-re);this._w=(ne-z)/oe,this._x=.25*oe,this._y=(v+C)/oe,this._z=(w+H)/oe}else if(O>re){const oe=2*Math.sqrt(1+O-d-re);this._w=(w-H)/oe,this._x=(v+C)/oe,this._y=.25*oe,this._z=(z+ne)/oe}else{const oe=2*Math.sqrt(1+re-d-O);this._w=(C-v)/oe,this._x=(w+H)/oe,this._y=(z+ne)/oe,this._z=.25*oe}return this._onChangeCallback(),this}setFromUnitVectors(r,l){let d=r.dot(l)+1;return d<Number.EPSILON?(d=0,Math.abs(r.x)>Math.abs(r.z)?(this._x=-r.y,this._y=r.x,this._z=0,this._w=d):(this._x=0,this._y=-r.z,this._z=r.y,this._w=d)):(this._x=r.y*l.z-r.z*l.y,this._y=r.z*l.x-r.x*l.z,this._z=r.x*l.y-r.y*l.x,this._w=d),this.normalize()}angleTo(r){return 2*Math.acos(Math.abs(ys(this.dot(r),-1,1)))}rotateTowards(r,l){const d=this.angleTo(r);if(d===0)return this;const v=Math.min(1,l/d);return this.slerp(r,v),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(r){return this._x*r._x+this._y*r._y+this._z*r._z+this._w*r._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let r=this.length();return r===0?(this._x=0,this._y=0,this._z=0,this._w=1):(r=1/r,this._x=this._x*r,this._y=this._y*r,this._z=this._z*r,this._w=this._w*r),this._onChangeCallback(),this}multiply(r,l){return l!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(r,l)):this.multiplyQuaternions(this,r)}premultiply(r){return this.multiplyQuaternions(r,this)}multiplyQuaternions(r,l){const d=r._x,v=r._y,w=r._z,C=r._w,O=l._x,z=l._y,H=l._z,ne=l._w;return this._x=d*ne+C*O+v*H-w*z,this._y=v*ne+C*z+w*O-d*H,this._z=w*ne+C*H+d*z-v*O,this._w=C*ne-d*O-v*z-w*H,this._onChangeCallback(),this}slerp(r,l){if(l===0)return this;if(l===1)return this.copy(r);const d=this._x,v=this._y,w=this._z,C=this._w;let O=C*r._w+d*r._x+v*r._y+w*r._z;if(O<0?(this._w=-r._w,this._x=-r._x,this._y=-r._y,this._z=-r._z,O=-O):this.copy(r),O>=1)return this._w=C,this._x=d,this._y=v,this._z=w,this;const z=1-O*O;if(z<=Number.EPSILON){const oe=1-l;return this._w=oe*C+l*this._w,this._x=oe*d+l*this._x,this._y=oe*v+l*this._y,this._z=oe*w+l*this._z,this.normalize(),this._onChangeCallback(),this}const H=Math.sqrt(z),ne=Math.atan2(H,O),re=Math.sin((1-l)*ne)/H,se=Math.sin(l*ne)/H;return this._w=C*re+this._w*se,this._x=d*re+this._x*se,this._y=v*re+this._y*se,this._z=w*re+this._z*se,this._onChangeCallback(),this}slerpQuaternions(r,l,d){return this.copy(r).slerp(l,d)}random(){const r=Math.random(),l=Math.sqrt(1-r),d=Math.sqrt(r),v=2*Math.PI*Math.random(),w=2*Math.PI*Math.random();return this.set(l*Math.cos(v),d*Math.sin(w),d*Math.cos(w),l*Math.sin(v))}equals(r){return r._x===this._x&&r._y===this._y&&r._z===this._z&&r._w===this._w}fromArray(r,l=0){return this._x=r[l],this._y=r[l+1],this._z=r[l+2],this._w=r[l+3],this._onChangeCallback(),this}toArray(r=[],l=0){return r[l]=this._x,r[l+1]=this._y,r[l+2]=this._z,r[l+3]=this._w,r}fromBufferAttribute(r,l){return this._x=r.getX(l),this._y=r.getY(l),this._z=r.getZ(l),this._w=r.getW(l),this}_onChange(r){return this._onChangeCallback=r,this}_onChangeCallback(){}}os.prototype.isQuaternion=!0;class qe{constructor(r=0,l=0,d=0){this.x=r,this.y=l,this.z=d}set(r,l,d){return d===void 0&&(d=this.z),this.x=r,this.y=l,this.z=d,this}setScalar(r){return this.x=r,this.y=r,this.z=r,this}setX(r){return this.x=r,this}setY(r){return this.y=r,this}setZ(r){return this.z=r,this}setComponent(r,l){switch(r){case 0:this.x=l;break;case 1:this.y=l;break;case 2:this.z=l;break;default:throw new Error("index is out of range: "+r)}return this}getComponent(r){switch(r){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+r)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(r){return this.x=r.x,this.y=r.y,this.z=r.z,this}add(r,l){return l!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(r,l)):(this.x+=r.x,this.y+=r.y,this.z+=r.z,this)}addScalar(r){return this.x+=r,this.y+=r,this.z+=r,this}addVectors(r,l){return this.x=r.x+l.x,this.y=r.y+l.y,this.z=r.z+l.z,this}addScaledVector(r,l){return this.x+=r.x*l,this.y+=r.y*l,this.z+=r.z*l,this}sub(r,l){return l!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(r,l)):(this.x-=r.x,this.y-=r.y,this.z-=r.z,this)}subScalar(r){return this.x-=r,this.y-=r,this.z-=r,this}subVectors(r,l){return this.x=r.x-l.x,this.y=r.y-l.y,this.z=r.z-l.z,this}multiply(r,l){return l!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(r,l)):(this.x*=r.x,this.y*=r.y,this.z*=r.z,this)}multiplyScalar(r){return this.x*=r,this.y*=r,this.z*=r,this}multiplyVectors(r,l){return this.x=r.x*l.x,this.y=r.y*l.y,this.z=r.z*l.z,this}applyEuler(r){return r&&r.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(Ow.setFromEuler(r))}applyAxisAngle(r,l){return this.applyQuaternion(Ow.setFromAxisAngle(r,l))}applyMatrix3(r){const l=this.x,d=this.y,v=this.z,w=r.elements;return this.x=w[0]*l+w[3]*d+w[6]*v,this.y=w[1]*l+w[4]*d+w[7]*v,this.z=w[2]*l+w[5]*d+w[8]*v,this}applyNormalMatrix(r){return this.applyMatrix3(r).normalize()}applyMatrix4(r){const l=this.x,d=this.y,v=this.z,w=r.elements,C=1/(w[3]*l+w[7]*d+w[11]*v+w[15]);return this.x=(w[0]*l+w[4]*d+w[8]*v+w[12])*C,this.y=(w[1]*l+w[5]*d+w[9]*v+w[13])*C,this.z=(w[2]*l+w[6]*d+w[10]*v+w[14])*C,this}applyQuaternion(r){const l=this.x,d=this.y,v=this.z,w=r.x,C=r.y,O=r.z,z=r.w,H=z*l+C*v-O*d,ne=z*d+O*l-w*v,re=z*v+w*d-C*l,se=-w*l-C*d-O*v;return this.x=H*z+se*-w+ne*-O-re*-C,this.y=ne*z+se*-C+re*-w-H*-O,this.z=re*z+se*-O+H*-C-ne*-w,this}project(r){return this.applyMatrix4(r.matrixWorldInverse).applyMatrix4(r.projectionMatrix)}unproject(r){return this.applyMatrix4(r.projectionMatrixInverse).applyMatrix4(r.matrixWorld)}transformDirection(r){const l=this.x,d=this.y,v=this.z,w=r.elements;return this.x=w[0]*l+w[4]*d+w[8]*v,this.y=w[1]*l+w[5]*d+w[9]*v,this.z=w[2]*l+w[6]*d+w[10]*v,this.normalize()}divide(r){return this.x/=r.x,this.y/=r.y,this.z/=r.z,this}divideScalar(r){return this.multiplyScalar(1/r)}min(r){return this.x=Math.min(this.x,r.x),this.y=Math.min(this.y,r.y),this.z=Math.min(this.z,r.z),this}max(r){return this.x=Math.max(this.x,r.x),this.y=Math.max(this.y,r.y),this.z=Math.max(this.z,r.z),this}clamp(r,l){return this.x=Math.max(r.x,Math.min(l.x,this.x)),this.y=Math.max(r.y,Math.min(l.y,this.y)),this.z=Math.max(r.z,Math.min(l.z,this.z)),this}clampScalar(r,l){return this.x=Math.max(r,Math.min(l,this.x)),this.y=Math.max(r,Math.min(l,this.y)),this.z=Math.max(r,Math.min(l,this.z)),this}clampLength(r,l){const d=this.length();return this.divideScalar(d||1).multiplyScalar(Math.max(r,Math.min(l,d)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(r){return this.x*r.x+this.y*r.y+this.z*r.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(r){return this.normalize().multiplyScalar(r)}lerp(r,l){return this.x+=(r.x-this.x)*l,this.y+=(r.y-this.y)*l,this.z+=(r.z-this.z)*l,this}lerpVectors(r,l,d){return this.x=r.x+(l.x-r.x)*d,this.y=r.y+(l.y-r.y)*d,this.z=r.z+(l.z-r.z)*d,this}cross(r,l){return l!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(r,l)):this.crossVectors(this,r)}crossVectors(r,l){const d=r.x,v=r.y,w=r.z,C=l.x,O=l.y,z=l.z;return this.x=v*z-w*O,this.y=w*C-d*z,this.z=d*O-v*C,this}projectOnVector(r){const l=r.lengthSq();if(l===0)return this.set(0,0,0);const d=r.dot(this)/l;return this.copy(r).multiplyScalar(d)}projectOnPlane(r){return c1.copy(this).projectOnVector(r),this.sub(c1)}reflect(r){return this.sub(c1.copy(r).multiplyScalar(2*this.dot(r)))}angleTo(r){const l=Math.sqrt(this.lengthSq()*r.lengthSq());if(l===0)return Math.PI/2;const d=this.dot(r)/l;return Math.acos(ys(d,-1,1))}distanceTo(r){return Math.sqrt(this.distanceToSquared(r))}distanceToSquared(r){const l=this.x-r.x,d=this.y-r.y,v=this.z-r.z;return l*l+d*d+v*v}manhattanDistanceTo(r){return Math.abs(this.x-r.x)+Math.abs(this.y-r.y)+Math.abs(this.z-r.z)}setFromSpherical(r){return this.setFromSphericalCoords(r.radius,r.phi,r.theta)}setFromSphericalCoords(r,l,d){const v=Math.sin(l)*r;return this.x=v*Math.sin(d),this.y=Math.cos(l)*r,this.z=v*Math.cos(d),this}setFromCylindrical(r){return this.setFromCylindricalCoords(r.radius,r.theta,r.y)}setFromCylindricalCoords(r,l,d){return this.x=r*Math.sin(l),this.y=d,this.z=r*Math.cos(l),this}setFromMatrixPosition(r){const l=r.elements;return this.x=l[12],this.y=l[13],this.z=l[14],this}setFromMatrixScale(r){const l=this.setFromMatrixColumn(r,0).length(),d=this.setFromMatrixColumn(r,1).length(),v=this.setFromMatrixColumn(r,2).length();return this.x=l,this.y=d,this.z=v,this}setFromMatrixColumn(r,l){return this.fromArray(r.elements,l*4)}setFromMatrix3Column(r,l){return this.fromArray(r.elements,l*3)}equals(r){return r.x===this.x&&r.y===this.y&&r.z===this.z}fromArray(r,l=0){return this.x=r[l],this.y=r[l+1],this.z=r[l+2],this}toArray(r=[],l=0){return r[l]=this.x,r[l+1]=this.y,r[l+2]=this.z,r}fromBufferAttribute(r,l,d){return d!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=r.getX(l),this.y=r.getY(l),this.z=r.getZ(l),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const r=(Math.random()-.5)*2,l=Math.random()*Math.PI*2,d=Math.sqrt(1-r**2);return this.x=d*Math.cos(l),this.y=d*Math.sin(l),this.z=r,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}qe.prototype.isVector3=!0;const c1=new qe,Ow=new os;class po{constructor(r=new qe(1/0,1/0,1/0),l=new qe(-1/0,-1/0,-1/0)){this.min=r,this.max=l}set(r,l){return this.min.copy(r),this.max.copy(l),this}setFromArray(r){let l=1/0,d=1/0,v=1/0,w=-1/0,C=-1/0,O=-1/0;for(let z=0,H=r.length;z<H;z+=3){const ne=r[z],re=r[z+1],se=r[z+2];ne<l&&(l=ne),re<d&&(d=re),se<v&&(v=se),ne>w&&(w=ne),re>C&&(C=re),se>O&&(O=se)}return this.min.set(l,d,v),this.max.set(w,C,O),this}setFromBufferAttribute(r){let l=1/0,d=1/0,v=1/0,w=-1/0,C=-1/0,O=-1/0;for(let z=0,H=r.count;z<H;z++){const ne=r.getX(z),re=r.getY(z),se=r.getZ(z);ne<l&&(l=ne),re<d&&(d=re),se<v&&(v=se),ne>w&&(w=ne),re>C&&(C=re),se>O&&(O=se)}return this.min.set(l,d,v),this.max.set(w,C,O),this}setFromPoints(r){this.makeEmpty();for(let l=0,d=r.length;l<d;l++)this.expandByPoint(r[l]);return this}setFromCenterAndSize(r,l){const d=cu.copy(l).multiplyScalar(.5);return this.min.copy(r).sub(d),this.max.copy(r).add(d),this}setFromObject(r,l=!1){return this.makeEmpty(),this.expandByObject(r,l)}clone(){return new this.constructor().copy(this)}copy(r){return this.min.copy(r.min),this.max.copy(r.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(r){return this.isEmpty()?r.set(0,0,0):r.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(r){return this.isEmpty()?r.set(0,0,0):r.subVectors(this.max,this.min)}expandByPoint(r){return this.min.min(r),this.max.max(r),this}expandByVector(r){return this.min.sub(r),this.max.add(r),this}expandByScalar(r){return this.min.addScalar(-r),this.max.addScalar(r),this}expandByObject(r,l=!1){r.updateWorldMatrix(!1,!1);const d=r.geometry;if(d!==void 0)if(l&&d.attributes!=null&&d.attributes.position!==void 0){const w=d.attributes.position;for(let C=0,O=w.count;C<O;C++)cu.fromBufferAttribute(w,C).applyMatrix4(r.matrixWorld),this.expandByPoint(cu)}else d.boundingBox===null&&d.computeBoundingBox(),u1.copy(d.boundingBox),u1.applyMatrix4(r.matrixWorld),this.union(u1);const v=r.children;for(let w=0,C=v.length;w<C;w++)this.expandByObject(v[w],l);return this}containsPoint(r){return!(r.x<this.min.x||r.x>this.max.x||r.y<this.min.y||r.y>this.max.y||r.z<this.min.z||r.z>this.max.z)}containsBox(r){return this.min.x<=r.min.x&&r.max.x<=this.max.x&&this.min.y<=r.min.y&&r.max.y<=this.max.y&&this.min.z<=r.min.z&&r.max.z<=this.max.z}getParameter(r,l){return l.set((r.x-this.min.x)/(this.max.x-this.min.x),(r.y-this.min.y)/(this.max.y-this.min.y),(r.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(r){return!(r.max.x<this.min.x||r.min.x>this.max.x||r.max.y<this.min.y||r.min.y>this.max.y||r.max.z<this.min.z||r.min.z>this.max.z)}intersectsSphere(r){return this.clampPoint(r.center,cu),cu.distanceToSquared(r.center)<=r.radius*r.radius}intersectsPlane(r){let l,d;return r.normal.x>0?(l=r.normal.x*this.min.x,d=r.normal.x*this.max.x):(l=r.normal.x*this.max.x,d=r.normal.x*this.min.x),r.normal.y>0?(l+=r.normal.y*this.min.y,d+=r.normal.y*this.max.y):(l+=r.normal.y*this.max.y,d+=r.normal.y*this.min.y),r.normal.z>0?(l+=r.normal.z*this.min.z,d+=r.normal.z*this.max.z):(l+=r.normal.z*this.max.z,d+=r.normal.z*this.min.z),l<=-r.constant&&d>=-r.constant}intersectsTriangle(r){if(this.isEmpty())return!1;this.getCenter(tp),Km.subVectors(this.max,tp),kh.subVectors(r.a,tp),zh.subVectors(r.b,tp),Hh.subVectors(r.c,tp),Yl.subVectors(zh,kh),Ql.subVectors(Hh,zh),uu.subVectors(kh,Hh);let l=[0,-Yl.z,Yl.y,0,-Ql.z,Ql.y,0,-uu.z,uu.y,Yl.z,0,-Yl.x,Ql.z,0,-Ql.x,uu.z,0,-uu.x,-Yl.y,Yl.x,0,-Ql.y,Ql.x,0,-uu.y,uu.x,0];return!h1(l,kh,zh,Hh,Km)||(l=[1,0,0,0,1,0,0,0,1],!h1(l,kh,zh,Hh,Km))?!1:(Zm.crossVectors(Yl,Ql),l=[Zm.x,Zm.y,Zm.z],h1(l,kh,zh,Hh,Km))}clampPoint(r,l){return l.copy(r).clamp(this.min,this.max)}distanceToPoint(r){return cu.copy(r).clamp(this.min,this.max).sub(r).length()}getBoundingSphere(r){return this.getCenter(r.center),r.radius=this.getSize(cu).length()*.5,r}intersect(r){return this.min.max(r.min),this.max.min(r.max),this.isEmpty()&&this.makeEmpty(),this}union(r){return this.min.min(r.min),this.max.max(r.max),this}applyMatrix4(r){return this.isEmpty()?this:(fl[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(r),fl[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(r),fl[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(r),fl[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(r),fl[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(r),fl[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(r),fl[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(r),fl[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(r),this.setFromPoints(fl),this)}translate(r){return this.min.add(r),this.max.add(r),this}equals(r){return r.min.equals(this.min)&&r.max.equals(this.max)}}po.prototype.isBox3=!0;const fl=[new qe,new qe,new qe,new qe,new qe,new qe,new qe,new qe],cu=new qe,u1=new po,kh=new qe,zh=new qe,Hh=new qe,Yl=new qe,Ql=new qe,uu=new qe,tp=new qe,Km=new qe,Zm=new qe,hu=new qe;function h1(A,r,l,d,v){for(let w=0,C=A.length-3;w<=C;w+=3){hu.fromArray(A,w);const O=v.x*Math.abs(hu.x)+v.y*Math.abs(hu.y)+v.z*Math.abs(hu.z),z=r.dot(hu),H=l.dot(hu),ne=d.dot(hu);if(Math.max(-Math.max(z,H,ne),Math.min(z,H,ne))>O)return!1}return!0}const NI=new po,Dw=new qe,Jm=new qe,f1=new qe;class Kl{constructor(r=new qe,l=-1){this.center=r,this.radius=l}set(r,l){return this.center.copy(r),this.radius=l,this}setFromPoints(r,l){const d=this.center;l!==void 0?d.copy(l):NI.setFromPoints(r).getCenter(d);let v=0;for(let w=0,C=r.length;w<C;w++)v=Math.max(v,d.distanceToSquared(r[w]));return this.radius=Math.sqrt(v),this}copy(r){return this.center.copy(r.center),this.radius=r.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(r){return r.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(r){return r.distanceTo(this.center)-this.radius}intersectsSphere(r){const l=this.radius+r.radius;return r.center.distanceToSquared(this.center)<=l*l}intersectsBox(r){return r.intersectsSphere(this)}intersectsPlane(r){return Math.abs(r.distanceToPoint(this.center))<=this.radius}clampPoint(r,l){const d=this.center.distanceToSquared(r);return l.copy(r),d>this.radius*this.radius&&(l.sub(this.center).normalize(),l.multiplyScalar(this.radius).add(this.center)),l}getBoundingBox(r){return this.isEmpty()?(r.makeEmpty(),r):(r.set(this.center,this.center),r.expandByScalar(this.radius),r)}applyMatrix4(r){return this.center.applyMatrix4(r),this.radius=this.radius*r.getMaxScaleOnAxis(),this}translate(r){return this.center.add(r),this}expandByPoint(r){f1.subVectors(r,this.center);const l=f1.lengthSq();if(l>this.radius*this.radius){const d=Math.sqrt(l),v=(d-this.radius)*.5;this.center.add(f1.multiplyScalar(v/d)),this.radius+=v}return this}union(r){return this.center.equals(r.center)===!0?Jm.set(0,0,1).multiplyScalar(r.radius):Jm.subVectors(r.center,this.center).normalize().multiplyScalar(r.radius),this.expandByPoint(Dw.copy(r.center).add(Jm)),this.expandByPoint(Dw.copy(r.center).sub(Jm)),this}equals(r){return r.center.equals(this.center)&&r.radius===this.radius}clone(){return new this.constructor().copy(this)}}const dl=new qe,d1=new qe,e0=new qe,Zl=new qe,p1=new qe,t0=new qe,m1=new qe;class Jl{constructor(r=new qe,l=new qe(0,0,-1)){this.origin=r,this.direction=l}set(r,l){return this.origin.copy(r),this.direction.copy(l),this}copy(r){return this.origin.copy(r.origin),this.direction.copy(r.direction),this}at(r,l){return l.copy(this.direction).multiplyScalar(r).add(this.origin)}lookAt(r){return this.direction.copy(r).sub(this.origin).normalize(),this}recast(r){return this.origin.copy(this.at(r,dl)),this}closestPointToPoint(r,l){l.subVectors(r,this.origin);const d=l.dot(this.direction);return d<0?l.copy(this.origin):l.copy(this.direction).multiplyScalar(d).add(this.origin)}distanceToPoint(r){return Math.sqrt(this.distanceSqToPoint(r))}distanceSqToPoint(r){const l=dl.subVectors(r,this.origin).dot(this.direction);return l<0?this.origin.distanceToSquared(r):(dl.copy(this.direction).multiplyScalar(l).add(this.origin),dl.distanceToSquared(r))}distanceSqToSegment(r,l,d,v){d1.copy(r).add(l).multiplyScalar(.5),e0.copy(l).sub(r).normalize(),Zl.copy(this.origin).sub(d1);const w=r.distanceTo(l)*.5,C=-this.direction.dot(e0),O=Zl.dot(this.direction),z=-Zl.dot(e0),H=Zl.lengthSq(),ne=Math.abs(1-C*C);let re,se,oe,ve;if(ne>0)if(re=C*z-O,se=C*O-z,ve=w*ne,re>=0)if(se>=-ve)if(se<=ve){const Te=1/ne;re*=Te,se*=Te,oe=re*(re+C*se+2*O)+se*(C*re+se+2*z)+H}else se=w,re=Math.max(0,-(C*se+O)),oe=-re*re+se*(se+2*z)+H;else se=-w,re=Math.max(0,-(C*se+O)),oe=-re*re+se*(se+2*z)+H;else se<=-ve?(re=Math.max(0,-(-C*w+O)),se=re>0?-w:Math.min(Math.max(-w,-z),w),oe=-re*re+se*(se+2*z)+H):se<=ve?(re=0,se=Math.min(Math.max(-w,-z),w),oe=se*(se+2*z)+H):(re=Math.max(0,-(C*w+O)),se=re>0?w:Math.min(Math.max(-w,-z),w),oe=-re*re+se*(se+2*z)+H);else se=C>0?-w:w,re=Math.max(0,-(C*se+O)),oe=-re*re+se*(se+2*z)+H;return d&&d.copy(this.direction).multiplyScalar(re).add(this.origin),v&&v.copy(e0).multiplyScalar(se).add(d1),oe}intersectSphere(r,l){dl.subVectors(r.center,this.origin);const d=dl.dot(this.direction),v=dl.dot(dl)-d*d,w=r.radius*r.radius;if(v>w)return null;const C=Math.sqrt(w-v),O=d-C,z=d+C;return O<0&&z<0?null:O<0?this.at(z,l):this.at(O,l)}intersectsSphere(r){return this.distanceSqToPoint(r.center)<=r.radius*r.radius}distanceToPlane(r){const l=r.normal.dot(this.direction);if(l===0)return r.distanceToPoint(this.origin)===0?0:null;const d=-(this.origin.dot(r.normal)+r.constant)/l;return d>=0?d:null}intersectPlane(r,l){const d=this.distanceToPlane(r);return d===null?null:this.at(d,l)}intersectsPlane(r){const l=r.distanceToPoint(this.origin);return l===0||r.normal.dot(this.direction)*l<0}intersectBox(r,l){let d,v,w,C,O,z;const H=1/this.direction.x,ne=1/this.direction.y,re=1/this.direction.z,se=this.origin;return H>=0?(d=(r.min.x-se.x)*H,v=(r.max.x-se.x)*H):(d=(r.max.x-se.x)*H,v=(r.min.x-se.x)*H),ne>=0?(w=(r.min.y-se.y)*ne,C=(r.max.y-se.y)*ne):(w=(r.max.y-se.y)*ne,C=(r.min.y-se.y)*ne),d>C||w>v||((w>d||d!==d)&&(d=w),(C<v||v!==v)&&(v=C),re>=0?(O=(r.min.z-se.z)*re,z=(r.max.z-se.z)*re):(O=(r.max.z-se.z)*re,z=(r.min.z-se.z)*re),d>z||O>v)||((O>d||d!==d)&&(d=O),(z<v||v!==v)&&(v=z),v<0)?null:this.at(d>=0?d:v,l)}intersectsBox(r){return this.intersectBox(r,dl)!==null}intersectTriangle(r,l,d,v,w){p1.subVectors(l,r),t0.subVectors(d,r),m1.crossVectors(p1,t0);let C=this.direction.dot(m1),O;if(C>0){if(v)return null;O=1}else if(C<0)O=-1,C=-C;else return null;Zl.subVectors(this.origin,r);const z=O*this.direction.dot(t0.crossVectors(Zl,t0));if(z<0)return null;const H=O*this.direction.dot(p1.cross(Zl));if(H<0||z+H>C)return null;const ne=-O*Zl.dot(m1);return ne<0?null:this.at(ne/C,w)}applyMatrix4(r){return this.origin.applyMatrix4(r),this.direction.transformDirection(r),this}equals(r){return r.origin.equals(this.origin)&&r.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Jn{constructor(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(r,l,d,v,w,C,O,z,H,ne,re,se,oe,ve,Te,Fe){const Ae=this.elements;return Ae[0]=r,Ae[4]=l,Ae[8]=d,Ae[12]=v,Ae[1]=w,Ae[5]=C,Ae[9]=O,Ae[13]=z,Ae[2]=H,Ae[6]=ne,Ae[10]=re,Ae[14]=se,Ae[3]=oe,Ae[7]=ve,Ae[11]=Te,Ae[15]=Fe,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Jn().fromArray(this.elements)}copy(r){const l=this.elements,d=r.elements;return l[0]=d[0],l[1]=d[1],l[2]=d[2],l[3]=d[3],l[4]=d[4],l[5]=d[5],l[6]=d[6],l[7]=d[7],l[8]=d[8],l[9]=d[9],l[10]=d[10],l[11]=d[11],l[12]=d[12],l[13]=d[13],l[14]=d[14],l[15]=d[15],this}copyPosition(r){const l=this.elements,d=r.elements;return l[12]=d[12],l[13]=d[13],l[14]=d[14],this}setFromMatrix3(r){const l=r.elements;return this.set(l[0],l[3],l[6],0,l[1],l[4],l[7],0,l[2],l[5],l[8],0,0,0,0,1),this}extractBasis(r,l,d){return r.setFromMatrixColumn(this,0),l.setFromMatrixColumn(this,1),d.setFromMatrixColumn(this,2),this}makeBasis(r,l,d){return this.set(r.x,l.x,d.x,0,r.y,l.y,d.y,0,r.z,l.z,d.z,0,0,0,0,1),this}extractRotation(r){const l=this.elements,d=r.elements,v=1/Gh.setFromMatrixColumn(r,0).length(),w=1/Gh.setFromMatrixColumn(r,1).length(),C=1/Gh.setFromMatrixColumn(r,2).length();return l[0]=d[0]*v,l[1]=d[1]*v,l[2]=d[2]*v,l[3]=0,l[4]=d[4]*w,l[5]=d[5]*w,l[6]=d[6]*w,l[7]=0,l[8]=d[8]*C,l[9]=d[9]*C,l[10]=d[10]*C,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,this}makeRotationFromEuler(r){r&&r.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const l=this.elements,d=r.x,v=r.y,w=r.z,C=Math.cos(d),O=Math.sin(d),z=Math.cos(v),H=Math.sin(v),ne=Math.cos(w),re=Math.sin(w);if(r.order==="XYZ"){const se=C*ne,oe=C*re,ve=O*ne,Te=O*re;l[0]=z*ne,l[4]=-z*re,l[8]=H,l[1]=oe+ve*H,l[5]=se-Te*H,l[9]=-O*z,l[2]=Te-se*H,l[6]=ve+oe*H,l[10]=C*z}else if(r.order==="YXZ"){const se=z*ne,oe=z*re,ve=H*ne,Te=H*re;l[0]=se+Te*O,l[4]=ve*O-oe,l[8]=C*H,l[1]=C*re,l[5]=C*ne,l[9]=-O,l[2]=oe*O-ve,l[6]=Te+se*O,l[10]=C*z}else if(r.order==="ZXY"){const se=z*ne,oe=z*re,ve=H*ne,Te=H*re;l[0]=se-Te*O,l[4]=-C*re,l[8]=ve+oe*O,l[1]=oe+ve*O,l[5]=C*ne,l[9]=Te-se*O,l[2]=-C*H,l[6]=O,l[10]=C*z}else if(r.order==="ZYX"){const se=C*ne,oe=C*re,ve=O*ne,Te=O*re;l[0]=z*ne,l[4]=ve*H-oe,l[8]=se*H+Te,l[1]=z*re,l[5]=Te*H+se,l[9]=oe*H-ve,l[2]=-H,l[6]=O*z,l[10]=C*z}else if(r.order==="YZX"){const se=C*z,oe=C*H,ve=O*z,Te=O*H;l[0]=z*ne,l[4]=Te-se*re,l[8]=ve*re+oe,l[1]=re,l[5]=C*ne,l[9]=-O*ne,l[2]=-H*ne,l[6]=oe*re+ve,l[10]=se-Te*re}else if(r.order==="XZY"){const se=C*z,oe=C*H,ve=O*z,Te=O*H;l[0]=z*ne,l[4]=-re,l[8]=H*ne,l[1]=se*re+Te,l[5]=C*ne,l[9]=oe*re-ve,l[2]=ve*re-oe,l[6]=O*ne,l[10]=Te*re+se}return l[3]=0,l[7]=0,l[11]=0,l[12]=0,l[13]=0,l[14]=0,l[15]=1,this}makeRotationFromQuaternion(r){return this.compose(UI,r,kI)}lookAt(r,l,d){const v=this.elements;return mo.subVectors(r,l),mo.lengthSq()===0&&(mo.z=1),mo.normalize(),ec.crossVectors(d,mo),ec.lengthSq()===0&&(Math.abs(d.z)===1?mo.x+=1e-4:mo.z+=1e-4,mo.normalize(),ec.crossVectors(d,mo)),ec.normalize(),n0.crossVectors(mo,ec),v[0]=ec.x,v[4]=n0.x,v[8]=mo.x,v[1]=ec.y,v[5]=n0.y,v[9]=mo.y,v[2]=ec.z,v[6]=n0.z,v[10]=mo.z,this}multiply(r,l){return l!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(r,l)):this.multiplyMatrices(this,r)}premultiply(r){return this.multiplyMatrices(r,this)}multiplyMatrices(r,l){const d=r.elements,v=l.elements,w=this.elements,C=d[0],O=d[4],z=d[8],H=d[12],ne=d[1],re=d[5],se=d[9],oe=d[13],ve=d[2],Te=d[6],Fe=d[10],Ae=d[14],ue=d[3],Ve=d[7],ke=d[11],je=d[15],st=v[0],At=v[4],Et=v[8],Xt=v[12],Ht=v[1],Ne=v[5],ct=v[9],It=v[13],Nt=v[2],Pt=v[6],Gt=v[10],sn=v[14],bn=v[3],kn=v[7],si=v[11],Vn=v[15];return w[0]=C*st+O*Ht+z*Nt+H*bn,w[4]=C*At+O*Ne+z*Pt+H*kn,w[8]=C*Et+O*ct+z*Gt+H*si,w[12]=C*Xt+O*It+z*sn+H*Vn,w[1]=ne*st+re*Ht+se*Nt+oe*bn,w[5]=ne*At+re*Ne+se*Pt+oe*kn,w[9]=ne*Et+re*ct+se*Gt+oe*si,w[13]=ne*Xt+re*It+se*sn+oe*Vn,w[2]=ve*st+Te*Ht+Fe*Nt+Ae*bn,w[6]=ve*At+Te*Ne+Fe*Pt+Ae*kn,w[10]=ve*Et+Te*ct+Fe*Gt+Ae*si,w[14]=ve*Xt+Te*It+Fe*sn+Ae*Vn,w[3]=ue*st+Ve*Ht+ke*Nt+je*bn,w[7]=ue*At+Ve*Ne+ke*Pt+je*kn,w[11]=ue*Et+Ve*ct+ke*Gt+je*si,w[15]=ue*Xt+Ve*It+ke*sn+je*Vn,this}multiplyScalar(r){const l=this.elements;return l[0]*=r,l[4]*=r,l[8]*=r,l[12]*=r,l[1]*=r,l[5]*=r,l[9]*=r,l[13]*=r,l[2]*=r,l[6]*=r,l[10]*=r,l[14]*=r,l[3]*=r,l[7]*=r,l[11]*=r,l[15]*=r,this}determinant(){const r=this.elements,l=r[0],d=r[4],v=r[8],w=r[12],C=r[1],O=r[5],z=r[9],H=r[13],ne=r[2],re=r[6],se=r[10],oe=r[14],ve=r[3],Te=r[7],Fe=r[11],Ae=r[15];return ve*(+w*z*re-v*H*re-w*O*se+d*H*se+v*O*oe-d*z*oe)+Te*(+l*z*oe-l*H*se+w*C*se-v*C*oe+v*H*ne-w*z*ne)+Fe*(+l*H*re-l*O*oe-w*C*re+d*C*oe+w*O*ne-d*H*ne)+Ae*(-v*O*ne-l*z*re+l*O*se+v*C*re-d*C*se+d*z*ne)}transpose(){const r=this.elements;let l;return l=r[1],r[1]=r[4],r[4]=l,l=r[2],r[2]=r[8],r[8]=l,l=r[6],r[6]=r[9],r[9]=l,l=r[3],r[3]=r[12],r[12]=l,l=r[7],r[7]=r[13],r[13]=l,l=r[11],r[11]=r[14],r[14]=l,this}setPosition(r,l,d){const v=this.elements;return r.isVector3?(v[12]=r.x,v[13]=r.y,v[14]=r.z):(v[12]=r,v[13]=l,v[14]=d),this}invert(){const r=this.elements,l=r[0],d=r[1],v=r[2],w=r[3],C=r[4],O=r[5],z=r[6],H=r[7],ne=r[8],re=r[9],se=r[10],oe=r[11],ve=r[12],Te=r[13],Fe=r[14],Ae=r[15],ue=re*Fe*H-Te*se*H+Te*z*oe-O*Fe*oe-re*z*Ae+O*se*Ae,Ve=ve*se*H-ne*Fe*H-ve*z*oe+C*Fe*oe+ne*z*Ae-C*se*Ae,ke=ne*Te*H-ve*re*H+ve*O*oe-C*Te*oe-ne*O*Ae+C*re*Ae,je=ve*re*z-ne*Te*z-ve*O*se+C*Te*se+ne*O*Fe-C*re*Fe,st=l*ue+d*Ve+v*ke+w*je;if(st===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const At=1/st;return r[0]=ue*At,r[1]=(Te*se*w-re*Fe*w-Te*v*oe+d*Fe*oe+re*v*Ae-d*se*Ae)*At,r[2]=(O*Fe*w-Te*z*w+Te*v*H-d*Fe*H-O*v*Ae+d*z*Ae)*At,r[3]=(re*z*w-O*se*w-re*v*H+d*se*H+O*v*oe-d*z*oe)*At,r[4]=Ve*At,r[5]=(ne*Fe*w-ve*se*w+ve*v*oe-l*Fe*oe-ne*v*Ae+l*se*Ae)*At,r[6]=(ve*z*w-C*Fe*w-ve*v*H+l*Fe*H+C*v*Ae-l*z*Ae)*At,r[7]=(C*se*w-ne*z*w+ne*v*H-l*se*H-C*v*oe+l*z*oe)*At,r[8]=ke*At,r[9]=(ve*re*w-ne*Te*w-ve*d*oe+l*Te*oe+ne*d*Ae-l*re*Ae)*At,r[10]=(C*Te*w-ve*O*w+ve*d*H-l*Te*H-C*d*Ae+l*O*Ae)*At,r[11]=(ne*O*w-C*re*w-ne*d*H+l*re*H+C*d*oe-l*O*oe)*At,r[12]=je*At,r[13]=(ne*Te*v-ve*re*v+ve*d*se-l*Te*se-ne*d*Fe+l*re*Fe)*At,r[14]=(ve*O*v-C*Te*v-ve*d*z+l*Te*z+C*d*Fe-l*O*Fe)*At,r[15]=(C*re*v-ne*O*v+ne*d*z-l*re*z-C*d*se+l*O*se)*At,this}scale(r){const l=this.elements,d=r.x,v=r.y,w=r.z;return l[0]*=d,l[4]*=v,l[8]*=w,l[1]*=d,l[5]*=v,l[9]*=w,l[2]*=d,l[6]*=v,l[10]*=w,l[3]*=d,l[7]*=v,l[11]*=w,this}getMaxScaleOnAxis(){const r=this.elements,l=r[0]*r[0]+r[1]*r[1]+r[2]*r[2],d=r[4]*r[4]+r[5]*r[5]+r[6]*r[6],v=r[8]*r[8]+r[9]*r[9]+r[10]*r[10];return Math.sqrt(Math.max(l,d,v))}makeTranslation(r,l,d){return this.set(1,0,0,r,0,1,0,l,0,0,1,d,0,0,0,1),this}makeRotationX(r){const l=Math.cos(r),d=Math.sin(r);return this.set(1,0,0,0,0,l,-d,0,0,d,l,0,0,0,0,1),this}makeRotationY(r){const l=Math.cos(r),d=Math.sin(r);return this.set(l,0,d,0,0,1,0,0,-d,0,l,0,0,0,0,1),this}makeRotationZ(r){const l=Math.cos(r),d=Math.sin(r);return this.set(l,-d,0,0,d,l,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(r,l){const d=Math.cos(l),v=Math.sin(l),w=1-d,C=r.x,O=r.y,z=r.z,H=w*C,ne=w*O;return this.set(H*C+d,H*O-v*z,H*z+v*O,0,H*O+v*z,ne*O+d,ne*z-v*C,0,H*z-v*O,ne*z+v*C,w*z*z+d,0,0,0,0,1),this}makeScale(r,l,d){return this.set(r,0,0,0,0,l,0,0,0,0,d,0,0,0,0,1),this}makeShear(r,l,d,v,w,C){return this.set(1,d,w,0,r,1,C,0,l,v,1,0,0,0,0,1),this}compose(r,l,d){const v=this.elements,w=l._x,C=l._y,O=l._z,z=l._w,H=w+w,ne=C+C,re=O+O,se=w*H,oe=w*ne,ve=w*re,Te=C*ne,Fe=C*re,Ae=O*re,ue=z*H,Ve=z*ne,ke=z*re,je=d.x,st=d.y,At=d.z;return v[0]=(1-(Te+Ae))*je,v[1]=(oe+ke)*je,v[2]=(ve-Ve)*je,v[3]=0,v[4]=(oe-ke)*st,v[5]=(1-(se+Ae))*st,v[6]=(Fe+ue)*st,v[7]=0,v[8]=(ve+Ve)*At,v[9]=(Fe-ue)*At,v[10]=(1-(se+Te))*At,v[11]=0,v[12]=r.x,v[13]=r.y,v[14]=r.z,v[15]=1,this}decompose(r,l,d){const v=this.elements;let w=Gh.set(v[0],v[1],v[2]).length();const C=Gh.set(v[4],v[5],v[6]).length(),O=Gh.set(v[8],v[9],v[10]).length();this.determinant()<0&&(w=-w),r.x=v[12],r.y=v[13],r.z=v[14],qo.copy(this);const H=1/w,ne=1/C,re=1/O;return qo.elements[0]*=H,qo.elements[1]*=H,qo.elements[2]*=H,qo.elements[4]*=ne,qo.elements[5]*=ne,qo.elements[6]*=ne,qo.elements[8]*=re,qo.elements[9]*=re,qo.elements[10]*=re,l.setFromRotationMatrix(qo),d.x=w,d.y=C,d.z=O,this}makePerspective(r,l,d,v,w,C){C===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const O=this.elements,z=2*w/(l-r),H=2*w/(d-v),ne=(l+r)/(l-r),re=(d+v)/(d-v),se=-(C+w)/(C-w),oe=-2*C*w/(C-w);return O[0]=z,O[4]=0,O[8]=ne,O[12]=0,O[1]=0,O[5]=H,O[9]=re,O[13]=0,O[2]=0,O[6]=0,O[10]=se,O[14]=oe,O[3]=0,O[7]=0,O[11]=-1,O[15]=0,this}makeOrthographic(r,l,d,v,w,C){const O=this.elements,z=1/(l-r),H=1/(d-v),ne=1/(C-w),re=(l+r)*z,se=(d+v)*H,oe=(C+w)*ne;return O[0]=2*z,O[4]=0,O[8]=0,O[12]=-re,O[1]=0,O[5]=2*H,O[9]=0,O[13]=-se,O[2]=0,O[6]=0,O[10]=-2*ne,O[14]=-oe,O[3]=0,O[7]=0,O[11]=0,O[15]=1,this}equals(r){const l=this.elements,d=r.elements;for(let v=0;v<16;v++)if(l[v]!==d[v])return!1;return!0}fromArray(r,l=0){for(let d=0;d<16;d++)this.elements[d]=r[d+l];return this}toArray(r=[],l=0){const d=this.elements;return r[l]=d[0],r[l+1]=d[1],r[l+2]=d[2],r[l+3]=d[3],r[l+4]=d[4],r[l+5]=d[5],r[l+6]=d[6],r[l+7]=d[7],r[l+8]=d[8],r[l+9]=d[9],r[l+10]=d[10],r[l+11]=d[11],r[l+12]=d[12],r[l+13]=d[13],r[l+14]=d[14],r[l+15]=d[15],r}}Jn.prototype.isMatrix4=!0;const Gh=new qe,qo=new Jn,UI=new qe(0,0,0),kI=new qe(1,1,1),ec=new qe,n0=new qe,mo=new qe,Bw=new Jn,Fw=new os;class fu{constructor(r=0,l=0,d=0,v=fu.DefaultOrder){this._x=r,this._y=l,this._z=d,this._order=v}get x(){return this._x}set x(r){this._x=r,this._onChangeCallback()}get y(){return this._y}set y(r){this._y=r,this._onChangeCallback()}get z(){return this._z}set z(r){this._z=r,this._onChangeCallback()}get order(){return this._order}set order(r){this._order=r,this._onChangeCallback()}set(r,l,d,v=this._order){return this._x=r,this._y=l,this._z=d,this._order=v,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(r){return this._x=r._x,this._y=r._y,this._z=r._z,this._order=r._order,this._onChangeCallback(),this}setFromRotationMatrix(r,l=this._order,d=!0){const v=r.elements,w=v[0],C=v[4],O=v[8],z=v[1],H=v[5],ne=v[9],re=v[2],se=v[6],oe=v[10];switch(l){case"XYZ":this._y=Math.asin(ys(O,-1,1)),Math.abs(O)<.9999999?(this._x=Math.atan2(-ne,oe),this._z=Math.atan2(-C,w)):(this._x=Math.atan2(se,H),this._z=0);break;case"YXZ":this._x=Math.asin(-ys(ne,-1,1)),Math.abs(ne)<.9999999?(this._y=Math.atan2(O,oe),this._z=Math.atan2(z,H)):(this._y=Math.atan2(-re,w),this._z=0);break;case"ZXY":this._x=Math.asin(ys(se,-1,1)),Math.abs(se)<.9999999?(this._y=Math.atan2(-re,oe),this._z=Math.atan2(-C,H)):(this._y=0,this._z=Math.atan2(z,w));break;case"ZYX":this._y=Math.asin(-ys(re,-1,1)),Math.abs(re)<.9999999?(this._x=Math.atan2(se,oe),this._z=Math.atan2(z,w)):(this._x=0,this._z=Math.atan2(-C,H));break;case"YZX":this._z=Math.asin(ys(z,-1,1)),Math.abs(z)<.9999999?(this._x=Math.atan2(-ne,H),this._y=Math.atan2(-re,w)):(this._x=0,this._y=Math.atan2(O,oe));break;case"XZY":this._z=Math.asin(-ys(C,-1,1)),Math.abs(C)<.9999999?(this._x=Math.atan2(se,H),this._y=Math.atan2(O,w)):(this._x=Math.atan2(-ne,oe),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+l)}return this._order=l,d===!0&&this._onChangeCallback(),this}setFromQuaternion(r,l,d){return Bw.makeRotationFromQuaternion(r),this.setFromRotationMatrix(Bw,l,d)}setFromVector3(r,l=this._order){return this.set(r.x,r.y,r.z,l)}reorder(r){return Fw.setFromEuler(this),this.setFromQuaternion(Fw,r)}equals(r){return r._x===this._x&&r._y===this._y&&r._z===this._z&&r._order===this._order}fromArray(r){return this._x=r[0],this._y=r[1],this._z=r[2],r[3]!==void 0&&(this._order=r[3]),this._onChangeCallback(),this}toArray(r=[],l=0){return r[l]=this._x,r[l+1]=this._y,r[l+2]=this._z,r[l+3]=this._order,r}toVector3(r){return r?r.set(this._x,this._y,this._z):new qe(this._x,this._y,this._z)}_onChange(r){return this._onChangeCallback=r,this}_onChangeCallback(){}}fu.prototype.isEuler=!0,fu.DefaultOrder="XYZ",fu.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class i0{constructor(){this.mask=1}set(r){this.mask=(1<<r|0)>>>0}enable(r){this.mask|=1<<r|0}enableAll(){this.mask=-1}toggle(r){this.mask^=1<<r|0}disable(r){this.mask&=~(1<<r|0)}disableAll(){this.mask=0}test(r){return(this.mask&r.mask)!==0}isEnabled(r){return(this.mask&(1<<r|0))!==0}}let zI=0;const Nw=new qe,Vh=new os,pl=new Jn,r0=new qe,np=new qe,HI=new qe,GI=new os,Uw=new qe(1,0,0),kw=new qe(0,1,0),zw=new qe(0,0,1),VI={type:"added"},Hw={type:"removed"};class ki extends hl{constructor(){super(),Object.defineProperty(this,"id",{value:zI++}),this.uuid=ho(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=ki.DefaultUp.clone();const r=new qe,l=new fu,d=new os,v=new qe(1,1,1);function w(){d.setFromEuler(l,!1)}function C(){l.setFromQuaternion(d,void 0,!1)}l._onChange(w),d._onChange(C),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:r},rotation:{configurable:!0,enumerable:!0,value:l},quaternion:{configurable:!0,enumerable:!0,value:d},scale:{configurable:!0,enumerable:!0,value:v},modelViewMatrix:{value:new Jn},normalMatrix:{value:new es}}),this.matrix=new Jn,this.matrixWorld=new Jn,this.matrixAutoUpdate=ki.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new i0,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(r){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(r),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(r){return this.quaternion.premultiply(r),this}setRotationFromAxisAngle(r,l){this.quaternion.setFromAxisAngle(r,l)}setRotationFromEuler(r){this.quaternion.setFromEuler(r,!0)}setRotationFromMatrix(r){this.quaternion.setFromRotationMatrix(r)}setRotationFromQuaternion(r){this.quaternion.copy(r)}rotateOnAxis(r,l){return Vh.setFromAxisAngle(r,l),this.quaternion.multiply(Vh),this}rotateOnWorldAxis(r,l){return Vh.setFromAxisAngle(r,l),this.quaternion.premultiply(Vh),this}rotateX(r){return this.rotateOnAxis(Uw,r)}rotateY(r){return this.rotateOnAxis(kw,r)}rotateZ(r){return this.rotateOnAxis(zw,r)}translateOnAxis(r,l){return Nw.copy(r).applyQuaternion(this.quaternion),this.position.add(Nw.multiplyScalar(l)),this}translateX(r){return this.translateOnAxis(Uw,r)}translateY(r){return this.translateOnAxis(kw,r)}translateZ(r){return this.translateOnAxis(zw,r)}localToWorld(r){return r.applyMatrix4(this.matrixWorld)}worldToLocal(r){return r.applyMatrix4(pl.copy(this.matrixWorld).invert())}lookAt(r,l,d){r.isVector3?r0.copy(r):r0.set(r,l,d);const v=this.parent;this.updateWorldMatrix(!0,!1),np.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?pl.lookAt(np,r0,this.up):pl.lookAt(r0,np,this.up),this.quaternion.setFromRotationMatrix(pl),v&&(pl.extractRotation(v.matrixWorld),Vh.setFromRotationMatrix(pl),this.quaternion.premultiply(Vh.invert()))}add(r){if(arguments.length>1){for(let l=0;l<arguments.length;l++)this.add(arguments[l]);return this}return r===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",r),this):(r&&r.isObject3D?(r.parent!==null&&r.parent.remove(r),r.parent=this,this.children.push(r),r.dispatchEvent(VI)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",r),this)}remove(r){if(arguments.length>1){for(let d=0;d<arguments.length;d++)this.remove(arguments[d]);return this}const l=this.children.indexOf(r);return l!==-1&&(r.parent=null,this.children.splice(l,1),r.dispatchEvent(Hw)),this}removeFromParent(){const r=this.parent;return r!==null&&r.remove(this),this}clear(){for(let r=0;r<this.children.length;r++){const l=this.children[r];l.parent=null,l.dispatchEvent(Hw)}return this.children.length=0,this}attach(r){return this.updateWorldMatrix(!0,!1),pl.copy(this.matrixWorld).invert(),r.parent!==null&&(r.parent.updateWorldMatrix(!0,!1),pl.multiply(r.parent.matrixWorld)),r.applyMatrix4(pl),this.add(r),r.updateWorldMatrix(!1,!0),this}getObjectById(r){return this.getObjectByProperty("id",r)}getObjectByName(r){return this.getObjectByProperty("name",r)}getObjectByProperty(r,l){if(this[r]===l)return this;for(let d=0,v=this.children.length;d<v;d++){const C=this.children[d].getObjectByProperty(r,l);if(C!==void 0)return C}}getWorldPosition(r){return this.updateWorldMatrix(!0,!1),r.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(r){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(np,r,HI),r}getWorldScale(r){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(np,GI,r),r}getWorldDirection(r){this.updateWorldMatrix(!0,!1);const l=this.matrixWorld.elements;return r.set(l[8],l[9],l[10]).normalize()}raycast(){}traverse(r){r(this);const l=this.children;for(let d=0,v=l.length;d<v;d++)l[d].traverse(r)}traverseVisible(r){if(this.visible===!1)return;r(this);const l=this.children;for(let d=0,v=l.length;d<v;d++)l[d].traverseVisible(r)}traverseAncestors(r){const l=this.parent;l!==null&&(r(l),l.traverseAncestors(r))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(r){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||r)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,r=!0);const l=this.children;for(let d=0,v=l.length;d<v;d++)l[d].updateMatrixWorld(r)}updateWorldMatrix(r,l){const d=this.parent;if(r===!0&&d!==null&&d.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),l===!0){const v=this.children;for(let w=0,C=v.length;w<C;w++)v[w].updateWorldMatrix(!1,!0)}}toJSON(r){const l=r===void 0||typeof r=="string",d={};l&&(r={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{}},d.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const v={};v.uuid=this.uuid,v.type=this.type,this.name!==""&&(v.name=this.name),this.castShadow===!0&&(v.castShadow=!0),this.receiveShadow===!0&&(v.receiveShadow=!0),this.visible===!1&&(v.visible=!1),this.frustumCulled===!1&&(v.frustumCulled=!1),this.renderOrder!==0&&(v.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(v.userData=this.userData),v.layers=this.layers.mask,v.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(v.matrixAutoUpdate=!1),this.isInstancedMesh&&(v.type="InstancedMesh",v.count=this.count,v.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(v.instanceColor=this.instanceColor.toJSON()));function w(O,z){return O[z.uuid]===void 0&&(O[z.uuid]=z.toJSON(r)),z.uuid}if(this.isScene)this.background&&(this.background.isColor?v.background=this.background.toJSON():this.background.isTexture&&(v.background=this.background.toJSON(r).uuid)),this.environment&&this.environment.isTexture&&(v.environment=this.environment.toJSON(r).uuid);else if(this.isMesh||this.isLine||this.isPoints){v.geometry=w(r.geometries,this.geometry);const O=this.geometry.parameters;if(O!==void 0&&O.shapes!==void 0){const z=O.shapes;if(Array.isArray(z))for(let H=0,ne=z.length;H<ne;H++){const re=z[H];w(r.shapes,re)}else w(r.shapes,z)}}if(this.isSkinnedMesh&&(v.bindMode=this.bindMode,v.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(w(r.skeletons,this.skeleton),v.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const O=[];for(let z=0,H=this.material.length;z<H;z++)O.push(w(r.materials,this.material[z]));v.material=O}else v.material=w(r.materials,this.material);if(this.children.length>0){v.children=[];for(let O=0;O<this.children.length;O++)v.children.push(this.children[O].toJSON(r).object)}if(this.animations.length>0){v.animations=[];for(let O=0;O<this.animations.length;O++){const z=this.animations[O];v.animations.push(w(r.animations,z))}}if(l){const O=C(r.geometries),z=C(r.materials),H=C(r.textures),ne=C(r.images),re=C(r.shapes),se=C(r.skeletons),oe=C(r.animations);O.length>0&&(d.geometries=O),z.length>0&&(d.materials=z),H.length>0&&(d.textures=H),ne.length>0&&(d.images=ne),re.length>0&&(d.shapes=re),se.length>0&&(d.skeletons=se),oe.length>0&&(d.animations=oe)}return d.object=v,d;function C(O){const z=[];for(const H in O){const ne=O[H];delete ne.metadata,z.push(ne)}return z}}clone(r){return new this.constructor().copy(this,r)}copy(r,l=!0){if(this.name=r.name,this.up.copy(r.up),this.position.copy(r.position),this.rotation.order=r.rotation.order,this.quaternion.copy(r.quaternion),this.scale.copy(r.scale),this.matrix.copy(r.matrix),this.matrixWorld.copy(r.matrixWorld),this.matrixAutoUpdate=r.matrixAutoUpdate,this.matrixWorldNeedsUpdate=r.matrixWorldNeedsUpdate,this.layers.mask=r.layers.mask,this.visible=r.visible,this.castShadow=r.castShadow,this.receiveShadow=r.receiveShadow,this.frustumCulled=r.frustumCulled,this.renderOrder=r.renderOrder,this.userData=JSON.parse(JSON.stringify(r.userData)),l===!0)for(let d=0;d<r.children.length;d++){const v=r.children[d];this.add(v.clone())}return this}}ki.DefaultUp=new qe(0,1,0),ki.DefaultMatrixAutoUpdate=!0,ki.prototype.isObject3D=!0;const Yo=new qe,ml=new qe,g1=new qe,gl=new qe,Wh=new qe,jh=new qe,Gw=new qe,v1=new qe,y1=new qe,x1=new qe;class Ur{constructor(r=new qe,l=new qe,d=new qe){this.a=r,this.b=l,this.c=d}static getNormal(r,l,d,v){v.subVectors(d,l),Yo.subVectors(r,l),v.cross(Yo);const w=v.lengthSq();return w>0?v.multiplyScalar(1/Math.sqrt(w)):v.set(0,0,0)}static getBarycoord(r,l,d,v,w){Yo.subVectors(v,l),ml.subVectors(d,l),g1.subVectors(r,l);const C=Yo.dot(Yo),O=Yo.dot(ml),z=Yo.dot(g1),H=ml.dot(ml),ne=ml.dot(g1),re=C*H-O*O;if(re===0)return w.set(-2,-1,-1);const se=1/re,oe=(H*z-O*ne)*se,ve=(C*ne-O*z)*se;return w.set(1-oe-ve,ve,oe)}static containsPoint(r,l,d,v){return this.getBarycoord(r,l,d,v,gl),gl.x>=0&&gl.y>=0&&gl.x+gl.y<=1}static getUV(r,l,d,v,w,C,O,z){return this.getBarycoord(r,l,d,v,gl),z.set(0,0),z.addScaledVector(w,gl.x),z.addScaledVector(C,gl.y),z.addScaledVector(O,gl.z),z}static isFrontFacing(r,l,d,v){return Yo.subVectors(d,l),ml.subVectors(r,l),Yo.cross(ml).dot(v)<0}set(r,l,d){return this.a.copy(r),this.b.copy(l),this.c.copy(d),this}setFromPointsAndIndices(r,l,d,v){return this.a.copy(r[l]),this.b.copy(r[d]),this.c.copy(r[v]),this}setFromAttributeAndIndices(r,l,d,v){return this.a.fromBufferAttribute(r,l),this.b.fromBufferAttribute(r,d),this.c.fromBufferAttribute(r,v),this}clone(){return new this.constructor().copy(this)}copy(r){return this.a.copy(r.a),this.b.copy(r.b),this.c.copy(r.c),this}getArea(){return Yo.subVectors(this.c,this.b),ml.subVectors(this.a,this.b),Yo.cross(ml).length()*.5}getMidpoint(r){return r.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(r){return Ur.getNormal(this.a,this.b,this.c,r)}getPlane(r){return r.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(r,l){return Ur.getBarycoord(r,this.a,this.b,this.c,l)}getUV(r,l,d,v,w){return Ur.getUV(r,this.a,this.b,this.c,l,d,v,w)}containsPoint(r){return Ur.containsPoint(r,this.a,this.b,this.c)}isFrontFacing(r){return Ur.isFrontFacing(this.a,this.b,this.c,r)}intersectsBox(r){return r.intersectsTriangle(this)}closestPointToPoint(r,l){const d=this.a,v=this.b,w=this.c;let C,O;Wh.subVectors(v,d),jh.subVectors(w,d),v1.subVectors(r,d);const z=Wh.dot(v1),H=jh.dot(v1);if(z<=0&&H<=0)return l.copy(d);y1.subVectors(r,v);const ne=Wh.dot(y1),re=jh.dot(y1);if(ne>=0&&re<=ne)return l.copy(v);const se=z*re-ne*H;if(se<=0&&z>=0&&ne<=0)return C=z/(z-ne),l.copy(d).addScaledVector(Wh,C);x1.subVectors(r,w);const oe=Wh.dot(x1),ve=jh.dot(x1);if(ve>=0&&oe<=ve)return l.copy(w);const Te=oe*H-z*ve;if(Te<=0&&H>=0&&ve<=0)return O=H/(H-ve),l.copy(d).addScaledVector(jh,O);const Fe=ne*ve-oe*re;if(Fe<=0&&re-ne>=0&&oe-ve>=0)return Gw.subVectors(w,v),O=(re-ne)/(re-ne+(oe-ve)),l.copy(v).addScaledVector(Gw,O);const Ae=1/(Fe+Te+se);return C=Te*Ae,O=se*Ae,l.copy(d).addScaledVector(Wh,C).addScaledVector(jh,O)}equals(r){return r.a.equals(this.a)&&r.b.equals(this.b)&&r.c.equals(this.c)}}let WI=0;class as extends hl{constructor(){super(),Object.defineProperty(this,"id",{value:WI++}),this.uuid=ho(),this.name="",this.type="Material",this.fog=!0,this.blending=W,this.side=E,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=K,this.blendDst=Y,this.blendEquation=N,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=vt,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=Sw,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=wa,this.stencilZFail=wa,this.stencilZPass=wa,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.alphaWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(r){this._alphaTest>0!=r>0&&this.version++,this._alphaTest=r}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(r){if(r!==void 0)for(const l in r){const d=r[l];if(d===void 0){console.warn("THREE.Material: '"+l+"' parameter is undefined.");continue}if(l==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=d===D;continue}const v=this[l];if(v===void 0){console.warn("THREE."+this.type+": '"+l+"' is not a property of this material.");continue}v&&v.isColor?v.set(d):v&&v.isVector3&&d&&d.isVector3?v.copy(d):this[l]=d}}toJSON(r){const l=r===void 0||typeof r=="string";l&&(r={textures:{},images:{}});const d={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};d.uuid=this.uuid,d.type=this.type,this.name!==""&&(d.name=this.name),this.color&&this.color.isColor&&(d.color=this.color.getHex()),this.roughness!==void 0&&(d.roughness=this.roughness),this.metalness!==void 0&&(d.metalness=this.metalness),this.sheen!==void 0&&(d.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(d.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(d.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(d.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(d.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(d.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(d.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(d.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(d.shininess=this.shininess),this.clearcoat!==void 0&&(d.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(d.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(d.clearcoatMap=this.clearcoatMap.toJSON(r).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(d.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(r).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(d.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(r).uuid,d.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.map&&this.map.isTexture&&(d.map=this.map.toJSON(r).uuid),this.matcap&&this.matcap.isTexture&&(d.matcap=this.matcap.toJSON(r).uuid),this.alphaMap&&this.alphaMap.isTexture&&(d.alphaMap=this.alphaMap.toJSON(r).uuid),this.lightMap&&this.lightMap.isTexture&&(d.lightMap=this.lightMap.toJSON(r).uuid,d.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(d.aoMap=this.aoMap.toJSON(r).uuid,d.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(d.bumpMap=this.bumpMap.toJSON(r).uuid,d.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(d.normalMap=this.normalMap.toJSON(r).uuid,d.normalMapType=this.normalMapType,d.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(d.displacementMap=this.displacementMap.toJSON(r).uuid,d.displacementScale=this.displacementScale,d.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(d.roughnessMap=this.roughnessMap.toJSON(r).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(d.metalnessMap=this.metalnessMap.toJSON(r).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(d.emissiveMap=this.emissiveMap.toJSON(r).uuid),this.specularMap&&this.specularMap.isTexture&&(d.specularMap=this.specularMap.toJSON(r).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(d.specularIntensityMap=this.specularIntensityMap.toJSON(r).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(d.specularColorMap=this.specularColorMap.toJSON(r).uuid),this.envMap&&this.envMap.isTexture&&(d.envMap=this.envMap.toJSON(r).uuid,this.combine!==void 0&&(d.combine=this.combine)),this.envMapIntensity!==void 0&&(d.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(d.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(d.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(d.gradientMap=this.gradientMap.toJSON(r).uuid),this.transmission!==void 0&&(d.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(d.transmissionMap=this.transmissionMap.toJSON(r).uuid),this.thickness!==void 0&&(d.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(d.thicknessMap=this.thicknessMap.toJSON(r).uuid),this.attenuationDistance!==void 0&&(d.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(d.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(d.size=this.size),this.shadowSide!==null&&(d.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(d.sizeAttenuation=this.sizeAttenuation),this.blending!==W&&(d.blending=this.blending),this.side!==E&&(d.side=this.side),this.vertexColors&&(d.vertexColors=!0),this.opacity<1&&(d.opacity=this.opacity),this.transparent===!0&&(d.transparent=this.transparent),d.depthFunc=this.depthFunc,d.depthTest=this.depthTest,d.depthWrite=this.depthWrite,d.colorWrite=this.colorWrite,d.alphaWrite=this.alphaWrite,d.stencilWrite=this.stencilWrite,d.stencilWriteMask=this.stencilWriteMask,d.stencilFunc=this.stencilFunc,d.stencilRef=this.stencilRef,d.stencilFuncMask=this.stencilFuncMask,d.stencilFail=this.stencilFail,d.stencilZFail=this.stencilZFail,d.stencilZPass=this.stencilZPass,this.rotation&&this.rotation!==0&&(d.rotation=this.rotation),this.polygonOffset===!0&&(d.polygonOffset=!0),this.polygonOffsetFactor!==0&&(d.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(d.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth&&this.linewidth!==1&&(d.linewidth=this.linewidth),this.dashSize!==void 0&&(d.dashSize=this.dashSize),this.gapSize!==void 0&&(d.gapSize=this.gapSize),this.scale!==void 0&&(d.scale=this.scale),this.dithering===!0&&(d.dithering=!0),this.alphaTest>0&&(d.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(d.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(d.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(d.wireframe=this.wireframe),this.wireframeLinewidth>1&&(d.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(d.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(d.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(d.flatShading=this.flatShading),this.visible===!1&&(d.visible=!1),this.toneMapped===!1&&(d.toneMapped=!1),JSON.stringify(this.userData)!=="{}"&&(d.userData=this.userData);function v(w){const C=[];for(const O in w){const z=w[O];delete z.metadata,C.push(z)}return C}if(l){const w=v(r.textures),C=v(r.images);w.length>0&&(d.textures=w),C.length>0&&(d.images=C)}return d}clone(){return new this.constructor().copy(this)}copy(r){this.name=r.name,this.fog=r.fog,this.blending=r.blending,this.side=r.side,this.vertexColors=r.vertexColors,this.opacity=r.opacity,this.transparent=r.transparent,this.blendSrc=r.blendSrc,this.blendDst=r.blendDst,this.blendEquation=r.blendEquation,this.blendSrcAlpha=r.blendSrcAlpha,this.blendDstAlpha=r.blendDstAlpha,this.blendEquationAlpha=r.blendEquationAlpha,this.depthFunc=r.depthFunc,this.depthTest=r.depthTest,this.depthWrite=r.depthWrite,this.stencilWriteMask=r.stencilWriteMask,this.stencilFunc=r.stencilFunc,this.stencilRef=r.stencilRef,this.stencilFuncMask=r.stencilFuncMask,this.stencilFail=r.stencilFail,this.stencilZFail=r.stencilZFail,this.stencilZPass=r.stencilZPass,this.stencilWrite=r.stencilWrite;const l=r.clippingPlanes;let d=null;if(l!==null){const v=l.length;d=new Array(v);for(let w=0;w!==v;++w)d[w]=l[w].clone()}return this.clippingPlanes=d,this.clipIntersection=r.clipIntersection,this.clipShadows=r.clipShadows,this.shadowSide=r.shadowSide,this.colorWrite=r.colorWrite,this.alphaWrite=r.alphaWrite,this.precision=r.precision,this.polygonOffset=r.polygonOffset,this.polygonOffsetFactor=r.polygonOffsetFactor,this.polygonOffsetUnits=r.polygonOffsetUnits,this.dithering=r.dithering,this.alphaTest=r.alphaTest,this.alphaToCoverage=r.alphaToCoverage,this.premultipliedAlpha=r.premultipliedAlpha,this.visible=r.visible,this.toneMapped=r.toneMapped,this.userData=JSON.parse(JSON.stringify(r.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(r){r===!0&&this.version++}}as.prototype.isMaterial=!0;class vl extends as{constructor(r){super(),this.type="MeshBasicMaterial",this.color=new Un(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Je,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.specularMap=r.specularMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.combine=r.combine,this.reflectivity=r.reflectivity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this}}vl.prototype.isMeshBasicMaterial=!0;const gr=new qe,s0=new pn;class Wi{constructor(r,l,d){if(Array.isArray(r))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=r,this.itemSize=l,this.count=r!==void 0?r.length/l:0,this.normalized=d===!0,this.usage=Dh,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(r){r===!0&&this.version++}setUsage(r){return this.usage=r,this}copy(r){return this.name=r.name,this.array=new r.array.constructor(r.array),this.itemSize=r.itemSize,this.count=r.count,this.normalized=r.normalized,this.usage=r.usage,this}copyAt(r,l,d){r*=this.itemSize,d*=l.itemSize;for(let v=0,w=this.itemSize;v<w;v++)this.array[r+v]=l.array[d+v];return this}copyArray(r){return this.array.set(r),this}copyColorsArray(r){const l=this.array;let d=0;for(let v=0,w=r.length;v<w;v++){let C=r[v];C===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",v),C=new Un),l[d++]=C.r,l[d++]=C.g,l[d++]=C.b}return this}copyVector2sArray(r){const l=this.array;let d=0;for(let v=0,w=r.length;v<w;v++){let C=r[v];C===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",v),C=new pn),l[d++]=C.x,l[d++]=C.y}return this}copyVector3sArray(r){const l=this.array;let d=0;for(let v=0,w=r.length;v<w;v++){let C=r[v];C===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",v),C=new qe),l[d++]=C.x,l[d++]=C.y,l[d++]=C.z}return this}copyVector4sArray(r){const l=this.array;let d=0;for(let v=0,w=r.length;v<w;v++){let C=r[v];C===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",v),C=new nr),l[d++]=C.x,l[d++]=C.y,l[d++]=C.z,l[d++]=C.w}return this}applyMatrix3(r){if(this.itemSize===2)for(let l=0,d=this.count;l<d;l++)s0.fromBufferAttribute(this,l),s0.applyMatrix3(r),this.setXY(l,s0.x,s0.y);else if(this.itemSize===3)for(let l=0,d=this.count;l<d;l++)gr.fromBufferAttribute(this,l),gr.applyMatrix3(r),this.setXYZ(l,gr.x,gr.y,gr.z);return this}applyMatrix4(r){for(let l=0,d=this.count;l<d;l++)gr.x=this.getX(l),gr.y=this.getY(l),gr.z=this.getZ(l),gr.applyMatrix4(r),this.setXYZ(l,gr.x,gr.y,gr.z);return this}applyNormalMatrix(r){for(let l=0,d=this.count;l<d;l++)gr.x=this.getX(l),gr.y=this.getY(l),gr.z=this.getZ(l),gr.applyNormalMatrix(r),this.setXYZ(l,gr.x,gr.y,gr.z);return this}transformDirection(r){for(let l=0,d=this.count;l<d;l++)gr.x=this.getX(l),gr.y=this.getY(l),gr.z=this.getZ(l),gr.transformDirection(r),this.setXYZ(l,gr.x,gr.y,gr.z);return this}set(r,l=0){return this.array.set(r,l),this}getX(r){return this.array[r*this.itemSize]}setX(r,l){return this.array[r*this.itemSize]=l,this}getY(r){return this.array[r*this.itemSize+1]}setY(r,l){return this.array[r*this.itemSize+1]=l,this}getZ(r){return this.array[r*this.itemSize+2]}setZ(r,l){return this.array[r*this.itemSize+2]=l,this}getW(r){return this.array[r*this.itemSize+3]}setW(r,l){return this.array[r*this.itemSize+3]=l,this}setXY(r,l,d){return r*=this.itemSize,this.array[r+0]=l,this.array[r+1]=d,this}setXYZ(r,l,d,v){return r*=this.itemSize,this.array[r+0]=l,this.array[r+1]=d,this.array[r+2]=v,this}setXYZW(r,l,d,v,w){return r*=this.itemSize,this.array[r+0]=l,this.array[r+1]=d,this.array[r+2]=v,this.array[r+3]=w,this}onUpload(r){return this.onUploadCallback=r,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const r={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return this.name!==""&&(r.name=this.name),this.usage!==Dh&&(r.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(r.updateRange=this.updateRange),r}}Wi.prototype.isBufferAttribute=!0;class Vw extends Wi{constructor(r,l,d){super(new Int8Array(r),l,d)}}class Ww extends Wi{constructor(r,l,d){super(new Uint8Array(r),l,d)}}class jw extends Wi{constructor(r,l,d){super(new Uint8ClampedArray(r),l,d)}}class Xw extends Wi{constructor(r,l,d){super(new Int16Array(r),l,d)}}class o0 extends Wi{constructor(r,l,d){super(new Uint16Array(r),l,d)}}class $w extends Wi{constructor(r,l,d){super(new Int32Array(r),l,d)}}class a0 extends Wi{constructor(r,l,d){super(new Uint32Array(r),l,d)}}class qw extends Wi{constructor(r,l,d){super(new Uint16Array(r),l,d)}}qw.prototype.isFloat16BufferAttribute=!0;class ei extends Wi{constructor(r,l,d){super(new Float32Array(r),l,d)}}class Yw extends Wi{constructor(r,l,d){super(new Float64Array(r),l,d)}}let jI=0;const Do=new Jn,A1=new ki,Xh=new qe,go=new po,ip=new po,ls=new qe;class ui extends hl{constructor(){super(),Object.defineProperty(this,"id",{value:jI++}),this.uuid=ho(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(r){return Array.isArray(r)?this.index=new(Lw(r)?a0:o0)(r,1):this.index=r,this}getAttribute(r){return this.attributes[r]}setAttribute(r,l){return this.attributes[r]=l,this}deleteAttribute(r){return delete this.attributes[r],this}hasAttribute(r){return this.attributes[r]!==void 0}addGroup(r,l,d=0){this.groups.push({start:r,count:l,materialIndex:d})}clearGroups(){this.groups=[]}setDrawRange(r,l){this.drawRange.start=r,this.drawRange.count=l}applyMatrix4(r){const l=this.attributes.position;l!==void 0&&(l.applyMatrix4(r),l.needsUpdate=!0);const d=this.attributes.normal;if(d!==void 0){const w=new es().getNormalMatrix(r);d.applyNormalMatrix(w),d.needsUpdate=!0}const v=this.attributes.tangent;return v!==void 0&&(v.transformDirection(r),v.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(r){return Do.makeRotationFromQuaternion(r),this.applyMatrix4(Do),this}rotateX(r){return Do.makeRotationX(r),this.applyMatrix4(Do),this}rotateY(r){return Do.makeRotationY(r),this.applyMatrix4(Do),this}rotateZ(r){return Do.makeRotationZ(r),this.applyMatrix4(Do),this}translate(r,l,d){return Do.makeTranslation(r,l,d),this.applyMatrix4(Do),this}scale(r,l,d){return Do.makeScale(r,l,d),this.applyMatrix4(Do),this}lookAt(r){return A1.lookAt(r),A1.updateMatrix(),this.applyMatrix4(A1.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Xh).negate(),this.translate(Xh.x,Xh.y,Xh.z),this}setFromPoints(r){const l=[];for(let d=0,v=r.length;d<v;d++){const w=r[d];l.push(w.x,w.y,w.z||0)}return this.setAttribute("position",new ei(l,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new po);const r=this.attributes.position,l=this.morphAttributes.position;if(r&&r.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new qe(-1/0,-1/0,-1/0),new qe(1/0,1/0,1/0));return}if(r!==void 0){if(this.boundingBox.setFromBufferAttribute(r),l)for(let d=0,v=l.length;d<v;d++){const w=l[d];go.setFromBufferAttribute(w),this.morphTargetsRelative?(ls.addVectors(this.boundingBox.min,go.min),this.boundingBox.expandByPoint(ls),ls.addVectors(this.boundingBox.max,go.max),this.boundingBox.expandByPoint(ls)):(this.boundingBox.expandByPoint(go.min),this.boundingBox.expandByPoint(go.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Kl);const r=this.attributes.position,l=this.morphAttributes.position;if(r&&r.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new qe,1/0);return}if(r){const d=this.boundingSphere.center;if(go.setFromBufferAttribute(r),l)for(let w=0,C=l.length;w<C;w++){const O=l[w];ip.setFromBufferAttribute(O),this.morphTargetsRelative?(ls.addVectors(go.min,ip.min),go.expandByPoint(ls),ls.addVectors(go.max,ip.max),go.expandByPoint(ls)):(go.expandByPoint(ip.min),go.expandByPoint(ip.max))}go.getCenter(d);let v=0;for(let w=0,C=r.count;w<C;w++)ls.fromBufferAttribute(r,w),v=Math.max(v,d.distanceToSquared(ls));if(l)for(let w=0,C=l.length;w<C;w++){const O=l[w],z=this.morphTargetsRelative;for(let H=0,ne=O.count;H<ne;H++)ls.fromBufferAttribute(O,H),z&&(Xh.fromBufferAttribute(r,H),ls.add(Xh)),v=Math.max(v,d.distanceToSquared(ls))}this.boundingSphere.radius=Math.sqrt(v),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const r=this.index,l=this.attributes;if(r===null||l.position===void 0||l.normal===void 0||l.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const d=r.array,v=l.position.array,w=l.normal.array,C=l.uv.array,O=v.length/3;l.tangent===void 0&&this.setAttribute("tangent",new Wi(new Float32Array(4*O),4));const z=l.tangent.array,H=[],ne=[];for(let Ht=0;Ht<O;Ht++)H[Ht]=new qe,ne[Ht]=new qe;const re=new qe,se=new qe,oe=new qe,ve=new pn,Te=new pn,Fe=new pn,Ae=new qe,ue=new qe;function Ve(Ht,Ne,ct){re.fromArray(v,Ht*3),se.fromArray(v,Ne*3),oe.fromArray(v,ct*3),ve.fromArray(C,Ht*2),Te.fromArray(C,Ne*2),Fe.fromArray(C,ct*2),se.sub(re),oe.sub(re),Te.sub(ve),Fe.sub(ve);const It=1/(Te.x*Fe.y-Fe.x*Te.y);!isFinite(It)||(Ae.copy(se).multiplyScalar(Fe.y).addScaledVector(oe,-Te.y).multiplyScalar(It),ue.copy(oe).multiplyScalar(Te.x).addScaledVector(se,-Fe.x).multiplyScalar(It),H[Ht].add(Ae),H[Ne].add(Ae),H[ct].add(Ae),ne[Ht].add(ue),ne[Ne].add(ue),ne[ct].add(ue))}let ke=this.groups;ke.length===0&&(ke=[{start:0,count:d.length}]);for(let Ht=0,Ne=ke.length;Ht<Ne;++Ht){const ct=ke[Ht],It=ct.start,Nt=ct.count;for(let Pt=It,Gt=It+Nt;Pt<Gt;Pt+=3)Ve(d[Pt+0],d[Pt+1],d[Pt+2])}const je=new qe,st=new qe,At=new qe,Et=new qe;function Xt(Ht){At.fromArray(w,Ht*3),Et.copy(At);const Ne=H[Ht];je.copy(Ne),je.sub(At.multiplyScalar(At.dot(Ne))).normalize(),st.crossVectors(Et,Ne);const It=st.dot(ne[Ht])<0?-1:1;z[Ht*4]=je.x,z[Ht*4+1]=je.y,z[Ht*4+2]=je.z,z[Ht*4+3]=It}for(let Ht=0,Ne=ke.length;Ht<Ne;++Ht){const ct=ke[Ht],It=ct.start,Nt=ct.count;for(let Pt=It,Gt=It+Nt;Pt<Gt;Pt+=3)Xt(d[Pt+0]),Xt(d[Pt+1]),Xt(d[Pt+2])}}computeVertexNormals(){const r=this.index,l=this.getAttribute("position");if(l!==void 0){let d=this.getAttribute("normal");if(d===void 0)d=new Wi(new Float32Array(l.count*3),3),this.setAttribute("normal",d);else for(let se=0,oe=d.count;se<oe;se++)d.setXYZ(se,0,0,0);const v=new qe,w=new qe,C=new qe,O=new qe,z=new qe,H=new qe,ne=new qe,re=new qe;if(r)for(let se=0,oe=r.count;se<oe;se+=3){const ve=r.getX(se+0),Te=r.getX(se+1),Fe=r.getX(se+2);v.fromBufferAttribute(l,ve),w.fromBufferAttribute(l,Te),C.fromBufferAttribute(l,Fe),ne.subVectors(C,w),re.subVectors(v,w),ne.cross(re),O.fromBufferAttribute(d,ve),z.fromBufferAttribute(d,Te),H.fromBufferAttribute(d,Fe),O.add(ne),z.add(ne),H.add(ne),d.setXYZ(ve,O.x,O.y,O.z),d.setXYZ(Te,z.x,z.y,z.z),d.setXYZ(Fe,H.x,H.y,H.z)}else for(let se=0,oe=l.count;se<oe;se+=3)v.fromBufferAttribute(l,se+0),w.fromBufferAttribute(l,se+1),C.fromBufferAttribute(l,se+2),ne.subVectors(C,w),re.subVectors(v,w),ne.cross(re),d.setXYZ(se+0,ne.x,ne.y,ne.z),d.setXYZ(se+1,ne.x,ne.y,ne.z),d.setXYZ(se+2,ne.x,ne.y,ne.z);this.normalizeNormals(),d.needsUpdate=!0}}merge(r,l){if(!(r&&r.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",r);return}l===void 0&&(l=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const d=this.attributes;for(const v in d){if(r.attributes[v]===void 0)continue;const C=d[v].array,O=r.attributes[v],z=O.array,H=O.itemSize*l,ne=Math.min(z.length,C.length-H);for(let re=0,se=H;re<ne;re++,se++)C[se]=z[re]}return this}normalizeNormals(){const r=this.attributes.normal;for(let l=0,d=r.count;l<d;l++)ls.fromBufferAttribute(r,l),ls.normalize(),r.setXYZ(l,ls.x,ls.y,ls.z)}toNonIndexed(){function r(O,z){const H=O.array,ne=O.itemSize,re=O.normalized,se=new H.constructor(z.length*ne);let oe=0,ve=0;for(let Te=0,Fe=z.length;Te<Fe;Te++){O.isInterleavedBufferAttribute?oe=z[Te]*O.data.stride+O.offset:oe=z[Te]*ne;for(let Ae=0;Ae<ne;Ae++)se[ve++]=H[oe++]}return new Wi(se,ne,re)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const l=new ui,d=this.index.array,v=this.attributes;for(const O in v){const z=v[O],H=r(z,d);l.setAttribute(O,H)}const w=this.morphAttributes;for(const O in w){const z=[],H=w[O];for(let ne=0,re=H.length;ne<re;ne++){const se=H[ne],oe=r(se,d);z.push(oe)}l.morphAttributes[O]=z}l.morphTargetsRelative=this.morphTargetsRelative;const C=this.groups;for(let O=0,z=C.length;O<z;O++){const H=C[O];l.addGroup(H.start,H.count,H.materialIndex)}return l}toJSON(){const r={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(r.uuid=this.uuid,r.type=this.type,this.name!==""&&(r.name=this.name),Object.keys(this.userData).length>0&&(r.userData=this.userData),this.parameters!==void 0){const z=this.parameters;for(const H in z)z[H]!==void 0&&(r[H]=z[H]);return r}r.data={attributes:{}};const l=this.index;l!==null&&(r.data.index={type:l.array.constructor.name,array:Array.prototype.slice.call(l.array)});const d=this.attributes;for(const z in d){const H=d[z];r.data.attributes[z]=H.toJSON(r.data)}const v={};let w=!1;for(const z in this.morphAttributes){const H=this.morphAttributes[z],ne=[];for(let re=0,se=H.length;re<se;re++){const oe=H[re];ne.push(oe.toJSON(r.data))}ne.length>0&&(v[z]=ne,w=!0)}w&&(r.data.morphAttributes=v,r.data.morphTargetsRelative=this.morphTargetsRelative);const C=this.groups;C.length>0&&(r.data.groups=JSON.parse(JSON.stringify(C)));const O=this.boundingSphere;return O!==null&&(r.data.boundingSphere={center:O.center.toArray(),radius:O.radius}),r}clone(){return new this.constructor().copy(this)}copy(r){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const l={};this.name=r.name;const d=r.index;d!==null&&this.setIndex(d.clone(l));const v=r.attributes;for(const H in v){const ne=v[H];this.setAttribute(H,ne.clone(l))}const w=r.morphAttributes;for(const H in w){const ne=[],re=w[H];for(let se=0,oe=re.length;se<oe;se++)ne.push(re[se].clone(l));this.morphAttributes[H]=ne}this.morphTargetsRelative=r.morphTargetsRelative;const C=r.groups;for(let H=0,ne=C.length;H<ne;H++){const re=C[H];this.addGroup(re.start,re.count,re.materialIndex)}const O=r.boundingBox;O!==null&&(this.boundingBox=O.clone());const z=r.boundingSphere;return z!==null&&(this.boundingSphere=z.clone()),this.drawRange.start=r.drawRange.start,this.drawRange.count=r.drawRange.count,this.userData=r.userData,r.parameters!==void 0&&(this.parameters=Object.assign({},r.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}ui.prototype.isBufferGeometry=!0;const Qw=new Jn,$h=new Jl,b1=new Kl,tc=new qe,nc=new qe,ic=new qe,_1=new qe,w1=new qe,E1=new qe,l0=new qe,c0=new qe,u0=new qe,h0=new pn,f0=new pn,d0=new pn,M1=new qe,p0=new qe;class $r extends ki{constructor(r=new ui,l=new vl){super(),this.type="Mesh",this.geometry=r,this.material=l,this.updateMorphTargets()}copy(r){return super.copy(r),r.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=r.morphTargetInfluences.slice()),r.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},r.morphTargetDictionary)),this.material=r.material,this.geometry=r.geometry,this}updateMorphTargets(){const r=this.geometry;if(r.isBufferGeometry){const l=r.morphAttributes,d=Object.keys(l);if(d.length>0){const v=l[d[0]];if(v!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let w=0,C=v.length;w<C;w++){const O=v[w].name||String(w);this.morphTargetInfluences.push(0),this.morphTargetDictionary[O]=w}}}}else{const l=r.morphTargets;l!==void 0&&l.length>0&&console.error("THREE.Mesh.updateMorphTargets() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}raycast(r,l){const d=this.geometry,v=this.material,w=this.matrixWorld;if(v===void 0||(d.boundingSphere===null&&d.computeBoundingSphere(),b1.copy(d.boundingSphere),b1.applyMatrix4(w),r.ray.intersectsSphere(b1)===!1)||(Qw.copy(w).invert(),$h.copy(r.ray).applyMatrix4(Qw),d.boundingBox!==null&&$h.intersectsBox(d.boundingBox)===!1))return;let C;if(d.isBufferGeometry){const O=d.index,z=d.attributes.position,H=d.morphAttributes.position,ne=d.morphTargetsRelative,re=d.attributes.uv,se=d.attributes.uv2,oe=d.groups,ve=d.drawRange;if(O!==null)if(Array.isArray(v))for(let Te=0,Fe=oe.length;Te<Fe;Te++){const Ae=oe[Te],ue=v[Ae.materialIndex],Ve=Math.max(Ae.start,ve.start),ke=Math.min(O.count,Math.min(Ae.start+Ae.count,ve.start+ve.count));for(let je=Ve,st=ke;je<st;je+=3){const At=O.getX(je),Et=O.getX(je+1),Xt=O.getX(je+2);C=m0(this,ue,r,$h,z,H,ne,re,se,At,Et,Xt),C&&(C.faceIndex=Math.floor(je/3),C.face.materialIndex=Ae.materialIndex,l.push(C))}}else{const Te=Math.max(0,ve.start),Fe=Math.min(O.count,ve.start+ve.count);for(let Ae=Te,ue=Fe;Ae<ue;Ae+=3){const Ve=O.getX(Ae),ke=O.getX(Ae+1),je=O.getX(Ae+2);C=m0(this,v,r,$h,z,H,ne,re,se,Ve,ke,je),C&&(C.faceIndex=Math.floor(Ae/3),l.push(C))}}else if(z!==void 0)if(Array.isArray(v))for(let Te=0,Fe=oe.length;Te<Fe;Te++){const Ae=oe[Te],ue=v[Ae.materialIndex],Ve=Math.max(Ae.start,ve.start),ke=Math.min(z.count,Math.min(Ae.start+Ae.count,ve.start+ve.count));for(let je=Ve,st=ke;je<st;je+=3){const At=je,Et=je+1,Xt=je+2;C=m0(this,ue,r,$h,z,H,ne,re,se,At,Et,Xt),C&&(C.faceIndex=Math.floor(je/3),C.face.materialIndex=Ae.materialIndex,l.push(C))}}else{const Te=Math.max(0,ve.start),Fe=Math.min(z.count,ve.start+ve.count);for(let Ae=Te,ue=Fe;Ae<ue;Ae+=3){const Ve=Ae,ke=Ae+1,je=Ae+2;C=m0(this,v,r,$h,z,H,ne,re,se,Ve,ke,je),C&&(C.faceIndex=Math.floor(Ae/3),l.push(C))}}}else d.isGeometry&&console.error("THREE.Mesh.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}}$r.prototype.isMesh=!0;function XI(A,r,l,d,v,w,C,O){let z;if(r.side===T?z=d.intersectTriangle(C,w,v,!0,O):z=d.intersectTriangle(v,w,C,r.side!==P,O),z===null)return null;p0.copy(O),p0.applyMatrix4(A.matrixWorld);const H=l.ray.origin.distanceTo(p0);return H<l.near||H>l.far?null:{distance:H,point:p0.clone(),object:A}}function m0(A,r,l,d,v,w,C,O,z,H,ne,re){tc.fromBufferAttribute(v,H),nc.fromBufferAttribute(v,ne),ic.fromBufferAttribute(v,re);const se=A.morphTargetInfluences;if(w&&se){l0.set(0,0,0),c0.set(0,0,0),u0.set(0,0,0);for(let ve=0,Te=w.length;ve<Te;ve++){const Fe=se[ve],Ae=w[ve];Fe!==0&&(_1.fromBufferAttribute(Ae,H),w1.fromBufferAttribute(Ae,ne),E1.fromBufferAttribute(Ae,re),C?(l0.addScaledVector(_1,Fe),c0.addScaledVector(w1,Fe),u0.addScaledVector(E1,Fe)):(l0.addScaledVector(_1.sub(tc),Fe),c0.addScaledVector(w1.sub(nc),Fe),u0.addScaledVector(E1.sub(ic),Fe)))}tc.add(l0),nc.add(c0),ic.add(u0)}A.isSkinnedMesh&&(A.boneTransform(H,tc),A.boneTransform(ne,nc),A.boneTransform(re,ic));const oe=XI(A,r,l,d,tc,nc,ic,M1);if(oe){O&&(h0.fromBufferAttribute(O,H),f0.fromBufferAttribute(O,ne),d0.fromBufferAttribute(O,re),oe.uv=Ur.getUV(M1,tc,nc,ic,h0,f0,d0,new pn)),z&&(h0.fromBufferAttribute(z,H),f0.fromBufferAttribute(z,ne),d0.fromBufferAttribute(z,re),oe.uv2=Ur.getUV(M1,tc,nc,ic,h0,f0,d0,new pn));const ve={a:H,b:ne,c:re,normal:new qe,materialIndex:0};Ur.getNormal(tc,nc,ic,ve.normal),oe.face=ve}return oe}class yl extends ui{constructor(r=1,l=1,d=1,v=1,w=1,C=1){super(),this.type="BoxGeometry",this.parameters={width:r,height:l,depth:d,widthSegments:v,heightSegments:w,depthSegments:C};const O=this;v=Math.floor(v),w=Math.floor(w),C=Math.floor(C);const z=[],H=[],ne=[],re=[];let se=0,oe=0;ve("z","y","x",-1,-1,d,l,r,C,w,0),ve("z","y","x",1,-1,d,l,-r,C,w,1),ve("x","z","y",1,1,r,d,l,v,C,2),ve("x","z","y",1,-1,r,d,-l,v,C,3),ve("x","y","z",1,-1,r,l,d,v,w,4),ve("x","y","z",-1,-1,r,l,-d,v,w,5),this.setIndex(z),this.setAttribute("position",new ei(H,3)),this.setAttribute("normal",new ei(ne,3)),this.setAttribute("uv",new ei(re,2));function ve(Te,Fe,Ae,ue,Ve,ke,je,st,At,Et,Xt){const Ht=ke/At,Ne=je/Et,ct=ke/2,It=je/2,Nt=st/2,Pt=At+1,Gt=Et+1;let sn=0,bn=0;const kn=new qe;for(let si=0;si<Gt;si++){const Vn=si*Ne-It;for(let fn=0;fn<Pt;fn++){const Pn=fn*Ht-ct;kn[Te]=Pn*ue,kn[Fe]=Vn*Ve,kn[Ae]=Nt,H.push(kn.x,kn.y,kn.z),kn[Te]=0,kn[Fe]=0,kn[Ae]=st>0?1:-1,ne.push(kn.x,kn.y,kn.z),re.push(fn/At),re.push(1-si/Et),sn+=1}}for(let si=0;si<Et;si++)for(let Vn=0;Vn<At;Vn++){const fn=se+Vn+Pt*si,Pn=se+Vn+Pt*(si+1),li=se+(Vn+1)+Pt*(si+1),Mt=se+(Vn+1)+Pt*si;z.push(fn,Pn,Mt),z.push(Pn,li,Mt),bn+=6}O.addGroup(oe,bn,Xt),oe+=bn,se+=sn}}static fromJSON(r){return new yl(r.width,r.height,r.depth,r.widthSegments,r.heightSegments,r.depthSegments)}}function qh(A){const r={};for(const l in A){r[l]={};for(const d in A[l]){const v=A[l][d];v&&(v.isColor||v.isMatrix3||v.isMatrix4||v.isVector2||v.isVector3||v.isVector4||v.isTexture||v.isQuaternion)?r[l][d]=v.clone():Array.isArray(v)?r[l][d]=v.slice():r[l][d]=v}}return r}function Ps(A){const r={};for(let l=0;l<A.length;l++){const d=qh(A[l]);for(const v in d)r[v]=d[v]}return r}const Kw={clone:qh,merge:Ps};var $I=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,qI=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class xl extends as{constructor(r){super(),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=$I,this.fragmentShader=qI,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,r!==void 0&&(r.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(r))}copy(r){return super.copy(r),this.fragmentShader=r.fragmentShader,this.vertexShader=r.vertexShader,this.uniforms=qh(r.uniforms),this.defines=Object.assign({},r.defines),this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.lights=r.lights,this.clipping=r.clipping,this.extensions=Object.assign({},r.extensions),this.glslVersion=r.glslVersion,this}toJSON(r){const l=super.toJSON(r);l.glslVersion=this.glslVersion,l.uniforms={};for(const v in this.uniforms){const C=this.uniforms[v].value;C&&C.isTexture?l.uniforms[v]={type:"t",value:C.toJSON(r).uuid}:C&&C.isColor?l.uniforms[v]={type:"c",value:C.getHex()}:C&&C.isVector2?l.uniforms[v]={type:"v2",value:C.toArray()}:C&&C.isVector3?l.uniforms[v]={type:"v3",value:C.toArray()}:C&&C.isVector4?l.uniforms[v]={type:"v4",value:C.toArray()}:C&&C.isMatrix3?l.uniforms[v]={type:"m3",value:C.toArray()}:C&&C.isMatrix4?l.uniforms[v]={type:"m4",value:C.toArray()}:l.uniforms[v]={value:C}}Object.keys(this.defines).length>0&&(l.defines=this.defines),l.vertexShader=this.vertexShader,l.fragmentShader=this.fragmentShader;const d={};for(const v in this.extensions)this.extensions[v]===!0&&(d[v]=!0);return Object.keys(d).length>0&&(l.extensions=d),l}}xl.prototype.isShaderMaterial=!0;class rp extends ki{constructor(){super(),this.type="Camera",this.matrixWorldInverse=new Jn,this.projectionMatrix=new Jn,this.projectionMatrixInverse=new Jn}copy(r,l){return super.copy(r,l),this.matrixWorldInverse.copy(r.matrixWorldInverse),this.projectionMatrix.copy(r.projectionMatrix),this.projectionMatrixInverse.copy(r.projectionMatrixInverse),this}getWorldDirection(r){this.updateWorldMatrix(!0,!1);const l=this.matrixWorld.elements;return r.set(-l[8],-l[9],-l[10]).normalize()}updateMatrixWorld(r){super.updateMatrixWorld(r),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(r,l){super.updateWorldMatrix(r,l),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}rp.prototype.isCamera=!0;class qr extends rp{constructor(r=50,l=1,d=.1,v=2e3){super(),this.type="PerspectiveCamera",this.fov=r,this.zoom=1,this.near=d,this.far=v,this.focus=10,this.aspect=l,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(r,l){return super.copy(r,l),this.fov=r.fov,this.zoom=r.zoom,this.near=r.near,this.far=r.far,this.focus=r.focus,this.aspect=r.aspect,this.view=r.view===null?null:Object.assign({},r.view),this.filmGauge=r.filmGauge,this.filmOffset=r.filmOffset,this}setFocalLength(r){const l=.5*this.getFilmHeight()/r;this.fov=Zd*2*Math.atan(l),this.updateProjectionMatrix()}getFocalLength(){const r=Math.tan(lu*.5*this.fov);return .5*this.getFilmHeight()/r}getEffectiveFOV(){return Zd*2*Math.atan(Math.tan(lu*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(r,l,d,v,w,C){this.aspect=r/l,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=r,this.view.fullHeight=l,this.view.offsetX=d,this.view.offsetY=v,this.view.width=w,this.view.height=C,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const r=this.near;let l=r*Math.tan(lu*.5*this.fov)/this.zoom,d=2*l,v=this.aspect*d,w=-.5*v;const C=this.view;if(this.view!==null&&this.view.enabled){const z=C.fullWidth,H=C.fullHeight;w+=C.offsetX*v/z,l-=C.offsetY*d/H,v*=C.width/z,d*=C.height/H}const O=this.filmOffset;O!==0&&(w+=r*O/this.getFilmWidth()),this.projectionMatrix.makePerspective(w,w+v,l,l-d,r,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(r){const l=super.toJSON(r);return l.object.fov=this.fov,l.object.zoom=this.zoom,l.object.near=this.near,l.object.far=this.far,l.object.focus=this.focus,l.object.aspect=this.aspect,this.view!==null&&(l.object.view=Object.assign({},this.view)),l.object.filmGauge=this.filmGauge,l.object.filmOffset=this.filmOffset,l}}qr.prototype.isPerspectiveCamera=!0;const Yh=90,Qh=1;class g0 extends ki{constructor(r,l,d){if(super(),this.type="CubeCamera",d.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=d;const v=new qr(Yh,Qh,r,l);v.layers=this.layers,v.up.set(0,-1,0),v.lookAt(new qe(1,0,0)),this.add(v);const w=new qr(Yh,Qh,r,l);w.layers=this.layers,w.up.set(0,-1,0),w.lookAt(new qe(-1,0,0)),this.add(w);const C=new qr(Yh,Qh,r,l);C.layers=this.layers,C.up.set(0,0,1),C.lookAt(new qe(0,1,0)),this.add(C);const O=new qr(Yh,Qh,r,l);O.layers=this.layers,O.up.set(0,0,-1),O.lookAt(new qe(0,-1,0)),this.add(O);const z=new qr(Yh,Qh,r,l);z.layers=this.layers,z.up.set(0,-1,0),z.lookAt(new qe(0,0,1)),this.add(z);const H=new qr(Yh,Qh,r,l);H.layers=this.layers,H.up.set(0,-1,0),H.lookAt(new qe(0,0,-1)),this.add(H)}update(r,l){this.parent===null&&this.updateMatrixWorld();const d=this.renderTarget,[v,w,C,O,z,H]=this.children,ne=r.xr.enabled,re=r.getRenderTarget();r.xr.enabled=!1;const se=d.texture.generateMipmaps;d.texture.generateMipmaps=!1,r.setRenderTarget(d,0),r.render(l,v),r.setRenderTarget(d,1),r.render(l,w),r.setRenderTarget(d,2),r.render(l,C),r.setRenderTarget(d,3),r.render(l,O),r.setRenderTarget(d,4),r.render(l,z),d.texture.generateMipmaps=se,r.setRenderTarget(d,5),r.render(l,H),r.setRenderTarget(re),r.xr.enabled=ne,d.texture.needsPMREMUpdate=!0}}class Kh extends Xr{constructor(r,l,d,v,w,C,O,z,H,ne){r=r!==void 0?r:[],l=l!==void 0?l:Z,super(r,l,d,v,w,C,O,z,H,ne),this.flipY=!1}get images(){return this.image}set images(r){this.image=r}}Kh.prototype.isCubeTexture=!0;class v0 extends fo{constructor(r,l,d){Number.isInteger(l)&&(console.warn("THREE.WebGLCubeRenderTarget: constructor signature is now WebGLCubeRenderTarget( size, options )"),l=d),super(r,r,l),l=l||{},this.texture=new Kh(void 0,l.mapping,l.wrapS,l.wrapT,l.magFilter,l.minFilter,l.format,l.type,l.anisotropy,l.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=l.generateMipmaps!==void 0?l.generateMipmaps:!1,this.texture.minFilter=l.minFilter!==void 0?l.minFilter:ut}fromEquirectangularTexture(r,l){this.texture.type=l.type,this.texture.format=Se,this.texture.encoding=l.encoding,this.texture.generateMipmaps=l.generateMipmaps,this.texture.minFilter=l.minFilter,this.texture.magFilter=l.magFilter;const d={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},v=new yl(5,5,5),w=new xl({name:"CubemapFromEquirect",uniforms:qh(d.uniforms),vertexShader:d.vertexShader,fragmentShader:d.fragmentShader,side:T,blending:k});w.uniforms.tEquirect.value=l;const C=new $r(v,w),O=l.minFilter;return l.minFilter===gn&&(l.minFilter=ut),new g0(1,10,this).update(r,C),l.minFilter=O,C.geometry.dispose(),C.material.dispose(),this}clear(r,l,d,v){const w=r.getRenderTarget();for(let C=0;C<6;C++)r.setRenderTarget(this,C),r.clear(l,d,v);r.setRenderTarget(w)}}v0.prototype.isWebGLCubeRenderTarget=!0;const S1=new qe,YI=new qe,QI=new es;class Ea{constructor(r=new qe(1,0,0),l=0){this.normal=r,this.constant=l}set(r,l){return this.normal.copy(r),this.constant=l,this}setComponents(r,l,d,v){return this.normal.set(r,l,d),this.constant=v,this}setFromNormalAndCoplanarPoint(r,l){return this.normal.copy(r),this.constant=-l.dot(this.normal),this}setFromCoplanarPoints(r,l,d){const v=S1.subVectors(d,l).cross(YI.subVectors(r,l)).normalize();return this.setFromNormalAndCoplanarPoint(v,r),this}copy(r){return this.normal.copy(r.normal),this.constant=r.constant,this}normalize(){const r=1/this.normal.length();return this.normal.multiplyScalar(r),this.constant*=r,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(r){return this.normal.dot(r)+this.constant}distanceToSphere(r){return this.distanceToPoint(r.center)-r.radius}projectPoint(r,l){return l.copy(this.normal).multiplyScalar(-this.distanceToPoint(r)).add(r)}intersectLine(r,l){const d=r.delta(S1),v=this.normal.dot(d);if(v===0)return this.distanceToPoint(r.start)===0?l.copy(r.start):null;const w=-(r.start.dot(this.normal)+this.constant)/v;return w<0||w>1?null:l.copy(d).multiplyScalar(w).add(r.start)}intersectsLine(r){const l=this.distanceToPoint(r.start),d=this.distanceToPoint(r.end);return l<0&&d>0||d<0&&l>0}intersectsBox(r){return r.intersectsPlane(this)}intersectsSphere(r){return r.intersectsPlane(this)}coplanarPoint(r){return r.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(r,l){const d=l||QI.getNormalMatrix(r),v=this.coplanarPoint(S1).applyMatrix4(r),w=this.normal.applyMatrix3(d).normalize();return this.constant=-v.dot(w),this}translate(r){return this.constant-=r.dot(this.normal),this}equals(r){return r.normal.equals(this.normal)&&r.constant===this.constant}clone(){return new this.constructor().copy(this)}}Ea.prototype.isPlane=!0;const Zh=new Kl,y0=new qe;class sp{constructor(r=new Ea,l=new Ea,d=new Ea,v=new Ea,w=new Ea,C=new Ea){this.planes=[r,l,d,v,w,C]}set(r,l,d,v,w,C){const O=this.planes;return O[0].copy(r),O[1].copy(l),O[2].copy(d),O[3].copy(v),O[4].copy(w),O[5].copy(C),this}copy(r){const l=this.planes;for(let d=0;d<6;d++)l[d].copy(r.planes[d]);return this}setFromProjectionMatrix(r){const l=this.planes,d=r.elements,v=d[0],w=d[1],C=d[2],O=d[3],z=d[4],H=d[5],ne=d[6],re=d[7],se=d[8],oe=d[9],ve=d[10],Te=d[11],Fe=d[12],Ae=d[13],ue=d[14],Ve=d[15];return l[0].setComponents(O-v,re-z,Te-se,Ve-Fe).normalize(),l[1].setComponents(O+v,re+z,Te+se,Ve+Fe).normalize(),l[2].setComponents(O+w,re+H,Te+oe,Ve+Ae).normalize(),l[3].setComponents(O-w,re-H,Te-oe,Ve-Ae).normalize(),l[4].setComponents(O-C,re-ne,Te-ve,Ve-ue).normalize(),l[5].setComponents(O+C,re+ne,Te+ve,Ve+ue).normalize(),this}intersectsObject(r){const l=r.geometry;return l.boundingSphere===null&&l.computeBoundingSphere(),Zh.copy(l.boundingSphere).applyMatrix4(r.matrixWorld),this.intersectsSphere(Zh)}intersectsSprite(r){return Zh.center.set(0,0,0),Zh.radius=.7071067811865476,Zh.applyMatrix4(r.matrixWorld),this.intersectsSphere(Zh)}intersectsSphere(r){const l=this.planes,d=r.center,v=-r.radius;for(let w=0;w<6;w++)if(l[w].distanceToPoint(d)<v)return!1;return!0}intersectsBox(r){const l=this.planes;for(let d=0;d<6;d++){const v=l[d];if(y0.x=v.normal.x>0?r.max.x:r.min.x,y0.y=v.normal.y>0?r.max.y:r.min.y,y0.z=v.normal.z>0?r.max.z:r.min.z,v.distanceToPoint(y0)<0)return!1}return!0}containsPoint(r){const l=this.planes;for(let d=0;d<6;d++)if(l[d].distanceToPoint(r)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function T1(){let A=null,r=!1,l=null,d=null;function v(w,C){l(w,C),d=A.requestAnimationFrame(v)}return{start:function(){r!==!0&&l!==null&&(d=A.requestAnimationFrame(v),r=!0)},stop:function(){A.cancelAnimationFrame(d),r=!1},setAnimationLoop:function(w){l=w},setContext:function(w){A=w}}}function KI(A,r){const l=r.isWebGL2,d=new WeakMap;function v(H,ne){const re=H.array,se=H.usage,oe=A.createBuffer();A.bindBuffer(ne,oe),A.bufferData(ne,re,se),H.onUploadCallback();let ve=A.FLOAT;return re instanceof Float32Array?ve=A.FLOAT:re instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):re instanceof Uint16Array?H.isFloat16BufferAttribute?l?ve=A.HALF_FLOAT:console.warn("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2."):ve=A.UNSIGNED_SHORT:re instanceof Int16Array?ve=A.SHORT:re instanceof Uint32Array?ve=A.UNSIGNED_INT:re instanceof Int32Array?ve=A.INT:re instanceof Int8Array?ve=A.BYTE:(re instanceof Uint8Array||re instanceof Uint8ClampedArray)&&(ve=A.UNSIGNED_BYTE),{buffer:oe,type:ve,bytesPerElement:re.BYTES_PER_ELEMENT,version:H.version}}function w(H,ne,re){const se=ne.array,oe=ne.updateRange;A.bindBuffer(re,H),oe.count===-1?A.bufferSubData(re,0,se):(l?A.bufferSubData(re,oe.offset*se.BYTES_PER_ELEMENT,se,oe.offset,oe.count):A.bufferSubData(re,oe.offset*se.BYTES_PER_ELEMENT,se.subarray(oe.offset,oe.offset+oe.count)),oe.count=-1)}function C(H){return H.isInterleavedBufferAttribute&&(H=H.data),d.get(H)}function O(H){H.isInterleavedBufferAttribute&&(H=H.data);const ne=d.get(H);ne&&(A.deleteBuffer(ne.buffer),d.delete(H))}function z(H,ne){if(H.isGLBufferAttribute){const se=d.get(H);(!se||se.version<H.version)&&d.set(H,{buffer:H.buffer,type:H.type,bytesPerElement:H.elementSize,version:H.version});return}H.isInterleavedBufferAttribute&&(H=H.data);const re=d.get(H);re===void 0?d.set(H,v(H,ne)):re.version<H.version&&(w(re.buffer,H,ne),re.version=H.version)}return{get:C,remove:O,update:z}}class du extends ui{constructor(r=1,l=1,d=1,v=1){super(),this.type="PlaneGeometry",this.parameters={width:r,height:l,widthSegments:d,heightSegments:v};const w=r/2,C=l/2,O=Math.floor(d),z=Math.floor(v),H=O+1,ne=z+1,re=r/O,se=l/z,oe=[],ve=[],Te=[],Fe=[];for(let Ae=0;Ae<ne;Ae++){const ue=Ae*se-C;for(let Ve=0;Ve<H;Ve++){const ke=Ve*re-w;ve.push(ke,-ue,0),Te.push(0,0,1),Fe.push(Ve/O),Fe.push(1-Ae/z)}}for(let Ae=0;Ae<z;Ae++)for(let ue=0;ue<O;ue++){const Ve=ue+H*Ae,ke=ue+H*(Ae+1),je=ue+1+H*(Ae+1),st=ue+1+H*Ae;oe.push(Ve,ke,st),oe.push(ke,je,st)}this.setIndex(oe),this.setAttribute("position",new ei(ve,3)),this.setAttribute("normal",new ei(Te,3)),this.setAttribute("uv",new ei(Fe,2))}static fromJSON(r){return new du(r.width,r.height,r.widthSegments,r.heightSegments)}}var ZI=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,JI=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,e4=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,t4=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,n4=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,i4=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,r4="vec3 transformed = vec3( position );",s4=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,o4=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,a4=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,l4=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,c4=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,u4=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,h4=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,f4=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,d4=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,p4=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,m4=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,g4=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,v4=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_maxMipLevel 8.0
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_maxTileSize 256.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		float texelSize = 1.0 / ( 3.0 * cubeUV_maxTileSize );
		vec2 uv = getUV( direction, face ) * ( faceSize - 1.0 ) + 0.5;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		if ( mipInt < cubeUV_maxMipLevel ) {
			uv.y += 2.0 * cubeUV_maxTileSize;
		}
		uv.y += filterInt * 2.0 * cubeUV_minTileSize;
		uv.x += 3.0 * max( 0.0, cubeUV_maxTileSize - 2.0 * faceSize );
		uv *= texelSize;
		return texture2D( envMap, uv ).rgb;
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, cubeUV_maxMipLevel );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,y4=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,x4=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,A4=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,b4=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,_4=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,w4="gl_FragColor = linearToOutputTexel( gl_FragColor );",E4=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,M4=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,S4=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,T4=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,C4=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,R4=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,L4=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,P4=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,I4=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,O4=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,D4=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,B4=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	#ifndef PHYSICALLY_CORRECT_LIGHTS
		lightMapIrradiance *= PI;
	#endif
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,F4=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,N4=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointLightInfo( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotLightInfo( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
		#endif
	}
	#pragma unroll_loop_end
#endif`,U4=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,k4=`#if defined( USE_ENVMAP )
	#ifdef ENVMAP_MODE_REFRACTION
		uniform float refractionRatio;
	#endif
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec;
			#ifdef ENVMAP_MODE_REFLECTION
				reflectVec = reflect( - viewDir, normal );
				reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			#else
				reflectVec = refract( - viewDir, normal, refractionRatio );
			#endif
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,z4=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,H4=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,G4=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,V4=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,W4=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,j4=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	vec3 FssEss = specularColor * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = specularColor + ( 1.0 - specularColor ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(		0, 1,		0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	vec3 diffuse = material.diffuseColor * ( 1.0 - ( singleScattering + multiScattering ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,X4=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,$4=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		#ifndef PHYSICALLY_CORRECT_LIGHTS
			lightMapIrradiance *= PI;
		#endif
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,q4=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,Y4=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,Q4=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,K4=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,Z4=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,J4=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,eO=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,tO=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,nO=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,iO=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,rO=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,sO=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1, 2 ) * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,oO=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform vec2 morphTargetsTextureSize;
		vec3 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset, const in int stride ) {
			float texelIndex = float( vertexIndex * stride + offset );
			float y = floor( texelIndex / morphTargetsTextureSize.x );
			float x = texelIndex - y * morphTargetsTextureSize.x;
			vec3 morphUV = vec3( ( x + 0.5 ) / morphTargetsTextureSize.x, y / morphTargetsTextureSize.y, morphTargetIndex );
			return texture( morphTargetsTexture, morphUV ).xyz;
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,aO=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			#ifndef USE_MORPHNORMALS
				if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 1 ) * morphTargetInfluences[ i ];
			#else
				if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0, 2 ) * morphTargetInfluences[ i ];
			#endif
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,lO=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,cO=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,uO=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,hO=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,fO=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,dO=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,pO=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,mO=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,gO=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,vO=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,yO=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,xO=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,AO=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,bO=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,_O=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,wO=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,EO=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,MO=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
							texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
							f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
							texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
							f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,SO=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,TO=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,CO=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,RO=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,LO=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	#ifdef BONE_TEXTURE
		uniform highp sampler2D boneTexture;
		uniform int boneTextureSize;
		mat4 getBoneMatrix( const in float i ) {
			float j = i * 4.0;
			float x = mod( j, float( boneTextureSize ) );
			float y = floor( j / float( boneTextureSize ) );
			float dx = 1.0 / float( boneTextureSize );
			float dy = 1.0 / float( boneTextureSize );
			y = dy * ( y + 0.5 );
			vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
			vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
			vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
			vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
			mat4 bone = mat4( v1, v2, v3, v4 );
			return bone;
		}
	#else
		uniform mat4 boneMatrices[ MAX_BONES ];
		mat4 getBoneMatrix( const in float i ) {
			mat4 bone = boneMatrices[ int(i) ];
			return bone;
		}
	#endif
#endif`,PO=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,IO=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,OO=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,DO=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,BO=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,FO=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(	1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,	1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,	1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,NO=`#ifdef USE_TRANSMISSION
	float transmissionAlpha = 1.0;
	float transmissionFactor = transmission;
	float thicknessFactor = thickness;
	#ifdef USE_TRANSMISSIONMAP
		transmissionFactor *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		thicknessFactor *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,
		attenuationColor, attenuationDistance );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );
	transmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );
#endif`,UO=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef TEXTURE_LOD_EXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( attenuationDistance == 0.0 ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,kO=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,zO=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,HO=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,GO=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,VO=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,WO=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,jO=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const Bi={alphamap_fragment:ZI,alphamap_pars_fragment:JI,alphatest_fragment:e4,alphatest_pars_fragment:t4,aomap_fragment:n4,aomap_pars_fragment:i4,begin_vertex:r4,beginnormal_vertex:s4,bsdfs:o4,bumpmap_pars_fragment:a4,clipping_planes_fragment:l4,clipping_planes_pars_fragment:c4,clipping_planes_pars_vertex:u4,clipping_planes_vertex:h4,color_fragment:f4,color_pars_fragment:d4,color_pars_vertex:p4,color_vertex:m4,common:g4,cube_uv_reflection_fragment:v4,defaultnormal_vertex:y4,displacementmap_pars_vertex:x4,displacementmap_vertex:A4,emissivemap_fragment:b4,emissivemap_pars_fragment:_4,encodings_fragment:w4,encodings_pars_fragment:E4,envmap_fragment:M4,envmap_common_pars_fragment:S4,envmap_pars_fragment:T4,envmap_pars_vertex:C4,envmap_physical_pars_fragment:k4,envmap_vertex:R4,fog_vertex:L4,fog_pars_vertex:P4,fog_fragment:I4,fog_pars_fragment:O4,gradientmap_pars_fragment:D4,lightmap_fragment:B4,lightmap_pars_fragment:F4,lights_lambert_vertex:N4,lights_pars_begin:U4,lights_toon_fragment:z4,lights_toon_pars_fragment:H4,lights_phong_fragment:G4,lights_phong_pars_fragment:V4,lights_physical_fragment:W4,lights_physical_pars_fragment:j4,lights_fragment_begin:X4,lights_fragment_maps:$4,lights_fragment_end:q4,logdepthbuf_fragment:Y4,logdepthbuf_pars_fragment:Q4,logdepthbuf_pars_vertex:K4,logdepthbuf_vertex:Z4,map_fragment:J4,map_pars_fragment:eO,map_particle_fragment:tO,map_particle_pars_fragment:nO,metalnessmap_fragment:iO,metalnessmap_pars_fragment:rO,morphnormal_vertex:sO,morphtarget_pars_vertex:oO,morphtarget_vertex:aO,normal_fragment_begin:lO,normal_fragment_maps:cO,normal_pars_fragment:uO,normal_pars_vertex:hO,normal_vertex:fO,normalmap_pars_fragment:dO,clearcoat_normal_fragment_begin:pO,clearcoat_normal_fragment_maps:mO,clearcoat_pars_fragment:gO,output_fragment:vO,packing:yO,premultiplied_alpha_fragment:xO,project_vertex:AO,dithering_fragment:bO,dithering_pars_fragment:_O,roughnessmap_fragment:wO,roughnessmap_pars_fragment:EO,shadowmap_pars_fragment:MO,shadowmap_pars_vertex:SO,shadowmap_vertex:TO,shadowmask_pars_fragment:CO,skinbase_vertex:RO,skinning_pars_vertex:LO,skinning_vertex:PO,skinnormal_vertex:IO,specularmap_fragment:OO,specularmap_pars_fragment:DO,tonemapping_fragment:BO,tonemapping_pars_fragment:FO,transmission_fragment:NO,transmission_pars_fragment:UO,uv_pars_fragment:kO,uv_pars_vertex:zO,uv_vertex:HO,uv2_pars_fragment:GO,uv2_pars_vertex:VO,uv2_vertex:WO,worldpos_vertex:jO,background_vert:`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,background_frag:`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	gl_FragColor = texture2D( t2D, vUv );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,cube_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,cube_frag:`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,depth_vert:`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,depth_frag:`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,distanceRGBA_vert:`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,distanceRGBA_frag:`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,equirect_vert:`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,equirect_frag:`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,linedashed_vert:`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,linedashed_frag:`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,meshbasic_vert:`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,meshbasic_frag:`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel= texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshlambert_vert:`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshlambert_frag:`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshmatcap_vert:`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,meshmatcap_frag:`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshnormal_vert:`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,meshnormal_frag:`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
}`,meshphong_vert:`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshphong_frag:`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshphysical_vert:`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,meshphysical_frag:`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,meshtoon_vert:`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,meshtoon_frag:`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,points_vert:`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,points_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,shadow_vert:`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,shadow_frag:`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,sprite_vert:`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,sprite_frag:`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`},Bn={common:{diffuse:{value:new Un(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new es},uv2Transform:{value:new es},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new pn(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new Un(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new Un(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new es}},sprite:{diffuse:{value:new Un(16777215)},opacity:{value:1},center:{value:new pn(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new es}}},Qo={basic:{uniforms:Ps([Bn.common,Bn.specularmap,Bn.envmap,Bn.aomap,Bn.lightmap,Bn.fog]),vertexShader:Bi.meshbasic_vert,fragmentShader:Bi.meshbasic_frag},lambert:{uniforms:Ps([Bn.common,Bn.specularmap,Bn.envmap,Bn.aomap,Bn.lightmap,Bn.emissivemap,Bn.fog,Bn.lights,{emissive:{value:new Un(0)}}]),vertexShader:Bi.meshlambert_vert,fragmentShader:Bi.meshlambert_frag},phong:{uniforms:Ps([Bn.common,Bn.specularmap,Bn.envmap,Bn.aomap,Bn.lightmap,Bn.emissivemap,Bn.bumpmap,Bn.normalmap,Bn.displacementmap,Bn.fog,Bn.lights,{emissive:{value:new Un(0)},specular:{value:new Un(1118481)},shininess:{value:30}}]),vertexShader:Bi.meshphong_vert,fragmentShader:Bi.meshphong_frag},standard:{uniforms:Ps([Bn.common,Bn.envmap,Bn.aomap,Bn.lightmap,Bn.emissivemap,Bn.bumpmap,Bn.normalmap,Bn.displacementmap,Bn.roughnessmap,Bn.metalnessmap,Bn.fog,Bn.lights,{emissive:{value:new Un(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Bi.meshphysical_vert,fragmentShader:Bi.meshphysical_frag},toon:{uniforms:Ps([Bn.common,Bn.aomap,Bn.lightmap,Bn.emissivemap,Bn.bumpmap,Bn.normalmap,Bn.displacementmap,Bn.gradientmap,Bn.fog,Bn.lights,{emissive:{value:new Un(0)}}]),vertexShader:Bi.meshtoon_vert,fragmentShader:Bi.meshtoon_frag},matcap:{uniforms:Ps([Bn.common,Bn.bumpmap,Bn.normalmap,Bn.displacementmap,Bn.fog,{matcap:{value:null}}]),vertexShader:Bi.meshmatcap_vert,fragmentShader:Bi.meshmatcap_frag},points:{uniforms:Ps([Bn.points,Bn.fog]),vertexShader:Bi.points_vert,fragmentShader:Bi.points_frag},dashed:{uniforms:Ps([Bn.common,Bn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Bi.linedashed_vert,fragmentShader:Bi.linedashed_frag},depth:{uniforms:Ps([Bn.common,Bn.displacementmap]),vertexShader:Bi.depth_vert,fragmentShader:Bi.depth_frag},normal:{uniforms:Ps([Bn.common,Bn.bumpmap,Bn.normalmap,Bn.displacementmap,{opacity:{value:1}}]),vertexShader:Bi.meshnormal_vert,fragmentShader:Bi.meshnormal_frag},sprite:{uniforms:Ps([Bn.sprite,Bn.fog]),vertexShader:Bi.sprite_vert,fragmentShader:Bi.sprite_frag},background:{uniforms:{uvTransform:{value:new es},t2D:{value:null}},vertexShader:Bi.background_vert,fragmentShader:Bi.background_frag},cube:{uniforms:Ps([Bn.envmap,{opacity:{value:1}}]),vertexShader:Bi.cube_vert,fragmentShader:Bi.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Bi.equirect_vert,fragmentShader:Bi.equirect_frag},distanceRGBA:{uniforms:Ps([Bn.common,Bn.displacementmap,{referencePosition:{value:new qe},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Bi.distanceRGBA_vert,fragmentShader:Bi.distanceRGBA_frag},shadow:{uniforms:Ps([Bn.lights,Bn.fog,{color:{value:new Un(0)},opacity:{value:1}}]),vertexShader:Bi.shadow_vert,fragmentShader:Bi.shadow_frag}};Qo.physical={uniforms:Ps([Qo.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new pn(1,1)},clearcoatNormalMap:{value:null},sheen:{value:0},sheenColor:{value:new Un(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new pn},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new Un(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new Un(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Bi.meshphysical_vert,fragmentShader:Bi.meshphysical_frag};function XO(A,r,l,d,v,w){const C=new Un(0);let O=v===!0?0:1,z,H,ne=null,re=0,se=null;function oe(Te,Fe){let Ae=!1,ue=Fe.isScene===!0?Fe.background:null;ue&&ue.isTexture&&(ue=r.get(ue));const Ve=A.xr,ke=Ve.getSession&&Ve.getSession();ke&&ke.environmentBlendMode==="additive"&&(ue=null),ue===null?ve(C,O):ue&&ue.isColor&&(ve(ue,1),Ae=!0),(A.autoClear||Ae)&&A.clear(A.autoClearColor,A.autoClearDepth,A.autoClearStencil),ue&&(ue.isCubeTexture||ue.mapping===X)?(H===void 0&&(H=new $r(new yl(1,1,1),new xl({name:"BackgroundCubeMaterial",uniforms:qh(Qo.cube.uniforms),vertexShader:Qo.cube.vertexShader,fragmentShader:Qo.cube.fragmentShader,side:T,depthTest:!1,depthWrite:!1,fog:!1})),H.geometry.deleteAttribute("normal"),H.geometry.deleteAttribute("uv"),H.onBeforeRender=function(je,st,At){this.matrixWorld.copyPosition(At.matrixWorld)},Object.defineProperty(H.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),d.update(H)),H.material.uniforms.envMap.value=ue,H.material.uniforms.flipEnvMap.value=ue.isCubeTexture&&ue.isRenderTargetTexture===!1?-1:1,(ne!==ue||re!==ue.version||se!==A.toneMapping)&&(H.material.needsUpdate=!0,ne=ue,re=ue.version,se=A.toneMapping),Te.unshift(H,H.geometry,H.material,0,0,null)):ue&&ue.isTexture&&(z===void 0&&(z=new $r(new du(2,2),new xl({name:"BackgroundMaterial",uniforms:qh(Qo.background.uniforms),vertexShader:Qo.background.vertexShader,fragmentShader:Qo.background.fragmentShader,side:E,depthTest:!1,depthWrite:!1,fog:!1})),z.geometry.deleteAttribute("normal"),Object.defineProperty(z.material,"map",{get:function(){return this.uniforms.t2D.value}}),d.update(z)),z.material.uniforms.t2D.value=ue,ue.matrixAutoUpdate===!0&&ue.updateMatrix(),z.material.uniforms.uvTransform.value.copy(ue.matrix),(ne!==ue||re!==ue.version||se!==A.toneMapping)&&(z.material.needsUpdate=!0,ne=ue,re=ue.version,se=A.toneMapping),Te.unshift(z,z.geometry,z.material,0,0,null))}function ve(Te,Fe){l.buffers.color.setClear(Te.r,Te.g,Te.b,Fe,w)}return{getClearColor:function(){return C},setClearColor:function(Te,Fe=1){C.set(Te),O=Fe,ve(C,O)},getClearAlpha:function(){return O},setClearAlpha:function(Te){O=Te,ve(C,O)},render:oe}}function $O(A,r,l,d){const v=A.getParameter(A.MAX_VERTEX_ATTRIBS),w=d.isWebGL2?null:r.get("OES_vertex_array_object"),C=d.isWebGL2||w!==null,O={},z=Te(null);let H=z;function ne(It,Nt,Pt,Gt,sn){let bn=!1;if(C){const kn=ve(Gt,Pt,Nt);H!==kn&&(H=kn,se(H.object)),bn=Fe(Gt,sn),bn&&Ae(Gt,sn)}else{const kn=Nt.wireframe===!0;(H.geometry!==Gt.id||H.program!==Pt.id||H.wireframe!==kn)&&(H.geometry=Gt.id,H.program=Pt.id,H.wireframe=kn,bn=!0)}It.isInstancedMesh===!0&&(bn=!0),sn!==null&&l.update(sn,A.ELEMENT_ARRAY_BUFFER),bn&&(At(It,Nt,Pt,Gt),sn!==null&&A.bindBuffer(A.ELEMENT_ARRAY_BUFFER,l.get(sn).buffer))}function re(){return d.isWebGL2?A.createVertexArray():w.createVertexArrayOES()}function se(It){return d.isWebGL2?A.bindVertexArray(It):w.bindVertexArrayOES(It)}function oe(It){return d.isWebGL2?A.deleteVertexArray(It):w.deleteVertexArrayOES(It)}function ve(It,Nt,Pt){const Gt=Pt.wireframe===!0;let sn=O[It.id];sn===void 0&&(sn={},O[It.id]=sn);let bn=sn[Nt.id];bn===void 0&&(bn={},sn[Nt.id]=bn);let kn=bn[Gt];return kn===void 0&&(kn=Te(re()),bn[Gt]=kn),kn}function Te(It){const Nt=[],Pt=[],Gt=[];for(let sn=0;sn<v;sn++)Nt[sn]=0,Pt[sn]=0,Gt[sn]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:Nt,enabledAttributes:Pt,attributeDivisors:Gt,object:It,attributes:{},index:null}}function Fe(It,Nt){const Pt=H.attributes,Gt=It.attributes;let sn=0;for(const bn in Gt){const kn=Pt[bn],si=Gt[bn];if(kn===void 0||kn.attribute!==si||kn.data!==si.data)return!0;sn++}return H.attributesNum!==sn||H.index!==Nt}function Ae(It,Nt){const Pt={},Gt=It.attributes;let sn=0;for(const bn in Gt){const kn=Gt[bn],si={};si.attribute=kn,kn.data&&(si.data=kn.data),Pt[bn]=si,sn++}H.attributes=Pt,H.attributesNum=sn,H.index=Nt}function ue(){const It=H.newAttributes;for(let Nt=0,Pt=It.length;Nt<Pt;Nt++)It[Nt]=0}function Ve(It){ke(It,0)}function ke(It,Nt){const Pt=H.newAttributes,Gt=H.enabledAttributes,sn=H.attributeDivisors;Pt[It]=1,Gt[It]===0&&(A.enableVertexAttribArray(It),Gt[It]=1),sn[It]!==Nt&&((d.isWebGL2?A:r.get("ANGLE_instanced_arrays"))[d.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](It,Nt),sn[It]=Nt)}function je(){const It=H.newAttributes,Nt=H.enabledAttributes;for(let Pt=0,Gt=Nt.length;Pt<Gt;Pt++)Nt[Pt]!==It[Pt]&&(A.disableVertexAttribArray(Pt),Nt[Pt]=0)}function st(It,Nt,Pt,Gt,sn,bn){d.isWebGL2===!0&&(Pt===A.INT||Pt===A.UNSIGNED_INT)?A.vertexAttribIPointer(It,Nt,Pt,sn,bn):A.vertexAttribPointer(It,Nt,Pt,Gt,sn,bn)}function At(It,Nt,Pt,Gt){if(d.isWebGL2===!1&&(It.isInstancedMesh||Gt.isInstancedBufferGeometry)&&r.get("ANGLE_instanced_arrays")===null)return;ue();const sn=Gt.attributes,bn=Pt.getAttributes(),kn=Nt.defaultAttributeValues;for(const si in bn){const Vn=bn[si];if(Vn.location>=0){let fn=sn[si];if(fn===void 0&&(si==="instanceMatrix"&&It.instanceMatrix&&(fn=It.instanceMatrix),si==="instanceColor"&&It.instanceColor&&(fn=It.instanceColor)),fn!==void 0){const Pn=fn.normalized,li=fn.itemSize,Mt=l.get(fn);if(Mt===void 0)continue;const fi=Mt.buffer,Qn=Mt.type,di=Mt.bytesPerElement;if(fn.isInterleavedBufferAttribute){const Wn=fn.data,Si=Wn.stride,pi=fn.offset;if(Wn&&Wn.isInstancedInterleavedBuffer){for(let ln=0;ln<Vn.locationSize;ln++)ke(Vn.location+ln,Wn.meshPerAttribute);It.isInstancedMesh!==!0&&Gt._maxInstanceCount===void 0&&(Gt._maxInstanceCount=Wn.meshPerAttribute*Wn.count)}else for(let ln=0;ln<Vn.locationSize;ln++)Ve(Vn.location+ln);A.bindBuffer(A.ARRAY_BUFFER,fi);for(let ln=0;ln<Vn.locationSize;ln++)st(Vn.location+ln,li/Vn.locationSize,Qn,Pn,Si*di,(pi+li/Vn.locationSize*ln)*di)}else{if(fn.isInstancedBufferAttribute){for(let Wn=0;Wn<Vn.locationSize;Wn++)ke(Vn.location+Wn,fn.meshPerAttribute);It.isInstancedMesh!==!0&&Gt._maxInstanceCount===void 0&&(Gt._maxInstanceCount=fn.meshPerAttribute*fn.count)}else for(let Wn=0;Wn<Vn.locationSize;Wn++)Ve(Vn.location+Wn);A.bindBuffer(A.ARRAY_BUFFER,fi);for(let Wn=0;Wn<Vn.locationSize;Wn++)st(Vn.location+Wn,li/Vn.locationSize,Qn,Pn,li*di,li/Vn.locationSize*Wn*di)}}else if(kn!==void 0){const Pn=kn[si];if(Pn!==void 0)switch(Pn.length){case 2:A.vertexAttrib2fv(Vn.location,Pn);break;case 3:A.vertexAttrib3fv(Vn.location,Pn);break;case 4:A.vertexAttrib4fv(Vn.location,Pn);break;default:A.vertexAttrib1fv(Vn.location,Pn)}}}}je()}function Et(){Ne();for(const It in O){const Nt=O[It];for(const Pt in Nt){const Gt=Nt[Pt];for(const sn in Gt)oe(Gt[sn].object),delete Gt[sn];delete Nt[Pt]}delete O[It]}}function Xt(It){if(O[It.id]===void 0)return;const Nt=O[It.id];for(const Pt in Nt){const Gt=Nt[Pt];for(const sn in Gt)oe(Gt[sn].object),delete Gt[sn];delete Nt[Pt]}delete O[It.id]}function Ht(It){for(const Nt in O){const Pt=O[Nt];if(Pt[It.id]===void 0)continue;const Gt=Pt[It.id];for(const sn in Gt)oe(Gt[sn].object),delete Gt[sn];delete Pt[It.id]}}function Ne(){ct(),H!==z&&(H=z,se(H.object))}function ct(){z.geometry=null,z.program=null,z.wireframe=!1}return{setup:ne,reset:Ne,resetDefaultState:ct,dispose:Et,releaseStatesOfGeometry:Xt,releaseStatesOfProgram:Ht,initAttributes:ue,enableAttribute:Ve,disableUnusedAttributes:je}}function qO(A,r,l,d){const v=d.isWebGL2;let w;function C(H){w=H}function O(H,ne){A.drawArrays(w,H,ne),l.update(ne,w,1)}function z(H,ne,re){if(re===0)return;let se,oe;if(v)se=A,oe="drawArraysInstanced";else if(se=r.get("ANGLE_instanced_arrays"),oe="drawArraysInstancedANGLE",se===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}se[oe](w,H,ne,re),l.update(ne,w,re)}this.setMode=C,this.render=O,this.renderInstances=z}function YO(A,r,l){let d;function v(){if(d!==void 0)return d;if(r.has("EXT_texture_filter_anisotropic")===!0){const At=r.get("EXT_texture_filter_anisotropic");d=A.getParameter(At.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else d=0;return d}function w(At){if(At==="highp"){if(A.getShaderPrecisionFormat(A.VERTEX_SHADER,A.HIGH_FLOAT).precision>0&&A.getShaderPrecisionFormat(A.FRAGMENT_SHADER,A.HIGH_FLOAT).precision>0)return"highp";At="mediump"}return At==="mediump"&&A.getShaderPrecisionFormat(A.VERTEX_SHADER,A.MEDIUM_FLOAT).precision>0&&A.getShaderPrecisionFormat(A.FRAGMENT_SHADER,A.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}const C=typeof WebGL2RenderingContext!="undefined"&&A instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext!="undefined"&&A instanceof WebGL2ComputeRenderingContext;let O=l.precision!==void 0?l.precision:"highp";const z=w(O);z!==O&&(console.warn("THREE.WebGLRenderer:",O,"not supported, using",z,"instead."),O=z);const H=C||r.has("WEBGL_draw_buffers"),ne=l.logarithmicDepthBuffer===!0,re=A.getParameter(A.MAX_TEXTURE_IMAGE_UNITS),se=A.getParameter(A.MAX_VERTEX_TEXTURE_IMAGE_UNITS),oe=A.getParameter(A.MAX_TEXTURE_SIZE),ve=A.getParameter(A.MAX_CUBE_MAP_TEXTURE_SIZE),Te=A.getParameter(A.MAX_VERTEX_ATTRIBS),Fe=A.getParameter(A.MAX_VERTEX_UNIFORM_VECTORS),Ae=A.getParameter(A.MAX_VARYING_VECTORS),ue=A.getParameter(A.MAX_FRAGMENT_UNIFORM_VECTORS),Ve=se>0,ke=C||r.has("OES_texture_float"),je=Ve&&ke,st=C?A.getParameter(A.MAX_SAMPLES):0;return{isWebGL2:C,drawBuffers:H,getMaxAnisotropy:v,getMaxPrecision:w,precision:O,logarithmicDepthBuffer:ne,maxTextures:re,maxVertexTextures:se,maxTextureSize:oe,maxCubemapSize:ve,maxAttributes:Te,maxVertexUniforms:Fe,maxVaryings:Ae,maxFragmentUniforms:ue,vertexTextures:Ve,floatFragmentTextures:ke,floatVertexTextures:je,maxSamples:st}}function QO(A){const r=this;let l=null,d=0,v=!1,w=!1;const C=new Ea,O=new es,z={value:null,needsUpdate:!1};this.uniform=z,this.numPlanes=0,this.numIntersection=0,this.init=function(re,se,oe){const ve=re.length!==0||se||d!==0||v;return v=se,l=ne(re,oe,0),d=re.length,ve},this.beginShadows=function(){w=!0,ne(null)},this.endShadows=function(){w=!1,H()},this.setState=function(re,se,oe){const ve=re.clippingPlanes,Te=re.clipIntersection,Fe=re.clipShadows,Ae=A.get(re);if(!v||ve===null||ve.length===0||w&&!Fe)w?ne(null):H();else{const ue=w?0:d,Ve=ue*4;let ke=Ae.clippingState||null;z.value=ke,ke=ne(ve,se,Ve,oe);for(let je=0;je!==Ve;++je)ke[je]=l[je];Ae.clippingState=ke,this.numIntersection=Te?this.numPlanes:0,this.numPlanes+=ue}};function H(){z.value!==l&&(z.value=l,z.needsUpdate=d>0),r.numPlanes=d,r.numIntersection=0}function ne(re,se,oe,ve){const Te=re!==null?re.length:0;let Fe=null;if(Te!==0){if(Fe=z.value,ve!==!0||Fe===null){const Ae=oe+Te*4,ue=se.matrixWorldInverse;O.getNormalMatrix(ue),(Fe===null||Fe.length<Ae)&&(Fe=new Float32Array(Ae));for(let Ve=0,ke=oe;Ve!==Te;++Ve,ke+=4)C.copy(re[Ve]).applyMatrix4(ue,O),C.normal.toArray(Fe,ke),Fe[ke+3]=C.constant}z.value=Fe,z.needsUpdate=!0}return r.numPlanes=Te,r.numIntersection=0,Fe}}function KO(A){let r=new WeakMap;function l(C,O){return O===S?C.mapping=Z:O===R&&(C.mapping=B),C}function d(C){if(C&&C.isTexture&&C.isRenderTargetTexture===!1){const O=C.mapping;if(O===S||O===R)if(r.has(C)){const z=r.get(C).texture;return l(z,C.mapping)}else{const z=C.image;if(z&&z.height>0){const H=new v0(z.height/2);return H.fromEquirectangularTexture(A,C),r.set(C,H),C.addEventListener("dispose",v),l(H.texture,C.mapping)}else return null}}return C}function v(C){const O=C.target;O.removeEventListener("dispose",v);const z=r.get(O);z!==void 0&&(r.delete(O),z.dispose())}function w(){r=new WeakMap}return{get:d,dispose:w}}class op extends rp{constructor(r=-1,l=1,d=1,v=-1,w=.1,C=2e3){super(),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=r,this.right=l,this.top=d,this.bottom=v,this.near=w,this.far=C,this.updateProjectionMatrix()}copy(r,l){return super.copy(r,l),this.left=r.left,this.right=r.right,this.top=r.top,this.bottom=r.bottom,this.near=r.near,this.far=r.far,this.zoom=r.zoom,this.view=r.view===null?null:Object.assign({},r.view),this}setViewOffset(r,l,d,v,w,C){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=r,this.view.fullHeight=l,this.view.offsetX=d,this.view.offsetY=v,this.view.width=w,this.view.height=C,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const r=(this.right-this.left)/(2*this.zoom),l=(this.top-this.bottom)/(2*this.zoom),d=(this.right+this.left)/2,v=(this.top+this.bottom)/2;let w=d-r,C=d+r,O=v+l,z=v-l;if(this.view!==null&&this.view.enabled){const H=(this.right-this.left)/this.view.fullWidth/this.zoom,ne=(this.top-this.bottom)/this.view.fullHeight/this.zoom;w+=H*this.view.offsetX,C=w+H*this.view.width,O-=ne*this.view.offsetY,z=O-ne*this.view.height}this.projectionMatrix.makeOrthographic(w,C,O,z,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(r){const l=super.toJSON(r);return l.object.zoom=this.zoom,l.object.left=this.left,l.object.right=this.right,l.object.top=this.top,l.object.bottom=this.bottom,l.object.near=this.near,l.object.far=this.far,this.view!==null&&(l.object.view=Object.assign({},this.view)),l}}op.prototype.isOrthographicCamera=!0;class Jh extends xl{constructor(r){super(r),this.type="RawShaderMaterial"}}Jh.prototype.isRawShaderMaterial=!0;const ef=4,rc=8,Ma=Math.pow(2,rc),Zw=[.125,.215,.35,.446,.526,.582],Jw=rc-ef+1+Zw.length,tf=20,C1=new op,{_lodPlanes:ap,_sizeLods:eE,_sigmas:x0}=ZO(),tE=new Un;let R1=null;const pu=(1+Math.sqrt(5))/2,nf=1/pu,nE=[new qe(1,1,1),new qe(-1,1,1),new qe(1,1,-1),new qe(-1,1,-1),new qe(0,pu,nf),new qe(0,pu,-nf),new qe(nf,0,pu),new qe(-nf,0,pu),new qe(pu,nf,0),new qe(-pu,nf,0)];class L1{constructor(r){this._renderer=r,this._pingPongRenderTarget=null,this._blurMaterial=JO(tf),this._equirectShader=null,this._cubemapShader=null,this._compileMaterial(this._blurMaterial)}fromScene(r,l=0,d=.1,v=100){R1=this._renderer.getRenderTarget();const w=this._allocateTargets();return this._sceneToCubeUV(r,d,v,w),l>0&&this._blur(w,0,0,l),this._applyPMREM(w),this._cleanup(w),w}fromEquirectangular(r,l=null){return this._fromTexture(r,l)}fromCubemap(r,l=null){return this._fromTexture(r,l)}compileCubemapShader(){this._cubemapShader===null&&(this._cubemapShader=sE(),this._compileMaterial(this._cubemapShader))}compileEquirectangularShader(){this._equirectShader===null&&(this._equirectShader=rE(),this._compileMaterial(this._equirectShader))}dispose(){this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose(),this._cubemapShader!==null&&this._cubemapShader.dispose(),this._equirectShader!==null&&this._equirectShader.dispose();for(let r=0;r<ap.length;r++)ap[r].dispose()}_cleanup(r){this._renderer.setRenderTarget(R1),r.scissorTest=!1,A0(r,0,0,r.width,r.height)}_fromTexture(r,l){R1=this._renderer.getRenderTarget();const d=l||this._allocateTargets(r);return this._textureToCubeUV(r,d),this._applyPMREM(d),this._cleanup(d),d}_allocateTargets(r){const l={magFilter:ut,minFilter:ut,generateMipmaps:!1,type:Zn,format:Se,encoding:Qi,depthBuffer:!1},d=iE(l);return d.depthBuffer=!r,this._pingPongRenderTarget===null&&(this._pingPongRenderTarget=iE(l)),d}_compileMaterial(r){const l=new $r(ap[0],r);this._renderer.compile(l,C1)}_sceneToCubeUV(r,l,d,v){const O=new qr(90,1,l,d),z=[1,-1,1,1,1,1],H=[1,1,1,-1,-1,-1],ne=this._renderer,re=ne.autoClear,se=ne.toneMapping;ne.getClearColor(tE),ne.toneMapping=Ee,ne.autoClear=!1;const oe=new vl({name:"PMREM.Background",side:T,depthWrite:!1,depthTest:!1}),ve=new $r(new yl,oe);let Te=!1;const Fe=r.background;Fe?Fe.isColor&&(oe.color.copy(Fe),r.background=null,Te=!0):(oe.color.copy(tE),Te=!0);for(let Ae=0;Ae<6;Ae++){const ue=Ae%3;ue===0?(O.up.set(0,z[Ae],0),O.lookAt(H[Ae],0,0)):ue===1?(O.up.set(0,0,z[Ae]),O.lookAt(0,H[Ae],0)):(O.up.set(0,z[Ae],0),O.lookAt(0,0,H[Ae])),A0(v,ue*Ma,Ae>2?Ma:0,Ma,Ma),ne.setRenderTarget(v),Te&&ne.render(ve,O),ne.render(r,O)}ve.geometry.dispose(),ve.material.dispose(),ne.toneMapping=se,ne.autoClear=re,r.background=Fe}_textureToCubeUV(r,l){const d=this._renderer,v=r.mapping===Z||r.mapping===B;v?(this._cubemapShader===null&&(this._cubemapShader=sE()),this._cubemapShader.uniforms.flipEnvMap.value=r.isRenderTargetTexture===!1?-1:1):this._equirectShader===null&&(this._equirectShader=rE());const w=v?this._cubemapShader:this._equirectShader,C=new $r(ap[0],w),O=w.uniforms;O.envMap.value=r,v||O.texelSize.value.set(1/r.image.width,1/r.image.height),A0(l,0,0,3*Ma,2*Ma),d.setRenderTarget(l),d.render(C,C1)}_applyPMREM(r){const l=this._renderer,d=l.autoClear;l.autoClear=!1;for(let v=1;v<Jw;v++){const w=Math.sqrt(x0[v]*x0[v]-x0[v-1]*x0[v-1]),C=nE[(v-1)%nE.length];this._blur(r,v-1,v,w,C)}l.autoClear=d}_blur(r,l,d,v,w){const C=this._pingPongRenderTarget;this._halfBlur(r,C,l,d,v,"latitudinal",w),this._halfBlur(C,r,d,d,v,"longitudinal",w)}_halfBlur(r,l,d,v,w,C,O){const z=this._renderer,H=this._blurMaterial;C!=="latitudinal"&&C!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const ne=3,re=new $r(ap[v],H),se=H.uniforms,oe=eE[d]-1,ve=isFinite(w)?Math.PI/(2*oe):2*Math.PI/(2*tf-1),Te=w/ve,Fe=isFinite(w)?1+Math.floor(ne*Te):tf;Fe>tf&&console.warn(`sigmaRadians, ${w}, is too large and will clip, as it requested ${Fe} samples when the maximum is set to ${tf}`);const Ae=[];let ue=0;for(let st=0;st<tf;++st){const At=st/Te,Et=Math.exp(-At*At/2);Ae.push(Et),st===0?ue+=Et:st<Fe&&(ue+=2*Et)}for(let st=0;st<Ae.length;st++)Ae[st]=Ae[st]/ue;se.envMap.value=r.texture,se.samples.value=Fe,se.weights.value=Ae,se.latitudinal.value=C==="latitudinal",O&&(se.poleAxis.value=O),se.dTheta.value=ve,se.mipInt.value=rc-d;const Ve=eE[v],ke=3*Math.max(0,Ma-2*Ve),je=(v===0?0:2*Ma)+2*Ve*(v>rc-ef?v-rc+ef:0);A0(l,ke,je,3*Ve,2*Ve),z.setRenderTarget(l),z.render(re,C1)}}function ZO(){const A=[],r=[],l=[];let d=rc;for(let v=0;v<Jw;v++){const w=Math.pow(2,d);r.push(w);let C=1/w;v>rc-ef?C=Zw[v-rc+ef-1]:v===0&&(C=0),l.push(C);const O=1/(w-1),z=-O/2,H=1+O/2,ne=[z,z,H,z,H,H,z,z,H,H,z,H],re=6,se=6,oe=3,ve=2,Te=1,Fe=new Float32Array(oe*se*re),Ae=new Float32Array(ve*se*re),ue=new Float32Array(Te*se*re);for(let ke=0;ke<re;ke++){const je=ke%3*2/3-1,st=ke>2?0:-1,At=[je,st,0,je+2/3,st,0,je+2/3,st+1,0,je,st,0,je+2/3,st+1,0,je,st+1,0];Fe.set(At,oe*se*ke),Ae.set(ne,ve*se*ke);const Et=[ke,ke,ke,ke,ke,ke];ue.set(Et,Te*se*ke)}const Ve=new ui;Ve.setAttribute("position",new Wi(Fe,oe)),Ve.setAttribute("uv",new Wi(Ae,ve)),Ve.setAttribute("faceIndex",new Wi(ue,Te)),A.push(Ve),d>ef&&d--}return{_lodPlanes:A,_sizeLods:r,_sigmas:l}}function iE(A){const r=new fo(3*Ma,3*Ma,A);return r.texture.mapping=X,r.texture.name="PMREM.cubeUv",r.scissorTest=!0,r}function A0(A,r,l,d,v){A.viewport.set(r,l,d,v),A.scissor.set(r,l,d,v)}function JO(A){const r=new Float32Array(A),l=new qe(0,1,0);return new Jh({name:"SphericalGaussianBlur",defines:{n:A},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:r},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:l}},vertexShader:P1(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:k,depthTest:!1,depthWrite:!1})}function rE(){const A=new pn(1,1);return new Jh({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null},texelSize:{value:A}},vertexShader:P1(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform vec2 texelSize;

			#include <common>

			void main() {

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				vec2 f = fract( uv / texelSize - 0.5 );
				uv -= f * texelSize;
				vec3 tl = texture2D ( envMap, uv ).rgb;
				uv.x += texelSize.x;
				vec3 tr = texture2D ( envMap, uv ).rgb;
				uv.y += texelSize.y;
				vec3 br = texture2D ( envMap, uv ).rgb;
				uv.x -= texelSize.x;
				vec3 bl = texture2D ( envMap, uv ).rgb;

				vec3 tm = mix( tl, tr, f.x );
				vec3 bm = mix( bl, br, f.x );
				gl_FragColor.rgb = mix( tm, bm, f.y );

			}
		`,blending:k,depthTest:!1,depthWrite:!1})}function sE(){return new Jh({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:P1(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:k,depthTest:!1,depthWrite:!1})}function P1(){return`

		precision mediump float;
		precision mediump int;

		attribute vec3 position;
		attribute vec2 uv;
		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function e5(A){let r=new WeakMap,l=null;function d(O){if(O&&O.isTexture){const z=O.mapping,H=z===S||z===R,ne=z===Z||z===B;if(H||ne)if(O.isRenderTargetTexture&&O.needsPMREMUpdate===!0){O.needsPMREMUpdate=!1;let re=r.get(O);return l===null&&(l=new L1(A)),re=H?l.fromEquirectangular(O,re):l.fromCubemap(O,re),r.set(O,re),re.texture}else{if(r.has(O))return r.get(O).texture;{const re=O.image;if(H&&re&&re.height>0||ne&&re&&v(re)){l===null&&(l=new L1(A));const se=H?l.fromEquirectangular(O):l.fromCubemap(O);return r.set(O,se),O.addEventListener("dispose",w),se.texture}else return null}}}return O}function v(O){let z=0;const H=6;for(let ne=0;ne<H;ne++)O[ne]!==void 0&&z++;return z===H}function w(O){const z=O.target;z.removeEventListener("dispose",w);const H=r.get(z);H!==void 0&&(r.delete(z),H.dispose())}function C(){r=new WeakMap,l!==null&&(l.dispose(),l=null)}return{get:d,dispose:C}}function t5(A){const r={};function l(d){if(r[d]!==void 0)return r[d];let v;switch(d){case"WEBGL_depth_texture":v=A.getExtension("WEBGL_depth_texture")||A.getExtension("MOZ_WEBGL_depth_texture")||A.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":v=A.getExtension("EXT_texture_filter_anisotropic")||A.getExtension("MOZ_EXT_texture_filter_anisotropic")||A.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":v=A.getExtension("WEBGL_compressed_texture_s3tc")||A.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||A.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":v=A.getExtension("WEBGL_compressed_texture_pvrtc")||A.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:v=A.getExtension(d)}return r[d]=v,v}return{has:function(d){return l(d)!==null},init:function(d){d.isWebGL2?l("EXT_color_buffer_float"):(l("WEBGL_depth_texture"),l("OES_texture_float"),l("OES_texture_half_float"),l("OES_texture_half_float_linear"),l("OES_standard_derivatives"),l("OES_element_index_uint"),l("OES_vertex_array_object"),l("ANGLE_instanced_arrays")),l("OES_texture_float_linear"),l("EXT_color_buffer_half_float"),l("WEBGL_multisampled_render_to_texture")},get:function(d){const v=l(d);return v===null&&console.warn("THREE.WebGLRenderer: "+d+" extension not supported."),v}}}function n5(A,r,l,d){const v={},w=new WeakMap;function C(re){const se=re.target;se.index!==null&&r.remove(se.index);for(const ve in se.attributes)r.remove(se.attributes[ve]);se.removeEventListener("dispose",C),delete v[se.id];const oe=w.get(se);oe&&(r.remove(oe),w.delete(se)),d.releaseStatesOfGeometry(se),se.isInstancedBufferGeometry===!0&&delete se._maxInstanceCount,l.memory.geometries--}function O(re,se){return v[se.id]===!0||(se.addEventListener("dispose",C),v[se.id]=!0,l.memory.geometries++),se}function z(re){const se=re.attributes;for(const ve in se)r.update(se[ve],A.ARRAY_BUFFER);const oe=re.morphAttributes;for(const ve in oe){const Te=oe[ve];for(let Fe=0,Ae=Te.length;Fe<Ae;Fe++)r.update(Te[Fe],A.ARRAY_BUFFER)}}function H(re){const se=[],oe=re.index,ve=re.attributes.position;let Te=0;if(oe!==null){const ue=oe.array;Te=oe.version;for(let Ve=0,ke=ue.length;Ve<ke;Ve+=3){const je=ue[Ve+0],st=ue[Ve+1],At=ue[Ve+2];se.push(je,st,st,At,At,je)}}else{const ue=ve.array;Te=ve.version;for(let Ve=0,ke=ue.length/3-1;Ve<ke;Ve+=3){const je=Ve+0,st=Ve+1,At=Ve+2;se.push(je,st,st,At,At,je)}}const Fe=new(Lw(se)?a0:o0)(se,1);Fe.version=Te;const Ae=w.get(re);Ae&&r.remove(Ae),w.set(re,Fe)}function ne(re){const se=w.get(re);if(se){const oe=re.index;oe!==null&&se.version<oe.version&&H(re)}else H(re);return w.get(re)}return{get:O,update:z,getWireframeAttribute:ne}}function i5(A,r,l,d){const v=d.isWebGL2;let w;function C(se){w=se}let O,z;function H(se){O=se.type,z=se.bytesPerElement}function ne(se,oe){A.drawElements(w,oe,O,se*z),l.update(oe,w,1)}function re(se,oe,ve){if(ve===0)return;let Te,Fe;if(v)Te=A,Fe="drawElementsInstanced";else if(Te=r.get("ANGLE_instanced_arrays"),Fe="drawElementsInstancedANGLE",Te===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}Te[Fe](w,oe,O,se*z,ve),l.update(oe,w,ve)}this.setMode=C,this.setIndex=H,this.render=ne,this.renderInstances=re}function r5(A){const r={geometries:0,textures:0},l={frame:0,calls:0,triangles:0,points:0,lines:0};function d(w,C,O){switch(l.calls++,C){case A.TRIANGLES:l.triangles+=O*(w/3);break;case A.LINES:l.lines+=O*(w/2);break;case A.LINE_STRIP:l.lines+=O*(w-1);break;case A.LINE_LOOP:l.lines+=O*w;break;case A.POINTS:l.points+=O*w;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",C);break}}function v(){l.frame++,l.calls=0,l.triangles=0,l.points=0,l.lines=0}return{memory:r,render:l,programs:null,autoReset:!0,reset:v,update:d}}class b0 extends Xr{constructor(r=null,l=1,d=1,v=1){super(null),this.image={data:r,width:l,height:d,depth:v},this.magFilter=at,this.minFilter=at,this.wrapR=ye,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}b0.prototype.isDataTexture2DArray=!0;function s5(A,r){return A[0]-r[0]}function o5(A,r){return Math.abs(r[1])-Math.abs(A[1])}function oE(A,r){let l=1;const d=r.isInterleavedBufferAttribute?r.data.array:r.array;d instanceof Int8Array?l=127:d instanceof Int16Array?l=32767:d instanceof Int32Array?l=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",d),A.divideScalar(l)}function a5(A,r,l){const d={},v=new Float32Array(8),w=new WeakMap,C=new qe,O=[];for(let H=0;H<8;H++)O[H]=[H,0];function z(H,ne,re,se){const oe=H.morphTargetInfluences;if(r.isWebGL2===!0){const Te=ne.morphAttributes.position.length;let Fe=w.get(ne);if(Fe===void 0||Fe.count!==Te){let It=function(){Ne.dispose(),w.delete(ne),ne.removeEventListener("dispose",It)};var ve=It;Fe!==void 0&&Fe.texture.dispose();const Ve=ne.morphAttributes.normal!==void 0,ke=ne.morphAttributes.position,je=ne.morphAttributes.normal||[],st=ne.attributes.position.count,At=Ve===!0?2:1;let Et=st*At,Xt=1;Et>r.maxTextureSize&&(Xt=Math.ceil(Et/r.maxTextureSize),Et=r.maxTextureSize);const Ht=new Float32Array(Et*Xt*4*Te),Ne=new b0(Ht,Et,Xt,Te);Ne.format=Se,Ne.type=xn,Ne.needsUpdate=!0;const ct=At*4;for(let Nt=0;Nt<Te;Nt++){const Pt=ke[Nt],Gt=je[Nt],sn=Et*Xt*4*Nt;for(let bn=0;bn<Pt.count;bn++){C.fromBufferAttribute(Pt,bn),Pt.normalized===!0&&oE(C,Pt);const kn=bn*ct;Ht[sn+kn+0]=C.x,Ht[sn+kn+1]=C.y,Ht[sn+kn+2]=C.z,Ht[sn+kn+3]=0,Ve===!0&&(C.fromBufferAttribute(Gt,bn),Gt.normalized===!0&&oE(C,Gt),Ht[sn+kn+4]=C.x,Ht[sn+kn+5]=C.y,Ht[sn+kn+6]=C.z,Ht[sn+kn+7]=0)}}Fe={count:Te,texture:Ne,size:new pn(Et,Xt)},w.set(ne,Fe),ne.addEventListener("dispose",It)}let Ae=0;for(let Ve=0;Ve<oe.length;Ve++)Ae+=oe[Ve];const ue=ne.morphTargetsRelative?1:1-Ae;se.getUniforms().setValue(A,"morphTargetBaseInfluence",ue),se.getUniforms().setValue(A,"morphTargetInfluences",oe),se.getUniforms().setValue(A,"morphTargetsTexture",Fe.texture,l),se.getUniforms().setValue(A,"morphTargetsTextureSize",Fe.size)}else{const Te=oe===void 0?0:oe.length;let Fe=d[ne.id];if(Fe===void 0||Fe.length!==Te){Fe=[];for(let je=0;je<Te;je++)Fe[je]=[je,0];d[ne.id]=Fe}for(let je=0;je<Te;je++){const st=Fe[je];st[0]=je,st[1]=oe[je]}Fe.sort(o5);for(let je=0;je<8;je++)je<Te&&Fe[je][1]?(O[je][0]=Fe[je][0],O[je][1]=Fe[je][1]):(O[je][0]=Number.MAX_SAFE_INTEGER,O[je][1]=0);O.sort(s5);const Ae=ne.morphAttributes.position,ue=ne.morphAttributes.normal;let Ve=0;for(let je=0;je<8;je++){const st=O[je],At=st[0],Et=st[1];At!==Number.MAX_SAFE_INTEGER&&Et?(Ae&&ne.getAttribute("morphTarget"+je)!==Ae[At]&&ne.setAttribute("morphTarget"+je,Ae[At]),ue&&ne.getAttribute("morphNormal"+je)!==ue[At]&&ne.setAttribute("morphNormal"+je,ue[At]),v[je]=Et,Ve+=Et):(Ae&&ne.hasAttribute("morphTarget"+je)===!0&&ne.deleteAttribute("morphTarget"+je),ue&&ne.hasAttribute("morphNormal"+je)===!0&&ne.deleteAttribute("morphNormal"+je),v[je]=0)}const ke=ne.morphTargetsRelative?1:1-Ve;se.getUniforms().setValue(A,"morphTargetBaseInfluence",ke),se.getUniforms().setValue(A,"morphTargetInfluences",v)}}return{update:z}}function l5(A,r,l,d){let v=new WeakMap;function w(z){const H=d.render.frame,ne=z.geometry,re=r.get(z,ne);return v.get(re)!==H&&(r.update(re),v.set(re,H)),z.isInstancedMesh&&(z.hasEventListener("dispose",O)===!1&&z.addEventListener("dispose",O),l.update(z.instanceMatrix,A.ARRAY_BUFFER),z.instanceColor!==null&&l.update(z.instanceColor,A.ARRAY_BUFFER)),re}function C(){v=new WeakMap}function O(z){const H=z.target;H.removeEventListener("dispose",O),l.remove(H.instanceMatrix),H.instanceColor!==null&&l.remove(H.instanceColor)}return{update:w,dispose:C}}class I1 extends Xr{constructor(r=null,l=1,d=1,v=1){super(null),this.image={data:r,width:l,height:d,depth:v},this.magFilter=at,this.minFilter=at,this.wrapR=ye,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}I1.prototype.isDataTexture3D=!0;const aE=new Xr,lE=new b0,cE=new I1,uE=new Kh,hE=[],fE=[],dE=new Float32Array(16),pE=new Float32Array(9),mE=new Float32Array(4);function rf(A,r,l){const d=A[0];if(d<=0||d>0)return A;const v=r*l;let w=hE[v];if(w===void 0&&(w=new Float32Array(v),hE[v]=w),r!==0){d.toArray(w,0);for(let C=1,O=0;C!==r;++C)O+=l,A[C].toArray(w,O)}return w}function js(A,r){if(A.length!==r.length)return!1;for(let l=0,d=A.length;l<d;l++)if(A[l]!==r[l])return!1;return!0}function Is(A,r){for(let l=0,d=r.length;l<d;l++)A[l]=r[l]}function _0(A,r){let l=fE[r];l===void 0&&(l=new Int32Array(r),fE[r]=l);for(let d=0;d!==r;++d)l[d]=A.allocateTextureUnit();return l}function c5(A,r){const l=this.cache;l[0]!==r&&(A.uniform1f(this.addr,r),l[0]=r)}function u5(A,r){const l=this.cache;if(r.x!==void 0)(l[0]!==r.x||l[1]!==r.y)&&(A.uniform2f(this.addr,r.x,r.y),l[0]=r.x,l[1]=r.y);else{if(js(l,r))return;A.uniform2fv(this.addr,r),Is(l,r)}}function h5(A,r){const l=this.cache;if(r.x!==void 0)(l[0]!==r.x||l[1]!==r.y||l[2]!==r.z)&&(A.uniform3f(this.addr,r.x,r.y,r.z),l[0]=r.x,l[1]=r.y,l[2]=r.z);else if(r.r!==void 0)(l[0]!==r.r||l[1]!==r.g||l[2]!==r.b)&&(A.uniform3f(this.addr,r.r,r.g,r.b),l[0]=r.r,l[1]=r.g,l[2]=r.b);else{if(js(l,r))return;A.uniform3fv(this.addr,r),Is(l,r)}}function f5(A,r){const l=this.cache;if(r.x!==void 0)(l[0]!==r.x||l[1]!==r.y||l[2]!==r.z||l[3]!==r.w)&&(A.uniform4f(this.addr,r.x,r.y,r.z,r.w),l[0]=r.x,l[1]=r.y,l[2]=r.z,l[3]=r.w);else{if(js(l,r))return;A.uniform4fv(this.addr,r),Is(l,r)}}function d5(A,r){const l=this.cache,d=r.elements;if(d===void 0){if(js(l,r))return;A.uniformMatrix2fv(this.addr,!1,r),Is(l,r)}else{if(js(l,d))return;mE.set(d),A.uniformMatrix2fv(this.addr,!1,mE),Is(l,d)}}function p5(A,r){const l=this.cache,d=r.elements;if(d===void 0){if(js(l,r))return;A.uniformMatrix3fv(this.addr,!1,r),Is(l,r)}else{if(js(l,d))return;pE.set(d),A.uniformMatrix3fv(this.addr,!1,pE),Is(l,d)}}function m5(A,r){const l=this.cache,d=r.elements;if(d===void 0){if(js(l,r))return;A.uniformMatrix4fv(this.addr,!1,r),Is(l,r)}else{if(js(l,d))return;dE.set(d),A.uniformMatrix4fv(this.addr,!1,dE),Is(l,d)}}function g5(A,r){const l=this.cache;l[0]!==r&&(A.uniform1i(this.addr,r),l[0]=r)}function v5(A,r){const l=this.cache;js(l,r)||(A.uniform2iv(this.addr,r),Is(l,r))}function y5(A,r){const l=this.cache;js(l,r)||(A.uniform3iv(this.addr,r),Is(l,r))}function x5(A,r){const l=this.cache;js(l,r)||(A.uniform4iv(this.addr,r),Is(l,r))}function A5(A,r){const l=this.cache;l[0]!==r&&(A.uniform1ui(this.addr,r),l[0]=r)}function b5(A,r){const l=this.cache;js(l,r)||(A.uniform2uiv(this.addr,r),Is(l,r))}function _5(A,r){const l=this.cache;js(l,r)||(A.uniform3uiv(this.addr,r),Is(l,r))}function w5(A,r){const l=this.cache;js(l,r)||(A.uniform4uiv(this.addr,r),Is(l,r))}function E5(A,r,l){const d=this.cache,v=l.allocateTextureUnit();d[0]!==v&&(A.uniform1i(this.addr,v),d[0]=v),l.safeSetTexture2D(r||aE,v)}function M5(A,r,l){const d=this.cache,v=l.allocateTextureUnit();d[0]!==v&&(A.uniform1i(this.addr,v),d[0]=v),l.setTexture3D(r||cE,v)}function S5(A,r,l){const d=this.cache,v=l.allocateTextureUnit();d[0]!==v&&(A.uniform1i(this.addr,v),d[0]=v),l.safeSetTextureCube(r||uE,v)}function T5(A,r,l){const d=this.cache,v=l.allocateTextureUnit();d[0]!==v&&(A.uniform1i(this.addr,v),d[0]=v),l.setTexture2DArray(r||lE,v)}function C5(A){switch(A){case 5126:return c5;case 35664:return u5;case 35665:return h5;case 35666:return f5;case 35674:return d5;case 35675:return p5;case 35676:return m5;case 5124:case 35670:return g5;case 35667:case 35671:return v5;case 35668:case 35672:return y5;case 35669:case 35673:return x5;case 5125:return A5;case 36294:return b5;case 36295:return _5;case 36296:return w5;case 35678:case 36198:case 36298:case 36306:case 35682:return E5;case 35679:case 36299:case 36307:return M5;case 35680:case 36300:case 36308:case 36293:return S5;case 36289:case 36303:case 36311:case 36292:return T5}}function R5(A,r){A.uniform1fv(this.addr,r)}function L5(A,r){const l=rf(r,this.size,2);A.uniform2fv(this.addr,l)}function P5(A,r){const l=rf(r,this.size,3);A.uniform3fv(this.addr,l)}function I5(A,r){const l=rf(r,this.size,4);A.uniform4fv(this.addr,l)}function O5(A,r){const l=rf(r,this.size,4);A.uniformMatrix2fv(this.addr,!1,l)}function D5(A,r){const l=rf(r,this.size,9);A.uniformMatrix3fv(this.addr,!1,l)}function B5(A,r){const l=rf(r,this.size,16);A.uniformMatrix4fv(this.addr,!1,l)}function F5(A,r){A.uniform1iv(this.addr,r)}function N5(A,r){A.uniform2iv(this.addr,r)}function U5(A,r){A.uniform3iv(this.addr,r)}function k5(A,r){A.uniform4iv(this.addr,r)}function z5(A,r){A.uniform1uiv(this.addr,r)}function H5(A,r){A.uniform2uiv(this.addr,r)}function G5(A,r){A.uniform3uiv(this.addr,r)}function V5(A,r){A.uniform4uiv(this.addr,r)}function W5(A,r,l){const d=r.length,v=_0(l,d);A.uniform1iv(this.addr,v);for(let w=0;w!==d;++w)l.safeSetTexture2D(r[w]||aE,v[w])}function j5(A,r,l){const d=r.length,v=_0(l,d);A.uniform1iv(this.addr,v);for(let w=0;w!==d;++w)l.setTexture3D(r[w]||cE,v[w])}function X5(A,r,l){const d=r.length,v=_0(l,d);A.uniform1iv(this.addr,v);for(let w=0;w!==d;++w)l.safeSetTextureCube(r[w]||uE,v[w])}function $5(A,r,l){const d=r.length,v=_0(l,d);A.uniform1iv(this.addr,v);for(let w=0;w!==d;++w)l.setTexture2DArray(r[w]||lE,v[w])}function q5(A){switch(A){case 5126:return R5;case 35664:return L5;case 35665:return P5;case 35666:return I5;case 35674:return O5;case 35675:return D5;case 35676:return B5;case 5124:case 35670:return F5;case 35667:case 35671:return N5;case 35668:case 35672:return U5;case 35669:case 35673:return k5;case 5125:return z5;case 36294:return H5;case 36295:return G5;case 36296:return V5;case 35678:case 36198:case 36298:case 36306:case 35682:return W5;case 35679:case 36299:case 36307:return j5;case 35680:case 36300:case 36308:case 36293:return X5;case 36289:case 36303:case 36311:case 36292:return $5}}function Y5(A,r,l){this.id=A,this.addr=l,this.cache=[],this.setValue=C5(r.type)}function gE(A,r,l){this.id=A,this.addr=l,this.cache=[],this.size=r.size,this.setValue=q5(r.type)}gE.prototype.updateCache=function(A){const r=this.cache;A instanceof Float32Array&&r.length!==A.length&&(this.cache=new Float32Array(A.length)),Is(r,A)};function vE(A){this.id=A,this.seq=[],this.map={}}vE.prototype.setValue=function(A,r,l){const d=this.seq;for(let v=0,w=d.length;v!==w;++v){const C=d[v];C.setValue(A,r[C.id],l)}};const O1=/(\w+)(\])?(\[|\.)?/g;function yE(A,r){A.seq.push(r),A.map[r.id]=r}function Q5(A,r,l){const d=A.name,v=d.length;for(O1.lastIndex=0;;){const w=O1.exec(d),C=O1.lastIndex;let O=w[1];const z=w[2]==="]",H=w[3];if(z&&(O=O|0),H===void 0||H==="["&&C+2===v){yE(l,H===void 0?new Y5(O,A,r):new gE(O,A,r));break}else{let re=l.map[O];re===void 0&&(re=new vE(O),yE(l,re)),l=re}}}function sc(A,r){this.seq=[],this.map={};const l=A.getProgramParameter(r,A.ACTIVE_UNIFORMS);for(let d=0;d<l;++d){const v=A.getActiveUniform(r,d),w=A.getUniformLocation(r,v.name);Q5(v,w,this)}}sc.prototype.setValue=function(A,r,l,d){const v=this.map[r];v!==void 0&&v.setValue(A,l,d)},sc.prototype.setOptional=function(A,r,l){const d=r[l];d!==void 0&&this.setValue(A,l,d)},sc.upload=function(A,r,l,d){for(let v=0,w=r.length;v!==w;++v){const C=r[v],O=l[C.id];O.needsUpdate!==!1&&C.setValue(A,O.value,d)}},sc.seqWithValue=function(A,r){const l=[];for(let d=0,v=A.length;d!==v;++d){const w=A[d];w.id in r&&l.push(w)}return l};function xE(A,r,l){const d=A.createShader(r);return A.shaderSource(d,l),A.compileShader(d),d}let K5=0;function Z5(A){const r=A.split(`
`);for(let l=0;l<r.length;l++)r[l]=l+1+": "+r[l];return r.join(`
`)}function J5(A){switch(A){case Qi:return["Linear","( value )"];case Li:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",A),["Linear","( value )"]}}function AE(A,r,l){const d=A.getShaderParameter(r,A.COMPILE_STATUS),v=A.getShaderInfoLog(r).trim();return d&&v===""?"":l.toUpperCase()+`

`+v+`

`+Z5(A.getShaderSource(r))}function eD(A,r){const l=J5(r);return"vec4 "+A+"( vec4 value ) { return LinearTo"+l[0]+l[1]+"; }"}function tD(A,r){let l;switch(r){case Oe:l="Linear";break;case Le:l="Reinhard";break;case ce:l="OptimizedCineon";break;case he:l="ACESFilmic";break;case ie:l="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",r),l="Linear"}return"vec3 "+A+"( vec3 color ) { return "+l+"ToneMapping( color ); }"}function nD(A){return[A.extensionDerivatives||A.envMapCubeUV||A.bumpMap||A.tangentSpaceNormalMap||A.clearcoatNormalMap||A.flatShading||A.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(A.extensionFragDepth||A.logarithmicDepthBuffer)&&A.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",A.extensionDrawBuffers&&A.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(A.extensionShaderTextureLOD||A.envMap||A.transmission)&&A.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(lp).join(`
`)}function iD(A){const r=[];for(const l in A){const d=A[l];d!==!1&&r.push("#define "+l+" "+d)}return r.join(`
`)}function rD(A,r){const l={},d=A.getProgramParameter(r,A.ACTIVE_ATTRIBUTES);for(let v=0;v<d;v++){const w=A.getActiveAttrib(r,v),C=w.name;let O=1;w.type===A.FLOAT_MAT2&&(O=2),w.type===A.FLOAT_MAT3&&(O=3),w.type===A.FLOAT_MAT4&&(O=4),l[C]={type:w.type,location:A.getAttribLocation(r,C),locationSize:O}}return l}function lp(A){return A!==""}function bE(A,r){return A.replace(/NUM_DIR_LIGHTS/g,r.numDirLights).replace(/NUM_SPOT_LIGHTS/g,r.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,r.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,r.numPointLights).replace(/NUM_HEMI_LIGHTS/g,r.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,r.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,r.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,r.numPointLightShadows)}function _E(A,r){return A.replace(/NUM_CLIPPING_PLANES/g,r.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,r.numClippingPlanes-r.numClipIntersection)}const sD=/^[ \t]*#include +<([\w\d./]+)>/gm;function D1(A){return A.replace(sD,oD)}function oD(A,r){const l=Bi[r];if(l===void 0)throw new Error("Can not resolve #include <"+r+">");return D1(l)}const aD=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,lD=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function wE(A){return A.replace(lD,EE).replace(aD,cD)}function cD(A,r,l,d){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),EE(A,r,l,d)}function EE(A,r,l,d){let v="";for(let w=parseInt(r);w<parseInt(l);w++)v+=d.replace(/\[\s*i\s*\]/g,"[ "+w+" ]").replace(/UNROLLED_LOOP_INDEX/g,w);return v}function ME(A){let r="precision "+A.precision+` float;
precision `+A.precision+" int;";return A.precision==="highp"?r+=`
#define HIGH_PRECISION`:A.precision==="mediump"?r+=`
#define MEDIUM_PRECISION`:A.precision==="lowp"&&(r+=`
#define LOW_PRECISION`),r}function uD(A){let r="SHADOWMAP_TYPE_BASIC";return A.shadowMapType===_?r="SHADOWMAP_TYPE_PCF":A.shadowMapType===x?r="SHADOWMAP_TYPE_PCF_SOFT":A.shadowMapType===b&&(r="SHADOWMAP_TYPE_VSM"),r}function hD(A){let r="ENVMAP_TYPE_CUBE";if(A.envMap)switch(A.envMapMode){case Z:case B:r="ENVMAP_TYPE_CUBE";break;case X:case xe:r="ENVMAP_TYPE_CUBE_UV";break}return r}function fD(A){let r="ENVMAP_MODE_REFLECTION";if(A.envMap)switch(A.envMapMode){case B:case xe:r="ENVMAP_MODE_REFRACTION";break}return r}function dD(A){let r="ENVMAP_BLENDING_NONE";if(A.envMap)switch(A.combine){case Je:r="ENVMAP_BLENDING_MULTIPLY";break;case We:r="ENVMAP_BLENDING_MIX";break;case _e:r="ENVMAP_BLENDING_ADD";break}return r}function pD(A,r,l,d){const v=A.getContext(),w=l.defines;let C=l.vertexShader,O=l.fragmentShader;const z=uD(l),H=hD(l),ne=fD(l),re=dD(l),se=l.isWebGL2?"":nD(l),oe=iD(w),ve=v.createProgram();let Te,Fe,Ae=l.glslVersion?"#version "+l.glslVersion+`
`:"";l.isRawShaderMaterial?(Te=[oe].filter(lp).join(`
`),Te.length>0&&(Te+=`
`),Fe=[se,oe].filter(lp).join(`
`),Fe.length>0&&(Fe+=`
`)):(Te=[ME(l),"#define SHADER_NAME "+l.shaderName,oe,l.instancing?"#define USE_INSTANCING":"",l.instancingColor?"#define USE_INSTANCING_COLOR":"",l.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define MAX_BONES "+l.maxBones,l.useFog&&l.fog?"#define USE_FOG":"",l.useFog&&l.fogExp2?"#define FOG_EXP2":"",l.map?"#define USE_MAP":"",l.envMap?"#define USE_ENVMAP":"",l.envMap?"#define "+ne:"",l.lightMap?"#define USE_LIGHTMAP":"",l.aoMap?"#define USE_AOMAP":"",l.emissiveMap?"#define USE_EMISSIVEMAP":"",l.bumpMap?"#define USE_BUMPMAP":"",l.normalMap?"#define USE_NORMALMAP":"",l.normalMap&&l.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",l.normalMap&&l.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",l.clearcoatMap?"#define USE_CLEARCOATMAP":"",l.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",l.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",l.displacementMap&&l.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",l.specularMap?"#define USE_SPECULARMAP":"",l.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",l.specularColorMap?"#define USE_SPECULARCOLORMAP":"",l.roughnessMap?"#define USE_ROUGHNESSMAP":"",l.metalnessMap?"#define USE_METALNESSMAP":"",l.alphaMap?"#define USE_ALPHAMAP":"",l.transmission?"#define USE_TRANSMISSION":"",l.transmissionMap?"#define USE_TRANSMISSIONMAP":"",l.thicknessMap?"#define USE_THICKNESSMAP":"",l.sheenColorMap?"#define USE_SHEENCOLORMAP":"",l.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",l.vertexTangents?"#define USE_TANGENT":"",l.vertexColors?"#define USE_COLOR":"",l.vertexAlphas?"#define USE_COLOR_ALPHA":"",l.vertexUvs?"#define USE_UV":"",l.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",l.flatShading?"#define FLAT_SHADED":"",l.skinning?"#define USE_SKINNING":"",l.useVertexTexture?"#define BONE_TEXTURE":"",l.morphTargets?"#define USE_MORPHTARGETS":"",l.morphNormals&&l.flatShading===!1?"#define USE_MORPHNORMALS":"",l.morphTargets&&l.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",l.morphTargets&&l.isWebGL2?"#define MORPHTARGETS_COUNT "+l.morphTargetsCount:"",l.doubleSided?"#define DOUBLE_SIDED":"",l.flipSided?"#define FLIP_SIDED":"",l.shadowMapEnabled?"#define USE_SHADOWMAP":"",l.shadowMapEnabled?"#define "+z:"",l.sizeAttenuation?"#define USE_SIZEATTENUATION":"",l.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",l.logarithmicDepthBuffer&&l.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(lp).join(`
`),Fe=[se,ME(l),"#define SHADER_NAME "+l.shaderName,oe,l.useFog&&l.fog?"#define USE_FOG":"",l.useFog&&l.fogExp2?"#define FOG_EXP2":"",l.map?"#define USE_MAP":"",l.matcap?"#define USE_MATCAP":"",l.envMap?"#define USE_ENVMAP":"",l.envMap?"#define "+H:"",l.envMap?"#define "+ne:"",l.envMap?"#define "+re:"",l.lightMap?"#define USE_LIGHTMAP":"",l.aoMap?"#define USE_AOMAP":"",l.emissiveMap?"#define USE_EMISSIVEMAP":"",l.bumpMap?"#define USE_BUMPMAP":"",l.normalMap?"#define USE_NORMALMAP":"",l.normalMap&&l.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",l.normalMap&&l.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",l.clearcoat?"#define USE_CLEARCOAT":"",l.clearcoatMap?"#define USE_CLEARCOATMAP":"",l.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",l.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",l.specularMap?"#define USE_SPECULARMAP":"",l.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",l.specularColorMap?"#define USE_SPECULARCOLORMAP":"",l.roughnessMap?"#define USE_ROUGHNESSMAP":"",l.metalnessMap?"#define USE_METALNESSMAP":"",l.alphaMap?"#define USE_ALPHAMAP":"",l.alphaTest?"#define USE_ALPHATEST":"",l.sheen?"#define USE_SHEEN":"",l.sheenColorMap?"#define USE_SHEENCOLORMAP":"",l.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",l.transmission?"#define USE_TRANSMISSION":"",l.transmissionMap?"#define USE_TRANSMISSIONMAP":"",l.thicknessMap?"#define USE_THICKNESSMAP":"",l.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",l.vertexTangents?"#define USE_TANGENT":"",l.vertexColors||l.instancingColor?"#define USE_COLOR":"",l.vertexAlphas?"#define USE_COLOR_ALPHA":"",l.vertexUvs?"#define USE_UV":"",l.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",l.gradientMap?"#define USE_GRADIENTMAP":"",l.flatShading?"#define FLAT_SHADED":"",l.doubleSided?"#define DOUBLE_SIDED":"",l.flipSided?"#define FLIP_SIDED":"",l.shadowMapEnabled?"#define USE_SHADOWMAP":"",l.shadowMapEnabled?"#define "+z:"",l.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",l.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",l.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",l.logarithmicDepthBuffer&&l.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"",(l.extensionShaderTextureLOD||l.envMap)&&l.rendererExtensionShaderTextureLod?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",l.toneMapping!==Ee?"#define TONE_MAPPING":"",l.toneMapping!==Ee?Bi.tonemapping_pars_fragment:"",l.toneMapping!==Ee?tD("toneMapping",l.toneMapping):"",l.dithering?"#define DITHERING":"",l.alphaWrite?"":"#define OPAQUE",Bi.encodings_pars_fragment,eD("linearToOutputTexel",l.outputEncoding),l.depthPacking?"#define DEPTH_PACKING "+l.depthPacking:"",`
`].filter(lp).join(`
`)),C=D1(C),C=bE(C,l),C=_E(C,l),O=D1(O),O=bE(O,l),O=_E(O,l),C=wE(C),O=wE(O),l.isWebGL2&&l.isRawShaderMaterial!==!0&&(Ae=`#version 300 es
`,Te=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+Te,Fe=["#define varying in",l.glslVersion===i1?"":"layout(location = 0) out highp vec4 pc_fragColor;",l.glslVersion===i1?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+Fe);const ue=Ae+Te+C,Ve=Ae+Fe+O,ke=xE(v,v.VERTEX_SHADER,ue),je=xE(v,v.FRAGMENT_SHADER,Ve);if(v.attachShader(ve,ke),v.attachShader(ve,je),l.index0AttributeName!==void 0?v.bindAttribLocation(ve,0,l.index0AttributeName):l.morphTargets===!0&&v.bindAttribLocation(ve,0,"position"),v.linkProgram(ve),A.debug.checkShaderErrors){const Et=v.getProgramInfoLog(ve).trim(),Xt=v.getShaderInfoLog(ke).trim(),Ht=v.getShaderInfoLog(je).trim();let Ne=!0,ct=!0;if(v.getProgramParameter(ve,v.LINK_STATUS)===!1){Ne=!1;const It=AE(v,ke,"vertex"),Nt=AE(v,je,"fragment");console.error("THREE.WebGLProgram: Shader Error "+v.getError()+" - VALIDATE_STATUS "+v.getProgramParameter(ve,v.VALIDATE_STATUS)+`

Program Info Log: `+Et+`
`+It+`
`+Nt)}else Et!==""?console.warn("THREE.WebGLProgram: Program Info Log:",Et):(Xt===""||Ht==="")&&(ct=!1);ct&&(this.diagnostics={runnable:Ne,programLog:Et,vertexShader:{log:Xt,prefix:Te},fragmentShader:{log:Ht,prefix:Fe}})}v.deleteShader(ke),v.deleteShader(je);let st;this.getUniforms=function(){return st===void 0&&(st=new sc(v,ve)),st};let At;return this.getAttributes=function(){return At===void 0&&(At=rD(v,ve)),At},this.destroy=function(){d.releaseStatesOfProgram(this),v.deleteProgram(ve),this.program=void 0},this.name=l.shaderName,this.id=K5++,this.cacheKey=r,this.usedTimes=1,this.program=ve,this.vertexShader=ke,this.fragmentShader=je,this}let mD=0;class gD{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(r){const l=r.vertexShader,d=r.fragmentShader,v=this._getShaderStage(l),w=this._getShaderStage(d),C=this._getShaderCacheForMaterial(r);return C.has(v)===!1&&(C.add(v),v.usedTimes++),C.has(w)===!1&&(C.add(w),w.usedTimes++),this}remove(r){const l=this.materialCache.get(r);for(const d of l)d.usedTimes--,d.usedTimes===0&&this.shaderCache.delete(d);return this.materialCache.delete(r),this}getVertexShaderID(r){return this._getShaderStage(r.vertexShader).id}getFragmentShaderID(r){return this._getShaderStage(r.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(r){const l=this.materialCache;return l.has(r)===!1&&l.set(r,new Set),l.get(r)}_getShaderStage(r){const l=this.shaderCache;if(l.has(r)===!1){const d=new vD;l.set(r,d)}return l.get(r)}}class vD{constructor(){this.id=mD++,this.usedTimes=0}}function yD(A,r,l,d,v,w,C){const O=new i0,z=new gD,H=[],ne=v.isWebGL2,re=v.logarithmicDepthBuffer,se=v.floatVertexTextures,oe=v.maxVertexUniforms,ve=v.vertexTextures;let Te=v.precision;const Fe={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function Ae(Ne){const It=Ne.skeleton.bones;if(se)return 1024;{const Pt=Math.floor((oe-20)/4),Gt=Math.min(Pt,It.length);return Gt<It.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+It.length+" bones. This GPU supports "+Gt+"."),0):Gt}}function ue(Ne,ct,It,Nt,Pt){const Gt=Nt.fog,sn=Ne.isMeshStandardMaterial?Nt.environment:null,bn=(Ne.isMeshStandardMaterial?l:r).get(Ne.envMap||sn),kn=Fe[Ne.type],si=Pt.isSkinnedMesh?Ae(Pt):0;Ne.precision!==null&&(Te=v.getMaxPrecision(Ne.precision),Te!==Ne.precision&&console.warn("THREE.WebGLProgram.getParameters:",Ne.precision,"not supported, using",Te,"instead."));let Vn,fn,Pn,li;if(kn){const Wn=Qo[kn];Vn=Wn.vertexShader,fn=Wn.fragmentShader}else Vn=Ne.vertexShader,fn=Ne.fragmentShader,z.update(Ne),Pn=z.getVertexShaderID(Ne),li=z.getFragmentShaderID(Ne);const Mt=A.getRenderTarget(),fi=Ne.alphaTest>0,Qn=Ne.clearcoat>0;return{isWebGL2:ne,shaderID:kn,shaderName:Ne.type,vertexShader:Vn,fragmentShader:fn,defines:Ne.defines,customVertexShaderID:Pn,customFragmentShaderID:li,isRawShaderMaterial:Ne.isRawShaderMaterial===!0,glslVersion:Ne.glslVersion,precision:Te,instancing:Pt.isInstancedMesh===!0,instancingColor:Pt.isInstancedMesh===!0&&Pt.instanceColor!==null,supportsVertexTextures:ve,outputEncoding:Mt===null?A.outputEncoding:Mt.isXRRenderTarget===!0?Mt.texture.encoding:Qi,map:!!Ne.map,matcap:!!Ne.matcap,envMap:!!bn,envMapMode:bn&&bn.mapping,envMapCubeUV:!!bn&&(bn.mapping===X||bn.mapping===xe),lightMap:!!Ne.lightMap,aoMap:!!Ne.aoMap,emissiveMap:!!Ne.emissiveMap,bumpMap:!!Ne.bumpMap,normalMap:!!Ne.normalMap,objectSpaceNormalMap:Ne.normalMapType===Ls,tangentSpaceNormalMap:Ne.normalMapType===Fr,decodeVideoTexture:!!Ne.map&&Ne.map.isVideoTexture===!0&&Ne.map.encoding===Li,clearcoat:Qn,clearcoatMap:Qn&&!!Ne.clearcoatMap,clearcoatRoughnessMap:Qn&&!!Ne.clearcoatRoughnessMap,clearcoatNormalMap:Qn&&!!Ne.clearcoatNormalMap,displacementMap:!!Ne.displacementMap,roughnessMap:!!Ne.roughnessMap,metalnessMap:!!Ne.metalnessMap,specularMap:!!Ne.specularMap,specularIntensityMap:!!Ne.specularIntensityMap,specularColorMap:!!Ne.specularColorMap,alphaMap:!!Ne.alphaMap,alphaTest:fi,alphaWrite:Ne.alphaWrite||Ne.transparent,gradientMap:!!Ne.gradientMap,sheen:Ne.sheen>0,sheenColorMap:!!Ne.sheenColorMap,sheenRoughnessMap:!!Ne.sheenRoughnessMap,transmission:Ne.transmission>0,transmissionMap:!!Ne.transmissionMap,thicknessMap:!!Ne.thicknessMap,combine:Ne.combine,vertexTangents:!!Ne.normalMap&&!!Pt.geometry&&!!Pt.geometry.attributes.tangent,vertexColors:Ne.vertexColors,vertexAlphas:Ne.vertexColors===!0&&!!Pt.geometry&&!!Pt.geometry.attributes.color&&Pt.geometry.attributes.color.itemSize===4,vertexUvs:!!Ne.map||!!Ne.bumpMap||!!Ne.normalMap||!!Ne.specularMap||!!Ne.alphaMap||!!Ne.emissiveMap||!!Ne.roughnessMap||!!Ne.metalnessMap||!!Ne.clearcoatMap||!!Ne.clearcoatRoughnessMap||!!Ne.clearcoatNormalMap||!!Ne.displacementMap||!!Ne.transmissionMap||!!Ne.thicknessMap||!!Ne.specularIntensityMap||!!Ne.specularColorMap||!!Ne.sheenColorMap||!!Ne.sheenRoughnessMap,uvsVertexOnly:!(!!Ne.map||!!Ne.bumpMap||!!Ne.normalMap||!!Ne.specularMap||!!Ne.alphaMap||!!Ne.emissiveMap||!!Ne.roughnessMap||!!Ne.metalnessMap||!!Ne.clearcoatNormalMap||Ne.transmission>0||!!Ne.transmissionMap||!!Ne.thicknessMap||!!Ne.specularIntensityMap||!!Ne.specularColorMap||Ne.sheen>0||!!Ne.sheenColorMap||!!Ne.sheenRoughnessMap)&&!!Ne.displacementMap,fog:!!Gt,useFog:Ne.fog,fogExp2:Gt&&Gt.isFogExp2,flatShading:!!Ne.flatShading,sizeAttenuation:Ne.sizeAttenuation,logarithmicDepthBuffer:re,skinning:Pt.isSkinnedMesh===!0&&si>0,maxBones:si,useVertexTexture:se,morphTargets:!!Pt.geometry&&!!Pt.geometry.morphAttributes.position,morphNormals:!!Pt.geometry&&!!Pt.geometry.morphAttributes.normal,morphTargetsCount:!!Pt.geometry&&!!Pt.geometry.morphAttributes.position?Pt.geometry.morphAttributes.position.length:0,numDirLights:ct.directional.length,numPointLights:ct.point.length,numSpotLights:ct.spot.length,numRectAreaLights:ct.rectArea.length,numHemiLights:ct.hemi.length,numDirLightShadows:ct.directionalShadowMap.length,numPointLightShadows:ct.pointShadowMap.length,numSpotLightShadows:ct.spotShadowMap.length,numClippingPlanes:C.numPlanes,numClipIntersection:C.numIntersection,dithering:Ne.dithering,shadowMapEnabled:A.shadowMap.enabled&&It.length>0,shadowMapType:A.shadowMap.type,toneMapping:Ne.toneMapped?A.toneMapping:Ee,physicallyCorrectLights:A.physicallyCorrectLights,premultipliedAlpha:Ne.premultipliedAlpha,doubleSided:Ne.side===P,flipSided:Ne.side===T,depthPacking:Ne.depthPacking!==void 0?Ne.depthPacking:!1,index0AttributeName:Ne.index0AttributeName,extensionDerivatives:Ne.extensions&&Ne.extensions.derivatives,extensionFragDepth:Ne.extensions&&Ne.extensions.fragDepth,extensionDrawBuffers:Ne.extensions&&Ne.extensions.drawBuffers,extensionShaderTextureLOD:Ne.extensions&&Ne.extensions.shaderTextureLOD,rendererExtensionFragDepth:ne||d.has("EXT_frag_depth"),rendererExtensionDrawBuffers:ne||d.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:ne||d.has("EXT_shader_texture_lod"),customProgramCacheKey:Ne.customProgramCacheKey()}}function Ve(Ne){const ct=[];if(Ne.shaderID?ct.push(Ne.shaderID):(ct.push(Ne.customVertexShaderID),ct.push(Ne.customFragmentShaderID)),Ne.defines!==void 0)for(const It in Ne.defines)ct.push(It),ct.push(Ne.defines[It]);return Ne.isRawShaderMaterial===!1&&(ke(ct,Ne),je(ct,Ne),ct.push(A.outputEncoding)),ct.push(Ne.customProgramCacheKey),ct.join()}function ke(Ne,ct){Ne.push(ct.precision),Ne.push(ct.outputEncoding),Ne.push(ct.envMapMode),Ne.push(ct.combine),Ne.push(ct.vertexUvs),Ne.push(ct.fogExp2),Ne.push(ct.sizeAttenuation),Ne.push(ct.maxBones),Ne.push(ct.morphTargetsCount),Ne.push(ct.numDirLights),Ne.push(ct.numPointLights),Ne.push(ct.numSpotLights),Ne.push(ct.numHemiLights),Ne.push(ct.numRectAreaLights),Ne.push(ct.numDirLightShadows),Ne.push(ct.numPointLightShadows),Ne.push(ct.numSpotLightShadows),Ne.push(ct.shadowMapType),Ne.push(ct.toneMapping),Ne.push(ct.numClippingPlanes),Ne.push(ct.numClipIntersection),Ne.push(ct.alphaWrite)}function je(Ne,ct){O.disableAll(),ct.isWebGL2&&O.enable(0),ct.supportsVertexTextures&&O.enable(1),ct.instancing&&O.enable(2),ct.instancingColor&&O.enable(3),ct.map&&O.enable(4),ct.matcap&&O.enable(5),ct.envMap&&O.enable(6),ct.envMapCubeUV&&O.enable(7),ct.lightMap&&O.enable(8),ct.aoMap&&O.enable(9),ct.emissiveMap&&O.enable(10),ct.bumpMap&&O.enable(11),ct.normalMap&&O.enable(12),ct.objectSpaceNormalMap&&O.enable(13),ct.tangentSpaceNormalMap&&O.enable(14),ct.clearcoat&&O.enable(15),ct.clearcoatMap&&O.enable(16),ct.clearcoatRoughnessMap&&O.enable(17),ct.clearcoatNormalMap&&O.enable(18),ct.displacementMap&&O.enable(19),ct.specularMap&&O.enable(20),ct.roughnessMap&&O.enable(21),ct.metalnessMap&&O.enable(22),ct.gradientMap&&O.enable(23),ct.alphaMap&&O.enable(24),ct.alphaTest&&O.enable(25),ct.vertexColors&&O.enable(26),ct.vertexAlphas&&O.enable(27),ct.vertexUvs&&O.enable(28),ct.vertexTangents&&O.enable(29),ct.uvsVertexOnly&&O.enable(30),ct.fog&&O.enable(31),Ne.push(O.mask),O.disableAll(),ct.useFog&&O.enable(0),ct.flatShading&&O.enable(1),ct.logarithmicDepthBuffer&&O.enable(2),ct.skinning&&O.enable(3),ct.useVertexTexture&&O.enable(4),ct.morphTargets&&O.enable(5),ct.morphNormals&&O.enable(6),ct.premultipliedAlpha&&O.enable(7),ct.shadowMapEnabled&&O.enable(8),ct.physicallyCorrectLights&&O.enable(9),ct.doubleSided&&O.enable(10),ct.flipSided&&O.enable(11),ct.depthPacking&&O.enable(12),ct.dithering&&O.enable(13),ct.specularIntensityMap&&O.enable(14),ct.specularColorMap&&O.enable(15),ct.transmission&&O.enable(16),ct.transmissionMap&&O.enable(17),ct.thicknessMap&&O.enable(18),ct.sheen&&O.enable(19),ct.sheenColorMap&&O.enable(20),ct.sheenRoughnessMap&&O.enable(21),ct.decodeVideoTexture&&O.enable(22),Ne.push(O.mask)}function st(Ne){const ct=Fe[Ne.type];let It;if(ct){const Nt=Qo[ct];It=Kw.clone(Nt.uniforms)}else It=Ne.uniforms;return It}function At(Ne,ct){let It;for(let Nt=0,Pt=H.length;Nt<Pt;Nt++){const Gt=H[Nt];if(Gt.cacheKey===ct){It=Gt,++It.usedTimes;break}}return It===void 0&&(It=new pD(A,ct,Ne,w),H.push(It)),It}function Et(Ne){if(--Ne.usedTimes===0){const ct=H.indexOf(Ne);H[ct]=H[H.length-1],H.pop(),Ne.destroy()}}function Xt(Ne){z.remove(Ne)}function Ht(){z.dispose()}return{getParameters:ue,getProgramCacheKey:Ve,getUniforms:st,acquireProgram:At,releaseProgram:Et,releaseShaderCache:Xt,programs:H,dispose:Ht}}function xD(){let A=new WeakMap;function r(w){let C=A.get(w);return C===void 0&&(C={},A.set(w,C)),C}function l(w){A.delete(w)}function d(w,C,O){A.get(w)[C]=O}function v(){A=new WeakMap}return{get:r,remove:l,update:d,dispose:v}}function AD(A,r){return A.groupOrder!==r.groupOrder?A.groupOrder-r.groupOrder:A.renderOrder!==r.renderOrder?A.renderOrder-r.renderOrder:A.material.id!==r.material.id?A.material.id-r.material.id:A.z!==r.z?A.z-r.z:A.id-r.id}function SE(A,r){return A.groupOrder!==r.groupOrder?A.groupOrder-r.groupOrder:A.renderOrder!==r.renderOrder?A.renderOrder-r.renderOrder:A.z!==r.z?r.z-A.z:A.id-r.id}function TE(){const A=[];let r=0;const l=[],d=[],v=[];function w(){r=0,l.length=0,d.length=0,v.length=0}function C(re,se,oe,ve,Te,Fe){let Ae=A[r];return Ae===void 0?(Ae={id:re.id,object:re,geometry:se,material:oe,groupOrder:ve,renderOrder:re.renderOrder,z:Te,group:Fe},A[r]=Ae):(Ae.id=re.id,Ae.object=re,Ae.geometry=se,Ae.material=oe,Ae.groupOrder=ve,Ae.renderOrder=re.renderOrder,Ae.z=Te,Ae.group=Fe),r++,Ae}function O(re,se,oe,ve,Te,Fe){const Ae=C(re,se,oe,ve,Te,Fe);oe.transmission>0?d.push(Ae):oe.transparent===!0?v.push(Ae):l.push(Ae)}function z(re,se,oe,ve,Te,Fe){const Ae=C(re,se,oe,ve,Te,Fe);oe.transmission>0?d.unshift(Ae):oe.transparent===!0?v.unshift(Ae):l.unshift(Ae)}function H(re,se){l.length>1&&l.sort(re||AD),d.length>1&&d.sort(se||SE),v.length>1&&v.sort(se||SE)}function ne(){for(let re=r,se=A.length;re<se;re++){const oe=A[re];if(oe.id===null)break;oe.id=null,oe.object=null,oe.geometry=null,oe.material=null,oe.group=null}}return{opaque:l,transmissive:d,transparent:v,init:w,push:O,unshift:z,finish:ne,sort:H}}function bD(){let A=new WeakMap;function r(d,v){let w;return A.has(d)===!1?(w=new TE,A.set(d,[w])):v>=A.get(d).length?(w=new TE,A.get(d).push(w)):w=A.get(d)[v],w}function l(){A=new WeakMap}return{get:r,dispose:l}}function _D(){const A={};return{get:function(r){if(A[r.id]!==void 0)return A[r.id];let l;switch(r.type){case"DirectionalLight":l={direction:new qe,color:new Un};break;case"SpotLight":l={position:new qe,direction:new qe,color:new Un,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":l={position:new qe,color:new Un,distance:0,decay:0};break;case"HemisphereLight":l={direction:new qe,skyColor:new Un,groundColor:new Un};break;case"RectAreaLight":l={color:new Un,position:new qe,halfWidth:new qe,halfHeight:new qe};break}return A[r.id]=l,l}}}function wD(){const A={};return{get:function(r){if(A[r.id]!==void 0)return A[r.id];let l;switch(r.type){case"DirectionalLight":l={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new pn};break;case"SpotLight":l={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new pn};break;case"PointLight":l={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new pn,shadowCameraNear:1,shadowCameraFar:1e3};break}return A[r.id]=l,l}}}let ED=0;function MD(A,r){return(r.castShadow?1:0)-(A.castShadow?1:0)}function SD(A,r){const l=new _D,d=wD(),v={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let ne=0;ne<9;ne++)v.probe.push(new qe);const w=new qe,C=new Jn,O=new Jn;function z(ne,re){let se=0,oe=0,ve=0;for(let Xt=0;Xt<9;Xt++)v.probe[Xt].set(0,0,0);let Te=0,Fe=0,Ae=0,ue=0,Ve=0,ke=0,je=0,st=0;ne.sort(MD);const At=re!==!0?Math.PI:1;for(let Xt=0,Ht=ne.length;Xt<Ht;Xt++){const Ne=ne[Xt],ct=Ne.color,It=Ne.intensity,Nt=Ne.distance,Pt=Ne.shadow&&Ne.shadow.map?Ne.shadow.map.texture:null;if(Ne.isAmbientLight)se+=ct.r*It*At,oe+=ct.g*It*At,ve+=ct.b*It*At;else if(Ne.isLightProbe)for(let Gt=0;Gt<9;Gt++)v.probe[Gt].addScaledVector(Ne.sh.coefficients[Gt],It);else if(Ne.isDirectionalLight){const Gt=l.get(Ne);if(Gt.color.copy(Ne.color).multiplyScalar(Ne.intensity*At),Ne.castShadow){const sn=Ne.shadow,bn=d.get(Ne);bn.shadowBias=sn.bias,bn.shadowNormalBias=sn.normalBias,bn.shadowRadius=sn.radius,bn.shadowMapSize=sn.mapSize,v.directionalShadow[Te]=bn,v.directionalShadowMap[Te]=Pt,v.directionalShadowMatrix[Te]=Ne.shadow.matrix,ke++}v.directional[Te]=Gt,Te++}else if(Ne.isSpotLight){const Gt=l.get(Ne);if(Gt.position.setFromMatrixPosition(Ne.matrixWorld),Gt.color.copy(ct).multiplyScalar(It*At),Gt.distance=Nt,Gt.coneCos=Math.cos(Ne.angle),Gt.penumbraCos=Math.cos(Ne.angle*(1-Ne.penumbra)),Gt.decay=Ne.decay,Ne.castShadow){const sn=Ne.shadow,bn=d.get(Ne);bn.shadowBias=sn.bias,bn.shadowNormalBias=sn.normalBias,bn.shadowRadius=sn.radius,bn.shadowMapSize=sn.mapSize,v.spotShadow[Ae]=bn,v.spotShadowMap[Ae]=Pt,v.spotShadowMatrix[Ae]=Ne.shadow.matrix,st++}v.spot[Ae]=Gt,Ae++}else if(Ne.isRectAreaLight){const Gt=l.get(Ne);Gt.color.copy(ct).multiplyScalar(It),Gt.halfWidth.set(Ne.width*.5,0,0),Gt.halfHeight.set(0,Ne.height*.5,0),v.rectArea[ue]=Gt,ue++}else if(Ne.isPointLight){const Gt=l.get(Ne);if(Gt.color.copy(Ne.color).multiplyScalar(Ne.intensity*At),Gt.distance=Ne.distance,Gt.decay=Ne.decay,Ne.castShadow){const sn=Ne.shadow,bn=d.get(Ne);bn.shadowBias=sn.bias,bn.shadowNormalBias=sn.normalBias,bn.shadowRadius=sn.radius,bn.shadowMapSize=sn.mapSize,bn.shadowCameraNear=sn.camera.near,bn.shadowCameraFar=sn.camera.far,v.pointShadow[Fe]=bn,v.pointShadowMap[Fe]=Pt,v.pointShadowMatrix[Fe]=Ne.shadow.matrix,je++}v.point[Fe]=Gt,Fe++}else if(Ne.isHemisphereLight){const Gt=l.get(Ne);Gt.skyColor.copy(Ne.color).multiplyScalar(It*At),Gt.groundColor.copy(Ne.groundColor).multiplyScalar(It*At),v.hemi[Ve]=Gt,Ve++}}ue>0&&(r.isWebGL2||A.has("OES_texture_float_linear")===!0?(v.rectAreaLTC1=Bn.LTC_FLOAT_1,v.rectAreaLTC2=Bn.LTC_FLOAT_2):A.has("OES_texture_half_float_linear")===!0?(v.rectAreaLTC1=Bn.LTC_HALF_1,v.rectAreaLTC2=Bn.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),v.ambient[0]=se,v.ambient[1]=oe,v.ambient[2]=ve;const Et=v.hash;(Et.directionalLength!==Te||Et.pointLength!==Fe||Et.spotLength!==Ae||Et.rectAreaLength!==ue||Et.hemiLength!==Ve||Et.numDirectionalShadows!==ke||Et.numPointShadows!==je||Et.numSpotShadows!==st)&&(v.directional.length=Te,v.spot.length=Ae,v.rectArea.length=ue,v.point.length=Fe,v.hemi.length=Ve,v.directionalShadow.length=ke,v.directionalShadowMap.length=ke,v.pointShadow.length=je,v.pointShadowMap.length=je,v.spotShadow.length=st,v.spotShadowMap.length=st,v.directionalShadowMatrix.length=ke,v.pointShadowMatrix.length=je,v.spotShadowMatrix.length=st,Et.directionalLength=Te,Et.pointLength=Fe,Et.spotLength=Ae,Et.rectAreaLength=ue,Et.hemiLength=Ve,Et.numDirectionalShadows=ke,Et.numPointShadows=je,Et.numSpotShadows=st,v.version=ED++)}function H(ne,re){let se=0,oe=0,ve=0,Te=0,Fe=0;const Ae=re.matrixWorldInverse;for(let ue=0,Ve=ne.length;ue<Ve;ue++){const ke=ne[ue];if(ke.isDirectionalLight){const je=v.directional[se];je.direction.setFromMatrixPosition(ke.matrixWorld),w.setFromMatrixPosition(ke.target.matrixWorld),je.direction.sub(w),je.direction.transformDirection(Ae),se++}else if(ke.isSpotLight){const je=v.spot[ve];je.position.setFromMatrixPosition(ke.matrixWorld),je.position.applyMatrix4(Ae),je.direction.setFromMatrixPosition(ke.matrixWorld),w.setFromMatrixPosition(ke.target.matrixWorld),je.direction.sub(w),je.direction.transformDirection(Ae),ve++}else if(ke.isRectAreaLight){const je=v.rectArea[Te];je.position.setFromMatrixPosition(ke.matrixWorld),je.position.applyMatrix4(Ae),O.identity(),C.copy(ke.matrixWorld),C.premultiply(Ae),O.extractRotation(C),je.halfWidth.set(ke.width*.5,0,0),je.halfHeight.set(0,ke.height*.5,0),je.halfWidth.applyMatrix4(O),je.halfHeight.applyMatrix4(O),Te++}else if(ke.isPointLight){const je=v.point[oe];je.position.setFromMatrixPosition(ke.matrixWorld),je.position.applyMatrix4(Ae),oe++}else if(ke.isHemisphereLight){const je=v.hemi[Fe];je.direction.setFromMatrixPosition(ke.matrixWorld),je.direction.transformDirection(Ae),je.direction.normalize(),Fe++}}}return{setup:z,setupView:H,state:v}}function CE(A,r){const l=new SD(A,r),d=[],v=[];function w(){d.length=0,v.length=0}function C(re){d.push(re)}function O(re){v.push(re)}function z(re){l.setup(d,re)}function H(re){l.setupView(d,re)}return{init:w,state:{lightsArray:d,shadowsArray:v,lights:l},setupLights:z,setupLightsView:H,pushLight:C,pushShadow:O}}function TD(A,r){let l=new WeakMap;function d(w,C=0){let O;return l.has(w)===!1?(O=new CE(A,r),l.set(w,[O])):C>=l.get(w).length?(O=new CE(A,r),l.get(w).push(O)):O=l.get(w)[C],O}function v(){l=new WeakMap}return{get:d,dispose:v}}class w0 extends as{constructor(r){super(),this.type="MeshDepthMaterial",this.depthPacking=Cs,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.setValues(r)}copy(r){return super.copy(r),this.depthPacking=r.depthPacking,this.map=r.map,this.alphaMap=r.alphaMap,this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this}}w0.prototype.isMeshDepthMaterial=!0;class E0 extends as{constructor(r){super(),this.type="MeshDistanceMaterial",this.referencePosition=new qe,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.setValues(r)}copy(r){return super.copy(r),this.referencePosition.copy(r.referencePosition),this.nearDistance=r.nearDistance,this.farDistance=r.farDistance,this.map=r.map,this.alphaMap=r.alphaMap,this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this}}E0.prototype.isMeshDistanceMaterial=!0;const CD=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,RD=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function RE(A,r,l){let d=new sp;const v=new pn,w=new pn,C=new nr,O=new w0({depthPacking:Rs}),z=new E0,H={},ne=l.maxTextureSize,re={0:T,1:E,2:P},se=new xl({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new pn},radius:{value:4}},vertexShader:CD,fragmentShader:RD}),oe=se.clone();oe.defines.HORIZONTAL_PASS=1;const ve=new ui;ve.setAttribute("position",new Wi(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const Te=new $r(ve,se),Fe=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=_,this.render=function(ke,je,st){if(Fe.enabled===!1||Fe.autoUpdate===!1&&Fe.needsUpdate===!1||ke.length===0)return;const At=A.getRenderTarget(),Et=A.getActiveCubeFace(),Xt=A.getActiveMipmapLevel(),Ht=A.state;Ht.setBlending(k),Ht.buffers.color.setClear(1,1,1,1),Ht.buffers.depth.setTest(!0),Ht.setScissorTest(!1);for(let Ne=0,ct=ke.length;Ne<ct;Ne++){const It=ke[Ne],Nt=It.shadow;if(Nt===void 0){console.warn("THREE.WebGLShadowMap:",It,"has no shadow.");continue}if(Nt.autoUpdate===!1&&Nt.needsUpdate===!1)continue;v.copy(Nt.mapSize);const Pt=Nt.getFrameExtents();if(v.multiply(Pt),w.copy(Nt.mapSize),(v.x>ne||v.y>ne)&&(v.x>ne&&(w.x=Math.floor(ne/Pt.x),v.x=w.x*Pt.x,Nt.mapSize.x=w.x),v.y>ne&&(w.y=Math.floor(ne/Pt.y),v.y=w.y*Pt.y,Nt.mapSize.y=w.y)),Nt.map===null&&!Nt.isPointLightShadow&&this.type===b){const sn={minFilter:ut,magFilter:ut,format:Se};Nt.map=new fo(v.x,v.y,sn),Nt.map.texture.name=It.name+".shadowMap",Nt.mapPass=new fo(v.x,v.y,sn),Nt.camera.updateProjectionMatrix()}if(Nt.map===null){const sn={minFilter:at,magFilter:at,format:Se};Nt.map=new fo(v.x,v.y,sn),Nt.map.texture.name=It.name+".shadowMap",Nt.camera.updateProjectionMatrix()}A.setRenderTarget(Nt.map),A.clear();const Gt=Nt.getViewportCount();for(let sn=0;sn<Gt;sn++){const bn=Nt.getViewport(sn);C.set(w.x*bn.x,w.y*bn.y,w.x*bn.z,w.y*bn.w),Ht.viewport(C),Nt.updateMatrices(It,sn),d=Nt.getFrustum(),Ve(je,st,Nt.camera,It,this.type)}!Nt.isPointLightShadow&&this.type===b&&Ae(Nt,st),Nt.needsUpdate=!1}Fe.needsUpdate=!1,A.setRenderTarget(At,Et,Xt)};function Ae(ke,je){const st=r.update(Te);se.defines.VSM_SAMPLES!==ke.blurSamples&&(se.defines.VSM_SAMPLES=ke.blurSamples,oe.defines.VSM_SAMPLES=ke.blurSamples,se.needsUpdate=!0,oe.needsUpdate=!0),se.uniforms.shadow_pass.value=ke.map.texture,se.uniforms.resolution.value=ke.mapSize,se.uniforms.radius.value=ke.radius,A.setRenderTarget(ke.mapPass),A.clear(),A.renderBufferDirect(je,null,st,se,Te,null),oe.uniforms.shadow_pass.value=ke.mapPass.texture,oe.uniforms.resolution.value=ke.mapSize,oe.uniforms.radius.value=ke.radius,A.setRenderTarget(ke.map),A.clear(),A.renderBufferDirect(je,null,st,oe,Te,null)}function ue(ke,je,st,At,Et,Xt,Ht){let Ne=null;const ct=At.isPointLight===!0?ke.customDistanceMaterial:ke.customDepthMaterial;if(ct!==void 0?Ne=ct:Ne=At.isPointLight===!0?z:O,A.localClippingEnabled&&st.clipShadows===!0&&st.clippingPlanes.length!==0||st.displacementMap&&st.displacementScale!==0||st.alphaMap&&st.alphaTest>0){const It=Ne.uuid,Nt=st.uuid;let Pt=H[It];Pt===void 0&&(Pt={},H[It]=Pt);let Gt=Pt[Nt];Gt===void 0&&(Gt=Ne.clone(),Pt[Nt]=Gt),Ne=Gt}return Ne.visible=st.visible,Ne.wireframe=st.wireframe,Ht===b?Ne.side=st.shadowSide!==null?st.shadowSide:st.side:Ne.side=st.shadowSide!==null?st.shadowSide:re[st.side],Ne.alphaMap=st.alphaMap,Ne.alphaTest=st.alphaTest,Ne.clipShadows=st.clipShadows,Ne.clippingPlanes=st.clippingPlanes,Ne.clipIntersection=st.clipIntersection,Ne.displacementMap=st.displacementMap,Ne.displacementScale=st.displacementScale,Ne.displacementBias=st.displacementBias,Ne.wireframeLinewidth=st.wireframeLinewidth,Ne.linewidth=st.linewidth,At.isPointLight===!0&&Ne.isMeshDistanceMaterial===!0&&(Ne.referencePosition.setFromMatrixPosition(At.matrixWorld),Ne.nearDistance=Et,Ne.farDistance=Xt),Ne}function Ve(ke,je,st,At,Et){if(ke.visible===!1)return;if(ke.layers.test(je.layers)&&(ke.isMesh||ke.isLine||ke.isPoints)&&(ke.castShadow||ke.receiveShadow&&Et===b)&&(!ke.frustumCulled||d.intersectsObject(ke))){ke.modelViewMatrix.multiplyMatrices(st.matrixWorldInverse,ke.matrixWorld);const Ne=r.update(ke),ct=ke.material;if(Array.isArray(ct)){const It=Ne.groups;for(let Nt=0,Pt=It.length;Nt<Pt;Nt++){const Gt=It[Nt],sn=ct[Gt.materialIndex];if(sn&&sn.visible){const bn=ue(ke,Ne,sn,At,st.near,st.far,Et);A.renderBufferDirect(st,null,Ne,bn,ke,Gt)}}}else if(ct.visible){const It=ue(ke,Ne,ct,At,st.near,st.far,Et);A.renderBufferDirect(st,null,Ne,It,ke,null)}}const Ht=ke.children;for(let Ne=0,ct=Ht.length;Ne<ct;Ne++)Ve(Ht[Ne],je,st,At,Et)}}function LD(A,r,l){const d=l.isWebGL2;function v(){let _t=!1;const ii=new nr;let Kn=null;const xi=new nr(0,0,0,0);return{setMask:function(dn){Kn!==dn&&!_t&&(A.colorMask(dn,dn,dn,dn),Kn=dn)},setLocked:function(dn){_t=dn},setClear:function(dn,hi,Vi,Mr,yo){yo===!0&&(dn*=Mr,hi*=Mr,Vi*=Mr),ii.set(dn,hi,Vi,Mr),xi.equals(ii)===!1&&(A.clearColor(dn,hi,Vi,Mr),xi.copy(ii))},reset:function(){_t=!1,Kn=null,xi.set(-1,0,0,0)}}}function w(){let _t=!1,ii=null,Kn=null,xi=null;return{setTest:function(dn){dn?Mt(A.DEPTH_TEST):fi(A.DEPTH_TEST)},setMask:function(dn){ii!==dn&&!_t&&(A.depthMask(dn),ii=dn)},setFunc:function(dn){if(Kn!==dn){if(dn)switch(dn){case ze:A.depthFunc(A.NEVER);break;case tt:A.depthFunc(A.ALWAYS);break;case rt:A.depthFunc(A.LESS);break;case vt:A.depthFunc(A.LEQUAL);break;case Ye:A.depthFunc(A.EQUAL);break;case Pe:A.depthFunc(A.GEQUAL);break;case Be:A.depthFunc(A.GREATER);break;case $e:A.depthFunc(A.NOTEQUAL);break;default:A.depthFunc(A.LEQUAL)}else A.depthFunc(A.LEQUAL);Kn=dn}},setLocked:function(dn){_t=dn},setClear:function(dn){xi!==dn&&(A.clearDepth(dn),xi=dn)},reset:function(){_t=!1,ii=null,Kn=null,xi=null}}}function C(){let _t=!1,ii=null,Kn=null,xi=null,dn=null,hi=null,Vi=null,Mr=null,yo=null;return{setTest:function(Pr){_t||(Pr?Mt(A.STENCIL_TEST):fi(A.STENCIL_TEST))},setMask:function(Pr){ii!==Pr&&!_t&&(A.stencilMask(Pr),ii=Pr)},setFunc:function(Pr,Pa,wl){(Kn!==Pr||xi!==Pa||dn!==wl)&&(A.stencilFunc(Pr,Pa,wl),Kn=Pr,xi=Pa,dn=wl)},setOp:function(Pr,Pa,wl){(hi!==Pr||Vi!==Pa||Mr!==wl)&&(A.stencilOp(Pr,Pa,wl),hi=Pr,Vi=Pa,Mr=wl)},setLocked:function(Pr){_t=Pr},setClear:function(Pr){yo!==Pr&&(A.clearStencil(Pr),yo=Pr)},reset:function(){_t=!1,ii=null,Kn=null,xi=null,dn=null,hi=null,Vi=null,Mr=null,yo=null}}}const O=new v,z=new w,H=new C;let ne={},re={},se=new WeakMap,oe=[],ve=null,Te=!1,Fe=null,Ae=null,ue=null,Ve=null,ke=null,je=null,st=null,At=!1,Et=null,Xt=null,Ht=null,Ne=null,ct=null;const It=A.getParameter(A.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let Nt=!1,Pt=0;const Gt=A.getParameter(A.VERSION);Gt.indexOf("WebGL")!==-1?(Pt=parseFloat(/^WebGL (\d)/.exec(Gt)[1]),Nt=Pt>=1):Gt.indexOf("OpenGL ES")!==-1&&(Pt=parseFloat(/^OpenGL ES (\d)/.exec(Gt)[1]),Nt=Pt>=2);let sn=null,bn={};const kn=A.getParameter(A.SCISSOR_BOX),si=A.getParameter(A.VIEWPORT),Vn=new nr().fromArray(kn),fn=new nr().fromArray(si);function Pn(_t,ii,Kn){const xi=new Uint8Array(4),dn=A.createTexture();A.bindTexture(_t,dn),A.texParameteri(_t,A.TEXTURE_MIN_FILTER,A.NEAREST),A.texParameteri(_t,A.TEXTURE_MAG_FILTER,A.NEAREST);for(let hi=0;hi<Kn;hi++)A.texImage2D(ii+hi,0,A.RGBA,1,1,0,A.RGBA,A.UNSIGNED_BYTE,xi);return dn}const li={};li[A.TEXTURE_2D]=Pn(A.TEXTURE_2D,A.TEXTURE_2D,1),li[A.TEXTURE_CUBE_MAP]=Pn(A.TEXTURE_CUBE_MAP,A.TEXTURE_CUBE_MAP_POSITIVE_X,6),O.setClear(0,0,0,1),z.setClear(1),H.setClear(0),Mt(A.DEPTH_TEST),z.setFunc(vt),Dn(!1),ti(p),Mt(A.CULL_FACE),ln(k);function Mt(_t){ne[_t]!==!0&&(A.enable(_t),ne[_t]=!0)}function fi(_t){ne[_t]!==!1&&(A.disable(_t),ne[_t]=!1)}function Qn(_t,ii){return re[_t]!==ii?(A.bindFramebuffer(_t,ii),re[_t]=ii,d&&(_t===A.DRAW_FRAMEBUFFER&&(re[A.FRAMEBUFFER]=ii),_t===A.FRAMEBUFFER&&(re[A.DRAW_FRAMEBUFFER]=ii)),!0):!1}function di(_t,ii){let Kn=oe,xi=!1;if(_t)if(Kn=se.get(ii),Kn===void 0&&(Kn=[],se.set(ii,Kn)),_t.isWebGLMultipleRenderTargets){const dn=_t.texture;if(Kn.length!==dn.length||Kn[0]!==A.COLOR_ATTACHMENT0){for(let hi=0,Vi=dn.length;hi<Vi;hi++)Kn[hi]=A.COLOR_ATTACHMENT0+hi;Kn.length=dn.length,xi=!0}}else Kn[0]!==A.COLOR_ATTACHMENT0&&(Kn[0]=A.COLOR_ATTACHMENT0,xi=!0);else Kn[0]!==A.BACK&&(Kn[0]=A.BACK,xi=!0);xi&&(l.isWebGL2?A.drawBuffers(Kn):r.get("WEBGL_draw_buffers").drawBuffersWEBGL(Kn))}function Wn(_t){return ve!==_t?(A.useProgram(_t),ve=_t,!0):!1}const Si={[N]:A.FUNC_ADD,[L]:A.FUNC_SUBTRACT,[M]:A.FUNC_REVERSE_SUBTRACT};if(d)Si[I]=A.MIN,Si[U]=A.MAX;else{const _t=r.get("EXT_blend_minmax");_t!==null&&(Si[I]=_t.MIN_EXT,Si[U]=_t.MAX_EXT)}const pi={[$]:A.ZERO,[ee]:A.ONE,[Q]:A.SRC_COLOR,[K]:A.SRC_ALPHA,[De]:A.SRC_ALPHA_SATURATE,[ge]:A.DST_COLOR,[we]:A.DST_ALPHA,[G]:A.ONE_MINUS_SRC_COLOR,[Y]:A.ONE_MINUS_SRC_ALPHA,[me]:A.ONE_MINUS_DST_COLOR,[Ke]:A.ONE_MINUS_DST_ALPHA};function ln(_t,ii,Kn,xi,dn,hi,Vi,Mr){if(_t===k){Te===!0&&(fi(A.BLEND),Te=!1);return}if(Te===!1&&(Mt(A.BLEND),Te=!0),_t!==te){if(_t!==Fe||Mr!==At){if((Ae!==N||ke!==N)&&(A.blendEquation(A.FUNC_ADD),Ae=N,ke=N),Mr)switch(_t){case W:A.blendFuncSeparate(A.ONE,A.ONE_MINUS_SRC_ALPHA,A.ONE,A.ONE_MINUS_SRC_ALPHA);break;case j:A.blendFunc(A.ONE,A.ONE);break;case J:A.blendFuncSeparate(A.ZERO,A.ONE_MINUS_SRC_COLOR,A.ZERO,A.ONE);break;case de:A.blendFuncSeparate(A.ZERO,A.SRC_COLOR,A.ZERO,A.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",_t);break}else switch(_t){case W:A.blendFuncSeparate(A.SRC_ALPHA,A.ONE_MINUS_SRC_ALPHA,A.ONE,A.ONE_MINUS_SRC_ALPHA);break;case j:A.blendFunc(A.SRC_ALPHA,A.ONE);break;case J:A.blendFuncSeparate(A.ZERO,A.ONE_MINUS_SRC_COLOR,A.ZERO,A.ONE);break;case de:A.blendFunc(A.ZERO,A.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",_t);break}ue=null,Ve=null,je=null,st=null,Fe=_t,At=Mr}return}dn=dn||ii,hi=hi||Kn,Vi=Vi||xi,(ii!==Ae||dn!==ke)&&(A.blendEquationSeparate(Si[ii],Si[dn]),Ae=ii,ke=dn),(Kn!==ue||xi!==Ve||hi!==je||Vi!==st)&&(A.blendFuncSeparate(pi[Kn],pi[xi],pi[hi],pi[Vi]),ue=Kn,Ve=xi,je=hi,st=Vi),Fe=_t,At=null}function In(_t,ii){_t.side===P?fi(A.CULL_FACE):Mt(A.CULL_FACE);let Kn=_t.side===T;ii&&(Kn=!Kn),Dn(Kn),_t.blending===W&&_t.transparent===!1?ln(k):ln(_t.blending,_t.blendEquation,_t.blendSrc,_t.blendDst,_t.blendEquationAlpha,_t.blendSrcAlpha,_t.blendDstAlpha,_t.premultipliedAlpha),z.setFunc(_t.depthFunc),z.setTest(_t.depthTest),z.setMask(_t.depthWrite),O.setMask(_t.colorWrite);const xi=_t.stencilWrite;H.setTest(xi),xi&&(H.setMask(_t.stencilWriteMask),H.setFunc(_t.stencilFunc,_t.stencilRef,_t.stencilFuncMask),H.setOp(_t.stencilFail,_t.stencilZFail,_t.stencilZPass)),yi(_t.polygonOffset,_t.polygonOffsetFactor,_t.polygonOffsetUnits),_t.alphaToCoverage===!0?Mt(A.SAMPLE_ALPHA_TO_COVERAGE):fi(A.SAMPLE_ALPHA_TO_COVERAGE)}function Dn(_t){Et!==_t&&(_t?A.frontFace(A.CW):A.frontFace(A.CCW),Et=_t)}function ti(_t){_t!==f?(Mt(A.CULL_FACE),_t!==Xt&&(_t===p?A.cullFace(A.BACK):_t===m?A.cullFace(A.FRONT):A.cullFace(A.FRONT_AND_BACK))):fi(A.CULL_FACE),Xt=_t}function Hn(_t){_t!==Ht&&(Nt&&A.lineWidth(_t),Ht=_t)}function yi(_t,ii,Kn){_t?(Mt(A.POLYGON_OFFSET_FILL),(Ne!==ii||ct!==Kn)&&(A.polygonOffset(ii,Kn),Ne=ii,ct=Kn)):fi(A.POLYGON_OFFSET_FILL)}function mi(_t){_t?Mt(A.SCISSOR_TEST):fi(A.SCISSOR_TEST)}function zi(_t){_t===void 0&&(_t=A.TEXTURE0+It-1),sn!==_t&&(A.activeTexture(_t),sn=_t)}function vr(_t,ii){sn===null&&zi();let Kn=bn[sn];Kn===void 0&&(Kn={type:void 0,texture:void 0},bn[sn]=Kn),(Kn.type!==_t||Kn.texture!==ii)&&(A.bindTexture(_t,ii||li[_t]),Kn.type=_t,Kn.texture=ii)}function cr(){const _t=bn[sn];_t!==void 0&&_t.type!==void 0&&(A.bindTexture(_t.type,null),_t.type=void 0,_t.texture=void 0)}function ht(){try{A.compressedTexImage2D.apply(A,arguments)}catch(_t){console.error("THREE.WebGLState:",_t)}}function Qe(){try{A.texSubImage2D.apply(A,arguments)}catch(_t){console.error("THREE.WebGLState:",_t)}}function cn(){try{A.texSubImage3D.apply(A,arguments)}catch(_t){console.error("THREE.WebGLState:",_t)}}function On(){try{A.compressedTexSubImage2D.apply(A,arguments)}catch(_t){console.error("THREE.WebGLState:",_t)}}function ri(){try{A.texStorage2D.apply(A,arguments)}catch(_t){console.error("THREE.WebGLState:",_t)}}function an(){try{A.texStorage3D.apply(A,arguments)}catch(_t){console.error("THREE.WebGLState:",_t)}}function ci(){try{A.texImage2D.apply(A,arguments)}catch(_t){console.error("THREE.WebGLState:",_t)}}function oi(){try{A.texImage3D.apply(A,arguments)}catch(_t){console.error("THREE.WebGLState:",_t)}}function Gn(_t){Vn.equals(_t)===!1&&(A.scissor(_t.x,_t.y,_t.z,_t.w),Vn.copy(_t))}function Nn(_t){fn.equals(_t)===!1&&(A.viewport(_t.x,_t.y,_t.z,_t.w),fn.copy(_t))}function Ti(){A.disable(A.BLEND),A.disable(A.CULL_FACE),A.disable(A.DEPTH_TEST),A.disable(A.POLYGON_OFFSET_FILL),A.disable(A.SCISSOR_TEST),A.disable(A.STENCIL_TEST),A.disable(A.SAMPLE_ALPHA_TO_COVERAGE),A.blendEquation(A.FUNC_ADD),A.blendFunc(A.ONE,A.ZERO),A.blendFuncSeparate(A.ONE,A.ZERO,A.ONE,A.ZERO),A.colorMask(!0,!0,!0,!0),A.clearColor(0,0,0,0),A.depthMask(!0),A.depthFunc(A.LESS),A.clearDepth(1),A.stencilMask(4294967295),A.stencilFunc(A.ALWAYS,0,4294967295),A.stencilOp(A.KEEP,A.KEEP,A.KEEP),A.clearStencil(0),A.cullFace(A.BACK),A.frontFace(A.CCW),A.polygonOffset(0,0),A.activeTexture(A.TEXTURE0),A.bindFramebuffer(A.FRAMEBUFFER,null),d===!0&&(A.bindFramebuffer(A.DRAW_FRAMEBUFFER,null),A.bindFramebuffer(A.READ_FRAMEBUFFER,null)),A.useProgram(null),A.lineWidth(1),A.scissor(0,0,A.canvas.width,A.canvas.height),A.viewport(0,0,A.canvas.width,A.canvas.height),ne={},sn=null,bn={},re={},se=new WeakMap,oe=[],ve=null,Te=!1,Fe=null,Ae=null,ue=null,Ve=null,ke=null,je=null,st=null,At=!1,Et=null,Xt=null,Ht=null,Ne=null,ct=null,Vn.set(0,0,A.canvas.width,A.canvas.height),fn.set(0,0,A.canvas.width,A.canvas.height),O.reset(),z.reset(),H.reset()}return{buffers:{color:O,depth:z,stencil:H},enable:Mt,disable:fi,bindFramebuffer:Qn,drawBuffers:di,useProgram:Wn,setBlending:ln,setMaterial:In,setFlipSided:Dn,setCullFace:ti,setLineWidth:Hn,setPolygonOffset:yi,setScissorTest:mi,activeTexture:zi,bindTexture:vr,unbindTexture:cr,compressedTexImage2D:ht,texImage2D:ci,texImage3D:oi,texStorage2D:ri,texStorage3D:an,texSubImage2D:Qe,texSubImage3D:cn,compressedTexSubImage2D:On,scissor:Gn,viewport:Nn,reset:Ti}}function PD(A,r,l,d,v,w,C){const O=v.isWebGL2,z=v.maxTextures,H=v.maxCubemapSize,ne=v.maxTextureSize,re=v.maxSamples,oe=r.has("WEBGL_multisampled_render_to_texture")?r.get("WEBGL_multisampled_render_to_texture"):void 0,ve=new WeakMap;let Te,Fe=!1;try{Fe=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function Ae(ht,Qe){return Fe?new OffscreenCanvas(ht,Qe):ep("canvas")}function ue(ht,Qe,cn,On){let ri=1;if((ht.width>On||ht.height>On)&&(ri=On/Math.max(ht.width,ht.height)),ri<1||Qe===!0)if(typeof HTMLImageElement!="undefined"&&ht instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&ht instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&ht instanceof ImageBitmap){const an=Qe?Cw:Math.floor,ci=an(ri*ht.width),oi=an(ri*ht.height);Te===void 0&&(Te=Ae(ci,oi));const Gn=cn?Ae(ci,oi):Te;return Gn.width=ci,Gn.height=oi,Gn.getContext("2d").drawImage(ht,0,0,ci,oi),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ht.width+"x"+ht.height+") to ("+ci+"x"+oi+")."),Gn}else return"data"in ht&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ht.width+"x"+ht.height+")."),ht;return ht}function Ve(ht){return s1(ht.width)&&s1(ht.height)}function ke(ht){return O?!1:ht.wrapS!==ye||ht.wrapT!==ye||ht.minFilter!==at&&ht.minFilter!==ut}function je(ht,Qe){return ht.generateMipmaps&&Qe&&ht.minFilter!==at&&ht.minFilter!==ut}function st(ht){A.generateMipmap(ht)}function At(ht,Qe,cn,On,ri=!1){if(O===!1)return Qe;if(ht!==null){if(A[ht]!==void 0)return A[ht];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ht+"'")}let an=Qe;return Qe===A.RED&&(cn===A.FLOAT&&(an=A.R32F),cn===A.HALF_FLOAT&&(an=A.R16F),cn===A.UNSIGNED_BYTE&&(an=A.R8)),Qe===A.RG&&(cn===A.FLOAT&&(an=A.RG32F),cn===A.HALF_FLOAT&&(an=A.RG16F),cn===A.UNSIGNED_BYTE&&(an=A.RG8)),Qe===A.RGBA&&(cn===A.FLOAT&&(an=A.RGBA32F),cn===A.HALF_FLOAT&&(an=A.RGBA16F),cn===A.UNSIGNED_BYTE&&(an=On===Li&&ri===!1?A.SRGB8_ALPHA8:A.RGBA8),cn===A.UNSIGNED_SHORT_4_4_4_4&&(an=A.RGBA4),cn===A.UNSIGNED_SHORT_5_5_5_1&&(an=A.RGB5_A1)),(an===A.R16F||an===A.R32F||an===A.RG16F||an===A.RG32F||an===A.RGBA16F||an===A.RGBA32F)&&r.get("EXT_color_buffer_float"),an}function Et(ht,Qe,cn){return je(ht,cn)===!0||ht.isFramebufferTexture&&ht.minFilter!==at&&ht.minFilter!==ut?Math.log2(Math.max(Qe.width,Qe.height))+1:ht.mipmaps!==void 0&&ht.mipmaps.length>0?ht.mipmaps.length:ht.isCompressedTexture&&Array.isArray(ht.image)?Qe.mipmaps.length:1}function Xt(ht){return ht===at||ht===mt||ht===Lt?A.NEAREST:A.LINEAR}function Ht(ht){const Qe=ht.target;Qe.removeEventListener("dispose",Ht),ct(Qe),Qe.isVideoTexture&&ve.delete(Qe),C.memory.textures--}function Ne(ht){const Qe=ht.target;Qe.removeEventListener("dispose",Ne),It(Qe)}function ct(ht){const Qe=d.get(ht);Qe.__webglInit!==void 0&&(A.deleteTexture(Qe.__webglTexture),d.remove(ht))}function It(ht){const Qe=ht.texture,cn=d.get(ht),On=d.get(Qe);if(!!ht){if(On.__webglTexture!==void 0&&(A.deleteTexture(On.__webglTexture),C.memory.textures--),ht.depthTexture&&ht.depthTexture.dispose(),ht.isWebGLCubeRenderTarget)for(let ri=0;ri<6;ri++)A.deleteFramebuffer(cn.__webglFramebuffer[ri]),cn.__webglDepthbuffer&&A.deleteRenderbuffer(cn.__webglDepthbuffer[ri]);else A.deleteFramebuffer(cn.__webglFramebuffer),cn.__webglDepthbuffer&&A.deleteRenderbuffer(cn.__webglDepthbuffer),cn.__webglMultisampledFramebuffer&&A.deleteFramebuffer(cn.__webglMultisampledFramebuffer),cn.__webglColorRenderbuffer&&A.deleteRenderbuffer(cn.__webglColorRenderbuffer),cn.__webglDepthRenderbuffer&&A.deleteRenderbuffer(cn.__webglDepthRenderbuffer);if(ht.isWebGLMultipleRenderTargets)for(let ri=0,an=Qe.length;ri<an;ri++){const ci=d.get(Qe[ri]);ci.__webglTexture&&(A.deleteTexture(ci.__webglTexture),C.memory.textures--),d.remove(Qe[ri])}d.remove(Qe),d.remove(ht)}}let Nt=0;function Pt(){Nt=0}function Gt(){const ht=Nt;return ht>=z&&console.warn("THREE.WebGLTextures: Trying to use "+ht+" texture units while this GPU supports only "+z),Nt+=1,ht}function sn(ht,Qe){const cn=d.get(ht);if(ht.isVideoTexture&&Hn(ht),ht.version>0&&cn.__version!==ht.version){const On=ht.image;if(On===void 0)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined");else if(On.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{Mt(cn,ht,Qe);return}}l.activeTexture(A.TEXTURE0+Qe),l.bindTexture(A.TEXTURE_2D,cn.__webglTexture)}function bn(ht,Qe){const cn=d.get(ht);if(ht.version>0&&cn.__version!==ht.version){Mt(cn,ht,Qe);return}l.activeTexture(A.TEXTURE0+Qe),l.bindTexture(A.TEXTURE_2D_ARRAY,cn.__webglTexture)}function kn(ht,Qe){const cn=d.get(ht);if(ht.version>0&&cn.__version!==ht.version){Mt(cn,ht,Qe);return}l.activeTexture(A.TEXTURE0+Qe),l.bindTexture(A.TEXTURE_3D,cn.__webglTexture)}function si(ht,Qe){const cn=d.get(ht);if(ht.version>0&&cn.__version!==ht.version){fi(cn,ht,Qe);return}l.activeTexture(A.TEXTURE0+Qe),l.bindTexture(A.TEXTURE_CUBE_MAP,cn.__webglTexture)}const Vn={[Ie]:A.REPEAT,[ye]:A.CLAMP_TO_EDGE,[nt]:A.MIRRORED_REPEAT},fn={[at]:A.NEAREST,[mt]:A.NEAREST_MIPMAP_NEAREST,[Lt]:A.NEAREST_MIPMAP_LINEAR,[ut]:A.LINEAR,[St]:A.LINEAR_MIPMAP_NEAREST,[gn]:A.LINEAR_MIPMAP_LINEAR};function Pn(ht,Qe,cn){if(cn?(A.texParameteri(ht,A.TEXTURE_WRAP_S,Vn[Qe.wrapS]),A.texParameteri(ht,A.TEXTURE_WRAP_T,Vn[Qe.wrapT]),(ht===A.TEXTURE_3D||ht===A.TEXTURE_2D_ARRAY)&&A.texParameteri(ht,A.TEXTURE_WRAP_R,Vn[Qe.wrapR]),A.texParameteri(ht,A.TEXTURE_MAG_FILTER,fn[Qe.magFilter]),A.texParameteri(ht,A.TEXTURE_MIN_FILTER,fn[Qe.minFilter])):(A.texParameteri(ht,A.TEXTURE_WRAP_S,A.CLAMP_TO_EDGE),A.texParameteri(ht,A.TEXTURE_WRAP_T,A.CLAMP_TO_EDGE),(ht===A.TEXTURE_3D||ht===A.TEXTURE_2D_ARRAY)&&A.texParameteri(ht,A.TEXTURE_WRAP_R,A.CLAMP_TO_EDGE),(Qe.wrapS!==ye||Qe.wrapT!==ye)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),A.texParameteri(ht,A.TEXTURE_MAG_FILTER,Xt(Qe.magFilter)),A.texParameteri(ht,A.TEXTURE_MIN_FILTER,Xt(Qe.minFilter)),Qe.minFilter!==at&&Qe.minFilter!==ut&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),r.has("EXT_texture_filter_anisotropic")===!0){const On=r.get("EXT_texture_filter_anisotropic");if(Qe.type===xn&&r.has("OES_texture_float_linear")===!1||O===!1&&Qe.type===Zn&&r.has("OES_texture_half_float_linear")===!1)return;(Qe.anisotropy>1||d.get(Qe).__currentAnisotropy)&&(A.texParameterf(ht,On.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(Qe.anisotropy,v.getMaxAnisotropy())),d.get(Qe).__currentAnisotropy=Qe.anisotropy)}}function li(ht,Qe){ht.__webglInit===void 0&&(ht.__webglInit=!0,Qe.addEventListener("dispose",Ht),ht.__webglTexture=A.createTexture(),C.memory.textures++)}function Mt(ht,Qe,cn){let On=A.TEXTURE_2D;Qe.isDataTexture2DArray&&(On=A.TEXTURE_2D_ARRAY),Qe.isDataTexture3D&&(On=A.TEXTURE_3D),li(ht,Qe),l.activeTexture(A.TEXTURE0+cn),l.bindTexture(On,ht.__webglTexture),A.pixelStorei(A.UNPACK_FLIP_Y_WEBGL,Qe.flipY),A.pixelStorei(A.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Qe.premultiplyAlpha),A.pixelStorei(A.UNPACK_ALIGNMENT,Qe.unpackAlignment),A.pixelStorei(A.UNPACK_COLORSPACE_CONVERSION_WEBGL,A.NONE);const ri=ke(Qe)&&Ve(Qe.image)===!1;let an=ue(Qe.image,ri,!1,ne);an=yi(Qe,an);const ci=Ve(an)||O,oi=w.convert(Qe.format,Qe.encoding);let Gn=w.convert(Qe.type),Nn=At(Qe.internalFormat,oi,Gn,Qe.encoding,Qe.isVideoTexture);Pn(On,Qe,ci);let Ti;const _t=Qe.mipmaps,ii=O&&Qe.isVideoTexture!==!0,Kn=ht.__version===void 0,xi=Et(Qe,an,ci);if(Qe.isDepthTexture)Nn=A.DEPTH_COMPONENT,O?Qe.type===xn?Nn=A.DEPTH_COMPONENT32F:Qe.type===ai?Nn=A.DEPTH_COMPONENT24:Qe.type===be?Nn=A.DEPTH24_STENCIL8:Nn=A.DEPTH_COMPONENT16:Qe.type===xn&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),Qe.format===dt&&Nn===A.DEPTH_COMPONENT&&Qe.type!==wn&&Qe.type!==ai&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),Qe.type=wn,Gn=w.convert(Qe.type)),Qe.format===Re&&Nn===A.DEPTH_COMPONENT&&(Nn=A.DEPTH_STENCIL,Qe.type!==be&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),Qe.type=be,Gn=w.convert(Qe.type))),ii&&Kn?l.texStorage2D(A.TEXTURE_2D,1,Nn,an.width,an.height):l.texImage2D(A.TEXTURE_2D,0,Nn,an.width,an.height,0,oi,Gn,null);else if(Qe.isDataTexture)if(_t.length>0&&ci){ii&&Kn&&l.texStorage2D(A.TEXTURE_2D,xi,Nn,_t[0].width,_t[0].height);for(let dn=0,hi=_t.length;dn<hi;dn++)Ti=_t[dn],ii?l.texSubImage2D(A.TEXTURE_2D,0,0,0,Ti.width,Ti.height,oi,Gn,Ti.data):l.texImage2D(A.TEXTURE_2D,dn,Nn,Ti.width,Ti.height,0,oi,Gn,Ti.data);Qe.generateMipmaps=!1}else ii?(Kn&&l.texStorage2D(A.TEXTURE_2D,xi,Nn,an.width,an.height),l.texSubImage2D(A.TEXTURE_2D,0,0,0,an.width,an.height,oi,Gn,an.data)):l.texImage2D(A.TEXTURE_2D,0,Nn,an.width,an.height,0,oi,Gn,an.data);else if(Qe.isCompressedTexture){ii&&Kn&&l.texStorage2D(A.TEXTURE_2D,xi,Nn,_t[0].width,_t[0].height);for(let dn=0,hi=_t.length;dn<hi;dn++)Ti=_t[dn],Qe.format!==Se?oi!==null?ii?l.compressedTexSubImage2D(A.TEXTURE_2D,dn,0,0,Ti.width,Ti.height,oi,Ti.data):l.compressedTexImage2D(A.TEXTURE_2D,dn,Nn,Ti.width,Ti.height,0,Ti.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):ii?l.texSubImage2D(A.TEXTURE_2D,dn,0,0,Ti.width,Ti.height,oi,Gn,Ti.data):l.texImage2D(A.TEXTURE_2D,dn,Nn,Ti.width,Ti.height,0,oi,Gn,Ti.data)}else if(Qe.isDataTexture2DArray)ii?(Kn&&l.texStorage3D(A.TEXTURE_2D_ARRAY,xi,Nn,an.width,an.height,an.depth),l.texSubImage3D(A.TEXTURE_2D_ARRAY,0,0,0,0,an.width,an.height,an.depth,oi,Gn,an.data)):l.texImage3D(A.TEXTURE_2D_ARRAY,0,Nn,an.width,an.height,an.depth,0,oi,Gn,an.data);else if(Qe.isDataTexture3D)ii?(Kn&&l.texStorage3D(A.TEXTURE_3D,xi,Nn,an.width,an.height,an.depth),l.texSubImage3D(A.TEXTURE_3D,0,0,0,0,an.width,an.height,an.depth,oi,Gn,an.data)):l.texImage3D(A.TEXTURE_3D,0,Nn,an.width,an.height,an.depth,0,oi,Gn,an.data);else if(Qe.isFramebufferTexture)ii&&Kn?l.texStorage2D(A.TEXTURE_2D,xi,Nn,an.width,an.height):l.texImage2D(A.TEXTURE_2D,0,Nn,an.width,an.height,0,oi,Gn,null);else if(_t.length>0&&ci){ii&&Kn&&l.texStorage2D(A.TEXTURE_2D,xi,Nn,_t[0].width,_t[0].height);for(let dn=0,hi=_t.length;dn<hi;dn++)Ti=_t[dn],ii?l.texSubImage2D(A.TEXTURE_2D,dn,0,0,oi,Gn,Ti):l.texImage2D(A.TEXTURE_2D,dn,Nn,oi,Gn,Ti);Qe.generateMipmaps=!1}else ii?(Kn&&l.texStorage2D(A.TEXTURE_2D,xi,Nn,an.width,an.height),l.texSubImage2D(A.TEXTURE_2D,0,0,0,oi,Gn,an)):l.texImage2D(A.TEXTURE_2D,0,Nn,oi,Gn,an);je(Qe,ci)&&st(On),ht.__version=Qe.version,Qe.onUpdate&&Qe.onUpdate(Qe)}function fi(ht,Qe,cn){if(Qe.image.length!==6)return;li(ht,Qe),l.activeTexture(A.TEXTURE0+cn),l.bindTexture(A.TEXTURE_CUBE_MAP,ht.__webglTexture),A.pixelStorei(A.UNPACK_FLIP_Y_WEBGL,Qe.flipY),A.pixelStorei(A.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Qe.premultiplyAlpha),A.pixelStorei(A.UNPACK_ALIGNMENT,Qe.unpackAlignment),A.pixelStorei(A.UNPACK_COLORSPACE_CONVERSION_WEBGL,A.NONE);const On=Qe&&(Qe.isCompressedTexture||Qe.image[0].isCompressedTexture),ri=Qe.image[0]&&Qe.image[0].isDataTexture,an=[];for(let dn=0;dn<6;dn++)!On&&!ri?an[dn]=ue(Qe.image[dn],!1,!0,H):an[dn]=ri?Qe.image[dn].image:Qe.image[dn],an[dn]=yi(Qe,an[dn]);const ci=an[0],oi=Ve(ci)||O,Gn=w.convert(Qe.format,Qe.encoding),Nn=w.convert(Qe.type),Ti=At(Qe.internalFormat,Gn,Nn,Qe.encoding),_t=O&&Qe.isVideoTexture!==!0,ii=ht.__version===void 0;let Kn=Et(Qe,ci,oi);Pn(A.TEXTURE_CUBE_MAP,Qe,oi);let xi;if(On){_t&&ii&&l.texStorage2D(A.TEXTURE_CUBE_MAP,Kn,Ti,ci.width,ci.height);for(let dn=0;dn<6;dn++){xi=an[dn].mipmaps;for(let hi=0;hi<xi.length;hi++){const Vi=xi[hi];Qe.format!==Se?Gn!==null?_t?l.compressedTexSubImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_X+dn,hi,0,0,Vi.width,Vi.height,Gn,Vi.data):l.compressedTexImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_X+dn,hi,Ti,Vi.width,Vi.height,0,Vi.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):_t?l.texSubImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_X+dn,hi,0,0,Vi.width,Vi.height,Gn,Nn,Vi.data):l.texImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_X+dn,hi,Ti,Vi.width,Vi.height,0,Gn,Nn,Vi.data)}}}else{xi=Qe.mipmaps,_t&&ii&&(xi.length>0&&Kn++,l.texStorage2D(A.TEXTURE_CUBE_MAP,Kn,Ti,an[0].width,an[0].height));for(let dn=0;dn<6;dn++)if(ri){_t?l.texSubImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_X+dn,0,0,0,an[dn].width,an[dn].height,Gn,Nn,an[dn].data):l.texImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_X+dn,0,Ti,an[dn].width,an[dn].height,0,Gn,Nn,an[dn].data);for(let hi=0;hi<xi.length;hi++){const Mr=xi[hi].image[dn].image;_t?l.texSubImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_X+dn,hi+1,0,0,Mr.width,Mr.height,Gn,Nn,Mr.data):l.texImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_X+dn,hi+1,Ti,Mr.width,Mr.height,0,Gn,Nn,Mr.data)}}else{_t?l.texSubImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_X+dn,0,0,0,Gn,Nn,an[dn]):l.texImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_X+dn,0,Ti,Gn,Nn,an[dn]);for(let hi=0;hi<xi.length;hi++){const Vi=xi[hi];_t?l.texSubImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_X+dn,hi+1,0,0,Gn,Nn,Vi.image[dn]):l.texImage2D(A.TEXTURE_CUBE_MAP_POSITIVE_X+dn,hi+1,Ti,Gn,Nn,Vi.image[dn])}}}je(Qe,oi)&&st(A.TEXTURE_CUBE_MAP),ht.__version=Qe.version,Qe.onUpdate&&Qe.onUpdate(Qe)}function Qn(ht,Qe,cn,On,ri){const an=w.convert(cn.format,cn.encoding),ci=w.convert(cn.type),oi=At(cn.internalFormat,an,ci,cn.encoding);d.get(Qe).__hasExternalTextures||(ri===A.TEXTURE_3D||ri===A.TEXTURE_2D_ARRAY?l.texImage3D(ri,0,oi,Qe.width,Qe.height,Qe.depth,0,an,ci,null):l.texImage2D(ri,0,oi,Qe.width,Qe.height,0,an,ci,null)),l.bindFramebuffer(A.FRAMEBUFFER,ht),Qe.useRenderToTexture?oe.framebufferTexture2DMultisampleEXT(A.FRAMEBUFFER,On,ri,d.get(cn).__webglTexture,0,ti(Qe)):A.framebufferTexture2D(A.FRAMEBUFFER,On,ri,d.get(cn).__webglTexture,0),l.bindFramebuffer(A.FRAMEBUFFER,null)}function di(ht,Qe,cn){if(A.bindRenderbuffer(A.RENDERBUFFER,ht),Qe.depthBuffer&&!Qe.stencilBuffer){let On=A.DEPTH_COMPONENT16;if(cn||Qe.useRenderToTexture){const ri=Qe.depthTexture;ri&&ri.isDepthTexture&&(ri.type===xn?On=A.DEPTH_COMPONENT32F:ri.type===ai&&(On=A.DEPTH_COMPONENT24));const an=ti(Qe);Qe.useRenderToTexture?oe.renderbufferStorageMultisampleEXT(A.RENDERBUFFER,an,On,Qe.width,Qe.height):A.renderbufferStorageMultisample(A.RENDERBUFFER,an,On,Qe.width,Qe.height)}else A.renderbufferStorage(A.RENDERBUFFER,On,Qe.width,Qe.height);A.framebufferRenderbuffer(A.FRAMEBUFFER,A.DEPTH_ATTACHMENT,A.RENDERBUFFER,ht)}else if(Qe.depthBuffer&&Qe.stencilBuffer){const On=ti(Qe);cn&&Qe.useRenderbuffer?A.renderbufferStorageMultisample(A.RENDERBUFFER,On,A.DEPTH24_STENCIL8,Qe.width,Qe.height):Qe.useRenderToTexture?oe.renderbufferStorageMultisampleEXT(A.RENDERBUFFER,On,A.DEPTH24_STENCIL8,Qe.width,Qe.height):A.renderbufferStorage(A.RENDERBUFFER,A.DEPTH_STENCIL,Qe.width,Qe.height),A.framebufferRenderbuffer(A.FRAMEBUFFER,A.DEPTH_STENCIL_ATTACHMENT,A.RENDERBUFFER,ht)}else{const On=Qe.isWebGLMultipleRenderTargets===!0?Qe.texture[0]:Qe.texture,ri=w.convert(On.format,On.encoding),an=w.convert(On.type),ci=At(On.internalFormat,ri,an,On.encoding),oi=ti(Qe);cn&&Qe.useRenderbuffer?A.renderbufferStorageMultisample(A.RENDERBUFFER,oi,ci,Qe.width,Qe.height):Qe.useRenderToTexture?oe.renderbufferStorageMultisampleEXT(A.RENDERBUFFER,oi,ci,Qe.width,Qe.height):A.renderbufferStorage(A.RENDERBUFFER,ci,Qe.width,Qe.height)}A.bindRenderbuffer(A.RENDERBUFFER,null)}function Wn(ht,Qe){if(Qe&&Qe.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(l.bindFramebuffer(A.FRAMEBUFFER,ht),!(Qe.depthTexture&&Qe.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!d.get(Qe.depthTexture).__webglTexture||Qe.depthTexture.image.width!==Qe.width||Qe.depthTexture.image.height!==Qe.height)&&(Qe.depthTexture.image.width=Qe.width,Qe.depthTexture.image.height=Qe.height,Qe.depthTexture.needsUpdate=!0),sn(Qe.depthTexture,0);const On=d.get(Qe.depthTexture).__webglTexture,ri=ti(Qe);if(Qe.depthTexture.format===dt)Qe.useRenderToTexture?oe.framebufferTexture2DMultisampleEXT(A.FRAMEBUFFER,A.DEPTH_ATTACHMENT,A.TEXTURE_2D,On,0,ri):A.framebufferTexture2D(A.FRAMEBUFFER,A.DEPTH_ATTACHMENT,A.TEXTURE_2D,On,0);else if(Qe.depthTexture.format===Re)Qe.useRenderToTexture?oe.framebufferTexture2DMultisampleEXT(A.FRAMEBUFFER,A.DEPTH_STENCIL_ATTACHMENT,A.TEXTURE_2D,On,0,ri):A.framebufferTexture2D(A.FRAMEBUFFER,A.DEPTH_STENCIL_ATTACHMENT,A.TEXTURE_2D,On,0);else throw new Error("Unknown depthTexture format")}function Si(ht){const Qe=d.get(ht),cn=ht.isWebGLCubeRenderTarget===!0;if(ht.depthTexture&&!Qe.__autoAllocateDepthBuffer){if(cn)throw new Error("target.depthTexture not supported in Cube render targets");Wn(Qe.__webglFramebuffer,ht)}else if(cn){Qe.__webglDepthbuffer=[];for(let On=0;On<6;On++)l.bindFramebuffer(A.FRAMEBUFFER,Qe.__webglFramebuffer[On]),Qe.__webglDepthbuffer[On]=A.createRenderbuffer(),di(Qe.__webglDepthbuffer[On],ht,!1)}else l.bindFramebuffer(A.FRAMEBUFFER,Qe.__webglFramebuffer),Qe.__webglDepthbuffer=A.createRenderbuffer(),di(Qe.__webglDepthbuffer,ht,!1);l.bindFramebuffer(A.FRAMEBUFFER,null)}function pi(ht,Qe,cn){const On=d.get(ht);Qe!==void 0&&Qn(On.__webglFramebuffer,ht,ht.texture,A.COLOR_ATTACHMENT0,A.TEXTURE_2D),cn!==void 0&&Si(ht)}function ln(ht){const Qe=ht.texture,cn=d.get(ht),On=d.get(Qe);ht.addEventListener("dispose",Ne),ht.isWebGLMultipleRenderTargets!==!0&&(On.__webglTexture===void 0&&(On.__webglTexture=A.createTexture()),On.__version=Qe.version,C.memory.textures++);const ri=ht.isWebGLCubeRenderTarget===!0,an=ht.isWebGLMultipleRenderTargets===!0,ci=Qe.isDataTexture3D||Qe.isDataTexture2DArray,oi=Ve(ht)||O;if(ri){cn.__webglFramebuffer=[];for(let Gn=0;Gn<6;Gn++)cn.__webglFramebuffer[Gn]=A.createFramebuffer()}else if(cn.__webglFramebuffer=A.createFramebuffer(),an)if(v.drawBuffers){const Gn=ht.texture;for(let Nn=0,Ti=Gn.length;Nn<Ti;Nn++){const _t=d.get(Gn[Nn]);_t.__webglTexture===void 0&&(_t.__webglTexture=A.createTexture(),C.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");else if(ht.useRenderbuffer)if(O){cn.__webglMultisampledFramebuffer=A.createFramebuffer(),cn.__webglColorRenderbuffer=A.createRenderbuffer(),A.bindRenderbuffer(A.RENDERBUFFER,cn.__webglColorRenderbuffer);const Gn=w.convert(Qe.format,Qe.encoding),Nn=w.convert(Qe.type),Ti=At(Qe.internalFormat,Gn,Nn,Qe.encoding),_t=ti(ht);A.renderbufferStorageMultisample(A.RENDERBUFFER,_t,Ti,ht.width,ht.height),l.bindFramebuffer(A.FRAMEBUFFER,cn.__webglMultisampledFramebuffer),A.framebufferRenderbuffer(A.FRAMEBUFFER,A.COLOR_ATTACHMENT0,A.RENDERBUFFER,cn.__webglColorRenderbuffer),A.bindRenderbuffer(A.RENDERBUFFER,null),ht.depthBuffer&&(cn.__webglDepthRenderbuffer=A.createRenderbuffer(),di(cn.__webglDepthRenderbuffer,ht,!0)),l.bindFramebuffer(A.FRAMEBUFFER,null)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.");if(ri){l.bindTexture(A.TEXTURE_CUBE_MAP,On.__webglTexture),Pn(A.TEXTURE_CUBE_MAP,Qe,oi);for(let Gn=0;Gn<6;Gn++)Qn(cn.__webglFramebuffer[Gn],ht,Qe,A.COLOR_ATTACHMENT0,A.TEXTURE_CUBE_MAP_POSITIVE_X+Gn);je(Qe,oi)&&st(A.TEXTURE_CUBE_MAP),l.unbindTexture()}else if(an){const Gn=ht.texture;for(let Nn=0,Ti=Gn.length;Nn<Ti;Nn++){const _t=Gn[Nn],ii=d.get(_t);l.bindTexture(A.TEXTURE_2D,ii.__webglTexture),Pn(A.TEXTURE_2D,_t,oi),Qn(cn.__webglFramebuffer,ht,_t,A.COLOR_ATTACHMENT0+Nn,A.TEXTURE_2D),je(_t,oi)&&st(A.TEXTURE_2D)}l.unbindTexture()}else{let Gn=A.TEXTURE_2D;ci&&(O?Gn=Qe.isDataTexture3D?A.TEXTURE_3D:A.TEXTURE_2D_ARRAY:console.warn("THREE.DataTexture3D and THREE.DataTexture2DArray only supported with WebGL2.")),l.bindTexture(Gn,On.__webglTexture),Pn(Gn,Qe,oi),Qn(cn.__webglFramebuffer,ht,Qe,A.COLOR_ATTACHMENT0,Gn),je(Qe,oi)&&st(Gn),l.unbindTexture()}ht.depthBuffer&&Si(ht)}function In(ht){const Qe=Ve(ht)||O,cn=ht.isWebGLMultipleRenderTargets===!0?ht.texture:[ht.texture];for(let On=0,ri=cn.length;On<ri;On++){const an=cn[On];if(je(an,Qe)){const ci=ht.isWebGLCubeRenderTarget?A.TEXTURE_CUBE_MAP:A.TEXTURE_2D,oi=d.get(an).__webglTexture;l.bindTexture(ci,oi),st(ci),l.unbindTexture()}}}function Dn(ht){if(ht.useRenderbuffer)if(O){const Qe=ht.width,cn=ht.height;let On=A.COLOR_BUFFER_BIT;const ri=[A.COLOR_ATTACHMENT0],an=ht.stencilBuffer?A.DEPTH_STENCIL_ATTACHMENT:A.DEPTH_ATTACHMENT;ht.depthBuffer&&ri.push(an),ht.ignoreDepthForMultisampleCopy||(ht.depthBuffer&&(On|=A.DEPTH_BUFFER_BIT),ht.stencilBuffer&&(On|=A.STENCIL_BUFFER_BIT));const ci=d.get(ht);l.bindFramebuffer(A.READ_FRAMEBUFFER,ci.__webglMultisampledFramebuffer),l.bindFramebuffer(A.DRAW_FRAMEBUFFER,ci.__webglFramebuffer),ht.ignoreDepthForMultisampleCopy&&(A.invalidateFramebuffer(A.READ_FRAMEBUFFER,[an]),A.invalidateFramebuffer(A.DRAW_FRAMEBUFFER,[an])),A.blitFramebuffer(0,0,Qe,cn,0,0,Qe,cn,On,A.NEAREST),A.invalidateFramebuffer(A.READ_FRAMEBUFFER,ri),l.bindFramebuffer(A.READ_FRAMEBUFFER,null),l.bindFramebuffer(A.DRAW_FRAMEBUFFER,ci.__webglMultisampledFramebuffer)}else console.warn("THREE.WebGLRenderer: WebGLMultisampleRenderTarget can only be used with WebGL2.")}function ti(ht){return O&&(ht.useRenderbuffer||ht.useRenderToTexture)?Math.min(re,ht.samples):0}function Hn(ht){const Qe=C.render.frame;ve.get(ht)!==Qe&&(ve.set(ht,Qe),ht.update())}function yi(ht,Qe){const cn=ht.encoding,On=ht.format,ri=ht.type;return ht.isCompressedTexture===!0||ht.isVideoTexture===!0||ht.format===$m||cn!==Qi&&(cn===Li?O===!1?r.has("EXT_sRGB")===!0&&On===Se?(ht.format=$m,ht.minFilter=ut,ht.generateMipmaps=!1):Qe=ql.sRGBToLinear(Qe):(On!==Se||ri!==un)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",cn)),Qe}let mi=!1,zi=!1;function vr(ht,Qe){ht&&ht.isWebGLRenderTarget&&(mi===!1&&(console.warn("THREE.WebGLTextures.safeSetTexture2D: don't use render targets as textures. Use their .texture property instead."),mi=!0),ht=ht.texture),sn(ht,Qe)}function cr(ht,Qe){ht&&ht.isWebGLCubeRenderTarget&&(zi===!1&&(console.warn("THREE.WebGLTextures.safeSetTextureCube: don't use cube render targets as textures. Use their .texture property instead."),zi=!0),ht=ht.texture),si(ht,Qe)}this.allocateTextureUnit=Gt,this.resetTextureUnits=Pt,this.setTexture2D=sn,this.setTexture2DArray=bn,this.setTexture3D=kn,this.setTextureCube=si,this.rebindTextures=pi,this.setupRenderTarget=ln,this.updateRenderTargetMipmap=In,this.updateMultisampleRenderTarget=Dn,this.setupDepthRenderbuffer=Si,this.setupFrameBufferTexture=Qn,this.safeSetTexture2D=vr,this.safeSetTextureCube=cr}function LE(A,r,l){const d=l.isWebGL2;function v(w,C=null){let O;if(w===un)return A.UNSIGNED_BYTE;if(w===Me)return A.UNSIGNED_SHORT_4_4_4_4;if(w===le)return A.UNSIGNED_SHORT_5_5_5_1;if(w===Mn)return A.BYTE;if(w===Cn)return A.SHORT;if(w===wn)return A.UNSIGNED_SHORT;if(w===zn)return A.INT;if(w===ai)return A.UNSIGNED_INT;if(w===xn)return A.FLOAT;if(w===Zn)return d?A.HALF_FLOAT:(O=r.get("OES_texture_half_float"),O!==null?O.HALF_FLOAT_OES:null);if(w===q)return A.ALPHA;if(w===Se)return A.RGBA;if(w===Ge)return A.LUMINANCE;if(w===lt)return A.LUMINANCE_ALPHA;if(w===dt)return A.DEPTH_COMPONENT;if(w===Re)return A.DEPTH_STENCIL;if(w===Ue)return A.RED;if(w===$m)return O=r.get("EXT_sRGB"),O!==null?O.SRGB_ALPHA_EXT:null;if(w===Xe)return A.RED_INTEGER;if(w===ft)return A.RG;if(w===it)return A.RG_INTEGER;if(w===xt)return A.RGBA_INTEGER;if(w===Dt||w===Kt||w===Wt||w===bt)if(C===Li)if(O=r.get("WEBGL_compressed_texture_s3tc_srgb"),O!==null){if(w===Dt)return O.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(w===Kt)return O.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(w===Wt)return O.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(w===bt)return O.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(O=r.get("WEBGL_compressed_texture_s3tc"),O!==null){if(w===Dt)return O.COMPRESSED_RGB_S3TC_DXT1_EXT;if(w===Kt)return O.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(w===Wt)return O.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(w===bt)return O.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(w===jt||w===on||w===$t||w===vn)if(O=r.get("WEBGL_compressed_texture_pvrtc"),O!==null){if(w===jt)return O.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(w===on)return O.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(w===$t)return O.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(w===vn)return O.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(w===Jt)return O=r.get("WEBGL_compressed_texture_etc1"),O!==null?O.COMPRESSED_RGB_ETC1_WEBGL:null;if(w===nn||w===hn)if(O=r.get("WEBGL_compressed_texture_etc"),O!==null){if(w===nn)return C===Li?O.COMPRESSED_SRGB8_ETC2:O.COMPRESSED_RGB8_ETC2;if(w===hn)return C===Li?O.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:O.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(w===rn||w===Rt||w===yt||w===Bt||w===Ft||w===Zt||w===en||w===Rn||w===ae||w===pe||w===Ce||w===fe||w===He||w===ot)if(O=r.get("WEBGL_compressed_texture_astc"),O!==null){if(w===rn)return C===Li?O.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:O.COMPRESSED_RGBA_ASTC_4x4_KHR;if(w===Rt)return C===Li?O.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:O.COMPRESSED_RGBA_ASTC_5x4_KHR;if(w===yt)return C===Li?O.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:O.COMPRESSED_RGBA_ASTC_5x5_KHR;if(w===Bt)return C===Li?O.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:O.COMPRESSED_RGBA_ASTC_6x5_KHR;if(w===Ft)return C===Li?O.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:O.COMPRESSED_RGBA_ASTC_6x6_KHR;if(w===Zt)return C===Li?O.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:O.COMPRESSED_RGBA_ASTC_8x5_KHR;if(w===en)return C===Li?O.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:O.COMPRESSED_RGBA_ASTC_8x6_KHR;if(w===Rn)return C===Li?O.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:O.COMPRESSED_RGBA_ASTC_8x8_KHR;if(w===ae)return C===Li?O.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:O.COMPRESSED_RGBA_ASTC_10x5_KHR;if(w===pe)return C===Li?O.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:O.COMPRESSED_RGBA_ASTC_10x6_KHR;if(w===Ce)return C===Li?O.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:O.COMPRESSED_RGBA_ASTC_10x8_KHR;if(w===fe)return C===Li?O.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:O.COMPRESSED_RGBA_ASTC_10x10_KHR;if(w===He)return C===Li?O.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:O.COMPRESSED_RGBA_ASTC_12x10_KHR;if(w===ot)return C===Li?O.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:O.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(w===pt)if(O=r.get("EXT_texture_compression_bptc"),O!==null){if(w===pt)return C===Li?O.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:O.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;if(w===be)return d?A.UNSIGNED_INT_24_8:(O=r.get("WEBGL_depth_texture"),O!==null?O.UNSIGNED_INT_24_8_WEBGL:null)}return{convert:v}}class oc extends ki{constructor(){super(),this.type="Group"}}oc.prototype.isGroup=!0;class M0 extends qr{constructor(r=[]){super(),this.cameras=r}}M0.prototype.isArrayCamera=!0;var PE=new qe,IE=new qe;function ID(A,r,l){PE.setFromMatrixPosition(r.matrixWorld),IE.setFromMatrixPosition(l.matrixWorld);var d=PE.distanceTo(IE),v=r.projectionMatrix.elements,w=l.projectionMatrix.elements,C=v[14]/(v[10]-1),O=v[14]/(v[10]+1),z=(v[9]+1)/v[5],H=(v[9]-1)/v[5],ne=(v[8]-1)/v[0],re=(w[8]+1)/w[0],se=C*ne,oe=C*re,ve=d/(-ne+re),Te=ve*-ne;r.matrixWorld.decompose(A.position,A.quaternion,A.scale),A.translateX(Te),A.translateZ(ve),A.matrixWorld.compose(A.position,A.quaternion,A.scale),A.matrixWorldInverse.getInverse(A.matrixWorld);var Fe=C+ve,Ae=O+ve,ue=se-Te,Ve=oe+(d-Te),ke=z*O/Ae*Fe,je=H*O/Ae*Fe;A.projectionMatrix.makePerspective(ue,Ve,ke,je,Fe,Ae)}function OE(A){var r,l,d=this,v=null,w=null,C=null,O=[],z=new Jn,H=new Jn,ne=1,re="local-floor";typeof window!="undefined"&&"VRFrameData"in window&&(w=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",ke,!1));var se=new Jn,oe=new os,ve=new qe,Te=new qr;Te.viewport=new nr,Te.layers.enable(1);var Fe=new qr;Fe.viewport=new nr,Fe.layers.enable(2);var Ae=new M0([Te,Fe]);Ae.layers.enable(1),Ae.layers.enable(2);var ue=new pn,Ve;function ke(){var Ne=d.isPresenting=v!==null&&v.isPresenting===!0;if(Ne){var ct=v.getEyeParameters("left");r=2*ct.renderWidth*ne,l=ct.renderHeight*ne,Ve=A.getPixelRatio(),A.getSize(ue),A.setDrawingBufferSize(r,l,1),Te.viewport.set(0,0,r/2,l),Fe.viewport.set(r/2,0,r/2,l),Ht.start(),d.dispatchEvent({type:"sessionstart"})}else d.enabled&&A.setDrawingBufferSize(ue.width,ue.height,Ve),Ht.stop(),d.dispatchEvent({type:"sessionend"})}var je=[],st=[];function At(Ne){for(var ct=navigator.getGamepads&&navigator.getGamepads(),It=0,Nt=ct.length;It<Nt;It++){var Pt=ct[It];if(Pt&&(Pt.id==="Daydream Controller"||Pt.id==="Gear VR Controller"||Pt.id==="Oculus Go Controller"||Pt.id==="OpenVR Gamepad"||Pt.id.startsWith("Oculus Touch")||Pt.id.startsWith("HTC Vive Focus")||Pt.id.startsWith("Spatial Controller"))){var Gt=Pt.hand;if(Ne===0&&(Gt===""||Gt==="right")||Ne===1&&Gt==="left")return Pt}}}function Et(){for(var Ne=0;Ne<O.length;Ne++){var ct=O[Ne],It=At(Ne);if(It!==void 0&&It.pose!==void 0){if(It.pose===null)return;var Nt=It.pose;Nt.hasPosition===!1&&ct.position.set(.2,-.6,-.05),Nt.position!==null&&ct.position.fromArray(Nt.position),Nt.orientation!==null&&ct.quaternion.fromArray(Nt.orientation),ct.matrix.compose(ct.position,ct.quaternion,ct.scale),ct.matrix.premultiply(z),ct.matrix.decompose(ct.position,ct.quaternion,ct.scale),ct.matrixWorldNeedsUpdate=!0,ct.visible=!0;var Pt=It.id==="Daydream Controller"?0:1;je[Ne]===void 0&&(je[Ne]=!1),je[Ne]!==It.buttons[Pt].pressed&&(je[Ne]=It.buttons[Pt].pressed,je[Ne]===!0?ct.dispatchEvent({type:"selectstart"}):(ct.dispatchEvent({type:"selectend"}),ct.dispatchEvent({type:"select"}))),Pt=2,st[Ne]===void 0&&(st[Ne]=!1),It.buttons[Pt]!==void 0&&st[Ne]!==It.buttons[Pt].pressed&&(st[Ne]=It.buttons[Pt].pressed,st[Ne]===!0?ct.dispatchEvent({type:"squeezestart"}):(ct.dispatchEvent({type:"squeezeend"}),ct.dispatchEvent({type:"squeeze"})))}else ct.visible=!1}}function Xt(Ne,ct){ct!==null&&ct.length===4&&Ne.set(ct[0]*r,ct[1]*l,ct[2]*r,ct[3]*l)}this.enabled=!1,this.getController=function(Ne){var ct=O[Ne];return ct===void 0&&(ct=new oc,ct.matrixAutoUpdate=!1,ct.visible=!1,O[Ne]=ct),ct},this.getDevice=function(){return v},this.setDevice=function(Ne){Ne!==void 0&&(v=Ne),Ht.setContext(Ne)},this.setFramebufferScaleFactor=function(Ne){ne=Ne},this.setReferenceSpaceType=function(Ne){re=Ne},this.setPoseTarget=function(Ne){Ne!==void 0&&(C=Ne)},this.getCamera=function(Ne){var ct=re==="local-floor"?1.6:0;if(v.depthNear=Ne.near,v.depthFar=Ne.far,v.getFrameData(w),re==="local-floor"){var It=v.stageParameters;It?z.fromArray(It.sittingToStandingTransform):z.makeTranslation(0,ct,0)}var Nt=w.pose,Pt=C!==null?C:Ne;Pt.matrix.copy(z),Pt.matrix.decompose(Pt.position,Pt.quaternion,Pt.scale),Nt.orientation!==null&&(oe.fromArray(Nt.orientation),Pt.quaternion.multiply(oe)),Nt.position!==null&&(oe.setFromRotationMatrix(z),ve.fromArray(Nt.position),ve.applyQuaternion(oe),Pt.position.add(ve)),Pt.updateMatrixWorld();for(var Gt=Pt.children,sn=0,bn=Gt.length;sn<bn;sn++)Gt[sn].updateMatrixWorld(!0);Te.near=Ne.near,Fe.near=Ne.near,Te.far=Ne.far,Fe.far=Ne.far,Te.matrixWorldInverse.fromArray(w.leftViewMatrix),Fe.matrixWorldInverse.fromArray(w.rightViewMatrix),H.getInverse(z),re==="local-floor"&&(Te.matrixWorldInverse.multiply(H),Fe.matrixWorldInverse.multiply(H));var kn=Pt.parent;kn!==null&&(se.getInverse(kn.matrixWorld),Te.matrixWorldInverse.multiply(se),Fe.matrixWorldInverse.multiply(se)),Te.matrixWorld.getInverse(Te.matrixWorldInverse),Fe.matrixWorld.getInverse(Fe.matrixWorldInverse),Te.projectionMatrix.fromArray(w.leftProjectionMatrix),Fe.projectionMatrix.fromArray(w.rightProjectionMatrix),ID(Ae,Te,Fe);var si=v.getLayers();if(si.length){var Vn=si[0];Xt(Te.viewport,Vn.leftBounds),Xt(Fe.viewport,Vn.rightBounds)}return Et(),Ae},this.getStandingMatrix=function(){return z},this.isPresenting=!1;var Ht=new T1;this.setAnimationLoop=function(Ne){Ht.setAnimationLoop(Ne),this.isPresenting&&Ht.start()},this.submitFrame=function(){this.isPresenting&&v.submitFrame()},this.dispose=function(){typeof window!="undefined"&&window.removeEventListener("vrdisplaypresentchange",ke)},this.setFrameOfReferenceType=function(){console.warn("THREE.WebVRManager: setFrameOfReferenceType() has been deprecated.")},this.addEventListener=function(){}}Object.assign(OE.prototype,hl.prototype);const OD={type:"move"};class B1{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new oc,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new oc,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new qe,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new qe),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new oc,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new qe,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new qe),this._grip}dispatchEvent(r){return this._targetRay!==null&&this._targetRay.dispatchEvent(r),this._grip!==null&&this._grip.dispatchEvent(r),this._hand!==null&&this._hand.dispatchEvent(r),this}disconnect(r){return this.dispatchEvent({type:"disconnected",data:r}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(r,l,d){let v=null,w=null,C=null;const O=this._targetRay,z=this._grip,H=this._hand;if(r&&l.session.visibilityState!=="visible-blurred")if(O!==null&&(v=l.getPose(r.targetRaySpace,d),v!==null&&(O.matrix.fromArray(v.transform.matrix),O.matrix.decompose(O.position,O.rotation,O.scale),v.linearVelocity?(O.hasLinearVelocity=!0,O.linearVelocity.copy(v.linearVelocity)):O.hasLinearVelocity=!1,v.angularVelocity?(O.hasAngularVelocity=!0,O.angularVelocity.copy(v.angularVelocity)):O.hasAngularVelocity=!1,this.dispatchEvent(OD))),H&&r.hand){C=!0;for(const Te of r.hand.values()){const Fe=l.getJointPose(Te,d);if(H.joints[Te.jointName]===void 0){const ue=new oc;ue.matrixAutoUpdate=!1,ue.visible=!1,H.joints[Te.jointName]=ue,H.add(ue)}const Ae=H.joints[Te.jointName];Fe!==null&&(Ae.matrix.fromArray(Fe.transform.matrix),Ae.matrix.decompose(Ae.position,Ae.rotation,Ae.scale),Ae.jointRadius=Fe.radius),Ae.visible=Fe!==null}const ne=H.joints["index-finger-tip"],re=H.joints["thumb-tip"],se=ne.position.distanceTo(re.position),oe=.02,ve=.005;H.inputState.pinching&&se>oe+ve?(H.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:r.handedness,target:this})):!H.inputState.pinching&&se<=oe-ve&&(H.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:r.handedness,target:this}))}else z!==null&&r.gripSpace&&(w=l.getPose(r.gripSpace,d),w!==null&&(z.matrix.fromArray(w.transform.matrix),z.matrix.decompose(z.position,z.rotation,z.scale),w.linearVelocity?(z.hasLinearVelocity=!0,z.linearVelocity.copy(w.linearVelocity)):z.hasLinearVelocity=!1,w.angularVelocity?(z.hasAngularVelocity=!0,z.angularVelocity.copy(w.angularVelocity)):z.hasAngularVelocity=!1));return O!==null&&(O.visible=v!==null),z!==null&&(z.visible=w!==null),H!==null&&(H.visible=C!==null),this}}class S0 extends Xr{constructor(r,l,d,v,w,C,O,z,H,ne){if(ne=ne!==void 0?ne:dt,ne!==dt&&ne!==Re)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");d===void 0&&ne===dt&&(d=wn),d===void 0&&ne===Re&&(d=be),super(null,v,w,C,O,z,ne,d,H),this.image={width:r,height:l},this.magFilter=O!==void 0?O:at,this.minFilter=z!==void 0?z:at,this.flipY=!1,this.generateMipmaps=!1}}S0.prototype.isDepthTexture=!0;class DD extends hl{constructor(r,l){super();const d=this;let v=null,w=1;var C=null;let O=null,z="local-floor";const H=r.extensions.has("WEBGL_multisampled_render_to_texture");let ne=null;var re=[];let se=null,oe=null,ve=null,Te=!1,Fe=null;const Ae=l.getContextAttributes();let ue=null,Ve=null;const ke=[],je=new Map,st=new qr;st.layers.enable(1),st.viewport=new nr;const At=new qr;At.layers.enable(2),At.viewport=new nr;const Et=[st,At],Xt=new M0;Xt.layers.enable(1),Xt.layers.enable(2);let Ht=null,Ne=null;this.cameraAutoUpdate=!0,this.layersEnabled=!1,this.enabled=!1,this.isPresenting=!1,this.getCameraPose=function(){return ne},this.getController=function(fn){let Pn=ke[fn];return Pn===void 0&&(Pn=new B1,ke[fn]=Pn),Pn.getTargetRaySpace()},this.getControllerGrip=function(fn){let Pn=ke[fn];return Pn===void 0&&(Pn=new B1,ke[fn]=Pn),Pn.getGripSpace()},this.getHand=function(fn){let Pn=ke[fn];return Pn===void 0&&(Pn=new B1,ke[fn]=Pn),Pn.getHandSpace()};function ct(fn){const Pn=je.get(fn.inputSource);Pn&&Pn.dispatchEvent({type:fn.type,data:fn.inputSource})}function It(){je.forEach(function(fn,Pn){fn.disconnect(Pn)}),je.clear(),Ht=null,Ne=null,r.setRenderTarget(ue),ve=null,oe=null,se=null,v=null,Ve=null,Vn.stop(),d.isPresenting=!1,d.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(fn){w=fn,d.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(fn){z=fn,d.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return O},this.getBaseLayer=function(){return oe!==null?oe:ve},this.getBinding=function(){return se},this.getFrame=function(){return Fe},this.getSession=function(){return v},this.setSession=async function(fn){if(v=fn,v!==null){if(ue=r.getRenderTarget(),v.addEventListener("select",ct),v.addEventListener("selectstart",ct),v.addEventListener("selectend",ct),v.addEventListener("squeeze",ct),v.addEventListener("squeezestart",ct),v.addEventListener("squeezeend",ct),v.addEventListener("end",It),v.addEventListener("inputsourceschange",Nt),Ae.xrCompatible!==!0&&await l.makeXRCompatible(),v.renderState.layers===void 0||r.capabilities.isWebGL2===!1){const Pn={antialias:v.renderState.layers===void 0?Ae.antialias:!0,alpha:Ae.alpha,depth:Ae.depth,stencil:Ae.stencil,framebufferScaleFactor:w};ve=new XRWebGLLayer(v,l,Pn),v.updateRenderState({baseLayer:ve}),Ve=new fo(ve.framebufferWidth,ve.framebufferHeight,{format:Se,type:un,encoding:r.outputEncoding})}else{Te=Ae.antialias;let Pn=null,li=null,Mt=null;Ae.depth&&(Mt=Ae.stencil?l.DEPTH24_STENCIL8:l.DEPTH_COMPONENT24,Pn=Ae.stencil?Re:dt,li=Ae.stencil?be:wn);const fi={colorFormat:r.outputEncoding===Li?l.SRGB8_ALPHA8:l.RGBA8,depthFormat:Mt,scaleFactor:w};se=new XRWebGLBinding(v,l),oe=se.createProjectionLayer(fi),v.updateRenderState({layers:[oe]}),Te?Ve=new Qm(oe.textureWidth,oe.textureHeight,{format:Se,type:un,depthTexture:new S0(oe.textureWidth,oe.textureHeight,li,void 0,void 0,void 0,void 0,void 0,void 0,Pn),stencilBuffer:Ae.stencil,ignoreDepth:oe.ignoreDepthValues,useRenderToTexture:H,encoding:r.outputEncoding}):Ve=new fo(oe.textureWidth,oe.textureHeight,{format:Se,type:un,depthTexture:new S0(oe.textureWidth,oe.textureHeight,li,void 0,void 0,void 0,void 0,void 0,void 0,Pn),stencilBuffer:Ae.stencil,ignoreDepth:oe.ignoreDepthValues,encoding:r.outputEncoding})}Ve.isXRRenderTarget=!0,this.setFoveation(1),O=await v.requestReferenceSpace(z),Vn.setContext(v),Vn.start(),d.isPresenting=!0,d.dispatchEvent({type:"sessionstart"})}},this.addLayer=function(fn){!window.XRWebGLBinding||!this.layersEnabled||!v||(re.push(fn),this.updateLayers())},this.removeLayer=function(fn){!window.XRWebGLBinding||!this.layersEnabled||!v||(re.splice(re.indexOf(fn),1),this.updateLayers())},this.updateLayers=function(){var fn=re.map(function(Pn){return Pn});fn.unshift(v.renderState.layers[0]),v.updateRenderState({layers:fn})};function Nt(fn){const Pn=v.inputSources;for(let li=0;li<ke.length;li++)je.set(Pn[li],ke[li]);for(let li=0;li<fn.removed.length;li++){const Mt=fn.removed[li],fi=je.get(Mt);fi&&(fi.dispatchEvent({type:"disconnected",data:Mt}),je.delete(Mt))}for(let li=0;li<fn.added.length;li++){const Mt=fn.added[li],fi=je.get(Mt);fi&&fi.dispatchEvent({type:"connected",data:Mt})}}const Pt=new qe,Gt=new qe;function sn(fn,Pn,li){Pt.setFromMatrixPosition(Pn.matrixWorld),Gt.setFromMatrixPosition(li.matrixWorld);const Mt=Pt.distanceTo(Gt),fi=Pn.projectionMatrix.elements,Qn=li.projectionMatrix.elements,di=fi[14]/(fi[10]-1),Wn=fi[14]/(fi[10]+1),Si=(fi[9]+1)/fi[5],pi=(fi[9]-1)/fi[5],ln=(fi[8]-1)/fi[0],In=(Qn[8]+1)/Qn[0],Dn=di*ln,ti=di*In,Hn=Mt/(-ln+In),yi=Hn*-ln;Pn.matrixWorld.decompose(fn.position,fn.quaternion,fn.scale),fn.translateX(yi),fn.translateZ(Hn),fn.matrixWorld.compose(fn.position,fn.quaternion,fn.scale),fn.matrixWorldInverse.copy(fn.matrixWorld).invert();const mi=di+Hn,zi=Wn+Hn,vr=Dn-yi,cr=ti+(Mt-yi),ht=Si*Wn/zi*mi,Qe=pi*Wn/zi*mi;fn.projectionMatrix.makePerspective(vr,cr,ht,Qe,mi,zi)}function bn(fn,Pn){Pn===null?fn.matrixWorld.copy(fn.matrix):fn.matrixWorld.multiplyMatrices(Pn.matrixWorld,fn.matrix),fn.matrixWorldInverse.copy(fn.matrixWorld).invert()}this.setPoseTarget=function(fn){fn!==void 0&&(C=fn)},this.updateCamera=function(fn){if(v===null)return;Xt.near=At.near=st.near=fn.near,Xt.far=At.far=st.far=fn.far,(Ht!==Xt.near||Ne!==Xt.far)&&(v.updateRenderState({depthNear:Xt.near,depthFar:Xt.far}),Ht=Xt.near,Ne=Xt.far);const Pn=Xt.cameras;var li=C||fn;const Mt=li.parent;bn(Xt,Mt);for(let Qn=0;Qn<Pn.length;Qn++)bn(Pn[Qn],Mt);Xt.matrixWorld.decompose(Xt.position,Xt.quaternion,Xt.scale),li.matrixWorld.copy(Xt.matrixWorld),li.matrix.copy(Xt.matrix),li.matrix.decompose(li.position,li.quaternion,li.scale);const fi=li.children;for(let Qn=0,di=fi.length;Qn<di;Qn++)fi[Qn].updateMatrixWorld(!0);Pn.length===2?sn(Xt,st,At):Xt.projectionMatrix.copy(st.projectionMatrix)},this.getCamera=function(){return Xt},this.getFoveation=function(){if(oe!==null)return oe.fixedFoveation;if(ve!==null)return ve.fixedFoveation},this.setFoveation=function(fn){oe!==null&&(oe.fixedFoveation=fn),ve!==null&&ve.fixedFoveation!==void 0&&(ve.fixedFoveation=fn)};let kn=null;function si(fn,Pn){if(ne=Pn.getViewerPose(O),Fe=Pn,ne!==null){const Mt=ne.views;ve!==null&&(r.setRenderTargetFramebuffer(Ve,ve.framebuffer),r.setRenderTarget(Ve));let fi=!1;Mt.length!==Xt.cameras.length&&(Xt.cameras.length=0,fi=!0);for(let Qn=0;Qn<Mt.length;Qn++){const di=Mt[Qn];let Wn=null;if(ve!==null)Wn=ve.getViewport(di);else{const pi=se.getViewSubImage(oe,di);Wn=pi.viewport,Qn===0&&(r.setRenderTargetTextures(Ve,pi.colorTexture,oe.ignoreDepthValues?void 0:pi.depthStencilTexture),r.setRenderTarget(Ve))}const Si=Et[Qn];Si.matrix.fromArray(di.transform.matrix),Si.projectionMatrix.fromArray(di.projectionMatrix),Si.viewport.set(Wn.x,Wn.y,Wn.width,Wn.height),Qn===0&&Xt.matrix.copy(Si.matrix),fi===!0&&Xt.cameras.push(Si)}}const li=v.inputSources;for(let Mt=0;Mt<ke.length;Mt++){const fi=ke[Mt],Qn=li[Mt];fi.update(Qn,Pn,O)}kn&&kn(fn,Pn),Fe=null}const Vn=new T1;Vn.setAnimationLoop(si),this.setAnimationLoop=function(fn){kn=fn},this.dispose=function(){}}}function BD(A){function r(Ae,ue){Ae.fogColor.value.copy(ue.color),ue.isFog?(Ae.fogNear.value=ue.near,Ae.fogFar.value=ue.far):ue.isFogExp2&&(Ae.fogDensity.value=ue.density)}function l(Ae,ue,Ve,ke,je){ue.isMeshBasicMaterial?d(Ae,ue):ue.isMeshLambertMaterial?(d(Ae,ue),z(Ae,ue)):ue.isMeshToonMaterial?(d(Ae,ue),ne(Ae,ue)):ue.isMeshPhongMaterial?(d(Ae,ue),H(Ae,ue)):ue.isMeshStandardMaterial?(d(Ae,ue),ue.isMeshPhysicalMaterial?se(Ae,ue,je):re(Ae,ue)):ue.isMeshMatcapMaterial?(d(Ae,ue),oe(Ae,ue)):ue.isMeshDepthMaterial?(d(Ae,ue),ve(Ae,ue)):ue.isMeshDistanceMaterial?(d(Ae,ue),Te(Ae,ue)):ue.isMeshNormalMaterial?(d(Ae,ue),Fe(Ae,ue)):ue.isLineBasicMaterial?(v(Ae,ue),ue.isLineDashedMaterial&&w(Ae,ue)):ue.isPointsMaterial?C(Ae,ue,Ve,ke):ue.isSpriteMaterial?O(Ae,ue):ue.isShadowMaterial?(Ae.color.value.copy(ue.color),Ae.opacity.value=ue.opacity):ue.isShaderMaterial&&(ue.uniformsNeedUpdate=!1)}function d(Ae,ue){Ae.opacity.value=ue.opacity,ue.color&&Ae.diffuse.value.copy(ue.color),ue.emissive&&Ae.emissive.value.copy(ue.emissive).multiplyScalar(ue.emissiveIntensity),ue.map&&(Ae.map.value=ue.map),ue.alphaMap&&(Ae.alphaMap.value=ue.alphaMap),ue.specularMap&&(Ae.specularMap.value=ue.specularMap),ue.alphaTest>0&&(Ae.alphaTest.value=ue.alphaTest);const Ve=A.get(ue).envMap;Ve&&(Ae.envMap.value=Ve,Ae.flipEnvMap.value=Ve.isCubeTexture&&Ve.isRenderTargetTexture===!1?-1:1,Ae.reflectivity.value=ue.reflectivity,Ae.ior.value=ue.ior,Ae.refractionRatio.value=ue.refractionRatio),ue.lightMap&&(Ae.lightMap.value=ue.lightMap,Ae.lightMapIntensity.value=ue.lightMapIntensity),ue.aoMap&&(Ae.aoMap.value=ue.aoMap,Ae.aoMapIntensity.value=ue.aoMapIntensity);let ke;ue.map?ke=ue.map:ue.specularMap?ke=ue.specularMap:ue.displacementMap?ke=ue.displacementMap:ue.normalMap?ke=ue.normalMap:ue.bumpMap?ke=ue.bumpMap:ue.roughnessMap?ke=ue.roughnessMap:ue.metalnessMap?ke=ue.metalnessMap:ue.alphaMap?ke=ue.alphaMap:ue.emissiveMap?ke=ue.emissiveMap:ue.clearcoatMap?ke=ue.clearcoatMap:ue.clearcoatNormalMap?ke=ue.clearcoatNormalMap:ue.clearcoatRoughnessMap?ke=ue.clearcoatRoughnessMap:ue.specularIntensityMap?ke=ue.specularIntensityMap:ue.specularColorMap?ke=ue.specularColorMap:ue.transmissionMap?ke=ue.transmissionMap:ue.thicknessMap?ke=ue.thicknessMap:ue.sheenColorMap?ke=ue.sheenColorMap:ue.sheenRoughnessMap&&(ke=ue.sheenRoughnessMap),ke!==void 0&&(ke.isWebGLRenderTarget&&(ke=ke.texture),ke.matrixAutoUpdate===!0&&ke.updateMatrix(),Ae.uvTransform.value.copy(ke.matrix));let je;ue.aoMap?je=ue.aoMap:ue.lightMap&&(je=ue.lightMap),je!==void 0&&(je.isWebGLRenderTarget&&(je=je.texture),je.matrixAutoUpdate===!0&&je.updateMatrix(),Ae.uv2Transform.value.copy(je.matrix))}function v(Ae,ue){Ae.diffuse.value.copy(ue.color),Ae.opacity.value=ue.opacity}function w(Ae,ue){Ae.dashSize.value=ue.dashSize,Ae.totalSize.value=ue.dashSize+ue.gapSize,Ae.scale.value=ue.scale}function C(Ae,ue,Ve,ke){Ae.diffuse.value.copy(ue.color),Ae.opacity.value=ue.opacity,Ae.size.value=ue.size*Ve,Ae.scale.value=ke*.5,ue.map&&(Ae.map.value=ue.map),ue.alphaMap&&(Ae.alphaMap.value=ue.alphaMap),ue.alphaTest>0&&(Ae.alphaTest.value=ue.alphaTest);let je;ue.map?je=ue.map:ue.alphaMap&&(je=ue.alphaMap),je!==void 0&&(je.matrixAutoUpdate===!0&&je.updateMatrix(),Ae.uvTransform.value.copy(je.matrix))}function O(Ae,ue){Ae.diffuse.value.copy(ue.color),Ae.opacity.value=ue.opacity,Ae.rotation.value=ue.rotation,ue.map&&(Ae.map.value=ue.map),ue.alphaMap&&(Ae.alphaMap.value=ue.alphaMap),ue.alphaTest>0&&(Ae.alphaTest.value=ue.alphaTest);let Ve;ue.map?Ve=ue.map:ue.alphaMap&&(Ve=ue.alphaMap),Ve!==void 0&&(Ve.matrixAutoUpdate===!0&&Ve.updateMatrix(),Ae.uvTransform.value.copy(Ve.matrix))}function z(Ae,ue){ue.emissiveMap&&(Ae.emissiveMap.value=ue.emissiveMap)}function H(Ae,ue){Ae.specular.value.copy(ue.specular),Ae.shininess.value=Math.max(ue.shininess,1e-4),ue.emissiveMap&&(Ae.emissiveMap.value=ue.emissiveMap),ue.bumpMap&&(Ae.bumpMap.value=ue.bumpMap,Ae.bumpScale.value=ue.bumpScale,ue.side===T&&(Ae.bumpScale.value*=-1)),ue.normalMap&&(Ae.normalMap.value=ue.normalMap,Ae.normalScale.value.copy(ue.normalScale),ue.side===T&&Ae.normalScale.value.negate()),ue.displacementMap&&(Ae.displacementMap.value=ue.displacementMap,Ae.displacementScale.value=ue.displacementScale,Ae.displacementBias.value=ue.displacementBias)}function ne(Ae,ue){ue.gradientMap&&(Ae.gradientMap.value=ue.gradientMap),ue.emissiveMap&&(Ae.emissiveMap.value=ue.emissiveMap),ue.bumpMap&&(Ae.bumpMap.value=ue.bumpMap,Ae.bumpScale.value=ue.bumpScale,ue.side===T&&(Ae.bumpScale.value*=-1)),ue.normalMap&&(Ae.normalMap.value=ue.normalMap,Ae.normalScale.value.copy(ue.normalScale),ue.side===T&&Ae.normalScale.value.negate()),ue.displacementMap&&(Ae.displacementMap.value=ue.displacementMap,Ae.displacementScale.value=ue.displacementScale,Ae.displacementBias.value=ue.displacementBias)}function re(Ae,ue){Ae.roughness.value=ue.roughness,Ae.metalness.value=ue.metalness,ue.roughnessMap&&(Ae.roughnessMap.value=ue.roughnessMap),ue.metalnessMap&&(Ae.metalnessMap.value=ue.metalnessMap),ue.emissiveMap&&(Ae.emissiveMap.value=ue.emissiveMap),ue.bumpMap&&(Ae.bumpMap.value=ue.bumpMap,Ae.bumpScale.value=ue.bumpScale,ue.side===T&&(Ae.bumpScale.value*=-1)),ue.normalMap&&(Ae.normalMap.value=ue.normalMap,Ae.normalScale.value.copy(ue.normalScale),ue.side===T&&Ae.normalScale.value.negate()),ue.displacementMap&&(Ae.displacementMap.value=ue.displacementMap,Ae.displacementScale.value=ue.displacementScale,Ae.displacementBias.value=ue.displacementBias),A.get(ue).envMap&&(Ae.envMapIntensity.value=ue.envMapIntensity)}function se(Ae,ue,Ve){re(Ae,ue),Ae.ior.value=ue.ior,ue.sheen>0&&(Ae.sheenColor.value.copy(ue.sheenColor).multiplyScalar(ue.sheen),Ae.sheenRoughness.value=ue.sheenRoughness,ue.sheenColorMap&&(Ae.sheenColorMap.value=ue.sheenColorMap),ue.sheenRoughnessMap&&(Ae.sheenRoughnessMap.value=ue.sheenRoughnessMap)),ue.clearcoat>0&&(Ae.clearcoat.value=ue.clearcoat,Ae.clearcoatRoughness.value=ue.clearcoatRoughness,ue.clearcoatMap&&(Ae.clearcoatMap.value=ue.clearcoatMap),ue.clearcoatRoughnessMap&&(Ae.clearcoatRoughnessMap.value=ue.clearcoatRoughnessMap),ue.clearcoatNormalMap&&(Ae.clearcoatNormalScale.value.copy(ue.clearcoatNormalScale),Ae.clearcoatNormalMap.value=ue.clearcoatNormalMap,ue.side===T&&Ae.clearcoatNormalScale.value.negate())),ue.transmission>0&&(Ae.transmission.value=ue.transmission,Ae.transmissionSamplerMap.value=Ve.texture,Ae.transmissionSamplerSize.value.set(Ve.width,Ve.height),ue.transmissionMap&&(Ae.transmissionMap.value=ue.transmissionMap),Ae.thickness.value=ue.thickness,ue.thicknessMap&&(Ae.thicknessMap.value=ue.thicknessMap),Ae.attenuationDistance.value=ue.attenuationDistance,Ae.attenuationColor.value.copy(ue.attenuationColor)),Ae.specularIntensity.value=ue.specularIntensity,Ae.specularColor.value.copy(ue.specularColor),ue.specularIntensityMap&&(Ae.specularIntensityMap.value=ue.specularIntensityMap),ue.specularColorMap&&(Ae.specularColorMap.value=ue.specularColorMap)}function oe(Ae,ue){ue.matcap&&(Ae.matcap.value=ue.matcap),ue.bumpMap&&(Ae.bumpMap.value=ue.bumpMap,Ae.bumpScale.value=ue.bumpScale,ue.side===T&&(Ae.bumpScale.value*=-1)),ue.normalMap&&(Ae.normalMap.value=ue.normalMap,Ae.normalScale.value.copy(ue.normalScale),ue.side===T&&Ae.normalScale.value.negate()),ue.displacementMap&&(Ae.displacementMap.value=ue.displacementMap,Ae.displacementScale.value=ue.displacementScale,Ae.displacementBias.value=ue.displacementBias)}function ve(Ae,ue){ue.displacementMap&&(Ae.displacementMap.value=ue.displacementMap,Ae.displacementScale.value=ue.displacementScale,Ae.displacementBias.value=ue.displacementBias)}function Te(Ae,ue){ue.displacementMap&&(Ae.displacementMap.value=ue.displacementMap,Ae.displacementScale.value=ue.displacementScale,Ae.displacementBias.value=ue.displacementBias),Ae.referencePosition.value.copy(ue.referencePosition),Ae.nearDistance.value=ue.nearDistance,Ae.farDistance.value=ue.farDistance}function Fe(Ae,ue){ue.bumpMap&&(Ae.bumpMap.value=ue.bumpMap,Ae.bumpScale.value=ue.bumpScale,ue.side===T&&(Ae.bumpScale.value*=-1)),ue.normalMap&&(Ae.normalMap.value=ue.normalMap,Ae.normalScale.value.copy(ue.normalScale),ue.side===T&&Ae.normalScale.value.negate()),ue.displacementMap&&(Ae.displacementMap.value=ue.displacementMap,Ae.displacementScale.value=ue.displacementScale,Ae.displacementBias.value=ue.displacementBias)}return{refreshFogUniforms:r,refreshMaterialUniforms:l}}function FD(){const A=ep("canvas");return A.style.display="block",A}function fr(A={}){const r=A.canvas!==void 0?A.canvas:FD(),l=A.context!==void 0?A.context:null,d=A.alpha!==void 0?A.alpha:!1,v=A.depth!==void 0?A.depth:!0,w=A.stencil!==void 0?A.stencil:!0,C=A.antialias!==void 0?A.antialias:!1,O=A.premultipliedAlpha!==void 0?A.premultipliedAlpha:!0,z=A.preserveDrawingBuffer!==void 0?A.preserveDrawingBuffer:!1,H=A.powerPreference!==void 0?A.powerPreference:"default",ne=A.failIfMajorPerformanceCaveat!==void 0?A.failIfMajorPerformanceCaveat:!1;let re=null,se=null;const oe=[],ve=[];this.domElement=r,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Qi,this.physicallyCorrectLights=!1,this.toneMapping=Ee,this.toneMappingExposure=1;const Te=this;let Fe=!1,Ae=0,ue=0,Ve=null,ke=-1,je=null;const st=new nr,At=new nr;let Et=null,Xt=r.width,Ht=r.height,Ne=1,ct=null,It=null;const Nt=new nr(0,0,Xt,Ht),Pt=new nr(0,0,Xt,Ht);let Gt=!1;const sn=new sp;let bn=!1,kn=!1,si=null;const Vn=new Jn,fn=new qe,Pn={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function li(){return Ve===null?Ne:1}let Mt=l;function fi(et,kt){for(let Yt=0;Yt<et.length;Yt++){const qt=et[Yt],mn=r.getContext(qt,kt);if(mn!==null)return mn}return null}try{const et={alpha:!0,depth:v,stencil:w,antialias:C,premultipliedAlpha:O,preserveDrawingBuffer:z,powerPreference:H,failIfMajorPerformanceCaveat:ne};if("setAttribute"in r&&r.setAttribute("data-engine",`three.js r${c}`),r.addEventListener("webglcontextlost",Ti,!1),r.addEventListener("webglcontextrestored",_t,!1),Mt===null){const kt=["webgl2","webgl","experimental-webgl"];if(Te.isWebGL1Renderer===!0&&kt.shift(),Mt=fi(kt,et),Mt===null)throw fi(kt)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}Mt.getShaderPrecisionFormat===void 0&&(Mt.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(et){throw console.error("THREE.WebGLRenderer: "+et.message),et}let Qn,di,Wn,Si,pi,ln,In,Dn,ti,Hn,yi,mi,zi,vr,cr,ht,Qe,cn,On,ri,an,ci,oi;function Gn(){Qn=new t5(Mt),di=new YO(Mt,Qn,A),Qn.init(di),ci=new LE(Mt,Qn,di),Wn=new LD(Mt,Qn,di),Si=new r5(Mt),pi=new xD,ln=new PD(Mt,Qn,Wn,pi,di,ci,Si),In=new KO(Te),Dn=new e5(Te),ti=new KI(Mt,di),oi=new $O(Mt,Qn,ti,di),Hn=new n5(Mt,ti,Si,oi),yi=new l5(Mt,Hn,ti,Si),On=new a5(Mt,di,ln),ht=new QO(pi),mi=new yD(Te,In,Dn,Qn,di,oi,ht),zi=new BD(pi),vr=new bD,cr=new TD(Qn,di),cn=new XO(Te,In,Wn,yi,d,O),Qe=new RE(Te,yi,di),ri=new qO(Mt,Qn,Si,di),an=new i5(Mt,Qn,Si,di),Si.programs=mi.programs,Te.capabilities=di,Te.extensions=Qn,Te.properties=pi,Te.renderLists=vr,Te.shadowMap=Qe,Te.state=Wn,Te.info=Si}Gn();const Nn=typeof navigator!="undefined"&&"xr"in navigator?new DD(Te,Mt):new OE(Te);this.xr=Nn,this.getContext=function(){return Mt},this.getContextAttributes=function(){return Mt.getContextAttributes()},this.forceContextLoss=function(){const et=Qn.get("WEBGL_lose_context");et&&et.loseContext()},this.forceContextRestore=function(){const et=Qn.get("WEBGL_lose_context");et&&et.restoreContext()},this.getPixelRatio=function(){return Ne},this.setPixelRatio=function(et){et!==void 0&&(Ne=et,this.setSize(Xt,Ht,!1))},this.getSize=function(et){return et.set(Xt,Ht)},this.setSize=function(et,kt,Yt){if(Nn.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}Xt=et,Ht=kt,r.width=Math.floor(et*Ne),r.height=Math.floor(kt*Ne),Yt!==!1&&(r.style.width=et+"px",r.style.height=kt+"px"),this.setViewport(0,0,et,kt)},this.getDrawingBufferSize=function(et){return et.set(Xt*Ne,Ht*Ne).floor()},this.setDrawingBufferSize=function(et,kt,Yt){Xt=et,Ht=kt,Ne=Yt,r.width=Math.floor(et*Yt),r.height=Math.floor(kt*Yt),this.setViewport(0,0,et,kt)},this.getCurrentViewport=function(et){return et.copy(st)},this.getViewport=function(et){return et.copy(Nt)},this.setViewport=function(et,kt,Yt,qt){et.isVector4?Nt.set(et.x,et.y,et.z,et.w):Nt.set(et,kt,Yt,qt),Wn.viewport(st.copy(Nt).multiplyScalar(Ne).floor())},this.getScissor=function(et){return et.copy(Pt)},this.setScissor=function(et,kt,Yt,qt){et.isVector4?Pt.set(et.x,et.y,et.z,et.w):Pt.set(et,kt,Yt,qt),Wn.scissor(At.copy(Pt).multiplyScalar(Ne).floor())},this.getScissorTest=function(){return Gt},this.setScissorTest=function(et){Wn.setScissorTest(Gt=et)},this.setOpaqueSort=function(et){ct=et},this.setTransparentSort=function(et){It=et},this.getClearColor=function(et){return et.copy(cn.getClearColor())},this.setClearColor=function(){cn.setClearColor.apply(cn,arguments)},this.getClearAlpha=function(){return cn.getClearAlpha()},this.setClearAlpha=function(){cn.setClearAlpha.apply(cn,arguments)},this.clear=function(et,kt,Yt){let qt=0;(et===void 0||et)&&(qt|=Mt.COLOR_BUFFER_BIT),(kt===void 0||kt)&&(qt|=Mt.DEPTH_BUFFER_BIT),(Yt===void 0||Yt)&&(qt|=Mt.STENCIL_BUFFER_BIT),Mt.clear(qt)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){r.removeEventListener("webglcontextlost",Ti,!1),r.removeEventListener("webglcontextrestored",_t,!1),vr.dispose(),cr.dispose(),pi.dispose(),In.dispose(),Dn.dispose(),yi.dispose(),oi.dispose(),mi.dispose(),Nn.dispose(),Nn.removeEventListener("sessionstart",Vi),Nn.removeEventListener("sessionend",Mr),si&&(si.dispose(),si=null),yo.stop()};function Ti(et){et.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),Fe=!0}function _t(){console.log("THREE.WebGLRenderer: Context Restored."),Fe=!1;const et=Si.autoReset,kt=Qe.enabled,Yt=Qe.autoUpdate,qt=Qe.needsUpdate,mn=Qe.type;Gn(),Si.autoReset=et,Qe.enabled=kt,Qe.autoUpdate=Yt,Qe.needsUpdate=qt,Qe.type=mn}function ii(et){const kt=et.target;kt.removeEventListener("dispose",ii),Kn(kt)}function Kn(et){xi(et),pi.remove(et)}function xi(et){const kt=pi.get(et).programs;kt!==void 0&&(kt.forEach(function(Yt){mi.releaseProgram(Yt)}),et.isShaderMaterial&&mi.releaseShaderCache(et))}this.renderBufferDirect=function(et,kt,Yt,qt,mn,Ei){kt===null&&(kt=Pn);const Ci=mn.isMesh&&mn.matrixWorld.determinant()<0,Fi=N6(et,kt,Yt,qt,mn);Wn.setMaterial(qt,Ci);let Di=Yt.index;const ar=Yt.attributes.position;if(Di===null){if(ar===void 0||ar.count===0)return}else if(Di.count===0)return;let $i=1;qt.wireframe===!0&&(Di=Hn.getWireframeAttribute(Yt),$i=2),oi.setup(mn,qt,Fi,Yt,Di);let Ki,Ir=ri;Di!==null&&(Ki=ti.get(Di),Ir=an,Ir.setIndex(Ki));const Lu=Di!==null?Di.count:ar.count,_f=Yt.drawRange.start*$i,ir=Yt.drawRange.count*$i,Ia=Ei!==null?Ei.start*$i:0,ts=Ei!==null?Ei.count*$i:1/0,Oa=Math.max(_f,Ia),cg=Math.min(Lu,_f+ir,Ia+ts)-1,Da=Math.max(0,cg-Oa+1);if(Da!==0){if(mn.isMesh)qt.wireframe===!0?(Wn.setLineWidth(qt.wireframeLinewidth*li()),Ir.setMode(Mt.LINES)):Ir.setMode(Mt.TRIANGLES);else if(mn.isLine){let El=qt.linewidth;El===void 0&&(El=1),Wn.setLineWidth(El*li()),mn.isLineSegments?Ir.setMode(Mt.LINES):mn.isLineLoop?Ir.setMode(Mt.LINE_LOOP):Ir.setMode(Mt.LINE_STRIP)}else mn.isPoints?Ir.setMode(Mt.POINTS):mn.isSprite&&Ir.setMode(Mt.TRIANGLES);if(mn.isInstancedMesh)Ir.renderInstances(Oa,Da,mn.count);else if(Yt.isInstancedBufferGeometry){const El=Math.min(Yt.instanceCount,Yt._maxInstanceCount);Ir.renderInstances(Oa,Da,El)}else Ir.render(Oa,Da)}},this.compile=function(et,kt){se=cr.get(et),se.init(),ve.push(se),et.traverseVisible(function(Yt){Yt.isLight&&Yt.layers.test(kt.layers)&&(se.pushLight(Yt),Yt.castShadow&&se.pushShadow(Yt))}),se.setupLights(Te.physicallyCorrectLights),et.traverse(function(Yt){const qt=Yt.material;if(qt)if(Array.isArray(qt))for(let mn=0;mn<qt.length;mn++){const Ei=qt[mn];Rx(Ei,et,Yt)}else Rx(qt,et,Yt)}),ve.pop(),se=null};let dn=null;function hi(et){dn&&dn(et)}function Vi(){yo.stop()}function Mr(){yo.start()}const yo=new T1;yo.setAnimationLoop(hi),typeof window!="undefined"&&yo.setContext(window),this.setAnimationLoop=function(et){dn=et,Nn.setAnimationLoop(et),et===null?yo.stop():yo.start()},Nn.addEventListener("sessionstart",Vi),Nn.addEventListener("sessionend",Mr),this.render=function(et,kt){if(kt!==void 0&&kt.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(Fe===!0)return;et.autoUpdate===!0&&et.updateMatrixWorld(),kt.parent===null&&kt.updateMatrixWorld(),Nn.enabled===!0&&Nn.isPresenting===!0&&(Nn.cameraAutoUpdate===!0&&Nn.updateCamera(kt),kt=Nn.getCamera()),et.isScene===!0&&et.onBeforeRender(Te,et,kt,Ve),se=cr.get(et,ve.length),se.init(),ve.push(se),Vn.multiplyMatrices(kt.projectionMatrix,kt.matrixWorldInverse),sn.setFromProjectionMatrix(Vn),kn=this.localClippingEnabled,bn=ht.init(this.clippingPlanes,kn,kt),re=vr.get(et,oe.length),re.init(),oe.push(re),Pr(et,kt,0,Te.sortObjects),re.finish(),Te.sortObjects===!0&&re.sort(ct,It),bn===!0&&ht.beginShadows();const Yt=se.state.shadowsArray;if(Qe.render(Yt,et,kt),bn===!0&&ht.endShadows(),this.info.autoReset===!0&&this.info.reset(),cn.render(re,et),se.setupLights(Te.physicallyCorrectLights),kt.isArrayCamera){const qt=kt.cameras;for(let mn=0,Ei=qt.length;mn<Ei;mn++){const Ci=qt[mn];Pa(re,et,Ci,Ci.viewport)}}else Pa(re,et,kt);Ve!==null&&(ln.updateMultisampleRenderTarget(Ve),ln.updateRenderTargetMipmap(Ve)),et.isScene===!0&&et.onAfterRender(Te,et,kt),Wn.buffers.depth.setTest(!0),Wn.buffers.depth.setMask(!0),Wn.buffers.color.setMask(!0),Wn.setPolygonOffset(!1),Nn.enabled&&Nn.submitFrame&&Nn.submitFrame(),oi.resetDefaultState(),ke=-1,je=null,ve.pop(),ve.length>0?se=ve[ve.length-1]:se=null,oe.pop(),oe.length>0?re=oe[oe.length-1]:re=null};function Pr(et,kt,Yt,qt){if(et.visible===!1)return;if(et.layers.test(kt.layers)){if(et.isGroup)Yt=et.renderOrder;else if(et.isLOD)et.autoUpdate===!0&&et.update(kt);else if(et.isLight)se.pushLight(et),et.castShadow&&se.pushShadow(et);else if(et.isSprite){if(!et.frustumCulled||sn.intersectsSprite(et)){qt&&fn.setFromMatrixPosition(et.matrixWorld).applyMatrix4(Vn);const Ci=yi.update(et),Fi=et.material;Fi.visible&&re.push(et,Ci,Fi,Yt,fn.z,null)}}else if((et.isMesh||et.isLine||et.isPoints)&&(et.isSkinnedMesh&&et.skeleton.frame!==Si.render.frame&&(et.skeleton.update(),et.skeleton.frame=Si.render.frame),!et.frustumCulled||sn.intersectsObject(et))){qt&&fn.setFromMatrixPosition(et.matrixWorld).applyMatrix4(Vn);const Ci=yi.update(et),Fi=et.material;if(Array.isArray(Fi)){const Di=Ci.groups;for(let ar=0,$i=Di.length;ar<$i;ar++){const Ki=Di[ar],Ir=Fi[Ki.materialIndex];Ir&&Ir.visible&&re.push(et,Ci,Ir,Yt,fn.z,Ki)}}else Fi.visible&&re.push(et,Ci,Fi,Yt,fn.z,null)}}const Ei=et.children;for(let Ci=0,Fi=Ei.length;Ci<Fi;Ci++)Pr(Ei[Ci],kt,Yt,qt)}function Pa(et,kt,Yt,qt){const mn=et.opaque,Ei=et.transmissive,Ci=et.transparent;se.setupLightsView(Yt),Ei.length>0&&wl(mn,kt,Yt),qt&&Wn.viewport(st.copy(qt)),mn.length>0&&lg(mn,kt,Yt),Ei.length>0&&lg(Ei,kt,Yt),Ci.length>0&&lg(Ci,kt,Yt)}function wl(et,kt,Yt){if(si===null){const Ci=C===!0&&di.isWebGL2===!0?Qm:fo;si=new Ci(1024,1024,{generateMipmaps:!0,type:ci.convert(Zn)!==null?Zn:un,minFilter:gn,magFilter:at,wrapS:ye,wrapT:ye,useRenderToTexture:Qn.has("WEBGL_multisampled_render_to_texture")})}const qt=Te.getRenderTarget();Te.setRenderTarget(si),Te.clear();const mn=Te.toneMapping;Te.toneMapping=Ee,lg(et,kt,Yt),Te.toneMapping=mn,ln.updateMultisampleRenderTarget(si),ln.updateRenderTargetMipmap(si),Te.setRenderTarget(qt)}function lg(et,kt,Yt){const qt=kt.isScene===!0?kt.overrideMaterial:null;for(let mn=0,Ei=et.length;mn<Ei;mn++){const Ci=et[mn],Fi=Ci.object,Di=Ci.geometry,ar=qt===null?Ci.material:qt,$i=Ci.group;Fi.layers.test(Yt.layers)&&F6(Fi,kt,Yt,Di,ar,$i)}}function F6(et,kt,Yt,qt,mn,Ei){et.onBeforeRender(Te,kt,Yt,qt,mn,Ei),et.modelViewMatrix.multiplyMatrices(Yt.matrixWorldInverse,et.matrixWorld),et.normalMatrix.getNormalMatrix(et.modelViewMatrix),mn.onBeforeRender(Te,kt,Yt,qt,et,Ei),mn.transparent===!0&&mn.side===P?(mn.side=T,mn.needsUpdate=!0,Te.renderBufferDirect(Yt,kt,qt,mn,et,Ei),mn.side=E,mn.needsUpdate=!0,Te.renderBufferDirect(Yt,kt,qt,mn,et,Ei),mn.side=P):Te.renderBufferDirect(Yt,kt,qt,mn,et,Ei),et.onAfterRender(Te,kt,Yt,qt,mn,Ei)}function Rx(et,kt,Yt){kt.isScene!==!0&&(kt=Pn);const qt=pi.get(et),mn=se.state.lights,Ei=se.state.shadowsArray,Ci=mn.state.version,Fi=mi.getParameters(et,mn.state,Ei,kt,Yt),Di=mi.getProgramCacheKey(Fi);let ar=qt.programs;qt.environment=et.isMeshStandardMaterial?kt.environment:null,qt.fog=kt.fog,qt.envMap=(et.isMeshStandardMaterial?Dn:In).get(et.envMap||qt.environment),ar===void 0&&(et.addEventListener("dispose",ii),ar=new Map,qt.programs=ar);let $i=ar.get(Di);if($i!==void 0){if(qt.currentProgram===$i&&qt.lightsStateVersion===Ci)return u2(et,Fi),$i}else Fi.uniforms=mi.getUniforms(et),et.onBuild(Yt,Fi,Te),et.onBeforeCompile(Fi,Te),$i=mi.acquireProgram(Fi,Di),ar.set(Di,$i),qt.uniforms=Fi.uniforms;const Ki=qt.uniforms;(!et.isShaderMaterial&&!et.isRawShaderMaterial||et.clipping===!0)&&(Ki.clippingPlanes=ht.uniform),u2(et,Fi),qt.needsLights=k6(et),qt.lightsStateVersion=Ci,qt.needsLights&&(Ki.ambientLightColor.value=mn.state.ambient,Ki.lightProbe.value=mn.state.probe,Ki.directionalLights.value=mn.state.directional,Ki.directionalLightShadows.value=mn.state.directionalShadow,Ki.spotLights.value=mn.state.spot,Ki.spotLightShadows.value=mn.state.spotShadow,Ki.rectAreaLights.value=mn.state.rectArea,Ki.ltc_1.value=mn.state.rectAreaLTC1,Ki.ltc_2.value=mn.state.rectAreaLTC2,Ki.pointLights.value=mn.state.point,Ki.pointLightShadows.value=mn.state.pointShadow,Ki.hemisphereLights.value=mn.state.hemi,Ki.directionalShadowMap.value=mn.state.directionalShadowMap,Ki.directionalShadowMatrix.value=mn.state.directionalShadowMatrix,Ki.spotShadowMap.value=mn.state.spotShadowMap,Ki.spotShadowMatrix.value=mn.state.spotShadowMatrix,Ki.pointShadowMap.value=mn.state.pointShadowMap,Ki.pointShadowMatrix.value=mn.state.pointShadowMatrix);const Ir=$i.getUniforms(),Lu=sc.seqWithValue(Ir.seq,Ki);return qt.currentProgram=$i,qt.uniformsList=Lu,$i}function u2(et,kt){const Yt=pi.get(et);Yt.outputEncoding=kt.outputEncoding,Yt.instancing=kt.instancing,Yt.skinning=kt.skinning,Yt.morphTargets=kt.morphTargets,Yt.morphNormals=kt.morphNormals,Yt.morphTargetsCount=kt.morphTargetsCount,Yt.numClippingPlanes=kt.numClippingPlanes,Yt.numIntersection=kt.numClipIntersection,Yt.vertexAlphas=kt.vertexAlphas,Yt.vertexTangents=kt.vertexTangents,Yt.toneMapping=kt.toneMapping}function N6(et,kt,Yt,qt,mn){kt.isScene!==!0&&(kt=Pn),ln.resetTextureUnits();const Ei=kt.fog,Ci=qt.isMeshStandardMaterial?kt.environment:null,Fi=Ve===null?Te.outputEncoding:Ve.isXRRenderTarget===!0?Ve.texture.encoding:Qi,Di=(qt.isMeshStandardMaterial?Dn:In).get(qt.envMap||Ci),ar=qt.vertexColors===!0&&!!Yt.attributes.color&&Yt.attributes.color.itemSize===4,$i=!!qt.normalMap&&!!Yt.attributes.tangent,Ki=!!Yt.morphAttributes.position,Ir=!!Yt.morphAttributes.normal,Lu=Yt.morphAttributes.position?Yt.morphAttributes.position.length:0,_f=qt.toneMapped?Te.toneMapping:Ee,ir=pi.get(qt),Ia=se.state.lights;if(bn===!0&&(kn===!0||et!==je)){const Jo=et===je&&qt.id===ke;ht.setState(qt,et,Jo)}let ts=!1;qt.version===ir.__version?(ir.needsLights&&ir.lightsStateVersion!==Ia.state.version||ir.outputEncoding!==Fi||mn.isInstancedMesh&&ir.instancing===!1||!mn.isInstancedMesh&&ir.instancing===!0||mn.isSkinnedMesh&&ir.skinning===!1||!mn.isSkinnedMesh&&ir.skinning===!0||ir.envMap!==Di||qt.fog&&ir.fog!==Ei||ir.numClippingPlanes!==void 0&&(ir.numClippingPlanes!==ht.numPlanes||ir.numIntersection!==ht.numIntersection)||ir.vertexAlphas!==ar||ir.vertexTangents!==$i||ir.morphTargets!==Ki||ir.morphNormals!==Ir||ir.toneMapping!==_f||di.isWebGL2===!0&&ir.morphTargetsCount!==Lu)&&(ts=!0):(ts=!0,ir.__version=qt.version);let Oa=ir.currentProgram;ts===!0&&(Oa=Rx(qt,kt,mn));let cg=!1,Da=!1,El=!1;const Os=Oa.getUniforms(),Lp=ir.uniforms;if(Wn.useProgram(Oa.program)&&(cg=!0,Da=!0,El=!0),qt.id!==ke&&(ke=qt.id,Da=!0),cg||je!==et){if(Os.setValue(Mt,"projectionMatrix",et.projectionMatrix),di.logarithmicDepthBuffer&&Os.setValue(Mt,"logDepthBufFC",2/(Math.log(et.far+1)/Math.LN2)),je!==et&&(je=et,Da=!0,El=!0),qt.isShaderMaterial||qt.isMeshPhongMaterial||qt.isMeshToonMaterial||qt.isMeshStandardMaterial||qt.envMap){const Jo=Os.map.cameraPosition;Jo!==void 0&&Jo.setValue(Mt,fn.setFromMatrixPosition(et.matrixWorld))}(qt.isMeshPhongMaterial||qt.isMeshToonMaterial||qt.isMeshLambertMaterial||qt.isMeshBasicMaterial||qt.isMeshStandardMaterial||qt.isShaderMaterial)&&Os.setValue(Mt,"isOrthographic",et.isOrthographicCamera===!0),(qt.isMeshPhongMaterial||qt.isMeshToonMaterial||qt.isMeshLambertMaterial||qt.isMeshBasicMaterial||qt.isMeshStandardMaterial||qt.isShaderMaterial||qt.isShadowMaterial||mn.isSkinnedMesh)&&Os.setValue(Mt,"viewMatrix",et.matrixWorldInverse)}if(mn.isSkinnedMesh){Os.setOptional(Mt,mn,"bindMatrix"),Os.setOptional(Mt,mn,"bindMatrixInverse");const Jo=mn.skeleton;Jo&&(di.floatVertexTextures?(Jo.boneTexture===null&&Jo.computeBoneTexture(),Os.setValue(Mt,"boneTexture",Jo.boneTexture,ln),Os.setValue(Mt,"boneTextureSize",Jo.boneTextureSize)):Os.setOptional(Mt,Jo,"boneMatrices"))}return!!Yt&&(Yt.morphAttributes.position!==void 0||Yt.morphAttributes.normal!==void 0)&&On.update(mn,Yt,qt,Oa),(Da||ir.receiveShadow!==mn.receiveShadow)&&(ir.receiveShadow=mn.receiveShadow,Os.setValue(Mt,"receiveShadow",mn.receiveShadow)),Da&&(Os.setValue(Mt,"toneMappingExposure",Te.toneMappingExposure),ir.needsLights&&U6(Lp,El),Ei&&qt.fog&&zi.refreshFogUniforms(Lp,Ei),zi.refreshMaterialUniforms(Lp,qt,Ne,Ht,si),sc.upload(Mt,ir.uniformsList,Lp,ln)),qt.isShaderMaterial&&qt.uniformsNeedUpdate===!0&&(sc.upload(Mt,ir.uniformsList,Lp,ln),qt.uniformsNeedUpdate=!1),qt.isSpriteMaterial&&Os.setValue(Mt,"center",mn.center),Os.setValue(Mt,"modelViewMatrix",mn.modelViewMatrix),Os.setValue(Mt,"normalMatrix",mn.normalMatrix),Os.setValue(Mt,"modelMatrix",mn.matrixWorld),Oa}function U6(et,kt){et.ambientLightColor.needsUpdate=kt,et.lightProbe.needsUpdate=kt,et.directionalLights.needsUpdate=kt,et.directionalLightShadows.needsUpdate=kt,et.pointLights.needsUpdate=kt,et.pointLightShadows.needsUpdate=kt,et.spotLights.needsUpdate=kt,et.spotLightShadows.needsUpdate=kt,et.rectAreaLights.needsUpdate=kt,et.hemisphereLights.needsUpdate=kt}function k6(et){return et.isMeshLambertMaterial||et.isMeshToonMaterial||et.isMeshPhongMaterial||et.isMeshStandardMaterial||et.isShadowMaterial||et.isShaderMaterial&&et.lights===!0}this.setTexture2D=function(){var et=!1;return function(Yt,qt){Yt&&Yt.isWebGLRenderTarget&&(et||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),et=!0),Yt=Yt.texture),ln.setTexture2D(Yt,qt)}}(),this.getActiveCubeFace=function(){return Ae},this.getActiveMipmapLevel=function(){return ue},this.getRenderTarget=function(){return Ve},this.setRenderTargetTextures=function(et,kt,Yt){pi.get(et.texture).__webglTexture=kt,pi.get(et.depthTexture).__webglTexture=Yt;const qt=pi.get(et);qt.__hasExternalTextures=!0,qt.__hasExternalTextures&&(qt.__autoAllocateDepthBuffer=Yt===void 0,qt.__autoAllocateDepthBuffer||et.useRenderToTexture&&(console.warn("render-to-texture extension was disabled because an external texture was provided"),et.useRenderToTexture=!1,et.useRenderbuffer=!0))},this.setRenderTargetFramebuffer=function(et,kt){const Yt=pi.get(et);Yt.__webglFramebuffer=kt,Yt.__useDefaultFramebuffer=kt===void 0},this.setRenderTarget=function(et,kt=0,Yt=0){Ve=et,Ae=kt,ue=Yt;let qt=!0;if(et){const Di=pi.get(et);Di.__useDefaultFramebuffer!==void 0?(Wn.bindFramebuffer(Mt.FRAMEBUFFER,null),qt=!1):Di.__webglFramebuffer===void 0?ln.setupRenderTarget(et):Di.__hasExternalTextures&&ln.rebindTextures(et,pi.get(et.texture).__webglTexture,pi.get(et.depthTexture).__webglTexture)}let mn=null,Ei=!1,Ci=!1;if(et){const Di=et.texture;(Di.isDataTexture3D||Di.isDataTexture2DArray)&&(Ci=!0);const ar=pi.get(et).__webglFramebuffer;et.isWebGLCubeRenderTarget?(mn=ar[kt],Ei=!0):et.useRenderbuffer?mn=pi.get(et).__webglMultisampledFramebuffer:mn=ar,st.copy(et.viewport),At.copy(et.scissor),Et=et.scissorTest}else st.copy(Nt).multiplyScalar(Ne).floor(),At.copy(Pt).multiplyScalar(Ne).floor(),Et=Gt;if(Wn.bindFramebuffer(Mt.FRAMEBUFFER,mn)&&di.drawBuffers&&qt&&Wn.drawBuffers(et,mn),Wn.viewport(st),Wn.scissor(At),Wn.setScissorTest(Et),Ei){const Di=pi.get(et.texture);Mt.framebufferTexture2D(Mt.FRAMEBUFFER,Mt.COLOR_ATTACHMENT0,Mt.TEXTURE_CUBE_MAP_POSITIVE_X+kt,Di.__webglTexture,Yt)}else if(Ci){const Di=pi.get(et.texture),ar=kt||0;Mt.framebufferTextureLayer(Mt.FRAMEBUFFER,Mt.COLOR_ATTACHMENT0,Di.__webglTexture,Yt||0,ar)}ke=-1},this.readRenderTargetPixels=function(et,kt,Yt,qt,mn,Ei,Ci){if(!(et&&et.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Fi=pi.get(et).__webglFramebuffer;if(et.isWebGLCubeRenderTarget&&Ci!==void 0&&(Fi=Fi[Ci]),Fi){Wn.bindFramebuffer(Mt.FRAMEBUFFER,Fi);try{const Di=et.texture,ar=Di.format,$i=Di.type;if(ar!==Se&&ci.convert(ar)!==Mt.getParameter(Mt.IMPLEMENTATION_COLOR_READ_FORMAT)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const Ki=$i===Zn&&(Qn.has("EXT_color_buffer_half_float")||di.isWebGL2&&Qn.has("EXT_color_buffer_float"));if($i!==un&&ci.convert($i)!==Mt.getParameter(Mt.IMPLEMENTATION_COLOR_READ_TYPE)&&!($i===xn&&(di.isWebGL2||Qn.has("OES_texture_float")||Qn.has("WEBGL_color_buffer_float")))&&!Ki){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}Mt.checkFramebufferStatus(Mt.FRAMEBUFFER)===Mt.FRAMEBUFFER_COMPLETE?kt>=0&&kt<=et.width-qt&&Yt>=0&&Yt<=et.height-mn&&Mt.readPixels(kt,Yt,qt,mn,ci.convert(ar),ci.convert($i),Ei):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{const Di=Ve!==null?pi.get(Ve).__webglFramebuffer:null;Wn.bindFramebuffer(Mt.FRAMEBUFFER,Di)}}},this.copyFramebufferToTexture=function(et,kt,Yt=0){if(kt.isFramebufferTexture!==!0){console.error("THREE.WebGLRenderer: copyFramebufferToTexture() can only be used with FramebufferTexture.");return}const qt=Math.pow(2,-Yt),mn=Math.floor(kt.image.width*qt),Ei=Math.floor(kt.image.height*qt);ln.setTexture2D(kt,0),Mt.copyTexSubImage2D(Mt.TEXTURE_2D,Yt,0,0,et.x,et.y,mn,Ei),Wn.unbindTexture()},this.copyTextureToTexture=function(et,kt,Yt,qt=0){const mn=kt.image.width,Ei=kt.image.height,Ci=ci.convert(Yt.format),Fi=ci.convert(Yt.type);ln.setTexture2D(Yt,0),Mt.pixelStorei(Mt.UNPACK_FLIP_Y_WEBGL,Yt.flipY),Mt.pixelStorei(Mt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,Yt.premultiplyAlpha),Mt.pixelStorei(Mt.UNPACK_ALIGNMENT,Yt.unpackAlignment),kt.isDataTexture?Mt.texSubImage2D(Mt.TEXTURE_2D,qt,et.x,et.y,mn,Ei,Ci,Fi,kt.image.data):kt.isCompressedTexture?Mt.compressedTexSubImage2D(Mt.TEXTURE_2D,qt,et.x,et.y,kt.mipmaps[0].width,kt.mipmaps[0].height,Ci,kt.mipmaps[0].data):Mt.texSubImage2D(Mt.TEXTURE_2D,qt,et.x,et.y,Ci,Fi,kt.image),qt===0&&Yt.generateMipmaps&&Mt.generateMipmap(Mt.TEXTURE_2D),Wn.unbindTexture()},this.copyTextureToTexture3D=function(et,kt,Yt,qt,mn=0){if(Te.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const Ei=et.max.x-et.min.x+1,Ci=et.max.y-et.min.y+1,Fi=et.max.z-et.min.z+1,Di=ci.convert(qt.format),ar=ci.convert(qt.type);let $i;if(qt.isDataTexture3D)ln.setTexture3D(qt,0),$i=Mt.TEXTURE_3D;else if(qt.isDataTexture2DArray)ln.setTexture2DArray(qt,0),$i=Mt.TEXTURE_2D_ARRAY;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}Mt.pixelStorei(Mt.UNPACK_FLIP_Y_WEBGL,qt.flipY),Mt.pixelStorei(Mt.UNPACK_PREMULTIPLY_ALPHA_WEBGL,qt.premultiplyAlpha),Mt.pixelStorei(Mt.UNPACK_ALIGNMENT,qt.unpackAlignment);const Ki=Mt.getParameter(Mt.UNPACK_ROW_LENGTH),Ir=Mt.getParameter(Mt.UNPACK_IMAGE_HEIGHT),Lu=Mt.getParameter(Mt.UNPACK_SKIP_PIXELS),_f=Mt.getParameter(Mt.UNPACK_SKIP_ROWS),ir=Mt.getParameter(Mt.UNPACK_SKIP_IMAGES),Ia=Yt.isCompressedTexture?Yt.mipmaps[0]:Yt.image;Mt.pixelStorei(Mt.UNPACK_ROW_LENGTH,Ia.width),Mt.pixelStorei(Mt.UNPACK_IMAGE_HEIGHT,Ia.height),Mt.pixelStorei(Mt.UNPACK_SKIP_PIXELS,et.min.x),Mt.pixelStorei(Mt.UNPACK_SKIP_ROWS,et.min.y),Mt.pixelStorei(Mt.UNPACK_SKIP_IMAGES,et.min.z),Yt.isDataTexture||Yt.isDataTexture3D?Mt.texSubImage3D($i,mn,kt.x,kt.y,kt.z,Ei,Ci,Fi,Di,ar,Ia.data):Yt.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),Mt.compressedTexSubImage3D($i,mn,kt.x,kt.y,kt.z,Ei,Ci,Fi,Di,Ia.data)):Mt.texSubImage3D($i,mn,kt.x,kt.y,kt.z,Ei,Ci,Fi,Di,ar,Ia),Mt.pixelStorei(Mt.UNPACK_ROW_LENGTH,Ki),Mt.pixelStorei(Mt.UNPACK_IMAGE_HEIGHT,Ir),Mt.pixelStorei(Mt.UNPACK_SKIP_PIXELS,Lu),Mt.pixelStorei(Mt.UNPACK_SKIP_ROWS,_f),Mt.pixelStorei(Mt.UNPACK_SKIP_IMAGES,ir),mn===0&&qt.generateMipmaps&&Mt.generateMipmap($i),Wn.unbindTexture()},this.initTexture=function(et){ln.setTexture2D(et,0),Wn.unbindTexture()},this.resetState=function(){Ae=0,ue=0,Ve=null,Wn.reset(),oi.reset()},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}fr.prototype.isWebGLRenderer=!0;class DE extends fr{}DE.prototype.isWebGL1Renderer=!0;class cp{constructor(r,l=25e-5){this.name="",this.color=new Un(r),this.density=l}clone(){return new cp(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}cp.prototype.isFogExp2=!0;class up{constructor(r,l=1,d=1e3){this.name="",this.color=new Un(r),this.near=l,this.far=d}clone(){return new up(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}up.prototype.isFog=!0;class T0 extends ki{constructor(){super(),this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(r,l){return super.copy(r,l),r.background!==null&&(this.background=r.background.clone()),r.environment!==null&&(this.environment=r.environment.clone()),r.fog!==null&&(this.fog=r.fog.clone()),r.overrideMaterial!==null&&(this.overrideMaterial=r.overrideMaterial.clone()),this.autoUpdate=r.autoUpdate,this.matrixAutoUpdate=r.matrixAutoUpdate,this}toJSON(r){const l=super.toJSON(r);return this.fog!==null&&(l.object.fog=this.fog.toJSON()),l}}T0.prototype.isScene=!0;class mu{constructor(r,l){this.array=r,this.stride=l,this.count=r!==void 0?r.length/l:0,this.usage=Dh,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=ho()}onUploadCallback(){}set needsUpdate(r){r===!0&&this.version++}setUsage(r){return this.usage=r,this}copy(r){return this.array=new r.array.constructor(r.array),this.count=r.count,this.stride=r.stride,this.usage=r.usage,this}copyAt(r,l,d){r*=this.stride,d*=l.stride;for(let v=0,w=this.stride;v<w;v++)this.array[r+v]=l.array[d+v];return this}set(r,l=0){return this.array.set(r,l),this}clone(r){r.arrayBuffers===void 0&&(r.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ho()),r.arrayBuffers[this.array.buffer._uuid]===void 0&&(r.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const l=new this.array.constructor(r.arrayBuffers[this.array.buffer._uuid]),d=new this.constructor(l,this.stride);return d.setUsage(this.usage),d}onUpload(r){return this.onUploadCallback=r,this}toJSON(r){return r.arrayBuffers===void 0&&(r.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=ho()),r.arrayBuffers[this.array.buffer._uuid]===void 0&&(r.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}mu.prototype.isInterleavedBuffer=!0;const kr=new qe;class ac{constructor(r,l,d,v=!1){this.name="",this.data=r,this.itemSize=l,this.offset=d,this.normalized=v===!0}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(r){this.data.needsUpdate=r}applyMatrix4(r){for(let l=0,d=this.data.count;l<d;l++)kr.x=this.getX(l),kr.y=this.getY(l),kr.z=this.getZ(l),kr.applyMatrix4(r),this.setXYZ(l,kr.x,kr.y,kr.z);return this}applyNormalMatrix(r){for(let l=0,d=this.count;l<d;l++)kr.x=this.getX(l),kr.y=this.getY(l),kr.z=this.getZ(l),kr.applyNormalMatrix(r),this.setXYZ(l,kr.x,kr.y,kr.z);return this}transformDirection(r){for(let l=0,d=this.count;l<d;l++)kr.x=this.getX(l),kr.y=this.getY(l),kr.z=this.getZ(l),kr.transformDirection(r),this.setXYZ(l,kr.x,kr.y,kr.z);return this}setX(r,l){return this.data.array[r*this.data.stride+this.offset]=l,this}setY(r,l){return this.data.array[r*this.data.stride+this.offset+1]=l,this}setZ(r,l){return this.data.array[r*this.data.stride+this.offset+2]=l,this}setW(r,l){return this.data.array[r*this.data.stride+this.offset+3]=l,this}getX(r){return this.data.array[r*this.data.stride+this.offset]}getY(r){return this.data.array[r*this.data.stride+this.offset+1]}getZ(r){return this.data.array[r*this.data.stride+this.offset+2]}getW(r){return this.data.array[r*this.data.stride+this.offset+3]}setXY(r,l,d){return r=r*this.data.stride+this.offset,this.data.array[r+0]=l,this.data.array[r+1]=d,this}setXYZ(r,l,d,v){return r=r*this.data.stride+this.offset,this.data.array[r+0]=l,this.data.array[r+1]=d,this.data.array[r+2]=v,this}setXYZW(r,l,d,v,w){return r=r*this.data.stride+this.offset,this.data.array[r+0]=l,this.data.array[r+1]=d,this.data.array[r+2]=v,this.data.array[r+3]=w,this}clone(r){if(r===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const l=[];for(let d=0;d<this.count;d++){const v=d*this.data.stride+this.offset;for(let w=0;w<this.itemSize;w++)l.push(this.data.array[v+w])}return new Wi(new this.array.constructor(l),this.itemSize,this.normalized)}else return r.interleavedBuffers===void 0&&(r.interleavedBuffers={}),r.interleavedBuffers[this.data.uuid]===void 0&&(r.interleavedBuffers[this.data.uuid]=this.data.clone(r)),new ac(r.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(r){if(r===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const l=[];for(let d=0;d<this.count;d++){const v=d*this.data.stride+this.offset;for(let w=0;w<this.itemSize;w++)l.push(this.data.array[v+w])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:l,normalized:this.normalized}}else return r.interleavedBuffers===void 0&&(r.interleavedBuffers={}),r.interleavedBuffers[this.data.uuid]===void 0&&(r.interleavedBuffers[this.data.uuid]=this.data.toJSON(r)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}ac.prototype.isInterleavedBufferAttribute=!0;class C0 extends as{constructor(r){super(),this.type="SpriteMaterial",this.color=new Un(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.map=r.map,this.alphaMap=r.alphaMap,this.rotation=r.rotation,this.sizeAttenuation=r.sizeAttenuation,this}}C0.prototype.isSpriteMaterial=!0;let sf;const hp=new qe,of=new qe,af=new qe,lf=new pn,fp=new pn,BE=new Jn,R0=new qe,dp=new qe,L0=new qe,FE=new pn,F1=new pn,NE=new pn;class P0 extends ki{constructor(r){if(super(),this.type="Sprite",sf===void 0){sf=new ui;const l=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),d=new mu(l,5);sf.setIndex([0,1,2,0,2,3]),sf.setAttribute("position",new ac(d,3,0,!1)),sf.setAttribute("uv",new ac(d,2,3,!1))}this.geometry=sf,this.material=r!==void 0?r:new C0,this.center=new pn(.5,.5)}raycast(r,l){r.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),of.setFromMatrixScale(this.matrixWorld),BE.copy(r.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(r.camera.matrixWorldInverse,this.matrixWorld),af.setFromMatrixPosition(this.modelViewMatrix),r.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&of.multiplyScalar(-af.z);const d=this.material.rotation;let v,w;d!==0&&(w=Math.cos(d),v=Math.sin(d));const C=this.center;I0(R0.set(-.5,-.5,0),af,C,of,v,w),I0(dp.set(.5,-.5,0),af,C,of,v,w),I0(L0.set(.5,.5,0),af,C,of,v,w),FE.set(0,0),F1.set(1,0),NE.set(1,1);let O=r.ray.intersectTriangle(R0,dp,L0,!1,hp);if(O===null&&(I0(dp.set(-.5,.5,0),af,C,of,v,w),F1.set(0,1),O=r.ray.intersectTriangle(R0,L0,dp,!1,hp),O===null))return;const z=r.ray.origin.distanceTo(hp);z<r.near||z>r.far||l.push({distance:z,point:hp.clone(),uv:Ur.getUV(hp,R0,dp,L0,FE,F1,NE,new pn),face:null,object:this})}copy(r){return super.copy(r),r.center!==void 0&&this.center.copy(r.center),this.material=r.material,this}}P0.prototype.isSprite=!0;function I0(A,r,l,d,v,w){lf.subVectors(A,l).addScalar(.5).multiply(d),v!==void 0?(fp.x=w*lf.x-v*lf.y,fp.y=v*lf.x+w*lf.y):fp.copy(lf),A.copy(r),A.x+=fp.x,A.y+=fp.y,A.applyMatrix4(BE)}const O0=new qe,UE=new qe;class kE extends ki{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(r){super.copy(r,!1);const l=r.levels;for(let d=0,v=l.length;d<v;d++){const w=l[d];this.addLevel(w.object.clone(),w.distance)}return this.autoUpdate=r.autoUpdate,this}addLevel(r,l=0){l=Math.abs(l);const d=this.levels;let v;for(v=0;v<d.length&&!(l<d[v].distance);v++);return d.splice(v,0,{distance:l,object:r}),this.add(r),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(r){const l=this.levels;if(l.length>0){let d,v;for(d=1,v=l.length;d<v&&!(r<l[d].distance);d++);return l[d-1].object}return null}raycast(r,l){if(this.levels.length>0){O0.setFromMatrixPosition(this.matrixWorld);const v=r.ray.origin.distanceTo(O0);this.getObjectForDistance(v).raycast(r,l)}}update(r){const l=this.levels;if(l.length>1){O0.setFromMatrixPosition(r.matrixWorld),UE.setFromMatrixPosition(this.matrixWorld);const d=O0.distanceTo(UE)/r.zoom;l[0].object.visible=!0;let v,w;for(v=1,w=l.length;v<w&&d>=l[v].distance;v++)l[v-1].object.visible=!1,l[v].object.visible=!0;for(this._currentLevel=v-1;v<w;v++)l[v].object.visible=!1}}toJSON(r){const l=super.toJSON(r);this.autoUpdate===!1&&(l.object.autoUpdate=!1),l.object.levels=[];const d=this.levels;for(let v=0,w=d.length;v<w;v++){const C=d[v];l.object.levels.push({object:C.object.uuid,distance:C.distance})}return l}}const zE=new qe,HE=new nr,GE=new nr,ND=new qe,VE=new Jn;class D0 extends $r{constructor(r,l){super(r,l),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Jn,this.bindMatrixInverse=new Jn}copy(r){return super.copy(r),this.bindMode=r.bindMode,this.bindMatrix.copy(r.bindMatrix),this.bindMatrixInverse.copy(r.bindMatrixInverse),this.skeleton=r.skeleton,this}bind(r,l){this.skeleton=r,l===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),l=this.matrixWorld),this.bindMatrix.copy(l),this.bindMatrixInverse.copy(l).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const r=new nr,l=this.geometry.attributes.skinWeight;for(let d=0,v=l.count;d<v;d++){r.x=l.getX(d),r.y=l.getY(d),r.z=l.getZ(d),r.w=l.getW(d);const w=1/r.manhattanLength();w!==1/0?r.multiplyScalar(w):r.set(1,0,0,0),l.setXYZW(d,r.x,r.y,r.z,r.w)}}updateMatrixWorld(r){super.updateMatrixWorld(r),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(r,l){const d=this.skeleton,v=this.geometry;HE.fromBufferAttribute(v.attributes.skinIndex,r),GE.fromBufferAttribute(v.attributes.skinWeight,r),zE.copy(l).applyMatrix4(this.bindMatrix),l.set(0,0,0);for(let w=0;w<4;w++){const C=GE.getComponent(w);if(C!==0){const O=HE.getComponent(w);VE.multiplyMatrices(d.bones[O].matrixWorld,d.boneInverses[O]),l.addScaledVector(ND.copy(zE).applyMatrix4(VE),C)}}return l.applyMatrix4(this.bindMatrixInverse)}}D0.prototype.isSkinnedMesh=!0;class B0 extends ki{constructor(){super(),this.type="Bone"}}B0.prototype.isBone=!0;class gu extends Xr{constructor(r=null,l=1,d=1,v,w,C,O,z,H=at,ne=at,re,se){super(null,C,O,z,H,ne,v,w,re,se),this.image={data:r,width:l,height:d},this.magFilter=H,this.minFilter=ne,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}gu.prototype.isDataTexture=!0;const WE=new Jn,UD=new Jn;class F0{constructor(r=[],l=[]){this.uuid=ho(),this.bones=r.slice(0),this.boneInverses=l,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const r=this.bones,l=this.boneInverses;if(this.boneMatrices=new Float32Array(r.length*16),l.length===0)this.calculateInverses();else if(r.length!==l.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let d=0,v=this.bones.length;d<v;d++)this.boneInverses.push(new Jn)}}calculateInverses(){this.boneInverses.length=0;for(let r=0,l=this.bones.length;r<l;r++){const d=new Jn;this.bones[r]&&d.copy(this.bones[r].matrixWorld).invert(),this.boneInverses.push(d)}}pose(){for(let r=0,l=this.bones.length;r<l;r++){const d=this.bones[r];d&&d.matrixWorld.copy(this.boneInverses[r]).invert()}for(let r=0,l=this.bones.length;r<l;r++){const d=this.bones[r];d&&(d.parent&&d.parent.isBone?(d.matrix.copy(d.parent.matrixWorld).invert(),d.matrix.multiply(d.matrixWorld)):d.matrix.copy(d.matrixWorld),d.matrix.decompose(d.position,d.quaternion,d.scale))}}update(){const r=this.bones,l=this.boneInverses,d=this.boneMatrices,v=this.boneTexture;for(let w=0,C=r.length;w<C;w++){const O=r[w]?r[w].matrixWorld:UD;WE.multiplyMatrices(O,l[w]),WE.toArray(d,w*16)}v!==null&&(v.needsUpdate=!0)}clone(){return new F0(this.bones,this.boneInverses)}computeBoneTexture(){let r=Math.sqrt(this.bones.length*4);r=Tw(r),r=Math.max(r,4);const l=new Float32Array(r*r*4);l.set(this.boneMatrices);const d=new gu(l,r,r,Se,xn);return d.needsUpdate=!0,this.boneMatrices=l,this.boneTexture=d,this.boneTextureSize=r,this}getBoneByName(r){for(let l=0,d=this.bones.length;l<d;l++){const v=this.bones[l];if(v.name===r)return v}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(r,l){this.uuid=r.uuid;for(let d=0,v=r.bones.length;d<v;d++){const w=r.bones[d];let C=l[w];C===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",w),C=new B0),this.bones.push(C),this.boneInverses.push(new Jn().fromArray(r.boneInverses[d]))}return this.init(),this}toJSON(){const r={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};r.uuid=this.uuid;const l=this.bones,d=this.boneInverses;for(let v=0,w=l.length;v<w;v++){const C=l[v];r.bones.push(C.uuid);const O=d[v];r.boneInverses.push(O.toArray())}return r}}class vu extends Wi{constructor(r,l,d,v=1){typeof d=="number"&&(v=d,d=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(r,l,d),this.meshPerAttribute=v}copy(r){return super.copy(r),this.meshPerAttribute=r.meshPerAttribute,this}toJSON(){const r=super.toJSON();return r.meshPerAttribute=this.meshPerAttribute,r.isInstancedBufferAttribute=!0,r}}vu.prototype.isInstancedBufferAttribute=!0;const jE=new Jn,XE=new Jn,N0=[],pp=new $r;class N1 extends $r{constructor(r,l,d){super(r,l),this.instanceMatrix=new vu(new Float32Array(d*16),16),this.instanceColor=null,this.count=d,this.frustumCulled=!1}copy(r){return super.copy(r),this.instanceMatrix.copy(r.instanceMatrix),r.instanceColor!==null&&(this.instanceColor=r.instanceColor.clone()),this.count=r.count,this}getColorAt(r,l){l.fromArray(this.instanceColor.array,r*3)}getMatrixAt(r,l){l.fromArray(this.instanceMatrix.array,r*16)}raycast(r,l){const d=this.matrixWorld,v=this.count;if(pp.geometry=this.geometry,pp.material=this.material,pp.material!==void 0)for(let w=0;w<v;w++){this.getMatrixAt(w,jE),XE.multiplyMatrices(d,jE),pp.matrixWorld=XE,pp.raycast(r,N0);for(let C=0,O=N0.length;C<O;C++){const z=N0[C];z.instanceId=w,z.object=this,l.push(z)}N0.length=0}}setColorAt(r,l){this.instanceColor===null&&(this.instanceColor=new vu(new Float32Array(this.instanceMatrix.count*3),3)),l.toArray(this.instanceColor.array,r*3)}setMatrixAt(r,l){l.toArray(this.instanceMatrix.array,r*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}N1.prototype.isInstancedMesh=!0;class cs extends as{constructor(r){super(),this.type="LineBasicMaterial",this.color=new Un(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.linewidth=r.linewidth,this.linecap=r.linecap,this.linejoin=r.linejoin,this}}cs.prototype.isLineBasicMaterial=!0;const $E=new qe,qE=new qe,YE=new Jn,U1=new Jl,U0=new Kl;class Al extends ki{constructor(r=new ui,l=new cs){super(),this.type="Line",this.geometry=r,this.material=l,this.updateMorphTargets()}copy(r){return super.copy(r),this.material=r.material,this.geometry=r.geometry,this}computeLineDistances(){const r=this.geometry;if(r.isBufferGeometry)if(r.index===null){const l=r.attributes.position,d=[0];for(let v=1,w=l.count;v<w;v++)$E.fromBufferAttribute(l,v-1),qE.fromBufferAttribute(l,v),d[v]=d[v-1],d[v]+=$E.distanceTo(qE);r.setAttribute("lineDistance",new ei(d,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else r.isGeometry&&console.error("THREE.Line.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}raycast(r,l){const d=this.geometry,v=this.matrixWorld,w=r.params.Line.threshold,C=d.drawRange;if(d.boundingSphere===null&&d.computeBoundingSphere(),U0.copy(d.boundingSphere),U0.applyMatrix4(v),U0.radius+=w,r.ray.intersectsSphere(U0)===!1)return;YE.copy(v).invert(),U1.copy(r.ray).applyMatrix4(YE);const O=w/((this.scale.x+this.scale.y+this.scale.z)/3),z=O*O,H=new qe,ne=new qe,re=new qe,se=new qe,oe=this.isLineSegments?2:1;if(d.isBufferGeometry){const ve=d.index,Fe=d.attributes.position;if(ve!==null){const Ae=Math.max(0,C.start),ue=Math.min(ve.count,C.start+C.count);for(let Ve=Ae,ke=ue-1;Ve<ke;Ve+=oe){const je=ve.getX(Ve),st=ve.getX(Ve+1);if(H.fromBufferAttribute(Fe,je),ne.fromBufferAttribute(Fe,st),U1.distanceSqToSegment(H,ne,se,re)>z)continue;se.applyMatrix4(this.matrixWorld);const Et=r.ray.origin.distanceTo(se);Et<r.near||Et>r.far||l.push({distance:Et,point:re.clone().applyMatrix4(this.matrixWorld),index:Ve,face:null,faceIndex:null,object:this})}}else{const Ae=Math.max(0,C.start),ue=Math.min(Fe.count,C.start+C.count);for(let Ve=Ae,ke=ue-1;Ve<ke;Ve+=oe){if(H.fromBufferAttribute(Fe,Ve),ne.fromBufferAttribute(Fe,Ve+1),U1.distanceSqToSegment(H,ne,se,re)>z)continue;se.applyMatrix4(this.matrixWorld);const st=r.ray.origin.distanceTo(se);st<r.near||st>r.far||l.push({distance:st,point:re.clone().applyMatrix4(this.matrixWorld),index:Ve,face:null,faceIndex:null,object:this})}}}else d.isGeometry&&console.error("THREE.Line.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const r=this.geometry;if(r.isBufferGeometry){const l=r.morphAttributes,d=Object.keys(l);if(d.length>0){const v=l[d[0]];if(v!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let w=0,C=v.length;w<C;w++){const O=v[w].name||String(w);this.morphTargetInfluences.push(0),this.morphTargetDictionary[O]=w}}}}else{const l=r.morphTargets;l!==void 0&&l.length>0&&console.error("THREE.Line.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}Al.prototype.isLine=!0;const QE=new qe,KE=new qe;class ro extends Al{constructor(r,l){super(r,l),this.type="LineSegments"}computeLineDistances(){const r=this.geometry;if(r.isBufferGeometry)if(r.index===null){const l=r.attributes.position,d=[];for(let v=0,w=l.count;v<w;v+=2)QE.fromBufferAttribute(l,v),KE.fromBufferAttribute(l,v+1),d[v]=v===0?0:d[v-1],d[v+1]=d[v]+QE.distanceTo(KE);r.setAttribute("lineDistance",new ei(d,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else r.isGeometry&&console.error("THREE.LineSegments.computeLineDistances() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.");return this}}ro.prototype.isLineSegments=!0;class k1 extends Al{constructor(r,l){super(r,l),this.type="LineLoop"}}k1.prototype.isLineLoop=!0;class yu extends as{constructor(r){super(),this.type="PointsMaterial",this.color=new Un(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.map=r.map,this.alphaMap=r.alphaMap,this.size=r.size,this.sizeAttenuation=r.sizeAttenuation,this}}yu.prototype.isPointsMaterial=!0;const ZE=new Jn,z1=new Jl,k0=new Kl,z0=new qe;class mp extends ki{constructor(r=new ui,l=new yu){super(),this.type="Points",this.geometry=r,this.material=l,this.updateMorphTargets()}copy(r){return super.copy(r),this.material=r.material,this.geometry=r.geometry,this}raycast(r,l){const d=this.geometry,v=this.matrixWorld,w=r.params.Points.threshold,C=d.drawRange;if(d.boundingSphere===null&&d.computeBoundingSphere(),k0.copy(d.boundingSphere),k0.applyMatrix4(v),k0.radius+=w,r.ray.intersectsSphere(k0)===!1)return;ZE.copy(v).invert(),z1.copy(r.ray).applyMatrix4(ZE);const O=w/((this.scale.x+this.scale.y+this.scale.z)/3),z=O*O;if(d.isBufferGeometry){const H=d.index,re=d.attributes.position;if(H!==null){const se=Math.max(0,C.start),oe=Math.min(H.count,C.start+C.count);for(let ve=se,Te=oe;ve<Te;ve++){const Fe=H.getX(ve);z0.fromBufferAttribute(re,Fe),JE(z0,Fe,z,v,r,l,this)}}else{const se=Math.max(0,C.start),oe=Math.min(re.count,C.start+C.count);for(let ve=se,Te=oe;ve<Te;ve++)z0.fromBufferAttribute(re,ve),JE(z0,ve,z,v,r,l,this)}}else console.error("THREE.Points.raycast() no longer supports THREE.Geometry. Use THREE.BufferGeometry instead.")}updateMorphTargets(){const r=this.geometry;if(r.isBufferGeometry){const l=r.morphAttributes,d=Object.keys(l);if(d.length>0){const v=l[d[0]];if(v!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let w=0,C=v.length;w<C;w++){const O=v[w].name||String(w);this.morphTargetInfluences.push(0),this.morphTargetDictionary[O]=w}}}}else{const l=r.morphTargets;l!==void 0&&l.length>0&&console.error("THREE.Points.updateMorphTargets() does not support THREE.Geometry. Use THREE.BufferGeometry instead.")}}}mp.prototype.isPoints=!0;function JE(A,r,l,d,v,w,C){const O=z1.distanceSqToPoint(A);if(O<l){const z=new qe;z1.closestPointToPoint(A,z),z.applyMatrix4(d);const H=v.ray.origin.distanceTo(z);if(H<v.near||H>v.far)return;w.push({distance:H,distanceToRay:Math.sqrt(O),point:z,index:r,face:null,object:C})}}class eM extends Xr{constructor(r,l,d,v,w,C,O,z,H){super(r,l,d,v,w,C,O,z,H),this.minFilter=C!==void 0?C:ut,this.magFilter=w!==void 0?w:ut,this.generateMipmaps=!1;const ne=this;function re(){ne.needsUpdate=!0,r.requestVideoFrameCallback(re)}"requestVideoFrameCallback"in r&&r.requestVideoFrameCallback(re)}clone(){return new this.constructor(this.image).copy(this)}update(){const r=this.image;"requestVideoFrameCallback"in r===!1&&r.readyState>=r.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}eM.prototype.isVideoTexture=!0;class tM extends Xr{constructor(r,l,d){super({width:r,height:l}),this.format=d,this.magFilter=at,this.minFilter=at,this.generateMipmaps=!1,this.needsUpdate=!0}}tM.prototype.isFramebufferTexture=!0;class H1 extends Xr{constructor(r,l,d,v,w,C,O,z,H,ne,re,se){super(null,C,O,z,H,ne,v,w,re,se),this.image={width:l,height:d},this.mipmaps=r,this.flipY=!1,this.generateMipmaps=!1}}H1.prototype.isCompressedTexture=!0;class nM extends Xr{constructor(r,l,d,v,w,C,O,z,H){super(r,l,d,v,w,C,O,z,H),this.needsUpdate=!0}}nM.prototype.isCanvasTexture=!0;class cf extends ui{constructor(r=1,l=8,d=0,v=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:r,segments:l,thetaStart:d,thetaLength:v},l=Math.max(3,l);const w=[],C=[],O=[],z=[],H=new qe,ne=new pn;C.push(0,0,0),O.push(0,0,1),z.push(.5,.5);for(let re=0,se=3;re<=l;re++,se+=3){const oe=d+re/l*v;H.x=r*Math.cos(oe),H.y=r*Math.sin(oe),C.push(H.x,H.y,H.z),O.push(0,0,1),ne.x=(C[se]/r+1)/2,ne.y=(C[se+1]/r+1)/2,z.push(ne.x,ne.y)}for(let re=1;re<=l;re++)w.push(re,re+1,0);this.setIndex(w),this.setAttribute("position",new ei(C,3)),this.setAttribute("normal",new ei(O,3)),this.setAttribute("uv",new ei(z,2))}static fromJSON(r){return new cf(r.radius,r.segments,r.thetaStart,r.thetaLength)}}class lc extends ui{constructor(r=1,l=1,d=1,v=8,w=1,C=!1,O=0,z=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:r,radiusBottom:l,height:d,radialSegments:v,heightSegments:w,openEnded:C,thetaStart:O,thetaLength:z};const H=this;v=Math.floor(v),w=Math.floor(w);const ne=[],re=[],se=[],oe=[];let ve=0;const Te=[],Fe=d/2;let Ae=0;ue(),C===!1&&(r>0&&Ve(!0),l>0&&Ve(!1)),this.setIndex(ne),this.setAttribute("position",new ei(re,3)),this.setAttribute("normal",new ei(se,3)),this.setAttribute("uv",new ei(oe,2));function ue(){const ke=new qe,je=new qe;let st=0;const At=(l-r)/d;for(let Et=0;Et<=w;Et++){const Xt=[],Ht=Et/w,Ne=Ht*(l-r)+r;for(let ct=0;ct<=v;ct++){const It=ct/v,Nt=It*z+O,Pt=Math.sin(Nt),Gt=Math.cos(Nt);je.x=Ne*Pt,je.y=-Ht*d+Fe,je.z=Ne*Gt,re.push(je.x,je.y,je.z),ke.set(Pt,At,Gt).normalize(),se.push(ke.x,ke.y,ke.z),oe.push(It,1-Ht),Xt.push(ve++)}Te.push(Xt)}for(let Et=0;Et<v;Et++)for(let Xt=0;Xt<w;Xt++){const Ht=Te[Xt][Et],Ne=Te[Xt+1][Et],ct=Te[Xt+1][Et+1],It=Te[Xt][Et+1];ne.push(Ht,Ne,It),ne.push(Ne,ct,It),st+=6}H.addGroup(Ae,st,0),Ae+=st}function Ve(ke){const je=ve,st=new pn,At=new qe;let Et=0;const Xt=ke===!0?r:l,Ht=ke===!0?1:-1;for(let ct=1;ct<=v;ct++)re.push(0,Fe*Ht,0),se.push(0,Ht,0),oe.push(.5,.5),ve++;const Ne=ve;for(let ct=0;ct<=v;ct++){const Nt=ct/v*z+O,Pt=Math.cos(Nt),Gt=Math.sin(Nt);At.x=Xt*Gt,At.y=Fe*Ht,At.z=Xt*Pt,re.push(At.x,At.y,At.z),se.push(0,Ht,0),st.x=Pt*.5+.5,st.y=Gt*.5*Ht+.5,oe.push(st.x,st.y),ve++}for(let ct=0;ct<v;ct++){const It=je+ct,Nt=Ne+ct;ke===!0?ne.push(Nt,Nt+1,It):ne.push(Nt+1,Nt,It),Et+=3}H.addGroup(Ae,Et,ke===!0?1:2),Ae+=Et}}static fromJSON(r){return new lc(r.radiusTop,r.radiusBottom,r.height,r.radialSegments,r.heightSegments,r.openEnded,r.thetaStart,r.thetaLength)}}class uf extends lc{constructor(r=1,l=1,d=8,v=1,w=!1,C=0,O=Math.PI*2){super(0,r,l,d,v,w,C,O),this.type="ConeGeometry",this.parameters={radius:r,height:l,radialSegments:d,heightSegments:v,openEnded:w,thetaStart:C,thetaLength:O}}static fromJSON(r){return new uf(r.radius,r.height,r.radialSegments,r.heightSegments,r.openEnded,r.thetaStart,r.thetaLength)}}class Sa extends ui{constructor(r=[],l=[],d=1,v=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:r,indices:l,radius:d,detail:v};const w=[],C=[];O(v),H(d),ne(),this.setAttribute("position",new ei(w,3)),this.setAttribute("normal",new ei(w.slice(),3)),this.setAttribute("uv",new ei(C,2)),v===0?this.computeVertexNormals():this.normalizeNormals();function O(ue){const Ve=new qe,ke=new qe,je=new qe;for(let st=0;st<l.length;st+=3)oe(l[st+0],Ve),oe(l[st+1],ke),oe(l[st+2],je),z(Ve,ke,je,ue)}function z(ue,Ve,ke,je){const st=je+1,At=[];for(let Et=0;Et<=st;Et++){At[Et]=[];const Xt=ue.clone().lerp(ke,Et/st),Ht=Ve.clone().lerp(ke,Et/st),Ne=st-Et;for(let ct=0;ct<=Ne;ct++)ct===0&&Et===st?At[Et][ct]=Xt:At[Et][ct]=Xt.clone().lerp(Ht,ct/Ne)}for(let Et=0;Et<st;Et++)for(let Xt=0;Xt<2*(st-Et)-1;Xt++){const Ht=Math.floor(Xt/2);Xt%2===0?(se(At[Et][Ht+1]),se(At[Et+1][Ht]),se(At[Et][Ht])):(se(At[Et][Ht+1]),se(At[Et+1][Ht+1]),se(At[Et+1][Ht]))}}function H(ue){const Ve=new qe;for(let ke=0;ke<w.length;ke+=3)Ve.x=w[ke+0],Ve.y=w[ke+1],Ve.z=w[ke+2],Ve.normalize().multiplyScalar(ue),w[ke+0]=Ve.x,w[ke+1]=Ve.y,w[ke+2]=Ve.z}function ne(){const ue=new qe;for(let Ve=0;Ve<w.length;Ve+=3){ue.x=w[Ve+0],ue.y=w[Ve+1],ue.z=w[Ve+2];const ke=Fe(ue)/2/Math.PI+.5,je=Ae(ue)/Math.PI+.5;C.push(ke,1-je)}ve(),re()}function re(){for(let ue=0;ue<C.length;ue+=6){const Ve=C[ue+0],ke=C[ue+2],je=C[ue+4],st=Math.max(Ve,ke,je),At=Math.min(Ve,ke,je);st>.9&&At<.1&&(Ve<.2&&(C[ue+0]+=1),ke<.2&&(C[ue+2]+=1),je<.2&&(C[ue+4]+=1))}}function se(ue){w.push(ue.x,ue.y,ue.z)}function oe(ue,Ve){const ke=ue*3;Ve.x=r[ke+0],Ve.y=r[ke+1],Ve.z=r[ke+2]}function ve(){const ue=new qe,Ve=new qe,ke=new qe,je=new qe,st=new pn,At=new pn,Et=new pn;for(let Xt=0,Ht=0;Xt<w.length;Xt+=9,Ht+=6){ue.set(w[Xt+0],w[Xt+1],w[Xt+2]),Ve.set(w[Xt+3],w[Xt+4],w[Xt+5]),ke.set(w[Xt+6],w[Xt+7],w[Xt+8]),st.set(C[Ht+0],C[Ht+1]),At.set(C[Ht+2],C[Ht+3]),Et.set(C[Ht+4],C[Ht+5]),je.copy(ue).add(Ve).add(ke).divideScalar(3);const Ne=Fe(je);Te(st,Ht+0,ue,Ne),Te(At,Ht+2,Ve,Ne),Te(Et,Ht+4,ke,Ne)}}function Te(ue,Ve,ke,je){je<0&&ue.x===1&&(C[Ve]=ue.x-1),ke.x===0&&ke.z===0&&(C[Ve]=je/2/Math.PI+.5)}function Fe(ue){return Math.atan2(ue.z,-ue.x)}function Ae(ue){return Math.atan2(-ue.y,Math.sqrt(ue.x*ue.x+ue.z*ue.z))}}static fromJSON(r){return new Sa(r.vertices,r.indices,r.radius,r.details)}}class hf extends Sa{constructor(r=1,l=0){const d=(1+Math.sqrt(5))/2,v=1/d,w=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-v,-d,0,-v,d,0,v,-d,0,v,d,-v,-d,0,-v,d,0,v,-d,0,v,d,0,-d,0,-v,d,0,-v,-d,0,v,d,0,v],C=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(w,C,r,l),this.type="DodecahedronGeometry",this.parameters={radius:r,detail:l}}static fromJSON(r){return new hf(r.radius,r.detail)}}const H0=new qe,G0=new qe,G1=new qe,V0=new Ur;class V1 extends ui{constructor(r=null,l=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:r,thresholdAngle:l},r!==null){const v=Math.pow(10,4),w=Math.cos(lu*l),C=r.getIndex(),O=r.getAttribute("position"),z=C?C.count:O.count,H=[0,0,0],ne=["a","b","c"],re=new Array(3),se={},oe=[];for(let ve=0;ve<z;ve+=3){C?(H[0]=C.getX(ve),H[1]=C.getX(ve+1),H[2]=C.getX(ve+2)):(H[0]=ve,H[1]=ve+1,H[2]=ve+2);const{a:Te,b:Fe,c:Ae}=V0;if(Te.fromBufferAttribute(O,H[0]),Fe.fromBufferAttribute(O,H[1]),Ae.fromBufferAttribute(O,H[2]),V0.getNormal(G1),re[0]=`${Math.round(Te.x*v)},${Math.round(Te.y*v)},${Math.round(Te.z*v)}`,re[1]=`${Math.round(Fe.x*v)},${Math.round(Fe.y*v)},${Math.round(Fe.z*v)}`,re[2]=`${Math.round(Ae.x*v)},${Math.round(Ae.y*v)},${Math.round(Ae.z*v)}`,!(re[0]===re[1]||re[1]===re[2]||re[2]===re[0]))for(let ue=0;ue<3;ue++){const Ve=(ue+1)%3,ke=re[ue],je=re[Ve],st=V0[ne[ue]],At=V0[ne[Ve]],Et=`${ke}_${je}`,Xt=`${je}_${ke}`;Xt in se&&se[Xt]?(G1.dot(se[Xt].normal)<=w&&(oe.push(st.x,st.y,st.z),oe.push(At.x,At.y,At.z)),se[Xt]=null):Et in se||(se[Et]={index0:H[ue],index1:H[Ve],normal:G1.clone()})}}for(const ve in se)if(se[ve]){const{index0:Te,index1:Fe}=se[ve];H0.fromBufferAttribute(O,Te),G0.fromBufferAttribute(O,Fe),oe.push(H0.x,H0.y,H0.z),oe.push(G0.x,G0.y,G0.z)}this.setAttribute("position",new ei(oe,3))}}}class vo{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(r,l){const d=this.getUtoTmapping(r);return this.getPoint(d,l)}getPoints(r=5){const l=[];for(let d=0;d<=r;d++)l.push(this.getPoint(d/r));return l}getSpacedPoints(r=5){const l=[];for(let d=0;d<=r;d++)l.push(this.getPointAt(d/r));return l}getLength(){const r=this.getLengths();return r[r.length-1]}getLengths(r=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===r+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const l=[];let d,v=this.getPoint(0),w=0;l.push(0);for(let C=1;C<=r;C++)d=this.getPoint(C/r),w+=d.distanceTo(v),l.push(w),v=d;return this.cacheArcLengths=l,l}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(r,l){const d=this.getLengths();let v=0;const w=d.length;let C;l?C=l:C=r*d[w-1];let O=0,z=w-1,H;for(;O<=z;)if(v=Math.floor(O+(z-O)/2),H=d[v]-C,H<0)O=v+1;else if(H>0)z=v-1;else{z=v;break}if(v=z,d[v]===C)return v/(w-1);const ne=d[v],se=d[v+1]-ne,oe=(C-ne)/se;return(v+oe)/(w-1)}getTangent(r,l){let v=r-1e-4,w=r+1e-4;v<0&&(v=0),w>1&&(w=1);const C=this.getPoint(v),O=this.getPoint(w),z=l||(C.isVector2?new pn:new qe);return z.copy(O).sub(C).normalize(),z}getTangentAt(r,l){const d=this.getUtoTmapping(r);return this.getTangent(d,l)}computeFrenetFrames(r,l){const d=new qe,v=[],w=[],C=[],O=new qe,z=new Jn;for(let oe=0;oe<=r;oe++){const ve=oe/r;v[oe]=this.getTangentAt(ve,new qe)}w[0]=new qe,C[0]=new qe;let H=Number.MAX_VALUE;const ne=Math.abs(v[0].x),re=Math.abs(v[0].y),se=Math.abs(v[0].z);ne<=H&&(H=ne,d.set(1,0,0)),re<=H&&(H=re,d.set(0,1,0)),se<=H&&d.set(0,0,1),O.crossVectors(v[0],d).normalize(),w[0].crossVectors(v[0],O),C[0].crossVectors(v[0],w[0]);for(let oe=1;oe<=r;oe++){if(w[oe]=w[oe-1].clone(),C[oe]=C[oe-1].clone(),O.crossVectors(v[oe-1],v[oe]),O.length()>Number.EPSILON){O.normalize();const ve=Math.acos(ys(v[oe-1].dot(v[oe]),-1,1));w[oe].applyMatrix4(z.makeRotationAxis(O,ve))}C[oe].crossVectors(v[oe],w[oe])}if(l===!0){let oe=Math.acos(ys(w[0].dot(w[r]),-1,1));oe/=r,v[0].dot(O.crossVectors(w[0],w[r]))>0&&(oe=-oe);for(let ve=1;ve<=r;ve++)w[ve].applyMatrix4(z.makeRotationAxis(v[ve],oe*ve)),C[ve].crossVectors(v[ve],w[ve])}return{tangents:v,normals:w,binormals:C}}clone(){return new this.constructor().copy(this)}copy(r){return this.arcLengthDivisions=r.arcLengthDivisions,this}toJSON(){const r={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return r.arcLengthDivisions=this.arcLengthDivisions,r.type=this.type,r}fromJSON(r){return this.arcLengthDivisions=r.arcLengthDivisions,this}}class gp extends vo{constructor(r=0,l=0,d=1,v=1,w=0,C=Math.PI*2,O=!1,z=0){super(),this.type="EllipseCurve",this.aX=r,this.aY=l,this.xRadius=d,this.yRadius=v,this.aStartAngle=w,this.aEndAngle=C,this.aClockwise=O,this.aRotation=z}getPoint(r,l){const d=l||new pn,v=Math.PI*2;let w=this.aEndAngle-this.aStartAngle;const C=Math.abs(w)<Number.EPSILON;for(;w<0;)w+=v;for(;w>v;)w-=v;w<Number.EPSILON&&(C?w=0:w=v),this.aClockwise===!0&&!C&&(w===v?w=-v:w=w-v);const O=this.aStartAngle+r*w;let z=this.aX+this.xRadius*Math.cos(O),H=this.aY+this.yRadius*Math.sin(O);if(this.aRotation!==0){const ne=Math.cos(this.aRotation),re=Math.sin(this.aRotation),se=z-this.aX,oe=H-this.aY;z=se*ne-oe*re+this.aX,H=se*re+oe*ne+this.aY}return d.set(z,H)}copy(r){return super.copy(r),this.aX=r.aX,this.aY=r.aY,this.xRadius=r.xRadius,this.yRadius=r.yRadius,this.aStartAngle=r.aStartAngle,this.aEndAngle=r.aEndAngle,this.aClockwise=r.aClockwise,this.aRotation=r.aRotation,this}toJSON(){const r=super.toJSON();return r.aX=this.aX,r.aY=this.aY,r.xRadius=this.xRadius,r.yRadius=this.yRadius,r.aStartAngle=this.aStartAngle,r.aEndAngle=this.aEndAngle,r.aClockwise=this.aClockwise,r.aRotation=this.aRotation,r}fromJSON(r){return super.fromJSON(r),this.aX=r.aX,this.aY=r.aY,this.xRadius=r.xRadius,this.yRadius=r.yRadius,this.aStartAngle=r.aStartAngle,this.aEndAngle=r.aEndAngle,this.aClockwise=r.aClockwise,this.aRotation=r.aRotation,this}}gp.prototype.isEllipseCurve=!0;class W1 extends gp{constructor(r,l,d,v,w,C){super(r,l,d,d,v,w,C),this.type="ArcCurve"}}W1.prototype.isArcCurve=!0;function j1(){let A=0,r=0,l=0,d=0;function v(w,C,O,z){A=w,r=O,l=-3*w+3*C-2*O-z,d=2*w-2*C+O+z}return{initCatmullRom:function(w,C,O,z,H){v(C,O,H*(O-w),H*(z-C))},initNonuniformCatmullRom:function(w,C,O,z,H,ne,re){let se=(C-w)/H-(O-w)/(H+ne)+(O-C)/ne,oe=(O-C)/ne-(z-C)/(ne+re)+(z-O)/re;se*=ne,oe*=ne,v(C,O,se,oe)},calc:function(w){const C=w*w,O=C*w;return A+r*w+l*C+d*O}}}const W0=new qe,X1=new j1,$1=new j1,q1=new j1;class Y1 extends vo{constructor(r=[],l=!1,d="centripetal",v=.5){super(),this.type="CatmullRomCurve3",this.points=r,this.closed=l,this.curveType=d,this.tension=v}getPoint(r,l=new qe){const d=l,v=this.points,w=v.length,C=(w-(this.closed?0:1))*r;let O=Math.floor(C),z=C-O;this.closed?O+=O>0?0:(Math.floor(Math.abs(O)/w)+1)*w:z===0&&O===w-1&&(O=w-2,z=1);let H,ne;this.closed||O>0?H=v[(O-1)%w]:(W0.subVectors(v[0],v[1]).add(v[0]),H=W0);const re=v[O%w],se=v[(O+1)%w];if(this.closed||O+2<w?ne=v[(O+2)%w]:(W0.subVectors(v[w-1],v[w-2]).add(v[w-1]),ne=W0),this.curveType==="centripetal"||this.curveType==="chordal"){const oe=this.curveType==="chordal"?.5:.25;let ve=Math.pow(H.distanceToSquared(re),oe),Te=Math.pow(re.distanceToSquared(se),oe),Fe=Math.pow(se.distanceToSquared(ne),oe);Te<1e-4&&(Te=1),ve<1e-4&&(ve=Te),Fe<1e-4&&(Fe=Te),X1.initNonuniformCatmullRom(H.x,re.x,se.x,ne.x,ve,Te,Fe),$1.initNonuniformCatmullRom(H.y,re.y,se.y,ne.y,ve,Te,Fe),q1.initNonuniformCatmullRom(H.z,re.z,se.z,ne.z,ve,Te,Fe)}else this.curveType==="catmullrom"&&(X1.initCatmullRom(H.x,re.x,se.x,ne.x,this.tension),$1.initCatmullRom(H.y,re.y,se.y,ne.y,this.tension),q1.initCatmullRom(H.z,re.z,se.z,ne.z,this.tension));return d.set(X1.calc(z),$1.calc(z),q1.calc(z)),d}copy(r){super.copy(r),this.points=[];for(let l=0,d=r.points.length;l<d;l++){const v=r.points[l];this.points.push(v.clone())}return this.closed=r.closed,this.curveType=r.curveType,this.tension=r.tension,this}toJSON(){const r=super.toJSON();r.points=[];for(let l=0,d=this.points.length;l<d;l++){const v=this.points[l];r.points.push(v.toArray())}return r.closed=this.closed,r.curveType=this.curveType,r.tension=this.tension,r}fromJSON(r){super.fromJSON(r),this.points=[];for(let l=0,d=r.points.length;l<d;l++){const v=r.points[l];this.points.push(new qe().fromArray(v))}return this.closed=r.closed,this.curveType=r.curveType,this.tension=r.tension,this}}Y1.prototype.isCatmullRomCurve3=!0;function iM(A,r,l,d,v){const w=(d-r)*.5,C=(v-l)*.5,O=A*A,z=A*O;return(2*l-2*d+w+C)*z+(-3*l+3*d-2*w-C)*O+w*A+l}function kD(A,r){const l=1-A;return l*l*r}function zD(A,r){return 2*(1-A)*A*r}function HD(A,r){return A*A*r}function vp(A,r,l,d){return kD(A,r)+zD(A,l)+HD(A,d)}function GD(A,r){const l=1-A;return l*l*l*r}function VD(A,r){const l=1-A;return 3*l*l*A*r}function WD(A,r){return 3*(1-A)*A*A*r}function jD(A,r){return A*A*A*r}function yp(A,r,l,d,v){return GD(A,r)+VD(A,l)+WD(A,d)+jD(A,v)}class j0 extends vo{constructor(r=new pn,l=new pn,d=new pn,v=new pn){super(),this.type="CubicBezierCurve",this.v0=r,this.v1=l,this.v2=d,this.v3=v}getPoint(r,l=new pn){const d=l,v=this.v0,w=this.v1,C=this.v2,O=this.v3;return d.set(yp(r,v.x,w.x,C.x,O.x),yp(r,v.y,w.y,C.y,O.y)),d}copy(r){return super.copy(r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this.v3.copy(r.v3),this}toJSON(){const r=super.toJSON();return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r.v3=this.v3.toArray(),r}fromJSON(r){return super.fromJSON(r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this.v3.fromArray(r.v3),this}}j0.prototype.isCubicBezierCurve=!0;class Q1 extends vo{constructor(r=new qe,l=new qe,d=new qe,v=new qe){super(),this.type="CubicBezierCurve3",this.v0=r,this.v1=l,this.v2=d,this.v3=v}getPoint(r,l=new qe){const d=l,v=this.v0,w=this.v1,C=this.v2,O=this.v3;return d.set(yp(r,v.x,w.x,C.x,O.x),yp(r,v.y,w.y,C.y,O.y),yp(r,v.z,w.z,C.z,O.z)),d}copy(r){return super.copy(r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this.v3.copy(r.v3),this}toJSON(){const r=super.toJSON();return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r.v3=this.v3.toArray(),r}fromJSON(r){return super.fromJSON(r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this.v3.fromArray(r.v3),this}}Q1.prototype.isCubicBezierCurve3=!0;class xp extends vo{constructor(r=new pn,l=new pn){super(),this.type="LineCurve",this.v1=r,this.v2=l}getPoint(r,l=new pn){const d=l;return r===1?d.copy(this.v2):(d.copy(this.v2).sub(this.v1),d.multiplyScalar(r).add(this.v1)),d}getPointAt(r,l){return this.getPoint(r,l)}getTangent(r,l){const d=l||new pn;return d.copy(this.v2).sub(this.v1).normalize(),d}copy(r){return super.copy(r),this.v1.copy(r.v1),this.v2.copy(r.v2),this}toJSON(){const r=super.toJSON();return r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r}fromJSON(r){return super.fromJSON(r),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this}}xp.prototype.isLineCurve=!0;class rM extends vo{constructor(r=new qe,l=new qe){super(),this.type="LineCurve3",this.isLineCurve3=!0,this.v1=r,this.v2=l}getPoint(r,l=new qe){const d=l;return r===1?d.copy(this.v2):(d.copy(this.v2).sub(this.v1),d.multiplyScalar(r).add(this.v1)),d}getPointAt(r,l){return this.getPoint(r,l)}copy(r){return super.copy(r),this.v1.copy(r.v1),this.v2.copy(r.v2),this}toJSON(){const r=super.toJSON();return r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r}fromJSON(r){return super.fromJSON(r),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this}}class X0 extends vo{constructor(r=new pn,l=new pn,d=new pn){super(),this.type="QuadraticBezierCurve",this.v0=r,this.v1=l,this.v2=d}getPoint(r,l=new pn){const d=l,v=this.v0,w=this.v1,C=this.v2;return d.set(vp(r,v.x,w.x,C.x),vp(r,v.y,w.y,C.y)),d}copy(r){return super.copy(r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this}toJSON(){const r=super.toJSON();return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r}fromJSON(r){return super.fromJSON(r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this}}X0.prototype.isQuadraticBezierCurve=!0;class $0 extends vo{constructor(r=new qe,l=new qe,d=new qe){super(),this.type="QuadraticBezierCurve3",this.v0=r,this.v1=l,this.v2=d}getPoint(r,l=new qe){const d=l,v=this.v0,w=this.v1,C=this.v2;return d.set(vp(r,v.x,w.x,C.x),vp(r,v.y,w.y,C.y),vp(r,v.z,w.z,C.z)),d}copy(r){return super.copy(r),this.v0.copy(r.v0),this.v1.copy(r.v1),this.v2.copy(r.v2),this}toJSON(){const r=super.toJSON();return r.v0=this.v0.toArray(),r.v1=this.v1.toArray(),r.v2=this.v2.toArray(),r}fromJSON(r){return super.fromJSON(r),this.v0.fromArray(r.v0),this.v1.fromArray(r.v1),this.v2.fromArray(r.v2),this}}$0.prototype.isQuadraticBezierCurve3=!0;class q0 extends vo{constructor(r=[]){super(),this.type="SplineCurve",this.points=r}getPoint(r,l=new pn){const d=l,v=this.points,w=(v.length-1)*r,C=Math.floor(w),O=w-C,z=v[C===0?C:C-1],H=v[C],ne=v[C>v.length-2?v.length-1:C+1],re=v[C>v.length-3?v.length-1:C+2];return d.set(iM(O,z.x,H.x,ne.x,re.x),iM(O,z.y,H.y,ne.y,re.y)),d}copy(r){super.copy(r),this.points=[];for(let l=0,d=r.points.length;l<d;l++){const v=r.points[l];this.points.push(v.clone())}return this}toJSON(){const r=super.toJSON();r.points=[];for(let l=0,d=this.points.length;l<d;l++){const v=this.points[l];r.points.push(v.toArray())}return r}fromJSON(r){super.fromJSON(r),this.points=[];for(let l=0,d=r.points.length;l<d;l++){const v=r.points[l];this.points.push(new pn().fromArray(v))}return this}}q0.prototype.isSplineCurve=!0;var K1=Object.freeze({__proto__:null,ArcCurve:W1,CatmullRomCurve3:Y1,CubicBezierCurve:j0,CubicBezierCurve3:Q1,EllipseCurve:gp,LineCurve:xp,LineCurve3:rM,QuadraticBezierCurve:X0,QuadraticBezierCurve3:$0,SplineCurve:q0});class sM extends vo{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(r){this.curves.push(r)}closePath(){const r=this.curves[0].getPoint(0),l=this.curves[this.curves.length-1].getPoint(1);r.equals(l)||this.curves.push(new xp(l,r))}getPoint(r,l){const d=r*this.getLength(),v=this.getCurveLengths();let w=0;for(;w<v.length;){if(v[w]>=d){const C=v[w]-d,O=this.curves[w],z=O.getLength(),H=z===0?0:1-C/z;return O.getPointAt(H,l)}w++}return null}getLength(){const r=this.getCurveLengths();return r[r.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const r=[];let l=0;for(let d=0,v=this.curves.length;d<v;d++)l+=this.curves[d].getLength(),r.push(l);return this.cacheLengths=r,r}getSpacedPoints(r=40){const l=[];for(let d=0;d<=r;d++)l.push(this.getPoint(d/r));return this.autoClose&&l.push(l[0]),l}getPoints(r=12){const l=[];let d;for(let v=0,w=this.curves;v<w.length;v++){const C=w[v],O=C&&C.isEllipseCurve?r*2:C&&(C.isLineCurve||C.isLineCurve3)?1:C&&C.isSplineCurve?r*C.points.length:r,z=C.getPoints(O);for(let H=0;H<z.length;H++){const ne=z[H];d&&d.equals(ne)||(l.push(ne),d=ne)}}return this.autoClose&&l.length>1&&!l[l.length-1].equals(l[0])&&l.push(l[0]),l}copy(r){super.copy(r),this.curves=[];for(let l=0,d=r.curves.length;l<d;l++){const v=r.curves[l];this.curves.push(v.clone())}return this.autoClose=r.autoClose,this}toJSON(){const r=super.toJSON();r.autoClose=this.autoClose,r.curves=[];for(let l=0,d=this.curves.length;l<d;l++){const v=this.curves[l];r.curves.push(v.toJSON())}return r}fromJSON(r){super.fromJSON(r),this.autoClose=r.autoClose,this.curves=[];for(let l=0,d=r.curves.length;l<d;l++){const v=r.curves[l];this.curves.push(new K1[v.type]().fromJSON(v))}return this}}class Ap extends sM{constructor(r){super(),this.type="Path",this.currentPoint=new pn,r&&this.setFromPoints(r)}setFromPoints(r){this.moveTo(r[0].x,r[0].y);for(let l=1,d=r.length;l<d;l++)this.lineTo(r[l].x,r[l].y);return this}moveTo(r,l){return this.currentPoint.set(r,l),this}lineTo(r,l){const d=new xp(this.currentPoint.clone(),new pn(r,l));return this.curves.push(d),this.currentPoint.set(r,l),this}quadraticCurveTo(r,l,d,v){const w=new X0(this.currentPoint.clone(),new pn(r,l),new pn(d,v));return this.curves.push(w),this.currentPoint.set(d,v),this}bezierCurveTo(r,l,d,v,w,C){const O=new j0(this.currentPoint.clone(),new pn(r,l),new pn(d,v),new pn(w,C));return this.curves.push(O),this.currentPoint.set(w,C),this}splineThru(r){const l=[this.currentPoint.clone()].concat(r),d=new q0(l);return this.curves.push(d),this.currentPoint.copy(r[r.length-1]),this}arc(r,l,d,v,w,C){const O=this.currentPoint.x,z=this.currentPoint.y;return this.absarc(r+O,l+z,d,v,w,C),this}absarc(r,l,d,v,w,C){return this.absellipse(r,l,d,d,v,w,C),this}ellipse(r,l,d,v,w,C,O,z){const H=this.currentPoint.x,ne=this.currentPoint.y;return this.absellipse(r+H,l+ne,d,v,w,C,O,z),this}absellipse(r,l,d,v,w,C,O,z){const H=new gp(r,l,d,v,w,C,O,z);if(this.curves.length>0){const re=H.getPoint(0);re.equals(this.currentPoint)||this.lineTo(re.x,re.y)}this.curves.push(H);const ne=H.getPoint(1);return this.currentPoint.copy(ne),this}copy(r){return super.copy(r),this.currentPoint.copy(r.currentPoint),this}toJSON(){const r=super.toJSON();return r.currentPoint=this.currentPoint.toArray(),r}fromJSON(r){return super.fromJSON(r),this.currentPoint.fromArray(r.currentPoint),this}}class Ta extends Ap{constructor(r){super(r),this.uuid=ho(),this.type="Shape",this.holes=[]}getPointsHoles(r){const l=[];for(let d=0,v=this.holes.length;d<v;d++)l[d]=this.holes[d].getPoints(r);return l}extractPoints(r){return{shape:this.getPoints(r),holes:this.getPointsHoles(r)}}copy(r){super.copy(r),this.holes=[];for(let l=0,d=r.holes.length;l<d;l++){const v=r.holes[l];this.holes.push(v.clone())}return this}toJSON(){const r=super.toJSON();r.uuid=this.uuid,r.holes=[];for(let l=0,d=this.holes.length;l<d;l++){const v=this.holes[l];r.holes.push(v.toJSON())}return r}fromJSON(r){super.fromJSON(r),this.uuid=r.uuid,this.holes=[];for(let l=0,d=r.holes.length;l<d;l++){const v=r.holes[l];this.holes.push(new Ap().fromJSON(v))}return this}}const XD={triangulate:function(A,r,l=2){const d=r&&r.length,v=d?r[0]*l:A.length;let w=oM(A,0,v,l,!0);const C=[];if(!w||w.next===w.prev)return C;let O,z,H,ne,re,se,oe;if(d&&(w=KD(A,r,w,l)),A.length>80*l){O=H=A[0],z=ne=A[1];for(let ve=l;ve<v;ve+=l)re=A[ve],se=A[ve+1],re<O&&(O=re),se<z&&(z=se),re>H&&(H=re),se>ne&&(ne=se);oe=Math.max(H-O,ne-z),oe=oe!==0?1/oe:0}return bp(w,C,l,O,z,oe),C}};function oM(A,r,l,d,v){let w,C;if(v===lB(A,r,l,d)>0)for(w=r;w<l;w+=d)C=cM(w,A[w],A[w+1],C);else for(w=l-d;w>=r;w-=d)C=cM(w,A[w],A[w+1],C);return C&&Y0(C,C.next)&&(wp(C),C=C.next),C}function cc(A,r){if(!A)return A;r||(r=A);let l=A,d;do if(d=!1,!l.steiner&&(Y0(l,l.next)||Er(l.prev,l,l.next)===0)){if(wp(l),l=r=l.prev,l===l.next)break;d=!0}else l=l.next;while(d||l!==r);return r}function bp(A,r,l,d,v,w,C){if(!A)return;!C&&w&&nB(A,d,v,w);let O=A,z,H;for(;A.prev!==A.next;){if(z=A.prev,H=A.next,w?qD(A,d,v,w):$D(A)){r.push(z.i/l),r.push(A.i/l),r.push(H.i/l),wp(A),A=H.next,O=H.next;continue}if(A=H,A===O){C?C===1?(A=YD(cc(A),r,l),bp(A,r,l,d,v,w,2)):C===2&&QD(A,r,l,d,v,w):bp(cc(A),r,l,d,v,w,1);break}}}function $D(A){const r=A.prev,l=A,d=A.next;if(Er(r,l,d)>=0)return!1;let v=A.next.next;for(;v!==A.prev;){if(ff(r.x,r.y,l.x,l.y,d.x,d.y,v.x,v.y)&&Er(v.prev,v,v.next)>=0)return!1;v=v.next}return!0}function qD(A,r,l,d){const v=A.prev,w=A,C=A.next;if(Er(v,w,C)>=0)return!1;const O=v.x<w.x?v.x<C.x?v.x:C.x:w.x<C.x?w.x:C.x,z=v.y<w.y?v.y<C.y?v.y:C.y:w.y<C.y?w.y:C.y,H=v.x>w.x?v.x>C.x?v.x:C.x:w.x>C.x?w.x:C.x,ne=v.y>w.y?v.y>C.y?v.y:C.y:w.y>C.y?w.y:C.y,re=Z1(O,z,r,l,d),se=Z1(H,ne,r,l,d);let oe=A.prevZ,ve=A.nextZ;for(;oe&&oe.z>=re&&ve&&ve.z<=se;){if(oe!==A.prev&&oe!==A.next&&ff(v.x,v.y,w.x,w.y,C.x,C.y,oe.x,oe.y)&&Er(oe.prev,oe,oe.next)>=0||(oe=oe.prevZ,ve!==A.prev&&ve!==A.next&&ff(v.x,v.y,w.x,w.y,C.x,C.y,ve.x,ve.y)&&Er(ve.prev,ve,ve.next)>=0))return!1;ve=ve.nextZ}for(;oe&&oe.z>=re;){if(oe!==A.prev&&oe!==A.next&&ff(v.x,v.y,w.x,w.y,C.x,C.y,oe.x,oe.y)&&Er(oe.prev,oe,oe.next)>=0)return!1;oe=oe.prevZ}for(;ve&&ve.z<=se;){if(ve!==A.prev&&ve!==A.next&&ff(v.x,v.y,w.x,w.y,C.x,C.y,ve.x,ve.y)&&Er(ve.prev,ve,ve.next)>=0)return!1;ve=ve.nextZ}return!0}function YD(A,r,l){let d=A;do{const v=d.prev,w=d.next.next;!Y0(v,w)&&aM(v,d,d.next,w)&&_p(v,w)&&_p(w,v)&&(r.push(v.i/l),r.push(d.i/l),r.push(w.i/l),wp(d),wp(d.next),d=A=w),d=d.next}while(d!==A);return cc(d)}function QD(A,r,l,d,v,w){let C=A;do{let O=C.next.next;for(;O!==C.prev;){if(C.i!==O.i&&sB(C,O)){let z=lM(C,O);C=cc(C,C.next),z=cc(z,z.next),bp(C,r,l,d,v,w),bp(z,r,l,d,v,w);return}O=O.next}C=C.next}while(C!==A)}function KD(A,r,l,d){const v=[];let w,C,O,z,H;for(w=0,C=r.length;w<C;w++)O=r[w]*d,z=w<C-1?r[w+1]*d:A.length,H=oM(A,O,z,d,!1),H===H.next&&(H.steiner=!0),v.push(rB(H));for(v.sort(ZD),w=0;w<v.length;w++)JD(v[w],l),l=cc(l,l.next);return l}function ZD(A,r){return A.x-r.x}function JD(A,r){if(r=eB(A,r),r){const l=lM(r,A);cc(r,r.next),cc(l,l.next)}}function eB(A,r){let l=r;const d=A.x,v=A.y;let w=-1/0,C;do{if(v<=l.y&&v>=l.next.y&&l.next.y!==l.y){const se=l.x+(v-l.y)*(l.next.x-l.x)/(l.next.y-l.y);if(se<=d&&se>w){if(w=se,se===d){if(v===l.y)return l;if(v===l.next.y)return l.next}C=l.x<l.next.x?l:l.next}}l=l.next}while(l!==r);if(!C)return null;if(d===w)return C;const O=C,z=C.x,H=C.y;let ne=1/0,re;l=C;do d>=l.x&&l.x>=z&&d!==l.x&&ff(v<H?d:w,v,z,H,v<H?w:d,v,l.x,l.y)&&(re=Math.abs(v-l.y)/(d-l.x),_p(l,A)&&(re<ne||re===ne&&(l.x>C.x||l.x===C.x&&tB(C,l)))&&(C=l,ne=re)),l=l.next;while(l!==O);return C}function tB(A,r){return Er(A.prev,A,r.prev)<0&&Er(r.next,A,A.next)<0}function nB(A,r,l,d){let v=A;do v.z===null&&(v.z=Z1(v.x,v.y,r,l,d)),v.prevZ=v.prev,v.nextZ=v.next,v=v.next;while(v!==A);v.prevZ.nextZ=null,v.prevZ=null,iB(v)}function iB(A){let r,l,d,v,w,C,O,z,H=1;do{for(l=A,A=null,w=null,C=0;l;){for(C++,d=l,O=0,r=0;r<H&&(O++,d=d.nextZ,!!d);r++);for(z=H;O>0||z>0&&d;)O!==0&&(z===0||!d||l.z<=d.z)?(v=l,l=l.nextZ,O--):(v=d,d=d.nextZ,z--),w?w.nextZ=v:A=v,v.prevZ=w,w=v;l=d}w.nextZ=null,H*=2}while(C>1);return A}function Z1(A,r,l,d,v){return A=32767*(A-l)*v,r=32767*(r-d)*v,A=(A|A<<8)&16711935,A=(A|A<<4)&252645135,A=(A|A<<2)&858993459,A=(A|A<<1)&1431655765,r=(r|r<<8)&16711935,r=(r|r<<4)&252645135,r=(r|r<<2)&858993459,r=(r|r<<1)&1431655765,A|r<<1}function rB(A){let r=A,l=A;do(r.x<l.x||r.x===l.x&&r.y<l.y)&&(l=r),r=r.next;while(r!==A);return l}function ff(A,r,l,d,v,w,C,O){return(v-C)*(r-O)-(A-C)*(w-O)>=0&&(A-C)*(d-O)-(l-C)*(r-O)>=0&&(l-C)*(w-O)-(v-C)*(d-O)>=0}function sB(A,r){return A.next.i!==r.i&&A.prev.i!==r.i&&!oB(A,r)&&(_p(A,r)&&_p(r,A)&&aB(A,r)&&(Er(A.prev,A,r.prev)||Er(A,r.prev,r))||Y0(A,r)&&Er(A.prev,A,A.next)>0&&Er(r.prev,r,r.next)>0)}function Er(A,r,l){return(r.y-A.y)*(l.x-r.x)-(r.x-A.x)*(l.y-r.y)}function Y0(A,r){return A.x===r.x&&A.y===r.y}function aM(A,r,l,d){const v=K0(Er(A,r,l)),w=K0(Er(A,r,d)),C=K0(Er(l,d,A)),O=K0(Er(l,d,r));return!!(v!==w&&C!==O||v===0&&Q0(A,l,r)||w===0&&Q0(A,d,r)||C===0&&Q0(l,A,d)||O===0&&Q0(l,r,d))}function Q0(A,r,l){return r.x<=Math.max(A.x,l.x)&&r.x>=Math.min(A.x,l.x)&&r.y<=Math.max(A.y,l.y)&&r.y>=Math.min(A.y,l.y)}function K0(A){return A>0?1:A<0?-1:0}function oB(A,r){let l=A;do{if(l.i!==A.i&&l.next.i!==A.i&&l.i!==r.i&&l.next.i!==r.i&&aM(l,l.next,A,r))return!0;l=l.next}while(l!==A);return!1}function _p(A,r){return Er(A.prev,A,A.next)<0?Er(A,r,A.next)>=0&&Er(A,A.prev,r)>=0:Er(A,r,A.prev)<0||Er(A,A.next,r)<0}function aB(A,r){let l=A,d=!1;const v=(A.x+r.x)/2,w=(A.y+r.y)/2;do l.y>w!=l.next.y>w&&l.next.y!==l.y&&v<(l.next.x-l.x)*(w-l.y)/(l.next.y-l.y)+l.x&&(d=!d),l=l.next;while(l!==A);return d}function lM(A,r){const l=new J1(A.i,A.x,A.y),d=new J1(r.i,r.x,r.y),v=A.next,w=r.prev;return A.next=r,r.prev=A,l.next=v,v.prev=l,d.next=l,l.prev=d,w.next=d,d.prev=w,d}function cM(A,r,l,d){const v=new J1(A,r,l);return d?(v.next=d.next,v.prev=d,d.next.prev=v,d.next=v):(v.prev=v,v.next=v),v}function wp(A){A.next.prev=A.prev,A.prev.next=A.next,A.prevZ&&(A.prevZ.nextZ=A.nextZ),A.nextZ&&(A.nextZ.prevZ=A.prevZ)}function J1(A,r,l){this.i=A,this.x=r,this.y=l,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function lB(A,r,l,d){let v=0;for(let w=r,C=l-d;w<l;w+=d)v+=(A[C]-A[w])*(A[w+1]+A[C+1]),C=w;return v}class Ca{static area(r){const l=r.length;let d=0;for(let v=l-1,w=0;w<l;v=w++)d+=r[v].x*r[w].y-r[w].x*r[v].y;return d*.5}static isClockWise(r){return Ca.area(r)<0}static triangulateShape(r,l){const d=[],v=[],w=[];uM(r),hM(d,r);let C=r.length;l.forEach(uM);for(let z=0;z<l.length;z++)v.push(C),C+=l[z].length,hM(d,l[z]);const O=XD.triangulate(d,v);for(let z=0;z<O.length;z+=3)w.push(O.slice(z,z+3));return w}}function uM(A){const r=A.length;r>2&&A[r-1].equals(A[0])&&A.pop()}function hM(A,r){for(let l=0;l<r.length;l++)A.push(r[l].x),A.push(r[l].y)}class Ra extends ui{constructor(r=new Ta([new pn(.5,.5),new pn(-.5,.5),new pn(-.5,-.5),new pn(.5,-.5)]),l={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:r,options:l},r=Array.isArray(r)?r:[r];const d=this,v=[],w=[];for(let O=0,z=r.length;O<z;O++){const H=r[O];C(H)}this.setAttribute("position",new ei(v,3)),this.setAttribute("uv",new ei(w,2)),this.computeVertexNormals();function C(O){const z=[],H=l.curveSegments!==void 0?l.curveSegments:12,ne=l.steps!==void 0?l.steps:1;let re=l.depth!==void 0?l.depth:1,se=l.bevelEnabled!==void 0?l.bevelEnabled:!0,oe=l.bevelThickness!==void 0?l.bevelThickness:.2,ve=l.bevelSize!==void 0?l.bevelSize:oe-.1,Te=l.bevelOffset!==void 0?l.bevelOffset:0,Fe=l.bevelSegments!==void 0?l.bevelSegments:3;const Ae=l.extrudePath,ue=l.UVGenerator!==void 0?l.UVGenerator:cB;l.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),re=l.amount);let Ve,ke=!1,je,st,At,Et;Ae&&(Ve=Ae.getSpacedPoints(ne),ke=!0,se=!1,je=Ae.computeFrenetFrames(ne,!1),st=new qe,At=new qe,Et=new qe),se||(Fe=0,oe=0,ve=0,Te=0);const Xt=O.extractPoints(H);let Ht=Xt.shape;const Ne=Xt.holes;if(!Ca.isClockWise(Ht)){Ht=Ht.reverse();for(let ln=0,In=Ne.length;ln<In;ln++){const Dn=Ne[ln];Ca.isClockWise(Dn)&&(Ne[ln]=Dn.reverse())}}const It=Ca.triangulateShape(Ht,Ne),Nt=Ht;for(let ln=0,In=Ne.length;ln<In;ln++){const Dn=Ne[ln];Ht=Ht.concat(Dn)}function Pt(ln,In,Dn){return In||console.error("THREE.ExtrudeGeometry: vec does not exist"),In.clone().multiplyScalar(Dn).add(ln)}const Gt=Ht.length,sn=It.length;function bn(ln,In,Dn){let ti,Hn,yi;const mi=ln.x-In.x,zi=ln.y-In.y,vr=Dn.x-ln.x,cr=Dn.y-ln.y,ht=mi*mi+zi*zi,Qe=mi*cr-zi*vr;if(Math.abs(Qe)>Number.EPSILON){const cn=Math.sqrt(ht),On=Math.sqrt(vr*vr+cr*cr),ri=In.x-zi/cn,an=In.y+mi/cn,ci=Dn.x-cr/On,oi=Dn.y+vr/On,Gn=((ci-ri)*cr-(oi-an)*vr)/(mi*cr-zi*vr);ti=ri+mi*Gn-ln.x,Hn=an+zi*Gn-ln.y;const Nn=ti*ti+Hn*Hn;if(Nn<=2)return new pn(ti,Hn);yi=Math.sqrt(Nn/2)}else{let cn=!1;mi>Number.EPSILON?vr>Number.EPSILON&&(cn=!0):mi<-Number.EPSILON?vr<-Number.EPSILON&&(cn=!0):Math.sign(zi)===Math.sign(cr)&&(cn=!0),cn?(ti=-zi,Hn=mi,yi=Math.sqrt(ht)):(ti=mi,Hn=zi,yi=Math.sqrt(ht/2))}return new pn(ti/yi,Hn/yi)}const kn=[];for(let ln=0,In=Nt.length,Dn=In-1,ti=ln+1;ln<In;ln++,Dn++,ti++)Dn===In&&(Dn=0),ti===In&&(ti=0),kn[ln]=bn(Nt[ln],Nt[Dn],Nt[ti]);const si=[];let Vn,fn=kn.concat();for(let ln=0,In=Ne.length;ln<In;ln++){const Dn=Ne[ln];Vn=[];for(let ti=0,Hn=Dn.length,yi=Hn-1,mi=ti+1;ti<Hn;ti++,yi++,mi++)yi===Hn&&(yi=0),mi===Hn&&(mi=0),Vn[ti]=bn(Dn[ti],Dn[yi],Dn[mi]);si.push(Vn),fn=fn.concat(Vn)}for(let ln=0;ln<Fe;ln++){const In=ln/Fe,Dn=oe*Math.cos(In*Math.PI/2),ti=ve*Math.sin(In*Math.PI/2)+Te;for(let Hn=0,yi=Nt.length;Hn<yi;Hn++){const mi=Pt(Nt[Hn],kn[Hn],ti);Qn(mi.x,mi.y,-Dn)}for(let Hn=0,yi=Ne.length;Hn<yi;Hn++){const mi=Ne[Hn];Vn=si[Hn];for(let zi=0,vr=mi.length;zi<vr;zi++){const cr=Pt(mi[zi],Vn[zi],ti);Qn(cr.x,cr.y,-Dn)}}}const Pn=ve+Te;for(let ln=0;ln<Gt;ln++){const In=se?Pt(Ht[ln],fn[ln],Pn):Ht[ln];ke?(At.copy(je.normals[0]).multiplyScalar(In.x),st.copy(je.binormals[0]).multiplyScalar(In.y),Et.copy(Ve[0]).add(At).add(st),Qn(Et.x,Et.y,Et.z)):Qn(In.x,In.y,0)}for(let ln=1;ln<=ne;ln++)for(let In=0;In<Gt;In++){const Dn=se?Pt(Ht[In],fn[In],Pn):Ht[In];ke?(At.copy(je.normals[ln]).multiplyScalar(Dn.x),st.copy(je.binormals[ln]).multiplyScalar(Dn.y),Et.copy(Ve[ln]).add(At).add(st),Qn(Et.x,Et.y,Et.z)):Qn(Dn.x,Dn.y,re/ne*ln)}for(let ln=Fe-1;ln>=0;ln--){const In=ln/Fe,Dn=oe*Math.cos(In*Math.PI/2),ti=ve*Math.sin(In*Math.PI/2)+Te;for(let Hn=0,yi=Nt.length;Hn<yi;Hn++){const mi=Pt(Nt[Hn],kn[Hn],ti);Qn(mi.x,mi.y,re+Dn)}for(let Hn=0,yi=Ne.length;Hn<yi;Hn++){const mi=Ne[Hn];Vn=si[Hn];for(let zi=0,vr=mi.length;zi<vr;zi++){const cr=Pt(mi[zi],Vn[zi],ti);ke?Qn(cr.x,cr.y+Ve[ne-1].y,Ve[ne-1].x+Dn):Qn(cr.x,cr.y,re+Dn)}}}li(),Mt();function li(){const ln=v.length/3;if(se){let In=0,Dn=Gt*In;for(let ti=0;ti<sn;ti++){const Hn=It[ti];di(Hn[2]+Dn,Hn[1]+Dn,Hn[0]+Dn)}In=ne+Fe*2,Dn=Gt*In;for(let ti=0;ti<sn;ti++){const Hn=It[ti];di(Hn[0]+Dn,Hn[1]+Dn,Hn[2]+Dn)}}else{for(let In=0;In<sn;In++){const Dn=It[In];di(Dn[2],Dn[1],Dn[0])}for(let In=0;In<sn;In++){const Dn=It[In];di(Dn[0]+Gt*ne,Dn[1]+Gt*ne,Dn[2]+Gt*ne)}}d.addGroup(ln,v.length/3-ln,0)}function Mt(){const ln=v.length/3;let In=0;fi(Nt,In),In+=Nt.length;for(let Dn=0,ti=Ne.length;Dn<ti;Dn++){const Hn=Ne[Dn];fi(Hn,In),In+=Hn.length}d.addGroup(ln,v.length/3-ln,1)}function fi(ln,In){let Dn=ln.length;for(;--Dn>=0;){const ti=Dn;let Hn=Dn-1;Hn<0&&(Hn=ln.length-1);for(let yi=0,mi=ne+Fe*2;yi<mi;yi++){const zi=Gt*yi,vr=Gt*(yi+1),cr=In+ti+zi,ht=In+Hn+zi,Qe=In+Hn+vr,cn=In+ti+vr;Wn(cr,ht,Qe,cn)}}}function Qn(ln,In,Dn){z.push(ln),z.push(In),z.push(Dn)}function di(ln,In,Dn){Si(ln),Si(In),Si(Dn);const ti=v.length/3,Hn=ue.generateTopUV(d,v,ti-3,ti-2,ti-1);pi(Hn[0]),pi(Hn[1]),pi(Hn[2])}function Wn(ln,In,Dn,ti){Si(ln),Si(In),Si(ti),Si(In),Si(Dn),Si(ti);const Hn=v.length/3,yi=ue.generateSideWallUV(d,v,Hn-6,Hn-3,Hn-2,Hn-1);pi(yi[0]),pi(yi[1]),pi(yi[3]),pi(yi[1]),pi(yi[2]),pi(yi[3])}function Si(ln){v.push(z[ln*3+0]),v.push(z[ln*3+1]),v.push(z[ln*3+2])}function pi(ln){w.push(ln.x),w.push(ln.y)}}}toJSON(){const r=super.toJSON(),l=this.parameters.shapes,d=this.parameters.options;return uB(l,d,r)}static fromJSON(r,l){const d=[];for(let w=0,C=r.shapes.length;w<C;w++){const O=l[r.shapes[w]];d.push(O)}const v=r.options.extrudePath;return v!==void 0&&(r.options.extrudePath=new K1[v.type]().fromJSON(v)),new Ra(d,r.options)}}const cB={generateTopUV:function(A,r,l,d,v){const w=r[l*3],C=r[l*3+1],O=r[d*3],z=r[d*3+1],H=r[v*3],ne=r[v*3+1];return[new pn(w,C),new pn(O,z),new pn(H,ne)]},generateSideWallUV:function(A,r,l,d,v,w){const C=r[l*3],O=r[l*3+1],z=r[l*3+2],H=r[d*3],ne=r[d*3+1],re=r[d*3+2],se=r[v*3],oe=r[v*3+1],ve=r[v*3+2],Te=r[w*3],Fe=r[w*3+1],Ae=r[w*3+2];return Math.abs(O-ne)<Math.abs(C-H)?[new pn(C,1-z),new pn(H,1-re),new pn(se,1-ve),new pn(Te,1-Ae)]:[new pn(O,1-z),new pn(ne,1-re),new pn(oe,1-ve),new pn(Fe,1-Ae)]}};function uB(A,r,l){if(l.shapes=[],Array.isArray(A))for(let d=0,v=A.length;d<v;d++){const w=A[d];l.shapes.push(w.uuid)}else l.shapes.push(A.uuid);return r.extrudePath!==void 0&&(l.options.extrudePath=r.extrudePath.toJSON()),l}class df extends Sa{constructor(r=1,l=0){const d=(1+Math.sqrt(5))/2,v=[-1,d,0,1,d,0,-1,-d,0,1,-d,0,0,-1,d,0,1,d,0,-1,-d,0,1,-d,d,0,-1,d,0,1,-d,0,-1,-d,0,1],w=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(v,w,r,l),this.type="IcosahedronGeometry",this.parameters={radius:r,detail:l}}static fromJSON(r){return new df(r.radius,r.detail)}}class pf extends ui{constructor(r=[new pn(0,.5),new pn(.5,0),new pn(0,-.5)],l=12,d=0,v=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:r,segments:l,phiStart:d,phiLength:v},l=Math.floor(l),v=ys(v,0,Math.PI*2);const w=[],C=[],O=[],z=[],H=[],ne=1/l,re=new qe,se=new pn,oe=new qe,ve=new qe,Te=new qe;let Fe=0,Ae=0;for(let ue=0;ue<=r.length-1;ue++)switch(ue){case 0:Fe=r[ue+1].x-r[ue].x,Ae=r[ue+1].y-r[ue].y,oe.x=Ae*1,oe.y=-Fe,oe.z=Ae*0,Te.copy(oe),oe.normalize(),z.push(oe.x,oe.y,oe.z);break;case r.length-1:z.push(Te.x,Te.y,Te.z);break;default:Fe=r[ue+1].x-r[ue].x,Ae=r[ue+1].y-r[ue].y,oe.x=Ae*1,oe.y=-Fe,oe.z=Ae*0,ve.copy(oe),oe.x+=Te.x,oe.y+=Te.y,oe.z+=Te.z,oe.normalize(),z.push(oe.x,oe.y,oe.z),Te.copy(ve)}for(let ue=0;ue<=l;ue++){const Ve=d+ue*ne*v,ke=Math.sin(Ve),je=Math.cos(Ve);for(let st=0;st<=r.length-1;st++){re.x=r[st].x*ke,re.y=r[st].y,re.z=r[st].x*je,C.push(re.x,re.y,re.z),se.x=ue/l,se.y=st/(r.length-1),O.push(se.x,se.y);const At=z[3*st+0]*ke,Et=z[3*st+1],Xt=z[3*st+0]*je;H.push(At,Et,Xt)}}for(let ue=0;ue<l;ue++)for(let Ve=0;Ve<r.length-1;Ve++){const ke=Ve+ue*r.length,je=ke,st=ke+r.length,At=ke+r.length+1,Et=ke+1;w.push(je,st,Et),w.push(At,Et,st)}this.setIndex(w),this.setAttribute("position",new ei(C,3)),this.setAttribute("uv",new ei(O,2)),this.setAttribute("normal",new ei(H,3))}static fromJSON(r){return new pf(r.points,r.segments,r.phiStart,r.phiLength)}}class xu extends Sa{constructor(r=1,l=0){const d=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],v=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(d,v,r,l),this.type="OctahedronGeometry",this.parameters={radius:r,detail:l}}static fromJSON(r){return new xu(r.radius,r.detail)}}class mf extends ui{constructor(r=.5,l=1,d=8,v=1,w=0,C=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:r,outerRadius:l,thetaSegments:d,phiSegments:v,thetaStart:w,thetaLength:C},d=Math.max(3,d),v=Math.max(1,v);const O=[],z=[],H=[],ne=[];let re=r;const se=(l-r)/v,oe=new qe,ve=new pn;for(let Te=0;Te<=v;Te++){for(let Fe=0;Fe<=d;Fe++){const Ae=w+Fe/d*C;oe.x=re*Math.cos(Ae),oe.y=re*Math.sin(Ae),z.push(oe.x,oe.y,oe.z),H.push(0,0,1),ve.x=(oe.x/l+1)/2,ve.y=(oe.y/l+1)/2,ne.push(ve.x,ve.y)}re+=se}for(let Te=0;Te<v;Te++){const Fe=Te*(d+1);for(let Ae=0;Ae<d;Ae++){const ue=Ae+Fe,Ve=ue,ke=ue+d+1,je=ue+d+2,st=ue+1;O.push(Ve,ke,st),O.push(ke,je,st)}}this.setIndex(O),this.setAttribute("position",new ei(z,3)),this.setAttribute("normal",new ei(H,3)),this.setAttribute("uv",new ei(ne,2))}static fromJSON(r){return new mf(r.innerRadius,r.outerRadius,r.thetaSegments,r.phiSegments,r.thetaStart,r.thetaLength)}}class Au extends ui{constructor(r=new Ta([new pn(0,.5),new pn(-.5,-.5),new pn(.5,-.5)]),l=12){super(),this.type="ShapeGeometry",this.parameters={shapes:r,curveSegments:l};const d=[],v=[],w=[],C=[];let O=0,z=0;if(Array.isArray(r)===!1)H(r);else for(let ne=0;ne<r.length;ne++)H(r[ne]),this.addGroup(O,z,ne),O+=z,z=0;this.setIndex(d),this.setAttribute("position",new ei(v,3)),this.setAttribute("normal",new ei(w,3)),this.setAttribute("uv",new ei(C,2));function H(ne){const re=v.length/3,se=ne.extractPoints(l);let oe=se.shape;const ve=se.holes;Ca.isClockWise(oe)===!1&&(oe=oe.reverse());for(let Fe=0,Ae=ve.length;Fe<Ae;Fe++){const ue=ve[Fe];Ca.isClockWise(ue)===!0&&(ve[Fe]=ue.reverse())}const Te=Ca.triangulateShape(oe,ve);for(let Fe=0,Ae=ve.length;Fe<Ae;Fe++){const ue=ve[Fe];oe=oe.concat(ue)}for(let Fe=0,Ae=oe.length;Fe<Ae;Fe++){const ue=oe[Fe];v.push(ue.x,ue.y,0),w.push(0,0,1),C.push(ue.x,ue.y)}for(let Fe=0,Ae=Te.length;Fe<Ae;Fe++){const ue=Te[Fe],Ve=ue[0]+re,ke=ue[1]+re,je=ue[2]+re;d.push(Ve,ke,je),z+=3}}}toJSON(){const r=super.toJSON(),l=this.parameters.shapes;return hB(l,r)}static fromJSON(r,l){const d=[];for(let v=0,w=r.shapes.length;v<w;v++){const C=l[r.shapes[v]];d.push(C)}return new Au(d,r.curveSegments)}}function hB(A,r){if(r.shapes=[],Array.isArray(A))for(let l=0,d=A.length;l<d;l++){const v=A[l];r.shapes.push(v.uuid)}else r.shapes.push(A.uuid);return r}class bu extends ui{constructor(r=1,l=32,d=16,v=0,w=Math.PI*2,C=0,O=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:r,widthSegments:l,heightSegments:d,phiStart:v,phiLength:w,thetaStart:C,thetaLength:O},l=Math.max(3,Math.floor(l)),d=Math.max(2,Math.floor(d));const z=Math.min(C+O,Math.PI);let H=0;const ne=[],re=new qe,se=new qe,oe=[],ve=[],Te=[],Fe=[];for(let Ae=0;Ae<=d;Ae++){const ue=[],Ve=Ae/d;let ke=0;Ae==0&&C==0?ke=.5/l:Ae==d&&z==Math.PI&&(ke=-.5/l);for(let je=0;je<=l;je++){const st=je/l;re.x=-r*Math.cos(v+st*w)*Math.sin(C+Ve*O),re.y=r*Math.cos(C+Ve*O),re.z=r*Math.sin(v+st*w)*Math.sin(C+Ve*O),ve.push(re.x,re.y,re.z),se.copy(re).normalize(),Te.push(se.x,se.y,se.z),Fe.push(st+ke,1-Ve),ue.push(H++)}ne.push(ue)}for(let Ae=0;Ae<d;Ae++)for(let ue=0;ue<l;ue++){const Ve=ne[Ae][ue+1],ke=ne[Ae][ue],je=ne[Ae+1][ue],st=ne[Ae+1][ue+1];(Ae!==0||C>0)&&oe.push(Ve,ke,st),(Ae!==d-1||z<Math.PI)&&oe.push(ke,je,st)}this.setIndex(oe),this.setAttribute("position",new ei(ve,3)),this.setAttribute("normal",new ei(Te,3)),this.setAttribute("uv",new ei(Fe,2))}static fromJSON(r){return new bu(r.radius,r.widthSegments,r.heightSegments,r.phiStart,r.phiLength,r.thetaStart,r.thetaLength)}}class gf extends Sa{constructor(r=1,l=0){const d=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],v=[2,1,0,0,3,2,1,3,0,2,3,1];super(d,v,r,l),this.type="TetrahedronGeometry",this.parameters={radius:r,detail:l}}static fromJSON(r){return new gf(r.radius,r.detail)}}class vf extends ui{constructor(r=1,l=.4,d=8,v=6,w=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:r,tube:l,radialSegments:d,tubularSegments:v,arc:w},d=Math.floor(d),v=Math.floor(v);const C=[],O=[],z=[],H=[],ne=new qe,re=new qe,se=new qe;for(let oe=0;oe<=d;oe++)for(let ve=0;ve<=v;ve++){const Te=ve/v*w,Fe=oe/d*Math.PI*2;re.x=(r+l*Math.cos(Fe))*Math.cos(Te),re.y=(r+l*Math.cos(Fe))*Math.sin(Te),re.z=l*Math.sin(Fe),O.push(re.x,re.y,re.z),ne.x=r*Math.cos(Te),ne.y=r*Math.sin(Te),se.subVectors(re,ne).normalize(),z.push(se.x,se.y,se.z),H.push(ve/v),H.push(oe/d)}for(let oe=1;oe<=d;oe++)for(let ve=1;ve<=v;ve++){const Te=(v+1)*oe+ve-1,Fe=(v+1)*(oe-1)+ve-1,Ae=(v+1)*(oe-1)+ve,ue=(v+1)*oe+ve;C.push(Te,Fe,ue),C.push(Fe,Ae,ue)}this.setIndex(C),this.setAttribute("position",new ei(O,3)),this.setAttribute("normal",new ei(z,3)),this.setAttribute("uv",new ei(H,2))}static fromJSON(r){return new vf(r.radius,r.tube,r.radialSegments,r.tubularSegments,r.arc)}}class yf extends ui{constructor(r=1,l=.4,d=64,v=8,w=2,C=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:r,tube:l,tubularSegments:d,radialSegments:v,p:w,q:C},d=Math.floor(d),v=Math.floor(v);const O=[],z=[],H=[],ne=[],re=new qe,se=new qe,oe=new qe,ve=new qe,Te=new qe,Fe=new qe,Ae=new qe;for(let Ve=0;Ve<=d;++Ve){const ke=Ve/d*w*Math.PI*2;ue(ke,w,C,r,oe),ue(ke+.01,w,C,r,ve),Fe.subVectors(ve,oe),Ae.addVectors(ve,oe),Te.crossVectors(Fe,Ae),Ae.crossVectors(Te,Fe),Te.normalize(),Ae.normalize();for(let je=0;je<=v;++je){const st=je/v*Math.PI*2,At=-l*Math.cos(st),Et=l*Math.sin(st);re.x=oe.x+(At*Ae.x+Et*Te.x),re.y=oe.y+(At*Ae.y+Et*Te.y),re.z=oe.z+(At*Ae.z+Et*Te.z),z.push(re.x,re.y,re.z),se.subVectors(re,oe).normalize(),H.push(se.x,se.y,se.z),ne.push(Ve/d),ne.push(je/v)}}for(let Ve=1;Ve<=d;Ve++)for(let ke=1;ke<=v;ke++){const je=(v+1)*(Ve-1)+(ke-1),st=(v+1)*Ve+(ke-1),At=(v+1)*Ve+ke,Et=(v+1)*(Ve-1)+ke;O.push(je,st,Et),O.push(st,At,Et)}this.setIndex(O),this.setAttribute("position",new ei(z,3)),this.setAttribute("normal",new ei(H,3)),this.setAttribute("uv",new ei(ne,2));function ue(Ve,ke,je,st,At){const Et=Math.cos(Ve),Xt=Math.sin(Ve),Ht=je/ke*Ve,Ne=Math.cos(Ht);At.x=st*(2+Ne)*.5*Et,At.y=st*(2+Ne)*Xt*.5,At.z=st*Math.sin(Ht)*.5}}static fromJSON(r){return new yf(r.radius,r.tube,r.tubularSegments,r.radialSegments,r.p,r.q)}}class xf extends ui{constructor(r=new $0(new qe(-1,-1,0),new qe(-1,1,0),new qe(1,1,0)),l=64,d=1,v=8,w=!1){super(),this.type="TubeGeometry",this.parameters={path:r,tubularSegments:l,radius:d,radialSegments:v,closed:w};const C=r.computeFrenetFrames(l,w);this.tangents=C.tangents,this.normals=C.normals,this.binormals=C.binormals;const O=new qe,z=new qe,H=new pn;let ne=new qe;const re=[],se=[],oe=[],ve=[];Te(),this.setIndex(ve),this.setAttribute("position",new ei(re,3)),this.setAttribute("normal",new ei(se,3)),this.setAttribute("uv",new ei(oe,2));function Te(){for(let Ve=0;Ve<l;Ve++)Fe(Ve);Fe(w===!1?l:0),ue(),Ae()}function Fe(Ve){ne=r.getPointAt(Ve/l,ne);const ke=C.normals[Ve],je=C.binormals[Ve];for(let st=0;st<=v;st++){const At=st/v*Math.PI*2,Et=Math.sin(At),Xt=-Math.cos(At);z.x=Xt*ke.x+Et*je.x,z.y=Xt*ke.y+Et*je.y,z.z=Xt*ke.z+Et*je.z,z.normalize(),se.push(z.x,z.y,z.z),O.x=ne.x+d*z.x,O.y=ne.y+d*z.y,O.z=ne.z+d*z.z,re.push(O.x,O.y,O.z)}}function Ae(){for(let Ve=1;Ve<=l;Ve++)for(let ke=1;ke<=v;ke++){const je=(v+1)*(Ve-1)+(ke-1),st=(v+1)*Ve+(ke-1),At=(v+1)*Ve+ke,Et=(v+1)*(Ve-1)+ke;ve.push(je,st,Et),ve.push(st,At,Et)}}function ue(){for(let Ve=0;Ve<=l;Ve++)for(let ke=0;ke<=v;ke++)H.x=Ve/l,H.y=ke/v,oe.push(H.x,H.y)}}toJSON(){const r=super.toJSON();return r.path=this.parameters.path.toJSON(),r}static fromJSON(r){return new xf(new K1[r.path.type]().fromJSON(r.path),r.tubularSegments,r.radius,r.radialSegments,r.closed)}}class ex extends ui{constructor(r=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:r},r!==null){const l=[],d=new Set,v=new qe,w=new qe;if(r.index!==null){const C=r.attributes.position,O=r.index;let z=r.groups;z.length===0&&(z=[{start:0,count:O.count,materialIndex:0}]);for(let H=0,ne=z.length;H<ne;++H){const re=z[H],se=re.start,oe=re.count;for(let ve=se,Te=se+oe;ve<Te;ve+=3)for(let Fe=0;Fe<3;Fe++){const Ae=O.getX(ve+Fe),ue=O.getX(ve+(Fe+1)%3);v.fromBufferAttribute(C,Ae),w.fromBufferAttribute(C,ue),fM(v,w,d)===!0&&(l.push(v.x,v.y,v.z),l.push(w.x,w.y,w.z))}}}else{const C=r.attributes.position;for(let O=0,z=C.count/3;O<z;O++)for(let H=0;H<3;H++){const ne=3*O+H,re=3*O+(H+1)%3;v.fromBufferAttribute(C,ne),w.fromBufferAttribute(C,re),fM(v,w,d)===!0&&(l.push(v.x,v.y,v.z),l.push(w.x,w.y,w.z))}}this.setAttribute("position",new ei(l,3))}}}function fM(A,r,l){const d=`${A.x},${A.y},${A.z}-${r.x},${r.y},${r.z}`,v=`${r.x},${r.y},${r.z}-${A.x},${A.y},${A.z}`;return l.has(d)===!0||l.has(v)===!0?!1:(l.add(d,v),!0)}var dM=Object.freeze({__proto__:null,BoxGeometry:yl,BoxBufferGeometry:yl,CircleGeometry:cf,CircleBufferGeometry:cf,ConeGeometry:uf,ConeBufferGeometry:uf,CylinderGeometry:lc,CylinderBufferGeometry:lc,DodecahedronGeometry:hf,DodecahedronBufferGeometry:hf,EdgesGeometry:V1,ExtrudeGeometry:Ra,ExtrudeBufferGeometry:Ra,IcosahedronGeometry:df,IcosahedronBufferGeometry:df,LatheGeometry:pf,LatheBufferGeometry:pf,OctahedronGeometry:xu,OctahedronBufferGeometry:xu,PlaneGeometry:du,PlaneBufferGeometry:du,PolyhedronGeometry:Sa,PolyhedronBufferGeometry:Sa,RingGeometry:mf,RingBufferGeometry:mf,ShapeGeometry:Au,ShapeBufferGeometry:Au,SphereGeometry:bu,SphereBufferGeometry:bu,TetrahedronGeometry:gf,TetrahedronBufferGeometry:gf,TorusGeometry:vf,TorusBufferGeometry:vf,TorusKnotGeometry:yf,TorusKnotBufferGeometry:yf,TubeGeometry:xf,TubeBufferGeometry:xf,WireframeGeometry:ex});class tx extends as{constructor(r){super(),this.type="ShadowMaterial",this.color=new Un(0),this.transparent=!0,this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this}}tx.prototype.isShadowMaterial=!0;class Z0 extends as{constructor(r){super(),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new Un(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Un(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Fr,this.normalScale=new pn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(r)}copy(r){return super.copy(r),this.defines={STANDARD:""},this.color.copy(r.color),this.roughness=r.roughness,this.metalness=r.metalness,this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.emissive.copy(r.emissive),this.emissiveMap=r.emissiveMap,this.emissiveIntensity=r.emissiveIntensity,this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.roughnessMap=r.roughnessMap,this.metalnessMap=r.metalnessMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.envMapIntensity=r.envMapIntensity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.flatShading=r.flatShading,this}}Z0.prototype.isMeshStandardMaterial=!0;class nx extends Z0{constructor(r){super(),this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new pn(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return ys(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(l){this.ior=(1+.4*l)/(1-.4*l)}}),this.sheenColor=new Un(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new Un(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new Un(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._transmission=0,this.setValues(r)}get sheen(){return this._sheen}set sheen(r){this._sheen>0!=r>0&&this.version++,this._sheen=r}get clearcoat(){return this._clearcoat}set clearcoat(r){this._clearcoat>0!=r>0&&this.version++,this._clearcoat=r}get transmission(){return this._transmission}set transmission(r){this._transmission>0!=r>0&&this.version++,this._transmission=r}copy(r){return super.copy(r),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=r.clearcoat,this.clearcoatMap=r.clearcoatMap,this.clearcoatRoughness=r.clearcoatRoughness,this.clearcoatRoughnessMap=r.clearcoatRoughnessMap,this.clearcoatNormalMap=r.clearcoatNormalMap,this.clearcoatNormalScale.copy(r.clearcoatNormalScale),this.ior=r.ior,this.sheen=r.sheen,this.sheenColor.copy(r.sheenColor),this.sheenColorMap=r.sheenColorMap,this.sheenRoughness=r.sheenRoughness,this.sheenRoughnessMap=r.sheenRoughnessMap,this.transmission=r.transmission,this.transmissionMap=r.transmissionMap,this.thickness=r.thickness,this.thicknessMap=r.thicknessMap,this.attenuationDistance=r.attenuationDistance,this.attenuationColor.copy(r.attenuationColor),this.specularIntensity=r.specularIntensity,this.specularIntensityMap=r.specularIntensityMap,this.specularColor.copy(r.specularColor),this.specularColorMap=r.specularColorMap,this}}nx.prototype.isMeshPhysicalMaterial=!0;class ix extends as{constructor(r){super(),this.type="MeshPhongMaterial",this.color=new Un(16777215),this.specular=new Un(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Un(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Fr,this.normalScale=new pn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Je,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.specular.copy(r.specular),this.shininess=r.shininess,this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.emissive.copy(r.emissive),this.emissiveMap=r.emissiveMap,this.emissiveIntensity=r.emissiveIntensity,this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.specularMap=r.specularMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.combine=r.combine,this.reflectivity=r.reflectivity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this.flatShading=r.flatShading,this}}ix.prototype.isMeshPhongMaterial=!0;class rx extends as{constructor(r){super(),this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new Un(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Un(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Fr,this.normalScale=new pn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.map=r.map,this.gradientMap=r.gradientMap,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.emissive.copy(r.emissive),this.emissiveMap=r.emissiveMap,this.emissiveIntensity=r.emissiveIntensity,this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.alphaMap=r.alphaMap,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this}}rx.prototype.isMeshToonMaterial=!0;class sx extends as{constructor(r){super(),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Fr,this.normalScale=new pn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.flatShading=!1,this.setValues(r)}copy(r){return super.copy(r),this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.flatShading=r.flatShading,this}}sx.prototype.isMeshNormalMaterial=!0;class ox extends as{constructor(r){super(),this.type="MeshLambertMaterial",this.color=new Un(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new Un(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Je,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.setValues(r)}copy(r){return super.copy(r),this.color.copy(r.color),this.map=r.map,this.lightMap=r.lightMap,this.lightMapIntensity=r.lightMapIntensity,this.aoMap=r.aoMap,this.aoMapIntensity=r.aoMapIntensity,this.emissive.copy(r.emissive),this.emissiveMap=r.emissiveMap,this.emissiveIntensity=r.emissiveIntensity,this.specularMap=r.specularMap,this.alphaMap=r.alphaMap,this.envMap=r.envMap,this.combine=r.combine,this.reflectivity=r.reflectivity,this.refractionRatio=r.refractionRatio,this.wireframe=r.wireframe,this.wireframeLinewidth=r.wireframeLinewidth,this.wireframeLinecap=r.wireframeLinecap,this.wireframeLinejoin=r.wireframeLinejoin,this}}ox.prototype.isMeshLambertMaterial=!0;class ax extends as{constructor(r){super(),this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new Un(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=Fr,this.normalScale=new pn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.setValues(r)}copy(r){return super.copy(r),this.defines={MATCAP:""},this.color.copy(r.color),this.matcap=r.matcap,this.map=r.map,this.bumpMap=r.bumpMap,this.bumpScale=r.bumpScale,this.normalMap=r.normalMap,this.normalMapType=r.normalMapType,this.normalScale.copy(r.normalScale),this.displacementMap=r.displacementMap,this.displacementScale=r.displacementScale,this.displacementBias=r.displacementBias,this.alphaMap=r.alphaMap,this.flatShading=r.flatShading,this}}ax.prototype.isMeshMatcapMaterial=!0;class lx extends cs{constructor(r){super(),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(r)}copy(r){return super.copy(r),this.scale=r.scale,this.dashSize=r.dashSize,this.gapSize=r.gapSize,this}}lx.prototype.isLineDashedMaterial=!0;var fB=Object.freeze({__proto__:null,ShadowMaterial:tx,SpriteMaterial:C0,RawShaderMaterial:Jh,ShaderMaterial:xl,PointsMaterial:yu,MeshPhysicalMaterial:nx,MeshStandardMaterial:Z0,MeshPhongMaterial:ix,MeshToonMaterial:rx,MeshNormalMaterial:sx,MeshLambertMaterial:ox,MeshDepthMaterial:w0,MeshDistanceMaterial:E0,MeshBasicMaterial:vl,MeshMatcapMaterial:ax,LineDashedMaterial:lx,LineBasicMaterial:cs,Material:as});const Ar={arraySlice:function(A,r,l){return Ar.isTypedArray(A)?new A.constructor(A.subarray(r,l!==void 0?l:A.length)):A.slice(r,l)},convertArray:function(A,r,l){return!A||!l&&A.constructor===r?A:typeof r.BYTES_PER_ELEMENT=="number"?new r(A):Array.prototype.slice.call(A)},isTypedArray:function(A){return ArrayBuffer.isView(A)&&!(A instanceof DataView)},getKeyframeOrder:function(A){function r(v,w){return A[v]-A[w]}const l=A.length,d=new Array(l);for(let v=0;v!==l;++v)d[v]=v;return d.sort(r),d},sortedArray:function(A,r,l){const d=A.length,v=new A.constructor(d);for(let w=0,C=0;C!==d;++w){const O=l[w]*r;for(let z=0;z!==r;++z)v[C++]=A[O+z]}return v},flattenJSON:function(A,r,l,d){let v=1,w=A[0];for(;w!==void 0&&w[d]===void 0;)w=A[v++];if(w===void 0)return;let C=w[d];if(C!==void 0)if(Array.isArray(C))do C=w[d],C!==void 0&&(r.push(w.time),l.push.apply(l,C)),w=A[v++];while(w!==void 0);else if(C.toArray!==void 0)do C=w[d],C!==void 0&&(r.push(w.time),C.toArray(l,l.length)),w=A[v++];while(w!==void 0);else do C=w[d],C!==void 0&&(r.push(w.time),l.push(C)),w=A[v++];while(w!==void 0)},subclip:function(A,r,l,d,v=30){const w=A.clone();w.name=r;const C=[];for(let z=0;z<w.tracks.length;++z){const H=w.tracks[z],ne=H.getValueSize(),re=[],se=[];for(let oe=0;oe<H.times.length;++oe){const ve=H.times[oe]*v;if(!(ve<l||ve>=d)){re.push(H.times[oe]);for(let Te=0;Te<ne;++Te)se.push(H.values[oe*ne+Te])}}re.length!==0&&(H.times=Ar.convertArray(re,H.times.constructor),H.values=Ar.convertArray(se,H.values.constructor),C.push(H))}w.tracks=C;let O=1/0;for(let z=0;z<w.tracks.length;++z)O>w.tracks[z].times[0]&&(O=w.tracks[z].times[0]);for(let z=0;z<w.tracks.length;++z)w.tracks[z].shift(-1*O);return w.resetDuration(),w},makeClipAdditive:function(A,r=0,l=A,d=30){d<=0&&(d=30);const v=l.tracks.length,w=r/d;for(let C=0;C<v;++C){const O=l.tracks[C],z=O.ValueTypeName;if(z==="bool"||z==="string")continue;const H=A.tracks.find(function(Ae){return Ae.name===O.name&&Ae.ValueTypeName===z});if(H===void 0)continue;let ne=0;const re=O.getValueSize();O.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(ne=re/3);let se=0;const oe=H.getValueSize();H.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(se=oe/3);const ve=O.times.length-1;let Te;if(w<=O.times[0]){const Ae=ne,ue=re-ne;Te=Ar.arraySlice(O.values,Ae,ue)}else if(w>=O.times[ve]){const Ae=ve*re+ne,ue=Ae+re-ne;Te=Ar.arraySlice(O.values,Ae,ue)}else{const Ae=O.createInterpolant(),ue=ne,Ve=re-ne;Ae.evaluate(w),Te=Ar.arraySlice(Ae.resultBuffer,ue,Ve)}z==="quaternion"&&new os().fromArray(Te).normalize().conjugate().toArray(Te);const Fe=H.times.length;for(let Ae=0;Ae<Fe;++Ae){const ue=Ae*oe+se;if(z==="quaternion")os.multiplyQuaternionsFlat(H.values,ue,Te,0,H.values,ue);else{const Ve=oe-se*2;for(let ke=0;ke<Ve;++ke)H.values[ue+ke]-=Te[ke]}}}return A.blendMode=$n,A}};class bl{constructor(r,l,d,v){this.parameterPositions=r,this._cachedIndex=0,this.resultBuffer=v!==void 0?v:new l.constructor(d),this.sampleValues=l,this.valueSize=d,this.settings=null,this.DefaultSettings_={}}evaluate(r){const l=this.parameterPositions;let d=this._cachedIndex,v=l[d],w=l[d-1];e:{t:{let C;n:{i:if(!(r<v)){for(let O=d+2;;){if(v===void 0){if(r<w)break i;return d=l.length,this._cachedIndex=d,this.afterEnd_(d-1,r,w)}if(d===O)break;if(w=v,v=l[++d],r<v)break t}C=l.length;break n}if(!(r>=w)){const O=l[1];r<O&&(d=2,w=O);for(let z=d-2;;){if(w===void 0)return this._cachedIndex=0,this.beforeStart_(0,r,v);if(d===z)break;if(v=w,w=l[--d-1],r>=w)break t}C=d,d=0;break n}break e}for(;d<C;){const O=d+C>>>1;r<l[O]?C=O:d=O+1}if(v=l[d],w=l[d-1],w===void 0)return this._cachedIndex=0,this.beforeStart_(0,r,v);if(v===void 0)return d=l.length,this._cachedIndex=d,this.afterEnd_(d-1,w,r)}this._cachedIndex=d,this.intervalChanged_(d,w,v)}return this.interpolate_(d,w,r,v)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(r){const l=this.resultBuffer,d=this.sampleValues,v=this.valueSize,w=r*v;for(let C=0;C!==v;++C)l[C]=d[w+C];return l}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}bl.prototype.beforeStart_=bl.prototype.copySampleValue_,bl.prototype.afterEnd_=bl.prototype.copySampleValue_;class pM extends bl{constructor(r,l,d,v){super(r,l,d,v),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Tn,endingEnd:Tn}}intervalChanged_(r,l,d){const v=this.parameterPositions;let w=r-2,C=r+1,O=v[w],z=v[C];if(O===void 0)switch(this.getSettings_().endingStart){case Ln:w=r,O=2*l-d;break;case Xn:w=v.length-2,O=l+v[w]-v[w+1];break;default:w=r,O=d}if(z===void 0)switch(this.getSettings_().endingEnd){case Ln:C=r,z=2*d-l;break;case Xn:C=1,z=d+v[1]-v[0];break;default:C=r-1,z=l}const H=(d-l)*.5,ne=this.valueSize;this._weightPrev=H/(l-O),this._weightNext=H/(z-d),this._offsetPrev=w*ne,this._offsetNext=C*ne}interpolate_(r,l,d,v){const w=this.resultBuffer,C=this.sampleValues,O=this.valueSize,z=r*O,H=z-O,ne=this._offsetPrev,re=this._offsetNext,se=this._weightPrev,oe=this._weightNext,ve=(d-l)/(v-l),Te=ve*ve,Fe=Te*ve,Ae=-se*Fe+2*se*Te-se*ve,ue=(1+se)*Fe+(-1.5-2*se)*Te+(-.5+se)*ve+1,Ve=(-1-oe)*Fe+(1.5+oe)*Te+.5*ve,ke=oe*Fe-oe*Te;for(let je=0;je!==O;++je)w[je]=Ae*C[ne+je]+ue*C[H+je]+Ve*C[z+je]+ke*C[re+je];return w}}class cx extends bl{constructor(r,l,d,v){super(r,l,d,v)}interpolate_(r,l,d,v){const w=this.resultBuffer,C=this.sampleValues,O=this.valueSize,z=r*O,H=z-O,ne=(d-l)/(v-l),re=1-ne;for(let se=0;se!==O;++se)w[se]=C[H+se]*re+C[z+se]*ne;return w}}class mM extends bl{constructor(r,l,d,v){super(r,l,d,v)}interpolate_(r){return this.copySampleValue_(r-1)}}class Ko{constructor(r,l,d,v){if(r===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(l===void 0||l.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+r);this.name=r,this.times=Ar.convertArray(l,this.TimeBufferType),this.values=Ar.convertArray(d,this.ValueBufferType),this.setInterpolation(v||this.DefaultInterpolation)}static toJSON(r){const l=r.constructor;let d;if(l.toJSON!==this.toJSON)d=l.toJSON(r);else{d={name:r.name,times:Ar.convertArray(r.times,Array),values:Ar.convertArray(r.values,Array)};const v=r.getInterpolation();v!==r.DefaultInterpolation&&(d.interpolation=v)}return d.type=r.ValueTypeName,d}InterpolantFactoryMethodDiscrete(r){return new mM(this.times,this.values,this.getValueSize(),r)}InterpolantFactoryMethodLinear(r){return new cx(this.times,this.values,this.getValueSize(),r)}InterpolantFactoryMethodSmooth(r){return new pM(this.times,this.values,this.getValueSize(),r)}setInterpolation(r){let l;switch(r){case Ot:l=this.InterpolantFactoryMethodDiscrete;break;case Qt:l=this.InterpolantFactoryMethodLinear;break;case _n:l=this.InterpolantFactoryMethodSmooth;break}if(l===void 0){const d="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(r!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(d);return console.warn("THREE.KeyframeTrack:",d),this}return this.createInterpolant=l,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return Ot;case this.InterpolantFactoryMethodLinear:return Qt;case this.InterpolantFactoryMethodSmooth:return _n}}getValueSize(){return this.values.length/this.times.length}shift(r){if(r!==0){const l=this.times;for(let d=0,v=l.length;d!==v;++d)l[d]+=r}return this}scale(r){if(r!==1){const l=this.times;for(let d=0,v=l.length;d!==v;++d)l[d]*=r}return this}trim(r,l){const d=this.times,v=d.length;let w=0,C=v-1;for(;w!==v&&d[w]<r;)++w;for(;C!==-1&&d[C]>l;)--C;if(++C,w!==0||C!==v){w>=C&&(C=Math.max(C,1),w=C-1);const O=this.getValueSize();this.times=Ar.arraySlice(d,w,C),this.values=Ar.arraySlice(this.values,w*O,C*O)}return this}validate(){let r=!0;const l=this.getValueSize();l-Math.floor(l)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),r=!1);const d=this.times,v=this.values,w=d.length;w===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),r=!1);let C=null;for(let O=0;O!==w;O++){const z=d[O];if(typeof z=="number"&&isNaN(z)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,O,z),r=!1;break}if(C!==null&&C>z){console.error("THREE.KeyframeTrack: Out of order keys.",this,O,z,C),r=!1;break}C=z}if(v!==void 0&&Ar.isTypedArray(v))for(let O=0,z=v.length;O!==z;++O){const H=v[O];if(isNaN(H)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,O,H),r=!1;break}}return r}optimize(){const r=Ar.arraySlice(this.times),l=Ar.arraySlice(this.values),d=this.getValueSize(),v=this.getInterpolation()===_n,w=r.length-1;let C=1;for(let O=1;O<w;++O){let z=!1;const H=r[O],ne=r[O+1];if(H!==ne&&(O!==1||H!==r[0]))if(v)z=!0;else{const re=O*d,se=re-d,oe=re+d;for(let ve=0;ve!==d;++ve){const Te=l[re+ve];if(Te!==l[se+ve]||Te!==l[oe+ve]){z=!0;break}}}if(z){if(O!==C){r[C]=r[O];const re=O*d,se=C*d;for(let oe=0;oe!==d;++oe)l[se+oe]=l[re+oe]}++C}}if(w>0){r[C]=r[w];for(let O=w*d,z=C*d,H=0;H!==d;++H)l[z+H]=l[O+H];++C}return C!==r.length?(this.times=Ar.arraySlice(r,0,C),this.values=Ar.arraySlice(l,0,C*d)):(this.times=r,this.values=l),this}clone(){const r=Ar.arraySlice(this.times,0),l=Ar.arraySlice(this.values,0),d=this.constructor,v=new d(this.name,r,l);return v.createInterpolant=this.createInterpolant,v}}Ko.prototype.TimeBufferType=Float32Array,Ko.prototype.ValueBufferType=Float32Array,Ko.prototype.DefaultInterpolation=Qt;class _u extends Ko{}_u.prototype.ValueTypeName="bool",_u.prototype.ValueBufferType=Array,_u.prototype.DefaultInterpolation=Ot,_u.prototype.InterpolantFactoryMethodLinear=void 0,_u.prototype.InterpolantFactoryMethodSmooth=void 0;class ux extends Ko{}ux.prototype.ValueTypeName="color";class Ep extends Ko{}Ep.prototype.ValueTypeName="number";class gM extends bl{constructor(r,l,d,v){super(r,l,d,v)}interpolate_(r,l,d,v){const w=this.resultBuffer,C=this.sampleValues,O=this.valueSize,z=(d-l)/(v-l);let H=r*O;for(let ne=H+O;H!==ne;H+=4)os.slerpFlat(w,0,C,H-O,C,H,z);return w}}class Af extends Ko{InterpolantFactoryMethodLinear(r){return new gM(this.times,this.values,this.getValueSize(),r)}}Af.prototype.ValueTypeName="quaternion",Af.prototype.DefaultInterpolation=Qt,Af.prototype.InterpolantFactoryMethodSmooth=void 0;class wu extends Ko{}wu.prototype.ValueTypeName="string",wu.prototype.ValueBufferType=Array,wu.prototype.DefaultInterpolation=Ot,wu.prototype.InterpolantFactoryMethodLinear=void 0,wu.prototype.InterpolantFactoryMethodSmooth=void 0;class Mp extends Ko{}Mp.prototype.ValueTypeName="vector";class Sp{constructor(r,l=-1,d,v=Yn){this.name=r,this.tracks=d,this.duration=l,this.blendMode=v,this.uuid=ho(),this.duration<0&&this.resetDuration()}static parse(r){const l=[],d=r.tracks,v=1/(r.fps||1);for(let C=0,O=d.length;C!==O;++C)l.push(pB(d[C]).scale(v));const w=new this(r.name,r.duration,l,r.blendMode);return w.uuid=r.uuid,w}static toJSON(r){const l=[],d=r.tracks,v={name:r.name,duration:r.duration,tracks:l,uuid:r.uuid,blendMode:r.blendMode};for(let w=0,C=d.length;w!==C;++w)l.push(Ko.toJSON(d[w]));return v}static CreateFromMorphTargetSequence(r,l,d,v){const w=l.length,C=[];for(let O=0;O<w;O++){let z=[],H=[];z.push((O+w-1)%w,O,(O+1)%w),H.push(0,1,0);const ne=Ar.getKeyframeOrder(z);z=Ar.sortedArray(z,1,ne),H=Ar.sortedArray(H,1,ne),!v&&z[0]===0&&(z.push(w),H.push(H[0])),C.push(new Ep(".morphTargetInfluences["+l[O].name+"]",z,H).scale(1/d))}return new this(r,-1,C)}static findByName(r,l){let d=r;if(!Array.isArray(r)){const v=r;d=v.geometry&&v.geometry.animations||v.animations}for(let v=0;v<d.length;v++)if(d[v].name===l)return d[v];return null}static CreateClipsFromMorphTargetSequences(r,l,d){const v={},w=/^([\w-]*?)([\d]+)$/;for(let O=0,z=r.length;O<z;O++){const H=r[O],ne=H.name.match(w);if(ne&&ne.length>1){const re=ne[1];let se=v[re];se||(v[re]=se=[]),se.push(H)}}const C=[];for(const O in v)C.push(this.CreateFromMorphTargetSequence(O,v[O],l,d));return C}static parseAnimation(r,l){if(!r)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const d=function(re,se,oe,ve,Te){if(oe.length!==0){const Fe=[],Ae=[];Ar.flattenJSON(oe,Fe,Ae,ve),Fe.length!==0&&Te.push(new re(se,Fe,Ae))}},v=[],w=r.name||"default",C=r.fps||30,O=r.blendMode;let z=r.length||-1;const H=r.hierarchy||[];for(let re=0;re<H.length;re++){const se=H[re].keys;if(!(!se||se.length===0))if(se[0].morphTargets){const oe={};let ve;for(ve=0;ve<se.length;ve++)if(se[ve].morphTargets)for(let Te=0;Te<se[ve].morphTargets.length;Te++)oe[se[ve].morphTargets[Te]]=-1;for(const Te in oe){const Fe=[],Ae=[];for(let ue=0;ue!==se[ve].morphTargets.length;++ue){const Ve=se[ve];Fe.push(Ve.time),Ae.push(Ve.morphTarget===Te?1:0)}v.push(new Ep(".morphTargetInfluence["+Te+"]",Fe,Ae))}z=oe.length*(C||1)}else{const oe=".bones["+l[re].name+"]";d(Mp,oe+".position",se,"pos",v),d(Af,oe+".quaternion",se,"rot",v),d(Mp,oe+".scale",se,"scl",v)}}return v.length===0?null:new this(w,z,v,O)}resetDuration(){const r=this.tracks;let l=0;for(let d=0,v=r.length;d!==v;++d){const w=this.tracks[d];l=Math.max(l,w.times[w.times.length-1])}return this.duration=l,this}trim(){for(let r=0;r<this.tracks.length;r++)this.tracks[r].trim(0,this.duration);return this}validate(){let r=!0;for(let l=0;l<this.tracks.length;l++)r=r&&this.tracks[l].validate();return r}optimize(){for(let r=0;r<this.tracks.length;r++)this.tracks[r].optimize();return this}clone(){const r=[];for(let l=0;l<this.tracks.length;l++)r.push(this.tracks[l].clone());return new this.constructor(this.name,this.duration,r,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function dB(A){switch(A.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Ep;case"vector":case"vector2":case"vector3":case"vector4":return Mp;case"color":return ux;case"quaternion":return Af;case"bool":case"boolean":return _u;case"string":return wu}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+A)}function pB(A){if(A.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const r=dB(A.type);if(A.times===void 0){const l=[],d=[];Ar.flattenJSON(A.keys,l,d,"value"),A.times=l,A.values=d}return r.parse!==void 0?r.parse(A):new r(A.name,A.times,A.values,A.interpolation)}const Eu={enabled:!1,files:{},add:function(A,r){this.enabled!==!1&&(this.files[A]=r)},get:function(A){if(this.enabled!==!1)return this.files[A]},remove:function(A){delete this.files[A]},clear:function(){this.files={}}};class hx{constructor(r,l,d){const v=this;let w=!1,C=0,O=0,z;const H=[];this.onStart=void 0,this.onLoad=r,this.onProgress=l,this.onError=d,this.itemStart=function(ne){O++,w===!1&&v.onStart!==void 0&&v.onStart(ne,C,O),w=!0},this.itemEnd=function(ne){C++,v.onProgress!==void 0&&v.onProgress(ne,C,O),C===O&&(w=!1,v.onLoad!==void 0&&v.onLoad())},this.itemError=function(ne){v.onError!==void 0&&v.onError(ne)},this.resolveURL=function(ne){return z?z(ne):ne},this.setURLModifier=function(ne){return z=ne,this},this.addHandler=function(ne,re){return H.push(ne,re),this},this.removeHandler=function(ne){const re=H.indexOf(ne);return re!==-1&&H.splice(re,2),this},this.getHandler=function(ne){for(let re=0,se=H.length;re<se;re+=2){const oe=H[re],ve=H[re+1];if(oe.global&&(oe.lastIndex=0),oe.test(ne))return ve}return null}}}const vM=new hx;class Xs{constructor(r){this.manager=r!==void 0?r:vM,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(r,l){const d=this;return new Promise(function(v,w){d.load(r,v,l,w)})}parse(){}setCrossOrigin(r){return this.crossOrigin=r,this}setWithCredentials(r){return this.withCredentials=r,this}setPath(r){return this.path=r,this}setResourcePath(r){return this.resourcePath=r,this}setRequestHeader(r){return this.requestHeader=r,this}}const _l={};class La extends Xs{constructor(r){super(r)}load(r,l,d,v){r===void 0&&(r=""),this.path!==void 0&&(r=this.path+r),r=this.manager.resolveURL(r);const w=Eu.get(r);if(w!==void 0)return this.manager.itemStart(r),setTimeout(()=>{l&&l(w),this.manager.itemEnd(r)},0),w;if(_l[r]!==void 0){_l[r].push({onLoad:l,onProgress:d,onError:v});return}_l[r]=[],_l[r].push({onLoad:l,onProgress:d,onError:v});const C=new Request(r,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),O=this.mimeType,z=this.responseType;fetch(C).then(H=>{if(H.status===200||H.status===0){if(H.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream=="undefined"||H.body.getReader===void 0)return H;const ne=_l[r],re=H.body.getReader(),se=H.headers.get("Content-Length"),oe=se?parseInt(se):0,ve=oe!==0;let Te=0;const Fe=new ReadableStream({start(Ae){ue();function ue(){re.read().then(({done:Ve,value:ke})=>{if(Ve)Ae.close();else{Te+=ke.byteLength;const je=new ProgressEvent("progress",{lengthComputable:ve,loaded:Te,total:oe});for(let st=0,At=ne.length;st<At;st++){const Et=ne[st];Et.onProgress&&Et.onProgress(je)}Ae.enqueue(ke),ue()}})}}});return new Response(Fe)}else throw Error(`fetch for "${H.url}" responded with ${H.status}: ${H.statusText}`)}).then(H=>{switch(z){case"arraybuffer":return H.arrayBuffer();case"blob":return H.blob();case"document":return H.text().then(ne=>new DOMParser().parseFromString(ne,O));case"json":return H.json();default:if(O===void 0)return H.text();{const re=/charset="?([^;"\s]*)"?/i.exec(O),se=re&&re[1]?re[1].toLowerCase():void 0,oe=new TextDecoder(se);return H.arrayBuffer().then(ve=>oe.decode(ve))}}}).then(H=>{Eu.add(r,H);const ne=_l[r];delete _l[r];for(let re=0,se=ne.length;re<se;re++){const oe=ne[re];oe.onLoad&&oe.onLoad(H)}}).catch(H=>{const ne=_l[r];if(ne===void 0)throw this.manager.itemError(r),H;delete _l[r];for(let re=0,se=ne.length;re<se;re++){const oe=ne[re];oe.onError&&oe.onError(H)}this.manager.itemError(r)}).finally(()=>{this.manager.itemEnd(r)}),this.manager.itemStart(r)}setResponseType(r){return this.responseType=r,this}setMimeType(r){return this.mimeType=r,this}}class mB extends Xs{constructor(r){super(r)}load(r,l,d,v){const w=this,C=new La(this.manager);C.setPath(this.path),C.setRequestHeader(this.requestHeader),C.setWithCredentials(this.withCredentials),C.load(r,function(O){try{l(w.parse(JSON.parse(O)))}catch(z){v?v(z):console.error(z),w.manager.itemError(r)}},d,v)}parse(r){const l=[];for(let d=0;d<r.length;d++){const v=Sp.parse(r[d]);l.push(v)}return l}}class gB extends Xs{constructor(r){super(r)}load(r,l,d,v){const w=this,C=[],O=new H1,z=new La(this.manager);z.setPath(this.path),z.setResponseType("arraybuffer"),z.setRequestHeader(this.requestHeader),z.setWithCredentials(w.withCredentials);let H=0;function ne(re){z.load(r[re],function(se){const oe=w.parse(se,!0);C[re]={width:oe.width,height:oe.height,format:oe.format,mipmaps:oe.mipmaps},H+=1,H===6&&(oe.mipmapCount===1&&(O.minFilter=ut),O.image=C,O.format=oe.format,O.needsUpdate=!0,l&&l(O))},d,v)}if(Array.isArray(r))for(let re=0,se=r.length;re<se;++re)ne(re);else z.load(r,function(re){const se=w.parse(re,!0);if(se.isCubemap){const oe=se.mipmaps.length/se.mipmapCount;for(let ve=0;ve<oe;ve++){C[ve]={mipmaps:[]};for(let Te=0;Te<se.mipmapCount;Te++)C[ve].mipmaps.push(se.mipmaps[ve*se.mipmapCount+Te]),C[ve].format=se.format,C[ve].width=se.width,C[ve].height=se.height}O.image=C}else O.image.width=se.width,O.image.height=se.height,O.mipmaps=se.mipmaps;se.mipmapCount===1&&(O.minFilter=ut),O.format=se.format,O.needsUpdate=!0,l&&l(O)},d,v);return O}}class Tp extends Xs{constructor(r){super(r)}load(r,l,d,v){this.path!==void 0&&(r=this.path+r),r=this.manager.resolveURL(r);const w=this,C=Eu.get(r);if(C!==void 0)return w.manager.itemStart(r),setTimeout(function(){l&&l(C),w.manager.itemEnd(r)},0),C;const O=ep("img");function z(){ne(),Eu.add(r,this),l&&l(this),w.manager.itemEnd(r)}function H(re){ne(),v&&v(re),w.manager.itemError(r),w.manager.itemEnd(r)}function ne(){O.removeEventListener("load",z,!1),O.removeEventListener("error",H,!1)}return O.addEventListener("load",z,!1),O.addEventListener("error",H,!1),r.substr(0,5)!=="data:"&&this.crossOrigin!==void 0&&(O.crossOrigin=this.crossOrigin),w.manager.itemStart(r),O.src=r,O}}class yM extends Xs{constructor(r){super(r)}load(r,l,d,v){const w=new Kh,C=new Tp(this.manager);C.setCrossOrigin(this.crossOrigin),C.setPath(this.path);let O=0;function z(H){C.load(r[H],function(ne){w.images[H]=ne,O++,O===6&&(w.needsUpdate=!0,l&&l(w))},void 0,v)}for(let H=0;H<r.length;++H)z(H);return w}}class xM extends Xs{constructor(r){super(r)}load(r,l,d,v){const w=this,C=new gu,O=new La(this.manager);return O.setResponseType("arraybuffer"),O.setRequestHeader(this.requestHeader),O.setPath(this.path),O.setWithCredentials(w.withCredentials),O.load(r,function(z){const H=w.parse(z);!H||(H.image!==void 0?C.image=H.image:H.data!==void 0&&(C.image.width=H.width,C.image.height=H.height,C.image.data=H.data),C.wrapS=H.wrapS!==void 0?H.wrapS:ye,C.wrapT=H.wrapT!==void 0?H.wrapT:ye,C.magFilter=H.magFilter!==void 0?H.magFilter:ut,C.minFilter=H.minFilter!==void 0?H.minFilter:ut,C.anisotropy=H.anisotropy!==void 0?H.anisotropy:1,H.encoding!==void 0&&(C.encoding=H.encoding),H.flipY!==void 0&&(C.flipY=H.flipY),H.format!==void 0&&(C.format=H.format),H.type!==void 0&&(C.type=H.type),H.mipmaps!==void 0&&(C.mipmaps=H.mipmaps,C.minFilter=gn),H.mipmapCount===1&&(C.minFilter=ut),H.generateMipmaps!==void 0&&(C.generateMipmaps=H.generateMipmaps),C.needsUpdate=!0,l&&l(C,H))},d,v),C}}class AM extends Xs{constructor(r){super(r)}load(r,l,d,v){const w=new Xr,C=new Tp(this.manager);return C.setCrossOrigin(this.crossOrigin),C.setPath(this.path),C.load(r,function(O){w.image=O,w.needsUpdate=!0,l!==void 0&&l(w)},d,v),w}}class Zo extends ki{constructor(r,l=1){super(),this.type="Light",this.color=new Un(r),this.intensity=l}dispose(){}copy(r){return super.copy(r),this.color.copy(r.color),this.intensity=r.intensity,this}toJSON(r){const l=super.toJSON(r);return l.object.color=this.color.getHex(),l.object.intensity=this.intensity,this.groundColor!==void 0&&(l.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(l.object.distance=this.distance),this.angle!==void 0&&(l.object.angle=this.angle),this.decay!==void 0&&(l.object.decay=this.decay),this.penumbra!==void 0&&(l.object.penumbra=this.penumbra),this.shadow!==void 0&&(l.object.shadow=this.shadow.toJSON()),l}}Zo.prototype.isLight=!0;class fx extends Zo{constructor(r,l,d){super(r,d),this.type="HemisphereLight",this.position.copy(ki.DefaultUp),this.updateMatrix(),this.groundColor=new Un(l)}copy(r){return Zo.prototype.copy.call(this,r),this.groundColor.copy(r.groundColor),this}}fx.prototype.isHemisphereLight=!0;const bM=new Jn,_M=new qe,wM=new qe;class dx{constructor(r){this.camera=r,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new pn(512,512),this.map=null,this.mapPass=null,this.matrix=new Jn,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new sp,this._frameExtents=new pn(1,1),this._viewportCount=1,this._viewports=[new nr(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(r){const l=this.camera,d=this.matrix;_M.setFromMatrixPosition(r.matrixWorld),l.position.copy(_M),wM.setFromMatrixPosition(r.target.matrixWorld),l.lookAt(wM),l.updateMatrixWorld(),bM.multiplyMatrices(l.projectionMatrix,l.matrixWorldInverse),this._frustum.setFromProjectionMatrix(bM),d.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),d.multiply(l.projectionMatrix),d.multiply(l.matrixWorldInverse)}getViewport(r){return this._viewports[r]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(r){return this.camera=r.camera.clone(),this.bias=r.bias,this.radius=r.radius,this.mapSize.copy(r.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const r={};return this.bias!==0&&(r.bias=this.bias),this.normalBias!==0&&(r.normalBias=this.normalBias),this.radius!==1&&(r.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(r.mapSize=this.mapSize.toArray()),r.camera=this.camera.toJSON(!1).object,delete r.camera.matrix,r}}class EM extends dx{constructor(){super(new qr(50,1,.5,500)),this.focus=1}updateMatrices(r){const l=this.camera,d=Zd*2*r.angle*this.focus,v=this.mapSize.width/this.mapSize.height,w=r.distance||l.far;(d!==l.fov||v!==l.aspect||w!==l.far)&&(l.fov=d,l.aspect=v,l.far=w,l.updateProjectionMatrix()),super.updateMatrices(r)}copy(r){return super.copy(r),this.focus=r.focus,this}}EM.prototype.isSpotLightShadow=!0;class px extends Zo{constructor(r,l,d=0,v=Math.PI/3,w=0,C=1){super(r,l),this.type="SpotLight",this.position.copy(ki.DefaultUp),this.updateMatrix(),this.target=new ki,this.distance=d,this.angle=v,this.penumbra=w,this.decay=C,this.shadow=new EM}get power(){return this.intensity*Math.PI}set power(r){this.intensity=r/Math.PI}dispose(){this.shadow.dispose()}copy(r){return super.copy(r),this.distance=r.distance,this.angle=r.angle,this.penumbra=r.penumbra,this.decay=r.decay,this.target=r.target.clone(),this.shadow=r.shadow.clone(),this}}px.prototype.isSpotLight=!0;const MM=new Jn,Cp=new qe,mx=new qe;class SM extends dx{constructor(){super(new qr(90,1,.5,500)),this._frameExtents=new pn(4,2),this._viewportCount=6,this._viewports=[new nr(2,1,1,1),new nr(0,1,1,1),new nr(3,1,1,1),new nr(1,1,1,1),new nr(3,0,1,1),new nr(1,0,1,1)],this._cubeDirections=[new qe(1,0,0),new qe(-1,0,0),new qe(0,0,1),new qe(0,0,-1),new qe(0,1,0),new qe(0,-1,0)],this._cubeUps=[new qe(0,1,0),new qe(0,1,0),new qe(0,1,0),new qe(0,1,0),new qe(0,0,1),new qe(0,0,-1)]}updateMatrices(r,l=0){const d=this.camera,v=this.matrix,w=r.distance||d.far;w!==d.far&&(d.far=w,d.updateProjectionMatrix()),Cp.setFromMatrixPosition(r.matrixWorld),d.position.copy(Cp),mx.copy(d.position),mx.add(this._cubeDirections[l]),d.up.copy(this._cubeUps[l]),d.lookAt(mx),d.updateMatrixWorld(),v.makeTranslation(-Cp.x,-Cp.y,-Cp.z),MM.multiplyMatrices(d.projectionMatrix,d.matrixWorldInverse),this._frustum.setFromProjectionMatrix(MM)}}SM.prototype.isPointLightShadow=!0;class gx extends Zo{constructor(r,l,d=0,v=1){super(r,l),this.type="PointLight",this.distance=d,this.decay=v,this.shadow=new SM}get power(){return this.intensity*4*Math.PI}set power(r){this.intensity=r/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(r){return super.copy(r),this.distance=r.distance,this.decay=r.decay,this.shadow=r.shadow.clone(),this}}gx.prototype.isPointLight=!0;class TM extends dx{constructor(){super(new op(-5,5,5,-5,.5,500))}}TM.prototype.isDirectionalLightShadow=!0;class vx extends Zo{constructor(r,l){super(r,l),this.type="DirectionalLight",this.position.copy(ki.DefaultUp),this.updateMatrix(),this.target=new ki,this.shadow=new TM}dispose(){this.shadow.dispose()}copy(r){return super.copy(r),this.target=r.target.clone(),this.shadow=r.shadow.clone(),this}}vx.prototype.isDirectionalLight=!0;class yx extends Zo{constructor(r,l){super(r,l),this.type="AmbientLight"}}yx.prototype.isAmbientLight=!0;class xx extends Zo{constructor(r,l,d=10,v=10){super(r,l),this.type="RectAreaLight",this.width=d,this.height=v}get power(){return this.intensity*this.width*this.height*Math.PI}set power(r){this.intensity=r/(this.width*this.height*Math.PI)}copy(r){return super.copy(r),this.width=r.width,this.height=r.height,this}toJSON(r){const l=super.toJSON(r);return l.object.width=this.width,l.object.height=this.height,l}}xx.prototype.isRectAreaLight=!0;class Ax{constructor(){this.coefficients=[];for(let r=0;r<9;r++)this.coefficients.push(new qe)}set(r){for(let l=0;l<9;l++)this.coefficients[l].copy(r[l]);return this}zero(){for(let r=0;r<9;r++)this.coefficients[r].set(0,0,0);return this}getAt(r,l){const d=r.x,v=r.y,w=r.z,C=this.coefficients;return l.copy(C[0]).multiplyScalar(.282095),l.addScaledVector(C[1],.488603*v),l.addScaledVector(C[2],.488603*w),l.addScaledVector(C[3],.488603*d),l.addScaledVector(C[4],1.092548*(d*v)),l.addScaledVector(C[5],1.092548*(v*w)),l.addScaledVector(C[6],.315392*(3*w*w-1)),l.addScaledVector(C[7],1.092548*(d*w)),l.addScaledVector(C[8],.546274*(d*d-v*v)),l}getIrradianceAt(r,l){const d=r.x,v=r.y,w=r.z,C=this.coefficients;return l.copy(C[0]).multiplyScalar(.886227),l.addScaledVector(C[1],2*.511664*v),l.addScaledVector(C[2],2*.511664*w),l.addScaledVector(C[3],2*.511664*d),l.addScaledVector(C[4],2*.429043*d*v),l.addScaledVector(C[5],2*.429043*v*w),l.addScaledVector(C[6],.743125*w*w-.247708),l.addScaledVector(C[7],2*.429043*d*w),l.addScaledVector(C[8],.429043*(d*d-v*v)),l}add(r){for(let l=0;l<9;l++)this.coefficients[l].add(r.coefficients[l]);return this}addScaledSH(r,l){for(let d=0;d<9;d++)this.coefficients[d].addScaledVector(r.coefficients[d],l);return this}scale(r){for(let l=0;l<9;l++)this.coefficients[l].multiplyScalar(r);return this}lerp(r,l){for(let d=0;d<9;d++)this.coefficients[d].lerp(r.coefficients[d],l);return this}equals(r){for(let l=0;l<9;l++)if(!this.coefficients[l].equals(r.coefficients[l]))return!1;return!0}copy(r){return this.set(r.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(r,l=0){const d=this.coefficients;for(let v=0;v<9;v++)d[v].fromArray(r,l+v*3);return this}toArray(r=[],l=0){const d=this.coefficients;for(let v=0;v<9;v++)d[v].toArray(r,l+v*3);return r}static getBasisAt(r,l){const d=r.x,v=r.y,w=r.z;l[0]=.282095,l[1]=.488603*v,l[2]=.488603*w,l[3]=.488603*d,l[4]=1.092548*d*v,l[5]=1.092548*v*w,l[6]=.315392*(3*w*w-1),l[7]=1.092548*d*w,l[8]=.546274*(d*d-v*v)}}Ax.prototype.isSphericalHarmonics3=!0;class Rp extends Zo{constructor(r=new Ax,l=1){super(void 0,l),this.sh=r}copy(r){return super.copy(r),this.sh.copy(r.sh),this}fromJSON(r){return this.intensity=r.intensity,this.sh.fromArray(r.sh),this}toJSON(r){const l=super.toJSON(r);return l.object.sh=this.sh.toArray(),l}}Rp.prototype.isLightProbe=!0;class CM extends Xs{constructor(r){super(r),this.textures={}}load(r,l,d,v){const w=this,C=new La(w.manager);C.setPath(w.path),C.setRequestHeader(w.requestHeader),C.setWithCredentials(w.withCredentials),C.load(r,function(O){try{l(w.parse(JSON.parse(O)))}catch(z){v?v(z):console.error(z),w.manager.itemError(r)}},d,v)}parse(r){const l=this.textures;function d(w){return l[w]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",w),l[w]}const v=new fB[r.type];if(r.uuid!==void 0&&(v.uuid=r.uuid),r.name!==void 0&&(v.name=r.name),r.color!==void 0&&v.color!==void 0&&v.color.setHex(r.color),r.roughness!==void 0&&(v.roughness=r.roughness),r.metalness!==void 0&&(v.metalness=r.metalness),r.sheen!==void 0&&(v.sheen=r.sheen),r.sheenColor!==void 0&&(v.sheenColor=new Un().setHex(r.sheenColor)),r.sheenRoughness!==void 0&&(v.sheenRoughness=r.sheenRoughness),r.emissive!==void 0&&v.emissive!==void 0&&v.emissive.setHex(r.emissive),r.specular!==void 0&&v.specular!==void 0&&v.specular.setHex(r.specular),r.specularIntensity!==void 0&&(v.specularIntensity=r.specularIntensity),r.specularColor!==void 0&&v.specularColor!==void 0&&v.specularColor.setHex(r.specularColor),r.shininess!==void 0&&(v.shininess=r.shininess),r.clearcoat!==void 0&&(v.clearcoat=r.clearcoat),r.clearcoatRoughness!==void 0&&(v.clearcoatRoughness=r.clearcoatRoughness),r.transmission!==void 0&&(v.transmission=r.transmission),r.thickness!==void 0&&(v.thickness=r.thickness),r.attenuationDistance!==void 0&&(v.attenuationDistance=r.attenuationDistance),r.attenuationColor!==void 0&&v.attenuationColor!==void 0&&v.attenuationColor.setHex(r.attenuationColor),r.fog!==void 0&&(v.fog=r.fog),r.flatShading!==void 0&&(v.flatShading=r.flatShading),r.blending!==void 0&&(v.blending=r.blending),r.combine!==void 0&&(v.combine=r.combine),r.side!==void 0&&(v.side=r.side),r.shadowSide!==void 0&&(v.shadowSide=r.shadowSide),r.opacity!==void 0&&(v.opacity=r.opacity),r.transparent!==void 0&&(v.transparent=r.transparent),r.alphaTest!==void 0&&(v.alphaTest=r.alphaTest),r.depthTest!==void 0&&(v.depthTest=r.depthTest),r.depthWrite!==void 0&&(v.depthWrite=r.depthWrite),r.colorWrite!==void 0&&(v.colorWrite=r.colorWrite),r.alphaWrite!==void 0&&(v.alphaWrite=r.alphaWrite),r.stencilWrite!==void 0&&(v.stencilWrite=r.stencilWrite),r.stencilWriteMask!==void 0&&(v.stencilWriteMask=r.stencilWriteMask),r.stencilFunc!==void 0&&(v.stencilFunc=r.stencilFunc),r.stencilRef!==void 0&&(v.stencilRef=r.stencilRef),r.stencilFuncMask!==void 0&&(v.stencilFuncMask=r.stencilFuncMask),r.stencilFail!==void 0&&(v.stencilFail=r.stencilFail),r.stencilZFail!==void 0&&(v.stencilZFail=r.stencilZFail),r.stencilZPass!==void 0&&(v.stencilZPass=r.stencilZPass),r.wireframe!==void 0&&(v.wireframe=r.wireframe),r.wireframeLinewidth!==void 0&&(v.wireframeLinewidth=r.wireframeLinewidth),r.wireframeLinecap!==void 0&&(v.wireframeLinecap=r.wireframeLinecap),r.wireframeLinejoin!==void 0&&(v.wireframeLinejoin=r.wireframeLinejoin),r.rotation!==void 0&&(v.rotation=r.rotation),r.linewidth!==1&&(v.linewidth=r.linewidth),r.dashSize!==void 0&&(v.dashSize=r.dashSize),r.gapSize!==void 0&&(v.gapSize=r.gapSize),r.scale!==void 0&&(v.scale=r.scale),r.polygonOffset!==void 0&&(v.polygonOffset=r.polygonOffset),r.polygonOffsetFactor!==void 0&&(v.polygonOffsetFactor=r.polygonOffsetFactor),r.polygonOffsetUnits!==void 0&&(v.polygonOffsetUnits=r.polygonOffsetUnits),r.dithering!==void 0&&(v.dithering=r.dithering),r.alphaToCoverage!==void 0&&(v.alphaToCoverage=r.alphaToCoverage),r.premultipliedAlpha!==void 0&&(v.premultipliedAlpha=r.premultipliedAlpha),r.visible!==void 0&&(v.visible=r.visible),r.toneMapped!==void 0&&(v.toneMapped=r.toneMapped),r.userData!==void 0&&(v.userData=r.userData),r.vertexColors!==void 0&&(typeof r.vertexColors=="number"?v.vertexColors=r.vertexColors>0:v.vertexColors=r.vertexColors),r.uniforms!==void 0)for(const w in r.uniforms){const C=r.uniforms[w];switch(v.uniforms[w]={},C.type){case"t":v.uniforms[w].value=d(C.value);break;case"c":v.uniforms[w].value=new Un().setHex(C.value);break;case"v2":v.uniforms[w].value=new pn().fromArray(C.value);break;case"v3":v.uniforms[w].value=new qe().fromArray(C.value);break;case"v4":v.uniforms[w].value=new nr().fromArray(C.value);break;case"m3":v.uniforms[w].value=new es().fromArray(C.value);break;case"m4":v.uniforms[w].value=new Jn().fromArray(C.value);break;default:v.uniforms[w].value=C.value}}if(r.defines!==void 0&&(v.defines=r.defines),r.vertexShader!==void 0&&(v.vertexShader=r.vertexShader),r.fragmentShader!==void 0&&(v.fragmentShader=r.fragmentShader),r.extensions!==void 0)for(const w in r.extensions)v.extensions[w]=r.extensions[w];if(r.shading!==void 0&&(v.flatShading=r.shading===1),r.size!==void 0&&(v.size=r.size),r.sizeAttenuation!==void 0&&(v.sizeAttenuation=r.sizeAttenuation),r.map!==void 0&&(v.map=d(r.map)),r.matcap!==void 0&&(v.matcap=d(r.matcap)),r.alphaMap!==void 0&&(v.alphaMap=d(r.alphaMap)),r.bumpMap!==void 0&&(v.bumpMap=d(r.bumpMap)),r.bumpScale!==void 0&&(v.bumpScale=r.bumpScale),r.normalMap!==void 0&&(v.normalMap=d(r.normalMap)),r.normalMapType!==void 0&&(v.normalMapType=r.normalMapType),r.normalScale!==void 0){let w=r.normalScale;Array.isArray(w)===!1&&(w=[w,w]),v.normalScale=new pn().fromArray(w)}return r.displacementMap!==void 0&&(v.displacementMap=d(r.displacementMap)),r.displacementScale!==void 0&&(v.displacementScale=r.displacementScale),r.displacementBias!==void 0&&(v.displacementBias=r.displacementBias),r.roughnessMap!==void 0&&(v.roughnessMap=d(r.roughnessMap)),r.metalnessMap!==void 0&&(v.metalnessMap=d(r.metalnessMap)),r.emissiveMap!==void 0&&(v.emissiveMap=d(r.emissiveMap)),r.emissiveIntensity!==void 0&&(v.emissiveIntensity=r.emissiveIntensity),r.specularMap!==void 0&&(v.specularMap=d(r.specularMap)),r.specularIntensityMap!==void 0&&(v.specularIntensityMap=d(r.specularIntensityMap)),r.specularColorMap!==void 0&&(v.specularColorMap=d(r.specularColorMap)),r.envMap!==void 0&&(v.envMap=d(r.envMap)),r.envMapIntensity!==void 0&&(v.envMapIntensity=r.envMapIntensity),r.reflectivity!==void 0&&(v.reflectivity=r.reflectivity),r.refractionRatio!==void 0&&(v.refractionRatio=r.refractionRatio),r.lightMap!==void 0&&(v.lightMap=d(r.lightMap)),r.lightMapIntensity!==void 0&&(v.lightMapIntensity=r.lightMapIntensity),r.aoMap!==void 0&&(v.aoMap=d(r.aoMap)),r.aoMapIntensity!==void 0&&(v.aoMapIntensity=r.aoMapIntensity),r.gradientMap!==void 0&&(v.gradientMap=d(r.gradientMap)),r.clearcoatMap!==void 0&&(v.clearcoatMap=d(r.clearcoatMap)),r.clearcoatRoughnessMap!==void 0&&(v.clearcoatRoughnessMap=d(r.clearcoatRoughnessMap)),r.clearcoatNormalMap!==void 0&&(v.clearcoatNormalMap=d(r.clearcoatNormalMap)),r.clearcoatNormalScale!==void 0&&(v.clearcoatNormalScale=new pn().fromArray(r.clearcoatNormalScale)),r.transmissionMap!==void 0&&(v.transmissionMap=d(r.transmissionMap)),r.thicknessMap!==void 0&&(v.thicknessMap=d(r.thicknessMap)),r.sheenColorMap!==void 0&&(v.sheenColorMap=d(r.sheenColorMap)),r.sheenRoughnessMap!==void 0&&(v.sheenRoughnessMap=d(r.sheenRoughnessMap)),v}setTextures(r){return this.textures=r,this}}class J0{static decodeText(r){if(typeof TextDecoder!="undefined")return new TextDecoder().decode(r);let l="";for(let d=0,v=r.length;d<v;d++)l+=String.fromCharCode(r[d]);try{return decodeURIComponent(escape(l))}catch{return l}}static extractUrlBase(r){const l=r.lastIndexOf("/");return l===-1?"./":r.substr(0,l+1)}static resolveURL(r,l){return typeof r!="string"||r===""?"":(/^https?:\/\//i.test(l)&&/^\//.test(r)&&(l=l.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(r)||/^data:.*,.*$/i.test(r)||/^blob:.*$/i.test(r)?r:l+r)}}class bx extends ui{constructor(){super(),this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(r){return super.copy(r),this.instanceCount=r.instanceCount,this}clone(){return new this.constructor().copy(this)}toJSON(){const r=super.toJSON(this);return r.instanceCount=this.instanceCount,r.isInstancedBufferGeometry=!0,r}}bx.prototype.isInstancedBufferGeometry=!0;class RM extends Xs{constructor(r){super(r)}load(r,l,d,v){const w=this,C=new La(w.manager);C.setPath(w.path),C.setRequestHeader(w.requestHeader),C.setWithCredentials(w.withCredentials),C.load(r,function(O){try{l(w.parse(JSON.parse(O)))}catch(z){v?v(z):console.error(z),w.manager.itemError(r)}},d,v)}parse(r){const l={},d={};function v(oe,ve){if(l[ve]!==void 0)return l[ve];const Fe=oe.interleavedBuffers[ve],Ae=w(oe,Fe.buffer),ue=Fh(Fe.type,Ae),Ve=new mu(ue,Fe.stride);return Ve.uuid=Fe.uuid,l[ve]=Ve,Ve}function w(oe,ve){if(d[ve]!==void 0)return d[ve];const Fe=oe.arrayBuffers[ve],Ae=new Uint32Array(Fe).buffer;return d[ve]=Ae,Ae}const C=r.isInstancedBufferGeometry?new bx:new ui,O=r.data.index;if(O!==void 0){const oe=Fh(O.type,O.array);C.setIndex(new Wi(oe,1))}const z=r.data.attributes;for(const oe in z){const ve=z[oe];let Te;if(ve.isInterleavedBufferAttribute){const Fe=v(r.data,ve.data);Te=new ac(Fe,ve.itemSize,ve.offset,ve.normalized)}else{const Fe=Fh(ve.type,ve.array),Ae=ve.isInstancedBufferAttribute?vu:Wi;Te=new Ae(Fe,ve.itemSize,ve.normalized)}ve.name!==void 0&&(Te.name=ve.name),ve.usage!==void 0&&Te.setUsage(ve.usage),ve.updateRange!==void 0&&(Te.updateRange.offset=ve.updateRange.offset,Te.updateRange.count=ve.updateRange.count),C.setAttribute(oe,Te)}const H=r.data.morphAttributes;if(H)for(const oe in H){const ve=H[oe],Te=[];for(let Fe=0,Ae=ve.length;Fe<Ae;Fe++){const ue=ve[Fe];let Ve;if(ue.isInterleavedBufferAttribute){const ke=v(r.data,ue.data);Ve=new ac(ke,ue.itemSize,ue.offset,ue.normalized)}else{const ke=Fh(ue.type,ue.array);Ve=new Wi(ke,ue.itemSize,ue.normalized)}ue.name!==void 0&&(Ve.name=ue.name),Te.push(Ve)}C.morphAttributes[oe]=Te}r.data.morphTargetsRelative&&(C.morphTargetsRelative=!0);const re=r.data.groups||r.data.drawcalls||r.data.offsets;if(re!==void 0)for(let oe=0,ve=re.length;oe!==ve;++oe){const Te=re[oe];C.addGroup(Te.start,Te.count,Te.materialIndex)}const se=r.data.boundingSphere;if(se!==void 0){const oe=new qe;se.center!==void 0&&oe.fromArray(se.center),C.boundingSphere=new Kl(oe,se.radius)}return r.name&&(C.name=r.name),r.userData&&(C.userData=r.userData),C}}class vB extends Xs{constructor(r){super(r)}load(r,l,d,v){const w=this,C=this.path===""?J0.extractUrlBase(r):this.path;this.resourcePath=this.resourcePath||C;const O=new La(this.manager);O.setPath(this.path),O.setRequestHeader(this.requestHeader),O.setWithCredentials(this.withCredentials),O.load(r,function(z){let H=null;try{H=JSON.parse(z)}catch(re){v!==void 0&&v(re),console.error("THREE:ObjectLoader: Can't parse "+r+".",re.message);return}const ne=H.metadata;if(ne===void 0||ne.type===void 0||ne.type.toLowerCase()==="geometry"){console.error("THREE.ObjectLoader: Can't load "+r);return}w.parse(H,l)},d,v)}async loadAsync(r,l){const d=this,v=this.path===""?J0.extractUrlBase(r):this.path;this.resourcePath=this.resourcePath||v;const w=new La(this.manager);w.setPath(this.path),w.setRequestHeader(this.requestHeader),w.setWithCredentials(this.withCredentials);const C=await w.loadAsync(r,l),O=JSON.parse(C),z=O.metadata;if(z===void 0||z.type===void 0||z.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+r);return await d.parseAsync(O)}parse(r,l){const d=this.parseAnimations(r.animations),v=this.parseShapes(r.shapes),w=this.parseGeometries(r.geometries,v),C=this.parseImages(r.images,function(){l!==void 0&&l(H)}),O=this.parseTextures(r.textures,C),z=this.parseMaterials(r.materials,O),H=this.parseObject(r.object,w,z,O,d),ne=this.parseSkeletons(r.skeletons,H);if(this.bindSkeletons(H,ne),l!==void 0){let re=!1;for(const se in C)if(C[se]instanceof HTMLImageElement){re=!0;break}re===!1&&l(H)}return H}async parseAsync(r){const l=this.parseAnimations(r.animations),d=this.parseShapes(r.shapes),v=this.parseGeometries(r.geometries,d),w=await this.parseImagesAsync(r.images),C=this.parseTextures(r.textures,w),O=this.parseMaterials(r.materials,C),z=this.parseObject(r.object,v,O,C,l),H=this.parseSkeletons(r.skeletons,z);return this.bindSkeletons(z,H),z}parseShapes(r){const l={};if(r!==void 0)for(let d=0,v=r.length;d<v;d++){const w=new Ta().fromJSON(r[d]);l[w.uuid]=w}return l}parseSkeletons(r,l){const d={},v={};if(l.traverse(function(w){w.isBone&&(v[w.uuid]=w)}),r!==void 0)for(let w=0,C=r.length;w<C;w++){const O=new F0().fromJSON(r[w],v);d[O.uuid]=O}return d}parseGeometries(r,l){const d={};if(r!==void 0){const w=new RM;for(let C=0,O=r.length;C<O;C++){let z;const H=r[C];switch(H.type){case"BufferGeometry":case"InstancedBufferGeometry":z=w.parse(H);break;case"Geometry":if("THREE"in window&&"LegacyJSONLoader"in THREE){var v=new THREE.LegacyJSONLoader;z=v.parse(H,this.resourcePath).geometry}else console.error('THREE.ObjectLoader: You have to import LegacyJSONLoader in order load geometry data of type "Geometry".');break;default:H.type in dM?z=dM[H.type].fromJSON(H,l):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${H.type}"`)}z.uuid=H.uuid,H.name!==void 0&&(z.name=H.name),z.isBufferGeometry===!0&&H.userData!==void 0&&(z.userData=H.userData),d[H.uuid]=z}}return d}parseMaterials(r,l){const d={},v={};if(r!==void 0){const w=new CM;w.setTextures(l);for(let C=0,O=r.length;C<O;C++){const z=r[C];if(z.type==="MultiMaterial"){const H=[];for(let ne=0;ne<z.materials.length;ne++){const re=z.materials[ne];d[re.uuid]===void 0&&(d[re.uuid]=w.parse(re)),H.push(d[re.uuid])}v[z.uuid]=H}else d[z.uuid]===void 0&&(d[z.uuid]=w.parse(z)),v[z.uuid]=d[z.uuid]}}return v}parseAnimations(r){const l={};if(r!==void 0)for(let d=0;d<r.length;d++){const v=r[d],w=Sp.parse(v);l[w.uuid]=w}return l}parseImages(r,l){const d=this,v={};let w;function C(z){return d.manager.itemStart(z),w.load(z,function(){d.manager.itemEnd(z)},void 0,function(){d.manager.itemError(z),d.manager.itemEnd(z)})}function O(z){if(typeof z=="string"){const H=z,ne=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(H)?H:d.resourcePath+H;return C(ne)}else return z.data?{data:Fh(z.type,z.data),width:z.width,height:z.height}:null}if(r!==void 0&&r.length>0){const z=new hx(l);w=new Tp(z),w.setCrossOrigin(this.crossOrigin);for(let H=0,ne=r.length;H<ne;H++){const re=r[H],se=re.url;if(Array.isArray(se)){v[re.uuid]=[];for(let oe=0,ve=se.length;oe<ve;oe++){const Te=se[oe],Fe=O(Te);Fe!==null&&(Fe instanceof HTMLImageElement?v[re.uuid].push(Fe):v[re.uuid].push(new gu(Fe.data,Fe.width,Fe.height)))}}else{const oe=O(re.url);oe!==null&&(v[re.uuid]=oe)}}}return v}async parseImagesAsync(r){const l=this,d={};let v;async function w(C){if(typeof C=="string"){const O=C,z=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(O)?O:l.resourcePath+O;return await v.loadAsync(z)}else return C.data?{data:Fh(C.type,C.data),width:C.width,height:C.height}:null}if(r!==void 0&&r.length>0){v=new Tp(this.manager),v.setCrossOrigin(this.crossOrigin);for(let C=0,O=r.length;C<O;C++){const z=r[C],H=z.url;if(Array.isArray(H)){d[z.uuid]=[];for(let ne=0,re=H.length;ne<re;ne++){const se=H[ne],oe=await w(se);oe!==null&&(oe instanceof HTMLImageElement?d[z.uuid].push(oe):d[z.uuid].push(new gu(oe.data,oe.width,oe.height)))}}else{const ne=await w(z.url);ne!==null&&(d[z.uuid]=ne)}}}return d}parseTextures(r,l){function d(w,C){return typeof w=="number"?w:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",w),C[w])}const v={};if(r!==void 0)for(let w=0,C=r.length;w<C;w++){const O=r[w];O.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',O.uuid),l[O.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",O.image);let z;const H=l[O.image];Array.isArray(H)?(z=new Kh(H),H.length===6&&(z.needsUpdate=!0)):(H&&H.data?z=new gu(H.data,H.width,H.height):z=new Xr(H),H&&(z.needsUpdate=!0)),z.uuid=O.uuid,O.name!==void 0&&(z.name=O.name),O.mapping!==void 0&&(z.mapping=d(O.mapping,yB)),O.offset!==void 0&&z.offset.fromArray(O.offset),O.repeat!==void 0&&z.repeat.fromArray(O.repeat),O.center!==void 0&&z.center.fromArray(O.center),O.rotation!==void 0&&(z.rotation=O.rotation),O.wrap!==void 0&&(z.wrapS=d(O.wrap[0],LM),z.wrapT=d(O.wrap[1],LM)),O.format!==void 0&&(z.format=O.format),O.type!==void 0&&(z.type=O.type),O.encoding!==void 0&&(z.encoding=O.encoding),O.minFilter!==void 0&&(z.minFilter=d(O.minFilter,PM)),O.magFilter!==void 0&&(z.magFilter=d(O.magFilter,PM)),O.anisotropy!==void 0&&(z.anisotropy=O.anisotropy),O.flipY!==void 0&&(z.flipY=O.flipY),O.premultiplyAlpha!==void 0&&(z.premultiplyAlpha=O.premultiplyAlpha),O.unpackAlignment!==void 0&&(z.unpackAlignment=O.unpackAlignment),O.userData!==void 0&&(z.userData=O.userData),v[O.uuid]=z}return v}parseObject(r,l,d,v,w){let C;function O(se){return l[se]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",se),l[se]}function z(se){if(se!==void 0){if(Array.isArray(se)){const oe=[];for(let ve=0,Te=se.length;ve<Te;ve++){const Fe=se[ve];d[Fe]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",Fe),oe.push(d[Fe])}return oe}return d[se]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",se),d[se]}}function H(se){return v[se]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",se),v[se]}let ne,re;switch(r.type){case"Scene":C=new T0,r.background!==void 0&&(Number.isInteger(r.background)?C.background=new Un(r.background):C.background=H(r.background)),r.environment!==void 0&&(C.environment=H(r.environment)),r.fog!==void 0&&(r.fog.type==="Fog"?C.fog=new up(r.fog.color,r.fog.near,r.fog.far):r.fog.type==="FogExp2"&&(C.fog=new cp(r.fog.color,r.fog.density)));break;case"PerspectiveCamera":C=new qr(r.fov,r.aspect,r.near,r.far),r.focus!==void 0&&(C.focus=r.focus),r.zoom!==void 0&&(C.zoom=r.zoom),r.filmGauge!==void 0&&(C.filmGauge=r.filmGauge),r.filmOffset!==void 0&&(C.filmOffset=r.filmOffset),r.view!==void 0&&(C.view=Object.assign({},r.view));break;case"OrthographicCamera":C=new op(r.left,r.right,r.top,r.bottom,r.near,r.far),r.zoom!==void 0&&(C.zoom=r.zoom),r.view!==void 0&&(C.view=Object.assign({},r.view));break;case"AmbientLight":C=new yx(r.color,r.intensity);break;case"DirectionalLight":C=new vx(r.color,r.intensity);break;case"PointLight":C=new gx(r.color,r.intensity,r.distance,r.decay);break;case"RectAreaLight":C=new xx(r.color,r.intensity,r.width,r.height);break;case"SpotLight":C=new px(r.color,r.intensity,r.distance,r.angle,r.penumbra,r.decay);break;case"HemisphereLight":C=new fx(r.color,r.groundColor,r.intensity);break;case"LightProbe":C=new Rp().fromJSON(r);break;case"SkinnedMesh":ne=O(r.geometry),re=z(r.material),C=new D0(ne,re),r.bindMode!==void 0&&(C.bindMode=r.bindMode),r.bindMatrix!==void 0&&C.bindMatrix.fromArray(r.bindMatrix),r.skeleton!==void 0&&(C.skeleton=r.skeleton);break;case"Mesh":ne=O(r.geometry),re=z(r.material),C=new $r(ne,re);break;case"InstancedMesh":ne=O(r.geometry),re=z(r.material);const se=r.count,oe=r.instanceMatrix,ve=r.instanceColor;C=new N1(ne,re,se),C.instanceMatrix=new vu(new Float32Array(oe.array),16),ve!==void 0&&(C.instanceColor=new vu(new Float32Array(ve.array),ve.itemSize));break;case"LOD":C=new kE;break;case"Line":C=new Al(O(r.geometry),z(r.material));break;case"LineLoop":C=new k1(O(r.geometry),z(r.material));break;case"LineSegments":C=new ro(O(r.geometry),z(r.material));break;case"PointCloud":case"Points":C=new mp(O(r.geometry),z(r.material));break;case"Sprite":C=new P0(z(r.material));break;case"Group":C=new oc;break;case"Bone":C=new B0;break;default:C=new ki}if(C.uuid=r.uuid,r.name!==void 0&&(C.name=r.name),r.matrix!==void 0?(C.matrix.fromArray(r.matrix),r.matrixAutoUpdate!==void 0&&(C.matrixAutoUpdate=r.matrixAutoUpdate),C.matrixAutoUpdate&&C.matrix.decompose(C.position,C.quaternion,C.scale)):(r.position!==void 0&&C.position.fromArray(r.position),r.rotation!==void 0&&C.rotation.fromArray(r.rotation),r.quaternion!==void 0&&C.quaternion.fromArray(r.quaternion),r.scale!==void 0&&C.scale.fromArray(r.scale)),r.castShadow!==void 0&&(C.castShadow=r.castShadow),r.receiveShadow!==void 0&&(C.receiveShadow=r.receiveShadow),r.shadow&&(r.shadow.bias!==void 0&&(C.shadow.bias=r.shadow.bias),r.shadow.normalBias!==void 0&&(C.shadow.normalBias=r.shadow.normalBias),r.shadow.radius!==void 0&&(C.shadow.radius=r.shadow.radius),r.shadow.mapSize!==void 0&&C.shadow.mapSize.fromArray(r.shadow.mapSize),r.shadow.camera!==void 0&&(C.shadow.camera=this.parseObject(r.shadow.camera))),r.visible!==void 0&&(C.visible=r.visible),r.frustumCulled!==void 0&&(C.frustumCulled=r.frustumCulled),r.renderOrder!==void 0&&(C.renderOrder=r.renderOrder),r.userData!==void 0&&(C.userData=r.userData),r.layers!==void 0&&(C.layers.mask=r.layers),r.children!==void 0){const se=r.children;for(let oe=0;oe<se.length;oe++)C.add(this.parseObject(se[oe],l,d,v,w))}if(r.animations!==void 0){const se=r.animations;for(let oe=0;oe<se.length;oe++){const ve=se[oe];C.animations.push(w[ve])}}if(r.type==="LOD"){r.autoUpdate!==void 0&&(C.autoUpdate=r.autoUpdate);const se=r.levels;for(let oe=0;oe<se.length;oe++){const ve=se[oe],Te=C.getObjectByProperty("uuid",ve.object);Te!==void 0&&C.addLevel(Te,ve.distance)}}return C}bindSkeletons(r,l){Object.keys(l).length!==0&&r.traverse(function(d){if(d.isSkinnedMesh===!0&&d.skeleton!==void 0){const v=l[d.skeleton];v===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",d.skeleton):d.bind(v,d.bindMatrix)}})}setTexturePath(r){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(r)}}const yB={UVMapping:V,CubeReflectionMapping:Z,CubeRefractionMapping:B,EquirectangularReflectionMapping:S,EquirectangularRefractionMapping:R,CubeUVReflectionMapping:X,CubeUVRefractionMapping:xe},LM={RepeatWrapping:Ie,ClampToEdgeWrapping:ye,MirroredRepeatWrapping:nt},PM={NearestFilter:at,NearestMipmapNearestFilter:mt,NearestMipmapLinearFilter:Lt,LinearFilter:ut,LinearMipmapNearestFilter:St,LinearMipmapLinearFilter:gn};class IM extends Xs{constructor(r){super(r),typeof createImageBitmap=="undefined"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch=="undefined"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(r){return this.options=r,this}load(r,l,d,v){r===void 0&&(r=""),this.path!==void 0&&(r=this.path+r),r=this.manager.resolveURL(r);const w=this,C=Eu.get(r);if(C!==void 0)return w.manager.itemStart(r),setTimeout(function(){l&&l(C),w.manager.itemEnd(r)},0),C;const O={};O.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",O.headers=this.requestHeader,fetch(r,O).then(function(z){return z.blob()}).then(function(z){return createImageBitmap(z,Object.assign(w.options,{colorSpaceConversion:"none"}))}).then(function(z){Eu.add(r,z),l&&l(z),w.manager.itemEnd(r)}).catch(function(z){v&&v(z),w.manager.itemError(r),w.manager.itemEnd(r)}),w.manager.itemStart(r)}}IM.prototype.isImageBitmapLoader=!0;let eg;const _x={getContext:function(){return eg===void 0&&(eg=new(window.AudioContext||window.webkitAudioContext)),eg},setContext:function(A){eg=A}};class OM extends Xs{constructor(r){super(r)}load(r,l,d,v){const w=this,C=new La(this.manager);C.setResponseType("arraybuffer"),C.setPath(this.path),C.setRequestHeader(this.requestHeader),C.setWithCredentials(this.withCredentials),C.load(r,function(O){try{const z=O.slice(0);_x.getContext().decodeAudioData(z,function(ne){l(ne)})}catch(z){v?v(z):console.error(z),w.manager.itemError(r)}},d,v)}}class DM extends Rp{constructor(r,l,d=1){super(void 0,d);const v=new Un().set(r),w=new Un().set(l),C=new qe(v.r,v.g,v.b),O=new qe(w.r,w.g,w.b),z=Math.sqrt(Math.PI),H=z*Math.sqrt(.75);this.sh.coefficients[0].copy(C).add(O).multiplyScalar(z),this.sh.coefficients[1].copy(C).sub(O).multiplyScalar(H)}}DM.prototype.isHemisphereLightProbe=!0;class BM extends Rp{constructor(r,l=1){super(void 0,l);const d=new Un().set(r);this.sh.coefficients[0].set(d.r,d.g,d.b).multiplyScalar(2*Math.sqrt(Math.PI))}}BM.prototype.isAmbientLightProbe=!0;const FM=new Jn,NM=new Jn,Mu=new Jn;class xB{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new qr,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new qr,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(r){const l=this._cache;if(l.focus!==r.focus||l.fov!==r.fov||l.aspect!==r.aspect*this.aspect||l.near!==r.near||l.far!==r.far||l.zoom!==r.zoom||l.eyeSep!==this.eyeSep){l.focus=r.focus,l.fov=r.fov,l.aspect=r.aspect*this.aspect,l.near=r.near,l.far=r.far,l.zoom=r.zoom,l.eyeSep=this.eyeSep,Mu.copy(r.projectionMatrix);const v=l.eyeSep/2,w=v*l.near/l.focus,C=l.near*Math.tan(lu*l.fov*.5)/l.zoom;let O,z;NM.elements[12]=-v,FM.elements[12]=v,O=-C*l.aspect+w,z=C*l.aspect+w,Mu.elements[0]=2*l.near/(z-O),Mu.elements[8]=(z+O)/(z-O),this.cameraL.projectionMatrix.copy(Mu),O=-C*l.aspect-w,z=C*l.aspect-w,Mu.elements[0]=2*l.near/(z-O),Mu.elements[8]=(z+O)/(z-O),this.cameraR.projectionMatrix.copy(Mu)}this.cameraL.matrixWorld.copy(r.matrixWorld).multiply(NM),this.cameraR.matrixWorld.copy(r.matrixWorld).multiply(FM)}}class UM{constructor(r=!0){this.autoStart=r,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=kM(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let r=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const l=kM();r=(l-this.oldTime)/1e3,this.oldTime=l,this.elapsedTime+=r}return r}}function kM(){return(typeof performance=="undefined"?Date:performance).now()}const Su=new qe,zM=new os,AB=new qe,Tu=new qe;class bB extends ki{constructor(){super(),this.type="AudioListener",this.context=_x.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new UM}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(r){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=r,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(r){return this.gain.gain.setTargetAtTime(r,this.context.currentTime,.01),this}updateMatrixWorld(r){super.updateMatrixWorld(r);const l=this.context.listener,d=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Su,zM,AB),Tu.set(0,0,-1).applyQuaternion(zM),l.positionX){const v=this.context.currentTime+this.timeDelta;l.positionX.linearRampToValueAtTime(Su.x,v),l.positionY.linearRampToValueAtTime(Su.y,v),l.positionZ.linearRampToValueAtTime(Su.z,v),l.forwardX.linearRampToValueAtTime(Tu.x,v),l.forwardY.linearRampToValueAtTime(Tu.y,v),l.forwardZ.linearRampToValueAtTime(Tu.z,v),l.upX.linearRampToValueAtTime(d.x,v),l.upY.linearRampToValueAtTime(d.y,v),l.upZ.linearRampToValueAtTime(d.z,v)}else l.setPosition(Su.x,Su.y,Su.z),l.setOrientation(Tu.x,Tu.y,Tu.z,d.x,d.y,d.z)}}class wx extends ki{constructor(r){super(),this.type="Audio",this.listener=r,this.context=r.context,this.gain=this.context.createGain(),this.gain.connect(r.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(r){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=r,this.connect(),this}setMediaElementSource(r){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(r),this.connect(),this}setMediaStreamSource(r){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(r),this.connect(),this}setBuffer(r){return this.buffer=r,this.sourceType="buffer",this.autoplay&&this.play(),this}play(r=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+r;const l=this.context.createBufferSource();return l.buffer=this.buffer,l.loop=this.loop,l.loopStart=this.loopStart,l.loopEnd=this.loopEnd,l.onended=this.onEnded.bind(this),l.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=l,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let r=1,l=this.filters.length;r<l;r++)this.filters[r-1].connect(this.filters[r]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let r=1,l=this.filters.length;r<l;r++)this.filters[r-1].disconnect(this.filters[r]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(r){return r||(r=[]),this._connected===!0?(this.disconnect(),this.filters=r.slice(),this.connect()):this.filters=r.slice(),this}setDetune(r){if(this.detune=r,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(r){return this.setFilters(r?[r]:[])}setPlaybackRate(r){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=r,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(r){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=r,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(r){return this.loopStart=r,this}setLoopEnd(r){return this.loopEnd=r,this}getVolume(){return this.gain.gain.value}setVolume(r){return this.gain.gain.setTargetAtTime(r,this.context.currentTime,.01),this}}const Cu=new qe,HM=new os,_B=new qe,Ru=new qe;class wB extends wx{constructor(r){super(r),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(r){return this.panner.refDistance=r,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(r){return this.panner.rolloffFactor=r,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(r){return this.panner.distanceModel=r,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(r){return this.panner.maxDistance=r,this}setDirectionalCone(r,l,d){return this.panner.coneInnerAngle=r,this.panner.coneOuterAngle=l,this.panner.coneOuterGain=d,this}updateMatrixWorld(r){if(super.updateMatrixWorld(r),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(Cu,HM,_B),Ru.set(0,0,1).applyQuaternion(HM);const l=this.panner;if(l.positionX){const d=this.context.currentTime+this.listener.timeDelta;l.positionX.linearRampToValueAtTime(Cu.x,d),l.positionY.linearRampToValueAtTime(Cu.y,d),l.positionZ.linearRampToValueAtTime(Cu.z,d),l.orientationX.linearRampToValueAtTime(Ru.x,d),l.orientationY.linearRampToValueAtTime(Ru.y,d),l.orientationZ.linearRampToValueAtTime(Ru.z,d)}else l.setPosition(Cu.x,Cu.y,Cu.z),l.setOrientation(Ru.x,Ru.y,Ru.z)}}class GM{constructor(r,l=2048){this.analyser=r.context.createAnalyser(),this.analyser.fftSize=l,this.data=new Uint8Array(this.analyser.frequencyBinCount),r.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let r=0;const l=this.getFrequencyData();for(let d=0;d<l.length;d++)r+=l[d];return r/l.length}}class VM{constructor(r,l,d){this.binding=r,this.valueSize=d;let v,w,C;switch(l){case"quaternion":v=this._slerp,w=this._slerpAdditive,C=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(d*6),this._workIndex=5;break;case"string":case"bool":v=this._select,w=this._select,C=this._setAdditiveIdentityOther,this.buffer=new Array(d*5);break;default:v=this._lerp,w=this._lerpAdditive,C=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(d*5)}this._mixBufferRegion=v,this._mixBufferRegionAdditive=w,this._setIdentity=C,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(r,l){const d=this.buffer,v=this.valueSize,w=r*v+v;let C=this.cumulativeWeight;if(C===0){for(let O=0;O!==v;++O)d[w+O]=d[O];C=l}else{C+=l;const O=l/C;this._mixBufferRegion(d,w,0,O,v)}this.cumulativeWeight=C}accumulateAdditive(r){const l=this.buffer,d=this.valueSize,v=d*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(l,v,0,r,d),this.cumulativeWeightAdditive+=r}apply(r){const l=this.valueSize,d=this.buffer,v=r*l+l,w=this.cumulativeWeight,C=this.cumulativeWeightAdditive,O=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,w<1){const z=l*this._origIndex;this._mixBufferRegion(d,v,z,1-w,l)}C>0&&this._mixBufferRegionAdditive(d,v,this._addIndex*l,1,l);for(let z=l,H=l+l;z!==H;++z)if(d[z]!==d[z+l]){O.setValue(d,v);break}}saveOriginalState(){const r=this.binding,l=this.buffer,d=this.valueSize,v=d*this._origIndex;r.getValue(l,v);for(let w=d,C=v;w!==C;++w)l[w]=l[v+w%d];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const r=this.valueSize*3;this.binding.setValue(this.buffer,r)}_setAdditiveIdentityNumeric(){const r=this._addIndex*this.valueSize,l=r+this.valueSize;for(let d=r;d<l;d++)this.buffer[d]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const r=this._origIndex*this.valueSize,l=this._addIndex*this.valueSize;for(let d=0;d<this.valueSize;d++)this.buffer[l+d]=this.buffer[r+d]}_select(r,l,d,v,w){if(v>=.5)for(let C=0;C!==w;++C)r[l+C]=r[d+C]}_slerp(r,l,d,v){os.slerpFlat(r,l,r,l,r,d,v)}_slerpAdditive(r,l,d,v,w){const C=this._workIndex*w;os.multiplyQuaternionsFlat(r,C,r,l,r,d),os.slerpFlat(r,l,r,l,r,C,v)}_lerp(r,l,d,v,w){const C=1-v;for(let O=0;O!==w;++O){const z=l+O;r[z]=r[z]*C+r[d+O]*v}}_lerpAdditive(r,l,d,v,w){for(let C=0;C!==w;++C){const O=l+C;r[O]=r[O]+r[d+C]*v}}}const Ex="\\[\\]\\.:\\/",EB=new RegExp("["+Ex+"]","g"),Mx="[^"+Ex+"]",MB="[^"+Ex.replace("\\.","")+"]",SB=/((?:WC+[\/:])*)/.source.replace("WC",Mx),TB=/(WCOD+)?/.source.replace("WCOD",MB),CB=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",Mx),RB=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",Mx),LB=new RegExp("^"+SB+TB+CB+RB+"$"),PB=["material","materials","bones"];class IB{constructor(r,l,d){const v=d||Xi.parseTrackName(l);this._targetGroup=r,this._bindings=r.subscribe_(l,v)}getValue(r,l){this.bind();const d=this._targetGroup.nCachedObjects_,v=this._bindings[d];v!==void 0&&v.getValue(r,l)}setValue(r,l){const d=this._bindings;for(let v=this._targetGroup.nCachedObjects_,w=d.length;v!==w;++v)d[v].setValue(r,l)}bind(){const r=this._bindings;for(let l=this._targetGroup.nCachedObjects_,d=r.length;l!==d;++l)r[l].bind()}unbind(){const r=this._bindings;for(let l=this._targetGroup.nCachedObjects_,d=r.length;l!==d;++l)r[l].unbind()}}class Xi{constructor(r,l,d){this.path=l,this.parsedPath=d||Xi.parseTrackName(l),this.node=Xi.findNode(r,this.parsedPath.nodeName)||r,this.rootNode=r,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(r,l,d){return r&&r.isAnimationObjectGroup?new Xi.Composite(r,l,d):new Xi(r,l,d)}static sanitizeNodeName(r){return r.replace(/\s/g,"_").replace(EB,"")}static parseTrackName(r){const l=LB.exec(r);if(!l)throw new Error("PropertyBinding: Cannot parse trackName: "+r);const d={nodeName:l[2],objectName:l[3],objectIndex:l[4],propertyName:l[5],propertyIndex:l[6]},v=d.nodeName&&d.nodeName.lastIndexOf(".");if(v!==void 0&&v!==-1){const w=d.nodeName.substring(v+1);PB.indexOf(w)!==-1&&(d.nodeName=d.nodeName.substring(0,v),d.objectName=w)}if(d.propertyName===null||d.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+r);return d}static findNode(r,l){if(!l||l===""||l==="."||l===-1||l===r.name||l===r.uuid)return r;if(r.skeleton){const d=r.skeleton.getBoneByName(l);if(d!==void 0)return d}if(r.children){const d=function(w){for(let C=0;C<w.length;C++){const O=w[C];if(O.name===l||O.uuid===l)return O;const z=d(O.children);if(z)return z}return null},v=d(r.children);if(v)return v}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(r,l){r[l]=this.targetObject[this.propertyName]}_getValue_array(r,l){const d=this.resolvedProperty;for(let v=0,w=d.length;v!==w;++v)r[l++]=d[v]}_getValue_arrayElement(r,l){r[l]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(r,l){this.resolvedProperty.toArray(r,l)}_setValue_direct(r,l){this.targetObject[this.propertyName]=r[l]}_setValue_direct_setNeedsUpdate(r,l){this.targetObject[this.propertyName]=r[l],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(r,l){this.targetObject[this.propertyName]=r[l],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(r,l){const d=this.resolvedProperty;for(let v=0,w=d.length;v!==w;++v)d[v]=r[l++]}_setValue_array_setNeedsUpdate(r,l){const d=this.resolvedProperty;for(let v=0,w=d.length;v!==w;++v)d[v]=r[l++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(r,l){const d=this.resolvedProperty;for(let v=0,w=d.length;v!==w;++v)d[v]=r[l++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(r,l){this.resolvedProperty[this.propertyIndex]=r[l]}_setValue_arrayElement_setNeedsUpdate(r,l){this.resolvedProperty[this.propertyIndex]=r[l],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(r,l){this.resolvedProperty[this.propertyIndex]=r[l],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(r,l){this.resolvedProperty.fromArray(r,l)}_setValue_fromArray_setNeedsUpdate(r,l){this.resolvedProperty.fromArray(r,l),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(r,l){this.resolvedProperty.fromArray(r,l),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(r,l){this.bind(),this.getValue(r,l)}_setValue_unbound(r,l){this.bind(),this.setValue(r,l)}bind(){let r=this.node;const l=this.parsedPath,d=l.objectName,v=l.propertyName;let w=l.propertyIndex;if(r||(r=Xi.findNode(this.rootNode,l.nodeName)||this.rootNode,this.node=r),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!r){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(d){let H=l.objectIndex;switch(d){case"materials":if(!r.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!r.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}r=r.material.materials;break;case"bones":if(!r.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}r=r.skeleton.bones;for(let ne=0;ne<r.length;ne++)if(r[ne].name===H){H=ne;break}break;default:if(r[d]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}r=r[d]}if(H!==void 0){if(r[H]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,r);return}r=r[H]}}const C=r[v];if(C===void 0){const H=l.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+H+"."+v+" but it wasn't found.",r);return}let O=this.Versioning.None;this.targetObject=r,r.needsUpdate!==void 0?O=this.Versioning.NeedsUpdate:r.matrixWorldNeedsUpdate!==void 0&&(O=this.Versioning.MatrixWorldNeedsUpdate);let z=this.BindingType.Direct;if(w!==void 0){if(v==="morphTargetInfluences"){if(!r.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(r.geometry.isBufferGeometry){if(!r.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}r.morphTargetDictionary[w]!==void 0&&(w=r.morphTargetDictionary[w])}else{console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences on THREE.Geometry. Use THREE.BufferGeometry instead.",this);return}}z=this.BindingType.ArrayElement,this.resolvedProperty=C,this.propertyIndex=w}else C.fromArray!==void 0&&C.toArray!==void 0?(z=this.BindingType.HasFromToArray,this.resolvedProperty=C):Array.isArray(C)?(z=this.BindingType.EntireArray,this.resolvedProperty=C):this.propertyName=v;this.getValue=this.GetterByBindingType[z],this.setValue=this.SetterByBindingTypeAndVersioning[z][O]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}Xi.Composite=IB,Xi.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Xi.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},Xi.prototype.GetterByBindingType=[Xi.prototype._getValue_direct,Xi.prototype._getValue_array,Xi.prototype._getValue_arrayElement,Xi.prototype._getValue_toArray],Xi.prototype.SetterByBindingTypeAndVersioning=[[Xi.prototype._setValue_direct,Xi.prototype._setValue_direct_setNeedsUpdate,Xi.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[Xi.prototype._setValue_array,Xi.prototype._setValue_array_setNeedsUpdate,Xi.prototype._setValue_array_setMatrixWorldNeedsUpdate],[Xi.prototype._setValue_arrayElement,Xi.prototype._setValue_arrayElement_setNeedsUpdate,Xi.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[Xi.prototype._setValue_fromArray,Xi.prototype._setValue_fromArray_setNeedsUpdate,Xi.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class WM{constructor(){this.uuid=ho(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const r={};this._indicesByUUID=r;for(let d=0,v=arguments.length;d!==v;++d)r[arguments[d].uuid]=d;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const l=this;this.stats={objects:{get total(){return l._objects.length},get inUse(){return this.total-l.nCachedObjects_}},get bindingsPerObject(){return l._bindings.length}}}add(){const r=this._objects,l=this._indicesByUUID,d=this._paths,v=this._parsedPaths,w=this._bindings,C=w.length;let O,z=r.length,H=this.nCachedObjects_;for(let ne=0,re=arguments.length;ne!==re;++ne){const se=arguments[ne],oe=se.uuid;let ve=l[oe];if(ve===void 0){ve=z++,l[oe]=ve,r.push(se);for(let Te=0,Fe=C;Te!==Fe;++Te)w[Te].push(new Xi(se,d[Te],v[Te]))}else if(ve<H){O=r[ve];const Te=--H,Fe=r[Te];l[Fe.uuid]=ve,r[ve]=Fe,l[oe]=Te,r[Te]=se;for(let Ae=0,ue=C;Ae!==ue;++Ae){const Ve=w[Ae],ke=Ve[Te];let je=Ve[ve];Ve[ve]=ke,je===void 0&&(je=new Xi(se,d[Ae],v[Ae])),Ve[Te]=je}}else r[ve]!==O&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=H}remove(){const r=this._objects,l=this._indicesByUUID,d=this._bindings,v=d.length;let w=this.nCachedObjects_;for(let C=0,O=arguments.length;C!==O;++C){const z=arguments[C],H=z.uuid,ne=l[H];if(ne!==void 0&&ne>=w){const re=w++,se=r[re];l[se.uuid]=ne,r[ne]=se,l[H]=re,r[re]=z;for(let oe=0,ve=v;oe!==ve;++oe){const Te=d[oe],Fe=Te[re],Ae=Te[ne];Te[ne]=Fe,Te[re]=Ae}}}this.nCachedObjects_=w}uncache(){const r=this._objects,l=this._indicesByUUID,d=this._bindings,v=d.length;let w=this.nCachedObjects_,C=r.length;for(let O=0,z=arguments.length;O!==z;++O){const H=arguments[O],ne=H.uuid,re=l[ne];if(re!==void 0)if(delete l[ne],re<w){const se=--w,oe=r[se],ve=--C,Te=r[ve];l[oe.uuid]=re,r[re]=oe,l[Te.uuid]=se,r[se]=Te,r.pop();for(let Fe=0,Ae=v;Fe!==Ae;++Fe){const ue=d[Fe],Ve=ue[se],ke=ue[ve];ue[re]=Ve,ue[se]=ke,ue.pop()}}else{const se=--C,oe=r[se];se>0&&(l[oe.uuid]=re),r[re]=oe,r.pop();for(let ve=0,Te=v;ve!==Te;++ve){const Fe=d[ve];Fe[re]=Fe[se],Fe.pop()}}}this.nCachedObjects_=w}subscribe_(r,l){const d=this._bindingsIndicesByPath;let v=d[r];const w=this._bindings;if(v!==void 0)return w[v];const C=this._paths,O=this._parsedPaths,z=this._objects,H=z.length,ne=this.nCachedObjects_,re=new Array(H);v=w.length,d[r]=v,C.push(r),O.push(l),w.push(re);for(let se=ne,oe=z.length;se!==oe;++se){const ve=z[se];re[se]=new Xi(ve,r,l)}return re}unsubscribe_(r){const l=this._bindingsIndicesByPath,d=l[r];if(d!==void 0){const v=this._paths,w=this._parsedPaths,C=this._bindings,O=C.length-1,z=C[O],H=r[O];l[H]=d,C[d]=z,C.pop(),w[d]=w[O],w.pop(),v[d]=v[O],v.pop()}}}WM.prototype.isAnimationObjectGroup=!0;class OB{constructor(r,l,d=null,v=l.blendMode){this._mixer=r,this._clip=l,this._localRoot=d,this.blendMode=v;const w=l.tracks,C=w.length,O=new Array(C),z={endingStart:Tn,endingEnd:Tn};for(let H=0;H!==C;++H){const ne=w[H].createInterpolant(null);O[H]=ne,ne.settings=z}this._interpolantSettings=z,this._interpolants=O,this._propertyBindings=new Array(C),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=Vt,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(r){return this._startTime=r,this}setLoop(r,l){return this.loop=r,this.repetitions=l,this}setEffectiveWeight(r){return this.weight=r,this._effectiveWeight=this.enabled?r:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(r){return this._scheduleFading(r,0,1)}fadeOut(r){return this._scheduleFading(r,1,0)}crossFadeFrom(r,l,d){if(r.fadeOut(l),this.fadeIn(l),d){const v=this._clip.duration,w=r._clip.duration,C=w/v,O=v/w;r.warp(1,C,l),this.warp(O,1,l)}return this}crossFadeTo(r,l,d){return r.crossFadeFrom(this,l,d)}stopFading(){const r=this._weightInterpolant;return r!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(r)),this}setEffectiveTimeScale(r){return this.timeScale=r,this._effectiveTimeScale=this.paused?0:r,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(r){return this.timeScale=this._clip.duration/r,this.stopWarping()}syncWith(r){return this.time=r.time,this.timeScale=r.timeScale,this.stopWarping()}halt(r){return this.warp(this._effectiveTimeScale,0,r)}warp(r,l,d){const v=this._mixer,w=v.time,C=this.timeScale;let O=this._timeScaleInterpolant;O===null&&(O=v._lendControlInterpolant(),this._timeScaleInterpolant=O);const z=O.parameterPositions,H=O.sampleValues;return z[0]=w,z[1]=w+d,H[0]=r/C,H[1]=l/C,this}stopWarping(){const r=this._timeScaleInterpolant;return r!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(r)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(r,l,d,v){if(!this.enabled){this._updateWeight(r);return}const w=this._startTime;if(w!==null){const z=(r-w)*d;if(z<0||d===0)return;this._startTime=null,l=d*z}l*=this._updateTimeScale(r);const C=this._updateTime(l),O=this._updateWeight(r);if(O>0){const z=this._interpolants,H=this._propertyBindings;switch(this.blendMode){case $n:for(let ne=0,re=z.length;ne!==re;++ne)z[ne].evaluate(C),H[ne].accumulateAdditive(O);break;case Yn:default:for(let ne=0,re=z.length;ne!==re;++ne)z[ne].evaluate(C),H[ne].accumulate(v,O)}}}_updateWeight(r){let l=0;if(this.enabled){l=this.weight;const d=this._weightInterpolant;if(d!==null){const v=d.evaluate(r)[0];l*=v,r>d.parameterPositions[1]&&(this.stopFading(),v===0&&(this.enabled=!1))}}return this._effectiveWeight=l,l}_updateTimeScale(r){let l=0;if(!this.paused){l=this.timeScale;const d=this._timeScaleInterpolant;d!==null&&(l*=d.evaluate(r)[0],r>d.parameterPositions[1]&&(this.stopWarping(),l===0?this.paused=!0:this.timeScale=l))}return this._effectiveTimeScale=l,l}_updateTime(r){const l=this._clip.duration,d=this.loop;let v=this.time+r,w=this._loopCount;const C=d===gt;if(r===0)return w===-1?v:C&&(w&1)===1?l-v:v;if(d===Ut){w===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(v>=l)v=l;else if(v<0)v=0;else{this.time=v;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=v,this._mixer.dispatchEvent({type:"finished",action:this,direction:r<0?-1:1})}}else{if(w===-1&&(r>=0?(w=0,this._setEndings(!0,this.repetitions===0,C)):this._setEndings(this.repetitions===0,!0,C)),v>=l||v<0){const O=Math.floor(v/l);v-=l*O,w+=Math.abs(O);const z=this.repetitions-w;if(z<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,v=r>0?l:0,this.time=v,this._mixer.dispatchEvent({type:"finished",action:this,direction:r>0?1:-1});else{if(z===1){const H=r<0;this._setEndings(H,!H,C)}else this._setEndings(!1,!1,C);this._loopCount=w,this.time=v,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:O})}}else this.time=v;if(C&&(w&1)===1)return l-v}return v}_setEndings(r,l,d){const v=this._interpolantSettings;d?(v.endingStart=Ln,v.endingEnd=Ln):(r?v.endingStart=this.zeroSlopeAtStart?Ln:Tn:v.endingStart=Xn,l?v.endingEnd=this.zeroSlopeAtEnd?Ln:Tn:v.endingEnd=Xn)}_scheduleFading(r,l,d){const v=this._mixer,w=v.time;let C=this._weightInterpolant;C===null&&(C=v._lendControlInterpolant(),this._weightInterpolant=C);const O=C.parameterPositions,z=C.sampleValues;return O[0]=w,z[0]=l,O[1]=w+r,z[1]=d,this}}class jM extends hl{constructor(r){super(),this._root=r,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(r,l){const d=r._localRoot||this._root,v=r._clip.tracks,w=v.length,C=r._propertyBindings,O=r._interpolants,z=d.uuid,H=this._bindingsByRootAndName;let ne=H[z];ne===void 0&&(ne={},H[z]=ne);for(let re=0;re!==w;++re){const se=v[re],oe=se.name;let ve=ne[oe];if(ve!==void 0)++ve.referenceCount,C[re]=ve;else{if(ve=C[re],ve!==void 0){ve._cacheIndex===null&&(++ve.referenceCount,this._addInactiveBinding(ve,z,oe));continue}const Te=l&&l._propertyBindings[re].binding.parsedPath;ve=new VM(Xi.create(d,oe,Te),se.ValueTypeName,se.getValueSize()),++ve.referenceCount,this._addInactiveBinding(ve,z,oe),C[re]=ve}O[re].resultBuffer=ve.buffer}}_activateAction(r){if(!this._isActiveAction(r)){if(r._cacheIndex===null){const d=(r._localRoot||this._root).uuid,v=r._clip.uuid,w=this._actionsByClip[v];this._bindAction(r,w&&w.knownActions[0]),this._addInactiveAction(r,v,d)}const l=r._propertyBindings;for(let d=0,v=l.length;d!==v;++d){const w=l[d];w.useCount++===0&&(this._lendBinding(w),w.saveOriginalState())}this._lendAction(r)}}_deactivateAction(r){if(this._isActiveAction(r)){const l=r._propertyBindings;for(let d=0,v=l.length;d!==v;++d){const w=l[d];--w.useCount===0&&(w.restoreOriginalState(),this._takeBackBinding(w))}this._takeBackAction(r)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const r=this;this.stats={actions:{get total(){return r._actions.length},get inUse(){return r._nActiveActions}},bindings:{get total(){return r._bindings.length},get inUse(){return r._nActiveBindings}},controlInterpolants:{get total(){return r._controlInterpolants.length},get inUse(){return r._nActiveControlInterpolants}}}}_isActiveAction(r){const l=r._cacheIndex;return l!==null&&l<this._nActiveActions}_addInactiveAction(r,l,d){const v=this._actions,w=this._actionsByClip;let C=w[l];if(C===void 0)C={knownActions:[r],actionByRoot:{}},r._byClipCacheIndex=0,w[l]=C;else{const O=C.knownActions;r._byClipCacheIndex=O.length,O.push(r)}r._cacheIndex=v.length,v.push(r),C.actionByRoot[d]=r}_removeInactiveAction(r){const l=this._actions,d=l[l.length-1],v=r._cacheIndex;d._cacheIndex=v,l[v]=d,l.pop(),r._cacheIndex=null;const w=r._clip.uuid,C=this._actionsByClip,O=C[w],z=O.knownActions,H=z[z.length-1],ne=r._byClipCacheIndex;H._byClipCacheIndex=ne,z[ne]=H,z.pop(),r._byClipCacheIndex=null;const re=O.actionByRoot,se=(r._localRoot||this._root).uuid;delete re[se],z.length===0&&delete C[w],this._removeInactiveBindingsForAction(r)}_removeInactiveBindingsForAction(r){const l=r._propertyBindings;for(let d=0,v=l.length;d!==v;++d){const w=l[d];--w.referenceCount===0&&this._removeInactiveBinding(w)}}_lendAction(r){const l=this._actions,d=r._cacheIndex,v=this._nActiveActions++,w=l[v];r._cacheIndex=v,l[v]=r,w._cacheIndex=d,l[d]=w}_takeBackAction(r){const l=this._actions,d=r._cacheIndex,v=--this._nActiveActions,w=l[v];r._cacheIndex=v,l[v]=r,w._cacheIndex=d,l[d]=w}_addInactiveBinding(r,l,d){const v=this._bindingsByRootAndName,w=this._bindings;let C=v[l];C===void 0&&(C={},v[l]=C),C[d]=r,r._cacheIndex=w.length,w.push(r)}_removeInactiveBinding(r){const l=this._bindings,d=r.binding,v=d.rootNode.uuid,w=d.path,C=this._bindingsByRootAndName,O=C[v],z=l[l.length-1],H=r._cacheIndex;z._cacheIndex=H,l[H]=z,l.pop(),delete O[w],Object.keys(O).length===0&&delete C[v]}_lendBinding(r){const l=this._bindings,d=r._cacheIndex,v=this._nActiveBindings++,w=l[v];r._cacheIndex=v,l[v]=r,w._cacheIndex=d,l[d]=w}_takeBackBinding(r){const l=this._bindings,d=r._cacheIndex,v=--this._nActiveBindings,w=l[v];r._cacheIndex=v,l[v]=r,w._cacheIndex=d,l[d]=w}_lendControlInterpolant(){const r=this._controlInterpolants,l=this._nActiveControlInterpolants++;let d=r[l];return d===void 0&&(d=new cx(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),d.__cacheIndex=l,r[l]=d),d}_takeBackControlInterpolant(r){const l=this._controlInterpolants,d=r.__cacheIndex,v=--this._nActiveControlInterpolants,w=l[v];r.__cacheIndex=v,l[v]=r,w.__cacheIndex=d,l[d]=w}clipAction(r,l,d){const v=l||this._root,w=v.uuid;let C=typeof r=="string"?Sp.findByName(v,r):r;const O=C!==null?C.uuid:r,z=this._actionsByClip[O];let H=null;if(d===void 0&&(C!==null?d=C.blendMode:d=Yn),z!==void 0){const re=z.actionByRoot[w];if(re!==void 0&&re.blendMode===d)return re;H=z.knownActions[0],C===null&&(C=H._clip)}if(C===null)return null;const ne=new OB(this,C,l,d);return this._bindAction(ne,H),this._addInactiveAction(ne,O,w),ne}existingAction(r,l){const d=l||this._root,v=d.uuid,w=typeof r=="string"?Sp.findByName(d,r):r,C=w?w.uuid:r,O=this._actionsByClip[C];return O!==void 0&&O.actionByRoot[v]||null}stopAllAction(){const r=this._actions,l=this._nActiveActions;for(let d=l-1;d>=0;--d)r[d].stop();return this}update(r){r*=this.timeScale;const l=this._actions,d=this._nActiveActions,v=this.time+=r,w=Math.sign(r),C=this._accuIndex^=1;for(let H=0;H!==d;++H)l[H]._update(v,r,w,C);const O=this._bindings,z=this._nActiveBindings;for(let H=0;H!==z;++H)O[H].apply(C);return this}setTime(r){this.time=0;for(let l=0;l<this._actions.length;l++)this._actions[l].time=0;return this.update(r)}getRoot(){return this._root}uncacheClip(r){const l=this._actions,d=r.uuid,v=this._actionsByClip,w=v[d];if(w!==void 0){const C=w.knownActions;for(let O=0,z=C.length;O!==z;++O){const H=C[O];this._deactivateAction(H);const ne=H._cacheIndex,re=l[l.length-1];H._cacheIndex=null,H._byClipCacheIndex=null,re._cacheIndex=ne,l[ne]=re,l.pop(),this._removeInactiveBindingsForAction(H)}delete v[d]}}uncacheRoot(r){const l=r.uuid,d=this._actionsByClip;for(const C in d){const O=d[C].actionByRoot,z=O[l];z!==void 0&&(this._deactivateAction(z),this._removeInactiveAction(z))}const v=this._bindingsByRootAndName,w=v[l];if(w!==void 0)for(const C in w){const O=w[C];O.restoreOriginalState(),this._removeInactiveBinding(O)}}uncacheAction(r,l){const d=this.existingAction(r,l);d!==null&&(this._deactivateAction(d),this._removeInactiveAction(d))}}jM.prototype._controlInterpolantsResultBuffer=new Float32Array(1);class tg{constructor(r){typeof r=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),r=arguments[1]),this.value=r}clone(){return new tg(this.value.clone===void 0?this.value:this.value.clone())}}class XM extends mu{constructor(r,l,d=1){super(r,l),this.meshPerAttribute=d}copy(r){return super.copy(r),this.meshPerAttribute=r.meshPerAttribute,this}clone(r){const l=super.clone(r);return l.meshPerAttribute=this.meshPerAttribute,l}toJSON(r){const l=super.toJSON(r);return l.isInstancedInterleavedBuffer=!0,l.meshPerAttribute=this.meshPerAttribute,l}}XM.prototype.isInstancedInterleavedBuffer=!0;class $M{constructor(r,l,d,v,w){this.buffer=r,this.type=l,this.itemSize=d,this.elementSize=v,this.count=w,this.version=0}set needsUpdate(r){r===!0&&this.version++}setBuffer(r){return this.buffer=r,this}setType(r,l){return this.type=r,this.elementSize=l,this}setItemSize(r){return this.itemSize=r,this}setCount(r){return this.count=r,this}}$M.prototype.isGLBufferAttribute=!0;class DB{constructor(r,l,d=0,v=1/0){this.ray=new Jl(r,l),this.near=d,this.far=v,this.camera=null,this.layers=new i0,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(r,l){this.ray.set(r,l)}setFromCamera(r,l){l&&l.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(l.matrixWorld),this.ray.direction.set(r.x,r.y,.5).unproject(l).sub(this.ray.origin).normalize(),this.camera=l):l&&l.isOrthographicCamera?(this.ray.origin.set(r.x,r.y,(l.near+l.far)/(l.near-l.far)).unproject(l),this.ray.direction.set(0,0,-1).transformDirection(l.matrixWorld),this.camera=l):console.error("THREE.Raycaster: Unsupported camera type: "+l.type)}intersectObject(r,l=!0,d=[]){return Sx(r,this,d,l),d.sort(qM),d}intersectObjects(r,l=!0,d=[]){for(let v=0,w=r.length;v<w;v++)Sx(r[v],this,d,l);return d.sort(qM),d}}function qM(A,r){return A.distance-r.distance}function Sx(A,r,l,d){if(A.layers.test(r.layers)&&A.raycast(r,l),d===!0){const v=A.children;for(let w=0,C=v.length;w<C;w++)Sx(v[w],r,l,!0)}}class BB{constructor(r=1,l=0,d=0){return this.radius=r,this.phi=l,this.theta=d,this}set(r,l,d){return this.radius=r,this.phi=l,this.theta=d,this}copy(r){return this.radius=r.radius,this.phi=r.phi,this.theta=r.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(r){return this.setFromCartesianCoords(r.x,r.y,r.z)}setFromCartesianCoords(r,l,d){return this.radius=Math.sqrt(r*r+l*l+d*d),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(r,d),this.phi=Math.acos(ys(l/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class FB{constructor(r=1,l=0,d=0){return this.radius=r,this.theta=l,this.y=d,this}set(r,l,d){return this.radius=r,this.theta=l,this.y=d,this}copy(r){return this.radius=r.radius,this.theta=r.theta,this.y=r.y,this}setFromVector3(r){return this.setFromCartesianCoords(r.x,r.y,r.z)}setFromCartesianCoords(r,l,d){return this.radius=Math.sqrt(r*r+d*d),this.theta=Math.atan2(r,d),this.y=l,this}clone(){return new this.constructor().copy(this)}}const YM=new pn;class bf{constructor(r=new pn(1/0,1/0),l=new pn(-1/0,-1/0)){this.min=r,this.max=l}set(r,l){return this.min.copy(r),this.max.copy(l),this}setFromPoints(r){this.makeEmpty();for(let l=0,d=r.length;l<d;l++)this.expandByPoint(r[l]);return this}setFromCenterAndSize(r,l){const d=YM.copy(l).multiplyScalar(.5);return this.min.copy(r).sub(d),this.max.copy(r).add(d),this}clone(){return new this.constructor().copy(this)}copy(r){return this.min.copy(r.min),this.max.copy(r.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(r){return this.isEmpty()?r.set(0,0):r.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(r){return this.isEmpty()?r.set(0,0):r.subVectors(this.max,this.min)}expandByPoint(r){return this.min.min(r),this.max.max(r),this}expandByVector(r){return this.min.sub(r),this.max.add(r),this}expandByScalar(r){return this.min.addScalar(-r),this.max.addScalar(r),this}containsPoint(r){return!(r.x<this.min.x||r.x>this.max.x||r.y<this.min.y||r.y>this.max.y)}containsBox(r){return this.min.x<=r.min.x&&r.max.x<=this.max.x&&this.min.y<=r.min.y&&r.max.y<=this.max.y}getParameter(r,l){return l.set((r.x-this.min.x)/(this.max.x-this.min.x),(r.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(r){return!(r.max.x<this.min.x||r.min.x>this.max.x||r.max.y<this.min.y||r.min.y>this.max.y)}clampPoint(r,l){return l.copy(r).clamp(this.min,this.max)}distanceToPoint(r){return YM.copy(r).clamp(this.min,this.max).sub(r).length()}intersect(r){return this.min.max(r.min),this.max.min(r.max),this}union(r){return this.min.min(r.min),this.max.max(r.max),this}translate(r){return this.min.add(r),this.max.add(r),this}equals(r){return r.min.equals(this.min)&&r.max.equals(this.max)}}bf.prototype.isBox2=!0;const QM=new qe,ng=new qe;class KM{constructor(r=new qe,l=new qe){this.start=r,this.end=l}set(r,l){return this.start.copy(r),this.end.copy(l),this}copy(r){return this.start.copy(r.start),this.end.copy(r.end),this}getCenter(r){return r.addVectors(this.start,this.end).multiplyScalar(.5)}delta(r){return r.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(r,l){return this.delta(l).multiplyScalar(r).add(this.start)}closestPointToPointParameter(r,l){QM.subVectors(r,this.start),ng.subVectors(this.end,this.start);const d=ng.dot(ng);let w=ng.dot(QM)/d;return l&&(w=ys(w,0,1)),w}closestPointToPoint(r,l,d){const v=this.closestPointToPointParameter(r,l);return this.delta(d).multiplyScalar(v).add(this.start)}applyMatrix4(r){return this.start.applyMatrix4(r),this.end.applyMatrix4(r),this}equals(r){return r.start.equals(this.start)&&r.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const ZM=new qe;class NB extends ki{constructor(r,l){super(),this.light=r,this.light.updateMatrixWorld(),this.matrix=r.matrixWorld,this.matrixAutoUpdate=!1,this.color=l;const d=new ui,v=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let C=0,O=1,z=32;C<z;C++,O++){const H=C/z*Math.PI*2,ne=O/z*Math.PI*2;v.push(Math.cos(H),Math.sin(H),1,Math.cos(ne),Math.sin(ne),1)}d.setAttribute("position",new ei(v,3));const w=new cs({fog:!1,toneMapped:!1});this.cone=new ro(d,w),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const r=this.light.distance?this.light.distance:1e3,l=r*Math.tan(this.light.angle);this.cone.scale.set(l,l,r),ZM.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(ZM),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const uc=new qe,ig=new Jn,Tx=new Jn;class JM extends ro{constructor(r){const l=e2(r),d=new ui,v=[],w=[],C=new Un(0,0,1),O=new Un(0,1,0);for(let H=0;H<l.length;H++){const ne=l[H];ne.parent&&ne.parent.isBone&&(v.push(0,0,0),v.push(0,0,0),w.push(C.r,C.g,C.b),w.push(O.r,O.g,O.b))}d.setAttribute("position",new ei(v,3)),d.setAttribute("color",new ei(w,3));const z=new cs({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(d,z),this.type="SkeletonHelper",this.isSkeletonHelper=!0,this.root=r,this.bones=l,this.matrix=r.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(r){const l=this.bones,d=this.geometry,v=d.getAttribute("position");Tx.copy(this.root.matrixWorld).invert();for(let w=0,C=0;w<l.length;w++){const O=l[w];O.parent&&O.parent.isBone&&(ig.multiplyMatrices(Tx,O.matrixWorld),uc.setFromMatrixPosition(ig),v.setXYZ(C,uc.x,uc.y,uc.z),ig.multiplyMatrices(Tx,O.parent.matrixWorld),uc.setFromMatrixPosition(ig),v.setXYZ(C+1,uc.x,uc.y,uc.z),C+=2)}d.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(r)}}function e2(A){const r=[];A&&A.isBone&&r.push(A);for(let l=0;l<A.children.length;l++)r.push.apply(r,e2(A.children[l]));return r}class UB extends $r{constructor(r,l,d){const v=new bu(l,4,2),w=new vl({wireframe:!0,fog:!1,toneMapped:!1});super(v,w),this.light=r,this.light.updateMatrixWorld(),this.color=d,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const kB=new qe,t2=new Un,n2=new Un;class zB extends ki{constructor(r,l,d){super(),this.light=r,this.light.updateMatrixWorld(),this.matrix=r.matrixWorld,this.matrixAutoUpdate=!1,this.color=d;const v=new xu(l);v.rotateY(Math.PI*.5),this.material=new vl({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const w=v.getAttribute("position"),C=new Float32Array(w.count*3);v.setAttribute("color",new Wi(C,3)),this.add(new $r(v,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const r=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const l=r.geometry.getAttribute("color");t2.copy(this.light.color),n2.copy(this.light.groundColor);for(let d=0,v=l.count;d<v;d++){const w=d<v/2?t2:n2;l.setXYZ(d,w.r,w.g,w.b)}l.needsUpdate=!0}r.lookAt(kB.setFromMatrixPosition(this.light.matrixWorld).negate())}}class i2 extends ro{constructor(r=10,l=10,d=4473924,v=8947848){d=new Un(d),v=new Un(v);const w=l/2,C=r/l,O=r/2,z=[],H=[];for(let se=0,oe=0,ve=-O;se<=l;se++,ve+=C){z.push(-O,0,ve,O,0,ve),z.push(ve,0,-O,ve,0,O);const Te=se===w?d:v;Te.toArray(H,oe),oe+=3,Te.toArray(H,oe),oe+=3,Te.toArray(H,oe),oe+=3,Te.toArray(H,oe),oe+=3}const ne=new ui;ne.setAttribute("position",new ei(z,3)),ne.setAttribute("color",new ei(H,3));const re=new cs({vertexColors:!0,toneMapped:!1});super(ne,re),this.type="GridHelper"}}class HB extends ro{constructor(r=10,l=16,d=8,v=64,w=4473924,C=8947848){w=new Un(w),C=new Un(C);const O=[],z=[];for(let re=0;re<=l;re++){const se=re/l*(Math.PI*2),oe=Math.sin(se)*r,ve=Math.cos(se)*r;O.push(0,0,0),O.push(oe,0,ve);const Te=re&1?w:C;z.push(Te.r,Te.g,Te.b),z.push(Te.r,Te.g,Te.b)}for(let re=0;re<=d;re++){const se=re&1?w:C,oe=r-r/d*re;for(let ve=0;ve<v;ve++){let Te=ve/v*(Math.PI*2),Fe=Math.sin(Te)*oe,Ae=Math.cos(Te)*oe;O.push(Fe,0,Ae),z.push(se.r,se.g,se.b),Te=(ve+1)/v*(Math.PI*2),Fe=Math.sin(Te)*oe,Ae=Math.cos(Te)*oe,O.push(Fe,0,Ae),z.push(se.r,se.g,se.b)}}const H=new ui;H.setAttribute("position",new ei(O,3)),H.setAttribute("color",new ei(z,3));const ne=new cs({vertexColors:!0,toneMapped:!1});super(H,ne),this.type="PolarGridHelper"}}const r2=new qe,rg=new qe,s2=new qe;class GB extends ki{constructor(r,l,d){super(),this.light=r,this.light.updateMatrixWorld(),this.matrix=r.matrixWorld,this.matrixAutoUpdate=!1,this.color=d,l===void 0&&(l=1);let v=new ui;v.setAttribute("position",new ei([-l,l,0,l,l,0,l,-l,0,-l,-l,0,-l,l,0],3));const w=new cs({fog:!1,toneMapped:!1});this.lightPlane=new Al(v,w),this.add(this.lightPlane),v=new ui,v.setAttribute("position",new ei([0,0,0,0,0,1],3)),this.targetLine=new Al(v,w),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){r2.setFromMatrixPosition(this.light.matrixWorld),rg.setFromMatrixPosition(this.light.target.matrixWorld),s2.subVectors(rg,r2),this.lightPlane.lookAt(rg),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(rg),this.targetLine.scale.z=s2.length()}}const sg=new qe,Lr=new rp;class VB extends ro{constructor(r){const l=new ui,d=new cs({color:16777215,vertexColors:!0,toneMapped:!1}),v=[],w=[],C={},O=new Un(16755200),z=new Un(16711680),H=new Un(43775),ne=new Un(16777215),re=new Un(3355443);se("n1","n2",O),se("n2","n4",O),se("n4","n3",O),se("n3","n1",O),se("f1","f2",O),se("f2","f4",O),se("f4","f3",O),se("f3","f1",O),se("n1","f1",O),se("n2","f2",O),se("n3","f3",O),se("n4","f4",O),se("p","n1",z),se("p","n2",z),se("p","n3",z),se("p","n4",z),se("u1","u2",H),se("u2","u3",H),se("u3","u1",H),se("c","t",ne),se("p","c",re),se("cn1","cn2",re),se("cn3","cn4",re),se("cf1","cf2",re),se("cf3","cf4",re);function se(ve,Te,Fe){oe(ve,Fe),oe(Te,Fe)}function oe(ve,Te){v.push(0,0,0),w.push(Te.r,Te.g,Te.b),C[ve]===void 0&&(C[ve]=[]),C[ve].push(v.length/3-1)}l.setAttribute("position",new ei(v,3)),l.setAttribute("color",new ei(w,3)),super(l,d),this.type="CameraHelper",this.camera=r,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=r.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=C,this.update()}update(){const r=this.geometry,l=this.pointMap,d=1,v=1;Lr.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),zr("c",l,r,Lr,0,0,-1),zr("t",l,r,Lr,0,0,1),zr("n1",l,r,Lr,-d,-v,-1),zr("n2",l,r,Lr,d,-v,-1),zr("n3",l,r,Lr,-d,v,-1),zr("n4",l,r,Lr,d,v,-1),zr("f1",l,r,Lr,-d,-v,1),zr("f2",l,r,Lr,d,-v,1),zr("f3",l,r,Lr,-d,v,1),zr("f4",l,r,Lr,d,v,1),zr("u1",l,r,Lr,d*.7,v*1.1,-1),zr("u2",l,r,Lr,-d*.7,v*1.1,-1),zr("u3",l,r,Lr,0,v*2,-1),zr("cf1",l,r,Lr,-d,0,1),zr("cf2",l,r,Lr,d,0,1),zr("cf3",l,r,Lr,0,-v,1),zr("cf4",l,r,Lr,0,v,1),zr("cn1",l,r,Lr,-d,0,-1),zr("cn2",l,r,Lr,d,0,-1),zr("cn3",l,r,Lr,0,-v,-1),zr("cn4",l,r,Lr,0,v,-1),r.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function zr(A,r,l,d,v,w,C){sg.set(v,w,C).unproject(d);const O=r[A];if(O!==void 0){const z=l.getAttribute("position");for(let H=0,ne=O.length;H<ne;H++)z.setXYZ(O[H],sg.x,sg.y,sg.z)}}const og=new po;class o2 extends ro{constructor(r,l=16776960){const d=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),v=new Float32Array(8*3),w=new ui;w.setIndex(new Wi(d,1)),w.setAttribute("position",new Wi(v,3)),super(w,new cs({color:l,toneMapped:!1})),this.object=r,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(r){if(r!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&og.setFromObject(this.object),og.isEmpty())return;const l=og.min,d=og.max,v=this.geometry.attributes.position,w=v.array;w[0]=d.x,w[1]=d.y,w[2]=d.z,w[3]=l.x,w[4]=d.y,w[5]=d.z,w[6]=l.x,w[7]=l.y,w[8]=d.z,w[9]=d.x,w[10]=l.y,w[11]=d.z,w[12]=d.x,w[13]=d.y,w[14]=l.z,w[15]=l.x,w[16]=d.y,w[17]=l.z,w[18]=l.x,w[19]=l.y,w[20]=l.z,w[21]=d.x,w[22]=l.y,w[23]=l.z,v.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(r){return this.object=r,this.update(),this}copy(r){return ro.prototype.copy.call(this,r),this.object=r.object,this}}class WB extends ro{constructor(r,l=16776960){const d=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),v=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],w=new ui;w.setIndex(new Wi(d,1)),w.setAttribute("position",new ei(v,3)),super(w,new cs({color:l,toneMapped:!1})),this.box=r,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(r){const l=this.box;l.isEmpty()||(l.getCenter(this.position),l.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(r))}}class jB extends Al{constructor(r,l=1,d=16776960){const v=d,w=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],C=new ui;C.setAttribute("position",new ei(w,3)),C.computeBoundingSphere(),super(C,new cs({color:v,toneMapped:!1})),this.type="PlaneHelper",this.plane=r,this.size=l;const O=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],z=new ui;z.setAttribute("position",new ei(O,3)),z.computeBoundingSphere(),this.add(new $r(z,new vl({color:v,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(r){let l=-this.plane.constant;Math.abs(l)<1e-8&&(l=1e-8),this.scale.set(.5*this.size,.5*this.size,l),this.children[0].material.side=l<0?T:E,this.lookAt(this.plane.normal),super.updateMatrixWorld(r)}}const a2=new qe;let ag,Cx;class XB extends ki{constructor(r=new qe(0,0,1),l=new qe(0,0,0),d=1,v=16776960,w=d*.2,C=w*.2){super(),this.type="ArrowHelper",ag===void 0&&(ag=new ui,ag.setAttribute("position",new ei([0,0,0,0,1,0],3)),Cx=new lc(0,.5,1,5,1),Cx.translate(0,-.5,0)),this.position.copy(l),this.line=new Al(ag,new cs({color:v,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new $r(Cx,new vl({color:v,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(r),this.setLength(d,w,C)}setDirection(r){if(r.y>.99999)this.quaternion.set(0,0,0,1);else if(r.y<-.99999)this.quaternion.set(1,0,0,0);else{a2.set(r.z,0,-r.x).normalize();const l=Math.acos(r.y);this.quaternion.setFromAxisAngle(a2,l)}}setLength(r,l=r*.2,d=l*.2){this.line.scale.set(1,Math.max(1e-4,r-l),1),this.line.updateMatrix(),this.cone.scale.set(d,l,d),this.cone.position.y=r,this.cone.updateMatrix()}setColor(r){this.line.material.color.set(r),this.cone.material.color.set(r)}copy(r){return super.copy(r,!1),this.line.copy(r.line),this.cone.copy(r.cone),this}}class l2 extends ro{constructor(r=1){const l=[0,0,0,r,0,0,0,0,0,0,r,0,0,0,0,0,0,r],d=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],v=new ui;v.setAttribute("position",new ei(l,3)),v.setAttribute("color",new ei(d,3));const w=new cs({vertexColors:!0,toneMapped:!1});super(v,w),this.type="AxesHelper"}setColors(r,l,d){const v=new Un,w=this.geometry.attributes.color.array;return v.set(r),v.toArray(w,0),v.toArray(w,3),v.set(l),v.toArray(w,6),v.toArray(w,9),v.set(d),v.toArray(w,12),v.toArray(w,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class $B{constructor(){this.type="ShapePath",this.color=new Un,this.subPaths=[],this.currentPath=null}moveTo(r,l){return this.currentPath=new Ap,this.subPaths.push(this.currentPath),this.currentPath.moveTo(r,l),this}lineTo(r,l){return this.currentPath.lineTo(r,l),this}quadraticCurveTo(r,l,d,v){return this.currentPath.quadraticCurveTo(r,l,d,v),this}bezierCurveTo(r,l,d,v,w,C){return this.currentPath.bezierCurveTo(r,l,d,v,w,C),this}splineThru(r){return this.currentPath.splineThru(r),this}toShapes(r,l){function d(ue){const Ve=[];for(let ke=0,je=ue.length;ke<je;ke++){const st=ue[ke],At=new Ta;At.curves=st.curves,Ve.push(At)}return Ve}function v(ue,Ve){const ke=Ve.length;let je=!1;for(let st=ke-1,At=0;At<ke;st=At++){let Et=Ve[st],Xt=Ve[At],Ht=Xt.x-Et.x,Ne=Xt.y-Et.y;if(Math.abs(Ne)>Number.EPSILON){if(Ne<0&&(Et=Ve[At],Ht=-Ht,Xt=Ve[st],Ne=-Ne),ue.y<Et.y||ue.y>Xt.y)continue;if(ue.y===Et.y){if(ue.x===Et.x)return!0}else{const ct=Ne*(ue.x-Et.x)-Ht*(ue.y-Et.y);if(ct===0)return!0;if(ct<0)continue;je=!je}}else{if(ue.y!==Et.y)continue;if(Xt.x<=ue.x&&ue.x<=Et.x||Et.x<=ue.x&&ue.x<=Xt.x)return!0}}return je}const w=Ca.isClockWise,C=this.subPaths;if(C.length===0)return[];if(l===!0)return d(C);let O,z,H;const ne=[];if(C.length===1)return z=C[0],H=new Ta,H.curves=z.curves,ne.push(H),ne;let re=!w(C[0].getPoints());re=r?!re:re;const se=[],oe=[];let ve=[],Te=0,Fe;oe[Te]=void 0,ve[Te]=[];for(let ue=0,Ve=C.length;ue<Ve;ue++)z=C[ue],Fe=z.getPoints(),O=w(Fe),O=r?!O:O,O?(!re&&oe[Te]&&Te++,oe[Te]={s:new Ta,p:Fe},oe[Te].s.curves=z.curves,re&&Te++,ve[Te]=[]):ve[Te].push({h:z,p:Fe[0]});if(!oe[0])return d(C);if(oe.length>1){let ue=!1;const Ve=[];for(let ke=0,je=oe.length;ke<je;ke++)se[ke]=[];for(let ke=0,je=oe.length;ke<je;ke++){const st=ve[ke];for(let At=0;At<st.length;At++){const Et=st[At];let Xt=!0;for(let Ht=0;Ht<oe.length;Ht++)v(Et.p,oe[Ht].p)&&(ke!==Ht&&Ve.push({froms:ke,tos:Ht,hole:At}),Xt?(Xt=!1,se[Ht].push(Et)):ue=!0);Xt&&se[ke].push(Et)}}Ve.length>0&&(ue||(ve=se))}let Ae;for(let ue=0,Ve=oe.length;ue<Ve;ue++){H=oe[ue].s,ne.push(H),Ae=ve[ue];for(let ke=0,je=Ae.length;ke<je;ke++)H.holes.push(Ae[ke].h)}return ne}}const c2=new Float32Array(1),qB=new Int32Array(c2.buffer);class YB{static toHalfFloat(r){r>65504&&(console.warn("THREE.DataUtils.toHalfFloat(): value exceeds 65504."),r=65504),c2[0]=r;const l=qB[0];let d=l>>16&32768,v=l>>12&2047;const w=l>>23&255;return w<103?d:w>142?(d|=31744,d|=(w==255?0:1)&&l&8388607,d):w<113?(v|=2048,d|=(v>>114-w)+(v>>113-w&1),d):(d|=w-112<<10|v>>1,d+=v&1,d)}}const QB=0,KB=1,ZB=0,JB=1,e6=2;function t6(A){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),A}function n6(A=[]){return console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),A.isMultiMaterial=!0,A.materials=A,A.clone=function(){return A.slice()},A}function i6(A,r){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new mp(A,r)}function r6(A){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new P0(A)}function s6(A,r){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new mp(A,r)}function o6(A){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new yu(A)}function a6(A){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new yu(A)}function l6(A){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new yu(A)}function c6(A,r,l){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new qe(A,r,l)}function u6(A,r){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setUsage( THREE.DynamicDrawUsage ) instead."),new Wi(A,r).setUsage(Bh)}function h6(A,r){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new Vw(A,r)}function f6(A,r){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new Ww(A,r)}function d6(A,r){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new jw(A,r)}function p6(A,r){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new Xw(A,r)}function m6(A,r){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new o0(A,r)}function g6(A,r){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new $w(A,r)}function v6(A,r){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new a0(A,r)}function y6(A,r){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new ei(A,r)}function x6(A,r){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new Yw(A,r)}vo.create=function(A,r){return console.log("THREE.Curve.create() has been deprecated"),A.prototype=Object.create(vo.prototype),A.prototype.constructor=A,A.prototype.getPoint=r,A},Ap.prototype.fromPoints=function(A){return console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(A)};function A6(A){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new l2(A)}function b6(A,r){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new o2(A,r)}function _6(A,r){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new ro(new V1(A.geometry),new cs({color:r!==void 0?r:16777215}))}i2.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},JM.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")};function w6(A,r){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new ro(new ex(A.geometry),new cs({color:r!==void 0?r:16777215}))}Xs.prototype.extractUrlBase=function(A){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),J0.extractUrlBase(A)},Xs.Handlers={add:function(){console.error("THREE.Loader: Handlers.add() has been removed. Use LoadingManager.addHandler() instead.")},get:function(){console.error("THREE.Loader: Handlers.get() has been removed. Use LoadingManager.getHandler() instead.")}};function E6(A){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new La(A)}function M6(A){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new xM(A)}bf.prototype.center=function(A){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(A)},bf.prototype.empty=function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},bf.prototype.isIntersectionBox=function(A){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(A)},bf.prototype.size=function(A){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(A)},po.prototype.center=function(A){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(A)},po.prototype.empty=function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},po.prototype.isIntersectionBox=function(A){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(A)},po.prototype.isIntersectionSphere=function(A){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(A)},po.prototype.size=function(A){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(A)},Kl.prototype.empty=function(){return console.warn("THREE.Sphere: .empty() has been renamed to .isEmpty()."),this.isEmpty()},sp.prototype.setFromMatrix=function(A){return console.warn("THREE.Frustum: .setFromMatrix() has been renamed to .setFromProjectionMatrix()."),this.setFromProjectionMatrix(A)},KM.prototype.center=function(A){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(A)},es.prototype.flattenToArrayOffset=function(A,r){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(A,r)},es.prototype.multiplyVector3=function(A){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),A.applyMatrix3(this)},es.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},es.prototype.applyToBufferAttribute=function(A){return console.warn("THREE.Matrix3: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix3( matrix ) instead."),A.applyMatrix3(this)},es.prototype.applyToVector3Array=function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")},es.prototype.getInverse=function(A){return console.warn("THREE.Matrix3: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(A).invert()},Jn.prototype.extractPosition=function(A){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(A)},Jn.prototype.flattenToArrayOffset=function(A,r){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(A,r)},Jn.prototype.getPosition=function(){return console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),new qe().setFromMatrixColumn(this,3)},Jn.prototype.setRotationFromQuaternion=function(A){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(A)},Jn.prototype.multiplyToArray=function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},Jn.prototype.multiplyVector3=function(A){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),A.applyMatrix4(this)},Jn.prototype.multiplyVector4=function(A){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),A.applyMatrix4(this)},Jn.prototype.multiplyVector3Array=function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},Jn.prototype.rotateAxis=function(A){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),A.transformDirection(this)},Jn.prototype.crossVector=function(A){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),A.applyMatrix4(this)},Jn.prototype.translate=function(){console.error("THREE.Matrix4: .translate() has been removed.")},Jn.prototype.rotateX=function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},Jn.prototype.rotateY=function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},Jn.prototype.rotateZ=function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},Jn.prototype.rotateByAxis=function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},Jn.prototype.applyToBufferAttribute=function(A){return console.warn("THREE.Matrix4: .applyToBufferAttribute() has been removed. Use attribute.applyMatrix4( matrix ) instead."),A.applyMatrix4(this)},Jn.prototype.applyToVector3Array=function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},Jn.prototype.makeFrustum=function(A,r,l,d,v,w){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(A,r,d,l,v,w)},Jn.prototype.getInverse=function(A){return console.warn("THREE.Matrix4: .getInverse() has been removed. Use matrixInv.copy( matrix ).invert(); instead."),this.copy(A).invert()},Ea.prototype.isIntersectionLine=function(A){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(A)},os.prototype.multiplyVector3=function(A){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),A.applyQuaternion(this)},os.prototype.inverse=function(){return console.warn("THREE.Quaternion: .inverse() has been renamed to invert()."),this.invert()},Jl.prototype.isIntersectionBox=function(A){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(A)},Jl.prototype.isIntersectionPlane=function(A){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(A)},Jl.prototype.isIntersectionSphere=function(A){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(A)},Ur.prototype.area=function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},Ur.prototype.barycoordFromPoint=function(A,r){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(A,r)},Ur.prototype.midpoint=function(A){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(A)},Ur.prototypenormal=function(A){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(A)},Ur.prototype.plane=function(A){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(A)},Ur.barycoordFromPoint=function(A,r,l,d,v){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Ur.getBarycoord(A,r,l,d,v)},Ur.normal=function(A,r,l,d){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Ur.getNormal(A,r,l,d)},Ta.prototype.extractAllPoints=function(A){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(A)},Ta.prototype.extrude=function(A){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new Ra(this,A)},Ta.prototype.makeGeometry=function(A){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Au(this,A)},pn.prototype.fromAttribute=function(A,r,l){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(A,r,l)},pn.prototype.distanceToManhattan=function(A){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(A)},pn.prototype.lengthManhattan=function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},qe.prototype.setEulerFromRotationMatrix=function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},qe.prototype.setEulerFromQuaternion=function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},qe.prototype.getPositionFromMatrix=function(A){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(A)},qe.prototype.getScaleFromMatrix=function(A){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(A)},qe.prototype.getColumnFromMatrix=function(A,r){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(r,A)},qe.prototype.applyProjection=function(A){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(A)},qe.prototype.fromAttribute=function(A,r,l){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(A,r,l)},qe.prototype.distanceToManhattan=function(A){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(A)},qe.prototype.lengthManhattan=function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},nr.prototype.fromAttribute=function(A,r,l){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(A,r,l)},nr.prototype.lengthManhattan=function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()},ki.prototype.getChildByName=function(A){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(A)},ki.prototype.renderDepth=function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},ki.prototype.translate=function(A,r){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(r,A)},ki.prototype.getWorldRotation=function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")},ki.prototype.applyMatrix=function(A){return console.warn("THREE.Object3D: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(A)},Object.defineProperties(ki.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(A){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=A}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),$r.prototype.setDrawMode=function(){console.error("THREE.Mesh: .setDrawMode() has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")},Object.defineProperties($r.prototype,{drawMode:{get:function(){return console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode."),vi},set:function(){console.error("THREE.Mesh: .drawMode has been removed. The renderer now always assumes THREE.TrianglesDrawMode. Transform your geometry via BufferGeometryUtils.toTrianglesDrawMode() if necessary.")}}}),D0.prototype.initBones=function(){console.error("THREE.SkinnedMesh: initBones() has been removed.")},qr.prototype.setLens=function(A,r){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),r!==void 0&&(this.filmGauge=r),this.setFocalLength(A)},Object.defineProperties(Zo.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(A){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=A}},shadowCameraLeft:{set:function(A){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=A}},shadowCameraRight:{set:function(A){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=A}},shadowCameraTop:{set:function(A){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=A}},shadowCameraBottom:{set:function(A){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=A}},shadowCameraNear:{set:function(A){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=A}},shadowCameraFar:{set:function(A){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=A}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(A){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=A}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(A){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=A}},shadowMapHeight:{set:function(A){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=A}}}),Object.defineProperties(Wi.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},dynamic:{get:function(){return console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.usage===Bh},set:function(){console.warn("THREE.BufferAttribute: .dynamic has been deprecated. Use .usage instead."),this.setUsage(Bh)}}}),Wi.prototype.setDynamic=function(A){return console.warn("THREE.BufferAttribute: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(A===!0?Bh:Dh),this},Wi.prototype.copyIndicesArray=function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")},Wi.prototype.setArray=function(){console.error("THREE.BufferAttribute: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},ui.prototype.addIndex=function(A){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(A)},ui.prototype.addAttribute=function(A,r){return console.warn("THREE.BufferGeometry: .addAttribute() has been renamed to .setAttribute()."),!(r&&r.isBufferAttribute)&&!(r&&r.isInterleavedBufferAttribute)?(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),this.setAttribute(A,new Wi(arguments[1],arguments[2]))):A==="index"?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),this.setIndex(r),this):this.setAttribute(A,r)},ui.prototype.addDrawCall=function(A,r,l){l!==void 0&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(A,r)},ui.prototype.clearDrawCalls=function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},ui.prototype.computeOffsets=function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")},ui.prototype.removeAttribute=function(A){return console.warn("THREE.BufferGeometry: .removeAttribute() has been renamed to .deleteAttribute()."),this.deleteAttribute(A)},ui.prototype.applyMatrix=function(A){return console.warn("THREE.BufferGeometry: .applyMatrix() has been renamed to .applyMatrix4()."),this.applyMatrix4(A)},Object.defineProperties(ui.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),mu.prototype.setDynamic=function(A){return console.warn("THREE.InterleavedBuffer: .setDynamic() has been deprecated. Use .setUsage() instead."),this.setUsage(A===!0?Bh:Dh),this},mu.prototype.setArray=function(){console.error("THREE.InterleavedBuffer: .setArray has been removed. Use BufferGeometry .setAttribute to replace/resize attribute buffers")},Ra.prototype.getArrays=function(){console.error("THREE.ExtrudeGeometry: .getArrays() has been removed.")},Ra.prototype.addShapeList=function(){console.error("THREE.ExtrudeGeometry: .addShapeList() has been removed.")},Ra.prototype.addShape=function(){console.error("THREE.ExtrudeGeometry: .addShape() has been removed.")},T0.prototype.dispose=function(){console.error("THREE.Scene: .dispose() has been removed.")},tg.prototype.onUpdate=function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this},Object.defineProperties(as.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},overdraw:{get:function(){console.warn("THREE.Material: .overdraw has been removed.")},set:function(){console.warn("THREE.Material: .overdraw has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new Un}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(A){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=A===D}},stencilMask:{get:function(){return console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask},set:function(A){console.warn("THREE."+this.type+": .stencilMask has been removed. Use .stencilFuncMask instead."),this.stencilFuncMask=A}},vertexTangents:{get:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")},set:function(){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}}),Object.defineProperties(xl.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(A){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=A}}}),fr.prototype.clearTarget=function(A,r,l,d){console.warn("THREE.WebGLRenderer: .clearTarget() has been deprecated. Use .setRenderTarget() and .clear() instead."),this.setRenderTarget(A),this.clear(r,l,d)},fr.prototype.animate=function(A){console.warn("THREE.WebGLRenderer: .animate() is now .setAnimationLoop()."),this.setAnimationLoop(A)},fr.prototype.getCurrentRenderTarget=function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},fr.prototype.getMaxAnisotropy=function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},fr.prototype.getPrecision=function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},fr.prototype.resetGLState=function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},fr.prototype.supportsFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},fr.prototype.supportsHalfFloatTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},fr.prototype.supportsStandardDerivatives=function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},fr.prototype.supportsCompressedTextureS3TC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},fr.prototype.supportsCompressedTexturePVRTC=function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},fr.prototype.supportsBlendMinMax=function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},fr.prototype.supportsVertexTextures=function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},fr.prototype.supportsInstancedArrays=function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},fr.prototype.enableScissorTest=function(A){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(A)},fr.prototype.initMaterial=function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},fr.prototype.addPrePlugin=function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},fr.prototype.addPostPlugin=function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},fr.prototype.updateShadowMap=function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},fr.prototype.setFaceCulling=function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")},fr.prototype.setTexture=function(){console.warn("THREE.WebGLRenderer: .setTexture() has been removed.")},fr.prototype.setTextureCube=function(){console.warn("THREE.WebGLRenderer: .setTextureCube() has been removed.")},fr.prototype.getActiveMipMapLevel=function(){return console.warn("THREE.WebGLRenderer: .getActiveMipMapLevel() is now .getActiveMipmapLevel()."),this.getActiveMipmapLevel()},Object.defineProperties(fr.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(A){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=A}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(A){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=A}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}},context:{get:function(){return console.warn("THREE.WebGLRenderer: .context has been removed. Use .getContext() instead."),this.getContext()}},vr:{get:function(){return console.warn("THREE.WebGLRenderer: .vr has been renamed to .xr"),this.xr}},gammaInput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead."),!1},set:function(){console.warn("THREE.WebGLRenderer: .gammaInput has been removed. Set the encoding for textures via Texture.encoding instead.")}},gammaOutput:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),!1},set:function(A){console.warn("THREE.WebGLRenderer: .gammaOutput has been removed. Set WebGLRenderer.outputEncoding instead."),this.outputEncoding=A===!0?Li:Qi}},toneMappingWhitePoint:{get:function(){return console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed."),1},set:function(){console.warn("THREE.WebGLRenderer: .toneMappingWhitePoint has been removed.")}},gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}}),Object.defineProperties(RE.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}});function S6(A,r,l){return console.warn("THREE.WebGLRenderTargetCube( width, height, options ) is now WebGLCubeRenderTarget( size, options )."),new v0(A,l)}Object.defineProperties(fo.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(A){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=A}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(A){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=A}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(A){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=A}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(A){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=A}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(A){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=A}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(A){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=A}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(A){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=A}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(A){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=A}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(A){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=A}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(A){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=A}}}),wx.prototype.load=function(A){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");const r=this;return new OM().load(A,function(d){r.setBuffer(d)}),this},GM.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},g0.prototype.updateCubeMap=function(A,r){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(A,r)},g0.prototype.clear=function(A,r,l,d){return console.warn("THREE.CubeCamera: .clear() is now .renderTarget.clear()."),this.renderTarget.clear(A,r,l,d)},ql.crossOrigin=void 0,ql.loadTexture=function(A,r,l,d){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");const v=new AM;v.setCrossOrigin(this.crossOrigin);const w=v.load(A,l,void 0,d);return r&&(w.mapping=r),w},ql.loadTextureCube=function(A,r,l,d){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");const v=new yM;v.setCrossOrigin(this.crossOrigin);const w=v.load(A,l,void 0,d);return r&&(w.mapping=r),w},ql.loadCompressedTexture=function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},ql.loadCompressedTextureCube=function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")};function T6(){console.error("THREE.CanvasRenderer has been removed")}function C6(){console.error("THREE.JSONLoader has been removed.")}const R6={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/jsm/utils/SceneUtils.js")}};function L6(){console.error("THREE.LensFlare has been moved to /examples/jsm/objects/Lensflare.js")}function P6(){return console.error("THREE.ParametricGeometry has been moved to /examples/jsm/geometries/ParametricGeometry.js"),new ui}function I6(){return console.error("THREE.TextGeometry has been moved to /examples/jsm/geometries/TextGeometry.js"),new ui}function O6(){console.error("THREE.FontLoader has been moved to /examples/jsm/loaders/FontLoader.js")}function D6(){console.error("THREE.Font has been moved to /examples/jsm/loaders/FontLoader.js")}function B6(){console.error("THREE.ImmediateRenderObject has been removed.")}typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:c}})),typeof window!="undefined"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=c),s.ACESFilmicToneMapping=he,s.AddEquation=N,s.AddOperation=_e,s.AdditiveAnimationBlendMode=$n,s.AdditiveBlending=j,s.AlphaFormat=q,s.AlwaysDepth=tt,s.AlwaysStencilFunc=Sw,s.AmbientLight=yx,s.AmbientLightProbe=BM,s.AnimationClip=Sp,s.AnimationLoader=mB,s.AnimationMixer=jM,s.AnimationObjectGroup=WM,s.AnimationUtils=Ar,s.ArcCurve=W1,s.ArrayCamera=M0,s.ArrowHelper=XB,s.Audio=wx,s.AudioAnalyser=GM,s.AudioContext=_x,s.AudioListener=bB,s.AudioLoader=OM,s.AxesHelper=l2,s.AxisHelper=A6,s.BackSide=T,s.BasicDepthPacking=Cs,s.BasicShadowMap=g,s.BinaryTextureLoader=M6,s.Bone=B0,s.BooleanKeyframeTrack=_u,s.BoundingBoxHelper=b6,s.Box2=bf,s.Box3=po,s.Box3Helper=WB,s.BoxBufferGeometry=yl,s.BoxGeometry=yl,s.BoxHelper=o2,s.BufferAttribute=Wi,s.BufferGeometry=ui,s.BufferGeometryLoader=RM,s.ByteType=Mn,s.Cache=Eu,s.Camera=rp,s.CameraHelper=VB,s.CanvasRenderer=T6,s.CanvasTexture=nM,s.CatmullRomCurve3=Y1,s.CineonToneMapping=ce,s.CircleBufferGeometry=cf,s.CircleGeometry=cf,s.ClampToEdgeWrapping=ye,s.Clock=UM,s.Color=Un,s.ColorKeyframeTrack=ux,s.CompressedTexture=H1,s.CompressedTextureLoader=gB,s.ConeBufferGeometry=uf,s.ConeGeometry=uf,s.CubeCamera=g0,s.CubeReflectionMapping=Z,s.CubeRefractionMapping=B,s.CubeTexture=Kh,s.CubeTextureLoader=yM,s.CubeUVReflectionMapping=X,s.CubeUVRefractionMapping=xe,s.CubicBezierCurve=j0,s.CubicBezierCurve3=Q1,s.CubicInterpolant=pM,s.CullFaceBack=p,s.CullFaceFront=m,s.CullFaceFrontBack=y,s.CullFaceNone=f,s.Curve=vo,s.CurvePath=sM,s.CustomBlending=te,s.CustomToneMapping=ie,s.CylinderBufferGeometry=lc,s.CylinderGeometry=lc,s.Cylindrical=FB,s.DataTexture=gu,s.DataTexture2DArray=b0,s.DataTexture3D=I1,s.DataTextureLoader=xM,s.DataUtils=YB,s.DecrementStencilOp=eu,s.DecrementWrapStencilOp=nu,s.DefaultLoadingManager=vM,s.DepthFormat=dt,s.DepthStencilFormat=Re,s.DepthTexture=S0,s.DirectionalLight=vx,s.DirectionalLightHelper=GB,s.DiscreteInterpolant=mM,s.DodecahedronBufferGeometry=hf,s.DodecahedronGeometry=hf,s.DoubleSide=P,s.DstAlphaFactor=we,s.DstColorFactor=ge,s.DynamicBufferAttribute=u6,s.DynamicCopyUsage=xI,s.DynamicDrawUsage=Bh,s.DynamicReadUsage=gI,s.EdgesGeometry=V1,s.EdgesHelper=_6,s.EllipseCurve=gp,s.EqualDepth=Ye,s.EqualStencilFunc=ou,s.EquirectangularReflectionMapping=S,s.EquirectangularRefractionMapping=R,s.Euler=fu,s.EventDispatcher=hl,s.ExtrudeBufferGeometry=Ra,s.ExtrudeGeometry=Ra,s.FaceColors=JB,s.FileLoader=La,s.FlatShading=D,s.Float16BufferAttribute=qw,s.Float32Attribute=y6,s.Float32BufferAttribute=ei,s.Float64Attribute=x6,s.Float64BufferAttribute=Yw,s.FloatType=xn,s.Fog=up,s.FogExp2=cp,s.Font=D6,s.FontLoader=O6,s.FramebufferTexture=tM,s.FrontSide=E,s.Frustum=sp,s.GLBufferAttribute=$M,s.GLSL1=bI,s.GLSL3=i1,s.GreaterDepth=Be,s.GreaterEqualDepth=Pe,s.GreaterEqualStencilFunc=dI,s.GreaterStencilFunc=Nr,s.GridHelper=i2,s.Group=oc,s.HalfFloatType=Zn,s.HemisphereLight=fx,s.HemisphereLightHelper=zB,s.HemisphereLightProbe=DM,s.IcosahedronBufferGeometry=df,s.IcosahedronGeometry=df,s.ImageBitmapLoader=IM,s.ImageLoader=Tp,s.ImageUtils=ql,s.ImmediateRenderObject=B6,s.IncrementStencilOp=Jc,s.IncrementWrapStencilOp=tu,s.InstancedBufferAttribute=vu,s.InstancedBufferGeometry=bx,s.InstancedInterleavedBuffer=XM,s.InstancedMesh=N1,s.Int16Attribute=p6,s.Int16BufferAttribute=Xw,s.Int32Attribute=g6,s.Int32BufferAttribute=$w,s.Int8Attribute=h6,s.Int8BufferAttribute=Vw,s.IntType=zn,s.InterleavedBuffer=mu,s.InterleavedBufferAttribute=ac,s.Interpolant=bl,s.InterpolateDiscrete=Ot,s.InterpolateLinear=Qt,s.InterpolateSmooth=_n,s.InvertStencilOp=iu,s.JSONLoader=C6,s.KeepStencilOp=wa,s.KeyframeTrack=Ko,s.LOD=kE,s.LatheBufferGeometry=pf,s.LatheGeometry=pf,s.Layers=i0,s.LensFlare=L6,s.LessDepth=rt,s.LessEqualDepth=vt,s.LessEqualStencilFunc=au,s.LessStencilFunc=su,s.Light=Zo,s.LightProbe=Rp,s.Line=Al,s.Line3=KM,s.LineBasicMaterial=cs,s.LineCurve=xp,s.LineCurve3=rM,s.LineDashedMaterial=lx,s.LineLoop=k1,s.LinePieces=KB,s.LineSegments=ro,s.LineStrip=QB,s.LinearEncoding=Qi,s.LinearFilter=ut,s.LinearInterpolant=cx,s.LinearMipMapLinearFilter=An,s.LinearMipMapNearestFilter=Tt,s.LinearMipmapLinearFilter=gn,s.LinearMipmapNearestFilter=St,s.LinearToneMapping=Oe,s.Loader=Xs,s.LoaderUtils=J0,s.LoadingManager=hx,s.LoopOnce=Ut,s.LoopPingPong=gt,s.LoopRepeat=Vt,s.LuminanceAlphaFormat=lt,s.LuminanceFormat=Ge,s.MOUSE=u,s.Material=as,s.MaterialLoader=CM,s.Math=Rw,s.MathUtils=Rw,s.Matrix3=es,s.Matrix4=Jn,s.MaxEquation=U,s.Mesh=$r,s.MeshBasicMaterial=vl,s.MeshDepthMaterial=w0,s.MeshDistanceMaterial=E0,s.MeshFaceMaterial=t6,s.MeshLambertMaterial=ox,s.MeshMatcapMaterial=ax,s.MeshNormalMaterial=sx,s.MeshPhongMaterial=ix,s.MeshPhysicalMaterial=nx,s.MeshStandardMaterial=Z0,s.MeshToonMaterial=rx,s.MinEquation=I,s.MirroredRepeatWrapping=nt,s.MixOperation=We,s.MultiMaterial=n6,s.MultiplyBlending=de,s.MultiplyOperation=Je,s.NearestFilter=at,s.NearestMipMapLinearFilter=Ct,s.NearestMipMapNearestFilter=wt,s.NearestMipmapLinearFilter=Lt,s.NearestMipmapNearestFilter=mt,s.NeverDepth=ze,s.NeverStencilFunc=ru,s.NoBlending=k,s.NoColors=ZB,s.NoToneMapping=Ee,s.NormalAnimationBlendMode=Yn,s.NormalBlending=W,s.NotEqualDepth=$e,s.NotEqualStencilFunc=fI,s.NumberKeyframeTrack=Ep,s.Object3D=ki,s.ObjectLoader=vB,s.ObjectSpaceNormalMap=Ls,s.OctahedronBufferGeometry=xu,s.OctahedronGeometry=xu,s.OneFactor=ee,s.OneMinusDstAlphaFactor=Ke,s.OneMinusDstColorFactor=me,s.OneMinusSrcAlphaFactor=Y,s.OneMinusSrcColorFactor=G,s.OrthographicCamera=op,s.PCFShadowMap=_,s.PCFSoftShadowMap=x,s.PMREMGenerator=L1,s.ParametricGeometry=P6,s.Particle=r6,s.ParticleBasicMaterial=a6,s.ParticleSystem=s6,s.ParticleSystemMaterial=l6,s.Path=Ap,s.PerspectiveCamera=qr,s.Plane=Ea,s.PlaneBufferGeometry=du,s.PlaneGeometry=du,s.PlaneHelper=jB,s.PointCloud=i6,s.PointCloudMaterial=o6,s.PointLight=gx,s.PointLightHelper=UB,s.Points=mp,s.PointsMaterial=yu,s.PolarGridHelper=HB,s.PolyhedronBufferGeometry=Sa,s.PolyhedronGeometry=Sa,s.PositionalAudio=wB,s.PropertyBinding=Xi,s.PropertyMixer=VM,s.QuadraticBezierCurve=X0,s.QuadraticBezierCurve3=$0,s.Quaternion=os,s.QuaternionKeyframeTrack=Af,s.QuaternionLinearInterpolant=gM,s.REVISION=c,s.RGBADepthPacking=Rs,s.RGBAFormat=Se,s.RGBAIntegerFormat=xt,s.RGBA_ASTC_10x10_Format=fe,s.RGBA_ASTC_10x5_Format=ae,s.RGBA_ASTC_10x6_Format=pe,s.RGBA_ASTC_10x8_Format=Ce,s.RGBA_ASTC_12x10_Format=He,s.RGBA_ASTC_12x12_Format=ot,s.RGBA_ASTC_4x4_Format=rn,s.RGBA_ASTC_5x4_Format=Rt,s.RGBA_ASTC_5x5_Format=yt,s.RGBA_ASTC_6x5_Format=Bt,s.RGBA_ASTC_6x6_Format=Ft,s.RGBA_ASTC_8x5_Format=Zt,s.RGBA_ASTC_8x6_Format=en,s.RGBA_ASTC_8x8_Format=Rn,s.RGBA_BPTC_Format=pt,s.RGBA_ETC2_EAC_Format=hn,s.RGBA_PVRTC_2BPPV1_Format=vn,s.RGBA_PVRTC_4BPPV1_Format=$t,s.RGBA_S3TC_DXT1_Format=Kt,s.RGBA_S3TC_DXT3_Format=Wt,s.RGBA_S3TC_DXT5_Format=bt,s.RGB_ETC1_Format=Jt,s.RGB_ETC2_Format=nn,s.RGB_PVRTC_2BPPV1_Format=on,s.RGB_PVRTC_4BPPV1_Format=jt,s.RGB_S3TC_DXT1_Format=Dt,s.RGFormat=ft,s.RGIntegerFormat=it,s.RawShaderMaterial=Jh,s.Ray=Jl,s.Raycaster=DB,s.RectAreaLight=xx,s.RedFormat=Ue,s.RedIntegerFormat=Xe,s.ReinhardToneMapping=Le,s.RepeatWrapping=Ie,s.ReplaceStencilOp=Zc,s.ReverseSubtractEquation=M,s.RingBufferGeometry=mf,s.RingGeometry=mf,s.Scene=T0,s.SceneUtils=R6,s.ShaderChunk=Bi,s.ShaderLib=Qo,s.ShaderMaterial=xl,s.ShadowMaterial=tx,s.Shape=Ta,s.ShapeBufferGeometry=Au,s.ShapeGeometry=Au,s.ShapePath=$B,s.ShapeUtils=Ca,s.ShortType=Cn,s.Skeleton=F0,s.SkeletonHelper=JM,s.SkinnedMesh=D0,s.SmoothShading=F,s.Sphere=Kl,s.SphereBufferGeometry=bu,s.SphereGeometry=bu,s.Spherical=BB,s.SphericalHarmonics3=Ax,s.SplineCurve=q0,s.SpotLight=px,s.SpotLightHelper=NB,s.Sprite=P0,s.SpriteMaterial=C0,s.SrcAlphaFactor=K,s.SrcAlphaSaturateFactor=De,s.SrcColorFactor=Q,s.StaticCopyUsage=yI,s.StaticDrawUsage=Dh,s.StaticReadUsage=mI,s.StereoCamera=xB,s.StreamCopyUsage=AI,s.StreamDrawUsage=pI,s.StreamReadUsage=vI,s.StringKeyframeTrack=wu,s.SubtractEquation=L,s.SubtractiveBlending=J,s.TOUCH=h,s.TangentSpaceNormalMap=Fr,s.TetrahedronBufferGeometry=gf,s.TetrahedronGeometry=gf,s.TextGeometry=I6,s.Texture=Xr,s.TextureLoader=AM,s.TorusBufferGeometry=vf,s.TorusGeometry=vf,s.TorusKnotBufferGeometry=yf,s.TorusKnotGeometry=yf,s.Triangle=Ur,s.TriangleFanDrawMode=jr,s.TriangleStripDrawMode=Rr,s.TrianglesDrawMode=vi,s.TubeBufferGeometry=xf,s.TubeGeometry=xf,s.UVMapping=V,s.Uint16Attribute=m6,s.Uint16BufferAttribute=o0,s.Uint32Attribute=v6,s.Uint32BufferAttribute=a0,s.Uint8Attribute=f6,s.Uint8BufferAttribute=Ww,s.Uint8ClampedAttribute=d6,s.Uint8ClampedBufferAttribute=jw,s.Uniform=tg,s.UniformsLib=Bn,s.UniformsUtils=Kw,s.UnsignedByteType=un,s.UnsignedInt248Type=be,s.UnsignedIntType=ai,s.UnsignedShort4444Type=Me,s.UnsignedShort5551Type=le,s.UnsignedShortType=wn,s.VSMShadowMap=b,s.Vector2=pn,s.Vector3=qe,s.Vector4=nr,s.VectorKeyframeTrack=Mp,s.Vertex=c6,s.VertexColors=e6,s.VideoTexture=eM,s.WebGL1Renderer=DE,s.WebGLCubeRenderTarget=v0,s.WebGLMultipleRenderTargets=Iw,s.WebGLMultisampleRenderTarget=Qm,s.WebGLRenderTarget=fo,s.WebGLRenderTargetCube=S6,s.WebGLRenderer=fr,s.WebGLUtils=LE,s.WireframeGeometry=ex,s.WireframeHelper=w6,s.WrapAroundEnding=Xn,s.XHRLoader=E6,s.ZeroCurvatureEnding=Tn,s.ZeroFactor=$,s.ZeroSlopeEnding=Ln,s.ZeroStencilOp=_a,s._SRGBAFormat=$m,s.sRGBEncoding=Li,Object.defineProperty(s,"__esModule",{value:!0})})},{}],58:[function(n,i,o){(function(){class s{static fromCubeTexture(h){let f=0;const p=new THREE.Vector3,m=new THREE.Vector3,y=new THREE.Color,g=[0,0,0,0,0,0,0,0,0],_=new THREE.SphericalHarmonics3,x=_.coefficients;for(let E=0;E<6;E++){const T=h.image[E],P=T.width,D=T.height,F=document.createElement("canvas");F.width=P,F.height=D;const k=F.getContext("2d");k.drawImage(T,0,0,P,D);const W=k.getImageData(0,0,P,D),j=W.data,J=W.width,de=2/J;for(let te=0,N=j.length;te<N;te+=4){y.setRGB(j[te]/255,j[te+1]/255,j[te+2]/255),c(y,h.encoding);const L=te/4,M=-1+(L%J+.5)*de,I=1-(Math.floor(L/J)+.5)*de;switch(E){case 0:p.set(-1,I,-M);break;case 1:p.set(1,I,M);break;case 2:p.set(-M,1,-I);break;case 3:p.set(-M,-1,I);break;case 4:p.set(-M,I,1);break;case 5:p.set(M,I,-1);break}const U=p.lengthSq(),$=4/(Math.sqrt(U)*U);f+=$,m.copy(p).normalize(),THREE.SphericalHarmonics3.getBasisAt(m,g);for(let ee=0;ee<9;ee++)x[ee].x+=g[ee]*y.r*$,x[ee].y+=g[ee]*y.g*$,x[ee].z+=g[ee]*y.b*$}}const b=4*Math.PI/f;for(let E=0;E<9;E++)x[E].x*=b,x[E].y*=b,x[E].z*=b;return new THREE.LightProbe(_)}static fromCubeRenderTarget(h,f){let p=0;const m=new THREE.Vector3,y=new THREE.Vector3,g=new THREE.Color,_=[0,0,0,0,0,0,0,0,0],x=new THREE.SphericalHarmonics3,b=x.coefficients;for(let T=0;T<6;T++){const P=f.width,D=new Uint8Array(P*P*4);h.readRenderTargetPixels(f,0,0,P,P,D,T);const F=2/P;for(let k=0,W=D.length;k<W;k+=4){g.setRGB(D[k]/255,D[k+1]/255,D[k+2]/255),c(g,f.texture.encoding);const j=k/4,J=-1+(j%P+.5)*F,de=1-(Math.floor(j/P)+.5)*F;switch(T){case 0:m.set(1,de,-J);break;case 1:m.set(-1,de,J);break;case 2:m.set(J,1,-de);break;case 3:m.set(J,-1,de);break;case 4:m.set(J,de,1);break;case 5:m.set(-J,de,-1);break}const te=m.lengthSq(),N=4/(Math.sqrt(te)*te);p+=N,y.copy(m).normalize(),THREE.SphericalHarmonics3.getBasisAt(y,_);for(let L=0;L<9;L++)b[L].x+=_[L]*g.r*N,b[L].y+=_[L]*g.g*N,b[L].z+=_[L]*g.b*N}}const E=4*Math.PI/p;for(let T=0;T<9;T++)b[T].x*=E,b[T].y*=E,b[T].z*=E;return new THREE.LightProbe(x)}}function c(u,h){switch(h){case THREE.sRGBEncoding:u.convertSRGBToLinear();break;case THREE.LinearEncoding:break;default:console.warn("WARNING: LightProbeGenerator convertColorToLinear() encountered an unsupported encoding.");break}return u}THREE.LightProbeGenerator=s})()},{}],59:[function(n,i,o){(function(){const s=new WeakMap;class c extends THREE.Loader{constructor(f){super(f),this.decoderPath="",this.decoderConfig={},this.decoderBinary=null,this.decoderPending=null,this.workerLimit=4,this.workerPool=[],this.workerNextTaskID=1,this.workerSourceURL="",this.defaultAttributeIDs={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"},this.defaultAttributeTypes={position:"Float32Array",normal:"Float32Array",color:"Float32Array",uv:"Float32Array"}}setDecoderPath(f){return this.decoderPath=f,this}setDecoderConfig(f){return this.decoderConfig=f,this}setWorkerLimit(f){return this.workerLimit=f,this}load(f,p,m,y){const g=new THREE.FileLoader(this.manager);g.setPath(this.path),g.setResponseType("arraybuffer"),g.setRequestHeader(this.requestHeader),g.setWithCredentials(this.withCredentials),g.load(f,_=>{const x={attributeIDs:this.defaultAttributeIDs,attributeTypes:this.defaultAttributeTypes,useUniqueIDs:!1};this.decodeGeometry(_,x).then(p).catch(y)},m,y)}decodeDracoFile(f,p,m,y){const g={attributeIDs:m||this.defaultAttributeIDs,attributeTypes:y||this.defaultAttributeTypes,useUniqueIDs:!!m};this.decodeGeometry(f,g).then(p)}decodeGeometry(f,p){for(const b in p.attributeTypes){const E=p.attributeTypes[b];E.BYTES_PER_ELEMENT!==void 0&&(p.attributeTypes[b]=E.name)}const m=JSON.stringify(p);if(s.has(f)){const b=s.get(f);if(b.key===m)return b.promise;if(f.byteLength===0)throw new Error("THREE.DRACOLoader: Unable to re-decode a buffer with different settings. Buffer has already been transferred.")}let y;const g=this.workerNextTaskID++,_=f.byteLength,x=this._getWorker(g,_).then(b=>(y=b,new Promise((E,T)=>{y._callbacks[g]={resolve:E,reject:T},y.postMessage({type:"decode",id:g,taskConfig:p,buffer:f},[f])}))).then(b=>this._createGeometry(b.geometry));return x.catch(()=>!0).then(()=>{y&&g&&this._releaseTask(y,g)}),s.set(f,{key:m,promise:x}),x}_createGeometry(f){const p=new THREE.BufferGeometry;f.index&&p.setIndex(new THREE.BufferAttribute(f.index.array,1));for(let m=0;m<f.attributes.length;m++){const y=f.attributes[m],g=y.name,_=y.array,x=y.itemSize;p.setAttribute(g,new THREE.BufferAttribute(_,x))}return p}_loadLibrary(f,p){const m=new THREE.FileLoader(this.manager);return m.setPath(this.decoderPath),m.setResponseType(p),m.setWithCredentials(this.withCredentials),new Promise((y,g)=>{m.load(f,y,void 0,g)})}preload(){return this._initDecoder(),this}_initDecoder(){if(this.decoderPending)return this.decoderPending;const f=typeof WebAssembly!="object"||this.decoderConfig.type==="js",p=[];return f?p.push(this._loadLibrary("draco_decoder.js","text")):(p.push(this._loadLibrary("draco_wasm_wrapper.js","text")),p.push(this._loadLibrary("draco_decoder.wasm","arraybuffer"))),this.decoderPending=Promise.all(p).then(m=>{const y=m[0];f||(this.decoderConfig.wasmBinary=m[1]);const g=u.toString(),_=["/* draco decoder */",y,"","/* worker */",g.substring(g.indexOf("{")+1,g.lastIndexOf("}"))].join(`
`);this.workerSourceURL=URL.createObjectURL(new Blob([_]))}),this.decoderPending}_getWorker(f,p){return this._initDecoder().then(()=>{if(this.workerPool.length<this.workerLimit){const y=new Worker(this.workerSourceURL);y._callbacks={},y._taskCosts={},y._taskLoad=0,y.postMessage({type:"init",decoderConfig:this.decoderConfig}),y.onmessage=function(g){const _=g.data;switch(_.type){case"decode":y._callbacks[_.id].resolve(_);break;case"error":y._callbacks[_.id].reject(_);break;default:console.error('THREE.DRACOLoader: Unexpected message, "'+_.type+'"')}},this.workerPool.push(y)}else this.workerPool.sort(function(y,g){return y._taskLoad>g._taskLoad?-1:1});const m=this.workerPool[this.workerPool.length-1];return m._taskCosts[f]=p,m._taskLoad+=p,m})}_releaseTask(f,p){f._taskLoad-=f._taskCosts[p],delete f._callbacks[p],delete f._taskCosts[p]}debug(){console.log("Task load: ",this.workerPool.map(f=>f._taskLoad))}dispose(){for(let f=0;f<this.workerPool.length;++f)this.workerPool[f].terminate();return this.workerPool.length=0,this}}function u(){let h,f;onmessage=function(_){const x=_.data;switch(x.type){case"init":h=x.decoderConfig,f=new Promise(function(T){h.onModuleLoaded=function(P){T({draco:P})},DracoDecoderModule(h)});break;case"decode":const b=x.buffer,E=x.taskConfig;f.then(T=>{const P=T.draco,D=new P.Decoder,F=new P.DecoderBuffer;F.Init(new Int8Array(b),b.byteLength);try{const k=p(P,D,F,E),W=k.attributes.map(j=>j.array.buffer);k.index&&W.push(k.index.array.buffer),self.postMessage({type:"decode",id:x.id,geometry:k},W)}catch(k){console.error(k),self.postMessage({type:"error",id:x.id,error:k.message})}finally{P.destroy(F),P.destroy(D)}});break}};function p(_,x,b,E){const T=E.attributeIDs,P=E.attributeTypes;let D,F;const k=x.GetEncodedGeometryType(b);if(k===_.TRIANGULAR_MESH)D=new _.Mesh,F=x.DecodeBufferToMesh(b,D);else if(k===_.POINT_CLOUD)D=new _.PointCloud,F=x.DecodeBufferToPointCloud(b,D);else throw new Error("THREE.DRACOLoader: Unexpected geometry type.");if(!F.ok()||D.ptr===0)throw new Error("THREE.DRACOLoader: Decoding failed: "+F.error_msg());const W={index:null,attributes:[]};for(const j in T){const J=self[P[j]];let de,te;if(E.useUniqueIDs)te=T[j],de=x.GetAttributeByUniqueId(D,te);else{if(te=x.GetAttributeId(D,_[T[j]]),te===-1)continue;de=x.GetAttribute(D,te)}W.attributes.push(y(_,x,D,j,J,de))}return k===_.TRIANGULAR_MESH&&(W.index=m(_,x,D)),_.destroy(D),W}function m(_,x,b){const T=b.num_faces()*3,P=T*4,D=_._malloc(P);x.GetTrianglesUInt32Array(b,P,D);const F=new Uint32Array(_.HEAPF32.buffer,D,T).slice();return _._free(D),{array:F,itemSize:1}}function y(_,x,b,E,T,P){const D=P.num_components(),k=b.num_points()*D,W=k*T.BYTES_PER_ELEMENT,j=g(_,T),J=_._malloc(W);x.GetAttributeDataArrayForAllPoints(b,P,j,W,J);const de=new T(_.HEAPF32.buffer,J,k).slice();return _._free(J),{name:E,array:de,itemSize:D}}function g(_,x){switch(x){case Float32Array:return _.DT_FLOAT32;case Int8Array:return _.DT_INT8;case Int16Array:return _.DT_INT16;case Int32Array:return _.DT_INT32;case Uint8Array:return _.DT_UINT8;case Uint16Array:return _.DT_UINT16;case Uint32Array:return _.DT_UINT32}}}THREE.DRACOLoader=c})()},{}],60:[function(n,i,o){(function(){class s extends THREE.Loader{constructor(_e){super(_e),this.dracoLoader=null,this.ktx2Loader=null,this.meshoptDecoder=null,this.pluginCallbacks=[],this.register(function(Ee){return new p(Ee)}),this.register(function(Ee){return new b(Ee)}),this.register(function(Ee){return new E(Ee)}),this.register(function(Ee){return new m(Ee)}),this.register(function(Ee){return new y(Ee)}),this.register(function(Ee){return new g(Ee)}),this.register(function(Ee){return new _(Ee)}),this.register(function(Ee){return new x(Ee)}),this.register(function(Ee){return new h(Ee)}),this.register(function(Ee){return new T(Ee)})}load(_e,Ee,Oe,Le){const ce=this;let he;this.resourcePath!==""?he=this.resourcePath:this.path!==""?he=this.path:he=THREE.LoaderUtils.extractUrlBase(_e),this.manager.itemStart(_e);const ie=function(Z){Le?Le(Z):console.error(Z),ce.manager.itemError(_e),ce.manager.itemEnd(_e)},V=new THREE.FileLoader(this.manager);V.setPath(this.path),V.setResponseType("arraybuffer"),V.setRequestHeader(this.requestHeader),V.setWithCredentials(this.withCredentials),V.load(_e,function(Z){try{ce.parse(Z,he,function(B){Ee(B),ce.manager.itemEnd(_e)},ie)}catch(B){ie(B)}},Oe,ie)}setDRACOLoader(_e){return this.dracoLoader=_e,this}setDDSLoader(){throw new Error('THREE.GLTFLoader: "MSFT_texture_dds" no longer supported. Please update to "KHR_texture_basisu".')}setKTX2Loader(_e){return this.ktx2Loader=_e,this}setMeshoptDecoder(_e){return this.meshoptDecoder=_e,this}register(_e){return this.pluginCallbacks.indexOf(_e)===-1&&this.pluginCallbacks.push(_e),this}unregister(_e){return this.pluginCallbacks.indexOf(_e)!==-1&&this.pluginCallbacks.splice(this.pluginCallbacks.indexOf(_e),1),this}parse(_e,Ee,Oe,Le){let ce;const he={},ie={};if(typeof _e=="string")ce=_e;else if(THREE.LoaderUtils.decodeText(new Uint8Array(_e,0,4))===P){try{he[u.KHR_BINARY_GLTF]=new k(_e)}catch(S){Le&&Le(S);return}ce=he[u.KHR_BINARY_GLTF].content}else ce=THREE.LoaderUtils.decodeText(new Uint8Array(_e));const V=JSON.parse(ce);if(V.asset===void 0||V.asset.version[0]<2){Le&&Le(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported."));return}const Z=new Ye(V,{path:Ee||this.resourcePath||"",crossOrigin:this.crossOrigin,requestHeader:this.requestHeader,manager:this.manager,ktx2Loader:this.ktx2Loader,meshoptDecoder:this.meshoptDecoder});Z.fileLoader.setRequestHeader(this.requestHeader);for(let B=0;B<this.pluginCallbacks.length;B++){const S=this.pluginCallbacks[B](Z);ie[S.name]=S,he[S.name]=!0}if(V.extensionsUsed)for(let B=0;B<V.extensionsUsed.length;++B){const S=V.extensionsUsed[B],R=V.extensionsRequired||[];switch(S){case u.KHR_MATERIALS_UNLIT:he[S]=new f;break;case u.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:he[S]=new de;break;case u.KHR_DRACO_MESH_COMPRESSION:he[S]=new W(V,this.dracoLoader);break;case u.KHR_TEXTURE_TRANSFORM:he[S]=new j;break;case u.KHR_MESH_QUANTIZATION:he[S]=new te;break;default:R.indexOf(S)>=0&&ie[S]===void 0&&console.warn('THREE.GLTFLoader: Unknown extension "'+S+'".')}}Z.setExtensions(he),Z.setPlugins(ie),Z.parse(Oe,Le)}parseAsync(_e,Ee){const Oe=this;return new Promise(function(Le,ce){Oe.parse(_e,Ee,Le,ce)})}}function c(){let We={};return{get:function(_e){return We[_e]},add:function(_e,Ee){We[_e]=Ee},remove:function(_e){delete We[_e]},removeAll:function(){We={}}}}const u={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS_PUNCTUAL:"KHR_lights_punctual",KHR_MATERIALS_CLEARCOAT:"KHR_materials_clearcoat",KHR_MATERIALS_IOR:"KHR_materials_ior",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_SHEEN:"KHR_materials_sheen",KHR_MATERIALS_SPECULAR:"KHR_materials_specular",KHR_MATERIALS_TRANSMISSION:"KHR_materials_transmission",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",KHR_MATERIALS_VOLUME:"KHR_materials_volume",KHR_TEXTURE_BASISU:"KHR_texture_basisu",KHR_TEXTURE_TRANSFORM:"KHR_texture_transform",KHR_MESH_QUANTIZATION:"KHR_mesh_quantization",EXT_TEXTURE_WEBP:"EXT_texture_webp",EXT_MESHOPT_COMPRESSION:"EXT_meshopt_compression"};class h{constructor(_e){this.parser=_e,this.name=u.KHR_LIGHTS_PUNCTUAL,this.cache={refs:{},uses:{}}}_markDefs(){const _e=this.parser,Ee=this.parser.json.nodes||[];for(let Oe=0,Le=Ee.length;Oe<Le;Oe++){const ce=Ee[Oe];ce.extensions&&ce.extensions[this.name]&&ce.extensions[this.name].light!==void 0&&_e._addNodeRef(this.cache,ce.extensions[this.name].light)}}_loadLight(_e){const Ee=this.parser,Oe="light:"+_e;let Le=Ee.cache.get(Oe);if(Le)return Le;const ce=Ee.json,V=((ce.extensions&&ce.extensions[this.name]||{}).lights||[])[_e];let Z;const B=new THREE.Color(16777215);V.color!==void 0&&B.fromArray(V.color);const S=V.range!==void 0?V.range:0;switch(V.type){case"directional":Z=new THREE.DirectionalLight(B),Z.target.position.set(0,0,-1),Z.add(Z.target);break;case"point":Z=new THREE.PointLight(B),Z.distance=S;break;case"spot":Z=new THREE.SpotLight(B),Z.distance=S,V.spot=V.spot||{},V.spot.innerConeAngle=V.spot.innerConeAngle!==void 0?V.spot.innerConeAngle:0,V.spot.outerConeAngle=V.spot.outerConeAngle!==void 0?V.spot.outerConeAngle:Math.PI/4,Z.angle=V.spot.outerConeAngle,Z.penumbra=1-V.spot.innerConeAngle/V.spot.outerConeAngle,Z.target.position.set(0,0,-1),Z.add(Z.target);break;default:throw new Error("THREE.GLTFLoader: Unexpected light type: "+V.type)}return Z.position.set(0,0,0),Z.decay=2,V.intensity!==void 0&&(Z.intensity=V.intensity),Z.name=Ee.createUniqueName(V.name||"light_"+_e),Le=Promise.resolve(Z),Ee.cache.add(Oe,Le),Le}createNodeAttachment(_e){const Ee=this,Oe=this.parser,ce=Oe.json.nodes[_e],ie=(ce.extensions&&ce.extensions[this.name]||{}).light;return ie===void 0?null:this._loadLight(ie).then(function(V){return Oe._getNodeRef(Ee.cache,ie,V)})}}class f{constructor(){this.name=u.KHR_MATERIALS_UNLIT}getMaterialType(){return THREE.MeshBasicMaterial}extendParams(_e,Ee,Oe){const Le=[];_e.color=new THREE.Color(1,1,1),_e.opacity=1;const ce=Ee.pbrMetallicRoughness;if(ce){if(Array.isArray(ce.baseColorFactor)){const he=ce.baseColorFactor;_e.color.fromArray(he),_e.opacity=he[3]}ce.baseColorTexture!==void 0&&Le.push(Oe.assignTexture(_e,"map",ce.baseColorTexture))}return Promise.all(Le)}}class p{constructor(_e){this.parser=_e,this.name=u.KHR_MATERIALS_CLEARCOAT}getMaterialType(_e){const Oe=this.parser.json.materials[_e];return!Oe.extensions||!Oe.extensions[this.name]?null:THREE.MeshPhysicalMaterial}extendMaterialParams(_e,Ee){const Oe=this.parser,Le=Oe.json.materials[_e];if(!Le.extensions||!Le.extensions[this.name])return Promise.resolve();const ce=[],he=Le.extensions[this.name];if(he.clearcoatFactor!==void 0&&(Ee.clearcoat=he.clearcoatFactor),he.clearcoatTexture!==void 0&&ce.push(Oe.assignTexture(Ee,"clearcoatMap",he.clearcoatTexture)),he.clearcoatRoughnessFactor!==void 0&&(Ee.clearcoatRoughness=he.clearcoatRoughnessFactor),he.clearcoatRoughnessTexture!==void 0&&ce.push(Oe.assignTexture(Ee,"clearcoatRoughnessMap",he.clearcoatRoughnessTexture)),he.clearcoatNormalTexture!==void 0&&(ce.push(Oe.assignTexture(Ee,"clearcoatNormalMap",he.clearcoatNormalTexture)),he.clearcoatNormalTexture.scale!==void 0)){const ie=he.clearcoatNormalTexture.scale;Ee.clearcoatNormalScale=new THREE.Vector2(ie,ie)}return Promise.all(ce)}}class m{constructor(_e){this.parser=_e,this.name=u.KHR_MATERIALS_SHEEN}getMaterialType(_e){const Oe=this.parser.json.materials[_e];return!Oe.extensions||!Oe.extensions[this.name]?null:THREE.MeshPhysicalMaterial}extendMaterialParams(_e,Ee){const Oe=this.parser,Le=Oe.json.materials[_e];if(!Le.extensions||!Le.extensions[this.name])return Promise.resolve();const ce=[];Ee.sheenColor=new THREE.Color(0,0,0),Ee.sheenRoughness=0,Ee.sheen=1;const he=Le.extensions[this.name];return he.sheenColorFactor!==void 0&&Ee.sheenColor.fromArray(he.sheenColorFactor),he.sheenRoughnessFactor!==void 0&&(Ee.sheenRoughness=he.sheenRoughnessFactor),he.sheenColorTexture!==void 0&&ce.push(Oe.assignTexture(Ee,"sheenColorMap",he.sheenColorTexture)),he.sheenRoughnessTexture!==void 0&&ce.push(Oe.assignTexture(Ee,"sheenRoughnessMap",he.sheenRoughnessTexture)),Promise.all(ce)}}class y{constructor(_e){this.parser=_e,this.name=u.KHR_MATERIALS_TRANSMISSION}getMaterialType(_e){const Oe=this.parser.json.materials[_e];return!Oe.extensions||!Oe.extensions[this.name]?null:THREE.MeshPhysicalMaterial}extendMaterialParams(_e,Ee){const Oe=this.parser,Le=Oe.json.materials[_e];if(!Le.extensions||!Le.extensions[this.name])return Promise.resolve();const ce=[],he=Le.extensions[this.name];return he.transmissionFactor!==void 0&&(Ee.transmission=he.transmissionFactor),he.transmissionTexture!==void 0&&ce.push(Oe.assignTexture(Ee,"transmissionMap",he.transmissionTexture)),Promise.all(ce)}}class g{constructor(_e){this.parser=_e,this.name=u.KHR_MATERIALS_VOLUME}getMaterialType(_e){const Oe=this.parser.json.materials[_e];return!Oe.extensions||!Oe.extensions[this.name]?null:THREE.MeshPhysicalMaterial}extendMaterialParams(_e,Ee){const Oe=this.parser,Le=Oe.json.materials[_e];if(!Le.extensions||!Le.extensions[this.name])return Promise.resolve();const ce=[],he=Le.extensions[this.name];Ee.thickness=he.thicknessFactor!==void 0?he.thicknessFactor:0,he.thicknessTexture!==void 0&&ce.push(Oe.assignTexture(Ee,"thicknessMap",he.thicknessTexture)),Ee.attenuationDistance=he.attenuationDistance||0;const ie=he.attenuationColor||[1,1,1];return Ee.attenuationColor=new THREE.Color(ie[0],ie[1],ie[2]),Promise.all(ce)}}class _{constructor(_e){this.parser=_e,this.name=u.KHR_MATERIALS_IOR}getMaterialType(_e){const Oe=this.parser.json.materials[_e];return!Oe.extensions||!Oe.extensions[this.name]?null:THREE.MeshPhysicalMaterial}extendMaterialParams(_e,Ee){const Le=this.parser.json.materials[_e];if(!Le.extensions||!Le.extensions[this.name])return Promise.resolve();const ce=Le.extensions[this.name];return Ee.ior=ce.ior!==void 0?ce.ior:1.5,Promise.resolve()}}class x{constructor(_e){this.parser=_e,this.name=u.KHR_MATERIALS_SPECULAR}getMaterialType(_e){const Oe=this.parser.json.materials[_e];return!Oe.extensions||!Oe.extensions[this.name]?null:THREE.MeshPhysicalMaterial}extendMaterialParams(_e,Ee){const Oe=this.parser,Le=Oe.json.materials[_e];if(!Le.extensions||!Le.extensions[this.name])return Promise.resolve();const ce=[],he=Le.extensions[this.name];Ee.specularIntensity=he.specularFactor!==void 0?he.specularFactor:1,he.specularTexture!==void 0&&ce.push(Oe.assignTexture(Ee,"specularIntensityMap",he.specularTexture));const ie=he.specularColorFactor||[1,1,1];return Ee.specularColor=new THREE.Color(ie[0],ie[1],ie[2]),he.specularColorTexture!==void 0&&ce.push(Oe.assignTexture(Ee,"specularColorMap",he.specularColorTexture).then(function(V){V.encoding=THREE.sRGBEncoding})),Promise.all(ce)}}class b{constructor(_e){this.parser=_e,this.name=u.KHR_TEXTURE_BASISU}loadTexture(_e){const Ee=this.parser,Oe=Ee.json,Le=Oe.textures[_e];if(!Le.extensions||!Le.extensions[this.name])return null;const ce=Le.extensions[this.name],he=Oe.images[ce.source],ie=Ee.options.ktx2Loader;if(!ie){if(Oe.extensionsRequired&&Oe.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setKTX2Loader must be called before loading KTX2 textures");return null}return Ee.loadTextureImage(_e,he,ie)}}class E{constructor(_e){this.parser=_e,this.name=u.EXT_TEXTURE_WEBP,this.isSupported=null}loadTexture(_e){const Ee=this.name,Oe=this.parser,Le=Oe.json,ce=Le.textures[_e];if(!ce.extensions||!ce.extensions[Ee])return null;const he=ce.extensions[Ee],ie=Le.images[he.source];let V=Oe.textureLoader;if(ie.uri){const Z=Oe.options.manager.getHandler(ie.uri);Z!==null&&(V=Z)}return this.detectSupport().then(function(Z){if(Z)return Oe.loadTextureImage(_e,ie,V);if(Le.extensionsRequired&&Le.extensionsRequired.indexOf(Ee)>=0)throw new Error("THREE.GLTFLoader: WebP required by asset but unsupported.");return Oe.loadTexture(_e)})}detectSupport(){return this.isSupported||(this.isSupported=new Promise(function(_e){const Ee=new Image;Ee.src="data:image/webp;base64,UklGRiIAAABXRUJQVlA4IBYAAAAwAQCdASoBAAEADsD+JaQAA3AAAAAA",Ee.onload=Ee.onerror=function(){_e(Ee.height===1)}})),this.isSupported}}class T{constructor(_e){this.name=u.EXT_MESHOPT_COMPRESSION,this.parser=_e}loadBufferView(_e){const Ee=this.parser.json,Oe=Ee.bufferViews[_e];if(Oe.extensions&&Oe.extensions[this.name]){const Le=Oe.extensions[this.name],ce=this.parser.getDependency("buffer",Le.buffer),he=this.parser.options.meshoptDecoder;if(!he||!he.supported){if(Ee.extensionsRequired&&Ee.extensionsRequired.indexOf(this.name)>=0)throw new Error("THREE.GLTFLoader: setMeshoptDecoder must be called before loading compressed files");return null}return Promise.all([ce,he.ready]).then(function(ie){const V=Le.byteOffset||0,Z=Le.byteLength||0,B=Le.count,S=Le.byteStride,R=new ArrayBuffer(B*S),X=new Uint8Array(ie[0],V,Z);return he.decodeGltfBuffer(new Uint8Array(R),B,S,X,Le.mode,Le.filter),R})}else return null}}const P="glTF",D=12,F={JSON:1313821514,BIN:5130562};class k{constructor(_e){this.name=u.KHR_BINARY_GLTF,this.content=null,this.body=null;const Ee=new DataView(_e,0,D);if(this.header={magic:THREE.LoaderUtils.decodeText(new Uint8Array(_e.slice(0,4))),version:Ee.getUint32(4,!0),length:Ee.getUint32(8,!0)},this.header.magic!==P)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");if(this.header.version<2)throw new Error("THREE.GLTFLoader: Legacy binary file detected.");const Oe=this.header.length-D,Le=new DataView(_e,D);let ce=0;for(;ce<Oe;){const he=Le.getUint32(ce,!0);ce+=4;const ie=Le.getUint32(ce,!0);if(ce+=4,ie===F.JSON){const V=new Uint8Array(_e,D+ce,he);this.content=THREE.LoaderUtils.decodeText(V)}else if(ie===F.BIN){const V=D+ce;this.body=_e.slice(V,V+he)}ce+=he}if(this.content===null)throw new Error("THREE.GLTFLoader: JSON content not found.")}}class W{constructor(_e,Ee){if(!Ee)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=u.KHR_DRACO_MESH_COMPRESSION,this.json=_e,this.dracoLoader=Ee,this.dracoLoader.preload()}decodePrimitive(_e,Ee){const Oe=this.json,Le=this.dracoLoader,ce=_e.extensions[this.name].bufferView,he=_e.extensions[this.name].attributes,ie={},V={},Z={};for(const B in he){const S=G[B]||B.toLowerCase();ie[S]=he[B]}for(const B in _e.attributes){const S=G[B]||B.toLowerCase();if(he[B]!==void 0){const R=Oe.accessors[_e.attributes[B]],X=U[R.componentType];Z[S]=X,V[S]=R.normalized===!0}}return Ee.getDependency("bufferView",ce).then(function(B){return new Promise(function(S){Le.decodeDracoFile(B,function(R){for(const X in R.attributes){const xe=R.attributes[X],Ie=V[X];Ie!==void 0&&(xe.normalized=Ie)}S(R)},ie,Z)})})}}class j{constructor(){this.name=u.KHR_TEXTURE_TRANSFORM}extendTexture(_e,Ee){return Ee.texCoord!==void 0&&console.warn('THREE.GLTFLoader: Custom UV sets in "'+this.name+'" extension not yet supported.'),Ee.offset===void 0&&Ee.rotation===void 0&&Ee.scale===void 0||(_e=_e.clone(),Ee.offset!==void 0&&_e.offset.fromArray(Ee.offset),Ee.rotation!==void 0&&(_e.rotation=Ee.rotation),Ee.scale!==void 0&&_e.repeat.fromArray(Ee.scale),_e.needsUpdate=!0),_e}}class J extends THREE.MeshStandardMaterial{constructor(_e){super(),this.isGLTFSpecularGlossinessMaterial=!0;const Ee=["#ifdef USE_SPECULARMAP","	uniform sampler2D specularMap;","#endif"].join(`
`),Oe=["#ifdef USE_GLOSSINESSMAP","	uniform sampler2D glossinessMap;","#endif"].join(`
`),Le=["vec3 specularFactor = specular;","#ifdef USE_SPECULARMAP","	vec4 texelSpecular = texture2D( specularMap, vUv );","	// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture","	specularFactor *= texelSpecular.rgb;","#endif"].join(`
`),ce=["float glossinessFactor = glossiness;","#ifdef USE_GLOSSINESSMAP","	vec4 texelGlossiness = texture2D( glossinessMap, vUv );","	// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture","	glossinessFactor *= texelGlossiness.a;","#endif"].join(`
`),he=["PhysicalMaterial material;","material.diffuseColor = diffuseColor.rgb * ( 1. - max( specularFactor.r, max( specularFactor.g, specularFactor.b ) ) );","vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );","float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );","material.roughness = max( 1.0 - glossinessFactor, 0.0525 ); // 0.0525 corresponds to the base mip of a 256 cubemap.","material.roughness += geometryRoughness;","material.roughness = min( material.roughness, 1.0 );","material.specularColor = specularFactor;"].join(`
`),ie={specular:{value:new THREE.Color().setHex(16777215)},glossiness:{value:1},specularMap:{value:null},glossinessMap:{value:null}};this._extraUniforms=ie,this.onBeforeCompile=function(V){for(const Z in ie)V.uniforms[Z]=ie[Z];V.fragmentShader=V.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>",Ee).replace("#include <metalnessmap_pars_fragment>",Oe).replace("#include <roughnessmap_fragment>",Le).replace("#include <metalnessmap_fragment>",ce).replace("#include <lights_physical_fragment>",he)},Object.defineProperties(this,{specular:{get:function(){return ie.specular.value},set:function(V){ie.specular.value=V}},specularMap:{get:function(){return ie.specularMap.value},set:function(V){ie.specularMap.value=V,V?this.defines.USE_SPECULARMAP="":delete this.defines.USE_SPECULARMAP}},glossiness:{get:function(){return ie.glossiness.value},set:function(V){ie.glossiness.value=V}},glossinessMap:{get:function(){return ie.glossinessMap.value},set:function(V){ie.glossinessMap.value=V,V?(this.defines.USE_GLOSSINESSMAP="",this.defines.USE_UV=""):(delete this.defines.USE_GLOSSINESSMAP,delete this.defines.USE_UV)}}}),delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this.setValues(_e)}copy(_e){return super.copy(_e),this.specularMap=_e.specularMap,this.specular.copy(_e.specular),this.glossinessMap=_e.glossinessMap,this.glossiness=_e.glossiness,delete this.metalness,delete this.roughness,delete this.metalnessMap,delete this.roughnessMap,this}}class de{constructor(){this.name=u.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,this.specularGlossinessParams=["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","normalMapType","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"]}getMaterialType(){return J}extendParams(_e,Ee,Oe){const Le=Ee.extensions[this.name];_e.color=new THREE.Color(1,1,1),_e.opacity=1;const ce=[];if(Array.isArray(Le.diffuseFactor)){const he=Le.diffuseFactor;_e.color.fromArray(he),_e.opacity=he[3]}if(Le.diffuseTexture!==void 0&&ce.push(Oe.assignTexture(_e,"map",Le.diffuseTexture)),_e.emissive=new THREE.Color(0,0,0),_e.glossiness=Le.glossinessFactor!==void 0?Le.glossinessFactor:1,_e.specular=new THREE.Color(1,1,1),Array.isArray(Le.specularFactor)&&_e.specular.fromArray(Le.specularFactor),Le.specularGlossinessTexture!==void 0){const he=Le.specularGlossinessTexture;ce.push(Oe.assignTexture(_e,"glossinessMap",he)),ce.push(Oe.assignTexture(_e,"specularMap",he))}return Promise.all(ce)}createMaterial(_e){const Ee=new J(_e);return Ee.fog=!0,Ee.color=_e.color,Ee.map=_e.map===void 0?null:_e.map,Ee.lightMap=null,Ee.lightMapIntensity=1,Ee.aoMap=_e.aoMap===void 0?null:_e.aoMap,Ee.aoMapIntensity=1,Ee.emissive=_e.emissive,Ee.emissiveIntensity=1,Ee.emissiveMap=_e.emissiveMap===void 0?null:_e.emissiveMap,Ee.bumpMap=_e.bumpMap===void 0?null:_e.bumpMap,Ee.bumpScale=1,Ee.normalMap=_e.normalMap===void 0?null:_e.normalMap,Ee.normalMapType=THREE.TangentSpaceNormalMap,_e.normalScale&&(Ee.normalScale=_e.normalScale),Ee.displacementMap=null,Ee.displacementScale=1,Ee.displacementBias=0,Ee.specularMap=_e.specularMap===void 0?null:_e.specularMap,Ee.specular=_e.specular,Ee.glossinessMap=_e.glossinessMap===void 0?null:_e.glossinessMap,Ee.glossiness=_e.glossiness,Ee.alphaMap=null,Ee.envMap=_e.envMap===void 0?null:_e.envMap,Ee.envMapIntensity=1,Ee.refractionRatio=.98,Ee}}class te{constructor(){this.name=u.KHR_MESH_QUANTIZATION}}class N extends THREE.Interpolant{constructor(_e,Ee,Oe,Le){super(_e,Ee,Oe,Le)}copySampleValue_(_e){const Ee=this.resultBuffer,Oe=this.sampleValues,Le=this.valueSize,ce=_e*Le*3+Le;for(let he=0;he!==Le;he++)Ee[he]=Oe[ce+he];return Ee}}N.prototype.beforeStart_=N.prototype.copySampleValue_,N.prototype.afterEnd_=N.prototype.copySampleValue_,N.prototype.interpolate_=function(We,_e,Ee,Oe){const Le=this.resultBuffer,ce=this.sampleValues,he=this.valueSize,ie=he*2,V=he*3,Z=Oe-_e,B=(Ee-_e)/Z,S=B*B,R=S*B,X=We*V,xe=X-V,Ie=-2*R+3*S,ye=R-S,nt=1-Ie,at=ye-S+B;for(let mt=0;mt!==he;mt++){const wt=ce[xe+mt+he],Lt=ce[xe+mt+ie]*Z,Ct=ce[X+mt+he],ut=ce[X+mt]*Z;Le[mt]=nt*wt+at*Lt+Ie*Ct+ye*ut}return Le};const L=new THREE.Quaternion;class M extends N{interpolate_(_e,Ee,Oe,Le){const ce=super.interpolate_(_e,Ee,Oe,Le);return L.fromArray(ce).normalize().toArray(ce),ce}}const I={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},U={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},$={9728:THREE.NearestFilter,9729:THREE.LinearFilter,9984:THREE.NearestMipmapNearestFilter,9985:THREE.LinearMipmapNearestFilter,9986:THREE.NearestMipmapLinearFilter,9987:THREE.LinearMipmapLinearFilter},ee={33071:THREE.ClampToEdgeWrapping,33648:THREE.MirroredRepeatWrapping,10497:THREE.RepeatWrapping},Q={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},G={POSITION:"position",NORMAL:"normal",TANGENT:"tangent",TEXCOORD_0:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",WEIGHTS_0:"skinWeight",JOINTS_0:"skinIndex"},K={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Y={CUBICSPLINE:void 0,LINEAR:THREE.InterpolateLinear,STEP:THREE.InterpolateDiscrete},we={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};function Ke(We){return We.DefaultMaterial===void 0&&(We.DefaultMaterial=new THREE.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:THREE.FrontSide})),We.DefaultMaterial}function ge(We,_e,Ee){for(const Oe in Ee.extensions)We[Oe]===void 0&&(_e.userData.gltfExtensions=_e.userData.gltfExtensions||{},_e.userData.gltfExtensions[Oe]=Ee.extensions[Oe])}function me(We,_e){_e.extras!==void 0&&(typeof _e.extras=="object"?Object.assign(We.userData,_e.extras):console.warn("THREE.GLTFLoader: Ignoring primitive type .extras, "+_e.extras))}function De(We,_e,Ee){let Oe=!1,Le=!1;for(let ie=0,V=_e.length;ie<V;ie++){const Z=_e[ie];if(Z.POSITION!==void 0&&(Oe=!0),Z.NORMAL!==void 0&&(Le=!0),Oe&&Le)break}if(!Oe&&!Le)return Promise.resolve(We);const ce=[],he=[];for(let ie=0,V=_e.length;ie<V;ie++){const Z=_e[ie];if(Oe){const B=Z.POSITION!==void 0?Ee.getDependency("accessor",Z.POSITION):We.attributes.position;ce.push(B)}if(Le){const B=Z.NORMAL!==void 0?Ee.getDependency("accessor",Z.NORMAL):We.attributes.normal;he.push(B)}}return Promise.all([Promise.all(ce),Promise.all(he)]).then(function(ie){const V=ie[0],Z=ie[1];return Oe&&(We.morphAttributes.position=V),Le&&(We.morphAttributes.normal=Z),We.morphTargetsRelative=!0,We})}function ze(We,_e){if(We.updateMorphTargets(),_e.weights!==void 0)for(let Ee=0,Oe=_e.weights.length;Ee<Oe;Ee++)We.morphTargetInfluences[Ee]=_e.weights[Ee];if(_e.extras&&Array.isArray(_e.extras.targetNames)){const Ee=_e.extras.targetNames;if(We.morphTargetInfluences.length===Ee.length){We.morphTargetDictionary={};for(let Oe=0,Le=Ee.length;Oe<Le;Oe++)We.morphTargetDictionary[Ee[Oe]]=Oe}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function tt(We){const _e=We.extensions&&We.extensions[u.KHR_DRACO_MESH_COMPRESSION];let Ee;return _e?Ee="draco:"+_e.bufferView+":"+_e.indices+":"+rt(_e.attributes):Ee=We.indices+":"+rt(We.attributes)+":"+We.mode,Ee}function rt(We){let _e="";const Ee=Object.keys(We).sort();for(let Oe=0,Le=Ee.length;Oe<Le;Oe++)_e+=Ee[Oe]+":"+We[Ee[Oe]]+";";return _e}function vt(We){switch(We){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:throw new Error("THREE.GLTFLoader: Unsupported normalized accessor component type.")}}class Ye{constructor(_e={},Ee={}){this.json=_e,this.extensions={},this.plugins={},this.options=Ee,this.cache=new c,this.associations=new Map,this.primitiveCache={},this.meshCache={refs:{},uses:{}},this.cameraCache={refs:{},uses:{}},this.lightCache={refs:{},uses:{}},this.textureCache={},this.nodeNamesUsed={},typeof createImageBitmap!="undefined"&&/Firefox|^((?!chrome|android).)*safari/i.test(navigator.userAgent)===!1?this.textureLoader=new THREE.ImageBitmapLoader(this.options.manager):this.textureLoader=new THREE.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.textureLoader.setRequestHeader(this.options.requestHeader),this.fileLoader=new THREE.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer"),this.options.crossOrigin==="use-credentials"&&this.fileLoader.setWithCredentials(!0)}setExtensions(_e){this.extensions=_e}setPlugins(_e){this.plugins=_e}parse(_e,Ee){const Oe=this,Le=this.json,ce=this.extensions;this.cache.removeAll(),this._invokeAll(function(he){return he._markDefs&&he._markDefs()}),Promise.all(this._invokeAll(function(he){return he.beforeRoot&&he.beforeRoot()})).then(function(){return Promise.all([Oe.getDependencies("scene"),Oe.getDependencies("animation"),Oe.getDependencies("camera")])}).then(function(he){const ie={scene:he[0][Le.scene||0],scenes:he[0],animations:he[1],cameras:he[2],asset:Le.asset,parser:Oe,userData:{}};ge(ce,ie,Le),me(ie,Le),Promise.all(Oe._invokeAll(function(V){return V.afterRoot&&V.afterRoot(ie)})).then(function(){_e(ie)})}).catch(Ee)}_markDefs(){const _e=this.json.nodes||[],Ee=this.json.skins||[],Oe=this.json.meshes||[];for(let Le=0,ce=Ee.length;Le<ce;Le++){const he=Ee[Le].joints;for(let ie=0,V=he.length;ie<V;ie++)_e[he[ie]].isBone=!0}for(let Le=0,ce=_e.length;Le<ce;Le++){const he=_e[Le];he.mesh!==void 0&&(this._addNodeRef(this.meshCache,he.mesh),he.skin!==void 0&&(Oe[he.mesh].isSkinnedMesh=!0)),he.camera!==void 0&&this._addNodeRef(this.cameraCache,he.camera)}}_addNodeRef(_e,Ee){Ee!==void 0&&(_e.refs[Ee]===void 0&&(_e.refs[Ee]=_e.uses[Ee]=0),_e.refs[Ee]++)}_getNodeRef(_e,Ee,Oe){if(_e.refs[Ee]<=1)return Oe;const Le=Oe.clone(),ce=(he,ie)=>{const V=this.associations.get(he);V!=null&&this.associations.set(ie,V);for(const[Z,B]of he.children.entries())ce(B,ie.children[Z])};return ce(Oe,Le),Le.name+="_instance_"+_e.uses[Ee]++,Le}_invokeOne(_e){const Ee=Object.values(this.plugins);Ee.push(this);for(let Oe=0;Oe<Ee.length;Oe++){const Le=_e(Ee[Oe]);if(Le)return Le}return null}_invokeAll(_e){const Ee=Object.values(this.plugins);Ee.unshift(this);const Oe=[];for(let Le=0;Le<Ee.length;Le++){const ce=_e(Ee[Le]);ce&&Oe.push(ce)}return Oe}getDependency(_e,Ee){const Oe=_e+":"+Ee;let Le=this.cache.get(Oe);if(!Le){switch(_e){case"scene":Le=this.loadScene(Ee);break;case"node":Le=this.loadNode(Ee);break;case"mesh":Le=this._invokeOne(function(ce){return ce.loadMesh&&ce.loadMesh(Ee)});break;case"accessor":Le=this.loadAccessor(Ee);break;case"bufferView":Le=this._invokeOne(function(ce){return ce.loadBufferView&&ce.loadBufferView(Ee)});break;case"buffer":Le=this.loadBuffer(Ee);break;case"material":Le=this._invokeOne(function(ce){return ce.loadMaterial&&ce.loadMaterial(Ee)});break;case"texture":Le=this._invokeOne(function(ce){return ce.loadTexture&&ce.loadTexture(Ee)});break;case"skin":Le=this.loadSkin(Ee);break;case"animation":Le=this.loadAnimation(Ee);break;case"camera":Le=this.loadCamera(Ee);break;default:throw new Error("Unknown type: "+_e)}this.cache.add(Oe,Le)}return Le}getDependencies(_e){let Ee=this.cache.get(_e);if(!Ee){const Oe=this,Le=this.json[_e+(_e==="mesh"?"es":"s")]||[];Ee=Promise.all(Le.map(function(ce,he){return Oe.getDependency(_e,he)})),this.cache.add(_e,Ee)}return Ee}loadBuffer(_e){const Ee=this.json.buffers[_e],Oe=this.fileLoader;if(Ee.type&&Ee.type!=="arraybuffer")throw new Error("THREE.GLTFLoader: "+Ee.type+" buffer type is not supported.");if(Ee.uri===void 0&&_e===0)return Promise.resolve(this.extensions[u.KHR_BINARY_GLTF].body);const Le=this.options;return new Promise(function(ce,he){Oe.load(THREE.LoaderUtils.resolveURL(Ee.uri,Le.path),ce,void 0,function(){he(new Error('THREE.GLTFLoader: Failed to load buffer "'+Ee.uri+'".'))})})}loadBufferView(_e){const Ee=this.json.bufferViews[_e];return this.getDependency("buffer",Ee.buffer).then(function(Oe){const Le=Ee.byteLength||0,ce=Ee.byteOffset||0;return Oe.slice(ce,ce+Le)})}loadAccessor(_e){const Ee=this,Oe=this.json,Le=this.json.accessors[_e];if(Le.bufferView===void 0&&Le.sparse===void 0)return Promise.resolve(null);const ce=[];return Le.bufferView!==void 0?ce.push(this.getDependency("bufferView",Le.bufferView)):ce.push(null),Le.sparse!==void 0&&(ce.push(this.getDependency("bufferView",Le.sparse.indices.bufferView)),ce.push(this.getDependency("bufferView",Le.sparse.values.bufferView))),Promise.all(ce).then(function(he){const ie=he[0],V=Q[Le.type],Z=U[Le.componentType],B=Z.BYTES_PER_ELEMENT,S=B*V,R=Le.byteOffset||0,X=Le.bufferView!==void 0?Oe.bufferViews[Le.bufferView].byteStride:void 0,xe=Le.normalized===!0;let Ie,ye;if(X&&X!==S){const nt=Math.floor(R/X),at="InterleavedBuffer:"+Le.bufferView+":"+Le.componentType+":"+nt+":"+Le.count;let mt=Ee.cache.get(at);mt||(Ie=new Z(ie,nt*X,Le.count*X/B),mt=new THREE.InterleavedBuffer(Ie,X/B),Ee.cache.add(at,mt)),ye=new THREE.InterleavedBufferAttribute(mt,V,R%X/B,xe)}else ie===null?Ie=new Z(Le.count*V):Ie=new Z(ie,R,Le.count*V),ye=new THREE.BufferAttribute(Ie,V,xe);if(Le.sparse!==void 0){const nt=Q.SCALAR,at=U[Le.sparse.indices.componentType],mt=Le.sparse.indices.byteOffset||0,wt=Le.sparse.values.byteOffset||0,Lt=new at(he[1],mt,Le.sparse.count*nt),Ct=new Z(he[2],wt,Le.sparse.count*V);ie!==null&&(ye=new THREE.BufferAttribute(ye.array.slice(),ye.itemSize,ye.normalized));for(let ut=0,St=Lt.length;ut<St;ut++){const Tt=Lt[ut];if(ye.setX(Tt,Ct[ut*V]),V>=2&&ye.setY(Tt,Ct[ut*V+1]),V>=3&&ye.setZ(Tt,Ct[ut*V+2]),V>=4&&ye.setW(Tt,Ct[ut*V+3]),V>=5)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse THREE.BufferAttribute.")}}return ye})}loadTexture(_e){const Ee=this.json,Oe=this.options,Le=Ee.textures[_e],ce=Ee.images[Le.source];let he=this.textureLoader;if(ce.uri){const ie=Oe.manager.getHandler(ce.uri);ie!==null&&(he=ie)}return this.loadTextureImage(_e,ce,he)}loadTextureImage(_e,Ee,Oe){const Le=this,ce=this.json,he=this.options,ie=ce.textures[_e],V=(Ee.uri||Ee.bufferView)+":"+ie.sampler;if(this.textureCache[V])return this.textureCache[V];const Z=self.URL||self.webkitURL;let B=Ee.uri||"",S=!1;if(Ee.bufferView!==void 0)B=Le.getDependency("bufferView",Ee.bufferView).then(function(X){S=!0;const xe=new Blob([X],{type:Ee.mimeType});return B=Z.createObjectURL(xe),B});else if(Ee.uri===void 0)throw new Error("THREE.GLTFLoader: Image "+_e+" is missing URI and bufferView");const R=Promise.resolve(B).then(function(X){return new Promise(function(xe,Ie){let ye=xe;Oe.isImageBitmapLoader===!0&&(ye=function(nt){const at=new THREE.Texture(nt);at.needsUpdate=!0,xe(at)}),Oe.load(THREE.LoaderUtils.resolveURL(X,he.path),ye,void 0,Ie)})}).then(function(X){S===!0&&Z.revokeObjectURL(B),X.flipY=!1,ie.name&&(X.name=ie.name);const Ie=(ce.samplers||{})[ie.sampler]||{};return X.magFilter=$[Ie.magFilter]||THREE.LinearFilter,X.minFilter=$[Ie.minFilter]||THREE.LinearMipmapLinearFilter,X.wrapS=ee[Ie.wrapS]||THREE.RepeatWrapping,X.wrapT=ee[Ie.wrapT]||THREE.RepeatWrapping,Le.associations.set(X,{textures:_e}),X}).catch(function(){return console.error("THREE.GLTFLoader: Couldn't load texture",B),null});return this.textureCache[V]=R,R}assignTexture(_e,Ee,Oe){const Le=this;return this.getDependency("texture",Oe.index).then(function(ce){if(Oe.texCoord!==void 0&&Oe.texCoord!=0&&!(Ee==="aoMap"&&Oe.texCoord==1)&&console.warn("THREE.GLTFLoader: Custom UV set "+Oe.texCoord+" for texture "+Ee+" not yet supported."),Le.extensions[u.KHR_TEXTURE_TRANSFORM]){const he=Oe.extensions!==void 0?Oe.extensions[u.KHR_TEXTURE_TRANSFORM]:void 0;if(he){const ie=Le.associations.get(ce);ce=Le.extensions[u.KHR_TEXTURE_TRANSFORM].extendTexture(ce,he),Le.associations.set(ce,ie)}}return _e[Ee]=ce,ce})}assignFinalMaterial(_e){const Ee=_e.geometry;let Oe=_e.material;const Le=Ee.attributes.tangent===void 0,ce=Ee.attributes.color!==void 0,he=Ee.attributes.normal===void 0;if(_e.isPoints){const ie="PointsMaterial:"+Oe.uuid;let V=this.cache.get(ie);V||(V=new THREE.PointsMaterial,THREE.Material.prototype.copy.call(V,Oe),V.color.copy(Oe.color),V.map=Oe.map,V.sizeAttenuation=!1,this.cache.add(ie,V)),Oe=V}else if(_e.isLine){const ie="LineBasicMaterial:"+Oe.uuid;let V=this.cache.get(ie);V||(V=new THREE.LineBasicMaterial,THREE.Material.prototype.copy.call(V,Oe),V.color.copy(Oe.color),this.cache.add(ie,V)),Oe=V}if(Le||ce||he){let ie="ClonedMaterial:"+Oe.uuid+":";Oe.isGLTFSpecularGlossinessMaterial&&(ie+="specular-glossiness:"),Le&&(ie+="derivative-tangents:"),ce&&(ie+="vertex-colors:"),he&&(ie+="flat-shading:");let V=this.cache.get(ie);V||(V=Oe.clone(),ce&&(V.vertexColors=!0),he&&(V.flatShading=!0),Le&&(V.normalScale&&(V.normalScale.y*=-1),V.clearcoatNormalScale&&(V.clearcoatNormalScale.y*=-1)),this.cache.add(ie,V),this.associations.set(V,this.associations.get(Oe))),Oe=V}Oe.aoMap&&Ee.attributes.uv2===void 0&&Ee.attributes.uv!==void 0&&Ee.setAttribute("uv2",Ee.attributes.uv),_e.material=Oe}getMaterialType(){return THREE.MeshStandardMaterial}loadMaterial(_e){const Ee=this,Oe=this.json,Le=this.extensions,ce=Oe.materials[_e];let he;const ie={},V=ce.extensions||{},Z=[];if(V[u.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){const S=Le[u.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];he=S.getMaterialType(),Z.push(S.extendParams(ie,ce,Ee))}else if(V[u.KHR_MATERIALS_UNLIT]){const S=Le[u.KHR_MATERIALS_UNLIT];he=S.getMaterialType(),Z.push(S.extendParams(ie,ce,Ee))}else{const S=ce.pbrMetallicRoughness||{};if(ie.color=new THREE.Color(1,1,1),ie.opacity=1,Array.isArray(S.baseColorFactor)){const R=S.baseColorFactor;ie.color.fromArray(R),ie.opacity=R[3]}S.baseColorTexture!==void 0&&Z.push(Ee.assignTexture(ie,"map",S.baseColorTexture)),ie.metalness=S.metallicFactor!==void 0?S.metallicFactor:1,ie.roughness=S.roughnessFactor!==void 0?S.roughnessFactor:1,S.metallicRoughnessTexture!==void 0&&(Z.push(Ee.assignTexture(ie,"metalnessMap",S.metallicRoughnessTexture)),Z.push(Ee.assignTexture(ie,"roughnessMap",S.metallicRoughnessTexture))),he=this._invokeOne(function(R){return R.getMaterialType&&R.getMaterialType(_e)}),Z.push(Promise.all(this._invokeAll(function(R){return R.extendMaterialParams&&R.extendMaterialParams(_e,ie)})))}ce.doubleSided===!0&&(ie.side=THREE.DoubleSide);const B=ce.alphaMode||we.OPAQUE;if(B===we.BLEND?(ie.transparent=!0,ie.depthWrite=!1):(ie.transparent=!1,ie.alphaWrite=!1,B===we.MASK&&(ie.alphaTest=ce.alphaCutoff!==void 0?ce.alphaCutoff:.5)),ce.normalTexture!==void 0&&he!==THREE.MeshBasicMaterial&&(Z.push(Ee.assignTexture(ie,"normalMap",ce.normalTexture)),ie.normalScale=new THREE.Vector2(1,1),ce.normalTexture.scale!==void 0)){const S=ce.normalTexture.scale;ie.normalScale.set(S,S)}return ce.occlusionTexture!==void 0&&he!==THREE.MeshBasicMaterial&&(Z.push(Ee.assignTexture(ie,"aoMap",ce.occlusionTexture)),ce.occlusionTexture.strength!==void 0&&(ie.aoMapIntensity=ce.occlusionTexture.strength)),ce.emissiveFactor!==void 0&&he!==THREE.MeshBasicMaterial&&(ie.emissive=new THREE.Color().fromArray(ce.emissiveFactor)),ce.emissiveTexture!==void 0&&he!==THREE.MeshBasicMaterial&&Z.push(Ee.assignTexture(ie,"emissiveMap",ce.emissiveTexture)),Promise.all(Z).then(function(){let S;return he===J?S=Le[u.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(ie):S=new he(ie),ce.name&&(S.name=ce.name),S.map&&(S.map.encoding=THREE.sRGBEncoding),S.emissiveMap&&(S.emissiveMap.encoding=THREE.sRGBEncoding),me(S,ce),Ee.associations.set(S,{materials:_e}),ce.extensions&&ge(Le,S,ce),S})}createUniqueName(_e){const Ee=THREE.PropertyBinding.sanitizeNodeName(_e||"");let Oe=Ee;for(let Le=1;this.nodeNamesUsed[Oe];++Le)Oe=Ee+"_"+Le;return this.nodeNamesUsed[Oe]=!0,Oe}loadGeometries(_e){const Ee=this,Oe=this.extensions,Le=this.primitiveCache;function ce(ie){return Oe[u.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(ie,Ee).then(function(V){return $e(V,ie,Ee)})}const he=[];for(let ie=0,V=_e.length;ie<V;ie++){const Z=_e[ie],B=tt(Z),S=Le[B];if(S)he.push(S.promise);else{let R;Z.extensions&&Z.extensions[u.KHR_DRACO_MESH_COMPRESSION]?R=ce(Z):R=$e(new THREE.BufferGeometry,Z,Ee),Le[B]={primitive:Z,promise:R},he.push(R)}}return Promise.all(he)}loadMesh(_e){const Ee=this,Oe=this.json,Le=this.extensions,ce=Oe.meshes[_e],he=ce.primitives,ie=[];for(let V=0,Z=he.length;V<Z;V++){const B=he[V].material===void 0?Ke(this.cache):this.getDependency("material",he[V].material);ie.push(B)}return ie.push(Ee.loadGeometries(he)),Promise.all(ie).then(function(V){const Z=V.slice(0,V.length-1),B=V[V.length-1],S=[];for(let X=0,xe=B.length;X<xe;X++){const Ie=B[X],ye=he[X];let nt;const at=Z[X];if(ye.mode===I.TRIANGLES||ye.mode===I.TRIANGLE_STRIP||ye.mode===I.TRIANGLE_FAN||ye.mode===void 0)nt=ce.isSkinnedMesh===!0?new THREE.SkinnedMesh(Ie,at):new THREE.Mesh(Ie,at),nt.isSkinnedMesh===!0&&!nt.geometry.attributes.skinWeight.normalized&&nt.normalizeSkinWeights(),ye.mode===I.TRIANGLE_STRIP?nt.geometry=Je(nt.geometry,THREE.TriangleStripDrawMode):ye.mode===I.TRIANGLE_FAN&&(nt.geometry=Je(nt.geometry,THREE.TriangleFanDrawMode));else if(ye.mode===I.LINES)nt=new THREE.LineSegments(Ie,at);else if(ye.mode===I.LINE_STRIP)nt=new THREE.Line(Ie,at);else if(ye.mode===I.LINE_LOOP)nt=new THREE.LineLoop(Ie,at);else if(ye.mode===I.POINTS)nt=new THREE.Points(Ie,at);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+ye.mode);Object.keys(nt.geometry.morphAttributes).length>0&&ze(nt,ce),nt.name=Ee.createUniqueName(ce.name||"mesh_"+_e),me(nt,ce),ye.extensions&&ge(Le,nt,ye),Ee.assignFinalMaterial(nt),S.push(nt)}for(let X=0,xe=S.length;X<xe;X++)Ee.associations.set(S[X],{meshes:_e,primitives:X});if(S.length===1)return S[0];const R=new THREE.Group;Ee.associations.set(R,{meshes:_e});for(let X=0,xe=S.length;X<xe;X++)R.add(S[X]);return R})}loadCamera(_e){let Ee;const Oe=this.json.cameras[_e],Le=Oe[Oe.type];if(!Le){console.warn("THREE.GLTFLoader: Missing camera parameters.");return}return Oe.type==="perspective"?Ee=new THREE.PerspectiveCamera(THREE.MathUtils.radToDeg(Le.yfov),Le.aspectRatio||1,Le.znear||1,Le.zfar||2e6):Oe.type==="orthographic"&&(Ee=new THREE.OrthographicCamera(-Le.xmag,Le.xmag,Le.ymag,-Le.ymag,Le.znear,Le.zfar)),Oe.name&&(Ee.name=this.createUniqueName(Oe.name)),me(Ee,Oe),Promise.resolve(Ee)}loadSkin(_e){const Ee=this.json.skins[_e],Oe={joints:Ee.joints};return Ee.inverseBindMatrices===void 0?Promise.resolve(Oe):this.getDependency("accessor",Ee.inverseBindMatrices).then(function(Le){return Oe.inverseBindMatrices=Le,Oe})}loadAnimation(_e){const Oe=this.json.animations[_e],Le=[],ce=[],he=[],ie=[],V=[];for(let Z=0,B=Oe.channels.length;Z<B;Z++){const S=Oe.channels[Z],R=Oe.samplers[S.sampler],X=S.target,xe=X.node!==void 0?X.node:X.id,Ie=Oe.parameters!==void 0?Oe.parameters[R.input]:R.input,ye=Oe.parameters!==void 0?Oe.parameters[R.output]:R.output;Le.push(this.getDependency("node",xe)),ce.push(this.getDependency("accessor",Ie)),he.push(this.getDependency("accessor",ye)),ie.push(R),V.push(X)}return Promise.all([Promise.all(Le),Promise.all(ce),Promise.all(he),Promise.all(ie),Promise.all(V)]).then(function(Z){const B=Z[0],S=Z[1],R=Z[2],X=Z[3],xe=Z[4],Ie=[];for(let nt=0,at=B.length;nt<at;nt++){const mt=B[nt],wt=S[nt],Lt=R[nt],Ct=X[nt],ut=xe[nt];if(mt===void 0)continue;mt.updateMatrix(),mt.matrixAutoUpdate=!0;let St;switch(K[ut.path]){case K.weights:St=THREE.NumberKeyframeTrack;break;case K.rotation:St=THREE.QuaternionKeyframeTrack;break;case K.position:case K.scale:default:St=THREE.VectorKeyframeTrack;break}const Tt=mt.name?mt.name:mt.uuid,gn=Ct.interpolation!==void 0?Y[Ct.interpolation]:THREE.InterpolateLinear,An=[];K[ut.path]===K.weights?mt.traverse(function(Mn){Mn.morphTargetInfluences&&An.push(Mn.name?Mn.name:Mn.uuid)}):An.push(Tt);let un=Lt.array;if(Lt.normalized){const Mn=vt(un.constructor),Cn=new Float32Array(un.length);for(let wn=0,zn=un.length;wn<zn;wn++)Cn[wn]=un[wn]*Mn;un=Cn}for(let Mn=0,Cn=An.length;Mn<Cn;Mn++){const wn=new St(An[Mn]+"."+K[ut.path],wt.array,un,gn);Ct.interpolation==="CUBICSPLINE"&&(wn.createInterpolant=function(ai){const xn=this instanceof THREE.QuaternionKeyframeTrack?M:N;return new xn(this.times,this.values,this.getValueSize()/3,ai)},wn.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),Ie.push(wn)}}const ye=Oe.name?Oe.name:"animation_"+_e;return new THREE.AnimationClip(ye,void 0,Ie)})}createNodeMesh(_e){const Ee=this.json,Oe=this,Le=Ee.nodes[_e];return Le.mesh===void 0?null:Oe.getDependency("mesh",Le.mesh).then(function(ce){const he=Oe._getNodeRef(Oe.meshCache,Le.mesh,ce);return Le.weights!==void 0&&he.traverse(function(ie){if(!!ie.isMesh)for(let V=0,Z=Le.weights.length;V<Z;V++)ie.morphTargetInfluences[V]=Le.weights[V]}),he})}loadNode(_e){const Ee=this.json,Oe=this.extensions,Le=this,ce=Ee.nodes[_e],he=ce.name?Le.createUniqueName(ce.name):"";return function(){const ie=[],V=Le._invokeOne(function(Z){return Z.createNodeMesh&&Z.createNodeMesh(_e)});return V&&ie.push(V),ce.camera!==void 0&&ie.push(Le.getDependency("camera",ce.camera).then(function(Z){return Le._getNodeRef(Le.cameraCache,ce.camera,Z)})),Le._invokeAll(function(Z){return Z.createNodeAttachment&&Z.createNodeAttachment(_e)}).forEach(function(Z){ie.push(Z)}),Promise.all(ie)}().then(function(ie){let V;if(ce.isBone===!0?V=new THREE.Bone:ie.length>1?V=new THREE.Group:ie.length===1?V=ie[0]:V=new THREE.Object3D,V!==ie[0])for(let Z=0,B=ie.length;Z<B;Z++)V.add(ie[Z]);if(ce.name&&(V.userData.name=ce.name,V.name=he),me(V,ce),ce.extensions&&ge(Oe,V,ce),ce.matrix!==void 0){const Z=new THREE.Matrix4;Z.fromArray(ce.matrix),V.applyMatrix4(Z)}else ce.translation!==void 0&&V.position.fromArray(ce.translation),ce.rotation!==void 0&&V.quaternion.fromArray(ce.rotation),ce.scale!==void 0&&V.scale.fromArray(ce.scale);return Le.associations.has(V)||Le.associations.set(V,{}),Le.associations.get(V).nodes=_e,V})}loadScene(_e){const Ee=this.json,Oe=this.extensions,Le=this.json.scenes[_e],ce=this,he=new THREE.Group;Le.name&&(he.name=ce.createUniqueName(Le.name)),me(he,Le),Le.extensions&&ge(Oe,he,Le);const ie=Le.nodes||[],V=[];for(let Z=0,B=ie.length;Z<B;Z++)V.push(Pe(ie[Z],he,Ee,ce));return Promise.all(V).then(function(){const Z=B=>{const S=new Map;for(const[R,X]of ce.associations)(R instanceof THREE.Material||R instanceof THREE.Texture)&&S.set(R,X);return B.traverse(R=>{const X=ce.associations.get(R);X!=null&&S.set(R,X)}),S};return ce.associations=Z(he),he})}}function Pe(We,_e,Ee,Oe){const Le=Ee.nodes[We];return Oe.getDependency("node",We).then(function(ce){if(Le.skin===void 0)return ce;let he;return Oe.getDependency("skin",Le.skin).then(function(ie){he=ie;const V=[];for(let Z=0,B=he.joints.length;Z<B;Z++)V.push(Oe.getDependency("node",he.joints[Z]));return Promise.all(V)}).then(function(ie){return ce.traverse(function(V){if(!V.isMesh)return;const Z=[],B=[];for(let S=0,R=ie.length;S<R;S++){const X=ie[S];if(X){Z.push(X);const xe=new THREE.Matrix4;he.inverseBindMatrices!==void 0&&xe.fromArray(he.inverseBindMatrices.array,S*16),B.push(xe)}else console.warn('THREE.GLTFLoader: Joint "%s" could not be found.',he.joints[S])}V.bind(new THREE.Skeleton(Z,B),V.matrixWorld)}),ce})}).then(function(ce){_e.add(ce);const he=[];if(Le.children){const ie=Le.children;for(let V=0,Z=ie.length;V<Z;V++){const B=ie[V];he.push(Pe(B,ce,Ee,Oe))}}return Promise.all(he)})}function Be(We,_e,Ee){const Oe=_e.attributes,Le=new THREE.Box3;if(Oe.POSITION!==void 0){const ie=Ee.json.accessors[Oe.POSITION],V=ie.min,Z=ie.max;if(V!==void 0&&Z!==void 0){if(Le.set(new THREE.Vector3(V[0],V[1],V[2]),new THREE.Vector3(Z[0],Z[1],Z[2])),ie.normalized){const B=vt(U[ie.componentType]);Le.min.multiplyScalar(B),Le.max.multiplyScalar(B)}}else{console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.");return}}else return;const ce=_e.targets;if(ce!==void 0){const ie=new THREE.Vector3,V=new THREE.Vector3;for(let Z=0,B=ce.length;Z<B;Z++){const S=ce[Z];if(S.POSITION!==void 0){const R=Ee.json.accessors[S.POSITION],X=R.min,xe=R.max;if(X!==void 0&&xe!==void 0){if(V.setX(Math.max(Math.abs(X[0]),Math.abs(xe[0]))),V.setY(Math.max(Math.abs(X[1]),Math.abs(xe[1]))),V.setZ(Math.max(Math.abs(X[2]),Math.abs(xe[2]))),R.normalized){const Ie=vt(U[R.componentType]);V.multiplyScalar(Ie)}ie.max(V)}else console.warn("THREE.GLTFLoader: Missing min/max properties for accessor POSITION.")}}Le.expandByVector(ie)}We.boundingBox=Le;const he=new THREE.Sphere;Le.getCenter(he.center),he.radius=Le.min.distanceTo(Le.max)/2,We.boundingSphere=he}function $e(We,_e,Ee){const Oe=_e.attributes,Le=[];function ce(he,ie){return Ee.getDependency("accessor",he).then(function(V){We.setAttribute(ie,V)})}for(const he in Oe){const ie=G[he]||he.toLowerCase();ie in We.attributes||Le.push(ce(Oe[he],ie))}if(_e.indices!==void 0&&!We.index){const he=Ee.getDependency("accessor",_e.indices).then(function(ie){We.setIndex(ie)});Le.push(he)}return me(We,_e),Be(We,_e,Ee),Promise.all(Le).then(function(){return _e.targets!==void 0?De(We,_e.targets,Ee):We})}function Je(We,_e){let Ee=We.getIndex();if(Ee===null){const he=[],ie=We.getAttribute("position");if(ie!==void 0){for(let V=0;V<ie.count;V++)he.push(V);We.setIndex(he),Ee=We.getIndex()}else return console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),We}const Oe=Ee.count-2,Le=[];if(_e===THREE.TriangleFanDrawMode)for(let he=1;he<=Oe;he++)Le.push(Ee.getX(0)),Le.push(Ee.getX(he)),Le.push(Ee.getX(he+1));else for(let he=0;he<Oe;he++)he%2===0?(Le.push(Ee.getX(he)),Le.push(Ee.getX(he+1)),Le.push(Ee.getX(he+2))):(Le.push(Ee.getX(he+2)),Le.push(Ee.getX(he+1)),Le.push(Ee.getX(he)));Le.length/3!==Oe&&console.error("THREE.GLTFLoader.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const ce=We.clone();return ce.setIndex(Le),ce}THREE.GLTFLoader=s})()},{}],61:[function(n,i,o){(function(){class s extends THREE.Loader{constructor(h){super(h)}load(h,f,p,m){const y=this,g=this.path===""?THREE.LoaderUtils.extractUrlBase(h):this.path,_=new THREE.FileLoader(this.manager);_.setPath(this.path),_.setRequestHeader(this.requestHeader),_.setWithCredentials(this.withCredentials),_.load(h,function(x){try{f(y.parse(x,g))}catch(b){m?m(b):console.error(b),y.manager.itemError(h)}},p,m)}setMaterialOptions(h){return this.materialOptions=h,this}parse(h,f){const p=h.split(`
`);let m={};const y=/\s+/,g={};for(let x=0;x<p.length;x++){let b=p[x];if(b=b.trim(),b.length===0||b.charAt(0)==="#")continue;const E=b.indexOf(" ");let T=E>=0?b.substring(0,E):b;T=T.toLowerCase();let P=E>=0?b.substring(E+1):"";if(P=P.trim(),T==="newmtl")m={name:P},g[P]=m;else if(T==="ka"||T==="kd"||T==="ks"||T==="ke"){const D=P.split(y,3);m[T]=[parseFloat(D[0]),parseFloat(D[1]),parseFloat(D[2])]}else m[T]=P}const _=new c(this.resourcePath||f,this.materialOptions);return _.setCrossOrigin(this.crossOrigin),_.setManager(this.manager),_.setMaterials(g),_}}class c{constructor(h="",f={}){this.baseUrl=h,this.options=f,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.crossOrigin="anonymous",this.side=this.options.side!==void 0?this.options.side:THREE.FrontSide,this.wrap=this.options.wrap!==void 0?this.options.wrap:THREE.RepeatWrapping}setCrossOrigin(h){return this.crossOrigin=h,this}setManager(h){this.manager=h}setMaterials(h){this.materialsInfo=this.convert(h),this.materials={},this.materialsArray=[],this.nameLookup={}}convert(h){if(!this.options)return h;const f={};for(const p in h){const m=h[p],y={};f[p]=y;for(const g in m){let _=!0,x=m[g];const b=g.toLowerCase();switch(b){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(x=[x[0]/255,x[1]/255,x[2]/255]),this.options&&this.options.ignoreZeroRGBs&&x[0]===0&&x[1]===0&&x[2]===0&&(_=!1);break}_&&(y[b]=x)}}return f}preload(){for(const h in this.materialsInfo)this.create(h)}getIndex(h){return this.nameLookup[h]}getAsArray(){let h=0;for(const f in this.materialsInfo)this.materialsArray[h]=this.create(f),this.nameLookup[f]=h,h++;return this.materialsArray}create(h){return this.materials[h]===void 0&&this.createMaterial_(h),this.materials[h]}createMaterial_(h){const f=this,p=this.materialsInfo[h],m={name:h,side:this.side};function y(_,x){return typeof x!="string"||x===""?"":/^https?:\/\//i.test(x)?x:_+x}function g(_,x){if(m[_])return;const b=f.getTextureParams(x,m),E=f.loadTexture(y(f.baseUrl,b.url));E.repeat.copy(b.scale),E.offset.copy(b.offset),E.wrapS=f.wrap,E.wrapT=f.wrap,(_==="map"||_==="emissiveMap")&&(E.encoding=THREE.sRGBEncoding),m[_]=E}for(const _ in p){const x=p[_];let b;if(x!=="")switch(_.toLowerCase()){case"kd":m.color=new THREE.Color().fromArray(x).convertSRGBToLinear();break;case"ks":m.specular=new THREE.Color().fromArray(x).convertSRGBToLinear();break;case"ke":m.emissive=new THREE.Color().fromArray(x).convertSRGBToLinear();break;case"map_kd":g("map",x);break;case"map_ks":g("specularMap",x);break;case"map_ke":g("emissiveMap",x);break;case"norm":g("normalMap",x);break;case"map_bump":case"bump":g("bumpMap",x);break;case"map_d":g("alphaMap",x),m.transparent=!0;break;case"ns":m.shininess=parseFloat(x);break;case"d":b=parseFloat(x),b<1&&(m.opacity=b,m.transparent=!0);break;case"tr":b=parseFloat(x),this.options&&this.options.invertTrProperty&&(b=1-b),b>0&&(m.opacity=1-b,m.transparent=!0);break}}return this.materials[h]=new THREE.MeshPhongMaterial(m),this.materials[h]}getTextureParams(h,f){const p={scale:new THREE.Vector2(1,1),offset:new THREE.Vector2(0,0)},m=h.split(/\s+/);let y;return y=m.indexOf("-bm"),y>=0&&(f.bumpScale=parseFloat(m[y+1]),m.splice(y,2)),y=m.indexOf("-s"),y>=0&&(p.scale.set(parseFloat(m[y+1]),parseFloat(m[y+2])),m.splice(y,4)),y=m.indexOf("-o"),y>=0&&(p.offset.set(parseFloat(m[y+1]),parseFloat(m[y+2])),m.splice(y,4)),p.url=m.join(" ").trim(),p}loadTexture(h,f,p,m,y){const g=this.manager!==void 0?this.manager:THREE.DefaultLoadingManager;let _=g.getHandler(h);_===null&&(_=new THREE.TextureLoader(g)),_.setCrossOrigin&&_.setCrossOrigin(this.crossOrigin);const x=_.load(h,p,m,y);return f!==void 0&&(x.mapping=f),x}}THREE.MTLLoader=s})()},{}],62:[function(n,i,o){(function(){const s=/^[og]\s*(.+)?/,c=/^mtllib /,u=/^usemtl /,h=/^usemap /,f=new THREE.Vector3,p=new THREE.Vector3,m=new THREE.Vector3,y=new THREE.Vector3,g=new THREE.Vector3;function _(){const b={objects:[],object:{},vertices:[],normals:[],colors:[],uvs:[],materials:{},materialLibraries:[],startObject:function(E,T){if(this.object&&this.object.fromDeclaration===!1){this.object.name=E,this.object.fromDeclaration=T!==!1;return}const P=this.object&&typeof this.object.currentMaterial=="function"?this.object.currentMaterial():void 0;if(this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0),this.object={name:E||"",fromDeclaration:T!==!1,geometry:{vertices:[],normals:[],colors:[],uvs:[],hasUVIndices:!1},materials:[],smooth:!0,startMaterial:function(D,F){const k=this._finalize(!1);k&&(k.inherited||k.groupCount<=0)&&this.materials.splice(k.index,1);const W={index:this.materials.length,name:D||"",mtllib:Array.isArray(F)&&F.length>0?F[F.length-1]:"",smooth:k!==void 0?k.smooth:this.smooth,groupStart:k!==void 0?k.groupEnd:0,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(j){const J={index:typeof j=="number"?j:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return J.clone=this.clone.bind(J),J}};return this.materials.push(W),W},currentMaterial:function(){if(this.materials.length>0)return this.materials[this.materials.length-1]},_finalize:function(D){const F=this.currentMaterial();if(F&&F.groupEnd===-1&&(F.groupEnd=this.geometry.vertices.length/3,F.groupCount=F.groupEnd-F.groupStart,F.inherited=!1),D&&this.materials.length>1)for(let k=this.materials.length-1;k>=0;k--)this.materials[k].groupCount<=0&&this.materials.splice(k,1);return D&&this.materials.length===0&&this.materials.push({name:"",smooth:this.smooth}),F}},P&&P.name&&typeof P.clone=="function"){const D=P.clone(0);D.inherited=!0,this.object.materials.push(D)}this.objects.push(this.object)},finalize:function(){this.object&&typeof this.object._finalize=="function"&&this.object._finalize(!0)},parseVertexIndex:function(E,T){const P=parseInt(E,10);return(P>=0?P-1:P+T/3)*3},parseNormalIndex:function(E,T){const P=parseInt(E,10);return(P>=0?P-1:P+T/3)*3},parseUVIndex:function(E,T){const P=parseInt(E,10);return(P>=0?P-1:P+T/2)*2},addVertex:function(E,T,P){const D=this.vertices,F=this.object.geometry.vertices;F.push(D[E+0],D[E+1],D[E+2]),F.push(D[T+0],D[T+1],D[T+2]),F.push(D[P+0],D[P+1],D[P+2])},addVertexPoint:function(E){const T=this.vertices;this.object.geometry.vertices.push(T[E+0],T[E+1],T[E+2])},addVertexLine:function(E){const T=this.vertices;this.object.geometry.vertices.push(T[E+0],T[E+1],T[E+2])},addNormal:function(E,T,P){const D=this.normals,F=this.object.geometry.normals;F.push(D[E+0],D[E+1],D[E+2]),F.push(D[T+0],D[T+1],D[T+2]),F.push(D[P+0],D[P+1],D[P+2])},addFaceNormal:function(E,T,P){const D=this.vertices,F=this.object.geometry.normals;f.fromArray(D,E),p.fromArray(D,T),m.fromArray(D,P),g.subVectors(m,p),y.subVectors(f,p),g.cross(y),g.normalize(),F.push(g.x,g.y,g.z),F.push(g.x,g.y,g.z),F.push(g.x,g.y,g.z)},addColor:function(E,T,P){const D=this.colors,F=this.object.geometry.colors;D[E]!==void 0&&F.push(D[E+0],D[E+1],D[E+2]),D[T]!==void 0&&F.push(D[T+0],D[T+1],D[T+2]),D[P]!==void 0&&F.push(D[P+0],D[P+1],D[P+2])},addUV:function(E,T,P){const D=this.uvs,F=this.object.geometry.uvs;F.push(D[E+0],D[E+1]),F.push(D[T+0],D[T+1]),F.push(D[P+0],D[P+1])},addDefaultUV:function(){const E=this.object.geometry.uvs;E.push(0,0),E.push(0,0),E.push(0,0)},addUVLine:function(E){const T=this.uvs;this.object.geometry.uvs.push(T[E+0],T[E+1])},addFace:function(E,T,P,D,F,k,W,j,J){const de=this.vertices.length;let te=this.parseVertexIndex(E,de),N=this.parseVertexIndex(T,de),L=this.parseVertexIndex(P,de);if(this.addVertex(te,N,L),this.addColor(te,N,L),W!==void 0&&W!==""){const M=this.normals.length;te=this.parseNormalIndex(W,M),N=this.parseNormalIndex(j,M),L=this.parseNormalIndex(J,M),this.addNormal(te,N,L)}else this.addFaceNormal(te,N,L);if(D!==void 0&&D!==""){const M=this.uvs.length;te=this.parseUVIndex(D,M),N=this.parseUVIndex(F,M),L=this.parseUVIndex(k,M),this.addUV(te,N,L),this.object.geometry.hasUVIndices=!0}else this.addDefaultUV()},addPointGeometry:function(E){this.object.geometry.type="Points";const T=this.vertices.length;for(let P=0,D=E.length;P<D;P++){const F=this.parseVertexIndex(E[P],T);this.addVertexPoint(F),this.addColor(F)}},addLineGeometry:function(E,T){this.object.geometry.type="Line";const P=this.vertices.length,D=this.uvs.length;for(let F=0,k=E.length;F<k;F++)this.addVertexLine(this.parseVertexIndex(E[F],P));for(let F=0,k=T.length;F<k;F++)this.addUVLine(this.parseUVIndex(T[F],D))}};return b.startObject("",!1),b}class x extends THREE.Loader{constructor(E){super(E),this.materials=null}load(E,T,P,D){const F=this,k=new THREE.FileLoader(this.manager);k.setPath(this.path),k.setRequestHeader(this.requestHeader),k.setWithCredentials(this.withCredentials),k.load(E,function(W){try{T(F.parse(W))}catch(j){D?D(j):console.error(j),F.manager.itemError(E)}},P,D)}setMaterials(E){return this.materials=E,this}parse(E){const T=new _;E.indexOf(`\r
`)!==-1&&(E=E.replace(/\r\n/g,`
`)),E.indexOf(`\\
`)!==-1&&(E=E.replace(/\\\n/g,""));const P=E.split(`
`);let D="",F="",k=0,W=[];const j=typeof"".trimLeft=="function";for(let te=0,N=P.length;te<N;te++)if(D=P[te],D=j?D.trimLeft():D.trim(),k=D.length,k!==0&&(F=D.charAt(0),F!=="#"))if(F==="v"){const L=D.split(/\s+/);switch(L[0]){case"v":T.vertices.push(parseFloat(L[1]),parseFloat(L[2]),parseFloat(L[3])),L.length>=7?T.colors.push(parseFloat(L[4]),parseFloat(L[5]),parseFloat(L[6])):T.colors.push(void 0,void 0,void 0);break;case"vn":T.normals.push(parseFloat(L[1]),parseFloat(L[2]),parseFloat(L[3]));break;case"vt":T.uvs.push(parseFloat(L[1]),parseFloat(L[2]));break}}else if(F==="f"){const M=D.substr(1).trim().split(/\s+/),I=[];for(let $=0,ee=M.length;$<ee;$++){const Q=M[$];if(Q.length>0){const G=Q.split("/");I.push(G)}}const U=I[0];for(let $=1,ee=I.length-1;$<ee;$++){const Q=I[$],G=I[$+1];T.addFace(U[0],Q[0],G[0],U[1],Q[1],G[1],U[2],Q[2],G[2])}}else if(F==="l"){const L=D.substring(1).trim().split(" ");let M=[];const I=[];if(D.indexOf("/")===-1)M=L;else for(let U=0,$=L.length;U<$;U++){const ee=L[U].split("/");ee[0]!==""&&M.push(ee[0]),ee[1]!==""&&I.push(ee[1])}T.addLineGeometry(M,I)}else if(F==="p"){const M=D.substr(1).trim().split(" ");T.addPointGeometry(M)}else if((W=s.exec(D))!==null){const L=(" "+W[0].substr(1).trim()).substr(1);T.startObject(L)}else if(u.test(D))T.object.startMaterial(D.substring(7).trim(),T.materialLibraries);else if(c.test(D))T.materialLibraries.push(D.substring(7).trim());else if(h.test(D))console.warn('THREE.OBJLoader: Rendering identifier "usemap" not supported. Textures must be defined in MTL files.');else if(F==="s"){if(W=D.split(" "),W.length>1){const M=W[1].trim().toLowerCase();T.object.smooth=M!=="0"&&M!=="off"}else T.object.smooth=!0;const L=T.object.currentMaterial();L&&(L.smooth=T.object.smooth)}else{if(D==="\0")continue;console.warn('THREE.OBJLoader: Unexpected line: "'+D+'"')}T.finalize();const J=new THREE.Group;if(J.materialLibraries=[].concat(T.materialLibraries),!(T.objects.length===1&&T.objects[0].geometry.vertices.length===0)===!0)for(let te=0,N=T.objects.length;te<N;te++){const L=T.objects[te],M=L.geometry,I=L.materials,U=M.type==="Line",$=M.type==="Points";let ee=!1;if(M.vertices.length===0)continue;const Q=new THREE.BufferGeometry;Q.setAttribute("position",new THREE.Float32BufferAttribute(M.vertices,3)),M.normals.length>0&&Q.setAttribute("normal",new THREE.Float32BufferAttribute(M.normals,3)),M.colors.length>0&&(ee=!0,Q.setAttribute("color",new THREE.Float32BufferAttribute(M.colors,3))),M.hasUVIndices===!0&&Q.setAttribute("uv",new THREE.Float32BufferAttribute(M.uvs,2));const G=[];for(let Y=0,we=I.length;Y<we;Y++){const Ke=I[Y],ge=Ke.name+"_"+Ke.smooth+"_"+ee;let me=T.materials[ge];if(this.materials!==null){if(me=this.materials.create(Ke.name),U&&me&&!(me instanceof THREE.LineBasicMaterial)){const De=new THREE.LineBasicMaterial;THREE.Material.prototype.copy.call(De,me),De.color.copy(me.color),me=De}else if($&&me&&!(me instanceof THREE.PointsMaterial)){const De=new THREE.PointsMaterial({size:10,sizeAttenuation:!1});THREE.Material.prototype.copy.call(De,me),De.color.copy(me.color),De.map=me.map,me=De}}me===void 0&&(U?me=new THREE.LineBasicMaterial:$?me=new THREE.PointsMaterial({size:1,sizeAttenuation:!1}):me=new THREE.MeshPhongMaterial,me.name=Ke.name,me.flatShading=!Ke.smooth,me.vertexColors=ee,T.materials[ge]=me),G.push(me)}let K;if(G.length>1){for(let Y=0,we=I.length;Y<we;Y++){const Ke=I[Y];Q.addGroup(Ke.groupStart,Ke.groupCount,Y)}U?K=new THREE.LineSegments(Q,G):$?K=new THREE.Points(Q,G):K=new THREE.Mesh(Q,G)}else U?K=new THREE.LineSegments(Q,G[0]):$?K=new THREE.Points(Q,G[0]):K=new THREE.Mesh(Q,G[0]);K.name=L.name,J.add(K)}else if(T.vertices.length>0){const te=new THREE.PointsMaterial({size:1,sizeAttenuation:!1}),N=new THREE.BufferGeometry;N.setAttribute("position",new THREE.Float32BufferAttribute(T.vertices,3)),T.colors.length>0&&T.colors[0]!==void 0&&(N.setAttribute("color",new THREE.Float32BufferAttribute(T.colors,3)),te.vertexColors=!0);const L=new THREE.Points(N,te);J.add(L)}return J}}THREE.OBJLoader=x})()},{}],63:[function(n,i,o){(function(){function s(g){g.computeTangents(),console.warn("THREE.BufferGeometryUtils: .computeTangents() has been removed. Use THREE.BufferGeometry.computeTangents() instead.")}function c(g,_=!1){const x=g[0].index!==null,b=new Set(Object.keys(g[0].attributes)),E=new Set(Object.keys(g[0].morphAttributes)),T={},P={},D=g[0].morphTargetsRelative,F=new THREE.BufferGeometry;let k=0;for(let W=0;W<g.length;++W){const j=g[W];let J=0;if(x!==(j.index!==null))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+W+". All geometries must have compatible attributes; make sure index attribute exists among all geometries, or in none of them."),null;for(const de in j.attributes){if(!b.has(de))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+W+'. All geometries must have compatible attributes; make sure "'+de+'" attribute exists among all geometries, or in none of them.'),null;T[de]===void 0&&(T[de]=[]),T[de].push(j.attributes[de]),J++}if(J!==b.size)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+W+". Make sure all geometries have the same number of attributes."),null;if(D!==j.morphTargetsRelative)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+W+". .morphTargetsRelative must be consistent throughout all geometries."),null;for(const de in j.morphAttributes){if(!E.has(de))return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+W+".  .morphAttributes must be consistent throughout all geometries."),null;P[de]===void 0&&(P[de]=[]),P[de].push(j.morphAttributes[de])}if(F.userData.mergedUserData=F.userData.mergedUserData||[],F.userData.mergedUserData.push(j.userData),_){let de;if(x)de=j.index.count;else if(j.attributes.position!==void 0)de=j.attributes.position.count;else return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed with geometry at index "+W+". The geometry must have either an index or a position attribute"),null;F.addGroup(k,de,W),k+=de}}if(x){let W=0;const j=[];for(let J=0;J<g.length;++J){const de=g[J].index;for(let te=0;te<de.count;++te)j.push(de.getX(te)+W);W+=g[J].attributes.position.count}F.setIndex(j)}for(const W in T){const j=u(T[W]);if(!j)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+W+" attribute."),null;F.setAttribute(W,j)}for(const W in P){const j=P[W][0].length;if(j===0)break;F.morphAttributes=F.morphAttributes||{},F.morphAttributes[W]=[];for(let J=0;J<j;++J){const de=[];for(let N=0;N<P[W].length;++N)de.push(P[W][N][J]);const te=u(de);if(!te)return console.error("THREE.BufferGeometryUtils: .mergeBufferGeometries() failed while trying to merge the "+W+" morphAttribute."),null;F.morphAttributes[W].push(te)}}return F}function u(g){let _,x,b,E=0;for(let D=0;D<g.length;++D){const F=g[D];if(F.isInterleavedBufferAttribute)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. InterleavedBufferAttributes are not supported."),null;if(_===void 0&&(_=F.array.constructor),_!==F.array.constructor)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. THREE.BufferAttribute.array must be of consistent array types across matching attributes."),null;if(x===void 0&&(x=F.itemSize),x!==F.itemSize)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. THREE.BufferAttribute.itemSize must be consistent across matching attributes."),null;if(b===void 0&&(b=F.normalized),b!==F.normalized)return console.error("THREE.BufferGeometryUtils: .mergeBufferAttributes() failed. THREE.BufferAttribute.normalized must be consistent across matching attributes."),null;E+=F.array.length}const T=new _(E);let P=0;for(let D=0;D<g.length;++D)T.set(g[D].array,P),P+=g[D].array.length;return new THREE.BufferAttribute(T,x,b)}function h(g){let _,x=0,b=0;for(let k=0,W=g.length;k<W;++k){const j=g[k];if(_===void 0&&(_=j.array.constructor),_!==j.array.constructor)return console.error("AttributeBuffers of different types cannot be interleaved"),null;x+=j.array.length,b+=j.itemSize}const E=new THREE.InterleavedBuffer(new _(x),b);let T=0;const P=[],D=["getX","getY","getZ","getW"],F=["setX","setY","setZ","setW"];for(let k=0,W=g.length;k<W;k++){const j=g[k],J=j.itemSize,de=j.count,te=new THREE.InterleavedBufferAttribute(E,J,T,j.normalized);P.push(te),T+=J;for(let N=0;N<de;N++)for(let L=0;L<J;L++)te[F[L]](N,j[D[L]](N))}return P}function f(g){let _=0;for(const b in g.attributes){const E=g.getAttribute(b);_+=E.count*E.itemSize*E.array.BYTES_PER_ELEMENT}const x=g.getIndex();return _+=x?x.count*x.itemSize*x.array.BYTES_PER_ELEMENT:0,_}function p(g,_=1e-4){_=Math.max(_,Number.EPSILON);const x={},b=g.getIndex(),E=g.getAttribute("position"),T=b?b.count:E.count;let P=0;const D=Object.keys(g.attributes),F={},k={},W=[],j=["getX","getY","getZ","getW"];for(let N=0,L=D.length;N<L;N++){const M=D[N];F[M]=[];const I=g.morphAttributes[M];I&&(k[M]=new Array(I.length).fill().map(()=>[]))}const J=Math.log10(1/_),de=Math.pow(10,J);for(let N=0;N<T;N++){const L=b?b.getX(N):N;let M="";for(let I=0,U=D.length;I<U;I++){const $=D[I],ee=g.getAttribute($),Q=ee.itemSize;for(let G=0;G<Q;G++)M+=`${~~(ee[j[G]](L)*de)},`}if(M in x)W.push(x[M]);else{for(let I=0,U=D.length;I<U;I++){const $=D[I],ee=g.getAttribute($),Q=g.morphAttributes[$],G=ee.itemSize,K=F[$],Y=k[$];for(let we=0;we<G;we++){const Ke=j[we];if(K.push(ee[Ke](L)),Q)for(let ge=0,me=Q.length;ge<me;ge++)Y[ge].push(Q[ge][Ke](L))}}x[M]=P,W.push(P),P++}}const te=g.clone();for(let N=0,L=D.length;N<L;N++){const M=D[N],I=g.getAttribute(M),U=new I.array.constructor(F[M]),$=new THREE.BufferAttribute(U,I.itemSize,I.normalized);if(te.setAttribute(M,$),M in k)for(let ee=0;ee<k[M].length;ee++){const Q=g.morphAttributes[M][ee],G=new Q.array.constructor(k[M][ee]),K=new THREE.BufferAttribute(G,Q.itemSize,Q.normalized);te.morphAttributes[M][ee]=K}}return te.setIndex(W),te}function m(g,_){if(_===THREE.TrianglesDrawMode)return console.warn("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Geometry already defined as triangles."),g;if(_===THREE.TriangleFanDrawMode||_===THREE.TriangleStripDrawMode){let x=g.getIndex();if(x===null){const P=[],D=g.getAttribute("position");if(D!==void 0){for(let F=0;F<D.count;F++)P.push(F);g.setIndex(P),x=g.getIndex()}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Undefined position attribute. Processing not possible."),g}const b=x.count-2,E=[];if(_===THREE.TriangleFanDrawMode)for(let P=1;P<=b;P++)E.push(x.getX(0)),E.push(x.getX(P)),E.push(x.getX(P+1));else for(let P=0;P<b;P++)P%2===0?(E.push(x.getX(P)),E.push(x.getX(P+1)),E.push(x.getX(P+2))):(E.push(x.getX(P+2)),E.push(x.getX(P+1)),E.push(x.getX(P)));E.length/3!==b&&console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unable to generate correct amount of triangles.");const T=g.clone();return T.setIndex(E),T.clearGroups(),T}else return console.error("THREE.BufferGeometryUtils.toTrianglesDrawMode(): Unknown draw mode:",_),g}function y(g){if(g.geometry.isBufferGeometry!==!0)return console.error("THREE.BufferGeometryUtils: Geometry is not of type THREE.BufferGeometry."),null;const _=new THREE.Vector3,x=new THREE.Vector3,b=new THREE.Vector3,E=new THREE.Vector3,T=new THREE.Vector3,P=new THREE.Vector3,D=new THREE.Vector3,F=new THREE.Vector3,k=new THREE.Vector3;function W(Pe,Be,$e,Je,We,_e,Ee,Oe,Le){_.fromBufferAttribute($e,_e),x.fromBufferAttribute($e,Ee),b.fromBufferAttribute($e,Oe);const ce=Pe.morphTargetInfluences;if(Be.morphTargets&&Je&&ce){D.set(0,0,0),F.set(0,0,0),k.set(0,0,0);for(let he=0,ie=Je.length;he<ie;he++){const V=ce[he],Z=Je[he];V!==0&&(E.fromBufferAttribute(Z,_e),T.fromBufferAttribute(Z,Ee),P.fromBufferAttribute(Z,Oe),We?(D.addScaledVector(E,V),F.addScaledVector(T,V),k.addScaledVector(P,V)):(D.addScaledVector(E.sub(_),V),F.addScaledVector(T.sub(x),V),k.addScaledVector(P.sub(b),V)))}_.add(D),x.add(F),b.add(k)}Pe.isSkinnedMesh&&(Pe.boneTransform(_e,_),Pe.boneTransform(Ee,x),Pe.boneTransform(Oe,b)),Le[_e*3+0]=_.x,Le[_e*3+1]=_.y,Le[_e*3+2]=_.z,Le[Ee*3+0]=x.x,Le[Ee*3+1]=x.y,Le[Ee*3+2]=x.z,Le[Oe*3+0]=b.x,Le[Oe*3+1]=b.y,Le[Oe*3+2]=b.z}const j=g.geometry,J=g.material;let de,te,N;const L=j.index,M=j.attributes.position,I=j.morphAttributes.position,U=j.morphTargetsRelative,$=j.attributes.normal,ee=j.morphAttributes.position,Q=j.groups,G=j.drawRange;let K,Y,we,Ke,ge,me,De,ze;const tt=new Float32Array(M.count*M.itemSize),rt=new Float32Array($.count*$.itemSize);if(L!==null)if(Array.isArray(J))for(K=0,we=Q.length;K<we;K++)for(ge=Q[K],me=J[ge.materialIndex],De=Math.max(ge.start,G.start),ze=Math.min(ge.start+ge.count,G.start+G.count),Y=De,Ke=ze;Y<Ke;Y+=3)de=L.getX(Y),te=L.getX(Y+1),N=L.getX(Y+2),W(g,me,M,I,U,de,te,N,tt),W(g,me,$,ee,U,de,te,N,rt);else for(De=Math.max(0,G.start),ze=Math.min(L.count,G.start+G.count),K=De,we=ze;K<we;K+=3)de=L.getX(K),te=L.getX(K+1),N=L.getX(K+2),W(g,J,M,I,U,de,te,N,tt),W(g,J,$,ee,U,de,te,N,rt);else if(M!==void 0)if(Array.isArray(J))for(K=0,we=Q.length;K<we;K++)for(ge=Q[K],me=J[ge.materialIndex],De=Math.max(ge.start,G.start),ze=Math.min(ge.start+ge.count,G.start+G.count),Y=De,Ke=ze;Y<Ke;Y+=3)de=Y,te=Y+1,N=Y+2,W(g,me,M,I,U,de,te,N,tt),W(g,me,$,ee,U,de,te,N,rt);else for(De=Math.max(0,G.start),ze=Math.min(M.count,G.start+G.count),K=De,we=ze;K<we;K+=3)de=K,te=K+1,N=K+2,W(g,J,M,I,U,de,te,N,tt),W(g,J,$,ee,U,de,te,N,rt);const vt=new THREE.Float32BufferAttribute(tt,3),Ye=new THREE.Float32BufferAttribute(rt,3);return{positionAttribute:M,normalAttribute:$,morphedPositionAttribute:vt,morphedNormalAttribute:Ye}}THREE.BufferGeometryUtils={},THREE.BufferGeometryUtils.computeMorphedAttributes=y,THREE.BufferGeometryUtils.computeTangents=s,THREE.BufferGeometryUtils.estimateBytesUsed=f,THREE.BufferGeometryUtils.interleaveAttributes=h,THREE.BufferGeometryUtils.mergeBufferAttributes=u,THREE.BufferGeometryUtils.mergeBufferGeometries=c,THREE.BufferGeometryUtils.mergeVertices=p,THREE.BufferGeometryUtils.toTrianglesDrawMode=m})()},{}],64:[function(n,i,o){var s=n("layout-bmfont-text");n("inherits");var c=n("quad-indices"),u=n("three-buffer-vertex-data"),h=n("object-assign"),f=n("./lib/vertices"),p=n("./lib/utils");i.exports=function(g){return new m(g)};class m extends THREE.BufferGeometry{constructor(g){super(),typeof g=="string"&&(g={text:g}),this._opt=h({},g),g&&this.update(g)}update(g){if(typeof g=="string"&&(g={text:g}),g=h({},this._opt,g),!g.font)throw new TypeError("must specify a { font } in options");this.layout=s(g);var _=g.flipY!==!1,x=g.font,b=x.common.scaleW,E=x.common.scaleH,T=this.layout.glyphs.filter(function(W){var j=W.data;return j.width*j.height>0});this.visibleGlyphs=T;var P=f.positions(T),D=f.uvs(T,b,E,_),F=c({clockwise:!0,type:"uint16",count:T.length});if(u.index(this,F,1,"uint16"),u.attr(this,"position",P,2),u.attr(this,"uv",D,2),!g.multipage&&"page"in this.attributes)this.removeAttribute("page");else if(g.multipage){var k=f.pages(T);u.attr(this,"page",k,1)}}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new THREE.Sphere);var g=this.attributes.position.array,_=this.attributes.position.itemSize;if(!g||!_||g.length<2){this.boundingSphere.radius=0,this.boundingSphere.center.set(0,0,0);return}p.computeSphere(g,this.boundingSphere),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.')}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new THREE.Box3);var g=this.boundingBox,_=this.attributes.position.array,x=this.attributes.position.itemSize;if(!_||!x||_.length<2){g.makeEmpty();return}p.computeBox(_,g)}}},{"./lib/utils":65,"./lib/vertices":66,inherits:30,"layout-bmfont-text":36,"object-assign":39,"quad-indices":51,"three-buffer-vertex-data":67}],65:[function(n,i,o){var s=2,c={min:[0,0],max:[0,0]};function u(h){var f=h.length/s;c.min[0]=h[0],c.min[1]=h[1],c.max[0]=h[0],c.max[1]=h[1];for(var p=0;p<f;p++){var m=h[p*s+0],y=h[p*s+1];c.min[0]=Math.min(m,c.min[0]),c.min[1]=Math.min(y,c.min[1]),c.max[0]=Math.max(m,c.max[0]),c.max[1]=Math.max(y,c.max[1])}}i.exports.computeBox=function(h,f){u(h),f.min.set(c.min[0],c.min[1],0),f.max.set(c.max[0],c.max[1],0)},i.exports.computeSphere=function(h,f){u(h);var p=c.min[0],m=c.min[1],y=c.max[0],g=c.max[1],_=y-p,x=g-m,b=Math.sqrt(_*_+x*x);f.center.set(p+_/2,m+x/2,0),f.radius=b/2}},{}],66:[function(n,i,o){i.exports.pages=function(c){var u=new Float32Array(c.length*4*1),h=0;return c.forEach(function(f){var p=f.data.page||0;u[h++]=p,u[h++]=p,u[h++]=p,u[h++]=p}),u},i.exports.uvs=function(c,u,h,f){var p=new Float32Array(c.length*4*2),m=0;return c.forEach(function(y){var g=y.data,_=g.x+g.width,x=g.y+g.height,b=g.x/u,E=g.y/h,T=_/u,P=x/h;f&&(E=(h-g.y)/h,P=(h-x)/h),p[m++]=b,p[m++]=E,p[m++]=b,p[m++]=P,p[m++]=T,p[m++]=P,p[m++]=T,p[m++]=E}),p},i.exports.positions=function(c){var u=new Float32Array(c.length*4*2),h=0;return c.forEach(function(f){var p=f.data,m=f.position[0]+p.xoffset,y=f.position[1]+p.yoffset,g=p.width,_=p.height;u[h++]=m,u[h++]=y,u[h++]=m,u[h++]=y+_,u[h++]=m+g,u[h++]=y+_,u[h++]=m+g,u[h++]=y}),u}},{}],67:[function(n,i,o){var s=n("flatten-vertex-data");i.exports.attr=u,i.exports.index=c;function c(f,p,m,y){typeof m!="number"&&(m=1),typeof y!="string"&&(y="uint16");var g=!f.index&&typeof f.setIndex!="function",_=g?f.getAttribute("index"):f.index,x=h(_,p,m,y);x&&(g?f.addAttribute("index",x):f.index=x)}function u(f,p,m,y,g){if(typeof y!="number"&&(y=3),typeof g!="string"&&(g="float32"),Array.isArray(m)&&Array.isArray(m[0])&&m[0].length!==y)throw new Error("Nested vertex array has unexpected size; expected "+y+" but found "+m[0].length);var _=f.getAttribute(p),x=h(_,m,y,g);f.setAttribute(p,x)}function h(f,p,m,y){return p=p||[],p=s(p,y),f=new THREE.BufferAttribute(p,m),f.itemSize=m,f.needsUpdate=!0,f}},{"flatten-vertex-data":23}],68:[function(n,i,o){(function(s,c){var u=n("process/browser.js").nextTick,h=Function.prototype.apply,f=Array.prototype.slice,p={},m=0;o.setTimeout=function(){return new y(h.call(setTimeout,window,arguments),clearTimeout)},o.setInterval=function(){return new y(h.call(setInterval,window,arguments),clearInterval)},o.clearTimeout=o.clearInterval=function(g){g.close()};function y(g,_){this._id=g,this._clearFn=_}y.prototype.unref=y.prototype.ref=function(){},y.prototype.close=function(){this._clearFn.call(window,this._id)},o.enroll=function(g,_){clearTimeout(g._idleTimeoutId),g._idleTimeout=_},o.unenroll=function(g){clearTimeout(g._idleTimeoutId),g._idleTimeout=-1},o._unrefActive=o.active=function(g){clearTimeout(g._idleTimeoutId);var _=g._idleTimeout;_>=0&&(g._idleTimeoutId=setTimeout(function(){g._onTimeout&&g._onTimeout()},_))},o.setImmediate=typeof s=="function"?s:function(g){var _=m++,x=arguments.length<2?!1:f.call(arguments,1);return p[_]=!0,u(function(){p[_]&&(x?g.apply(null,x):g.call(null),o.clearImmediate(_))}),_},o.clearImmediate=typeof c=="function"?c:function(g){delete p[g]}}).call(this,n("timers").setImmediate,n("timers").clearImmediate)},{"process/browser.js":49,timers:68}],69:[function(n,i,o){(function(s){/**
 * @license
 * webvr-polyfill
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * cardboard-vr-display
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * webvr-polyfill-dpdb 
 * Copyright (c) 2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * wglu-preserve-state
 * Copyright (c) 2016, Brandon Jones.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *//**
 * @license
 * nosleep.js
 * Copyright (c) 2017, Rich Tibbett
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */(function(c,u){typeof o=="object"&&typeof i!="undefined"?i.exports=u():c.WebVRPolyfill=u()})(this,function(){var c=typeof window!="undefined"?window:typeof s!="undefined"?s:typeof self!="undefined"?self:{};function u(D){return D&&D.__esModule&&Object.prototype.hasOwnProperty.call(D,"default")?D.default:D}function h(D,F){return F={exports:{}},D(F,F.exports),F.exports}var f=function(){return/Android/i.test(navigator.userAgent)||/iPhone|iPad|iPod/i.test(navigator.userAgent)},p=function(F,k){for(var W=0,j=F.length;W<j;W++)k[W]=F[W]},m=function(F,k){for(var W in k)k.hasOwnProperty(W)&&(F[W]=k[W]);return F},y=h(function(D,F){/**
 * @license
 * cardboard-vr-display
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * gl-preserve-state
 * Copyright (c) 2016, Brandon Jones.
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 *//**
 * @license
 * webvr-polyfill-dpdb
 * Copyright (c) 2015-2017 Google
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * nosleep.js
 * Copyright (c) 2017, Rich Tibbett
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
 * THE SOFTWARE.
 */(function(k,W){D.exports=W()})(c,function(){var k=function(ae,pe){if(!(ae instanceof pe))throw new TypeError("Cannot call a class as a function")},W=function(){function ae(pe,Ce){for(var fe=0;fe<Ce.length;fe++){var He=Ce[fe];He.enumerable=He.enumerable||!1,He.configurable=!0,"value"in He&&(He.writable=!0),Object.defineProperty(pe,He.key,He)}}return function(pe,Ce,fe){return Ce&&ae(pe.prototype,Ce),fe&&ae(pe,fe),pe}}(),j=function(){function ae(pe,Ce){var fe=[],He=!0,ot=!1,pt=void 0;try{for(var Ut=pe[Symbol.iterator](),Vt;!(He=(Vt=Ut.next()).done)&&(fe.push(Vt.value),!(Ce&&fe.length===Ce));He=!0);}catch(gt){ot=!0,pt=gt}finally{try{!He&&Ut.return&&Ut.return()}finally{if(ot)throw pt}}return fe}return function(pe,Ce){if(Array.isArray(pe))return pe;if(Symbol.iterator in Object(pe))return ae(pe,Ce);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),J=.001,de=1,te=function(pe,Ce){return"data:"+pe+","+encodeURIComponent(Ce)},N=function(pe,Ce,fe){return pe+(Ce-pe)*fe},L=function(){var ae=/iPad|iPhone|iPod/.test(navigator.platform);return function(){return ae}}(),M=function(){var ae=navigator.userAgent.indexOf("Version")!==-1&&navigator.userAgent.indexOf("Android")!==-1&&navigator.userAgent.indexOf("Chrome")!==-1;return function(){return ae}}(),I=function(){var ae=/^((?!chrome|android).)*safari/i.test(navigator.userAgent);return function(){return ae}}(),U=function(){var ae=navigator.userAgent.indexOf("Firefox")!==-1&&navigator.userAgent.indexOf("Android")!==-1;return function(){return ae}}(),$=function(){var ae=navigator.userAgent.match(/.*Chrome\/([0-9]+)/),pe=ae?parseInt(ae[1],10):null;return function(){return pe}}(),ee=function(){var ae=!1;return ae=L()&&I()&&navigator.userAgent.indexOf("13_4")!==-1,function(){return ae}}(),Q=function(){var ae=!1;if($()===65){var pe=navigator.userAgent.match(/.*Chrome\/([0-9\.]*)/);if(pe){var Ce=pe[1].split("."),fe=j(Ce,4);fe[0],fe[1];var He=fe[2],ot=fe[3];ae=parseInt(He,10)===3325&&parseInt(ot,10)<148}}return function(){return ae}}(),G=function(){var ae=navigator.userAgent.indexOf("R7 Build")!==-1;return function(){return ae}}(),K=function(){var pe=window.orientation==90||window.orientation==-90;return G()?!pe:pe},Y=function(pe){return!(isNaN(pe)||pe<=J||pe>de)},we=function(){return Math.max(window.screen.width,window.screen.height)*window.devicePixelRatio},Ke=function(){return Math.min(window.screen.width,window.screen.height)*window.devicePixelRatio},ge=function(pe){if(M())return!1;if(pe.requestFullscreen)pe.requestFullscreen();else if(pe.webkitRequestFullscreen)pe.webkitRequestFullscreen();else if(pe.mozRequestFullScreen)pe.mozRequestFullScreen();else if(pe.msRequestFullscreen)pe.msRequestFullscreen();else return!1;return!0},me=function(){if(document.exitFullscreen)document.exitFullscreen();else if(document.webkitExitFullscreen)document.webkitExitFullscreen();else if(document.mozCancelFullScreen)document.mozCancelFullScreen();else if(document.msExitFullscreen)document.msExitFullscreen();else return!1;return!0},De=function(){return document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement},ze=function(pe,Ce,fe,He){var ot=pe.createShader(pe.VERTEX_SHADER);pe.shaderSource(ot,Ce),pe.compileShader(ot);var pt=pe.createShader(pe.FRAGMENT_SHADER);pe.shaderSource(pt,fe),pe.compileShader(pt);var Ut=pe.createProgram();pe.attachShader(Ut,ot),pe.attachShader(Ut,pt);for(var Vt in He)pe.bindAttribLocation(Ut,He[Vt],Vt);return pe.linkProgram(Ut),pe.deleteShader(ot),pe.deleteShader(pt),Ut},tt=function(pe,Ce){for(var fe={},He=pe.getProgramParameter(Ce,pe.ACTIVE_UNIFORMS),ot="",pt=0;pt<He;pt++){var Ut=pe.getActiveUniform(Ce,pt);ot=Ut.name.replace("[0]",""),fe[ot]=pe.getUniformLocation(Ce,ot)}return fe},rt=function(pe,Ce,fe,He,ot,pt,Ut){var Vt=1/(Ce-fe),gt=1/(He-ot),Ot=1/(pt-Ut);return pe[0]=-2*Vt,pe[1]=0,pe[2]=0,pe[3]=0,pe[4]=0,pe[5]=-2*gt,pe[6]=0,pe[7]=0,pe[8]=0,pe[9]=0,pe[10]=2*Ot,pe[11]=0,pe[12]=(Ce+fe)*Vt,pe[13]=(ot+He)*gt,pe[14]=(Ut+pt)*Ot,pe[15]=1,pe},vt=function(){var pe=!1;return function(Ce){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(Ce)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(Ce.substr(0,4)))&&(pe=!0)}(navigator.userAgent||navigator.vendor||window.opera),pe},Ye=function(pe,Ce){for(var fe in Ce)Ce.hasOwnProperty(fe)&&(pe[fe]=Ce[fe]);return pe},Pe=function(pe){if(L()){var Ce=pe.style.width,fe=pe.style.height;pe.style.width=parseInt(Ce)+1+"px",pe.style.height=parseInt(fe)+"px",setTimeout(function(){pe.style.width=Ce,pe.style.height=fe},100)}window.canvas=pe},Be=function(){var ae=Math.PI/180,pe=Math.PI*.25;function Ce(gt,Ot,Qt,_n){var Tn=Math.tan(Ot?Ot.upDegrees*ae:pe),Ln=Math.tan(Ot?Ot.downDegrees*ae:pe),Xn=Math.tan(Ot?Ot.leftDegrees*ae:pe),Yn=Math.tan(Ot?Ot.rightDegrees*ae:pe),$n=2/(Xn+Yn),vi=2/(Tn+Ln);return gt[0]=$n,gt[1]=0,gt[2]=0,gt[3]=0,gt[4]=0,gt[5]=vi,gt[6]=0,gt[7]=0,gt[8]=-((Xn-Yn)*$n*.5),gt[9]=(Tn-Ln)*vi*.5,gt[10]=_n/(Qt-_n),gt[11]=-1,gt[12]=0,gt[13]=0,gt[14]=_n*Qt/(Qt-_n),gt[15]=0,gt}function fe(gt,Ot,Qt){var _n=Ot[0],Tn=Ot[1],Ln=Ot[2],Xn=Ot[3],Yn=_n+_n,$n=Tn+Tn,vi=Ln+Ln,Rr=_n*Yn,jr=_n*$n,Qi=_n*vi,Li=Tn*$n,Cs=Tn*vi,Rs=Ln*vi,Fr=Xn*Yn,Ls=Xn*$n,_a=Xn*vi;return gt[0]=1-(Li+Rs),gt[1]=jr+_a,gt[2]=Qi-Ls,gt[3]=0,gt[4]=jr-_a,gt[5]=1-(Rr+Rs),gt[6]=Cs+Fr,gt[7]=0,gt[8]=Qi+Ls,gt[9]=Cs-Fr,gt[10]=1-(Rr+Li),gt[11]=0,gt[12]=Qt[0],gt[13]=Qt[1],gt[14]=Qt[2],gt[15]=1,gt}function He(gt,Ot,Qt){var _n=Qt[0],Tn=Qt[1],Ln=Qt[2],Xn,Yn,$n,vi,Rr,jr,Qi,Li,Cs,Rs,Fr,Ls;return Ot===gt?(gt[12]=Ot[0]*_n+Ot[4]*Tn+Ot[8]*Ln+Ot[12],gt[13]=Ot[1]*_n+Ot[5]*Tn+Ot[9]*Ln+Ot[13],gt[14]=Ot[2]*_n+Ot[6]*Tn+Ot[10]*Ln+Ot[14],gt[15]=Ot[3]*_n+Ot[7]*Tn+Ot[11]*Ln+Ot[15]):(Xn=Ot[0],Yn=Ot[1],$n=Ot[2],vi=Ot[3],Rr=Ot[4],jr=Ot[5],Qi=Ot[6],Li=Ot[7],Cs=Ot[8],Rs=Ot[9],Fr=Ot[10],Ls=Ot[11],gt[0]=Xn,gt[1]=Yn,gt[2]=$n,gt[3]=vi,gt[4]=Rr,gt[5]=jr,gt[6]=Qi,gt[7]=Li,gt[8]=Cs,gt[9]=Rs,gt[10]=Fr,gt[11]=Ls,gt[12]=Xn*_n+Rr*Tn+Cs*Ln+Ot[12],gt[13]=Yn*_n+jr*Tn+Rs*Ln+Ot[13],gt[14]=$n*_n+Qi*Tn+Fr*Ln+Ot[14],gt[15]=vi*_n+Li*Tn+Ls*Ln+Ot[15]),gt}function ot(gt,Ot){var Qt=Ot[0],_n=Ot[1],Tn=Ot[2],Ln=Ot[3],Xn=Ot[4],Yn=Ot[5],$n=Ot[6],vi=Ot[7],Rr=Ot[8],jr=Ot[9],Qi=Ot[10],Li=Ot[11],Cs=Ot[12],Rs=Ot[13],Fr=Ot[14],Ls=Ot[15],_a=Qt*Yn-_n*Xn,wa=Qt*$n-Tn*Xn,Zc=Qt*vi-Ln*Xn,Jc=_n*$n-Tn*Yn,eu=_n*vi-Ln*Yn,tu=Tn*vi-Ln*$n,nu=Rr*Rs-jr*Cs,iu=Rr*Fr-Qi*Cs,ru=Rr*Ls-Li*Cs,su=jr*Fr-Qi*Rs,ou=jr*Ls-Li*Rs,au=Qi*Ls-Li*Fr,Nr=_a*au-wa*ou+Zc*su+Jc*ru-eu*iu+tu*nu;return Nr?(Nr=1/Nr,gt[0]=(Yn*au-$n*ou+vi*su)*Nr,gt[1]=(Tn*ou-_n*au-Ln*su)*Nr,gt[2]=(Rs*tu-Fr*eu+Ls*Jc)*Nr,gt[3]=(Qi*eu-jr*tu-Li*Jc)*Nr,gt[4]=($n*ru-Xn*au-vi*iu)*Nr,gt[5]=(Qt*au-Tn*ru+Ln*iu)*Nr,gt[6]=(Fr*Zc-Cs*tu-Ls*wa)*Nr,gt[7]=(Rr*tu-Qi*Zc+Li*wa)*Nr,gt[8]=(Xn*ou-Yn*ru+vi*nu)*Nr,gt[9]=(_n*ru-Qt*ou-Ln*nu)*Nr,gt[10]=(Cs*eu-Rs*Zc+Ls*_a)*Nr,gt[11]=(jr*Zc-Rr*eu-Li*_a)*Nr,gt[12]=(Yn*iu-Xn*su-$n*nu)*Nr,gt[13]=(Qt*su-_n*iu+Tn*nu)*Nr,gt[14]=(Rs*wa-Cs*Jc-Fr*_a)*Nr,gt[15]=(Rr*Jc-jr*wa+Qi*_a)*Nr,gt):null}var pt=new Float32Array([0,0,0,1]),Ut=new Float32Array([0,0,0]);function Vt(gt,Ot,Qt,_n,Tn,Ln){Ce(gt,_n||null,Ln.depthNear,Ln.depthFar);var Xn=Qt.orientation||pt,Yn=Qt.position||Ut;fe(Ot,Xn,Yn),Tn&&He(Ot,Ot,Tn),ot(Ot,Ot)}return function(gt,Ot,Qt){return!gt||!Ot?!1:(gt.pose=Ot,gt.timestamp=Ot.timestamp,Vt(gt.leftProjectionMatrix,gt.leftViewMatrix,Ot,Qt._getFieldOfView("left"),Qt._getEyeOffset("left"),Qt),Vt(gt.rightProjectionMatrix,gt.rightViewMatrix,Ot,Qt._getFieldOfView("right"),Qt._getEyeOffset("right"),Qt),!0)}}(),$e=function(){var pe=window.self!==window.top,Ce=Je(document.referrer),fe=Je(window.location.href);return pe&&Ce!==fe},Je=function(pe){var Ce,fe=pe.indexOf("://");fe!==-1?Ce=fe+3:Ce=0;var He=pe.indexOf("/",Ce);return He===-1&&(He=pe.length),pe.substring(0,He)},We=function(pe){if(pe.w>1)return console.warn("getQuaternionAngle: w > 1"),0;var Ce=2*Math.acos(pe.w);return Ce},_e=function(){var ae={};return function(pe,Ce){ae[pe]===void 0&&(console.warn("webvr-polyfill: "+Ce),ae[pe]=!0)}}(),Ee=function(pe,Ce){var fe=Ce?"Please use "+Ce+" instead.":"";_e(pe,pe+" has been deprecated. This may not work on native WebVR displays. "+fe)};function Oe(ae,pe,Ce){if(!pe){Ce(ae);return}for(var fe=[],He=null,ot=0;ot<pe.length;++ot){var pt=pe[ot];switch(pt){case ae.TEXTURE_BINDING_2D:case ae.TEXTURE_BINDING_CUBE_MAP:var Ut=pe[++ot];if(Ut<ae.TEXTURE0||Ut>ae.TEXTURE31){console.error("TEXTURE_BINDING_2D or TEXTURE_BINDING_CUBE_MAP must be followed by a valid texture unit"),fe.push(null,null);break}He||(He=ae.getParameter(ae.ACTIVE_TEXTURE)),ae.activeTexture(Ut),fe.push(ae.getParameter(pt),null);break;case ae.ACTIVE_TEXTURE:He=ae.getParameter(ae.ACTIVE_TEXTURE),fe.push(null);break;default:fe.push(ae.getParameter(pt));break}}Ce(ae);for(var ot=0;ot<pe.length;++ot){var pt=pe[ot],Vt=fe[ot];switch(pt){case ae.ACTIVE_TEXTURE:break;case ae.ARRAY_BUFFER_BINDING:ae.bindBuffer(ae.ARRAY_BUFFER,Vt);break;case ae.COLOR_CLEAR_VALUE:ae.clearColor(Vt[0],Vt[1],Vt[2],Vt[3]);break;case ae.COLOR_WRITEMASK:ae.colorMask(Vt[0],Vt[1],Vt[2],Vt[3]);break;case ae.CURRENT_PROGRAM:ae.useProgram(Vt);break;case ae.ELEMENT_ARRAY_BUFFER_BINDING:ae.bindBuffer(ae.ELEMENT_ARRAY_BUFFER,Vt);break;case ae.FRAMEBUFFER_BINDING:ae.bindFramebuffer(ae.FRAMEBUFFER,Vt);break;case ae.RENDERBUFFER_BINDING:ae.bindRenderbuffer(ae.RENDERBUFFER,Vt);break;case ae.TEXTURE_BINDING_2D:var Ut=pe[++ot];if(Ut<ae.TEXTURE0||Ut>ae.TEXTURE31)break;ae.activeTexture(Ut),ae.bindTexture(ae.TEXTURE_2D,Vt);break;case ae.TEXTURE_BINDING_CUBE_MAP:var Ut=pe[++ot];if(Ut<ae.TEXTURE0||Ut>ae.TEXTURE31)break;ae.activeTexture(Ut),ae.bindTexture(ae.TEXTURE_CUBE_MAP,Vt);break;case ae.VIEWPORT:ae.viewport(Vt[0],Vt[1],Vt[2],Vt[3]);break;case ae.BLEND:case ae.CULL_FACE:case ae.DEPTH_TEST:case ae.SCISSOR_TEST:case ae.STENCIL_TEST:Vt?ae.enable(pt):ae.disable(pt);break;default:console.log("No GL restore behavior for 0x"+pt.toString(16));break}He&&ae.activeTexture(He)}}var Le=Oe,ce=["attribute vec2 position;","attribute vec3 texCoord;","varying vec2 vTexCoord;","uniform vec4 viewportOffsetScale[2];","void main() {","  vec4 viewport = viewportOffsetScale[int(texCoord.z)];","  vTexCoord = (texCoord.xy * viewport.zw) + viewport.xy;","  gl_Position = vec4( position, 1.0, 1.0 );","}"].join(`
`),he=["precision mediump float;","uniform sampler2D diffuse;","varying vec2 vTexCoord;","void main() {","  gl_FragColor = texture2D(diffuse, vTexCoord);","}"].join(`
`);function ie(ae,pe,Ce,fe){this.gl=ae,this.cardboardUI=pe,this.bufferScale=Ce,this.dirtySubmitFrameBindings=fe,this.ctxAttribs=ae.getContextAttributes(),this.instanceExt=ae.getExtension("ANGLE_instanced_arrays"),this.meshWidth=20,this.meshHeight=20,this.bufferWidth=ae.drawingBufferWidth,this.bufferHeight=ae.drawingBufferHeight,this.realBindFramebuffer=ae.bindFramebuffer,this.realEnable=ae.enable,this.realDisable=ae.disable,this.realColorMask=ae.colorMask,this.realClearColor=ae.clearColor,this.realViewport=ae.viewport,L()||(this.realCanvasWidth=Object.getOwnPropertyDescriptor(ae.canvas.__proto__,"width"),this.realCanvasHeight=Object.getOwnPropertyDescriptor(ae.canvas.__proto__,"height")),this.isPatched=!1,this.lastBoundFramebuffer=null,this.cullFace=!1,this.depthTest=!1,this.blend=!1,this.scissorTest=!1,this.stencilTest=!1,this.viewport=[0,0,0,0],this.colorMask=[!0,!0,!0,!0],this.clearColor=[0,0,0,0],this.attribs={position:0,texCoord:1},this.program=ze(ae,ce,he,this.attribs),this.uniforms=tt(ae,this.program),this.viewportOffsetScale=new Float32Array(8),this.setTextureBounds(),this.vertexBuffer=ae.createBuffer(),this.indexBuffer=ae.createBuffer(),this.indexCount=0,this.renderTarget=ae.createTexture(),this.framebuffer=ae.createFramebuffer(),this.depthStencilBuffer=null,this.depthBuffer=null,this.stencilBuffer=null,this.ctxAttribs.depth&&this.ctxAttribs.stencil?this.depthStencilBuffer=ae.createRenderbuffer():this.ctxAttribs.depth?this.depthBuffer=ae.createRenderbuffer():this.ctxAttribs.stencil&&(this.stencilBuffer=ae.createRenderbuffer()),this.patch(),this.onResize()}ie.prototype.destroy=function(){var ae=this.gl;this.unpatch(),ae.deleteProgram(this.program),ae.deleteBuffer(this.vertexBuffer),ae.deleteBuffer(this.indexBuffer),ae.deleteTexture(this.renderTarget),ae.deleteFramebuffer(this.framebuffer),this.depthStencilBuffer&&ae.deleteRenderbuffer(this.depthStencilBuffer),this.depthBuffer&&ae.deleteRenderbuffer(this.depthBuffer),this.stencilBuffer&&ae.deleteRenderbuffer(this.stencilBuffer),this.cardboardUI&&this.cardboardUI.destroy()},ie.prototype.onResize=function(){var ae=this.gl,pe=this,Ce=[ae.RENDERBUFFER_BINDING,ae.TEXTURE_BINDING_2D,ae.TEXTURE0];Le(ae,Ce,function(fe){pe.realBindFramebuffer.call(fe,fe.FRAMEBUFFER,null),pe.scissorTest&&pe.realDisable.call(fe,fe.SCISSOR_TEST),pe.realColorMask.call(fe,!0,!0,!0,!0),pe.realViewport.call(fe,0,0,fe.drawingBufferWidth,fe.drawingBufferHeight),pe.realClearColor.call(fe,0,0,0,1),fe.clear(fe.COLOR_BUFFER_BIT),pe.realBindFramebuffer.call(fe,fe.FRAMEBUFFER,pe.framebuffer),fe.bindTexture(fe.TEXTURE_2D,pe.renderTarget),fe.texImage2D(fe.TEXTURE_2D,0,pe.ctxAttribs.alpha?fe.RGBA:fe.RGB,pe.bufferWidth,pe.bufferHeight,0,pe.ctxAttribs.alpha?fe.RGBA:fe.RGB,fe.UNSIGNED_BYTE,null),fe.texParameteri(fe.TEXTURE_2D,fe.TEXTURE_MAG_FILTER,fe.LINEAR),fe.texParameteri(fe.TEXTURE_2D,fe.TEXTURE_MIN_FILTER,fe.LINEAR),fe.texParameteri(fe.TEXTURE_2D,fe.TEXTURE_WRAP_S,fe.CLAMP_TO_EDGE),fe.texParameteri(fe.TEXTURE_2D,fe.TEXTURE_WRAP_T,fe.CLAMP_TO_EDGE),fe.framebufferTexture2D(fe.FRAMEBUFFER,fe.COLOR_ATTACHMENT0,fe.TEXTURE_2D,pe.renderTarget,0),pe.ctxAttribs.depth&&pe.ctxAttribs.stencil?(fe.bindRenderbuffer(fe.RENDERBUFFER,pe.depthStencilBuffer),fe.renderbufferStorage(fe.RENDERBUFFER,fe.DEPTH_STENCIL,pe.bufferWidth,pe.bufferHeight),fe.framebufferRenderbuffer(fe.FRAMEBUFFER,fe.DEPTH_STENCIL_ATTACHMENT,fe.RENDERBUFFER,pe.depthStencilBuffer)):pe.ctxAttribs.depth?(fe.bindRenderbuffer(fe.RENDERBUFFER,pe.depthBuffer),fe.renderbufferStorage(fe.RENDERBUFFER,fe.DEPTH_COMPONENT16,pe.bufferWidth,pe.bufferHeight),fe.framebufferRenderbuffer(fe.FRAMEBUFFER,fe.DEPTH_ATTACHMENT,fe.RENDERBUFFER,pe.depthBuffer)):pe.ctxAttribs.stencil&&(fe.bindRenderbuffer(fe.RENDERBUFFER,pe.stencilBuffer),fe.renderbufferStorage(fe.RENDERBUFFER,fe.STENCIL_INDEX8,pe.bufferWidth,pe.bufferHeight),fe.framebufferRenderbuffer(fe.FRAMEBUFFER,fe.STENCIL_ATTACHMENT,fe.RENDERBUFFER,pe.stencilBuffer)),!fe.checkFramebufferStatus(fe.FRAMEBUFFER)===fe.FRAMEBUFFER_COMPLETE&&console.error("Framebuffer incomplete!"),pe.realBindFramebuffer.call(fe,fe.FRAMEBUFFER,pe.lastBoundFramebuffer),pe.scissorTest&&pe.realEnable.call(fe,fe.SCISSOR_TEST),pe.realColorMask.apply(fe,pe.colorMask),pe.realViewport.apply(fe,pe.viewport),pe.realClearColor.apply(fe,pe.clearColor)}),this.cardboardUI&&this.cardboardUI.onResize()},ie.prototype.patch=function(){if(!this.isPatched){var ae=this,pe=this.gl.canvas,Ce=this.gl;L()||(pe.width=we()*this.bufferScale,pe.height=Ke()*this.bufferScale,Object.defineProperty(pe,"width",{configurable:!0,enumerable:!0,get:function(){return ae.bufferWidth},set:function(He){ae.bufferWidth=He,ae.realCanvasWidth.set.call(pe,He),ae.onResize()}}),Object.defineProperty(pe,"height",{configurable:!0,enumerable:!0,get:function(){return ae.bufferHeight},set:function(He){ae.bufferHeight=He,ae.realCanvasHeight.set.call(pe,He),ae.onResize()}})),this.lastBoundFramebuffer=Ce.getParameter(Ce.FRAMEBUFFER_BINDING),this.lastBoundFramebuffer==null&&(this.lastBoundFramebuffer=this.framebuffer,this.gl.bindFramebuffer(Ce.FRAMEBUFFER,this.framebuffer)),this.gl.bindFramebuffer=function(fe,He){ae.lastBoundFramebuffer=He||ae.framebuffer,ae.realBindFramebuffer.call(Ce,fe,ae.lastBoundFramebuffer)},this.cullFace=Ce.getParameter(Ce.CULL_FACE),this.depthTest=Ce.getParameter(Ce.DEPTH_TEST),this.blend=Ce.getParameter(Ce.BLEND),this.scissorTest=Ce.getParameter(Ce.SCISSOR_TEST),this.stencilTest=Ce.getParameter(Ce.STENCIL_TEST),Ce.enable=function(fe){switch(fe){case Ce.CULL_FACE:ae.cullFace=!0;break;case Ce.DEPTH_TEST:ae.depthTest=!0;break;case Ce.BLEND:ae.blend=!0;break;case Ce.SCISSOR_TEST:ae.scissorTest=!0;break;case Ce.STENCIL_TEST:ae.stencilTest=!0;break}ae.realEnable.call(Ce,fe)},Ce.disable=function(fe){switch(fe){case Ce.CULL_FACE:ae.cullFace=!1;break;case Ce.DEPTH_TEST:ae.depthTest=!1;break;case Ce.BLEND:ae.blend=!1;break;case Ce.SCISSOR_TEST:ae.scissorTest=!1;break;case Ce.STENCIL_TEST:ae.stencilTest=!1;break}ae.realDisable.call(Ce,fe)},this.colorMask=Ce.getParameter(Ce.COLOR_WRITEMASK),Ce.colorMask=function(fe,He,ot,pt){ae.colorMask[0]=fe,ae.colorMask[1]=He,ae.colorMask[2]=ot,ae.colorMask[3]=pt,ae.realColorMask.call(Ce,fe,He,ot,pt)},this.clearColor=Ce.getParameter(Ce.COLOR_CLEAR_VALUE),Ce.clearColor=function(fe,He,ot,pt){ae.clearColor[0]=fe,ae.clearColor[1]=He,ae.clearColor[2]=ot,ae.clearColor[3]=pt,ae.realClearColor.call(Ce,fe,He,ot,pt)},this.viewport=Ce.getParameter(Ce.VIEWPORT),Ce.viewport=function(fe,He,ot,pt){ae.viewport[0]=fe,ae.viewport[1]=He,ae.viewport[2]=ot,ae.viewport[3]=pt,ae.realViewport.call(Ce,fe,He,ot,pt)},this.isPatched=!0,Pe(pe)}},ie.prototype.unpatch=function(){if(!!this.isPatched){var ae=this.gl,pe=this.gl.canvas;L()||(Object.defineProperty(pe,"width",this.realCanvasWidth),Object.defineProperty(pe,"height",this.realCanvasHeight)),pe.width=this.bufferWidth,pe.height=this.bufferHeight,ae.bindFramebuffer=this.realBindFramebuffer,ae.enable=this.realEnable,ae.disable=this.realDisable,ae.colorMask=this.realColorMask,ae.clearColor=this.realClearColor,ae.viewport=this.realViewport,this.lastBoundFramebuffer==this.framebuffer&&ae.bindFramebuffer(ae.FRAMEBUFFER,null),this.isPatched=!1,setTimeout(function(){Pe(pe)},1)}},ie.prototype.setTextureBounds=function(ae,pe){ae||(ae=[0,0,.5,1]),pe||(pe=[.5,0,.5,1]),this.viewportOffsetScale[0]=ae[0],this.viewportOffsetScale[1]=ae[1],this.viewportOffsetScale[2]=ae[2],this.viewportOffsetScale[3]=ae[3],this.viewportOffsetScale[4]=pe[0],this.viewportOffsetScale[5]=pe[1],this.viewportOffsetScale[6]=pe[2],this.viewportOffsetScale[7]=pe[3]},ie.prototype.submitFrame=function(){var ae=this.gl,pe=this,Ce=[];if(this.dirtySubmitFrameBindings||Ce.push(ae.CURRENT_PROGRAM,ae.ARRAY_BUFFER_BINDING,ae.ELEMENT_ARRAY_BUFFER_BINDING,ae.TEXTURE_BINDING_2D,ae.TEXTURE0),Le(ae,Ce,function(He){pe.realBindFramebuffer.call(He,He.FRAMEBUFFER,null);var ot=0,pt=0;pe.instanceExt&&(ot=He.getVertexAttrib(pe.attribs.position,pe.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE),pt=He.getVertexAttrib(pe.attribs.texCoord,pe.instanceExt.VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE)),pe.cullFace&&pe.realDisable.call(He,He.CULL_FACE),pe.depthTest&&pe.realDisable.call(He,He.DEPTH_TEST),pe.blend&&pe.realDisable.call(He,He.BLEND),pe.scissorTest&&pe.realDisable.call(He,He.SCISSOR_TEST),pe.stencilTest&&pe.realDisable.call(He,He.STENCIL_TEST),pe.realColorMask.call(He,!0,!0,!0,!0),pe.realViewport.call(He,0,0,He.drawingBufferWidth,He.drawingBufferHeight),(pe.ctxAttribs.alpha||L())&&(pe.realClearColor.call(He,0,0,0,1),He.clear(He.COLOR_BUFFER_BIT)),He.useProgram(pe.program),He.bindBuffer(He.ELEMENT_ARRAY_BUFFER,pe.indexBuffer),He.bindBuffer(He.ARRAY_BUFFER,pe.vertexBuffer),He.enableVertexAttribArray(pe.attribs.position),He.enableVertexAttribArray(pe.attribs.texCoord),He.vertexAttribPointer(pe.attribs.position,2,He.FLOAT,!1,20,0),He.vertexAttribPointer(pe.attribs.texCoord,3,He.FLOAT,!1,20,8),pe.instanceExt&&(ot!=0&&pe.instanceExt.vertexAttribDivisorANGLE(pe.attribs.position,0),pt!=0&&pe.instanceExt.vertexAttribDivisorANGLE(pe.attribs.texCoord,0)),He.activeTexture(He.TEXTURE0),He.uniform1i(pe.uniforms.diffuse,0),He.bindTexture(He.TEXTURE_2D,pe.renderTarget),He.uniform4fv(pe.uniforms.viewportOffsetScale,pe.viewportOffsetScale),He.drawElements(He.TRIANGLES,pe.indexCount,He.UNSIGNED_SHORT,0),pe.cardboardUI&&pe.cardboardUI.renderNoState(),pe.realBindFramebuffer.call(pe.gl,He.FRAMEBUFFER,pe.framebuffer),pe.ctxAttribs.preserveDrawingBuffer||(pe.realClearColor.call(He,0,0,0,0),He.clear(He.COLOR_BUFFER_BIT)),pe.dirtySubmitFrameBindings||pe.realBindFramebuffer.call(He,He.FRAMEBUFFER,pe.lastBoundFramebuffer),pe.cullFace&&pe.realEnable.call(He,He.CULL_FACE),pe.depthTest&&pe.realEnable.call(He,He.DEPTH_TEST),pe.blend&&pe.realEnable.call(He,He.BLEND),pe.scissorTest&&pe.realEnable.call(He,He.SCISSOR_TEST),pe.stencilTest&&pe.realEnable.call(He,He.STENCIL_TEST),pe.realColorMask.apply(He,pe.colorMask),pe.realViewport.apply(He,pe.viewport),(pe.ctxAttribs.alpha||!pe.ctxAttribs.preserveDrawingBuffer)&&pe.realClearColor.apply(He,pe.clearColor),pe.instanceExt&&(ot!=0&&pe.instanceExt.vertexAttribDivisorANGLE(pe.attribs.position,ot),pt!=0&&pe.instanceExt.vertexAttribDivisorANGLE(pe.attribs.texCoord,pt))}),L()){var fe=ae.canvas;(fe.width!=pe.bufferWidth||fe.height!=pe.bufferHeight)&&(pe.bufferWidth=fe.width,pe.bufferHeight=fe.height,pe.onResize())}},ie.prototype.updateDeviceInfo=function(ae){var pe=this.gl,Ce=this,fe=[pe.ARRAY_BUFFER_BINDING,pe.ELEMENT_ARRAY_BUFFER_BINDING];Le(pe,fe,function(He){var ot=Ce.computeMeshVertices_(Ce.meshWidth,Ce.meshHeight,ae);if(He.bindBuffer(He.ARRAY_BUFFER,Ce.vertexBuffer),He.bufferData(He.ARRAY_BUFFER,ot,He.STATIC_DRAW),!Ce.indexCount){var pt=Ce.computeMeshIndices_(Ce.meshWidth,Ce.meshHeight);He.bindBuffer(He.ELEMENT_ARRAY_BUFFER,Ce.indexBuffer),He.bufferData(He.ELEMENT_ARRAY_BUFFER,pt,He.STATIC_DRAW),Ce.indexCount=pt.length}})},ie.prototype.computeMeshVertices_=function(ae,pe,Ce){for(var fe=new Float32Array(2*ae*pe*5),He=Ce.getLeftEyeVisibleTanAngles(),ot=Ce.getLeftEyeNoLensTanAngles(),pt=Ce.getLeftEyeVisibleScreenRect(ot),Ut=0,Vt=0;Vt<2;Vt++){for(var gt=0;gt<pe;gt++)for(var Ot=0;Ot<ae;Ot++,Ut++){var Qt=Ot/(ae-1),_n=gt/(pe-1),Tn=Qt,Ln=_n,Xn=N(He[0],He[2],Qt),Yn=N(He[3],He[1],_n),$n=Math.sqrt(Xn*Xn+Yn*Yn),vi=Ce.distortion.distortInverse($n),Rr=Xn*vi/$n,jr=Yn*vi/$n;Qt=(Rr-ot[0])/(ot[2]-ot[0]),_n=(jr-ot[3])/(ot[1]-ot[3]),Qt=(pt.x+Qt*pt.width-.5)*2,_n=(pt.y+_n*pt.height-.5)*2,fe[Ut*5+0]=Qt,fe[Ut*5+1]=_n,fe[Ut*5+2]=Tn,fe[Ut*5+3]=Ln,fe[Ut*5+4]=Vt}var Qi=He[2]-He[0];He[0]=-(Qi+He[0]),He[2]=Qi-He[2],Qi=ot[2]-ot[0],ot[0]=-(Qi+ot[0]),ot[2]=Qi-ot[2],pt.x=1-(pt.x+pt.width)}return fe},ie.prototype.computeMeshIndices_=function(ae,pe){for(var Ce=new Uint16Array(2*(ae-1)*(pe-1)*6),fe=ae/2,He=pe/2,ot=0,pt=0,Ut=0;Ut<2;Ut++)for(var Vt=0;Vt<pe;Vt++)for(var gt=0;gt<ae;gt++,ot++)gt==0||Vt==0||(gt<=fe==Vt<=He?(Ce[pt++]=ot,Ce[pt++]=ot-ae-1,Ce[pt++]=ot-ae,Ce[pt++]=ot-ae-1,Ce[pt++]=ot,Ce[pt++]=ot-1):(Ce[pt++]=ot-1,Ce[pt++]=ot-ae,Ce[pt++]=ot,Ce[pt++]=ot-ae,Ce[pt++]=ot-1,Ce[pt++]=ot-ae-1));return Ce},ie.prototype.getOwnPropertyDescriptor_=function(ae,pe){var Ce=Object.getOwnPropertyDescriptor(ae,pe);return(Ce.get===void 0||Ce.set===void 0)&&(Ce.configurable=!0,Ce.enumerable=!0,Ce.get=function(){return this.getAttribute(pe)},Ce.set=function(fe){this.setAttribute(pe,fe)}),Ce};var V=["attribute vec2 position;","uniform mat4 projectionMat;","void main() {","  gl_Position = projectionMat * vec4( position, -1.0, 1.0 );","}"].join(`
`),Z=["precision mediump float;","uniform vec4 color;","void main() {","  gl_FragColor = color;","}"].join(`
`),B=Math.PI/180,S=60,R=12,X=20,xe=1,Ie=.75,ye=.3125,nt=4,at=28,mt=1.5;function wt(ae){this.gl=ae,this.attribs={position:0},this.program=ze(ae,V,Z,this.attribs),this.uniforms=tt(ae,this.program),this.vertexBuffer=ae.createBuffer(),this.gearOffset=0,this.gearVertexCount=0,this.arrowOffset=0,this.arrowVertexCount=0,this.projMat=new Float32Array(16),this.listener=null,this.onResize()}wt.prototype.destroy=function(){var ae=this.gl;this.listener&&ae.canvas.removeEventListener("click",this.listener,!1),ae.deleteProgram(this.program),ae.deleteBuffer(this.vertexBuffer)},wt.prototype.listen=function(ae,pe){var Ce=this.gl.canvas;this.listener=function(fe){var He=Ce.clientWidth/2,ot=at*mt;fe.clientX>He-ot&&fe.clientX<He+ot&&fe.clientY>Ce.clientHeight-ot?ae(fe):fe.clientX<ot&&fe.clientY<ot&&pe(fe)},Ce.addEventListener("click",this.listener,!1)},wt.prototype.onResize=function(){var ae=this.gl,pe=this,Ce=[ae.ARRAY_BUFFER_BINDING];Le(ae,Ce,function(fe){var He=[],ot=fe.drawingBufferWidth/2,pt=Math.max(screen.width,screen.height)*window.devicePixelRatio,Ut=fe.drawingBufferWidth/pt,Vt=Ut*window.devicePixelRatio,gt=nt*Vt/2,Ot=at*mt*Vt,Qt=at*Vt/2,_n=(at*mt-at)*Vt;He.push(ot-gt,Ot),He.push(ot-gt,fe.drawingBufferHeight),He.push(ot+gt,Ot),He.push(ot+gt,fe.drawingBufferHeight),pe.gearOffset=He.length/2;function Tn(vi,Rr){var jr=(90-vi)*B,Qi=Math.cos(jr),Li=Math.sin(jr);He.push(ye*Qi*Qt+ot,ye*Li*Qt+Qt),He.push(Rr*Qi*Qt+ot,Rr*Li*Qt+Qt)}for(var Ln=0;Ln<=6;Ln++){var Xn=Ln*S;Tn(Xn,xe),Tn(Xn+R,xe),Tn(Xn+X,Ie),Tn(Xn+(S-X),Ie),Tn(Xn+(S-R),xe)}pe.gearVertexCount=He.length/2-pe.gearOffset,pe.arrowOffset=He.length/2;function Yn(vi,Rr){He.push(_n+vi,fe.drawingBufferHeight-_n-Rr)}var $n=gt/Math.sin(45*B);Yn(0,Qt),Yn(Qt,0),Yn(Qt+$n,$n),Yn($n,Qt+$n),Yn($n,Qt-$n),Yn(0,Qt),Yn(Qt,Qt*2),Yn(Qt+$n,Qt*2-$n),Yn($n,Qt-$n),Yn(0,Qt),Yn($n,Qt-gt),Yn(at*Vt,Qt-gt),Yn($n,Qt+gt),Yn(at*Vt,Qt+gt),pe.arrowVertexCount=He.length/2-pe.arrowOffset,fe.bindBuffer(fe.ARRAY_BUFFER,pe.vertexBuffer),fe.bufferData(fe.ARRAY_BUFFER,new Float32Array(He),fe.STATIC_DRAW)})},wt.prototype.render=function(){var ae=this.gl,pe=this,Ce=[ae.CULL_FACE,ae.DEPTH_TEST,ae.BLEND,ae.SCISSOR_TEST,ae.STENCIL_TEST,ae.COLOR_WRITEMASK,ae.VIEWPORT,ae.CURRENT_PROGRAM,ae.ARRAY_BUFFER_BINDING];Le(ae,Ce,function(fe){fe.disable(fe.CULL_FACE),fe.disable(fe.DEPTH_TEST),fe.disable(fe.BLEND),fe.disable(fe.SCISSOR_TEST),fe.disable(fe.STENCIL_TEST),fe.colorMask(!0,!0,!0,!0),fe.viewport(0,0,fe.drawingBufferWidth,fe.drawingBufferHeight),pe.renderNoState()})},wt.prototype.renderNoState=function(){var ae=this.gl;ae.useProgram(this.program),ae.bindBuffer(ae.ARRAY_BUFFER,this.vertexBuffer),ae.enableVertexAttribArray(this.attribs.position),ae.vertexAttribPointer(this.attribs.position,2,ae.FLOAT,!1,8,0),ae.uniform4f(this.uniforms.color,1,1,1,1),rt(this.projMat,0,ae.drawingBufferWidth,0,ae.drawingBufferHeight,.1,1024),ae.uniformMatrix4fv(this.uniforms.projectionMat,!1,this.projMat),ae.drawArrays(ae.TRIANGLE_STRIP,0,4),ae.drawArrays(ae.TRIANGLE_STRIP,this.gearOffset,this.gearVertexCount),ae.drawArrays(ae.TRIANGLE_STRIP,this.arrowOffset,this.arrowVertexCount)};function Lt(ae){this.coefficients=ae}Lt.prototype.distortInverse=function(ae){for(var pe=0,Ce=1,fe=ae-this.distort(pe);Math.abs(Ce-pe)>1e-4;){var He=ae-this.distort(Ce),ot=Ce-He*((Ce-pe)/(He-fe));pe=Ce,Ce=ot,fe=He}return Ce},Lt.prototype.distort=function(ae){for(var pe=ae*ae,Ce=0,fe=0;fe<this.coefficients.length;fe++)Ce=pe*(Ce+this.coefficients[fe]);return(Ce+1)*ae};var Ct=Math.PI/180,ut=180/Math.PI,St=function(pe,Ce,fe){this.x=pe||0,this.y=Ce||0,this.z=fe||0};St.prototype={constructor:St,set:function(pe,Ce,fe){return this.x=pe,this.y=Ce,this.z=fe,this},copy:function(pe){return this.x=pe.x,this.y=pe.y,this.z=pe.z,this},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},normalize:function(){var pe=this.length();if(pe!==0){var Ce=1/pe;this.multiplyScalar(Ce)}else this.x=0,this.y=0,this.z=0;return this},multiplyScalar:function(pe){this.x*=pe,this.y*=pe,this.z*=pe},applyQuaternion:function(pe){var Ce=this.x,fe=this.y,He=this.z,ot=pe.x,pt=pe.y,Ut=pe.z,Vt=pe.w,gt=Vt*Ce+pt*He-Ut*fe,Ot=Vt*fe+Ut*Ce-ot*He,Qt=Vt*He+ot*fe-pt*Ce,_n=-ot*Ce-pt*fe-Ut*He;return this.x=gt*Vt+_n*-ot+Ot*-Ut-Qt*-pt,this.y=Ot*Vt+_n*-pt+Qt*-ot-gt*-Ut,this.z=Qt*Vt+_n*-Ut+gt*-pt-Ot*-ot,this},dot:function(pe){return this.x*pe.x+this.y*pe.y+this.z*pe.z},crossVectors:function(pe,Ce){var fe=pe.x,He=pe.y,ot=pe.z,pt=Ce.x,Ut=Ce.y,Vt=Ce.z;return this.x=He*Vt-ot*Ut,this.y=ot*pt-fe*Vt,this.z=fe*Ut-He*pt,this}};var Tt=function(pe,Ce,fe,He){this.x=pe||0,this.y=Ce||0,this.z=fe||0,this.w=He!==void 0?He:1};Tt.prototype={constructor:Tt,set:function(pe,Ce,fe,He){return this.x=pe,this.y=Ce,this.z=fe,this.w=He,this},copy:function(pe){return this.x=pe.x,this.y=pe.y,this.z=pe.z,this.w=pe.w,this},setFromEulerXYZ:function(pe,Ce,fe){var He=Math.cos(pe/2),ot=Math.cos(Ce/2),pt=Math.cos(fe/2),Ut=Math.sin(pe/2),Vt=Math.sin(Ce/2),gt=Math.sin(fe/2);return this.x=Ut*ot*pt+He*Vt*gt,this.y=He*Vt*pt-Ut*ot*gt,this.z=He*ot*gt+Ut*Vt*pt,this.w=He*ot*pt-Ut*Vt*gt,this},setFromEulerYXZ:function(pe,Ce,fe){var He=Math.cos(pe/2),ot=Math.cos(Ce/2),pt=Math.cos(fe/2),Ut=Math.sin(pe/2),Vt=Math.sin(Ce/2),gt=Math.sin(fe/2);return this.x=Ut*ot*pt+He*Vt*gt,this.y=He*Vt*pt-Ut*ot*gt,this.z=He*ot*gt-Ut*Vt*pt,this.w=He*ot*pt+Ut*Vt*gt,this},setFromAxisAngle:function(pe,Ce){var fe=Ce/2,He=Math.sin(fe);return this.x=pe.x*He,this.y=pe.y*He,this.z=pe.z*He,this.w=Math.cos(fe),this},multiply:function(pe){return this.multiplyQuaternions(this,pe)},multiplyQuaternions:function(pe,Ce){var fe=pe.x,He=pe.y,ot=pe.z,pt=pe.w,Ut=Ce.x,Vt=Ce.y,gt=Ce.z,Ot=Ce.w;return this.x=fe*Ot+pt*Ut+He*gt-ot*Vt,this.y=He*Ot+pt*Vt+ot*Ut-fe*gt,this.z=ot*Ot+pt*gt+fe*Vt-He*Ut,this.w=pt*Ot-fe*Ut-He*Vt-ot*gt,this},inverse:function(){return this.x*=-1,this.y*=-1,this.z*=-1,this.normalize(),this},normalize:function(){var pe=Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w);return pe===0?(this.x=0,this.y=0,this.z=0,this.w=1):(pe=1/pe,this.x=this.x*pe,this.y=this.y*pe,this.z=this.z*pe,this.w=this.w*pe),this},slerp:function(pe,Ce){if(Ce===0)return this;if(Ce===1)return this.copy(pe);var fe=this.x,He=this.y,ot=this.z,pt=this.w,Ut=pt*pe.w+fe*pe.x+He*pe.y+ot*pe.z;if(Ut<0?(this.w=-pe.w,this.x=-pe.x,this.y=-pe.y,this.z=-pe.z,Ut=-Ut):this.copy(pe),Ut>=1)return this.w=pt,this.x=fe,this.y=He,this.z=ot,this;var Vt=Math.acos(Ut),gt=Math.sqrt(1-Ut*Ut);if(Math.abs(gt)<.001)return this.w=.5*(pt+this.w),this.x=.5*(fe+this.x),this.y=.5*(He+this.y),this.z=.5*(ot+this.z),this;var Ot=Math.sin((1-Ce)*Vt)/gt,Qt=Math.sin(Ce*Vt)/gt;return this.w=pt*Ot+this.w*Qt,this.x=fe*Ot+this.x*Qt,this.y=He*Ot+this.y*Qt,this.z=ot*Ot+this.z*Qt,this},setFromUnitVectors:function(){var ae,pe,Ce=1e-6;return function(fe,He){return ae===void 0&&(ae=new St),pe=fe.dot(He)+1,pe<Ce?(pe=0,Math.abs(fe.x)>Math.abs(fe.z)?ae.set(-fe.y,fe.x,0):ae.set(0,-fe.z,fe.y)):ae.crossVectors(fe,He),this.x=ae.x,this.y=ae.y,this.z=ae.z,this.w=pe,this.normalize(),this}}()};function gn(ae){this.width=ae.width||we(),this.height=ae.height||Ke(),this.widthMeters=ae.widthMeters,this.heightMeters=ae.heightMeters,this.bevelMeters=ae.bevelMeters}var An=new gn({widthMeters:.11,heightMeters:.062,bevelMeters:.004}),un=new gn({widthMeters:.1038,heightMeters:.0584,bevelMeters:.004}),Mn={CardboardV1:new wn({id:"CardboardV1",label:"Cardboard I/O 2014",fov:40,interLensDistance:.06,baselineLensDistance:.035,screenLensDistance:.042,distortionCoefficients:[.441,.156],inverseCoefficients:[-.4410035,.42756155,-.4804439,.5460139,-.58821183,.5733938,-.48303202,.33299083,-.17573841,.0651772,-.01488963,.001559834]}),CardboardV2:new wn({id:"CardboardV2",label:"Cardboard I/O 2015",fov:60,interLensDistance:.064,baselineLensDistance:.035,screenLensDistance:.039,distortionCoefficients:[.34,.55],inverseCoefficients:[-.33836704,-.18162185,.862655,-1.2462051,1.0560602,-.58208317,.21609078,-.05444823,.009177956,-.0009904169,6183535e-11,-16981803e-13]})};function Cn(ae,pe){this.viewer=Mn.CardboardV2,this.updateDeviceParams(ae),this.distortion=new Lt(this.viewer.distortionCoefficients);for(var Ce=0;Ce<pe.length;Ce++){var fe=pe[Ce];Mn[fe.id]=new wn(fe)}}Cn.prototype.updateDeviceParams=function(ae){this.device=this.determineDevice_(ae)||this.device},Cn.prototype.getDevice=function(){return this.device},Cn.prototype.setViewer=function(ae){this.viewer=ae,this.distortion=new Lt(this.viewer.distortionCoefficients)},Cn.prototype.determineDevice_=function(ae){if(!ae)return L()?(console.warn("Using fallback iOS device measurements."),un):(console.warn("Using fallback Android device measurements."),An);var pe=.0254,Ce=pe/ae.xdpi,fe=pe/ae.ydpi,He=we(),ot=Ke();return new gn({widthMeters:Ce*He,heightMeters:fe*ot,bevelMeters:ae.bevelMm*.001})},Cn.prototype.getDistortedFieldOfViewLeftEye=function(){var ae=this.viewer,pe=this.device,Ce=this.distortion,fe=ae.screenLensDistance,He=(pe.widthMeters-ae.interLensDistance)/2,ot=ae.interLensDistance/2,pt=ae.baselineLensDistance-pe.bevelMeters,Ut=pe.heightMeters-pt,Vt=ut*Math.atan(Ce.distort(He/fe)),gt=ut*Math.atan(Ce.distort(ot/fe)),Ot=ut*Math.atan(Ce.distort(pt/fe)),Qt=ut*Math.atan(Ce.distort(Ut/fe));return{leftDegrees:Math.min(Vt,ae.fov),rightDegrees:Math.min(gt,ae.fov),downDegrees:Math.min(Ot,ae.fov),upDegrees:Math.min(Qt,ae.fov)}},Cn.prototype.getLeftEyeVisibleTanAngles=function(){var ae=this.viewer,pe=this.device,Ce=this.distortion,fe=Math.tan(-Ct*ae.fov),He=Math.tan(Ct*ae.fov),ot=Math.tan(Ct*ae.fov),pt=Math.tan(-Ct*ae.fov),Ut=pe.widthMeters/4,Vt=pe.heightMeters/2,gt=ae.baselineLensDistance-pe.bevelMeters-Vt,Ot=ae.interLensDistance/2-Ut,Qt=-gt,_n=ae.screenLensDistance,Tn=Ce.distort((Ot-Ut)/_n),Ln=Ce.distort((Qt+Vt)/_n),Xn=Ce.distort((Ot+Ut)/_n),Yn=Ce.distort((Qt-Vt)/_n),$n=new Float32Array(4);return $n[0]=Math.max(fe,Tn),$n[1]=Math.min(He,Ln),$n[2]=Math.min(ot,Xn),$n[3]=Math.max(pt,Yn),$n},Cn.prototype.getLeftEyeNoLensTanAngles=function(){var ae=this.viewer,pe=this.device,Ce=this.distortion,fe=new Float32Array(4),He=Ce.distortInverse(Math.tan(-Ct*ae.fov)),ot=Ce.distortInverse(Math.tan(Ct*ae.fov)),pt=Ce.distortInverse(Math.tan(Ct*ae.fov)),Ut=Ce.distortInverse(Math.tan(-Ct*ae.fov)),Vt=pe.widthMeters/4,gt=pe.heightMeters/2,Ot=ae.baselineLensDistance-pe.bevelMeters-gt,Qt=ae.interLensDistance/2-Vt,_n=-Ot,Tn=ae.screenLensDistance,Ln=(Qt-Vt)/Tn,Xn=(_n+gt)/Tn,Yn=(Qt+Vt)/Tn,$n=(_n-gt)/Tn;return fe[0]=Math.max(He,Ln),fe[1]=Math.min(ot,Xn),fe[2]=Math.min(pt,Yn),fe[3]=Math.max(Ut,$n),fe},Cn.prototype.getLeftEyeVisibleScreenRect=function(ae){var pe=this.viewer,Ce=this.device,fe=pe.screenLensDistance,He=(Ce.widthMeters-pe.interLensDistance)/2,ot=pe.baselineLensDistance-Ce.bevelMeters,pt=(ae[0]*fe+He)/Ce.widthMeters,Ut=(ae[1]*fe+ot)/Ce.heightMeters,Vt=(ae[2]*fe+He)/Ce.widthMeters,gt=(ae[3]*fe+ot)/Ce.heightMeters;return{x:pt,y:gt,width:Vt-pt,height:Ut-gt}},Cn.prototype.getFieldOfViewLeftEye=function(ae){return ae?this.getUndistortedFieldOfViewLeftEye():this.getDistortedFieldOfViewLeftEye()},Cn.prototype.getFieldOfViewRightEye=function(ae){var pe=this.getFieldOfViewLeftEye(ae);return{leftDegrees:pe.rightDegrees,rightDegrees:pe.leftDegrees,upDegrees:pe.upDegrees,downDegrees:pe.downDegrees}},Cn.prototype.getUndistortedFieldOfViewLeftEye=function(){var ae=this.getUndistortedParams_();return{leftDegrees:ut*Math.atan(ae.outerDist),rightDegrees:ut*Math.atan(ae.innerDist),downDegrees:ut*Math.atan(ae.bottomDist),upDegrees:ut*Math.atan(ae.topDist)}},Cn.prototype.getUndistortedViewportLeftEye=function(){var ae=this.getUndistortedParams_(),pe=this.viewer,Ce=this.device,fe=pe.screenLensDistance,He=Ce.widthMeters/fe,ot=Ce.heightMeters/fe,pt=Ce.width/He,Ut=Ce.height/ot,Vt=Math.round((ae.eyePosX-ae.outerDist)*pt),gt=Math.round((ae.eyePosY-ae.bottomDist)*Ut);return{x:Vt,y:gt,width:Math.round((ae.eyePosX+ae.innerDist)*pt)-Vt,height:Math.round((ae.eyePosY+ae.topDist)*Ut)-gt}},Cn.prototype.getUndistortedParams_=function(){var ae=this.viewer,pe=this.device,Ce=this.distortion,fe=ae.screenLensDistance,He=ae.interLensDistance/2/fe,ot=pe.widthMeters/fe,pt=pe.heightMeters/fe,Ut=ot/2-He,Vt=(ae.baselineLensDistance-pe.bevelMeters)/fe,gt=ae.fov,Ot=Ce.distortInverse(Math.tan(Ct*gt)),Qt=Math.min(Ut,Ot),_n=Math.min(He,Ot),Tn=Math.min(Vt,Ot),Ln=Math.min(pt-Vt,Ot);return{outerDist:Qt,innerDist:_n,topDist:Ln,bottomDist:Tn,eyePosX:Ut,eyePosY:Vt}};function wn(ae){this.id=ae.id,this.label=ae.label,this.fov=ae.fov,this.interLensDistance=ae.interLensDistance,this.baselineLensDistance=ae.baselineLensDistance,this.screenLensDistance=ae.screenLensDistance,this.distortionCoefficients=ae.distortionCoefficients,this.inverseCoefficients=ae.inverseCoefficients}Cn.Viewers=Mn;var zn=1,ai="2019-11-09T17:36:14Z",xn=[{type:"android",rules:[{mdmh:"asus/*/Nexus 7/*"},{ua:"Nexus 7"}],dpi:[320.8,323],bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X00PD/*"},{ua:"ASUS_X00PD"}],dpi:245,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_X008D/*"},{ua:"ASUS_X008D"}],dpi:282,bw:3,ac:500},{type:"android",rules:[{mdmh:"asus/*/ASUS_Z00AD/*"},{ua:"ASUS_Z00AD"}],dpi:[403,404.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2 XL/*"},{ua:"Pixel 2 XL"}],dpi:537.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3 XL/*"},{ua:"Pixel 3 XL"}],dpi:[558.5,553.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel XL/*"},{ua:"Pixel XL"}],dpi:[537.9,533],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 3/*"},{ua:"Pixel 3"}],dpi:442.4,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Google/*/Pixel 2/*"},{ua:"Pixel 2"}],dpi:441,bw:3,ac:500},{type:"android",rules:[{mdmh:"Google/*/Pixel/*"},{ua:"Pixel"}],dpi:[432.6,436.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC6435LVW/*"},{ua:"HTC6435LVW"}],dpi:[449.7,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"HTC/*/HTC One XL/*"},{ua:"HTC One XL"}],dpi:[315.3,314.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"htc/*/Nexus 9/*"},{ua:"Nexus 9"}],dpi:289,bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One M9/*"},{ua:"HTC One M9"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One_M8/*"},{ua:"HTC One_M8"}],dpi:[449.7,447.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"HTC/*/HTC One/*"},{ua:"HTC One"}],dpi:472.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/Nexus 6P/*"},{ua:"Nexus 6P"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/BLN-L24/*"},{ua:"HONORBLN-L24"}],dpi:480,bw:4,ac:500},{type:"android",rules:[{mdmh:"Huawei/*/BKL-L09/*"},{ua:"BKL-L09"}],dpi:403,bw:3.47,ac:500},{type:"android",rules:[{mdmh:"LENOVO/*/Lenovo PB2-690Y/*"},{ua:"Lenovo PB2-690Y"}],dpi:[457.2,454.713],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5X/*"},{ua:"Nexus 5X"}],dpi:[422,419.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS345/*"},{ua:"LGMS345"}],dpi:[221.7,219.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D800/*"},{ua:"LG-D800"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/LG-D850/*"},{ua:"LG-D850"}],dpi:[537.9,541.9],bw:3,ac:500},{type:"android",rules:[{mdmh:"LGE/*/VS985 4G/*"},{ua:"VS985 4G"}],dpi:[537.9,535.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 5/*"},{ua:"Nexus 5 B"}],dpi:[442.4,444.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/Nexus 4/*"},{ua:"Nexus 4"}],dpi:[319.8,318.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LG-P769/*"},{ua:"LG-P769"}],dpi:[240.6,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGMS323/*"},{ua:"LGMS323"}],dpi:[206.6,204.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"LGE/*/LGLS996/*"},{ua:"LGLS996"}],dpi:[403.4,401.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/4560MMX/*"},{ua:"4560MMX"}],dpi:[240,219.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/A250/*"},{ua:"Micromax A250"}],dpi:[480,446.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Micromax/*/Micromax AQ4501/*"},{ua:"Micromax AQ4501"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/G5/*"},{ua:"Moto G (5) Plus"}],dpi:[403.4,403],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/DROID RAZR/*"},{ua:"DROID RAZR"}],dpi:[368.1,256.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT830C/*"},{ua:"XT830C"}],dpi:[254,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1021/*"},{ua:"XT1021"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1023/*"},{ua:"XT1023"}],dpi:[254,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1028/*"},{ua:"XT1028"}],dpi:[326.6,327.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1034/*"},{ua:"XT1034"}],dpi:[326.6,328.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1053/*"},{ua:"XT1053"}],dpi:[315.3,316.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1562/*"},{ua:"XT1562"}],dpi:[403.4,402.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/Nexus 6/*"},{ua:"Nexus 6 B"}],dpi:[494.3,489.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1063/*"},{ua:"XT1063"}],dpi:[295,296.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/XT1064/*"},{ua:"XT1064"}],dpi:[295,295.6],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1092/*"},{ua:"XT1092"}],dpi:[422,424.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"motorola/*/XT1095/*"},{ua:"XT1095"}],dpi:[422,423.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"motorola/*/G4/*"},{ua:"Moto G (4)"}],dpi:401,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/A0001/*"},{ua:"A0001"}],dpi:[403.4,401],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1001/*"},{ua:"ONE E1001"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1003/*"},{ua:"ONE E1003"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE E1005/*"},{ua:"ONE E1005"}],dpi:[442.4,441.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2001/*"},{ua:"ONE A2001"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2003/*"},{ua:"ONE A2003"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A2005/*"},{ua:"ONE A2005"}],dpi:[391.9,405.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3000/*"},{ua:"ONEPLUS A3000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3003/*"},{ua:"ONEPLUS A3003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A3010/*"},{ua:"ONEPLUS A3010"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A5000/*"},{ua:"ONEPLUS A5000 "}],dpi:[403.411,399.737],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONE A5010/*"},{ua:"ONEPLUS A5010"}],dpi:[403,400],bw:2,ac:1e3},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6000/*"},{ua:"ONEPLUS A6000"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6003/*"},{ua:"ONEPLUS A6003"}],dpi:401,bw:3,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6010/*"},{ua:"ONEPLUS A6010"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OnePlus/*/ONEPLUS A6013/*"},{ua:"ONEPLUS A6013"}],dpi:401,bw:2,ac:500},{type:"android",rules:[{mdmh:"OPPO/*/X909/*"},{ua:"X909"}],dpi:[442.4,444.1],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9082/*"},{ua:"GT-I9082"}],dpi:[184.7,185.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G360P/*"},{ua:"SM-G360P"}],dpi:[196.7,205.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Nexus S/*"},{ua:"Nexus S"}],dpi:[234.5,229.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[304.8,303.9],bw:5,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-T230NU/*"},{ua:"SM-T230NU"}],dpi:216,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SGH-T399/*"},{ua:"SGH-T399"}],dpi:[217.7,231.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SGH-M919/*"},{ua:"SGH-M919"}],dpi:[440.8,437.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N9005/*"},{ua:"SM-N9005"}],dpi:[386.4,387],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SM-N900A/*"},{ua:"SAMSUNG-SM-N900A"}],dpi:[386.4,387.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9500/*"},{ua:"GT-I9500"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/GT-I9505/*"},{ua:"GT-I9505"}],dpi:439.4,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900F/*"},{ua:"SM-G900F"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G900M/*"},{ua:"SM-G900M"}],dpi:[415.6,431.6],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G800F/*"},{ua:"SM-G800F"}],dpi:326.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G906S/*"},{ua:"SM-G906S"}],dpi:[562.7,572.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300/*"},{ua:"GT-I9300"}],dpi:[306.7,304.8],bw:5,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-T535/*"},{ua:"SM-T535"}],dpi:[142.6,136.4],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-N920C/*"},{ua:"SM-N920C"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920P/*"},{ua:"SM-N920P"}],dpi:[386.3655,390.144],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N920W8/*"},{ua:"SM-N920W8"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9300I/*"},{ua:"GT-I9300I"}],dpi:[304.8,305.8],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-I9195/*"},{ua:"GT-I9195"}],dpi:[249.4,256.7],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SPH-L520/*"},{ua:"SPH-L520"}],dpi:[249.4,255.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SAMSUNG-SGH-I717/*"},{ua:"SAMSUNG-SGH-I717"}],dpi:285.8,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SPH-D710/*"},{ua:"SPH-D710"}],dpi:[217.7,204.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/GT-N7100/*"},{ua:"GT-N7100"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SCH-I605/*"},{ua:"SCH-I605"}],dpi:265.1,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/Galaxy Nexus/*"},{ua:"Galaxy Nexus"}],dpi:[315.3,314.2],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910H/*"},{ua:"SM-N910H"}],dpi:[515.1,518],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-N910C/*"},{ua:"SM-N910C"}],dpi:[515.2,520.2],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G130M/*"},{ua:"SM-G130M"}],dpi:[165.9,164.8],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G928I/*"},{ua:"SM-G928I"}],dpi:[515.1,518.4],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G920F/*"},{ua:"SM-G920F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G920P/*"},{ua:"SM-G920P"}],dpi:[522.5,577],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G925F/*"},{ua:"SM-G925F"}],dpi:580.6,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G925V/*"},{ua:"SM-G925V"}],dpi:[522.5,576.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G930F/*"},{ua:"SM-G930F"}],dpi:576.6,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G935F/*"},{ua:"SM-G935F"}],dpi:533,bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G950F/*"},{ua:"SM-G950F"}],dpi:[562.707,565.293],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955U/*"},{ua:"SM-G955U"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G955F/*"},{ua:"SM-G955F"}],dpi:[522.514,525.762],bw:3,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G960F/*"},{ua:"SM-G960F"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9600/*"},{ua:"SM-G9600"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960T/*"},{ua:"SM-G960T"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960N/*"},{ua:"SM-G960N"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960U/*"},{ua:"SM-G960U"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G9608/*"},{ua:"SM-G9608"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960FD/*"},{ua:"SM-G960FD"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G960W/*"},{ua:"SM-G960W"}],dpi:[569.575,571.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G965F/*"},{ua:"SM-G965F"}],dpi:529,bw:2,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/C6903/*"},{ua:"C6903"}],dpi:[442.5,443.3],bw:3,ac:500},{type:"android",rules:[{mdmh:"Sony/*/D6653/*"},{ua:"D6653"}],dpi:[428.6,427.6],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6653/*"},{ua:"E6653"}],dpi:[428.6,425.7],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/E6853/*"},{ua:"E6853"}],dpi:[403.4,401.9],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Sony/*/SGP321/*"},{ua:"SGP321"}],dpi:[224.7,224.1],bw:3,ac:500},{type:"android",rules:[{mdmh:"TCT/*/ALCATEL ONE TOUCH Fierce/*"},{ua:"ALCATEL ONE TOUCH Fierce"}],dpi:[240,247.5],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"THL/*/thl 5000/*"},{ua:"thl 5000"}],dpi:[480,443.3],bw:3,ac:1e3},{type:"android",rules:[{mdmh:"Fly/*/IQ4412/*"},{ua:"IQ4412"}],dpi:307.9,bw:3,ac:1e3},{type:"android",rules:[{mdmh:"ZTE/*/ZTE Blade L2/*"},{ua:"ZTE Blade L2"}],dpi:240,bw:3,ac:500},{type:"android",rules:[{mdmh:"BENEVE/*/VR518/*"},{ua:"VR518"}],dpi:480,bw:3,ac:500},{type:"ios",rules:[{res:[640,960]}],dpi:[325.1,328.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[640,1136]}],dpi:[317.1,320.2],bw:3,ac:1e3},{type:"ios",rules:[{res:[750,1334]}],dpi:326.4,bw:4,ac:1e3},{type:"ios",rules:[{res:[1242,2208]}],dpi:[453.6,458.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2001]}],dpi:[410.9,415.4],bw:4,ac:1e3},{type:"ios",rules:[{res:[1125,2436]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"Huawei/*/EML-L29/*"},{ua:"EML-L29"}],dpi:428,bw:3.45,ac:500},{type:"android",rules:[{mdmh:"Nokia/*/Nokia 7.1/*"},{ua:"Nokia 7.1"}],dpi:[432,431.9],bw:3,ac:500},{type:"ios",rules:[{res:[1242,2688]}],dpi:458,bw:4,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G570M/*"},{ua:"SM-G570M"}],dpi:320,bw:3.684,ac:1e3},{type:"android",rules:[{mdmh:"samsung/*/SM-G970F/*"},{ua:"SM-G970F"}],dpi:438,bw:2.281,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G973F/*"},{ua:"SM-G973F"}],dpi:550,bw:2.002,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G975F/*"},{ua:"SM-G975F"}],dpi:522,bw:2.054,ac:500},{type:"android",rules:[{mdmh:"samsung/*/SM-G977F/*"},{ua:"SM-G977F"}],dpi:505,bw:2.334,ac:500},{type:"ios",rules:[{res:[828,1792]}],dpi:326,bw:5,ac:500}],Zn={format:zn,last_updated:ai,devices:xn};function Me(ae,pe){if(this.dpdb=Zn,this.recalculateDeviceParams_(),ae){this.onDeviceParamsUpdated=pe;var Ce=new XMLHttpRequest,fe=this;Ce.open("GET",ae,!0),Ce.addEventListener("load",function(){fe.loading=!1,Ce.status>=200&&Ce.status<=299?(fe.dpdb=JSON.parse(Ce.response),fe.recalculateDeviceParams_()):console.error("Error loading online DPDB!")}),Ce.send()}}Me.prototype.getDeviceParams=function(){return this.deviceParams},Me.prototype.recalculateDeviceParams_=function(){var ae=this.calcDeviceParams_();ae?(this.deviceParams=ae,this.onDeviceParamsUpdated&&this.onDeviceParamsUpdated(this.deviceParams)):console.error("Failed to recalculate device parameters.")},Me.prototype.calcDeviceParams_=function(){var ae=this.dpdb;if(!ae)return console.error("DPDB not available."),null;if(ae.format!=1)return console.error("DPDB has unexpected format version."),null;if(!ae.devices||!ae.devices.length)return console.error("DPDB does not have a devices section."),null;var pe=navigator.userAgent||navigator.vendor||window.opera,Ce=we(),fe=Ke();if(!ae.devices)return console.error("DPDB has no devices section."),null;for(var He=0;He<ae.devices.length;He++){var ot=ae.devices[He];if(!ot.rules){console.warn("Device["+He+"] has no rules section.");continue}if(ot.type!="ios"&&ot.type!="android"){console.warn("Device["+He+"] has invalid type.");continue}if(L()==(ot.type=="ios")){for(var pt=!1,Ut=0;Ut<ot.rules.length;Ut++){var Vt=ot.rules[Ut];if(this.ruleMatches_(Vt,pe,Ce,fe)){pt=!0;break}}if(!!pt){var gt=ot.dpi[0]||ot.dpi,Ot=ot.dpi[1]||ot.dpi;return new le({xdpi:gt,ydpi:Ot,bevelMm:ot.bw})}}}return console.warn("No DPDB device match."),null},Me.prototype.ruleMatches_=function(ae,pe,Ce,fe){if(!ae.ua&&!ae.res||(ae.ua&&ae.ua.substring(0,2)==="SM"&&(ae.ua=ae.ua.substring(0,7)),ae.ua&&pe.indexOf(ae.ua)<0))return!1;if(ae.res){if(!ae.res[0]||!ae.res[1])return!1;var He=ae.res[0],ot=ae.res[1];if(Math.min(Ce,fe)!=Math.min(He,ot)||Math.max(Ce,fe)!=Math.max(He,ot))return!1}return!0};function le(ae){this.xdpi=ae.xdpi,this.ydpi=ae.ydpi,this.bevelMm=ae.bevelMm}function be(ae,pe){this.set(ae,pe)}be.prototype.set=function(ae,pe){this.sample=ae,this.timestampS=pe},be.prototype.copy=function(ae){this.set(ae.sample,ae.timestampS)};function q(ae,pe){this.kFilter=ae,this.isDebug=pe,this.currentAccelMeasurement=new be,this.currentGyroMeasurement=new be,this.previousGyroMeasurement=new be,L()?this.filterQ=new Tt(-1,0,0,1):this.filterQ=new Tt(1,0,0,1),this.previousFilterQ=new Tt,this.previousFilterQ.copy(this.filterQ),this.accelQ=new Tt,this.isOrientationInitialized=!1,this.estimatedGravity=new St,this.measuredGravity=new St,this.gyroIntegralQ=new Tt}q.prototype.addAccelMeasurement=function(ae,pe){this.currentAccelMeasurement.set(ae,pe)},q.prototype.addGyroMeasurement=function(ae,pe){this.currentGyroMeasurement.set(ae,pe);var Ce=pe-this.previousGyroMeasurement.timestampS;Y(Ce)&&this.run_(),this.previousGyroMeasurement.copy(this.currentGyroMeasurement)},q.prototype.run_=function(){if(!this.isOrientationInitialized){this.accelQ=this.accelToQuaternion_(this.currentAccelMeasurement.sample),this.previousFilterQ.copy(this.accelQ),this.isOrientationInitialized=!0;return}var ae=this.currentGyroMeasurement.timestampS-this.previousGyroMeasurement.timestampS,pe=this.gyroToQuaternionDelta_(this.currentGyroMeasurement.sample,ae);this.gyroIntegralQ.multiply(pe),this.filterQ.copy(this.previousFilterQ),this.filterQ.multiply(pe);var Ce=new Tt;Ce.copy(this.filterQ),Ce.inverse(),this.estimatedGravity.set(0,0,-1),this.estimatedGravity.applyQuaternion(Ce),this.estimatedGravity.normalize(),this.measuredGravity.copy(this.currentAccelMeasurement.sample),this.measuredGravity.normalize();var fe=new Tt;fe.setFromUnitVectors(this.estimatedGravity,this.measuredGravity),fe.inverse(),this.isDebug&&console.log("Delta: %d deg, G_est: (%s, %s, %s), G_meas: (%s, %s, %s)",ut*We(fe),this.estimatedGravity.x.toFixed(1),this.estimatedGravity.y.toFixed(1),this.estimatedGravity.z.toFixed(1),this.measuredGravity.x.toFixed(1),this.measuredGravity.y.toFixed(1),this.measuredGravity.z.toFixed(1));var He=new Tt;He.copy(this.filterQ),He.multiply(fe),this.filterQ.slerp(He,1-this.kFilter),this.previousFilterQ.copy(this.filterQ)},q.prototype.getOrientation=function(){return this.filterQ},q.prototype.accelToQuaternion_=function(ae){var pe=new St;pe.copy(ae),pe.normalize();var Ce=new Tt;return Ce.setFromUnitVectors(new St(0,0,-1),pe),Ce.inverse(),Ce},q.prototype.gyroToQuaternionDelta_=function(ae,pe){var Ce=new Tt,fe=new St;return fe.copy(ae),fe.normalize(),Ce.setFromAxisAngle(fe,ae.length()*pe),Ce};function Se(ae,pe){this.predictionTimeS=ae,this.isDebug=pe,this.previousQ=new Tt,this.previousTimestampS=null,this.deltaQ=new Tt,this.outQ=new Tt}Se.prototype.getPrediction=function(ae,pe,Ce){if(!this.previousTimestampS)return this.previousQ.copy(ae),this.previousTimestampS=Ce,ae;var fe=new St;fe.copy(pe),fe.normalize();var He=pe.length();if(He<Ct*20)return this.isDebug&&console.log("Moving slowly, at %s deg/s: no prediction",(ut*He).toFixed(1)),this.outQ.copy(ae),this.previousQ.copy(ae),this.outQ;var ot=He*this.predictionTimeS;return this.deltaQ.setFromAxisAngle(fe,ot),this.outQ.copy(this.previousQ),this.outQ.multiply(this.deltaQ),this.previousQ.copy(ae),this.previousTimestampS=Ce,this.outQ};function Ge(ae,pe,Ce,fe){this.yawOnly=Ce,this.accelerometer=new St,this.gyroscope=new St,this.filter=new q(ae,fe),this.posePredictor=new Se(pe,fe),this.isFirefoxAndroid=U(),this.isIOS=L();var He=$();this.isDeviceMotionInRadians=!this.isIOS&&He&&He<66,this.isWithoutDeviceMotion=Q()||ee(),this.filterToWorldQ=new Tt,L()?this.filterToWorldQ.setFromAxisAngle(new St(1,0,0),Math.PI/2):this.filterToWorldQ.setFromAxisAngle(new St(1,0,0),-Math.PI/2),this.inverseWorldToScreenQ=new Tt,this.worldToScreenQ=new Tt,this.originalPoseAdjustQ=new Tt,this.originalPoseAdjustQ.setFromAxisAngle(new St(0,0,1),-window.orientation*Math.PI/180),this.setScreenTransform_(),K()&&this.filterToWorldQ.multiply(this.inverseWorldToScreenQ),this.resetQ=new Tt,this.orientationOut_=new Float32Array(4),this.start()}Ge.prototype.getPosition=function(){return null},Ge.prototype.getOrientation=function(){var ae=void 0;if(this.isWithoutDeviceMotion&&this._deviceOrientationQ){this.deviceOrientationFixQ=this.deviceOrientationFixQ||function(){var He=new Tt().setFromAxisAngle(new St(0,0,-1),0),ot=new Tt;return window.orientation===-90?ot.setFromAxisAngle(new St(0,1,0),Math.PI/-2):ot.setFromAxisAngle(new St(0,1,0),Math.PI/2),He.multiply(ot)}(),this.deviceOrientationFilterToWorldQ=this.deviceOrientationFilterToWorldQ||function(){var He=new Tt;return He.setFromAxisAngle(new St(1,0,0),-Math.PI/2),He}(),ae=this._deviceOrientationQ;var Ce=new Tt;return Ce.copy(ae),Ce.multiply(this.deviceOrientationFilterToWorldQ),Ce.multiply(this.resetQ),Ce.multiply(this.worldToScreenQ),Ce.multiplyQuaternions(this.deviceOrientationFixQ,Ce),this.yawOnly&&(Ce.x=0,Ce.z=0,Ce.normalize()),this.orientationOut_[0]=Ce.x,this.orientationOut_[1]=Ce.y,this.orientationOut_[2]=Ce.z,this.orientationOut_[3]=Ce.w,this.orientationOut_}else{var pe=this.filter.getOrientation();ae=this.posePredictor.getPrediction(pe,this.gyroscope,this.previousTimestampS)}var Ce=new Tt;return Ce.copy(this.filterToWorldQ),Ce.multiply(this.resetQ),Ce.multiply(ae),Ce.multiply(this.worldToScreenQ),this.yawOnly&&(Ce.x=0,Ce.z=0,Ce.normalize()),this.orientationOut_[0]=Ce.x,this.orientationOut_[1]=Ce.y,this.orientationOut_[2]=Ce.z,this.orientationOut_[3]=Ce.w,this.orientationOut_},Ge.prototype.resetPose=function(){this.resetQ.copy(this.filter.getOrientation()),this.resetQ.x=0,this.resetQ.y=0,this.resetQ.z*=-1,this.resetQ.normalize(),K()&&this.resetQ.multiply(this.inverseWorldToScreenQ),this.resetQ.multiply(this.originalPoseAdjustQ)},Ge.prototype.onDeviceOrientation_=function(ae){this._deviceOrientationQ=this._deviceOrientationQ||new Tt;var pe=ae.alpha,Ce=ae.beta,fe=ae.gamma;pe=(pe||0)*Math.PI/180,Ce=(Ce||0)*Math.PI/180,fe=(fe||0)*Math.PI/180,this._deviceOrientationQ.setFromEulerYXZ(Ce,pe,-fe)},Ge.prototype.onDeviceMotion_=function(ae){this.updateDeviceMotion_(ae)},Ge.prototype.updateDeviceMotion_=function(ae){var pe=ae.accelerationIncludingGravity,Ce=ae.rotationRate,fe=ae.timeStamp/1e3,He=fe-this.previousTimestampS;if(He<0){_e("fusion-pose-sensor:invalid:non-monotonic","Invalid timestamps detected: non-monotonic timestamp from devicemotion"),this.previousTimestampS=fe;return}else if(He<=J||He>de){_e("fusion-pose-sensor:invalid:outside-threshold","Invalid timestamps detected: Timestamp from devicemotion outside expected range."),this.previousTimestampS=fe;return}this.accelerometer.set(-pe.x,-pe.y,-pe.z),Ce&&(G()?this.gyroscope.set(-Ce.beta,Ce.alpha,Ce.gamma):this.gyroscope.set(Ce.alpha,Ce.beta,Ce.gamma),this.isDeviceMotionInRadians||this.gyroscope.multiplyScalar(Math.PI/180),this.filter.addGyroMeasurement(this.gyroscope,fe)),this.filter.addAccelMeasurement(this.accelerometer,fe),this.previousTimestampS=fe},Ge.prototype.onOrientationChange_=function(ae){this.setScreenTransform_()},Ge.prototype.onMessage_=function(ae){var pe=ae.data;if(!(!pe||!pe.type)){var Ce=pe.type.toLowerCase();Ce==="devicemotion"&&this.updateDeviceMotion_(pe.deviceMotionEvent)}},Ge.prototype.setScreenTransform_=function(){switch(this.worldToScreenQ.set(0,0,0,1),window.orientation){case 0:break;case 90:this.worldToScreenQ.setFromAxisAngle(new St(0,0,1),-Math.PI/2);break;case-90:this.worldToScreenQ.setFromAxisAngle(new St(0,0,1),Math.PI/2);break}this.inverseWorldToScreenQ.copy(this.worldToScreenQ),this.inverseWorldToScreenQ.inverse()},Ge.prototype.start=function(){this.onDeviceMotionCallback_=this.onDeviceMotion_.bind(this),this.onOrientationChangeCallback_=this.onOrientationChange_.bind(this),this.onMessageCallback_=this.onMessage_.bind(this),this.onDeviceOrientationCallback_=this.onDeviceOrientation_.bind(this),L()&&$e()&&window.addEventListener("message",this.onMessageCallback_),window.addEventListener("orientationchange",this.onOrientationChangeCallback_),this.isWithoutDeviceMotion?window.addEventListener("deviceorientation",this.onDeviceOrientationCallback_):window.addEventListener("devicemotion",this.onDeviceMotionCallback_)},Ge.prototype.stop=function(){window.removeEventListener("devicemotion",this.onDeviceMotionCallback_),window.removeEventListener("deviceorientation",this.onDeviceOrientationCallback_),window.removeEventListener("orientationchange",this.onOrientationChangeCallback_),window.removeEventListener("message",this.onMessageCallback_)};var lt=60,dt=new St(1,0,0),Re=new St(0,0,1),Ue=new Tt;Ue.setFromAxisAngle(dt,-Math.PI/2),Ue.multiply(new Tt().setFromAxisAngle(Re,Math.PI/2));var Xe=function(){function ae(pe){k(this,ae),this.config=pe,this.sensor=null,this.fusionSensor=null,this._out=new Float32Array(4),this.api=null,this.errors=[],this._sensorQ=new Tt,this._outQ=new Tt,this._onSensorRead=this._onSensorRead.bind(this),this._onSensorError=this._onSensorError.bind(this),this.init()}return W(ae,[{key:"init",value:function(){var Ce=null;try{Ce=new RelativeOrientationSensor({frequency:lt,referenceFrame:"screen"}),Ce.addEventListener("error",this._onSensorError)}catch(fe){this.errors.push(fe),fe.name==="SecurityError"?(console.error("Cannot construct sensors due to the Feature Policy"),console.warn('Attempting to fall back using "devicemotion"; however this will fail in the future without correct permissions.'),this.useDeviceMotion()):fe.name==="ReferenceError"?this.useDeviceMotion():console.error(fe)}Ce&&(this.api="sensor",this.sensor=Ce,this.sensor.addEventListener("reading",this._onSensorRead),this.sensor.start())}},{key:"useDeviceMotion",value:function(){this.api="devicemotion",this.fusionSensor=new Ge(this.config.K_FILTER,this.config.PREDICTION_TIME_S,this.config.YAW_ONLY,this.config.DEBUG),this.sensor&&(this.sensor.removeEventListener("reading",this._onSensorRead),this.sensor.removeEventListener("error",this._onSensorError),this.sensor=null)}},{key:"getOrientation",value:function(){if(this.fusionSensor)return this.fusionSensor.getOrientation();if(!this.sensor||!this.sensor.quaternion)return this._out[0]=this._out[1]=this._out[2]=0,this._out[3]=1,this._out;var Ce=this.sensor.quaternion;this._sensorQ.set(Ce[0],Ce[1],Ce[2],Ce[3]);var fe=this._outQ;return fe.copy(Ue),fe.multiply(this._sensorQ),this.config.YAW_ONLY&&(fe.x=fe.z=0,fe.normalize()),this._out[0]=fe.x,this._out[1]=fe.y,this._out[2]=fe.z,this._out[3]=fe.w,this._out}},{key:"_onSensorError",value:function(Ce){this.errors.push(Ce.error),Ce.error.name==="NotAllowedError"?console.error("Permission to access sensor was denied"):Ce.error.name==="NotReadableError"?console.error("Sensor could not be read"):console.error(Ce.error),this.useDeviceMotion()}},{key:"_onSensorRead",value:function(){}}]),ae}(),ft="<svg width='198' height='240' viewBox='0 0 198 240' xmlns='http://www.w3.org/2000/svg'><g fill='none' fill-rule='evenodd'><path d='M149.625 109.527l6.737 3.891v.886c0 .177.013.36.038.549.01.081.02.162.027.242.14 1.415.974 2.998 2.105 3.999l5.72 5.062.081-.09s4.382-2.53 5.235-3.024l25.97 14.993v54.001c0 .771-.386 1.217-.948 1.217-.233 0-.495-.076-.772-.236l-23.967-13.838-.014.024-27.322 15.775-.85-1.323c-4.731-1.529-9.748-2.74-14.951-3.61a.27.27 0 0 0-.007.024l-5.067 16.961-7.891 4.556-.037-.063v27.59c0 .772-.386 1.217-.948 1.217-.232 0-.495-.076-.772-.236l-42.473-24.522c-.95-.549-1.72-1.877-1.72-2.967v-1.035l-.021.047a5.111 5.111 0 0 0-1.816-.399 5.682 5.682 0 0 0-.546.001 13.724 13.724 0 0 1-1.918-.041c-1.655-.153-3.2-.6-4.404-1.296l-46.576-26.89.005.012-10.278-18.75c-1.001-1.827-.241-4.216 1.698-5.336l56.011-32.345a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.659 3.227 1.853l.005-.003.227.413-.006.004a9.63 9.63 0 0 0 1.477 2.018l.277.27c1.914 1.85 4.468 2.801 7.113 2.801 1.949 0 3.948-.517 5.775-1.572.013 0 7.319-4.219 7.319-4.219a4.194 4.194 0 0 1 2.099-.572c1.326 0 2.572.658 3.226 1.853l3.25 5.928.022-.018 6.785 3.917-.105-.182 46.881-26.965m0-1.635c-.282 0-.563.073-.815.218l-46.169 26.556-5.41-3.124-3.005-5.481c-.913-1.667-2.699-2.702-4.66-2.703-1.011 0-2.02.274-2.917.792a3825 3825 0 0 1-7.275 4.195l-.044.024a9.937 9.937 0 0 1-4.957 1.353c-2.292 0-4.414-.832-5.976-2.342l-.252-.245a7.992 7.992 0 0 1-1.139-1.534 1.379 1.379 0 0 0-.06-.122l-.227-.414a1.718 1.718 0 0 0-.095-.154c-.938-1.574-2.673-2.545-4.571-2.545-1.011 0-2.02.274-2.917.792L3.125 155.502c-2.699 1.559-3.738 4.94-2.314 7.538l10.278 18.75c.177.323.448.563.761.704l46.426 26.804c1.403.81 3.157 1.332 5.072 1.508a15.661 15.661 0 0 0 2.146.046 4.766 4.766 0 0 1 .396 0c.096.004.19.011.283.022.109 1.593 1.159 3.323 2.529 4.114l42.472 24.522c.524.302 1.058.455 1.59.455 1.497 0 2.583-1.2 2.583-2.852v-26.562l7.111-4.105a1.64 1.64 0 0 0 .749-.948l4.658-15.593c4.414.797 8.692 1.848 12.742 3.128l.533.829a1.634 1.634 0 0 0 2.193.531l26.532-15.317L193 192.433c.523.302 1.058.455 1.59.455 1.497 0 2.583-1.199 2.583-2.852v-54.001c0-.584-.312-1.124-.818-1.416l-25.97-14.993a1.633 1.633 0 0 0-1.636.001c-.606.351-2.993 1.73-4.325 2.498l-4.809-4.255c-.819-.725-1.461-1.933-1.561-2.936a7.776 7.776 0 0 0-.033-.294 2.487 2.487 0 0 1-.023-.336v-.886c0-.584-.312-1.123-.817-1.416l-6.739-3.891a1.633 1.633 0 0 0-.817-.219' fill='#455A64'/><path d='M96.027 132.636l46.576 26.891c1.204.695 1.979 1.587 2.242 2.541l-.01.007-81.374 46.982h-.001c-1.654-.152-3.199-.6-4.403-1.295l-46.576-26.891 83.546-48.235' fill='#FAFAFA'/><path d='M63.461 209.174c-.008 0-.015 0-.022-.002-1.693-.156-3.228-.609-4.441-1.309l-46.576-26.89a.118.118 0 0 1 0-.203l83.546-48.235a.117.117 0 0 1 .117 0l46.576 26.891c1.227.708 2.021 1.612 2.296 2.611a.116.116 0 0 1-.042.124l-.021.016-81.375 46.981a.11.11 0 0 1-.058.016zm-50.747-28.303l46.401 26.79c1.178.68 2.671 1.121 4.32 1.276l81.272-46.922c-.279-.907-1.025-1.73-2.163-2.387l-46.517-26.857-83.313 48.1z' fill='#607D8B'/><path d='M148.327 165.471a5.85 5.85 0 0 1-.546.001c-1.894-.083-3.302-1.038-3.145-2.132a2.693 2.693 0 0 0-.072-1.105l-81.103 46.822c.628.058 1.272.073 1.918.042.182-.009.364-.009.546-.001 1.894.083 3.302 1.038 3.145 2.132l79.257-45.759' fill='#FFF'/><path d='M69.07 211.347a.118.118 0 0 1-.115-.134c.045-.317-.057-.637-.297-.925-.505-.61-1.555-1.022-2.738-1.074a5.966 5.966 0 0 0-.535.001 14.03 14.03 0 0 1-1.935-.041.117.117 0 0 1-.103-.092.116.116 0 0 1 .055-.126l81.104-46.822a.117.117 0 0 1 .171.07c.104.381.129.768.074 1.153-.045.316.057.637.296.925.506.61 1.555 1.021 2.739 1.073.178.008.357.008.535-.001a.117.117 0 0 1 .064.218l-79.256 45.759a.114.114 0 0 1-.059.016zm-3.405-2.372c.089 0 .177.002.265.006 1.266.056 2.353.488 2.908 1.158.227.274.35.575.36.882l78.685-45.429c-.036 0-.072-.001-.107-.003-1.267-.056-2.354-.489-2.909-1.158-.282-.34-.402-.724-.347-1.107a2.604 2.604 0 0 0-.032-.91L63.846 208.97a13.91 13.91 0 0 0 1.528.012c.097-.005.194-.007.291-.007z' fill='#607D8B'/><path d='M2.208 162.134c-1.001-1.827-.241-4.217 1.698-5.337l56.011-32.344c1.939-1.12 4.324-.546 5.326 1.281l.232.41a9.344 9.344 0 0 0 1.47 2.021l.278.27c3.325 3.214 8.583 3.716 12.888 1.23l7.319-4.22c1.94-1.119 4.324-.546 5.325 1.282l3.25 5.928-83.519 48.229-10.278-18.75z' fill='#FAFAFA'/><path d='M12.486 181.001a.112.112 0 0 1-.031-.005.114.114 0 0 1-.071-.056L2.106 162.19c-1.031-1.88-.249-4.345 1.742-5.494l56.01-32.344a4.328 4.328 0 0 1 2.158-.588c1.415 0 2.65.702 3.311 1.882.01.008.018.017.024.028l.227.414a.122.122 0 0 1 .013.038 9.508 9.508 0 0 0 1.439 1.959l.275.266c1.846 1.786 4.344 2.769 7.031 2.769 1.977 0 3.954-.538 5.717-1.557a.148.148 0 0 1 .035-.013l7.284-4.206a4.321 4.321 0 0 1 2.157-.588c1.427 0 2.672.716 3.329 1.914l3.249 5.929a.116.116 0 0 1-.044.157l-83.518 48.229a.116.116 0 0 1-.059.016zm49.53-57.004c-.704 0-1.41.193-2.041.557l-56.01 32.345c-1.882 1.086-2.624 3.409-1.655 5.179l10.221 18.645 83.317-48.112-3.195-5.829c-.615-1.122-1.783-1.792-3.124-1.792a4.08 4.08 0 0 0-2.04.557l-7.317 4.225a.148.148 0 0 1-.035.013 11.7 11.7 0 0 1-5.801 1.569c-2.748 0-5.303-1.007-7.194-2.835l-.278-.27a9.716 9.716 0 0 1-1.497-2.046.096.096 0 0 1-.013-.037l-.191-.347a.11.11 0 0 1-.023-.029c-.615-1.123-1.783-1.793-3.124-1.793z' fill='#607D8B'/><path d='M42.434 155.808c-2.51-.001-4.697-1.258-5.852-3.365-1.811-3.304-.438-7.634 3.059-9.654l12.291-7.098a7.599 7.599 0 0 1 3.789-1.033c2.51 0 4.697 1.258 5.852 3.365 1.811 3.304.439 7.634-3.059 9.654l-12.291 7.098a7.606 7.606 0 0 1-3.789 1.033zm13.287-20.683a7.128 7.128 0 0 0-3.555.971l-12.291 7.098c-3.279 1.893-4.573 5.942-2.883 9.024 1.071 1.955 3.106 3.122 5.442 3.122a7.13 7.13 0 0 0 3.556-.97l12.291-7.098c3.279-1.893 4.572-5.942 2.883-9.024-1.072-1.955-3.106-3.123-5.443-3.123z' fill='#607D8B'/><path d='M149.588 109.407l6.737 3.89v.887c0 .176.013.36.037.549.011.081.02.161.028.242.14 1.415.973 2.998 2.105 3.999l7.396 6.545c.177.156.358.295.541.415 1.579 1.04 2.95.466 3.062-1.282.049-.784.057-1.595.023-2.429l-.003-.16v-1.151l25.987 15.003v54c0 1.09-.77 1.53-1.72.982l-42.473-24.523c-.95-.548-1.72-1.877-1.72-2.966v-34.033' fill='#FAFAFA'/><path d='M194.553 191.25c-.257 0-.54-.085-.831-.253l-42.472-24.521c-.981-.567-1.779-1.943-1.779-3.068v-34.033h.234v34.033c0 1.051.745 2.336 1.661 2.866l42.473 24.521c.424.245.816.288 1.103.122.285-.164.442-.52.442-1.002v-53.933l-25.753-14.868.003 1.106c.034.832.026 1.654-.024 2.439-.054.844-.396 1.464-.963 1.746-.619.309-1.45.173-2.28-.373a5.023 5.023 0 0 1-.553-.426l-7.397-6.544c-1.158-1.026-1.999-2.625-2.143-4.076a9.624 9.624 0 0 0-.027-.238 4.241 4.241 0 0 1-.038-.564v-.82l-6.68-3.856.117-.202 6.738 3.89.058.034v.954c0 .171.012.351.036.533.011.083.021.165.029.246.138 1.395.948 2.935 2.065 3.923l7.397 6.545c.173.153.35.289.527.406.758.499 1.504.63 2.047.359.49-.243.786-.795.834-1.551.05-.778.057-1.591.024-2.417l-.004-.163v-1.355l.175.1 25.987 15.004.059.033v54.068c0 .569-.198.996-.559 1.204a1.002 1.002 0 0 1-.506.131' fill='#607D8B'/><path d='M145.685 163.161l24.115 13.922-25.978 14.998-1.462-.307c-6.534-2.17-13.628-3.728-21.019-4.616-4.365-.524-8.663 1.096-9.598 3.62a2.746 2.746 0 0 0-.011 1.928c1.538 4.267 4.236 8.363 7.995 12.135l.532.845-25.977 14.997-24.115-13.922 75.518-43.6' fill='#FFF'/><path d='M94.282 220.818l-.059-.033-24.29-14.024.175-.101 75.577-43.634.058.033 24.29 14.024-26.191 15.122-.045-.01-1.461-.307c-6.549-2.174-13.613-3.725-21.009-4.614a13.744 13.744 0 0 0-1.638-.097c-3.758 0-7.054 1.531-7.837 3.642a2.62 2.62 0 0 0-.01 1.848c1.535 4.258 4.216 8.326 7.968 12.091l.016.021.526.835.006.01.064.102-.105.061-25.977 14.998-.058.033zm-23.881-14.057l23.881 13.788 24.802-14.32c.546-.315.846-.489 1.017-.575l-.466-.74c-3.771-3.787-6.467-7.881-8.013-12.168a2.851 2.851 0 0 1 .011-2.008c.815-2.199 4.203-3.795 8.056-3.795.557 0 1.117.033 1.666.099 7.412.891 14.491 2.445 21.041 4.621.836.175 1.215.254 1.39.304l25.78-14.884-23.881-13.788-75.284 43.466z' fill='#607D8B'/><path d='M167.23 125.979v50.871l-27.321 15.773-6.461-14.167c-.91-1.996-3.428-1.738-5.624.574a10.238 10.238 0 0 0-2.33 4.018l-6.46 21.628-27.322 15.774v-50.871l75.518-43.6' fill='#FFF'/><path d='M91.712 220.567a.127.127 0 0 1-.059-.016.118.118 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.519-43.6a.117.117 0 0 1 .175.101v50.871c0 .041-.023.08-.059.1l-27.321 15.775a.118.118 0 0 1-.094.01.12.12 0 0 1-.071-.063l-6.46-14.168c-.375-.822-1.062-1.275-1.934-1.275-1.089 0-2.364.686-3.5 1.881a10.206 10.206 0 0 0-2.302 3.972l-6.46 21.627a.118.118 0 0 1-.054.068L91.77 220.551a.12.12 0 0 1-.058.016zm.117-50.92v50.601l27.106-15.65 6.447-21.583a10.286 10.286 0 0 1 2.357-4.065c1.18-1.242 2.517-1.954 3.669-1.954.969 0 1.731.501 2.146 1.411l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M168.543 126.213v50.87l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.624.574a10.248 10.248 0 0 0-2.33 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6' fill='#FFF'/><path d='M93.025 220.8a.123.123 0 0 1-.059-.015.12.12 0 0 1-.058-.101v-50.871c0-.042.023-.08.058-.101l75.518-43.6a.112.112 0 0 1 .117 0c.036.02.059.059.059.1v50.871a.116.116 0 0 1-.059.101l-27.321 15.774a.111.111 0 0 1-.094.01.115.115 0 0 1-.071-.062l-6.46-14.168c-.375-.823-1.062-1.275-1.935-1.275-1.088 0-2.363.685-3.499 1.881a10.19 10.19 0 0 0-2.302 3.971l-6.461 21.628a.108.108 0 0 1-.053.067l-27.322 15.775a.12.12 0 0 1-.058.015zm.117-50.919v50.6l27.106-15.649 6.447-21.584a10.293 10.293 0 0 1 2.357-4.065c1.179-1.241 2.516-1.954 3.668-1.954.969 0 1.732.502 2.147 1.412l6.407 14.051 27.152-15.676v-50.601l-75.284 43.466z' fill='#607D8B'/><path d='M169.8 177.083l-27.322 15.774-6.46-14.168c-.91-1.995-3.428-1.738-5.625.574a10.246 10.246 0 0 0-2.329 4.019l-6.461 21.627-27.321 15.774v-50.87l75.518-43.6v50.87z' fill='#FAFAFA'/><path d='M94.282 220.917a.234.234 0 0 1-.234-.233v-50.871c0-.083.045-.161.117-.202l75.518-43.601a.234.234 0 1 1 .35.202v50.871a.233.233 0 0 1-.116.202l-27.322 15.775a.232.232 0 0 1-.329-.106l-6.461-14.168c-.36-.789-.992-1.206-1.828-1.206-1.056 0-2.301.672-3.415 1.844a10.099 10.099 0 0 0-2.275 3.924l-6.46 21.628a.235.235 0 0 1-.107.136l-27.322 15.774a.23.23 0 0 1-.116.031zm.233-50.969v50.331l26.891-15.525 6.434-21.539a10.41 10.41 0 0 1 2.384-4.112c1.201-1.265 2.569-1.991 3.753-1.991 1.018 0 1.818.526 2.253 1.48l6.354 13.934 26.982-15.578v-50.331l-75.051 43.331z' fill='#607D8B'/><path d='M109.894 199.943c-1.774 0-3.241-.725-4.244-2.12a.224.224 0 0 1 .023-.294.233.233 0 0 1 .301-.023c.78.547 1.705.827 2.75.827 1.323 0 2.754-.439 4.256-1.306 5.311-3.067 9.631-10.518 9.631-16.611 0-1.927-.442-3.56-1.278-4.724a.232.232 0 0 1 .323-.327c1.671 1.172 2.591 3.381 2.591 6.219 0 6.242-4.426 13.863-9.865 17.003-1.574.908-3.084 1.356-4.488 1.356zm-2.969-1.542c.813.651 1.82.877 2.968.877h.001c1.321 0 2.753-.327 4.254-1.194 5.311-3.067 9.632-10.463 9.632-16.556 0-1.979-.463-3.599-1.326-4.761.411 1.035.625 2.275.625 3.635 0 6.243-4.426 13.883-9.865 17.023-1.574.909-3.084 1.317-4.49 1.317-.641 0-1.243-.149-1.799-.341z' fill='#607D8B'/><path d='M113.097 197.23c5.384-3.108 9.748-10.636 9.748-16.814 0-2.051-.483-3.692-1.323-4.86-1.784-1.252-4.374-1.194-7.257.47-5.384 3.108-9.748 10.636-9.748 16.814 0 2.051.483 3.692 1.323 4.86 1.784 1.252 4.374 1.194 7.257-.47' fill='#FAFAFA'/><path d='M108.724 198.614c-1.142 0-2.158-.213-3.019-.817-.021-.014-.04.014-.055-.007-.894-1.244-1.367-2.948-1.367-4.973 0-6.242 4.426-13.864 9.865-17.005 1.574-.908 3.084-1.363 4.49-1.363 1.142 0 2.158.309 3.018.913a.23.23 0 0 1 .056.056c.894 1.244 1.367 2.972 1.367 4.997 0 6.243-4.426 13.783-9.865 16.923-1.574.909-3.084 1.276-4.49 1.276zm-2.718-1.109c.774.532 1.688.776 2.718.776 1.323 0 2.754-.413 4.256-1.28 5.311-3.066 9.631-10.505 9.631-16.598 0-1.909-.434-3.523-1.255-4.685-.774-.533-1.688-.799-2.718-.799-1.323 0-2.755.441-4.256 1.308-5.311 3.066-9.631 10.506-9.631 16.599 0 1.909.434 3.517 1.255 4.679z' fill='#607D8B'/><path d='M149.318 114.262l-9.984 8.878 15.893 11.031 5.589-6.112-11.498-13.797' fill='#FAFAFA'/><path d='M169.676 120.84l-9.748 5.627c-3.642 2.103-9.528 2.113-13.147.024-3.62-2.089-3.601-5.488.041-7.591l9.495-5.608-6.729-3.885-81.836 47.071 45.923 26.514 3.081-1.779c.631-.365.869-.898.618-1.39-2.357-4.632-2.593-9.546-.683-14.262 5.638-13.92 24.509-24.815 48.618-28.07 8.169-1.103 16.68-.967 24.704.394.852.145 1.776.008 2.407-.357l3.081-1.778-25.825-14.91' fill='#FAFAFA'/><path d='M113.675 183.459a.47.47 0 0 1-.233-.062l-45.924-26.515a.468.468 0 0 1 .001-.809l81.836-47.071a.467.467 0 0 1 .466 0l6.729 3.885a.467.467 0 0 1-.467.809l-6.496-3.75-80.9 46.533 44.988 25.973 2.848-1.644c.192-.111.62-.409.435-.773-2.416-4.748-2.658-9.814-.7-14.65 2.806-6.927 8.885-13.242 17.582-18.263 8.657-4.998 19.518-8.489 31.407-10.094 8.198-1.107 16.79-.97 24.844.397.739.125 1.561.007 2.095-.301l2.381-1.374-25.125-14.506a.467.467 0 0 1 .467-.809l25.825 14.91a.467.467 0 0 1 0 .809l-3.081 1.779c-.721.417-1.763.575-2.718.413-7.963-1.351-16.457-1.486-24.563-.392-11.77 1.589-22.512 5.039-31.065 9.977-8.514 4.916-14.456 11.073-17.183 17.805-1.854 4.578-1.623 9.376.666 13.875.37.725.055 1.513-.8 2.006l-3.081 1.78a.476.476 0 0 1-.234.062' fill='#455A64'/><path d='M153.316 128.279c-2.413 0-4.821-.528-6.652-1.586-1.818-1.049-2.82-2.461-2.82-3.975 0-1.527 1.016-2.955 2.861-4.02l9.493-5.607a.233.233 0 1 1 .238.402l-9.496 5.609c-1.696.979-2.628 2.263-2.628 3.616 0 1.34.918 2.608 2.585 3.571 3.549 2.049 9.343 2.038 12.914-.024l9.748-5.628a.234.234 0 0 1 .234.405l-9.748 5.628c-1.858 1.072-4.296 1.609-6.729 1.609' fill='#607D8B'/><path d='M113.675 182.992l-45.913-26.508M113.675 183.342a.346.346 0 0 1-.175-.047l-45.913-26.508a.35.35 0 1 1 .35-.607l45.913 26.508a.35.35 0 0 1-.175.654' fill='#455A64'/><path d='M67.762 156.484v54.001c0 1.09.77 2.418 1.72 2.967l42.473 24.521c.95.549 1.72.11 1.72-.98v-54.001' fill='#FAFAFA'/><path d='M112.727 238.561c-.297 0-.62-.095-.947-.285l-42.473-24.521c-1.063-.613-1.895-2.05-1.895-3.27v-54.001a.35.35 0 1 1 .701 0v54.001c0 .96.707 2.18 1.544 2.663l42.473 24.522c.344.198.661.243.87.122.206-.119.325-.411.325-.799v-54.001a.35.35 0 1 1 .7 0v54.001c0 .655-.239 1.154-.675 1.406a1.235 1.235 0 0 1-.623.162' fill='#455A64'/><path d='M112.86 147.512h-.001c-2.318 0-4.499-.522-6.142-1.471-1.705-.984-2.643-2.315-2.643-3.749 0-1.445.952-2.791 2.68-3.788l12.041-6.953c1.668-.962 3.874-1.493 6.212-1.493 2.318 0 4.499.523 6.143 1.472 1.704.984 2.643 2.315 2.643 3.748 0 1.446-.952 2.791-2.68 3.789l-12.042 6.952c-1.668.963-3.874 1.493-6.211 1.493zm12.147-16.753c-2.217 0-4.298.497-5.861 1.399l-12.042 6.952c-1.502.868-2.33 1.998-2.33 3.182 0 1.173.815 2.289 2.293 3.142 1.538.889 3.596 1.378 5.792 1.378h.001c2.216 0 4.298-.497 5.861-1.399l12.041-6.953c1.502-.867 2.33-1.997 2.33-3.182 0-1.172-.814-2.288-2.292-3.142-1.539-.888-3.596-1.377-5.793-1.377z' fill='#607D8B'/><path d='M165.63 123.219l-5.734 3.311c-3.167 1.828-8.286 1.837-11.433.02-3.147-1.817-3.131-4.772.036-6.601l5.734-3.31 11.397 6.58' fill='#FAFAFA'/><path d='M154.233 117.448l9.995 5.771-4.682 2.704c-1.434.827-3.352 1.283-5.399 1.283-2.029 0-3.923-.449-5.333-1.263-1.29-.744-2-1.694-2-2.674 0-.991.723-1.955 2.036-2.713l5.383-3.108m0-.809l-5.734 3.31c-3.167 1.829-3.183 4.784-.036 6.601 1.568.905 3.623 1.357 5.684 1.357 2.077 0 4.159-.46 5.749-1.377l5.734-3.311-11.397-6.58M145.445 179.667c-1.773 0-3.241-.85-4.243-2.245-.067-.092-.057-.275.023-.356.08-.081.207-.12.3-.055.781.548 1.706.812 2.751.811 1.322 0 2.754-.446 4.256-1.313 5.31-3.066 9.631-10.522 9.631-16.615 0-1.927-.442-3.562-1.279-4.726a.235.235 0 0 1 .024-.301.232.232 0 0 1 .3-.027c1.67 1.172 2.59 3.38 2.59 6.219 0 6.242-4.425 13.987-9.865 17.127-1.573.908-3.083 1.481-4.488 1.481zM142.476 178c.814.651 1.82 1.002 2.969 1.002 1.322 0 2.753-.452 4.255-1.32 5.31-3.065 9.631-10.523 9.631-16.617 0-1.98-.463-3.63-1.325-4.793.411 1.035.624 2.26.624 3.62 0 6.242-4.425 13.875-9.865 17.015-1.573.909-3.084 1.376-4.489 1.376a5.49 5.49 0 0 1-1.8-.283z' fill='#607D8B'/><path d='M148.648 176.704c5.384-3.108 9.748-10.636 9.748-16.813 0-2.052-.483-3.693-1.322-4.861-1.785-1.252-4.375-1.194-7.258.471-5.383 3.108-9.748 10.636-9.748 16.813 0 2.051.484 3.692 1.323 4.86 1.785 1.253 4.374 1.195 7.257-.47' fill='#FAFAFA'/><path d='M144.276 178.276c-1.143 0-2.158-.307-3.019-.911a.217.217 0 0 1-.055-.054c-.895-1.244-1.367-2.972-1.367-4.997 0-6.241 4.425-13.875 9.865-17.016 1.573-.908 3.084-1.369 4.489-1.369 1.143 0 2.158.307 3.019.91a.24.24 0 0 1 .055.055c.894 1.244 1.367 2.971 1.367 4.997 0 6.241-4.425 13.875-9.865 17.016-1.573.908-3.084 1.369-4.489 1.369zm-2.718-1.172c.773.533 1.687.901 2.718.901 1.322 0 2.754-.538 4.256-1.405 5.31-3.066 9.631-10.567 9.631-16.661 0-1.908-.434-3.554-1.256-4.716-.774-.532-1.688-.814-2.718-.814-1.322 0-2.754.433-4.256 1.3-5.31 3.066-9.631 10.564-9.631 16.657 0 1.91.434 3.576 1.256 4.738z' fill='#607D8B'/><path d='M150.72 172.361l-.363-.295a24.105 24.105 0 0 0 2.148-3.128 24.05 24.05 0 0 0 1.977-4.375l.443.149a24.54 24.54 0 0 1-2.015 4.46 24.61 24.61 0 0 1-2.19 3.189M115.917 191.514l-.363-.294a24.174 24.174 0 0 0 2.148-3.128 24.038 24.038 0 0 0 1.976-4.375l.443.148a24.48 24.48 0 0 1-2.015 4.461 24.662 24.662 0 0 1-2.189 3.188M114 237.476V182.584 237.476' fill='#607D8B'/><g><path d='M81.822 37.474c.017-.135-.075-.28-.267-.392-.327-.188-.826-.21-1.109-.045l-6.012 3.471c-.131.076-.194.178-.191.285.002.132.002.461.002.578v.043l-.007.128-6.591 3.779c-.001 0-2.077 1.046-2.787 5.192 0 0-.912 6.961-.898 19.745.015 12.57.606 17.07 1.167 21.351.22 1.684 3.001 2.125 3.001 2.125.331.04.698-.027 1.08-.248l75.273-43.551c1.808-1.069 2.667-3.719 3.056-6.284 1.213-7.99 1.675-32.978-.275-39.878-.196-.693-.51-1.083-.868-1.282l-2.086-.79c-.727.028-1.416.467-1.534.535L82.032 37.072l-.21.402' fill='#FFF'/><path d='M144.311 1.701l2.085.79c.358.199.672.589.868 1.282 1.949 6.9 1.487 31.887.275 39.878-.39 2.565-1.249 5.215-3.056 6.284L69.21 93.486a1.78 1.78 0 0 1-.896.258l-.183-.011c0 .001-2.782-.44-3.003-2.124-.56-4.282-1.151-8.781-1.165-21.351-.015-12.784.897-19.745.897-19.745.71-4.146 2.787-5.192 2.787-5.192l6.591-3.779.007-.128v-.043c0-.117 0-.446-.002-.578-.003-.107.059-.21.191-.285l6.012-3.472a.98.98 0 0 1 .481-.11c.218 0 .449.053.627.156.193.112.285.258.268.392l.211-.402 60.744-34.836c.117-.068.806-.507 1.534-.535m0-.997l-.039.001c-.618.023-1.283.244-1.974.656l-.021.012-60.519 34.706a2.358 2.358 0 0 0-.831-.15c-.365 0-.704.084-.98.244l-6.012 3.471c-.442.255-.699.69-.689 1.166l.001.15-6.08 3.487c-.373.199-2.542 1.531-3.29 5.898l-.006.039c-.009.07-.92 7.173-.906 19.875.014 12.62.603 17.116 1.172 21.465l.002.015c.308 2.355 3.475 2.923 3.836 2.98l.034.004c.101.013.204.019.305.019a2.77 2.77 0 0 0 1.396-.392l75.273-43.552c1.811-1.071 2.999-3.423 3.542-6.997 1.186-7.814 1.734-33.096-.301-40.299-.253-.893-.704-1.527-1.343-1.882l-.132-.062-2.085-.789a.973.973 0 0 0-.353-.065' fill='#455A64'/><path d='M128.267 11.565l1.495.434-56.339 32.326' fill='#FFF'/><path d='M74.202 90.545a.5.5 0 0 1-.25-.931l18.437-10.645a.499.499 0 1 1 .499.864L74.451 90.478l-.249.067M75.764 42.654l-.108-.062.046-.171 5.135-2.964.17.045-.045.171-5.135 2.964-.063.017M70.52 90.375V46.421l.063-.036L137.84 7.554v43.954l-.062.036L70.52 90.375zm.25-43.811v43.38l66.821-38.579V7.985L70.77 46.564z' fill='#607D8B'/><path d='M86.986 83.182c-.23.149-.612.384-.849.523l-11.505 6.701c-.237.139-.206.252.068.252h.565c.275 0 .693-.113.93-.252L87.7 83.705c.237-.139.428-.253.425-.256a11.29 11.29 0 0 1-.006-.503c0-.274-.188-.377-.418-.227l-.715.463' fill='#607D8B'/><path d='M75.266 90.782H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.236-.138.615-.371.844-.519l.715-.464a.488.488 0 0 1 .266-.089c.172 0 .345.13.345.421 0 .214.001.363.003.437l.006.004-.004.069c-.003.075-.003.075-.486.356l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.108.866-.234l11.505-6.702c.168-.098.294-.173.361-.214-.004-.084-.004-.218-.004-.437l-.095-.171-.131.049-.714.463c-.232.15-.616.386-.854.525l-11.505 6.702-.029.018z' fill='#607D8B'/><path d='M75.266 89.871H74.7c-.2 0-.316-.056-.346-.166-.03-.11.043-.217.215-.317l11.505-6.702c.258-.151.694-.268.993-.268h.565c.2 0 .316.056.346.166.03.11-.043.217-.215.317l-11.505 6.702a2.282 2.282 0 0 1-.992.268zm-.6-.25l.034.001h.566c.252 0 .649-.107.866-.234l11.505-6.702.03-.018-.035-.001h-.565c-.252 0-.649.108-.867.234l-11.505 6.702-.029.018zM74.37 90.801v-1.247 1.247' fill='#607D8B'/><path d='M68.13 93.901c-.751-.093-1.314-.737-1.439-1.376-.831-4.238-1.151-8.782-1.165-21.352-.015-12.784.897-19.745.897-19.745.711-4.146 2.787-5.192 2.787-5.192l74.859-43.219c.223-.129 2.487-1.584 3.195.923 1.95 6.9 1.488 31.887.275 39.878-.389 2.565-1.248 5.215-3.056 6.283L69.21 93.653c-.382.221-.749.288-1.08.248 0 0-2.781-.441-3.001-2.125-.561-4.281-1.152-8.781-1.167-21.351-.014-12.784.898-19.745.898-19.745.71-4.146 2.787-5.191 2.787-5.191l6.598-3.81.871-.119 6.599-3.83.046-.461L68.13 93.901' fill='#FAFAFA'/><path d='M68.317 94.161l-.215-.013h-.001l-.244-.047c-.719-.156-2.772-.736-2.976-2.292-.568-4.34-1.154-8.813-1.168-21.384-.014-12.654.891-19.707.9-19.777.725-4.231 2.832-5.338 2.922-5.382l6.628-3.827.87-.119 6.446-3.742.034-.334a.248.248 0 0 1 .273-.223.248.248 0 0 1 .223.272l-.059.589-6.752 3.919-.87.118-6.556 3.785c-.031.016-1.99 1.068-2.666 5.018-.007.06-.908 7.086-.894 19.702.014 12.539.597 16.996 1.161 21.305.091.691.689 1.154 1.309 1.452a1.95 1.95 0 0 1-.236-.609c-.781-3.984-1.155-8.202-1.17-21.399-.014-12.653.891-19.707.9-19.777.725-4.231 2.832-5.337 2.922-5.382-.004.001 74.444-42.98 74.846-43.212l.028-.017c.904-.538 1.72-.688 2.36-.433.555.221.949.733 1.172 1.52 2.014 7.128 1.46 32.219.281 39.983-.507 3.341-1.575 5.515-3.175 6.462L69.335 93.869a2.023 2.023 0 0 1-1.018.292zm-.147-.507c.293.036.604-.037.915-.217l75.273-43.551c1.823-1.078 2.602-3.915 2.934-6.106 1.174-7.731 1.731-32.695-.268-39.772-.178-.631-.473-1.032-.876-1.192-.484-.193-1.166-.052-1.921.397l-.034.021-74.858 43.218c-.031.017-1.989 1.069-2.666 5.019-.007.059-.908 7.085-.894 19.702.015 13.155.386 17.351 1.161 21.303.09.461.476.983 1.037 1.139.114.025.185.037.196.039h.001z' fill='#455A64'/><path d='M69.317 68.982c.489-.281.885-.056.885.505 0 .56-.396 1.243-.885 1.525-.488.282-.884.057-.884-.504 0-.56.396-1.243.884-1.526' fill='#FFF'/><path d='M68.92 71.133c-.289 0-.487-.228-.487-.625 0-.56.396-1.243.884-1.526a.812.812 0 0 1 .397-.121c.289 0 .488.229.488.626 0 .56-.396 1.243-.885 1.525a.812.812 0 0 1-.397.121m.794-2.459a.976.976 0 0 0-.49.147c-.548.317-.978 1.058-.978 1.687 0 .486.271.812.674.812a.985.985 0 0 0 .491-.146c.548-.317.978-1.057.978-1.687 0-.486-.272-.813-.675-.813' fill='#8097A2'/><path d='M68.92 70.947c-.271 0-.299-.307-.299-.439 0-.491.361-1.116.79-1.363a.632.632 0 0 1 .303-.096c.272 0 .301.306.301.438 0 .491-.363 1.116-.791 1.364a.629.629 0 0 1-.304.096m.794-2.086a.812.812 0 0 0-.397.121c-.488.283-.884.966-.884 1.526 0 .397.198.625.487.625a.812.812 0 0 0 .397-.121c.489-.282.885-.965.885-1.525 0-.397-.199-.626-.488-.626' fill='#8097A2'/><path d='M69.444 85.35c.264-.152.477-.031.477.272 0 .303-.213.67-.477.822-.263.153-.477.031-.477-.271 0-.302.214-.671.477-.823' fill='#FFF'/><path d='M69.23 86.51c-.156 0-.263-.123-.263-.337 0-.302.214-.671.477-.823a.431.431 0 0 1 .214-.066c.156 0 .263.124.263.338 0 .303-.213.67-.477.822a.431.431 0 0 1-.214.066m.428-1.412c-.1 0-.203.029-.307.09-.32.185-.57.618-.57.985 0 .309.185.524.449.524a.63.63 0 0 0 .308-.09c.32-.185.57-.618.57-.985 0-.309-.185-.524-.45-.524' fill='#8097A2'/><path d='M69.23 86.322l-.076-.149c0-.235.179-.544.384-.661l.12-.041.076.151c0 .234-.179.542-.383.66l-.121.04m.428-1.038a.431.431 0 0 0-.214.066c-.263.152-.477.521-.477.823 0 .214.107.337.263.337a.431.431 0 0 0 .214-.066c.264-.152.477-.519.477-.822 0-.214-.107-.338-.263-.338' fill='#8097A2'/><path d='M139.278 7.769v43.667L72.208 90.16V46.493l67.07-38.724' fill='#455A64'/><path d='M72.083 90.375V46.421l.063-.036 67.257-38.831v43.954l-.062.036-67.258 38.831zm.25-43.811v43.38l66.821-38.579V7.985L72.333 46.564z' fill='#607D8B'/></g><path d='M125.737 88.647l-7.639 3.334V84l-11.459 4.713v8.269L99 100.315l13.369 3.646 13.368-15.314' fill='#455A64'/></g></svg>";function it(){this.loadIcon_();var ae=document.createElement("div"),pt=ae.style;pt.position="fixed",pt.top=0,pt.right=0,pt.bottom=0,pt.left=0,pt.backgroundColor="gray",pt.fontFamily="sans-serif",pt.zIndex=1e6;var pe=document.createElement("img");pe.src=this.icon;var pt=pe.style;pt.marginLeft="25%",pt.marginTop="25%",pt.width="50%",ae.appendChild(pe);var Ce=document.createElement("div"),pt=Ce.style;pt.textAlign="center",pt.fontSize="16px",pt.lineHeight="24px",pt.margin="24px 25%",pt.width="50%",Ce.innerHTML="Place your phone into your Cardboard viewer.",ae.appendChild(Ce);var fe=document.createElement("div"),pt=fe.style;pt.backgroundColor="#CFD8DC",pt.position="fixed",pt.bottom=0,pt.width="100%",pt.height="48px",pt.padding="14px 24px",pt.boxSizing="border-box",pt.color="#656A6B",ae.appendChild(fe);var He=document.createElement("div");He.style.float="left",He.innerHTML="No Cardboard viewer?";var ot=document.createElement("a");ot.href="https://www.google.com/get/cardboard/get-cardboard/",ot.innerHTML="get one",ot.target="_blank";var pt=ot.style;pt.float="right",pt.fontWeight=600,pt.textTransform="uppercase",pt.borderLeft="1px solid gray",pt.paddingLeft="24px",pt.textDecoration="none",pt.color="#656A6B",fe.appendChild(He),fe.appendChild(ot),this.overlay=ae,this.text=Ce,this.hide()}it.prototype.show=function(ae){!ae&&!this.overlay.parentElement?document.body.appendChild(this.overlay):ae&&(this.overlay.parentElement&&this.overlay.parentElement!=ae&&this.overlay.parentElement.removeChild(this.overlay),ae.appendChild(this.overlay)),this.overlay.style.display="block";var pe=this.overlay.querySelector("img"),Ce=pe.style;K()?(Ce.width="20%",Ce.marginLeft="40%",Ce.marginTop="3%"):(Ce.width="50%",Ce.marginLeft="25%",Ce.marginTop="25%")},it.prototype.hide=function(){this.overlay.style.display="none"},it.prototype.showTemporarily=function(ae,pe){this.show(pe),this.timer=setTimeout(this.hide.bind(this),ae)},it.prototype.disableShowTemporarily=function(){clearTimeout(this.timer)},it.prototype.update=function(){this.disableShowTemporarily(),!K()&&vt()?this.show():this.hide()},it.prototype.loadIcon_=function(){this.icon=te("image/svg+xml",ft)};var xt="CardboardV1",Dt="WEBVR_CARDBOARD_VIEWER",Kt="webvr-polyfill-viewer-selector";function Wt(ae){try{this.selectedKey=localStorage.getItem(Dt)}catch(pe){console.error("Failed to load viewer profile: %s",pe)}this.selectedKey||(this.selectedKey=ae||xt),this.dialog=this.createDialog_(Cn.Viewers),this.root=null,this.onChangeCallbacks_=[]}Wt.prototype.show=function(ae){this.root=ae,ae.appendChild(this.dialog);var pe=this.dialog.querySelector("#"+this.selectedKey);pe.checked=!0,this.dialog.style.display="block"},Wt.prototype.hide=function(){this.root&&this.root.contains(this.dialog)&&this.root.removeChild(this.dialog),this.dialog.style.display="none"},Wt.prototype.getCurrentViewer=function(){return Cn.Viewers[this.selectedKey]},Wt.prototype.getSelectedKey_=function(){var ae=this.dialog.querySelector("input[name=field]:checked");return ae?ae.id:null},Wt.prototype.onChange=function(ae){this.onChangeCallbacks_.push(ae)},Wt.prototype.fireOnChange_=function(ae){for(var pe=0;pe<this.onChangeCallbacks_.length;pe++)this.onChangeCallbacks_[pe](ae)},Wt.prototype.onSave_=function(){if(this.selectedKey=this.getSelectedKey_(),!this.selectedKey||!Cn.Viewers[this.selectedKey]){console.error("ViewerSelector.onSave_: this should never happen!");return}this.fireOnChange_(Cn.Viewers[this.selectedKey]);try{localStorage.setItem(Dt,this.selectedKey)}catch(ae){console.error("Failed to save viewer profile: %s",ae)}this.hide()},Wt.prototype.createDialog_=function(ae){var pe=document.createElement("div");pe.classList.add(Kt),pe.style.display="none";var Ce=document.createElement("div"),ot=Ce.style;ot.position="fixed",ot.left=0,ot.top=0,ot.width="100%",ot.height="100%",ot.background="rgba(0, 0, 0, 0.3)",Ce.addEventListener("click",this.hide.bind(this));var fe=280,He=document.createElement("div"),ot=He.style;ot.boxSizing="border-box",ot.position="fixed",ot.top="24px",ot.left="50%",ot.marginLeft=-fe/2+"px",ot.width=fe+"px",ot.padding="24px",ot.overflow="hidden",ot.background="#fafafa",ot.fontFamily="'Roboto', sans-serif",ot.boxShadow="0px 5px 20px #666",He.appendChild(this.createH1_("Select your viewer"));for(var pt in ae)He.appendChild(this.createChoice_(pt,ae[pt].label));return He.appendChild(this.createButton_("Save",this.onSave_.bind(this))),pe.appendChild(Ce),pe.appendChild(He),pe},Wt.prototype.createH1_=function(ae){var pe=document.createElement("h1"),Ce=pe.style;return Ce.color="black",Ce.fontSize="20px",Ce.fontWeight="bold",Ce.marginTop=0,Ce.marginBottom="24px",pe.innerHTML=ae,pe},Wt.prototype.createChoice_=function(ae,pe){var Ce=document.createElement("div");Ce.style.marginTop="8px",Ce.style.color="black";var fe=document.createElement("input");fe.style.fontSize="30px",fe.setAttribute("id",ae),fe.setAttribute("type","radio"),fe.setAttribute("value",ae),fe.setAttribute("name","field");var He=document.createElement("label");return He.style.marginLeft="4px",He.setAttribute("for",ae),He.innerHTML=pe,Ce.appendChild(fe),Ce.appendChild(He),Ce},Wt.prototype.createButton_=function(ae,pe){var Ce=document.createElement("button");Ce.innerHTML=ae;var fe=Ce.style;return fe.float="right",fe.textTransform="uppercase",fe.color="#1094f7",fe.fontSize="14px",fe.letterSpacing=0,fe.border=0,fe.background="none",fe.marginTop="16px",Ce.addEventListener("click",pe),Ce};var bt=typeof window!="undefined"?window:typeof c!="undefined"?c:typeof self!="undefined"?self:{};function jt(ae){return ae&&ae.__esModule&&Object.prototype.hasOwnProperty.call(ae,"default")?ae.default:ae}function on(ae,pe){return pe={exports:{}},ae(pe,pe.exports),pe.exports}var $t=on(function(ae,pe){(function(fe,He){ae.exports=He()})(bt,function(){return function(Ce){var fe={};function He(ot){if(fe[ot])return fe[ot].exports;var pt=fe[ot]={i:ot,l:!1,exports:{}};return Ce[ot].call(pt.exports,pt,pt.exports,He),pt.l=!0,pt.exports}return He.m=Ce,He.c=fe,He.d=function(ot,pt,Ut){He.o(ot,pt)||Object.defineProperty(ot,pt,{configurable:!1,enumerable:!0,get:Ut})},He.n=function(ot){var pt=ot&&ot.__esModule?function(){return ot.default}:function(){return ot};return He.d(pt,"a",pt),pt},He.o=function(ot,pt){return Object.prototype.hasOwnProperty.call(ot,pt)},He.p="",He(He.s=0)}([function(Ce,fe,He){var ot=function(){function Ot(Qt,_n){for(var Tn=0;Tn<_n.length;Tn++){var Ln=_n[Tn];Ln.enumerable=Ln.enumerable||!1,Ln.configurable=!0,"value"in Ln&&(Ln.writable=!0),Object.defineProperty(Qt,Ln.key,Ln)}}return function(Qt,_n,Tn){return _n&&Ot(Qt.prototype,_n),Tn&&Ot(Qt,Tn),Qt}}();function pt(Ot,Qt){if(!(Ot instanceof Qt))throw new TypeError("Cannot call a class as a function")}var Ut=He(1),Vt=typeof navigator!="undefined"&&parseFloat((""+(/CPU.*OS ([0-9_]{3,4})[0-9_]{0,1}|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))<10&&!window.MSStream,gt=function(){function Ot(){pt(this,Ot),Vt?this.noSleepTimer=null:(this.noSleepVideo=document.createElement("video"),this.noSleepVideo.setAttribute("playsinline",""),this.noSleepVideo.setAttribute("src",Ut),this.noSleepVideo.addEventListener("timeupdate",function(Qt){this.noSleepVideo.currentTime>.5&&(this.noSleepVideo.currentTime=Math.random())}.bind(this)))}return ot(Ot,[{key:"enable",value:function(){Vt?(this.disable(),this.noSleepTimer=window.setInterval(function(){window.location.href="/",window.setTimeout(window.stop,0)},15e3)):this.noSleepVideo.play()}},{key:"disable",value:function(){Vt?this.noSleepTimer&&(window.clearInterval(this.noSleepTimer),this.noSleepTimer=null):this.noSleepVideo.pause()}}]),Ot}();Ce.exports=gt},function(Ce,fe,He){Ce.exports="data:video/mp4;base64,AAAAIGZ0eXBtcDQyAAACAGlzb21pc28yYXZjMW1wNDEAAAAIZnJlZQAACKBtZGF0AAAC8wYF///v3EXpvebZSLeWLNgg2SPu73gyNjQgLSBjb3JlIDE0MiByMjQ3OSBkZDc5YTYxIC0gSC4yNjQvTVBFRy00IEFWQyBjb2RlYyAtIENvcHlsZWZ0IDIwMDMtMjAxNCAtIGh0dHA6Ly93d3cudmlkZW9sYW4ub3JnL3gyNjQuaHRtbCAtIG9wdGlvbnM6IGNhYmFjPTEgcmVmPTEgZGVibG9jaz0xOjA6MCBhbmFseXNlPTB4MToweDExMSBtZT1oZXggc3VibWU9MiBwc3k9MSBwc3lfcmQ9MS4wMDowLjAwIG1peGVkX3JlZj0wIG1lX3JhbmdlPTE2IGNocm9tYV9tZT0xIHRyZWxsaXM9MCA4eDhkY3Q9MCBjcW09MCBkZWFkem9uZT0yMSwxMSBmYXN0X3Bza2lwPTEgY2hyb21hX3FwX29mZnNldD0wIHRocmVhZHM9NiBsb29rYWhlYWRfdGhyZWFkcz0xIHNsaWNlZF90aHJlYWRzPTAgbnI9MCBkZWNpbWF0ZT0xIGludGVybGFjZWQ9MCBibHVyYXlfY29tcGF0PTAgY29uc3RyYWluZWRfaW50cmE9MCBiZnJhbWVzPTMgYl9weXJhbWlkPTIgYl9hZGFwdD0xIGJfYmlhcz0wIGRpcmVjdD0xIHdlaWdodGI9MSBvcGVuX2dvcD0wIHdlaWdodHA9MSBrZXlpbnQ9MzAwIGtleWludF9taW49MzAgc2NlbmVjdXQ9NDAgaW50cmFfcmVmcmVzaD0wIHJjX2xvb2thaGVhZD0xMCByYz1jcmYgbWJ0cmVlPTEgY3JmPTIwLjAgcWNvbXA9MC42MCBxcG1pbj0wIHFwbWF4PTY5IHFwc3RlcD00IHZidl9tYXhyYXRlPTIwMDAwIHZidl9idWZzaXplPTI1MDAwIGNyZl9tYXg9MC4wIG5hbF9ocmQ9bm9uZSBmaWxsZXI9MCBpcF9yYXRpbz0xLjQwIGFxPTE6MS4wMACAAAAAOWWIhAA3//p+C7v8tDDSTjf97w55i3SbRPO4ZY+hkjD5hbkAkL3zpJ6h/LR1CAABzgB1kqqzUorlhQAAAAxBmiQYhn/+qZYADLgAAAAJQZ5CQhX/AAj5IQADQGgcIQADQGgcAAAACQGeYUQn/wALKCEAA0BoHAAAAAkBnmNEJ/8ACykhAANAaBwhAANAaBwAAAANQZpoNExDP/6plgAMuSEAA0BoHAAAAAtBnoZFESwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBnqVEJ/8ACykhAANAaBwAAAAJAZ6nRCf/AAsoIQADQGgcIQADQGgcAAAADUGarDRMQz/+qZYADLghAANAaBwAAAALQZ7KRRUsK/8ACPkhAANAaBwAAAAJAZ7pRCf/AAsoIQADQGgcIQADQGgcAAAACQGe60Qn/wALKCEAA0BoHAAAAA1BmvA0TEM//qmWAAy5IQADQGgcIQADQGgcAAAAC0GfDkUVLCv/AAj5IQADQGgcAAAACQGfLUQn/wALKSEAA0BoHCEAA0BoHAAAAAkBny9EJ/8ACyghAANAaBwAAAANQZs0NExDP/6plgAMuCEAA0BoHAAAAAtBn1JFFSwr/wAI+SEAA0BoHCEAA0BoHAAAAAkBn3FEJ/8ACyghAANAaBwAAAAJAZ9zRCf/AAsoIQADQGgcIQADQGgcAAAADUGbeDRMQz/+qZYADLkhAANAaBwAAAALQZ+WRRUsK/8ACPghAANAaBwhAANAaBwAAAAJAZ+1RCf/AAspIQADQGgcAAAACQGft0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bm7w0TEM//qmWAAy4IQADQGgcAAAAC0Gf2kUVLCv/AAj5IQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHAAAAAkBn/tEJ/8ACykhAANAaBwAAAANQZvgNExDP/6plgAMuSEAA0BoHCEAA0BoHAAAAAtBnh5FFSwr/wAI+CEAA0BoHAAAAAkBnj1EJ/8ACyghAANAaBwhAANAaBwAAAAJAZ4/RCf/AAspIQADQGgcAAAADUGaJDRMQz/+qZYADLghAANAaBwAAAALQZ5CRRUsK/8ACPkhAANAaBwhAANAaBwAAAAJAZ5hRCf/AAsoIQADQGgcAAAACQGeY0Qn/wALKSEAA0BoHCEAA0BoHAAAAA1Bmmg0TEM//qmWAAy5IQADQGgcAAAAC0GehkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGepUQn/wALKSEAA0BoHAAAAAkBnqdEJ/8ACyghAANAaBwAAAANQZqsNExDP/6plgAMuCEAA0BoHCEAA0BoHAAAAAtBnspFFSwr/wAI+SEAA0BoHAAAAAkBnulEJ/8ACyghAANAaBwhAANAaBwAAAAJAZ7rRCf/AAsoIQADQGgcAAAADUGa8DRMQz/+qZYADLkhAANAaBwhAANAaBwAAAALQZ8ORRUsK/8ACPkhAANAaBwAAAAJAZ8tRCf/AAspIQADQGgcIQADQGgcAAAACQGfL0Qn/wALKCEAA0BoHAAAAA1BmzQ0TEM//qmWAAy4IQADQGgcAAAAC0GfUkUVLCv/AAj5IQADQGgcIQADQGgcAAAACQGfcUQn/wALKCEAA0BoHAAAAAkBn3NEJ/8ACyghAANAaBwhAANAaBwAAAANQZt4NExC//6plgAMuSEAA0BoHAAAAAtBn5ZFFSwr/wAI+CEAA0BoHCEAA0BoHAAAAAkBn7VEJ/8ACykhAANAaBwAAAAJAZ+3RCf/AAspIQADQGgcAAAADUGbuzRMQn/+nhAAYsAhAANAaBwhAANAaBwAAAAJQZ/aQhP/AAspIQADQGgcAAAACQGf+UQn/wALKCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHCEAA0BoHAAACiFtb292AAAAbG12aGQAAAAA1YCCX9WAgl8AAAPoAAAH/AABAAABAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAAAAGGlvZHMAAAAAEICAgAcAT////v7/AAAF+XRyYWsAAABcdGtoZAAAAAPVgIJf1YCCXwAAAAEAAAAAAAAH0AAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAEAAAAAAygAAAMoAAAAAACRlZHRzAAAAHGVsc3QAAAAAAAAAAQAAB9AAABdwAAEAAAAABXFtZGlhAAAAIG1kaGQAAAAA1YCCX9WAgl8AAV+QAAK/IFXEAAAAAAAtaGRscgAAAAAAAAAAdmlkZQAAAAAAAAAAAAAAAFZpZGVvSGFuZGxlcgAAAAUcbWluZgAAABR2bWhkAAAAAQAAAAAAAAAAAAAAJGRpbmYAAAAcZHJlZgAAAAAAAAABAAAADHVybCAAAAABAAAE3HN0YmwAAACYc3RzZAAAAAAAAAABAAAAiGF2YzEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAAAygDKAEgAAABIAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAY//8AAAAyYXZjQwFNQCj/4QAbZ01AKOyho3ySTUBAQFAAAAMAEAAr8gDxgxlgAQAEaO+G8gAAABhzdHRzAAAAAAAAAAEAAAA8AAALuAAAABRzdHNzAAAAAAAAAAEAAAABAAAB8GN0dHMAAAAAAAAAPAAAAAEAABdwAAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAADqYAAAAAQAAF3AAAAABAAAAAAAAAAEAAAu4AAAAAQAAOpgAAAABAAAXcAAAAAEAAAAAAAAAAQAAC7gAAAABAAA6mAAAAAEAABdwAAAAAQAAAAAAAAABAAALuAAAAAEAAC7gAAAAAQAAF3AAAAABAAAAAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAEEc3RzegAAAAAAAAAAAAAAPAAAAzQAAAAQAAAADQAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAAPAAAADQAAAA0AAAARAAAADwAAAA0AAAANAAAAEQAAAA8AAAANAAAADQAAABEAAAANAAAADQAAAQBzdGNvAAAAAAAAADwAAAAwAAADZAAAA3QAAAONAAADoAAAA7kAAAPQAAAD6wAAA/4AAAQXAAAELgAABEMAAARcAAAEbwAABIwAAAShAAAEugAABM0AAATkAAAE/wAABRIAAAUrAAAFQgAABV0AAAVwAAAFiQAABaAAAAW1AAAFzgAABeEAAAX+AAAGEwAABiwAAAY/AAAGVgAABnEAAAaEAAAGnQAABrQAAAbPAAAG4gAABvUAAAcSAAAHJwAAB0AAAAdTAAAHcAAAB4UAAAeeAAAHsQAAB8gAAAfjAAAH9gAACA8AAAgmAAAIQQAACFQAAAhnAAAIhAAACJcAAAMsdHJhawAAAFx0a2hkAAAAA9WAgl/VgIJfAAAAAgAAAAAAAAf8AAAAAAAAAAAAAAABAQAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAACsm1kaWEAAAAgbWRoZAAAAADVgIJf1YCCXwAArEQAAWAAVcQAAAAAACdoZGxyAAAAAAAAAABzb3VuAAAAAAAAAAAAAAAAU3RlcmVvAAAAAmNtaW5mAAAAEHNtaGQAAAAAAAAAAAAAACRkaW5mAAAAHGRyZWYAAAAAAAAAAQAAAAx1cmwgAAAAAQAAAidzdGJsAAAAZ3N0c2QAAAAAAAAAAQAAAFdtcDRhAAAAAAAAAAEAAAAAAAAAAAACABAAAAAArEQAAAAAADNlc2RzAAAAAAOAgIAiAAIABICAgBRAFQAAAAADDUAAAAAABYCAgAISEAaAgIABAgAAABhzdHRzAAAAAAAAAAEAAABYAAAEAAAAABxzdHNjAAAAAAAAAAEAAAABAAAAAQAAAAEAAAAUc3RzegAAAAAAAAAGAAAAWAAAAXBzdGNvAAAAAAAAAFgAAAOBAAADhwAAA5oAAAOtAAADswAAA8oAAAPfAAAD5QAAA/gAAAQLAAAEEQAABCgAAAQ9AAAEUAAABFYAAARpAAAEgAAABIYAAASbAAAErgAABLQAAATHAAAE3gAABPMAAAT5AAAFDAAABR8AAAUlAAAFPAAABVEAAAVXAAAFagAABX0AAAWDAAAFmgAABa8AAAXCAAAFyAAABdsAAAXyAAAF+AAABg0AAAYgAAAGJgAABjkAAAZQAAAGZQAABmsAAAZ+AAAGkQAABpcAAAauAAAGwwAABskAAAbcAAAG7wAABwYAAAcMAAAHIQAABzQAAAc6AAAHTQAAB2QAAAdqAAAHfwAAB5IAAAeYAAAHqwAAB8IAAAfXAAAH3QAAB/AAAAgDAAAICQAACCAAAAg1AAAIOwAACE4AAAhhAAAIeAAACH4AAAiRAAAIpAAACKoAAAiwAAAItgAACLwAAAjCAAAAFnVkdGEAAAAObmFtZVN0ZXJlbwAAAHB1ZHRhAAAAaG1ldGEAAAAAAAAAIWhkbHIAAAAAAAAAAG1kaXJhcHBsAAAAAAAAAAAAAAAAO2lsc3QAAAAzqXRvbwAAACtkYXRhAAAAAQAAAABIYW5kQnJha2UgMC4xMC4yIDIwMTUwNjExMDA="}])})}),vn=jt($t),Jt=1e3,nn=[0,0,.5,1],hn=[.5,0,.5,1],rn=window.requestAnimationFrame,Rt=window.cancelAnimationFrame;function yt(){this.leftProjectionMatrix=new Float32Array(16),this.leftViewMatrix=new Float32Array(16),this.rightProjectionMatrix=new Float32Array(16),this.rightViewMatrix=new Float32Array(16),this.pose=null}function Bt(ae){Object.defineProperties(this,{hasPosition:{writable:!1,enumerable:!0,value:ae.hasPosition},hasExternalDisplay:{writable:!1,enumerable:!0,value:ae.hasExternalDisplay},canPresent:{writable:!1,enumerable:!0,value:ae.canPresent},maxLayers:{writable:!1,enumerable:!0,value:ae.maxLayers},hasOrientation:{enumerable:!0,get:function(){return Ee("VRDisplayCapabilities.prototype.hasOrientation","VRDisplay.prototype.getFrameData"),ae.hasOrientation}}})}function Ft(ae){ae=ae||{};var pe="wakelock"in ae?ae.wakelock:!0;this.isPolyfilled=!0,this.displayId=Jt++,this.displayName="",this.depthNear=.01,this.depthFar=1e4,this.isPresenting=!1,Object.defineProperty(this,"isConnected",{get:function(){return Ee("VRDisplay.prototype.isConnected","VRDisplayCapabilities.prototype.hasExternalDisplay"),!1}}),this.capabilities=new Bt({hasPosition:!1,hasOrientation:!1,hasExternalDisplay:!1,canPresent:!1,maxLayers:1}),this.stageParameters=null,this.waitingForPresent_=!1,this.layer_=null,this.originalParent_=null,this.fullscreenElement_=null,this.fullscreenWrapper_=null,this.fullscreenElementCachedStyle_=null,this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null,pe&&vt()&&(this.wakelock_=new vn)}Ft.prototype.getFrameData=function(ae){return Be(ae,this._getPose(),this)},Ft.prototype.getPose=function(){return Ee("VRDisplay.prototype.getPose","VRDisplay.prototype.getFrameData"),this._getPose()},Ft.prototype.resetPose=function(){return Ee("VRDisplay.prototype.resetPose"),this._resetPose()},Ft.prototype.getImmediatePose=function(){return Ee("VRDisplay.prototype.getImmediatePose","VRDisplay.prototype.getFrameData"),this._getPose()},Ft.prototype.requestAnimationFrame=function(ae){return rn(ae)},Ft.prototype.cancelAnimationFrame=function(ae){return Rt(ae)},Ft.prototype.wrapForFullscreen=function(ae){if(L())return ae;if(!this.fullscreenWrapper_){this.fullscreenWrapper_=document.createElement("div");var pe=["height: "+Math.min(screen.height,screen.width)+"px !important","top: 0 !important","left: 0 !important","right: 0 !important","border: 0","margin: 0","padding: 0","z-index: 999999 !important","position: fixed"];this.fullscreenWrapper_.setAttribute("style",pe.join("; ")+";"),this.fullscreenWrapper_.classList.add("webvr-polyfill-fullscreen-wrapper")}if(this.fullscreenElement_==ae)return this.fullscreenWrapper_;if(this.fullscreenElement_&&(this.originalParent_?this.originalParent_.appendChild(this.fullscreenElement_):this.fullscreenElement_.parentElement.removeChild(this.fullscreenElement_)),this.fullscreenElement_=ae,this.originalParent_=ae.parentElement,this.originalParent_||document.body.appendChild(ae),!this.fullscreenWrapper_.parentElement){var Ce=this.fullscreenElement_.parentElement;Ce.insertBefore(this.fullscreenWrapper_,this.fullscreenElement_),Ce.removeChild(this.fullscreenElement_)}this.fullscreenWrapper_.insertBefore(this.fullscreenElement_,this.fullscreenWrapper_.firstChild),this.fullscreenElementCachedStyle_=this.fullscreenElement_.getAttribute("style");var fe=this;function He(){if(!!fe.fullscreenElement_){var ot=["position: absolute","top: 0","left: 0","width: "+Math.max(screen.width,screen.height)+"px","height: "+Math.min(screen.height,screen.width)+"px","border: 0","margin: 0","padding: 0"];fe.fullscreenElement_.setAttribute("style",ot.join("; ")+";")}}return He(),this.fullscreenWrapper_},Ft.prototype.removeFullscreenWrapper=function(){if(!!this.fullscreenElement_){var ae=this.fullscreenElement_;this.fullscreenElementCachedStyle_?ae.setAttribute("style",this.fullscreenElementCachedStyle_):ae.removeAttribute("style"),this.fullscreenElement_=null,this.fullscreenElementCachedStyle_=null;var pe=this.fullscreenWrapper_.parentElement;return this.fullscreenWrapper_.removeChild(ae),this.originalParent_===pe?pe.insertBefore(ae,this.fullscreenWrapper_):this.originalParent_&&this.originalParent_.appendChild(ae),pe.removeChild(this.fullscreenWrapper_),ae}},Ft.prototype.requestPresent=function(ae){var pe=this.isPresenting,Ce=this;return ae instanceof Array||(Ee("VRDisplay.prototype.requestPresent with non-array argument","an array of VRLayers as the first argument"),ae=[ae]),new Promise(function(fe,He){if(!Ce.capabilities.canPresent){He(new Error("VRDisplay is not capable of presenting."));return}if(ae.length==0||ae.length>Ce.capabilities.maxLayers){He(new Error("Invalid number of layers."));return}var ot=ae[0];if(!ot.source){fe();return}var pt=ot.leftBounds||nn,Ut=ot.rightBounds||hn;if(pe){var Vt=Ce.layer_;Vt.source!==ot.source&&(Vt.source=ot.source);for(var gt=0;gt<4;gt++)Vt.leftBounds[gt]=pt[gt],Vt.rightBounds[gt]=Ut[gt];Ce.wrapForFullscreen(Ce.layer_.source),Ce.updatePresent_(),fe();return}if(Ce.layer_={predistorted:ot.predistorted,source:ot.source,leftBounds:pt.slice(0),rightBounds:Ut.slice(0)},Ce.waitingForPresent_=!1,Ce.layer_&&Ce.layer_.source){var Ot=Ce.wrapForFullscreen(Ce.layer_.source),Qt=function(){var Ln=De();Ce.isPresenting=Ot===Ln,Ce.isPresenting?(screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape-primary").catch(function(Xn){console.error("screen.orientation.lock() failed due to",Xn.message)}),Ce.waitingForPresent_=!1,Ce.beginPresent_(),fe()):(screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),Ce.removeFullscreenWrapper(),Ce.disableWakeLock(),Ce.endPresent_(),Ce.removeFullscreenListeners_()),Ce.fireVRDisplayPresentChange_()},_n=function(){!Ce.waitingForPresent_||(Ce.removeFullscreenWrapper(),Ce.removeFullscreenListeners_(),Ce.disableWakeLock(),Ce.waitingForPresent_=!1,Ce.isPresenting=!1,He(new Error("Unable to present.")))};Ce.addFullscreenListeners_(Ot,Qt,_n),ge(Ot)?(Ce.enableWakeLock(),Ce.waitingForPresent_=!0):(L()||M())&&(Ce.enableWakeLock(),Ce.isPresenting=!0,Ce.beginPresent_(),Ce.fireVRDisplayPresentChange_(),fe())}!Ce.waitingForPresent_&&!L()&&(me(),He(new Error("Unable to present.")))})},Ft.prototype.exitPresent=function(){var ae=this.isPresenting,pe=this;return this.isPresenting=!1,this.layer_=null,this.disableWakeLock(),new Promise(function(Ce,fe){ae?(!me()&&L()&&(pe.endPresent_(),pe.fireVRDisplayPresentChange_()),M()&&(pe.removeFullscreenWrapper(),pe.removeFullscreenListeners_(),pe.endPresent_(),pe.fireVRDisplayPresentChange_()),Ce()):fe(new Error("Was not presenting to VRDisplay."))})},Ft.prototype.getLayers=function(){return this.layer_?[this.layer_]:[]},Ft.prototype.fireVRDisplayPresentChange_=function(){var ae=new CustomEvent("vrdisplaypresentchange",{detail:{display:this}});window.dispatchEvent(ae)},Ft.prototype.fireVRDisplayConnect_=function(){var ae=new CustomEvent("vrdisplayconnect",{detail:{display:this}});window.dispatchEvent(ae)},Ft.prototype.addFullscreenListeners_=function(ae,pe,Ce){this.removeFullscreenListeners_(),this.fullscreenEventTarget_=ae,this.fullscreenChangeHandler_=pe,this.fullscreenErrorHandler_=Ce,pe&&(document.fullscreenEnabled?ae.addEventListener("fullscreenchange",pe,!1):document.webkitFullscreenEnabled?ae.addEventListener("webkitfullscreenchange",pe,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenchange",pe,!1):document.msFullscreenEnabled&&ae.addEventListener("msfullscreenchange",pe,!1)),Ce&&(document.fullscreenEnabled?ae.addEventListener("fullscreenerror",Ce,!1):document.webkitFullscreenEnabled?ae.addEventListener("webkitfullscreenerror",Ce,!1):document.mozFullScreenEnabled?document.addEventListener("mozfullscreenerror",Ce,!1):document.msFullscreenEnabled&&ae.addEventListener("msfullscreenerror",Ce,!1))},Ft.prototype.removeFullscreenListeners_=function(){if(!!this.fullscreenEventTarget_){var ae=this.fullscreenEventTarget_;if(this.fullscreenChangeHandler_){var pe=this.fullscreenChangeHandler_;ae.removeEventListener("fullscreenchange",pe,!1),ae.removeEventListener("webkitfullscreenchange",pe,!1),document.removeEventListener("mozfullscreenchange",pe,!1),ae.removeEventListener("msfullscreenchange",pe,!1)}if(this.fullscreenErrorHandler_){var Ce=this.fullscreenErrorHandler_;ae.removeEventListener("fullscreenerror",Ce,!1),ae.removeEventListener("webkitfullscreenerror",Ce,!1),document.removeEventListener("mozfullscreenerror",Ce,!1),ae.removeEventListener("msfullscreenerror",Ce,!1)}this.fullscreenEventTarget_=null,this.fullscreenChangeHandler_=null,this.fullscreenErrorHandler_=null}},Ft.prototype.enableWakeLock=function(){this.wakelock_&&this.wakelock_.enable()},Ft.prototype.disableWakeLock=function(){this.wakelock_&&this.wakelock_.disable()},Ft.prototype.beginPresent_=function(){},Ft.prototype.endPresent_=function(){},Ft.prototype.submitFrame=function(ae){},Ft.prototype.getEyeParameters=function(ae){return null};var Zt={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1},en={LEFT:"left",RIGHT:"right"};function Rn(ae){var pe=Ye({},Zt);ae=Ye(pe,ae||{}),Ft.call(this,{wakelock:ae.MOBILE_WAKE_LOCK}),this.config=ae,this.displayName="Cardboard VRDisplay",this.capabilities=new Bt({hasPosition:!1,hasOrientation:!0,hasExternalDisplay:!1,canPresent:!0,maxLayers:1}),this.stageParameters=null,this.bufferScale_=this.config.BUFFER_SCALE,this.poseSensor_=new Xe(this.config),this.distorter_=null,this.cardboardUI_=null,this.dpdb_=new Me(this.config.DPDB_URL,this.onDeviceParamsUpdated_.bind(this)),this.deviceInfo_=new Cn(this.dpdb_.getDeviceParams(),ae.ADDITIONAL_VIEWERS),this.viewerSelector_=new Wt(ae.DEFAULT_VIEWER),this.viewerSelector_.onChange(this.onViewerChanged_.bind(this)),this.deviceInfo_.setViewer(this.viewerSelector_.getCurrentViewer()),this.config.ROTATE_INSTRUCTIONS_DISABLED||(this.rotateInstructions_=new it),L()&&window.addEventListener("resize",this.onResize_.bind(this))}return Rn.prototype=Object.create(Ft.prototype),Rn.prototype._getPose=function(){return{position:null,orientation:this.poseSensor_.getOrientation(),linearVelocity:null,linearAcceleration:null,angularVelocity:null,angularAcceleration:null}},Rn.prototype._resetPose=function(){this.poseSensor_.resetPose&&this.poseSensor_.resetPose()},Rn.prototype._getFieldOfView=function(ae){var pe;if(ae==en.LEFT)pe=this.deviceInfo_.getFieldOfViewLeftEye();else if(ae==en.RIGHT)pe=this.deviceInfo_.getFieldOfViewRightEye();else return console.error("Invalid eye provided: %s",ae),null;return pe},Rn.prototype._getEyeOffset=function(ae){var pe;if(ae==en.LEFT)pe=[-this.deviceInfo_.viewer.interLensDistance*.5,0,0];else if(ae==en.RIGHT)pe=[this.deviceInfo_.viewer.interLensDistance*.5,0,0];else return console.error("Invalid eye provided: %s",ae),null;return pe},Rn.prototype.getEyeParameters=function(ae){var pe=this._getEyeOffset(ae),Ce=this._getFieldOfView(ae),fe={offset:pe,renderWidth:this.deviceInfo_.device.width*.5*this.bufferScale_,renderHeight:this.deviceInfo_.device.height*this.bufferScale_};return Object.defineProperty(fe,"fieldOfView",{enumerable:!0,get:function(){return Ee("VRFieldOfView","VRFrameData's projection matrices"),Ce}}),fe},Rn.prototype.onDeviceParamsUpdated_=function(ae){this.config.DEBUG&&console.log("DPDB reported that device params were updated."),this.deviceInfo_.updateDeviceParams(ae),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_)},Rn.prototype.updateBounds_=function(){this.layer_&&this.distorter_&&(this.layer_.leftBounds||this.layer_.rightBounds)&&this.distorter_.setTextureBounds(this.layer_.leftBounds,this.layer_.rightBounds)},Rn.prototype.beginPresent_=function(){var ae=this.layer_.source.getContext("webgl");ae||(ae=this.layer_.source.getContext("experimental-webgl")),ae||(ae=this.layer_.source.getContext("webgl2")),ae&&(this.layer_.predistorted?this.config.CARDBOARD_UI_DISABLED||(ae.canvas.width=we()*this.bufferScale_,ae.canvas.height=Ke()*this.bufferScale_,this.cardboardUI_=new wt(ae)):(this.config.CARDBOARD_UI_DISABLED||(this.cardboardUI_=new wt(ae)),this.distorter_=new ie(ae,this.cardboardUI_,this.config.BUFFER_SCALE,this.config.DIRTY_SUBMIT_FRAME_BINDINGS),this.distorter_.updateDeviceInfo(this.deviceInfo_)),this.cardboardUI_&&this.cardboardUI_.listen(function(pe){this.viewerSelector_.show(this.layer_.source.parentElement),pe.stopPropagation(),pe.preventDefault()}.bind(this),function(pe){this.exitPresent(),pe.stopPropagation(),pe.preventDefault()}.bind(this)),this.rotateInstructions_&&(K()&&vt()?this.rotateInstructions_.showTemporarily(3e3,this.layer_.source.parentElement):this.rotateInstructions_.update()),this.orientationHandler=this.onOrientationChange_.bind(this),window.addEventListener("orientationchange",this.orientationHandler),this.vrdisplaypresentchangeHandler=this.updateBounds_.bind(this),window.addEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler),this.fireVRDisplayDeviceParamsChange_())},Rn.prototype.endPresent_=function(){this.distorter_&&(this.distorter_.destroy(),this.distorter_=null),this.cardboardUI_&&(this.cardboardUI_.destroy(),this.cardboardUI_=null),this.rotateInstructions_&&this.rotateInstructions_.hide(),this.viewerSelector_.hide(),window.removeEventListener("orientationchange",this.orientationHandler),window.removeEventListener("vrdisplaypresentchange",this.vrdisplaypresentchangeHandler)},Rn.prototype.updatePresent_=function(){this.endPresent_(),this.beginPresent_()},Rn.prototype.submitFrame=function(ae){if(this.distorter_)this.updateBounds_(),this.distorter_.submitFrame();else if(this.cardboardUI_&&this.layer_){var pe=this.layer_.source.getContext("webgl");pe||(pe=this.layer_.source.getContext("experimental-webgl")),pe||(pe=this.layer_.source.getContext("webgl2"));var Ce=pe.canvas;(Ce.width!=this.lastWidth||Ce.height!=this.lastHeight)&&this.cardboardUI_.onResize(),this.lastWidth=Ce.width,this.lastHeight=Ce.height,this.cardboardUI_.render()}},Rn.prototype.onOrientationChange_=function(ae){this.viewerSelector_.hide(),this.rotateInstructions_&&this.rotateInstructions_.update(),this.onResize_()},Rn.prototype.onResize_=function(ae){if(this.layer_){var pe=this.layer_.source.getContext("webgl");pe||(pe=this.layer_.source.getContext("experimental-webgl")),pe||(pe=this.layer_.source.getContext("webgl2"));var Ce=["position: absolute","top: 0","left: 0","width: 100vw","height: 100vh","border: 0","margin: 0","padding: 0px","box-sizing: content-box"];pe.canvas.setAttribute("style",Ce.join("; ")+";"),Pe(pe.canvas)}},Rn.prototype.onViewerChanged_=function(ae){this.deviceInfo_.setViewer(ae),this.distorter_&&this.distorter_.updateDeviceInfo(this.deviceInfo_),this.fireVRDisplayDeviceParamsChange_()},Rn.prototype.fireVRDisplayDeviceParamsChange_=function(){var ae=new CustomEvent("vrdisplaydeviceparamschange",{detail:{vrdisplay:this,deviceInfo:this.deviceInfo_}});window.dispatchEvent(ae)},Rn.VRFrameData=yt,Rn.VRDisplay=Ft,Rn})}),g=u(y),_="0.10.12",x={ADDITIONAL_VIEWERS:[],DEFAULT_VIEWER:"",PROVIDE_MOBILE_VRDISPLAY:!0,MOBILE_WAKE_LOCK:!0,DEBUG:!1,DPDB_URL:"https://dpdb.webvr.rocks/dpdb.json",K_FILTER:.98,PREDICTION_TIME_S:.04,CARDBOARD_UI_DISABLED:!1,ROTATE_INSTRUCTIONS_DISABLED:!1,YAW_ONLY:!1,BUFFER_SCALE:.5,DIRTY_SUBMIT_FRAME_BINDINGS:!1};function b(D){this.config=m(m({},x),D),this.polyfillDisplays=[],this.enabled=!1,this.hasNative="getVRDisplays"in navigator,this.native={},this.native.getVRDisplays=navigator.getVRDisplays,this.native.VRFrameData=window.VRFrameData,this.native.VRDisplay=window.VRDisplay,(!this.hasNative||this.config.PROVIDE_MOBILE_VRDISPLAY&&f())&&(this.enable(),this.getVRDisplays().then(function(F){F&&F[0]&&F[0].fireVRDisplayConnect_&&F[0].fireVRDisplayConnect_()}))}b.prototype.getPolyfillDisplays=function(){if(this._polyfillDisplaysPopulated)return this.polyfillDisplays;if(f()){var D=new g({ADDITIONAL_VIEWERS:this.config.ADDITIONAL_VIEWERS,DEFAULT_VIEWER:this.config.DEFAULT_VIEWER,MOBILE_WAKE_LOCK:this.config.MOBILE_WAKE_LOCK,DEBUG:this.config.DEBUG,DPDB_URL:this.config.DPDB_URL,CARDBOARD_UI_DISABLED:this.config.CARDBOARD_UI_DISABLED,K_FILTER:this.config.K_FILTER,PREDICTION_TIME_S:this.config.PREDICTION_TIME_S,ROTATE_INSTRUCTIONS_DISABLED:this.config.ROTATE_INSTRUCTIONS_DISABLED,YAW_ONLY:this.config.YAW_ONLY,BUFFER_SCALE:this.config.BUFFER_SCALE,DIRTY_SUBMIT_FRAME_BINDINGS:this.config.DIRTY_SUBMIT_FRAME_BINDINGS});this.polyfillDisplays.push(D)}return this._polyfillDisplaysPopulated=!0,this.polyfillDisplays},b.prototype.enable=function(){if(this.enabled=!0,this.hasNative&&this.native.VRFrameData){var D=this.native.VRFrameData,F=new this.native.VRFrameData,k=this.native.VRDisplay.prototype.getFrameData;window.VRDisplay.prototype.getFrameData=function(W){if(W instanceof D){k.call(this,W);return}k.call(this,F),W.pose=F.pose,p(F.leftProjectionMatrix,W.leftProjectionMatrix),p(F.rightProjectionMatrix,W.rightProjectionMatrix),p(F.leftViewMatrix,W.leftViewMatrix),p(F.rightViewMatrix,W.rightViewMatrix)}}navigator.getVRDisplays=this.getVRDisplays.bind(this),window.VRDisplay=g.VRDisplay,window.VRFrameData=g.VRFrameData},b.prototype.getVRDisplays=function(){var D=this;return this.config,this.hasNative?this.native.getVRDisplays.call(navigator).then(function(F){return F.length>0?F:D.getPolyfillDisplays()}):Promise.resolve(this.getPolyfillDisplays())},b.version=_,b.VRFrameData=g.VRFrameData,b.VRDisplay=g.VRDisplay;var E=Object.freeze({default:b}),T=E&&b||E;typeof c!="undefined"&&c.window&&(c.document||(c.document=c.window.document),c.navigator||(c.navigator=c.window.navigator));var P=T;return P})}).call(this,typeof Tr!="undefined"?Tr:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],70:[function(n,i,o){var s=/\n/,c=`
`,u=/\s/;i.exports=function(g,_){var x=i.exports.lines(g,_);return x.map(function(b){return g.substring(b.start,b.end)}).join(`
`)},i.exports.lines=function(_,x){if(x=x||{},x.width===0&&x.mode!=="nowrap")return[];_=_||"";var b=typeof x.width=="number"?x.width:Number.MAX_VALUE,E=Math.max(0,x.start||0),T=typeof x.end=="number"?x.end:_.length,P=x.mode,D=x.measure||y;return P==="pre"?p(D,_,E,T,b):m(D,_,E,T,b,P)};function h(g,_,x,b){var E=g.indexOf(_,x);return E===-1||E>b?b:E}function f(g){return u.test(g)}function p(g,_,x,b,E){for(var T=[],P=x,D=x;D<b&&D<_.length;D++){var F=_.charAt(D),k=s.test(F);if(k||D===b-1){var W=k?D:D+1,j=g(_,P,W,E);T.push(j),P=D+1}}return T}function m(g,_,x,b,E,T){var P=[],D=E;for(T==="nowrap"&&(D=Number.MAX_VALUE);x<b&&x<_.length;){for(var F=h(_,c,x,b);x<F&&f(_.charAt(x));)x++;var k=g(_,x,F,D),W=x+(k.end-k.start),j=W+c.length;if(W<F){for(;W>x&&!f(_.charAt(W));)W--;if(W===x)j>x+c.length&&j--,W=j;else for(j=W;W>x&&f(_.charAt(W-c.length));)W--}if(W>=x){var J=g(_,x,W,D);P.push(J)}x=j}return P}function y(g,_,x,b){var E=Math.min(b,x-_);return{start:_,end:_+E}}},{}],71:[function(n,i,o){var s=n("global/window"),c=n("is-function"),u=n("parse-headers"),h=n("xtend");i.exports=y,i.exports.default=y,y.XMLHttpRequest=s.XMLHttpRequest||x,y.XDomainRequest="withCredentials"in new y.XMLHttpRequest?y.XMLHttpRequest:s.XDomainRequest,f(["get","put","post","patch","head","delete"],function(b){y[b==="delete"?"del":b]=function(E,T,P){return T=m(E,T,P),T.method=b.toUpperCase(),g(T)}});function f(b,E){for(var T=0;T<b.length;T++)E(b[T])}function p(b){for(var E in b)if(b.hasOwnProperty(E))return!1;return!0}function m(b,E,T){var P=b;return c(E)?(T=E,typeof b=="string"&&(P={uri:b})):P=h(E,{uri:b}),P.callback=T,P}function y(b,E,T){return E=m(b,E,T),g(E)}function g(b){if(typeof b.callback=="undefined")throw new Error("callback argument missing");var E=!1,T=function(Q,G,K){E||(E=!0,b.callback(Q,G,K))};function P(){W.readyState===4&&setTimeout(k,0)}function D(){var ee=void 0;if(W.response?ee=W.response:ee=W.responseText||_(W),I)try{ee=JSON.parse(ee)}catch{}return ee}function F(ee){return clearTimeout(U),ee instanceof Error||(ee=new Error(""+(ee||"Unknown XMLHttpRequest Error"))),ee.statusCode=0,T(ee,$)}function k(){if(!J){var ee;clearTimeout(U),b.useXDR&&W.status===void 0?ee=200:ee=W.status===1223?204:W.status;var Q=$,G=null;return ee!==0?(Q={body:D(),statusCode:ee,method:te,headers:{},url:de,rawRequest:W},W.getAllResponseHeaders&&(Q.headers=u(W.getAllResponseHeaders()))):G=new Error("Internal XMLHttpRequest Error"),T(G,Q,Q.body)}}var W=b.xhr||null;W||(b.cors||b.useXDR?W=new y.XDomainRequest:W=new y.XMLHttpRequest);var j,J,de=W.url=b.uri||b.url,te=W.method=b.method||"GET",N=b.body||b.data,L=W.headers=b.headers||{},M=!!b.sync,I=!1,U,$={body:void 0,headers:{},statusCode:0,method:te,url:de,rawRequest:W};if("json"in b&&b.json!==!1&&(I=!0,L.accept||L.Accept||(L.Accept="application/json"),te!=="GET"&&te!=="HEAD"&&(L["content-type"]||L["Content-Type"]||(L["Content-Type"]="application/json"),N=JSON.stringify(b.json===!0?N:b.json))),W.onreadystatechange=P,W.onload=k,W.onerror=F,W.onprogress=function(){},W.onabort=function(){J=!0},W.ontimeout=F,W.open(te,de,!M,b.username,b.password),M||(W.withCredentials=!!b.withCredentials),!M&&b.timeout>0&&(U=setTimeout(function(){if(!J){J=!0,W.abort("timeout");var ee=new Error("XMLHttpRequest timeout");ee.code="ETIMEDOUT",F(ee)}},b.timeout)),W.setRequestHeader)for(j in L)L.hasOwnProperty(j)&&W.setRequestHeader(j,L[j]);else if(b.headers&&!p(b.headers))throw new Error("Headers cannot be set on an XDomainRequest object");return"responseType"in b&&(W.responseType=b.responseType),"beforeSend"in b&&typeof b.beforeSend=="function"&&b.beforeSend(W),W.send(N||null),W}function _(b){try{if(b.responseType==="document")return b.responseXML;var E=b.responseXML&&b.responseXML.documentElement.nodeName==="parsererror";if(b.responseType===""&&!E)return b.responseXML}catch{}return null}function x(){}},{"global/window":27,"is-function":33,"parse-headers":47,xtend:73}],72:[function(n,i,o){i.exports=function(){return typeof self.DOMParser!="undefined"?function(c){var u=new self.DOMParser;return u.parseFromString(c,"application/xml")}:typeof self.ActiveXObject!="undefined"&&new self.ActiveXObject("Microsoft.XMLDOM")?function(c){var u=new self.ActiveXObject("Microsoft.XMLDOM");return u.async="false",u.loadXML(c),u}:function(c){var u=document.createElement("div");return u.innerHTML=c,u}}()},{}],73:[function(n,i,o){i.exports=c;var s=Object.prototype.hasOwnProperty;function c(){for(var u={},h=0;h<arguments.length;h++){var f=arguments[h];for(var p in f)s.call(f,p)&&(u[p]=f[p])}return u}},{}],74:[function(n,i,o){i.exports={name:"aframe",version:"1.3.0",description:"A web framework for building virtual reality experiences.",homepage:"https://aframe.io/",main:"dist/aframe-master.js",scripts:{browserify:"browserify src/index.js -s 'AFRAME' -p browserify-derequire",build:"shx mkdir -p build/ && npm run browserify -- --debug -t [ envify --INSPECTOR_VERSION dev ] -o build/aframe.js",codecov:"codecov",dev:"npm run build && cross-env INSPECTOR_VERSION=dev node ./scripts/budo -t envify",dist:"node scripts/updateVersionLog.js && npm run dist:min && npm run dist:max","dist:max":"npm run browserify -s -- --debug | exorcist dist/aframe-master.js.map > dist/aframe-master.js","dist:min":"npm run browserify -s -- --debug -p [ minifyify --map aframe-master.min.js.map --output dist/aframe-master.min.js.map ] -o dist/aframe-master.min.js",docs:"markserv --dir docs --port 9001",preghpages:"node ./scripts/preghpages.js",ghpages:"ghpages -p gh-pages/",lint:"semistandard -v | snazzy","lint:fix":"semistandard --fix",precommit:"npm run lint",prepush:"node scripts/testOnlyCheck.js",prerelease:"node scripts/release.js 1.1.0 1.2.0",start:"npm run dev","start:https":"cross-env SSL=true npm run dev",test:"karma start ./tests/karma.conf.js","test:docs":"node scripts/docsLint.js","test:firefox":"npm test -- --browsers Firefox","test:chrome":"npm test -- --browsers Chrome","test:nobrowser":"NO_BROWSER=true npm test","test:node":"mocha --ui tdd tests/node"},repository:"aframevr/aframe",license:"MIT",files:["dist/*","docs/**/*","src/**/*","vendor/**/*"],dependencies:{"custom-event-polyfill":"^1.0.6",debug:"ngokevin/debug#noTimestamp","deep-assign":"^2.0.0","document-register-element":"dmarcos/document-register-element#8ccc532b7f3744be954574caf3072a5fd260ca90","load-bmfont":"^1.2.3","object-assign":"^4.0.1",present:"0.0.6","promise-polyfill":"^3.1.0","super-animejs":"^3.1.0","super-three":"^0.137.0","three-bmfont-text":"dmarcos/three-bmfont-text#21d017046216e318362c48abd1a48bddfb6e0733","webvr-polyfill":"^0.10.12"},devDependencies:{browserify:"^13.1.0","browserify-css":"^0.8.4","browserify-derequire":"^0.9.4","browserify-istanbul":"^2.0.0",budo:"^9.2.0",chai:"^3.5.0","chai-shallow-deep-equal":"^1.4.0",chalk:"^1.1.3",codecov:"^1.0.1","cross-env":"^5.0.1",envify:"^3.4.1",exorcist:"^0.4.0",ghpages:"0.0.8","git-rev":"^0.2.1",glob:"^7.1.1",husky:"^0.11.7",istanbul:"^0.4.5",jsdom:"^9.11.0",karma:"1.4.1","karma-browserify":"^5.1.0","karma-chai-shallow-deep-equal":"0.0.4","karma-chrome-launcher":"^2.0.0","karma-coverage":"^1.1.1","karma-env-preprocessor":"^0.1.1","karma-firefox-launcher":"^1.2.0","karma-mocha":"^1.1.1","karma-mocha-reporter":"^2.1.0","karma-sinon-chai":"1.2.4",lolex:"^1.5.1",markserv:"github:sukima/markserv#feature/fix-broken-websoketio-link",minifyify:"^7.3.3",mocha:"^3.0.2","mozilla-download":"^1.1.1","replace-in-file":"^2.5.3",semistandard:"^9.0.0",shelljs:"^0.7.7",shx:"^0.2.2",sinon:"^1.17.5","sinon-chai":"2.8.0",snazzy:"^5.0.0","too-wordy":"ngokevin/too-wordy",uglifyjs:"^2.4.10","write-good":"^0.9.1"},link:!0,browserify:{transform:["browserify-css","envify"]},semistandard:{ignore:["build/**","dist/**","examples/**/shaders/*.js","**/vendor/**"]},keywords:["3d","aframe","cardboard","components","oculus","three","three.js","rift","vive","vr","web-components","webvr"],"browserify-css":{minify:!0},engines:{node:">= 4.6.0",npm:">= 2.15.9"}}},{}],75:[function(n,i,o){var s=n("super-animejs"),c=n("../core/component").components,u=n("../core/component").registerComponent,h=n("../lib/three"),f=n("../utils"),p=new h.Color,m=new h.Color,y=f.entity.getComponentProperty,g=f.entity.setComponentProperty,_={},x="color",b="position",E="rotation",T="scale",P="components",D="object3D";i.exports.Component=u("animation",{schema:{autoplay:{default:!0},delay:{default:0},dir:{default:""},dur:{default:1e3},easing:{default:"easeInQuad"},elasticity:{default:400},enabled:{default:!0},from:{default:""},loop:{default:0,parse:function(L){return L===!0||L==="true"?!0:L===!1||L==="false"?!1:parseInt(L,10)}},property:{default:""},startEvents:{type:"array"},pauseEvents:{type:"array"},resumeEvents:{type:"array"},round:{default:!1},to:{default:""},type:{default:""},isRawProperty:{default:!1}},multiple:!0,init:function(){var L=this;this.eventDetail={name:this.attrName},this.time=0,this.animation=null,this.animationIsPlaying=!1,this.onStartEvent=this.onStartEvent.bind(this),this.beginAnimation=this.beginAnimation.bind(this),this.pauseAnimation=this.pauseAnimation.bind(this),this.resumeAnimation=this.resumeAnimation.bind(this),this.fromColor={},this.toColor={},this.targets={},this.targetsArray=[],this.updateConfigForDefault=this.updateConfigForDefault.bind(this),this.updateConfigForRawColor=this.updateConfigForRawColor.bind(this),this.config={complete:function(){L.animationIsPlaying=!1,L.el.emit("animationcomplete",L.eventDetail,!1),L.id&&L.el.emit("animationcomplete__"+L.id,L.eventDetail,!1)}}},update:function(L){var M=this.config,I=this.data;this.animationIsPlaying=!1,this.data.enabled&&(!I.property||(M.autoplay=!1,M.direction=I.dir,M.duration=I.dur,M.easing=I.easing,M.elasticity=I.elasticity,M.loop=I.loop,M.round=I.round,this.createAndStartAnimation()))},tick:function(L,M){!this.animationIsPlaying||(this.time+=M,this.animation.tick(this.time))},remove:function(){this.pauseAnimation(),this.removeEventListeners()},pause:function(){this.paused=!0,this.pausedWasPlaying=this.animationIsPlaying,this.pauseAnimation(),this.removeEventListeners()},play:function(){!this.paused||(this.paused=!1,this.addEventListeners(),this.pausedWasPlaying&&(this.resumeAnimation(),this.pausedWasPlaying=!1))},createAndStartAnimation:function(){var L=this.data;if(this.updateConfig(),this.animationIsPlaying=!1,this.animation=s(this.config),this.animation.began=!0,this.removeEventListeners(),this.addEventListeners(),!(!L.autoplay||L.startEvents&&L.startEvents.length)){if(L.delay){setTimeout(this.beginAnimation,L.delay);return}this.beginAnimation()}},beginAnimation:function(){this.updateConfig(),this.animation.began=!0,this.time=0,this.animationIsPlaying=!0,this.stopRelatedAnimations(),this.el.emit("animationbegin",this.eventDetail,!1)},pauseAnimation:function(){this.animationIsPlaying=!1},resumeAnimation:function(){this.animationIsPlaying=!0},onStartEvent:function(){if(!!this.data.enabled){if(this.updateConfig(),this.animation&&this.animation.pause(),this.animation=s(this.config),this.data.delay){setTimeout(this.beginAnimation,this.data.delay);return}this.beginAnimation()}},updateConfigForRawColor:function(){var L=this.config,M=this.data,I=this.el,U,$,ee;if(!this.waitComponentInitRawProperty(this.updateConfigForRawColor)){U=M.from===""?J(I,M.property):M.from,ee=M.to,this.setColorConfig(U,ee),U=this.fromColor,ee=this.toColor,this.targetsArray.length=0,this.targetsArray.push(U),L.targets=this.targetsArray;for($ in ee)L[$]=ee[$];L.update=function(){var Q={};return function(G){var K;K=G.animatables[0].target,!(K.r===Q.r&&K.g===Q.g&&K.b===Q.b)&&de(I,M.property,K,M.type)}}()}},updateConfigForDefault:function(){var L=this.config,M=this.data,I=this.el,U,$,ee,Q;this.waitComponentInitRawProperty(this.updateConfigForDefault)||(M.from===""?U=N(M)?J(I,M.property):y(I,M.property):U=M.from,Q=M.to,ee=!isNaN(U||Q),ee?(U=parseFloat(U),Q=parseFloat(Q)):(U=U&&U.toString(),Q=Q&&Q.toString()),$=M.to==="true"||M.to==="false"||M.to===!0||M.to===!1,$&&(U=M.from==="true"||M.from===!0?1:0,Q=M.to==="true"||M.to===!0?1:0),this.targets.aframeProperty=U,L.targets=this.targets,L.aframeProperty=Q,L.update=function(){var G;return function(K){var Y;Y=K.animatables[0].target.aframeProperty,Y!==G&&(G=Y,$&&(Y=Y>=1),N(M)?de(I,M.property,Y,M.type):g(I,M.property,Y))}}())},updateConfigForVector:function(){var L=this.config,M=this.data,I=this.el,U,$,ee;$=M.from!==""?f.coordinates.parse(M.from):y(I,M.property),ee=f.coordinates.parse(M.to),M.property===E&&(k($),k(ee)),this.targetsArray.length=0,this.targetsArray.push($),L.targets=this.targetsArray;for(U in ee)L[U]=ee[U];if(M.property===b||M.property===E||M.property===T){L.update=function(){var Q={};return function(G){var K=G.animatables[0].target;M.property===T&&(K.x=Math.max(1e-4,K.x),K.y=Math.max(1e-4,K.y),K.z=Math.max(1e-4,K.z)),!(K.x===Q.x&&K.y===Q.y&&K.z===Q.z)&&(Q.x=K.x,Q.y=K.y,Q.z=K.z,I.object3D[M.property].set(K.x,K.y,K.z))}}();return}L.update=function(){var Q={};return function(G){var K=G.animatables[0].target;K.x===Q.x&&K.y===Q.y&&K.z===Q.z||(Q.x=K.x,Q.y=K.y,Q.z=K.z,g(I,M.property,K))}}()},updateConfig:function(){var L;L=F(this.el,this.data.property),N(this.data)&&this.data.type===x?this.updateConfigForRawColor():L==="vec2"||L==="vec3"||L==="vec4"?this.updateConfigForVector():this.updateConfigForDefault()},waitComponentInitRawProperty:function(L){var M,I=this.data,U=this.el,$=this;return I.from!==""||!I.property.startsWith(P)||(M=te(I.property)[1],U.components[M])?!1:(U.addEventListener("componentinitialized",function ee(Q){Q.detail.name===M&&(L(),$.animation=s($.config),U.removeEventListener("componentinitialized",ee))}),!0)},stopRelatedAnimations:function(){var L,M;for(M in this.el.components)L=this.el.components[M],M!==this.attrName&&L.name==="animation"&&(!L.animationIsPlaying||L.data.property===this.data.property&&(L.animationIsPlaying=!1))},addEventListeners:function(){var L=this.data,M=this.el;W(M,L.startEvents,this.onStartEvent),W(M,L.pauseEvents,this.pauseAnimation),W(M,L.resumeEvents,this.resumeAnimation)},removeEventListeners:function(){var L=this.data,M=this.el;j(M,L.startEvents,this.onStartEvent),j(M,L.pauseEvents,this.pauseAnimation),j(M,L.resumeEvents,this.resumeAnimation)},setColorConfig:function(L,M){p.set(L),m.set(M),L=this.fromColor,M=this.toColor,L.r=p.r,L.g=p.g,L.b=p.b,M.r=m.r,M.g=m.g,M.b=m.b}});function F(L,M){var I,U,$,ee;return $=M.split("."),U=$[0],ee=$[1],I=L.components[U]||c[U],!I||ee&&!I.schema[ee]?null:ee?I.schema[ee].type:I.schema.type}function k(L){L.x=h.Math.degToRad(L.x),L.y=h.Math.degToRad(L.y),L.z=h.Math.degToRad(L.z)}function W(L,M,I){var U;for(U=0;U<M.length;U++)L.addEventListener(M[U],I)}function j(L,M,I){var U;for(U=0;U<M.length;U++)L.removeEventListener(M[U],I)}function J(L,M){var I,U,$;for(U=te(M),$=L,I=0;I<U.length;I++)$=$[U[I]];if($===void 0)throw console.log(L),new Error("[animation] property ("+M+") could not be found");return $}function de(L,M,I,U){var $,ee,Q,G;for(M.startsWith("object3D.rotation")&&(I=h.Math.degToRad(I)),ee=te(M),G=L,$=0;$<ee.length-1;$++)G=G[ee[$]];if(Q=ee[ee.length-1],U===x){"r"in G[Q]?(G[Q].r=I.r,G[Q].g=I.g,G[Q].b=I.b):(G[Q].x=I.r,G[Q].y=I.g,G[Q].z=I.b);return}G[Q]=I}function te(L){return L in _||(_[L]=L.split(".")),_[L]}function N(L){return L.isRawProperty||L.property.startsWith(P)||L.property.startsWith(D)}},{"../core/component":136,"../lib/three":184,"../utils":212,"super-animejs":56}],76:[function(n,i,o){var s=n("../core/component").registerComponent,c=n("../lib/three");i.exports.Component=s("camera",{schema:{active:{default:!0},far:{default:1e4},fov:{default:80,min:0},near:{default:.005,min:0},spectator:{default:!1},zoom:{default:1,min:0}},init:function(){var u,h=this.el;u=this.camera=new c.PerspectiveCamera,h.setObject3D("camera",u)},update:function(u){var h=this.data,f=this.camera;f.aspect=h.aspect||window.innerWidth/window.innerHeight,f.far=h.far,f.fov=h.fov,f.near=h.near,f.zoom=h.zoom,f.updateProjectionMatrix(),this.updateActiveCamera(u),this.updateSpectatorCamera(u)},updateActiveCamera:function(u){var h=this.data,f=this.el,p=this.system;u&&u.active===h.active||h.spectator||(h.active&&p.activeCameraEl!==f?p.setActiveCamera(f):!h.active&&p.activeCameraEl===f&&p.disableActiveCamera())},updateSpectatorCamera:function(u){var h=this.data,f=this.el,p=this.system;u&&u.spectator===h.spectator||(h.spectator&&p.spectatorCameraEl!==f?p.setSpectatorCamera(f):!h.spectator&&p.spectatorCameraEl===f&&p.disableSpectatorCamera())},remove:function(){this.el.removeObject3D("camera")}})},{"../core/component":136,"../lib/three":184}],77:[function(n,i,o){var s=n("../core/component").registerComponent,c=n("../utils/"),u=c.bind,h={CLICK:"click",FUSING:"fusing",MOUSEENTER:"mouseenter",MOUSEDOWN:"mousedown",MOUSELEAVE:"mouseleave",MOUSEUP:"mouseup"},f={FUSING:"cursor-fusing",HOVERING:"cursor-hovering",HOVERED:"cursor-hovered"},p={DOWN:["mousedown","touchstart"],UP:["mouseup","touchend"]},m={DOWN:["selectstart"],UP:["selectend"]},y="a-mouse-cursor-hover";i.exports.Component=s("cursor",{dependencies:["raycaster"],schema:{downEvents:{default:[]},fuse:{default:c.device.isMobile()},fuseTimeout:{default:1500,min:0},mouseCursorStylesEnabled:{default:!0},upEvents:{default:[]},rayOrigin:{default:"entity",oneOf:["mouse","entity"]}},init:function(){var g=this;this.fuseTimeout=void 0,this.cursorDownEl=null,this.intersectedEl=null,this.canvasBounds=document.body.getBoundingClientRect(),this.isCursorDown=!1,this.updateCanvasBounds=c.debounce(function(){g.canvasBounds=g.el.sceneEl.canvas.getBoundingClientRect()},500),this.eventDetail={},this.intersectedEventDetail={cursorEl:this.el},this.onCursorDown=u(this.onCursorDown,this),this.onCursorUp=u(this.onCursorUp,this),this.onIntersection=u(this.onIntersection,this),this.onIntersectionCleared=u(this.onIntersectionCleared,this),this.onMouseMove=u(this.onMouseMove,this),this.onEnterVR=u(this.onEnterVR,this)},update:function(g){this.data.rayOrigin!==g.rayOrigin&&this.updateMouseEventListeners()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){var g=this.el;g.removeState(f.HOVERING),g.removeState(f.FUSING),clearTimeout(this.fuseTimeout),this.intersectedEl&&this.intersectedEl.removeState(f.HOVERED),this.removeEventListeners()},addEventListeners:function(){var g,_=this.data,x=this.el,b=this;function E(){g=x.sceneEl.canvas,!(_.downEvents.length||_.upEvents.length)&&(p.DOWN.forEach(function(T){g.addEventListener(T,b.onCursorDown)}),p.UP.forEach(function(T){g.addEventListener(T,b.onCursorUp)}))}g=x.sceneEl.canvas,g?E():x.sceneEl.addEventListener("render-target-loaded",E),_.downEvents.forEach(function(T){x.addEventListener(T,b.onCursorDown)}),_.upEvents.forEach(function(T){x.addEventListener(T,b.onCursorUp)}),x.addEventListener("raycaster-intersection",this.onIntersection),x.addEventListener("raycaster-closest-entity-changed",this.onIntersection),x.addEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),x.sceneEl.addEventListener("rendererresize",this.updateCanvasBounds),x.sceneEl.addEventListener("enter-vr",this.onEnterVR),window.addEventListener("resize",this.updateCanvasBounds),window.addEventListener("scroll",this.updateCanvasBounds),this.updateMouseEventListeners()},removeEventListeners:function(){var g,_=this.data,x=this.el,b=this;g=x.sceneEl.canvas,g&&!_.downEvents.length&&!_.upEvents.length&&(p.DOWN.forEach(function(E){g.removeEventListener(E,b.onCursorDown)}),p.UP.forEach(function(E){g.removeEventListener(E,b.onCursorUp)})),_.downEvents.forEach(function(E){x.removeEventListener(E,b.onCursorDown)}),_.upEvents.forEach(function(E){x.removeEventListener(E,b.onCursorUp)}),x.removeEventListener("raycaster-intersection",this.onIntersection),x.removeEventListener("raycaster-intersection-cleared",this.onIntersectionCleared),g.removeEventListener("mousemove",this.onMouseMove),g.removeEventListener("touchstart",this.onMouseMove),g.removeEventListener("touchmove",this.onMouseMove),x.sceneEl.removeEventListener("rendererresize",this.updateCanvasBounds),x.sceneEl.removeEventListener("enter-vr",this.onEnterVR),window.removeEventListener("resize",this.updateCanvasBounds),window.removeEventListener("scroll",this.updateCanvasBounds)},updateMouseEventListeners:function(){var g,_=this.el;g=_.sceneEl.canvas,g.removeEventListener("mousemove",this.onMouseMove),g.removeEventListener("touchmove",this.onMouseMove),_.setAttribute("raycaster","useWorldCoordinates",!1),this.data.rayOrigin==="mouse"&&(g.addEventListener("mousemove",this.onMouseMove,!1),g.addEventListener("touchmove",this.onMouseMove,!1),_.setAttribute("raycaster","useWorldCoordinates",!0),this.updateCanvasBounds())},onMouseMove:function(){var g=new THREE.Vector3,_=new THREE.Vector2,x=new THREE.Vector3,b={origin:x,direction:g};return function(E){var T=this.canvasBounds,P=this.el.sceneEl.camera,D,F,k;P.parent.updateMatrixWorld(),E.type==="touchmove"||E.type==="touchstart"?F=E.touches.item(0):F=E,D=F.clientX-T.left,k=F.clientY-T.top,_.x=D/T.width*2-1,_.y=-(k/T.height)*2+1,P&&P.isPerspectiveCamera?(x.setFromMatrixPosition(P.matrixWorld),g.set(_.x,_.y,.5).unproject(P).sub(x).normalize()):P&&P.isOrthographicCamera?(x.set(_.x,_.y,(P.near+P.far)/(P.near-P.far)).unproject(P),g.set(0,0,-1).transformDirection(P.matrixWorld)):console.error("AFRAME.Raycaster: Unsupported camera type: "+P.type),this.el.setAttribute("raycaster",b),E.type==="touchmove"&&E.preventDefault()}}(),onCursorDown:function(g){this.isCursorDown=!0,this.data.rayOrigin==="mouse"&&g.type==="touchstart"&&(this.onMouseMove(g),this.el.components.raycaster.checkIntersections(),g.preventDefault()),this.twoWayEmit(h.MOUSEDOWN),this.cursorDownEl=this.intersectedEl},onCursorUp:function(g){if(!!this.isCursorDown){this.isCursorDown=!1;var _=this.data;this.twoWayEmit(h.MOUSEUP),this.cursorDownEl&&this.cursorDownEl!==this.intersectedEl&&(this.intersectedEventDetail.intersection=null,this.cursorDownEl.emit(h.MOUSEUP,this.intersectedEventDetail)),(!_.fuse||_.rayOrigin==="mouse")&&this.intersectedEl&&this.cursorDownEl===this.intersectedEl&&this.twoWayEmit(h.CLICK),this.cursorDownEl=null,g.type==="touchend"&&g.preventDefault()}},onIntersection:function(g){var _,x=this.el,b,E,T;b=g.detail.els[0]===x?1:0,T=g.detail.intersections[b],E=g.detail.els[b],!!E&&this.intersectedEl!==E&&(this.intersectedEl&&(_=this.el.components.raycaster.getIntersection(this.intersectedEl),_&&_.distance<=T.distance)||(this.clearCurrentIntersection(!0),this.setIntersection(E,T)))},onIntersectionCleared:function(g){var _=g.detail.clearedEls;_.indexOf(this.intersectedEl)!==-1&&this.clearCurrentIntersection()},onEnterVR:function(){this.clearCurrentIntersection(!0);var g=this.el.sceneEl.xrSession,_=this;!g||this.data.rayOrigin!=="mouse"&&(m.DOWN.forEach(function(x){g.addEventListener(x,_.onCursorDown)}),m.UP.forEach(function(x){g.addEventListener(x,_.onCursorUp)}))},setIntersection:function(g,_){var x=this.el,b=this.data,E=this;this.intersectedEl!==g&&(this.intersectedEl=g,x.addState(f.HOVERING),g.addState(f.HOVERED),this.twoWayEmit(h.MOUSEENTER),this.data.mouseCursorStylesEnabled&&this.data.rayOrigin==="mouse"&&this.el.sceneEl.canvas.classList.add(y),!(b.fuseTimeout===0||!b.fuse)&&(x.addState(f.FUSING),this.twoWayEmit(h.FUSING),this.fuseTimeout=setTimeout(function(){x.removeState(f.FUSING),E.twoWayEmit(h.CLICK)},b.fuseTimeout)))},clearCurrentIntersection:function(g){var _,x,b,E=this.el;!this.intersectedEl||(this.intersectedEl.removeState(f.HOVERED),E.removeState(f.HOVERING),E.removeState(f.FUSING),this.twoWayEmit(h.MOUSELEAVE),this.data.mouseCursorStylesEnabled&&this.data.rayOrigin==="mouse"&&this.el.sceneEl.canvas.classList.remove(y),this.intersectedEl=null,clearTimeout(this.fuseTimeout),g!==!0&&(b=this.el.components.raycaster.intersections,b.length!==0&&(_=b[0].object.el===E?1:0,x=b[_],x&&this.setIntersection(x.object.el,x))))},twoWayEmit:function(g){var _=this.el,x=this.intersectedEl,b;b=this.el.components.raycaster.getIntersection(x),this.eventDetail.intersectedEl=x,this.eventDetail.intersection=b,_.emit(g,this.eventDetail),x&&(this.intersectedEventDetail.intersection=b,x.emit(g,this.intersectedEventDetail))}})},{"../core/component":136,"../utils/":212}],78:[function(n,i,o){var s=n("../core/component").registerComponent,c=n("../utils/bind"),u=n("../utils/tracked-controls"),h=u.checkControllerPresentAndSetup,f=u.emitIfAxesChanged,p=u.onButtonEvent,m="https://cdn.aframe.io/controllers/google/",y=m+"vr_controller_daydream.obj",g=m+"vr_controller_daydream.mtl",_=n("../utils/").device.isWebXRAvailable,x="google-daydream",b="Daydream Controller",E=_?x:b,T={axes:{trackpad:[0,1]},buttons:["trackpad","menu","system"]},P={axes:{touchpad:[0,1]},buttons:["none","none","touchpad","menu","system"]},D=_?P:T;i.exports.Component=s("daydream-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#000000"},buttonTouchedColor:{type:"color",default:"#777777"},buttonHighlightColor:{type:"color",default:"#FFFFFF"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:D,bindMethods:function(){this.onModelLoaded=c(this.onModelLoaded,this),this.onControllersUpdate=c(this.onControllersUpdate,this),this.checkIfControllerPresent=c(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=c(this.removeControllersUpdateListener,this),this.onAxisMoved=c(this.onAxisMoved,this)},init:function(){var F=this;this.onButtonChanged=c(this.onButtonChanged,this),this.onButtonDown=function(k){p(k.detail.id,"down",F)},this.onButtonUp=function(k){p(k.detail.id,"up",F)},this.onButtonTouchStart=function(k){p(k.detail.id,"touchstart",F)},this.onButtonTouchEnd=function(k){p(k.detail.id,"touchend",F)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var F=this.el;F.addEventListener("buttonchanged",this.onButtonChanged),F.addEventListener("buttondown",this.onButtonDown),F.addEventListener("buttonup",this.onButtonUp),F.addEventListener("touchstart",this.onButtonTouchStart),F.addEventListener("touchend",this.onButtonTouchEnd),F.addEventListener("model-loaded",this.onModelLoaded),F.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var F=this.el;F.removeEventListener("buttonchanged",this.onButtonChanged),F.removeEventListener("buttondown",this.onButtonDown),F.removeEventListener("buttonup",this.onButtonUp),F.removeEventListener("touchstart",this.onButtonTouchStart),F.removeEventListener("touchend",this.onButtonTouchEnd),F.removeEventListener("model-loaded",this.onModelLoaded),F.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){h(this,E,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var F=this.el,k=this.data;F.setAttribute("tracked-controls",{armModel:k.armModel,hand:k.hand,idPrefix:E,id:E,orientationOffset:k.orientationOffset}),this.data.model&&this.el.setAttribute("obj-model",{obj:y,mtl:g})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(F){var k=F.detail.model,W;!this.data.model||(W=this.buttonMeshes={},W.menu=k.getObjectByName("AppButton_AppButton_Cylinder.004"),W.system=k.getObjectByName("HomeButton_HomeButton_Cylinder.005"),W.trackpad=k.getObjectByName("TouchPad_TouchPad_Cylinder.003"),W.touchpad=k.getObjectByName("TouchPad_TouchPad_Cylinder.003"),k.position.set(0,0,-.04))},onAxisMoved:function(F){f(this,this.mapping.axes,F)},onButtonChanged:function(F){var k=this.mapping.buttons[F.detail.id];!k||this.el.emit(k+"changed",F.detail.state)},updateModel:function(F,k){!this.data.model||this.updateButtonModel(F,k)},updateButtonModel:function(F,k){var W=this.buttonMeshes;if(!(!W||!W[F])){var j;switch(k){case"down":j=this.data.buttonHighlightColor;break;case"touchstart":j=this.data.buttonTouchedColor;break;default:j=this.data.buttonColor}W[F].material.color.set(j)}}})},{"../core/component":136,"../utils/":212,"../utils/bind":206,"../utils/tracked-controls":221}],79:[function(n,i,o){var s=n("../core/component").registerComponent,c=n("../utils/bind"),u=n("../utils/tracked-controls"),h=u.checkControllerPresentAndSetup,f=u.emitIfAxesChanged,p=u.onButtonEvent,m=n("../utils/").device.isWebXRAvailable,y="https://cdn.aframe.io/controllers/samsung/",g=y+"gear_vr_controller.obj",_=y+"gear_vr_controller.mtl",x="samsung-gearvr",b="Gear VR",E=m?x:b,T={axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},P={axes:{touchpad:[0,1]},buttons:["trigger","none","touchpad","none","menu"]},D=m?P:T;i.exports.Component=s("gearvr-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#000000"},buttonTouchedColor:{type:"color",default:"#777777"},buttonHighlightColor:{type:"color",default:"#FFFFFF"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:D,bindMethods:function(){this.onModelLoaded=c(this.onModelLoaded,this),this.onControllersUpdate=c(this.onControllersUpdate,this),this.checkIfControllerPresent=c(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=c(this.removeControllersUpdateListener,this),this.onAxisMoved=c(this.onAxisMoved,this)},init:function(){var F=this;this.onButtonChanged=c(this.onButtonChanged,this),this.onButtonDown=function(k){p(k.detail.id,"down",F)},this.onButtonUp=function(k){p(k.detail.id,"up",F)},this.onButtonTouchStart=function(k){p(k.detail.id,"touchstart",F)},this.onButtonTouchEnd=function(k){p(k.detail.id,"touchend",F)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var F=this.el;F.addEventListener("buttonchanged",this.onButtonChanged),F.addEventListener("buttondown",this.onButtonDown),F.addEventListener("buttonup",this.onButtonUp),F.addEventListener("touchstart",this.onButtonTouchStart),F.addEventListener("touchend",this.onButtonTouchEnd),F.addEventListener("model-loaded",this.onModelLoaded),F.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var F=this.el;F.removeEventListener("buttonchanged",this.onButtonChanged),F.removeEventListener("buttondown",this.onButtonDown),F.removeEventListener("buttonup",this.onButtonUp),F.removeEventListener("touchstart",this.onButtonTouchStart),F.removeEventListener("touchend",this.onButtonTouchEnd),F.removeEventListener("model-loaded",this.onModelLoaded),F.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){h(this,E,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var F=this.el,k=this.data;F.setAttribute("tracked-controls",{armModel:k.armModel,hand:k.hand,idPrefix:E,id:E,orientationOffset:k.orientationOffset}),this.data.model&&this.el.setAttribute("obj-model",{obj:g,mtl:_})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(F){var k=F.detail.model,W;!this.data.model||(W=this.buttonMeshes={},W.trigger=k.children[2],W.trackpad=k.children[1],W.touchpad=k.children[1])},onButtonChanged:function(F){var k=this.mapping.buttons[F.detail.id];!k||this.el.emit(k+"changed",F.detail.state)},onAxisMoved:function(F){f(this,this.mapping.axes,F)},updateModel:function(F,k){!this.data.model||this.updateButtonModel(F,k)},updateButtonModel:function(F,k){var W=this.buttonMeshes;if(!(!W||!W[F])){var j;switch(k){case"down":j=this.data.buttonHighlightColor;break;case"touchstart":j=this.data.buttonTouchedColor;break;default:j=this.data.buttonColor}W[F].material.color.set(j)}}})},{"../core/component":136,"../utils/":212,"../utils/bind":206,"../utils/tracked-controls":221}],80:[function(n,i,o){var s=n("../core/component").registerComponent,c=n("../utils/bind"),u=n("../utils/tracked-controls"),h=u.checkControllerPresentAndSetup,f=u.emitIfAxesChanged,p=u.onButtonEvent,m="generic",y={axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick"]};i.exports.Component=s("generic-tracked-controller-controls",{schema:{hand:{default:""},defaultModel:{default:!0},defaultModelColor:{default:"gray"},orientationOffset:{type:"vec3"},disabled:{default:!1}},mapping:y,bindMethods:function(){this.onControllersUpdate=c(this.onControllersUpdate,this),this.checkIfControllerPresent=c(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=c(this.removeControllersUpdateListener,this),this.onAxisMoved=c(this.onAxisMoved,this)},init:function(){var g=this;this.onButtonChanged=c(this.onButtonChanged,this),this.onButtonDown=function(_){p(_.detail.id,"down",g)},this.onButtonUp=function(_){p(_.detail.id,"up",g)},this.onButtonTouchStart=function(_){p(_.detail.id,"touchstart",g)},this.onButtonTouchEnd=function(_){p(_.detail.id,"touchend",g)},this.controllerPresent=!1,this.wasControllerConnected=!1,this.lastControllerCheck=0,this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods(),this.el.addEventListener("controllerconnected",function(_){_.detail.name!==g.name&&(g.wasControllerConnected=!0,g.removeEventListeners(),g.removeControllersUpdateListener())})},addEventListeners:function(){var g=this.el;g.addEventListener("buttonchanged",this.onButtonChanged),g.addEventListener("buttondown",this.onButtonDown),g.addEventListener("buttonup",this.onButtonUp),g.addEventListener("touchstart",this.onButtonTouchStart),g.addEventListener("touchend",this.onButtonTouchEnd),g.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var g=this.el;g.removeEventListener("buttonchanged",this.onButtonChanged),g.removeEventListener("buttondown",this.onButtonDown),g.removeEventListener("buttonup",this.onButtonUp),g.removeEventListener("touchstart",this.onButtonTouchStart),g.removeEventListener("touchend",this.onButtonTouchEnd),g.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var g=this.data,_=g.hand?g.hand:void 0;h(this,m,{hand:_,iterateControllerProfiles:!0})},play:function(){this.wasControllerConnected||(this.checkIfControllerPresent(),this.addControllersUpdateListener())},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var g=this.el,_=this.data;if(this.el.components["tracked-controls"]){this.removeEventListeners();return}g.setAttribute("tracked-controls",{hand:_.hand,idPrefix:m,orientationOffset:_.orientationOffset,iterateControllerProfiles:!0}),this.data.defaultModel&&this.initDefaultModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(g){var _=this.mapping.buttons[g.detail.id];!_||this.el.emit(_+"changed",g.detail.state)},onAxisMoved:function(g){f(this,this.mapping.axes,g)},initDefaultModel:function(){var g=this.modelEl=document.createElement("a-entity");g.setAttribute("geometry",{primitive:"sphere",radius:.03}),g.setAttribute("material",{color:this.data.color}),this.el.appendChild(g)}})},{"../core/component":136,"../utils/bind":206,"../utils/tracked-controls":221}],81:[function(n,i,o){var s=n("../core/geometry").geometries,c=n("../core/geometry").geometryNames,u=n("../core/component").registerComponent,h=n("../lib/three"),f=new h.BufferGeometry;i.exports.Component=u("geometry",{schema:{buffer:{default:!0},primitive:{default:"box",oneOf:c,schemaChange:!0},skipCache:{default:!1}},init:function(){this.geometry=null},update:function(p){var m=this.data,y=this.el,g,_=this.system;this.geometry&&(_.unuseGeometry(p),this.geometry=null),this.geometry=_.getOrCreateGeometry(m),g=y.getObject3D("mesh"),g?g.geometry=this.geometry:(g=new h.Mesh,g.geometry=this.geometry,this.el.getAttribute("material")||(g.material=new h.MeshStandardMaterial({color:Math.random()*16777215,metalness:0,roughness:.5})),y.setObject3D("mesh",g))},remove:function(){this.system.unuseGeometry(this.data),this.el.getObject3D("mesh").geometry=f,this.geometry=null},updateSchema:function(p){var m=this.oldData&&this.oldData.primitive,y=p.primitive,g=s[y]&&s[y].schema;if(!g)throw new Error("Unknown geometry schema `"+y+"`");m&&m===y||this.extendSchema(g)}})},{"../core/component":136,"../core/geometry":137,"../lib/three":184}],82:[function(n,i,o){var s=n("../core/component").registerComponent,c=n("../lib/three"),u=n("../utils/"),h=u.debug("components:gltf-model:warn");i.exports.Component=s("gltf-model",{schema:{type:"model"},init:function(){var f=this,p=this.system.getDRACOLoader(),m=this.system.getMeshoptDecoder();this.model=null,this.loader=new c.GLTFLoader,p&&this.loader.setDRACOLoader(p),m?this.ready=m.then(function(y){f.loader.setMeshoptDecoder(y)}):this.ready=Promise.resolve()},update:function(){var f=this,p=this.el,m=this.data;!m||(this.remove(),this.ready.then(function(){f.loader.load(m,function(g){f.model=g.scene||g.scenes[0],f.model.animations=g.animations,p.setObject3D("mesh",f.model),p.emit("model-loaded",{format:"gltf",model:f.model})},void 0,function(g){var _=g&&g.message?g.message:"Failed to load glTF model";h(_),p.emit("model-error",{format:"gltf",src:m})})}))},remove:function(){!this.model||this.el.removeObject3D("mesh")}})},{"../core/component":136,"../lib/three":184,"../utils/":212}],83:[function(n,i,o){var s=n("../core/component").registerComponent,c={toonLeft:"https://cdn.aframe.io/controllers/hands/leftHand.glb",toonRight:"https://cdn.aframe.io/controllers/hands/rightHand.glb",lowPolyLeft:"https://cdn.aframe.io/controllers/hands/leftHandLow.glb",lowPolyRight:"https://cdn.aframe.io/controllers/hands/rightHandLow.glb",highPolyLeft:"https://cdn.aframe.io/controllers/hands/leftHandHigh.glb",highPolyRight:"https://cdn.aframe.io/controllers/hands/rightHandHigh.glb"},u={open:"Open",point:"Point",pointThumb:"Point + Thumb",fist:"Fist",hold:"Hold",thumbUp:"Thumb Up"},h={};h[u.fist]="grip",h[u.thumbUp]="pistol",h[u.point]="pointing",i.exports.Component=s("hand-controls",{schema:{color:{default:"white",type:"color"},hand:{default:"left"},handModelStyle:{default:"lowPoly",oneOf:["lowPoly","highPoly","toon"]}},init:function(){var m=this,y=this.el;this.gesture=u.open,this.pressedButtons={},this.touchedButtons={},this.loader=new THREE.GLTFLoader,this.loader.setCrossOrigin("anonymous"),this.onGripDown=function(){m.handleButton("grip","down")},this.onGripUp=function(){m.handleButton("grip","up")},this.onTrackpadDown=function(){m.handleButton("trackpad","down")},this.onTrackpadUp=function(){m.handleButton("trackpad","up")},this.onTrackpadTouchStart=function(){m.handleButton("trackpad","touchstart")},this.onTrackpadTouchEnd=function(){m.handleButton("trackpad","touchend")},this.onTriggerDown=function(){m.handleButton("trigger","down")},this.onTriggerUp=function(){m.handleButton("trigger","up")},this.onTriggerTouchStart=function(){m.handleButton("trigger","touchstart")},this.onTriggerTouchEnd=function(){m.handleButton("trigger","touchend")},this.onGripTouchStart=function(){m.handleButton("grip","touchstart")},this.onGripTouchEnd=function(){m.handleButton("grip","touchend")},this.onThumbstickDown=function(){m.handleButton("thumbstick","down")},this.onThumbstickUp=function(){m.handleButton("thumbstick","up")},this.onAorXTouchStart=function(){m.handleButton("AorX","touchstart")},this.onAorXTouchEnd=function(){m.handleButton("AorX","touchend")},this.onBorYTouchStart=function(){m.handleButton("BorY","touchstart")},this.onBorYTouchEnd=function(){m.handleButton("BorY","touchend")},this.onSurfaceTouchStart=function(){m.handleButton("surface","touchstart")},this.onSurfaceTouchEnd=function(){m.handleButton("surface","touchend")},this.onControllerConnected=this.onControllerConnected.bind(this),this.onControllerDisconnected=this.onControllerDisconnected.bind(this),y.addEventListener("controllerconnected",this.onControllerConnected),y.addEventListener("controllerdisconnected",this.onControllerDisconnected),y.object3D.visible=!1},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},tick:function(m,y){var g=this.el.getObject3D("mesh");!g||!g.mixer||g.mixer.update(y/1e3)},onControllerConnected:function(){this.el.object3D.visible=!0},onControllerDisconnected:function(){this.el.object3D.visible=!1},addEventListeners:function(){var m=this.el;m.addEventListener("gripdown",this.onGripDown),m.addEventListener("gripup",this.onGripUp),m.addEventListener("trackpaddown",this.onTrackpadDown),m.addEventListener("trackpadup",this.onTrackpadUp),m.addEventListener("trackpadtouchstart",this.onTrackpadTouchStart),m.addEventListener("trackpadtouchend",this.onTrackpadTouchEnd),m.addEventListener("triggerdown",this.onTriggerDown),m.addEventListener("triggerup",this.onTriggerUp),m.addEventListener("triggertouchstart",this.onTriggerTouchStart),m.addEventListener("triggertouchend",this.onTriggerTouchEnd),m.addEventListener("griptouchstart",this.onGripTouchStart),m.addEventListener("griptouchend",this.onGripTouchEnd),m.addEventListener("thumbstickdown",this.onThumbstickDown),m.addEventListener("thumbstickup",this.onThumbstickUp),m.addEventListener("abuttontouchstart",this.onAorXTouchStart),m.addEventListener("abuttontouchend",this.onAorXTouchEnd),m.addEventListener("bbuttontouchstart",this.onBorYTouchStart),m.addEventListener("bbuttontouchend",this.onBorYTouchEnd),m.addEventListener("xbuttontouchstart",this.onAorXTouchStart),m.addEventListener("xbuttontouchend",this.onAorXTouchEnd),m.addEventListener("ybuttontouchstart",this.onBorYTouchStart),m.addEventListener("ybuttontouchend",this.onBorYTouchEnd),m.addEventListener("surfacetouchstart",this.onSurfaceTouchStart),m.addEventListener("surfacetouchend",this.onSurfaceTouchEnd)},removeEventListeners:function(){var m=this.el;m.removeEventListener("gripdown",this.onGripDown),m.removeEventListener("gripup",this.onGripUp),m.removeEventListener("trackpaddown",this.onTrackpadDown),m.removeEventListener("trackpadup",this.onTrackpadUp),m.removeEventListener("trackpadtouchstart",this.onTrackpadTouchStart),m.removeEventListener("trackpadtouchend",this.onTrackpadTouchEnd),m.removeEventListener("triggerdown",this.onTriggerDown),m.removeEventListener("triggerup",this.onTriggerUp),m.removeEventListener("triggertouchstart",this.onTriggerTouchStart),m.removeEventListener("triggertouchend",this.onTriggerTouchEnd),m.removeEventListener("griptouchstart",this.onGripTouchStart),m.removeEventListener("griptouchend",this.onGripTouchEnd),m.removeEventListener("thumbstickdown",this.onThumbstickDown),m.removeEventListener("thumbstickup",this.onThumbstickUp),m.removeEventListener("abuttontouchstart",this.onAorXTouchStart),m.removeEventListener("abuttontouchend",this.onAorXTouchEnd),m.removeEventListener("bbuttontouchstart",this.onBorYTouchStart),m.removeEventListener("bbuttontouchend",this.onBorYTouchEnd),m.removeEventListener("xbuttontouchstart",this.onAorXTouchStart),m.removeEventListener("xbuttontouchend",this.onAorXTouchEnd),m.removeEventListener("ybuttontouchstart",this.onBorYTouchStart),m.removeEventListener("ybuttontouchend",this.onBorYTouchEnd),m.removeEventListener("surfacetouchstart",this.onSurfaceTouchStart),m.removeEventListener("surfacetouchend",this.onSurfaceTouchEnd)},update:function(m){var y,g=this.el,_=this.data.hand,x=this.data.handModelStyle,b=this.data.color,E=this;if(y={hand:_,model:!1},_!==m){var T=c[x+_.charAt(0).toUpperCase()+_.slice(1)];this.loader.load(T,function(P){var D=P.scene.children[0],F=_==="left"?Math.PI/2:-Math.PI/2;D.mixer=new THREE.AnimationMixer(D),E.clips=P.animations,g.setObject3D("mesh",D);var k=D.children[1].material;k.color=new THREE.Color(b),D.position.set(0,0,0),D.rotation.set(0,0,F),g.setAttribute("magicleap-controls",y),g.setAttribute("vive-controls",y),g.setAttribute("oculus-touch-controls",y),g.setAttribute("windows-motion-controls",y),g.setAttribute("hp-mixed-reality-controls",y)})}},remove:function(){this.el.removeObject3D("mesh")},handleButton:function(m,y){var g,_=y==="down",x=y==="touchstart";if(y.indexOf("touch")===0){if(x===this.touchedButtons[m])return;this.touchedButtons[m]=x}else{if(_===this.pressedButtons[m])return;this.pressedButtons[m]=_}g=this.gesture,this.gesture=this.determineGesture(),this.gesture!==g&&(this.animateGesture(this.gesture,g),this.emitGestureEvents(this.gesture,g))},determineGesture:function(){var m,y=this.pressedButtons.grip,g=this.pressedButtons.surface||this.touchedButtons.surface,_=this.pressedButtons.trackpad||this.touchedButtons.trackpad,x=this.pressedButtons.trigger||this.touchedButtons.trigger,b=this.touchedButtons.AorX||this.touchedButtons.BorY,E=p(this.el.components["tracked-controls"]);return E?y||x?m=u.fist:_&&(m=u.point):y?g||b||_?m=x?u.fist:u.point:m=x?u.thumbUp:u.pointThumb:x&&(m=u.hold),m},getClip:function(m){var y,g;for(g=0;g<this.clips.length;g++)if(y=this.clips[g],y.name===m)return y},animateGesture:function(m,y){if(m){this.playAnimation(m||u.open,y,!1);return}this.playAnimation(y,y,!0)},emitGestureEvents:function(m,y){var g=this.el,_;y!==m&&(_=f(y,!1),_&&g.emit(_),_=f(m,!0),_&&g.emit(_))},playAnimation:function(m,y,g){var _,x,b=this.el.getObject3D("mesh"),E;if(!!b){if(b.mixer.stopAllAction(),_=this.getClip(m),E=b.mixer.clipAction(_),E.clampWhenFinished=!0,E.loop=THREE.LoopRepeat,E.repetitions=0,E.timeScale=g?-1:1,E.time=g?_.duration:0,E.weight=1,!y||m===y){b.mixer.stopAllAction(),E.play();return}_=this.getClip(y),x=b.mixer.clipAction(_),x.weight=.15,x.play(),E.play(),x.crossFadeTo(E,.15,!0)}}});function f(m,y){var g;if(!!m){if(g=h[m],g==="grip")return g+(y?"close":"open");if(g==="point")return g+(y?"up":"down");if(g==="pointing"||g==="pistol")return g+(y?"start":"end")}}function p(m){var y=m&&m.controller,g=y&&(y.id&&y.id.indexOf("OpenVR ")===0||y.profiles&&y.profiles[0]&&y.profiles[0]==="htc-vive");return g}},{"../core/component":136}],84:[function(n,i,o){var s=n("../core/component").registerComponent,c=n("../utils/bind"),u=n("../utils/tracked-controls"),h=u.checkControllerPresentAndSetup,f="https://cdn.aframe.io/controllers/oculus-hands/v3/left.glb",p="https://cdn.aframe.io/controllers/oculus-hands/v3/right.glb",m={left:"b_l_",right:"b_r_"},y=["wrist","thumb-metacarpal","thumb-phalanx-proximal","thumb-phalanx-distal","thumb-tip","index-finger-metacarpal","index-finger-phalanx-proximal","index-finger-phalanx-intermediate","index-finger-phalanx-distal","index-finger-tip","middle-finger-metacarpal","middle-finger-phalanx-proximal","middle-finger-phalanx-intermediate","middle-finger-phalanx-distal","middle-finger-tip","ring-finger-metacarpal","ring-finger-phalanx-proximal","ring-finger-phalanx-intermediate","ring-finger-phalanx-distal","ring-finger-tip","pinky-finger-metacarpal","pinky-finger-phalanx-proximal","pinky-finger-phalanx-intermediate","pinky-finger-phalanx-distal","pinky-finger-tip"],g={wrist:"wrist","thumb-metacarpal":"thumb1","thumb-phalanx-proximal":"thumb2","thumb-phalanx-distal":"thumb3","thumb-tip":"thumb_null","index-finger-metacarpal":"index0","index-finger-phalanx-proximal":"index1","index-finger-phalanx-intermediate":"index2","index-finger-phalanx-distal":"index3","index-finger-tip":"index_null","middle-finger-metacarpal":"middle0","middle-finger-phalanx-proximal":"middle1","middle-finger-phalanx-intermediate":"middle2","middle-finger-phalanx-distal":"middle3","middle-finger-tip":"middle_null","ring-finger-metacarpal":"ring0","ring-finger-phalanx-proximal":"ring1","ring-finger-phalanx-intermediate":"ring2","ring-finger-phalanx-distal":"ring3","ring-finger-tip":"ring_null","pinky-finger-metacarpal":"pinky0","pinky-finger-phalanx-proximal":"pinky1","pinky-finger-phalanx-intermediate":"pinky2","pinky-finger-phalanx-distal":"pinky3","pinky-finger-tip":"pinky_null"},_=.015,x=.03,b=.5;i.exports.Component=s("hand-tracking-controls",{schema:{hand:{default:"right",oneOf:["left","right"]},modelStyle:{default:"mesh",oneOf:["dots","mesh"]},modelColor:{default:"white"}},bindMethods:function(){this.onControllersUpdate=c(this.onControllersUpdate,this),this.checkIfControllerPresent=c(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=c(this.removeControllersUpdateListener,this)},addEventListeners:function(){this.el.addEventListener("model-loaded",this.onModelLoaded);for(var E=0;E<this.jointEls.length;++E)this.jointEls[E].object3D.visible=!0},removeEventListeners:function(){this.el.removeEventListener("model-loaded",this.onModelLoaded);for(var E=0;E<this.jointEls.length;++E)this.jointEls[E].object3D.visible=!1},init:function(){var E=this.el.sceneEl,T=E.getAttribute("webxr").optionalFeatures;T.push("hand-tracking"),E.setAttribute("webxr",{optionalFeatures:T}),this.onModelLoaded=this.onModelLoaded.bind(this),this.jointEls=[],this.controllerPresent=!1,this.isPinched=!1,this.pinchEventDetail={position:new THREE.Vector3},this.indexTipPosition=new THREE.Vector3,this.bindMethods(),this.updateReferenceSpace=this.updateReferenceSpace.bind(this),this.el.sceneEl.addEventListener("enter-vr",this.updateReferenceSpace),this.el.sceneEl.addEventListener("exit-vr",this.updateReferenceSpace)},updateReferenceSpace:function(){var E=this,T=this.el.sceneEl.xrSession;if(this.referenceSpace=void 0,!!T){var P=E.el.sceneEl.systems.webxr.sessionReferenceSpaceType;T.requestReferenceSpace(P).then(function(D){E.referenceSpace=D.getOffsetReferenceSpace(new XRRigidTransform({x:0,y:1.5,z:0}))}).catch(function(D){throw E.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(P,"tracked-controls-webxr uses reference space "+P),D})}},checkIfControllerPresent:function(){var E=this.data,T=E.hand?E.hand:void 0;h(this,"",{hand:T,iterateControllerProfiles:!0,handTracking:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},tick:function(){var E=this.el.sceneEl,T=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,P=E.frame,D=this.el.components["tracked-controls-webxr"];!T||!P||!D||T.hand&&(this.el.object3D.position.set(0,0,0),this.el.object3D.rotation.set(0,0,0),P.getJointPose&&this.updateHandModel(),this.detectGesture())},updateHandModel:function(){this.data.modelStyle==="dots"&&this.updateHandDotsModel(),this.data.modelStyle==="mesh"&&this.updateHandMeshModel()},getBone:function(E){for(var T=this.bones,P=0;P<T.length;P++)if(T[P].name===E)return T[P];return null},updateHandMeshModel:function(){var E=this.el.sceneEl.frame,T=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,P=this.referenceSpace;if(!(!T||!this.mesh||!P)){this.mesh.visible=!1;for(var D of T.hand.values()){var F,k,W;k=E.getJointPose(D,P),g[D.jointName]&&(F=this.getBone(m[this.data.hand]+g[D.jointName]),F!=null&&k&&(W=k.transform,this.mesh.visible=!0,F.position.copy(W.position).multiplyScalar(100),F.quaternion.set(W.orientation.x,W.orientation.y,W.orientation.z,W.orientation.w)))}}},updateHandDotsModel:function(){var E=this.el.sceneEl.frame,T=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,P=this.el.components["tracked-controls-webxr"],D=P.system.referenceSpace,F,k,W,j=0;for(var J of T.hand.values())F=this.jointEls[j++],k=F.object3D,W=E.getJointPose(J,D),F.object3D.visible=!!W,W&&(k.matrix.elements=W.transform.matrix,k.matrix.decompose(k.position,k.rotation,k.scale),F.setAttribute("scale",{x:W.radius,y:W.radius,z:W.radius}))},detectGesture:function(){this.detectPinch()},detectPinch:function(){var E=new THREE.Vector3;return function(){var T=this.el.sceneEl.frame,P=this.indexTipPosition,D=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,F=this.el.components["tracked-controls-webxr"],k=this.referenceSpace||F.system.referenceSpace,W=D.hand.get("index-finger-tip"),j=D.hand.get("thumb-tip");if(!(!W||!j)){var J=T.getJointPose(W,k),de=T.getJointPose(j,k);if(!(!J||!de)){E.copy(de.transform.position),P.copy(J.transform.position);var te=P.distanceTo(E);te<_&&this.isPinched===!1&&(this.isPinched=!0,this.pinchEventDetail.position.copy(P).lerp(E,b),this.pinchEventDetail.position.y+=1.5,this.el.emit("pinchstarted",this.pinchEventDetail)),te>x&&this.isPinched===!0&&(this.isPinched=!1,this.pinchEventDetail.position.copy(P).lerp(E,b),this.pinchEventDetail.position.y+=1.5,this.el.emit("pinchended",this.pinchEventDetail)),this.isPinched&&(this.pinchEventDetail.position.copy(P).lerp(E,b),this.pinchEventDetail.position.y+=1.5,this.el.emit("pinchmoved",this.pinchEventDetail)),P.y+=1.5}}}}(),pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var E=this.el,T=this.data;E.setAttribute("tracked-controls",{hand:T.hand,iterateControllerProfiles:!0,handTrackingEnabled:!0}),this.initDefaultModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){var E;this.checkIfControllerPresent(),E=this.el.components["tracked-controls"]&&this.el.components["tracked-controls"].controller,!!this.el.getObject3D("mesh")&&(!E||!E.hand||!E.hand[0])&&(this.el.getObject3D("mesh").visible=!1)},initDefaultModel:function(){this.el.getObject3D("mesh")||(this.data.modelStyle==="dots"&&this.initDotsModel(),this.data.modelStyle==="mesh"&&this.initMeshHandModel())},initDotsModel:function(){if(this.jointEls.length===0)for(var E=0;E<y.length;++E){var T=this.jointEl=document.createElement("a-entity");T.setAttribute("geometry",{primitive:"sphere",radius:1}),T.setAttribute("material",{color:this.data.modelColor}),T.object3D.visible=!1,this.el.appendChild(T),this.jointEls.push(T)}},initMeshHandModel:function(){var E=this.data.hand==="left"?f:p;this.el.setAttribute("gltf-model",E)},onModelLoaded:function(){var E=this.mesh=this.el.getObject3D("mesh").children[0],T=this.skinnedMesh=E.children[30];!this.skinnedMesh||(this.bones=T.skeleton.bones,this.el.removeObject3D("mesh"),E.position.set(0,1.5,0),E.rotation.set(0,0,0),T.frustumCulled=!1,T.material=new THREE.MeshStandardMaterial({skinning:!0,color:this.data.modelColor}),this.el.setObject3D("mesh",E))}})},{"../core/component":136,"../utils/bind":206,"../utils/tracked-controls":221}],85:[function(n,i,o){var s=n("../core/component").registerComponent;i.exports.Component=s("hide-on-enter-ar",{init:function(){var c=this;this.el.sceneEl.addEventListener("enter-vr",function(){c.el.sceneEl.is("ar-mode")&&(c.el.object3D.visible=!1)}),this.el.sceneEl.addEventListener("exit-vr",function(){c.el.object3D.visible=!0})}})},{"../core/component":136}],86:[function(n,i,o){var s=n("../utils/bind"),c=n("../core/component").registerComponent,u=n("../lib/three"),h=n("../utils/tracked-controls"),f=h.checkControllerPresentAndSetup,p=h.emitIfAxesChanged,m=h.onButtonEvent,y="hp-mixed-reality",g="https://cdn.aframe.io/controllers/hp/mixed-reality/",_={x:0,y:0,z:.06},x={_x:Math.PI/4,_y:0,_z:0,_order:"XYZ"},b={left:{axes:{touchpad:[2,3]},buttons:["trigger","grip","none","thumbstick","xbutton","ybutton"]},right:{axes:{touchpad:[2,3]},buttons:["trigger","grip","none","thumbstick","abutton","bbutton"]}};i.exports.Component=c("hp-mixed-reality-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:b,init:function(){var E=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=s(this.onButtonChanged,this),this.onButtonDown=function(T){m(T.detail.id,"down",E,E.data.hand)},this.onButtonUp=function(T){m(T.detail.id,"up",E,E.data.hand)},this.onButtonTouchEnd=function(T){m(T.detail.id,"touchend",E,E.data.hand)},this.onButtonTouchStart=function(T){m(T.detail.id,"touchstart",E,E.data.hand)},this.previousButtonValues={},this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},update:function(){var E=this.data;this.controllerIndex=E.hand==="right"?0:E.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=s(this.onModelLoaded,this),this.onControllersUpdate=s(this.onControllersUpdate,this),this.checkIfControllerPresent=s(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=s(this.removeControllersUpdateListener,this),this.onAxisMoved=s(this.onAxisMoved,this)},addEventListeners:function(){var E=this.el;E.addEventListener("buttonchanged",this.onButtonChanged),E.addEventListener("buttondown",this.onButtonDown),E.addEventListener("buttonup",this.onButtonUp),E.addEventListener("touchstart",this.onButtonTouchStart),E.addEventListener("touchend",this.onButtonTouchEnd),E.addEventListener("axismove",this.onAxisMoved),E.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var E=this.el;E.removeEventListener("buttonchanged",this.onButtonChanged),E.removeEventListener("buttondown",this.onButtonDown),E.removeEventListener("buttonup",this.onButtonUp),E.removeEventListener("touchstart",this.onButtonTouchStart),E.removeEventListener("touchend",this.onButtonTouchEnd),E.removeEventListener("axismove",this.onAxisMoved),E.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var E=this.data;f(this,y,{index:this.controllerIndex,hand:E.hand})},injectTrackedControls:function(){var E=this.el,T=this.data;E.setAttribute("tracked-controls",{idPrefix:y,hand:T.hand,controller:this.controllerIndex,orientationOffset:T.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",g+this.data.hand+".glb")},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(E){var T=this.mapping[this.data.hand].buttons[E.detail.id],P;!T||(T==="trigger"&&(P=E.detail.state.value,console.log("analog value of trigger press: "+P)),this.el.emit(T+"changed",E.detail.state))},onModelLoaded:function(E){var T=E.detail.model;!this.data.model||(T.position.copy(_),T.rotation.copy(x),this.el.emit("controllermodelready",{name:"hp-mixed-reality-controls",model:this.data.model,rayOrigin:new u.Vector3(0,0,0)}))},onAxisMoved:function(E){p(this,this.mapping.axes,E)}})},{"../core/component":136,"../lib/three":184,"../utils/bind":206,"../utils/tracked-controls":221}],87:[function(n,i,o){n("./animation"),n("./camera"),n("./cursor"),n("./daydream-controls"),n("./gearvr-controls"),n("./geometry"),n("./generic-tracked-controller-controls"),n("./gltf-model"),n("./hand-tracking-controls"),n("./hand-controls"),n("./hide-on-enter-ar"),n("./hp-mixed-reality-controls"),n("./layer"),n("./laser-controls"),n("./light"),n("./line"),n("./link"),n("./look-controls"),n("./magicleap-controls"),n("./material"),n("./obj-model"),n("./oculus-go-controls"),n("./oculus-touch-controls"),n("./position"),n("./raycaster"),n("./rotation"),n("./scale"),n("./shadow"),n("./sound"),n("./text"),n("./tracked-controls"),n("./tracked-controls-webvr"),n("./tracked-controls-webxr"),n("./visible"),n("./valve-index-controls"),n("./vive-controls"),n("./vive-focus-controls"),n("./wasd-controls"),n("./windows-motion-controls"),n("./scene/ar-hit-test"),n("./scene/background"),n("./scene/debug"),n("./scene/device-orientation-permission-ui"),n("./scene/embedded"),n("./scene/inspector"),n("./scene/fog"),n("./scene/keyboard-shortcuts"),n("./scene/pool"),n("./scene/reflection"),n("./scene/screenshot"),n("./scene/stats"),n("./scene/vr-mode-ui")},{"./animation":75,"./camera":76,"./cursor":77,"./daydream-controls":78,"./gearvr-controls":79,"./generic-tracked-controller-controls":80,"./geometry":81,"./gltf-model":82,"./hand-controls":83,"./hand-tracking-controls":84,"./hide-on-enter-ar":85,"./hp-mixed-reality-controls":86,"./laser-controls":88,"./layer":89,"./light":90,"./line":91,"./link":92,"./look-controls":93,"./magicleap-controls":94,"./material":95,"./obj-model":96,"./oculus-go-controls":97,"./oculus-touch-controls":98,"./position":99,"./raycaster":100,"./rotation":101,"./scale":102,"./scene/ar-hit-test":103,"./scene/background":104,"./scene/debug":105,"./scene/device-orientation-permission-ui":106,"./scene/embedded":107,"./scene/fog":108,"./scene/inspector":109,"./scene/keyboard-shortcuts":110,"./scene/pool":111,"./scene/reflection":112,"./scene/screenshot":113,"./scene/stats":114,"./scene/vr-mode-ui":115,"./shadow":116,"./sound":117,"./text":118,"./tracked-controls":121,"./tracked-controls-webvr":119,"./tracked-controls-webxr":120,"./valve-index-controls":122,"./visible":123,"./vive-controls":124,"./vive-focus-controls":125,"./wasd-controls":126,"./windows-motion-controls":127}],88:[function(n,i,o){var s=n("../core/component").registerComponent,c=n("../utils/");s("laser-controls",{schema:{hand:{default:"right"},model:{default:!0},defaultModelColor:{type:"color",default:"grey"}},init:function(){var u=this.config,h=this.data,f=this.el,p=this,m={hand:h.hand,model:h.model};f.setAttribute("daydream-controls",m),f.setAttribute("gearvr-controls",m),f.setAttribute("hp-mixed-reality-controls",m),f.setAttribute("magicleap-controls",m),f.setAttribute("oculus-go-controls",m),f.setAttribute("oculus-touch-controls",m),f.setAttribute("valve-index-controls",m),f.setAttribute("vive-controls",m),f.setAttribute("vive-focus-controls",m),f.setAttribute("windows-motion-controls",m),f.setAttribute("generic-tracked-controller-controls",m),f.addEventListener("controllerconnected",y),f.addEventListener("controllerdisconnected",g),f.addEventListener("controllermodelready",function(_){y(_),p.modelReady=!0});function y(_){var x=u[_.detail.name];if(!!x){var b=c.extend({showLine:!0},x.raycaster||{});_.detail.rayOrigin&&(b.origin=_.detail.rayOrigin.origin,b.direction=_.detail.rayOrigin.direction,b.showLine=!0),_.detail.rayOrigin||!p.modelReady?f.setAttribute("raycaster",b):f.setAttribute("raycaster","showLine",!0),f.setAttribute("cursor",c.extend({fuse:!1},x.cursor))}}function g(){f.setAttribute("raycaster","showLine",!1)}},config:{"daydream-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"gearvr-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:.001,z:0}}},"generic-tracked-controller-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"hp-mixed-reality-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:0,z:0}}},"magicleap-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"oculus-go-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:5e-4,z:0}}},"oculus-touch-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{origin:{x:0,y:0,z:0}}},"valve-index-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]}},"vive-focus-controls":{cursor:{downEvents:["trackpaddown","triggerdown"],upEvents:["trackpadup","triggerup"]}},"windows-motion-controls":{cursor:{downEvents:["triggerdown"],upEvents:["triggerup"]},raycaster:{showLine:!1}}}})},{"../core/component":136,"../utils/":212}],89:[function(n,i,o){var s=n("../core/component").registerComponent,c=n("../utils/"),u=c.debug("components:layer:warn");i.exports.Component=s("layer",{schema:{type:{default:"quad",oneOf:["quad","monocubemap","stereocubemap"]},src:{type:"map"},rotateCubemap:{default:!1},width:{default:0},height:{default:0}},init:function(){var f=this.el.sceneEl.renderer.getContext();this.quaternion=new THREE.Quaternion,this.position=new THREE.Vector3,this.bindMethods(),this.needsRedraw=!1,this.frameBuffer=f.createFramebuffer();var p=this.el.sceneEl.getAttribute("webxr").requiredFeatures;p.push("layers"),this.el.sceneEl.getAttribute("webxr","requiredFeatures",p),this.el.sceneEl.addEventListener("enter-vr",this.onEnterVR),this.el.sceneEl.addEventListener("exit-vr",this.onExitVR)},bindMethods:function(){this.onRequestedReferenceSpace=this.onRequestedReferenceSpace.bind(this),this.onEnterVR=this.onEnterVR.bind(this),this.onExitVR=this.onExitVR.bind(this)},update:function(f){this.data.src!==f.src&&this.updateSrc()},updateSrc:function(){var f=this.data.type;if(this.texture=void 0,f==="quad"){this.loadQuadImage();return}if(f==="monocubemap"||f==="stereocubemap"){this.loadCubeMapImages();return}},loadCubeMapImages:function(){var f,p=this.xrGLFactory,m=this.el.sceneEl.frame,y=this.data.src,g=this.data.type;this.visibilityChanged=!1,this.layer&&(g!=="monocubemap"&&g!=="stereocubemap"||(y.complete?this.pendingCubeMapUpdate=!1:this.pendingCubeMapUpdate=!0,this.loadingScreen?this.loadingScreen=!1:this.loadingScreen=!0,g==="monocubemap"?(f=p.getSubImage(this.layer,m),this.loadCubeMapImage(f.colorTexture,y,0)):(f=p.getSubImage(this.layer,m,"left"),this.loadCubeMapImage(f.colorTexture,y,0),f=p.getSubImage(this.layer,m,"right"),this.loadCubeMapImage(f.colorTexture,y,6))))},loadQuadImage:function(){var f=this.data.src,p=this;this.el.sceneEl.systems.material.loadTexture(f,{src:f},function(y){p.el.sceneEl.renderer.initTexture(y),p.texture=y,f.tagName==="VIDEO"&&setTimeout(function(){p.textureIsVideo=!0},1e3),p.layer&&(p.layer.height=p.data.height/2||p.texture.image.height/1e3,p.layer.width=p.data.width/2||p.texture.image.width/1e3,p.needsRedraw=!0),p.updateQuadPanel()})},preGenerateCubeMapTextures:function(f,p){this.data.type==="monocubemap"?this.generateCubeMapTextures(f,0,p):(this.generateCubeMapTextures(f,0,p),this.generateCubeMapTextures(f,6,p))},generateCubeMapTextures:function(f,p,m){for(var y=this.data,g=this.cubeFaceSize,_=Math.min(f.width,f.height),x=[],b,E,T=0;T<6;T++){var P=document.createElement("CANVAS");P.width=P.height=g;var D=P.getContext("2d");y.rotateCubemap&&(T===2||T===3)&&(D.save(),D.translate(g,g),D.rotate(Math.PI)),D.drawImage(f,(T+p)*_,0,_,_,0,0,g,g),D.restore(),m&&m(),x.push(P)}return y.rotateCubemap&&(b=x[0],E=x[1],x[0]=E,x[1]=b,b=x[4],E=x[5],x[4]=E,x[5]=b),m&&m(),x},loadCubeMapImage:function(f,p,m){var y=this.el.sceneEl.renderer.getContext(),g;y.pixelStorei(y.UNPACK_FLIP_Y_WEBGL,!1),y.bindTexture(y.TEXTURE_CUBE_MAP,f),!p.complete||this.loadingScreen?g=this.loadingScreenImages:g=this.generateCubeMapTextures(p,m);var _=0;g.forEach(function(x,b){y.texSubImage2D(y.TEXTURE_CUBE_MAP_POSITIVE_X+b,0,0,0,y.RGBA,y.UNSIGNED_BYTE,x),_=y.getError()}),_!==0&&console.log("renderingError, WebGL Error Code: "+_),y.bindTexture(y.TEXTURE_CUBE_MAP,null)},tick:function(){!this.el.sceneEl.xrSession||(!this.layer&&this.el.sceneEl.is("vr-mode")&&this.initLayer(),this.updateTransform(),this.data.src.complete&&(this.pendingCubeMapUpdate||this.loadingScreen||this.visibilityChanged)&&this.loadCubeMapImages(),!(!this.needsRedraw&&!this.layer.needsRedraw&&!this.textureIsVideo)&&(this.data.type==="quad"&&this.draw(),this.needsRedraw=!1))},initLayer:function(){var f=this,p=this.data.type;if(this.el.sceneEl.xrSession.onvisibilitychange=function(m){f.visibilityChanged=m.session.visibilityState!=="hidden"},p==="quad"){this.initQuadLayer();return}if(p==="monocubemap"||p==="stereocubemap"){this.initCubeMapLayer();return}},initQuadLayer:function(){var f=this.el.sceneEl,p=f.renderer.getContext(),m=this.xrGLFactory=new XRWebGLBinding(f.xrSession,p);!this.texture||(this.layer=m.createQuadLayer({space:this.referenceSpace,viewPixelHeight:2048,viewPixelWidth:2048,height:this.data.height/2||this.texture.image.height/1e3,width:this.data.width/2||this.texture.image.width/1e3}),this.initLoadingScreenImages(),f.renderer.xr.addLayer(this.layer))},initCubeMapLayer:function(){var f=this.data.src,p=this.el.sceneEl,m=p.renderer.getContext(),y=m.getParameter(m.MAX_CUBE_MAP_TEXTURE_SIZE),g=this.cubeFaceSize=Math.min(y,Math.min(f.width,f.height)),_=this.xrGLFactory=new XRWebGLBinding(p.xrSession,m);this.layer=_.createCubeLayer({space:this.referenceSpace,viewPixelWidth:g,viewPixelHeight:g,layout:this.data.type==="monocubemap"?"mono":"stereo",isStatic:!1}),this.initLoadingScreenImages(),this.loadCubeMapImages(),p.renderer.xr.addLayer(this.layer)},initLoadingScreenImages:function(){for(var f=this.cubeFaceSize,p=this.loadingScreenImages=[],m=0;m<6;m++){var y=document.createElement("CANVAS");y.width=y.height=f;var g=y.getContext("2d");y.width=y.height=f,g.fillStyle="black",g.fillRect(0,0,f,f),m!==2&&m!==3&&(g.translate(f,0),g.scale(-1,1),g.fillStyle="white",g.font="30px Arial",g.fillText("Loading",f/2,f/2)),p.push(y)}},destroyLayer:function(){!this.layer||(this.el.sceneEl.renderer.xr.removeLayer(this.layer),this.layer.destroy(),this.layer=void 0)},toggleCompositorLayer:function(){this.enableCompositorLayer(!this.layerEnabled)},enableCompositorLayer:function(f){this.layerEnabled=f,this.quadPanelEl.object3D.visible=!this.layerEnabled},updateQuadPanel:function(){var f=this.quadPanelEl;this.quadPanelEl||(f=this.quadPanelEl=document.createElement("a-entity"),this.el.appendChild(f)),f.setAttribute("material",{shader:"flat",src:this.data.src,transparent:!0}),f.setAttribute("geometry",{primitive:"plane",height:this.data.height||this.texture.image.height/1e3,width:this.data.width||this.texture.image.height/1e3})},draw:function(){var f=this.el.sceneEl,p=this.el.sceneEl.renderer.getContext(),m=this.xrGLFactory.getSubImage(this.layer,f.frame),y=f.renderer.properties.get(this.texture).__webglTexture,g=p.getParameter(p.FRAMEBUFFER_BINDING);p.viewport(m.viewport.x,m.viewport.y,m.viewport.width,m.viewport.height),p.bindFramebuffer(p.FRAMEBUFFER,this.frameBuffer),p.framebufferTexture2D(p.FRAMEBUFFER,p.COLOR_ATTACHMENT0,p.TEXTURE_2D,m.colorTexture,0),h(p,y,m,this.data.src),p.bindFramebuffer(p.FRAMEBUFFER,g)},updateTransform:function(){var f=this.el,p=this.position,m=this.quaternion;f.object3D.updateMatrixWorld(),p.setFromMatrixPosition(f.object3D.matrixWorld),m.setFromRotationMatrix(f.object3D.matrixWorld),this.layerEnabled||p.set(0,0,1e8),this.layer.transform=new XRRigidTransform(p,m)},onEnterVR:function(){var f=this.el.sceneEl,p=f.xrSession;if(!f.hasWebXR||!XRWebGLBinding||!p){u("The layer component requires WebXR and the layers API enabled");return}p.requestReferenceSpace("local-floor").then(this.onRequestedReferenceSpace),this.needsRedraw=!0,this.layerEnabled=!0,this.quadPanelEl&&(this.quadPanelEl.object3D.visible=!1),this.data.src.play&&this.data.src.play()},onExitVR:function(){this.quadPanelEl&&(this.quadPanelEl.object3D.visible=!0),this.destroyLayer()},onRequestedReferenceSpace:function(f){this.referenceSpace=f}});function h(f,p,m,y){var g=f.createFramebuffer();let _=m.viewport.x,x=m.viewport.y,b=m.viewport.x+m.viewport.width,E=m.viewport.y+m.viewport.height;y.tagName==="VIDEO"&&(f.bindTexture(f.TEXTURE_2D,p),f.texSubImage2D(f.TEXTURE_2D,0,0,0,y.width,y.height,f.RGB,f.UNSIGNED_BYTE,y)),f.bindFramebuffer(f.READ_FRAMEBUFFER,g),f.framebufferTexture2D(f.READ_FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,p,0),f.readBuffer(f.COLOR_ATTACHMENT0),f.blitFramebuffer(0,0,y.width,y.height,_,x,b,E,f.COLOR_BUFFER_BIT,f.NEAREST),f.bindFramebuffer(f.READ_FRAMEBUFFER,null),f.deleteFramebuffer(g)}},{"../core/component":136,"../utils/":212}],90:[function(n,i,o){var s=n("../utils/bind"),c=n("../utils"),u=c.diff,h=n("../utils/debug"),f=n("../core/component").registerComponent,p=n("../lib/three"),m=p.Math.degToRad,y=h("components:light:warn"),g=new p.CubeTextureLoader,_={};i.exports.Component=f("light",{schema:{angle:{default:60,if:{type:["spot"]}},color:{type:"color",if:{type:["ambient","directional","hemisphere","point","spot"]}},envMap:{default:"",if:{type:["probe"]}},groundColor:{type:"color",if:{type:["hemisphere"]}},decay:{default:1,if:{type:["point","spot"]}},distance:{default:0,min:0,if:{type:["point","spot"]}},intensity:{default:1,min:0,if:{type:["ambient","directional","hemisphere","point","spot","probe"]}},penumbra:{default:0,min:0,max:1,if:{type:["spot"]}},type:{default:"directional",oneOf:["ambient","directional","hemisphere","point","spot","probe"],schemaChange:!0},target:{type:"selector",if:{type:["spot","directional"]}},castShadow:{default:!1,if:{type:["point","spot","directional"]}},shadowBias:{default:0,if:{castShadow:!0}},shadowCameraFar:{default:500,if:{castShadow:!0}},shadowCameraFov:{default:90,if:{castShadow:!0}},shadowCameraNear:{default:.5,if:{castShadow:!0}},shadowCameraTop:{default:5,if:{castShadow:!0}},shadowCameraRight:{default:5,if:{castShadow:!0}},shadowCameraBottom:{default:-5,if:{castShadow:!0}},shadowCameraLeft:{default:-5,if:{castShadow:!0}},shadowCameraVisible:{default:!1,if:{castShadow:!0}},shadowMapHeight:{default:512,if:{castShadow:!0}},shadowMapWidth:{default:512,if:{castShadow:!0}},shadowRadius:{default:1,if:{castShadow:!0}}},init:function(){var x=this.el;this.light=null,this.defaultTarget=null,this.rendererSystem=this.el.sceneEl.systems.renderer,this.system.registerLight(x)},update:function(x){var b=this.data,E=u(b,x),T=this.light,P=this.rendererSystem,D=this;if(T&&!("type"in E)){var F=!1;Object.keys(E).forEach(function(k){var W=b[k];switch(k){case"color":{T.color.set(W),P.applyColorCorrection(T.color);break}case"groundColor":{T.groundColor.set(W),P.applyColorCorrection(T.groundColor);break}case"angle":{T.angle=m(W);break}case"target":{W===null?(b.type==="spot"||b.type==="directional")&&(T.target=D.defaultTarget):W.hasLoaded?D.onSetTarget(W,T):W.addEventListener("loaded",s(D.onSetTarget,D,W,T));break}case"envMap":this.updateProbeMap(b,T);break;case"castShadow":case"shadowBias":case"shadowCameraFar":case"shadowCameraFov":case"shadowCameraNear":case"shadowCameraTop":case"shadowCameraRight":case"shadowCameraBottom":case"shadowCameraLeft":case"shadowCameraVisible":case"shadowMapHeight":case"shadowMapWidth":case"shadowRadius":F||(D.updateShadow(),F=!0);break;default:T[k]=W}});return}this.setLight(this.data),this.updateShadow()},setLight:function(x){var b=this.el,E=this.getLight(x);E&&(this.light&&b.removeObject3D("light"),this.light=E,this.light.el=b,b.setObject3D("light",this.light),(x.type==="spot"||x.type==="directional"||x.type==="hemisphere")&&b.getObject3D("light").translateY(-1),x.type==="spot"&&(b.setObject3D("light-target",this.defaultTarget),b.getObject3D("light-target").position.set(0,0,-1)))},updateShadow:function(){var x=this.el,b=this.data,E=this.light;E.castShadow=b.castShadow;var T=x.getObject3D("cameraHelper");if(b.shadowCameraVisible&&!T?x.setObject3D("cameraHelper",new p.CameraHelper(E.shadow.camera)):!b.shadowCameraVisible&&T&&x.removeObject3D("cameraHelper"),!b.castShadow)return E;E.shadow.bias=b.shadowBias,E.shadow.radius=b.shadowRadius,E.shadow.mapSize.height=b.shadowMapHeight,E.shadow.mapSize.width=b.shadowMapWidth,E.shadow.camera.near=b.shadowCameraNear,E.shadow.camera.far=b.shadowCameraFar,E.shadow.camera instanceof p.OrthographicCamera?(E.shadow.camera.top=b.shadowCameraTop,E.shadow.camera.right=b.shadowCameraRight,E.shadow.camera.bottom=b.shadowCameraBottom,E.shadow.camera.left=b.shadowCameraLeft):E.shadow.camera.fov=b.shadowCameraFov,E.shadow.camera.updateProjectionMatrix(),T&&T.update()},getLight:function(x){var b=x.angle,E=new p.Color(x.color);this.rendererSystem.applyColorCorrection(E),E=E.getHex();var T=x.decay,P=x.distance,D=new p.Color(x.groundColor);this.rendererSystem.applyColorCorrection(D),D=D.getHex();var F=x.intensity,k=x.type,W=x.target,j=null;switch(k.toLowerCase()){case"ambient":return new p.AmbientLight(E,F);case"directional":return j=new p.DirectionalLight(E,F),this.defaultTarget=j.target,W&&(W.hasLoaded?this.onSetTarget(W,j):W.addEventListener("loaded",s(this.onSetTarget,this,W,j))),j;case"hemisphere":return new p.HemisphereLight(E,D,F);case"point":return new p.PointLight(E,F,P,T);case"spot":return j=new p.SpotLight(E,F,P,m(b),x.penumbra,T),this.defaultTarget=j.target,W&&(W.hasLoaded?this.onSetTarget(W,j):W.addEventListener("loaded",s(this.onSetTarget,this,W,j))),j;case"probe":return j=new p.LightProbe,this.updateProbeMap(x,j),j;default:y("%s is not a valid light type. Choose from ambient, directional, hemisphere, point, spot.",k)}},updateProbeMap:function(x,b){x.envMap||b.copy(new p.LightProbe),_[x.envMap]instanceof window.Promise&&_[x.envMap].then(function(E){b.copy(E)}),_[x.envMap]instanceof p.LightProbe&&b.copy(_[x.envMap]),_[x.envMap]=new window.Promise(function(E){c.srcLoader.validateCubemapSrc(x.envMap,function(P){g.load(P,function(D){var F=p.LightProbeGenerator.fromCubeTexture(D);_[x.envMap]=F,b.copy(F)})})})},onSetTarget:function(x,b){b.target=x.object3D},remove:function(){var x=this.el;x.removeObject3D("light"),x.getObject3D("cameraHelper")&&x.removeObject3D("cameraHelper")}})},{"../core/component":136,"../lib/three":184,"../utils":212,"../utils/bind":206,"../utils/debug":208}],91:[function(n,i,o){var s=n("../core/component").registerComponent;i.exports.Component=s("line",{schema:{start:{type:"vec3",default:{x:0,y:0,z:0}},end:{type:"vec3",default:{x:0,y:0,z:0}},color:{type:"color",default:"#74BEC1"},opacity:{type:"number",default:1},visible:{default:!0}},multiple:!0,init:function(){var u=this.data,h,f;this.rendererSystem=this.el.sceneEl.systems.renderer,f=this.material=new THREE.LineBasicMaterial({color:u.color,opacity:u.opacity,transparent:u.opacity<1,visible:u.visible}),h=this.geometry=new THREE.BufferGeometry,h.setAttribute("position",new THREE.BufferAttribute(new Float32Array(2*3),3)),this.rendererSystem.applyColorCorrection(f.color),this.line=new THREE.Line(h,f),this.el.setObject3D(this.attrName,this.line)},update:function(u){var h=this.data,f=this.geometry,p=!1,m=this.material,y=f.attributes.position.array;c(h.start,u.start)||(y[0]=h.start.x,y[1]=h.start.y,y[2]=h.start.z,p=!0),c(h.end,u.end)||(y[3]=h.end.x,y[4]=h.end.y,y[5]=h.end.z,p=!0),p&&(f.attributes.position.needsUpdate=!0,f.computeBoundingSphere()),m.color.setStyle(h.color),this.rendererSystem.applyColorCorrection(m.color),m.opacity=h.opacity,m.transparent=h.opacity<1,m.visible=h.visible},remove:function(){this.el.removeObject3D("line",this.line)}});function c(u,h){return!u||!h?!1:u.x===h.x&&u.y===h.y&&u.z===h.z}},{"../core/component":136}],92:[function(n,i,o){var s=n("../core/component").registerComponent,c=n("../core/shader").registerShader,u=n("../lib/three");i.exports.Component=s("link",{schema:{backgroundColor:{default:"red",type:"color"},borderColor:{default:"white",type:"color"},highlighted:{default:!1},highlightedColor:{default:"#24CAFF",type:"color"},href:{default:""},image:{type:"asset"},on:{default:"click"},peekMode:{default:!1},title:{default:""},titleColor:{default:"white",type:"color"},visualAspectEnabled:{default:!1}},init:function(){this.navigate=this.navigate.bind(this),this.previousQuaternion=void 0,this.quaternionClone=new u.Quaternion,this.hiddenEls=[]},update:function(h){var f=this.data,p=this.el,m,y;!f.visualAspectEnabled||(this.initVisualAspect(),m=f.highlighted?f.highlightedColor:f.backgroundColor,y=f.highlighted?f.highlightedColor:f.borderColor,p.setAttribute("material","backgroundColor",m),p.setAttribute("material","strokeColor",y),f.on!==h.on&&this.updateEventListener(),h.peekMode!==void 0&&f.peekMode!==h.peekMode&&this.updatePeekMode(),!(!f.image||h.image===f.image)&&p.setAttribute("material","pano",typeof f.image=="string"?f.image:f.image.src))},updatePeekMode:function(){var h=this.el,f=this.sphereEl;this.data.peekMode?(this.hideAll(),h.getObject3D("mesh").visible=!1,f.setAttribute("visible",!0)):(this.showAll(),h.getObject3D("mesh").visible=!0,f.setAttribute("visible",!1))},play:function(){this.updateEventListener()},pause:function(){this.removeEventListener()},updateEventListener:function(){var h=this.el;!h.isPlaying||(this.removeEventListener(),h.addEventListener(this.data.on,this.navigate))},removeEventListener:function(){var h=this.data.on;!h||this.el.removeEventListener(h,this.navigate)},initVisualAspect:function(){var h=this.el,f,p,m;!this.data.visualAspectEnabled||this.visualAspectInitialized||(m=this.textEl=this.textEl||document.createElement("a-entity"),p=this.sphereEl=this.sphereEl||document.createElement("a-entity"),f=this.semiSphereEl=this.semiSphereEl||document.createElement("a-entity"),h.setAttribute("geometry",{primitive:"circle",radius:1,segments:64}),h.setAttribute("material",{shader:"portal",pano:this.data.image,side:"double"}),m.setAttribute("text",{color:this.data.titleColor,align:"center",font:"kelsonsans",value:this.data.title||this.data.href,width:4}),m.setAttribute("position","0 1.5 0"),h.appendChild(m),f.setAttribute("geometry",{primitive:"sphere",radius:1,phiStart:0,segmentsWidth:64,segmentsHeight:64,phiLength:180,thetaStart:0,thetaLength:360}),f.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),f.setAttribute("rotation","0 180 0"),f.setAttribute("position","0 0 0"),f.setAttribute("visible",!1),h.appendChild(f),p.setAttribute("geometry",{primitive:"sphere",radius:10,segmentsWidth:64,segmentsHeight:64}),p.setAttribute("material",{shader:"portal",borderEnabled:0,pano:this.data.image,side:"back"}),p.setAttribute("visible",!1),h.appendChild(p),this.visualAspectInitialized=!0)},navigate:function(){window.location=this.data.href},tick:function(){var h=new u.Vector3,f=new u.Vector3,p=new u.Quaternion,m=new u.Vector3;return function(){var y=this.el,g=y.object3D,_=y.sceneEl.camera,x,b,E=this.textEl;if(!!this.data.visualAspectEnabled)if(g.updateMatrixWorld(),_.parent.updateMatrixWorld(),_.updateMatrixWorld(),g.matrix.decompose(f,p,m),f.setFromMatrixPosition(g.matrixWorld),h.setFromMatrixPosition(_.matrixWorld),b=f.distanceTo(h),b>20)this.previousQuaternion||(this.quaternionClone.copy(p),this.previousQuaternion=this.quaternionClone),g.lookAt(h);else{if(x=this.calculateCameraPortalOrientation(),b<.5){if(this.semiSphereEl.getAttribute("visible")===!0)return;E.setAttribute("text","width",1.5),x<=0?(E.setAttribute("position","0 0 0.75"),E.setAttribute("rotation","0 180 0"),this.semiSphereEl.setAttribute("rotation","0 0 0")):(E.setAttribute("position","0 0 -0.75"),E.setAttribute("rotation","0 0 0"),this.semiSphereEl.setAttribute("rotation","0 180 0")),y.getObject3D("mesh").visible=!1,this.semiSphereEl.setAttribute("visible",!0),this.peekCameraPortalOrientation=x}else x<=0?E.setAttribute("rotation","0 180 0"):E.setAttribute("rotation","0 0 0"),E.setAttribute("text","width",5),E.setAttribute("position","0 1.5 0"),y.getObject3D("mesh").visible=!0,this.semiSphereEl.setAttribute("visible",!1),this.peekCameraPortalOrientation=void 0;this.previousQuaternion&&(g.quaternion.copy(this.previousQuaternion),this.previousQuaternion=void 0)}}}(),hideAll:function(){var h=this.el,f=this.hiddenEls,p=this;f.length>0||h.sceneEl.object3D.traverse(function(m){m&&m.el&&m.el.hasAttribute("link-controls")||!m.el||m===h.sceneEl.object3D||m.el===h||m.el===p.sphereEl||m.el===h.sceneEl.cameraEl||m.el.getAttribute("visible")===!1||m.el===p.textEl||m.el===p.semiSphereEl||(m.el.setAttribute("visible",!1),f.push(m.el))})},showAll:function(){this.hiddenEls.forEach(function(h){h.setAttribute("visible",!0)}),this.hiddenEls=[]},calculateCameraPortalOrientation:function(){var h=new u.Matrix4,f=new u.Vector3,p=new u.Vector3(0,0,1),m=new u.Vector3(0,0,0);return function(){var y=this.el,g=y.sceneEl.camera;return f.set(0,0,0),p.set(0,0,1),m.set(0,0,0),y.object3D.matrixWorld.extractRotation(h),p.applyMatrix4(h),y.object3D.updateMatrixWorld(),y.object3D.localToWorld(m),g.parent.parent.updateMatrixWorld(),g.parent.updateMatrixWorld(),g.updateMatrixWorld(),g.localToWorld(f),f.sub(m).normalize(),p.normalize(),Math.sign(p.dot(f))}}(),remove:function(){this.removeEventListener()}}),c("portal",{schema:{borderEnabled:{default:1,type:"int",is:"uniform"},backgroundColor:{default:"red",type:"color",is:"uniform"},pano:{type:"map",is:"uniform"},strokeColor:{default:"white",type:"color",is:"uniform"}},vertexShader:["vec3 portalPosition;","varying vec3 vWorldPosition;","varying float vDistanceToCenter;","varying float vDistance;","void main() {","vDistanceToCenter = clamp(length(position - vec3(0.0, 0.0, 0.0)), 0.0, 1.0);","portalPosition = (modelMatrix * vec4(0.0, 0.0, 0.0, 1.0)).xyz;","vDistance = length(portalPosition - cameraPosition);","vWorldPosition = (modelMatrix * vec4(position, 1.0)).xyz;","gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join(`
`),fragmentShader:["#define RECIPROCAL_PI2 0.15915494","uniform sampler2D pano;","uniform vec3 strokeColor;","uniform vec3 backgroundColor;","uniform float borderEnabled;","varying float vDistanceToCenter;","varying float vDistance;","varying vec3 vWorldPosition;","void main() {","vec3 direction = normalize(vWorldPosition - cameraPosition);","vec2 sampleUV;","float borderThickness = clamp(exp(-vDistance / 50.0), 0.6, 0.95);","sampleUV.y = clamp(direction.y * 0.5  + 0.5, 0.0, 1.0);","sampleUV.x = atan(direction.z, -direction.x) * -RECIPROCAL_PI2 + 0.5;","if (vDistanceToCenter > borderThickness && borderEnabled == 1.0) {","gl_FragColor = vec4(strokeColor, 1.0);","} else {","gl_FragColor = mix(texture2D(pano, sampleUV), vec4(backgroundColor, 1.0), clamp(pow((vDistance / 15.0), 2.0), 0.0, 1.0));","}","}"].join(`
`)})},{"../core/component":136,"../core/shader":146,"../lib/three":184}],93:[function(n,i,o){var s=n("../core/component").registerComponent,c=n("../lib/three"),u=n("../utils/"),h=u.bind,f=Math.PI/2;i.exports.Component=s("look-controls",{dependencies:["position","rotation"],schema:{enabled:{default:!0},magicWindowTrackingEnabled:{default:!0},pointerLockEnabled:{default:!1},reverseMouseDrag:{default:!1},reverseTouchDrag:{default:!1},touchEnabled:{default:!0},mouseEnabled:{default:!0}},init:function(){this.deltaYaw=0,this.previousHMDPosition=new c.Vector3,this.hmdQuaternion=new c.Quaternion,this.magicWindowAbsoluteEuler=new c.Euler,this.magicWindowDeltaEuler=new c.Euler,this.position=new c.Vector3,this.magicWindowObject=new c.Object3D,this.rotation={},this.deltaRotation={},this.savedPose=null,this.pointerLocked=!1,this.setupMouseControls(),this.bindMethods(),this.previousMouseEvent={},this.setupMagicWindowControls(),this.savedPose={position:new c.Vector3,rotation:new c.Euler},(this.el.sceneEl.is("vr-mode")||this.el.sceneEl.is("ar-mode"))&&this.onEnterVR()},setupMagicWindowControls:function(){var p,m=this.data;(u.device.isMobile()||u.device.isMobileDeviceRequestingDesktopSite())&&(p=this.magicWindowControls=new c.DeviceOrientationControls(this.magicWindowObject),typeof DeviceOrientationEvent!="undefined"&&DeviceOrientationEvent.requestPermission&&(p.enabled=!1,this.el.sceneEl.components["device-orientation-permission-ui"].permissionGranted?p.enabled=m.magicWindowTrackingEnabled:this.el.sceneEl.addEventListener("deviceorientationpermissiongranted",function(){p.enabled=m.magicWindowTrackingEnabled})))},update:function(p){var m=this.data;m.enabled!==p.enabled&&this.updateGrabCursor(m.enabled),p&&!m.magicWindowTrackingEnabled&&p.magicWindowTrackingEnabled&&(this.magicWindowAbsoluteEuler.set(0,0,0),this.magicWindowDeltaEuler.set(0,0,0)),this.magicWindowControls&&(this.magicWindowControls.enabled=m.magicWindowTrackingEnabled),p&&!m.pointerLockEnabled!==p.pointerLockEnabled&&(this.removeEventListeners(),this.addEventListeners(),this.pointerLocked&&this.exitPointerLock())},tick:function(p){var m=this.data;!m.enabled||this.updateOrientation()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},remove:function(){this.removeEventListeners(),this.pointerLocked&&this.exitPointerLock()},bindMethods:function(){this.onMouseDown=h(this.onMouseDown,this),this.onMouseMove=h(this.onMouseMove,this),this.onMouseUp=h(this.onMouseUp,this),this.onTouchStart=h(this.onTouchStart,this),this.onTouchMove=h(this.onTouchMove,this),this.onTouchEnd=h(this.onTouchEnd,this),this.onEnterVR=h(this.onEnterVR,this),this.onExitVR=h(this.onExitVR,this),this.onPointerLockChange=h(this.onPointerLockChange,this),this.onPointerLockError=h(this.onPointerLockError,this)},setupMouseControls:function(){this.mouseDown=!1,this.pitchObject=new c.Object3D,this.yawObject=new c.Object3D,this.yawObject.position.y=10,this.yawObject.add(this.pitchObject)},addEventListeners:function(){var p=this.el.sceneEl,m=p.canvas;if(!m){p.addEventListener("render-target-loaded",h(this.addEventListeners,this));return}m.addEventListener("mousedown",this.onMouseDown,!1),window.addEventListener("mousemove",this.onMouseMove,!1),window.addEventListener("mouseup",this.onMouseUp,!1),m.addEventListener("touchstart",this.onTouchStart),window.addEventListener("touchmove",this.onTouchMove),window.addEventListener("touchend",this.onTouchEnd),p.addEventListener("enter-vr",this.onEnterVR),p.addEventListener("exit-vr",this.onExitVR),this.data.pointerLockEnabled&&(document.addEventListener("pointerlockchange",this.onPointerLockChange,!1),document.addEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.addEventListener("pointerlockerror",this.onPointerLockError,!1))},removeEventListeners:function(){var p=this.el.sceneEl,m=p&&p.canvas;!m||(m.removeEventListener("mousedown",this.onMouseDown),window.removeEventListener("mousemove",this.onMouseMove),window.removeEventListener("mouseup",this.onMouseUp),m.removeEventListener("touchstart",this.onTouchStart),window.removeEventListener("touchmove",this.onTouchMove),window.removeEventListener("touchend",this.onTouchEnd),p.removeEventListener("enter-vr",this.onEnterVR),p.removeEventListener("exit-vr",this.onExitVR),document.removeEventListener("pointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("mozpointerlockchange",this.onPointerLockChange,!1),document.removeEventListener("pointerlockerror",this.onPointerLockError,!1))},updateOrientation:function(){var p=this.el.object3D,m=this.pitchObject,y=this.yawObject,g=this.el.sceneEl;(g.is("vr-mode")||g.is("ar-mode"))&&g.checkHeadsetConnected()||(this.updateMagicWindowOrientation(),p.rotation.x=this.magicWindowDeltaEuler.x+m.rotation.x,p.rotation.y=this.magicWindowDeltaEuler.y+y.rotation.y,p.rotation.z=this.magicWindowDeltaEuler.z)},updateMagicWindowOrientation:function(){var p=this.magicWindowAbsoluteEuler,m=this.magicWindowDeltaEuler;this.magicWindowControls&&this.magicWindowControls.enabled&&(this.magicWindowControls.update(),p.setFromQuaternion(this.magicWindowObject.quaternion,"YXZ"),!this.previousMagicWindowYaw&&p.y!==0&&(this.previousMagicWindowYaw=p.y),this.previousMagicWindowYaw&&(m.x=p.x,m.y+=p.y-this.previousMagicWindowYaw,m.z=p.z,this.previousMagicWindowYaw=p.y))},onMouseMove:function(p){var m,y,g,_=this.pitchObject,x=this.previousMouseEvent,b=this.yawObject;!this.data.enabled||!this.mouseDown&&!this.pointerLocked||(this.pointerLocked?(y=p.movementX||p.mozMovementX||0,g=p.movementY||p.mozMovementY||0):(y=p.screenX-x.screenX,g=p.screenY-x.screenY),this.previousMouseEvent.screenX=p.screenX,this.previousMouseEvent.screenY=p.screenY,m=this.data.reverseMouseDrag?1:-1,b.rotation.y+=y*.002*m,_.rotation.x+=g*.002*m,_.rotation.x=Math.max(-f,Math.min(f,_.rotation.x)))},onMouseDown:function(p){var m=this.el.sceneEl;if(!(!this.data.enabled||!this.data.mouseEnabled||(m.is("vr-mode")||m.is("ar-mode"))&&m.checkHeadsetConnected())&&p.button===0){var y=m&&m.canvas;this.mouseDown=!0,this.previousMouseEvent.screenX=p.screenX,this.previousMouseEvent.screenY=p.screenY,this.showGrabbingCursor(),this.data.pointerLockEnabled&&!this.pointerLocked&&(y.requestPointerLock?y.requestPointerLock():y.mozRequestPointerLock&&y.mozRequestPointerLock())}},showGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor="grabbing"},hideGrabbingCursor:function(){this.el.sceneEl.canvas.style.cursor=""},onMouseUp:function(){this.mouseDown=!1,this.hideGrabbingCursor()},onTouchStart:function(p){p.touches.length!==1||!this.data.touchEnabled||this.el.sceneEl.is("vr-mode")||this.el.sceneEl.is("ar-mode")||(this.touchStart={x:p.touches[0].pageX,y:p.touches[0].pageY},this.touchStarted=!0)},onTouchMove:function(p){var m,y=this.el.sceneEl.canvas,g,_=this.yawObject;!this.touchStarted||!this.data.touchEnabled||(g=2*Math.PI*(p.touches[0].pageX-this.touchStart.x)/y.clientWidth,m=this.data.reverseTouchDrag?1:-1,_.rotation.y-=g*.5*m,this.touchStart={x:p.touches[0].pageX,y:p.touches[0].pageY})},onTouchEnd:function(){this.touchStarted=!1},onEnterVR:function(){var p=this.el.sceneEl;!p.checkHeadsetConnected()||(this.saveCameraPose(),this.el.object3D.position.set(0,0,0),this.el.object3D.rotation.set(0,0,0),p.hasWebXR&&(this.el.object3D.matrixAutoUpdate=!1,this.el.object3D.updateMatrix()))},onExitVR:function(){!this.el.sceneEl.checkHeadsetConnected()||(this.restoreCameraPose(),this.previousHMDPosition.set(0,0,0),this.el.object3D.matrixAutoUpdate=!0)},onPointerLockChange:function(){this.pointerLocked=!!(document.pointerLockElement||document.mozPointerLockElement)},onPointerLockError:function(){this.pointerLocked=!1},exitPointerLock:function(){document.exitPointerLock(),this.pointerLocked=!1},updateGrabCursor:function(p){var m=this.el.sceneEl;function y(){m.canvas.classList.add("a-grab-cursor")}function g(){m.canvas.classList.remove("a-grab-cursor")}if(!m.canvas){p?m.addEventListener("render-target-loaded",y):m.addEventListener("render-target-loaded",g);return}if(p){y();return}g()},saveCameraPose:function(){var p=this.el;this.savedPose.position.copy(p.object3D.position),this.savedPose.rotation.copy(p.object3D.rotation),this.hasSavedPose=!0},restoreCameraPose:function(){var p=this.el,m=this.savedPose;!this.hasSavedPose||(p.object3D.position.copy(m.position),p.object3D.rotation.copy(m.rotation),this.hasSavedPose=!1)}})},{"../core/component":136,"../lib/three":184,"../utils/":212}],94:[function(n,i,o){var s=n("../utils/bind"),c=n("../core/component").registerComponent,u=n("../utils/tracked-controls"),h=u.checkControllerPresentAndSetup,f=u.emitIfAxesChanged,p=u.onButtonEvent,m="magicleap",y="-one",g=m+y,_="https://cdn.aframe.io/controllers/magicleap/magicleap-one-controller.glb",x={axes:{touchpad:[0,1]},buttons:["trigger","grip","touchpad","menu"]};i.exports.Component=c("magicleap-controls",{schema:{hand:{default:"none"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:x,init:function(){var b=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=s(this.onButtonChanged,this),this.onButtonDown=function(E){p(E.detail.id,"down",b)},this.onButtonUp=function(E){p(E.detail.id,"up",b)},this.onButtonTouchEnd=function(E){p(E.detail.id,"touchend",b)},this.onButtonTouchStart=function(E){p(E.detail.id,"touchstart",b)},this.previousButtonValues={},this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},update:function(){var b=this.data;this.controllerIndex=b.hand==="right"?0:b.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=s(this.onModelLoaded,this),this.onControllersUpdate=s(this.onControllersUpdate,this),this.checkIfControllerPresent=s(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=s(this.removeControllersUpdateListener,this),this.onAxisMoved=s(this.onAxisMoved,this)},addEventListeners:function(){var b=this.el;b.addEventListener("buttonchanged",this.onButtonChanged),b.addEventListener("buttondown",this.onButtonDown),b.addEventListener("buttonup",this.onButtonUp),b.addEventListener("touchstart",this.onButtonTouchStart),b.addEventListener("touchend",this.onButtonTouchEnd),b.addEventListener("axismove",this.onAxisMoved),b.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var b=this.el;b.removeEventListener("buttonchanged",this.onButtonChanged),b.removeEventListener("buttondown",this.onButtonDown),b.removeEventListener("buttonup",this.onButtonUp),b.removeEventListener("touchstart",this.onButtonTouchStart),b.removeEventListener("touchend",this.onButtonTouchEnd),b.removeEventListener("axismove",this.onAxisMoved),b.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var b=this.data;h(this,g,{index:this.controllerIndex,hand:b.hand})},injectTrackedControls:function(){var b=this.el,E=this.data;b.setAttribute("tracked-controls",{idPrefix:g,hand:E.hand,controller:this.controllerIndex,orientationOffset:E.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",_)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(b){var E=this.mapping.buttons[b.detail.id],T;!E||(E==="trigger"&&(T=b.detail.state.value,console.log("analog value of trigger press: "+T)),this.el.emit(E+"changed",b.detail.state))},onModelLoaded:function(b){var E=b.detail.model;E.scale.set(.01,.01,.01)},onAxisMoved:function(b){f(this,this.mapping.axes,b)},updateModel:function(b,E){},setButtonColor:function(b,E){}})},{"../core/component":136,"../utils/bind":206,"../utils/tracked-controls":221}],95:[function(n,i,o){var s=n("../utils/"),c=n("../core/component"),u=n("../lib/three"),h=n("../core/shader"),f=s.debug("components:material:error"),p=c.registerComponent,m=h.shaders,y=h.shaderNames;i.exports.Component=p("material",{schema:{alphaTest:{default:0,min:0,max:1},depthTest:{default:!0},depthWrite:{default:!0},flatShading:{default:!1},npot:{default:!1},offset:{type:"vec2",default:{x:0,y:0}},opacity:{default:1,min:0,max:1},repeat:{type:"vec2",default:{x:1,y:1}},shader:{default:"standard",oneOf:y,schemaChange:!0},side:{default:"front",oneOf:["front","back","double"]},transparent:{default:!1},vertexColors:{type:"string",default:"none",oneOf:["face","vertex"]},visible:{default:!0},blending:{default:"normal",oneOf:["none","normal","additive","subtractive","multiply"]},dithering:{default:!0}},init:function(){this.material=null},update:function(E){var T=this.data;(!this.shader||T.shader!==E.shader)&&this.updateShader(T.shader),this.shader.update(this.data),this.updateMaterial(E)},updateSchema:function(E){var T,P,D,F;P=E&&E.shader,T=this.oldData&&this.oldData.shader,F=P||T,D=m[F]&&m[F].schema,D||f("Unknown shader schema "+F),!(T&&P===T)&&(this.extendSchema(D),this.updateBehavior())},updateBehavior:function(){var E,T=this.el.sceneEl,P=this.schema,D=this,F;function k(W,j){var J;for(J in F)F[J]=W;D.shader.update(F)}this.tick=void 0,F={};for(E in P)P[E].type==="time"&&(this.tick=k,F[E]=!0);!T||(this.tick?T.addBehavior(this):T.removeBehavior(this))},updateShader:function(E){var T=this.data,P=m[E]&&m[E].Shader,D;if(!P)throw new Error("Unknown shader "+E);D=this.shader=new P,D.el=this.el,D.init(T),this.setMaterial(D.material),this.updateSchema(T)},updateMaterial:function(E){var T=this.data,P=this.material,D;P.alphaTest=T.alphaTest,P.depthTest=T.depthTest!==!1,P.depthWrite=T.depthWrite!==!1,P.opacity=T.opacity,P.flatShading=T.flatShading,P.side=g(T.side),P.transparent=T.transparent!==!1||T.opacity<1,P.vertexColors=_(T.vertexColors),P.visible=T.visible,P.blending=x(T.blending),P.dithering=T.dithering;for(D in E)break;D&&(E.alphaTest!==T.alphaTest||E.side!==T.side||E.vertexColors!==T.vertexColors)&&(P.needsUpdate=!0)},remove:function(){var E=new u.MeshBasicMaterial,T=this.material,P=this.el.getObject3D("mesh");P&&(P.material=E),b(T,this.system)},setMaterial:function(E){var T=this.el,P,D=this.system;this.material&&b(this.material,D),this.material=E,D.registerMaterial(E),P=T.getObject3D("mesh"),P?P.material=E:T.addEventListener("object3dset",function F(k){k.detail.type!=="mesh"||k.target!==T||(T.getObject3D("mesh").material=E,T.removeEventListener("object3dset",F))})}});function g(E){switch(E){case"back":return u.BackSide;case"double":return u.DoubleSide;default:return u.FrontSide}}function _(E){switch(E){case"face":return u.FaceColors;case"vertex":return u.VertexColors;default:return u.NoColors}}function x(E){switch(E){case"none":return u.NoBlending;case"additive":return u.AdditiveBlending;case"subtractive":return u.SubtractiveBlending;case"multiply":return u.MultiplyBlending;default:return u.NormalBlending}}function b(E,T){E.dispose(),T.unregisterMaterial(E)}},{"../core/component":136,"../core/shader":146,"../lib/three":184,"../utils/":212}],96:[function(n,i,o){var s=n("../utils/debug"),c=n("../core/component").registerComponent,u=n("../lib/three"),h=s("components:obj-model:warn");i.exports.Component=c("obj-model",{schema:{mtl:{type:"model"},obj:{type:"model"}},init:function(){var f=this;this.model=null,this.objLoader=new u.OBJLoader,this.mtlLoader=new u.MTLLoader(this.objLoader.manager),this.mtlLoader.crossOrigin="",this.el.addEventListener("componentinitialized",function(p){!f.model||p.detail.name==="material"&&f.applyMaterial()})},update:function(){var f=this.data;!f.obj||(this.resetMesh(),this.loadObj(f.obj,f.mtl))},remove:function(){!this.model||this.resetMesh()},resetMesh:function(){this.el.removeObject3D("mesh")},loadObj:function(f,p){var m=this,y=this.el,g=this.mtlLoader,_=this.objLoader,x=this.el.sceneEl.systems.renderer,b=p.substr(0,p.lastIndexOf("/")+1);if(p){y.hasAttribute("material")&&h("Material component properties are ignored when a .MTL is provided"),g.setResourcePath(b),g.load(p,function(E){E.preload(),_.setMaterials(E),_.load(f,function(T){m.model=T,m.model.traverse(function(P){if(P.isMesh){var D=P.material;D.color&&x.applyColorCorrection(D.color),D.map&&x.applyColorCorrection(D.map),D.emissive&&x.applyColorCorrection(D.emissive),D.emissiveMap&&x.applyColorCorrection(D.emissiveMap)}}),y.setObject3D("mesh",T),y.emit("model-loaded",{format:"obj",model:T})})});return}_.load(f,function(T){m.model=T,m.applyMaterial(),y.setObject3D("mesh",T),y.emit("model-loaded",{format:"obj",model:T})})},applyMaterial:function(){var f=this.el.components.material;!f||this.model.traverse(function(p){p instanceof u.Mesh&&(p.material=f.material)})}})},{"../core/component":136,"../lib/three":184,"../utils/debug":208}],97:[function(n,i,o){var s=n("../core/component").registerComponent,c=n("../utils/bind"),u=n("../utils/tracked-controls"),h=u.checkControllerPresentAndSetup,f=u.emitIfAxesChanged,p=u.onButtonEvent,m=n("../utils/").device.isWebXRAvailable,y="oculus-go",g="Oculus Go",_="https://cdn.aframe.io/controllers/oculus/go/oculus-go-controller.gltf",x=m?y:g,b={axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},E={axes:{touchpad:[0,1]},buttons:["trigger","none","touchpad"]},T=m?E:b;i.exports.Component=s("oculus-go-controls",{schema:{hand:{default:""},buttonColor:{type:"color",default:"#FFFFFF"},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:T,bindMethods:function(){this.onModelLoaded=c(this.onModelLoaded,this),this.onControllersUpdate=c(this.onControllersUpdate,this),this.checkIfControllerPresent=c(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=c(this.removeControllersUpdateListener,this),this.onAxisMoved=c(this.onAxisMoved,this)},init:function(){var P=this;this.onButtonChanged=c(this.onButtonChanged,this),this.onButtonDown=function(D){p(D.detail.id,"down",P)},this.onButtonUp=function(D){p(D.detail.id,"up",P)},this.onButtonTouchStart=function(D){p(D.detail.id,"touchstart",P)},this.onButtonTouchEnd=function(D){p(D.detail.id,"touchend",P)},this.controllerPresent=!1,this.lastControllerCheck=0,this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},addEventListeners:function(){var P=this.el;P.addEventListener("buttonchanged",this.onButtonChanged),P.addEventListener("buttondown",this.onButtonDown),P.addEventListener("buttonup",this.onButtonUp),P.addEventListener("touchstart",this.onButtonTouchStart),P.addEventListener("touchend",this.onButtonTouchEnd),P.addEventListener("model-loaded",this.onModelLoaded),P.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var P=this.el;P.removeEventListener("buttonchanged",this.onButtonChanged),P.removeEventListener("buttondown",this.onButtonDown),P.removeEventListener("buttonup",this.onButtonUp),P.removeEventListener("touchstart",this.onButtonTouchStart),P.removeEventListener("touchend",this.onButtonTouchEnd),P.removeEventListener("model-loaded",this.onModelLoaded),P.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){h(this,x,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var P=this.el,D=this.data;P.setAttribute("tracked-controls",{armModel:D.armModel,hand:D.hand,idPrefix:x,orientationOffset:D.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",_)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(P){var D=P.detail.model,F;!this.data.model||(F=this.buttonMeshes={},F.trigger=D.getObjectByName("oculus_go_button_trigger"),F.trackpad=D.getObjectByName("oculus_go_touchpad"),F.touchpad=D.getObjectByName("oculus_go_touchpad"))},onButtonChanged:function(P){var D=this.mapping.buttons[P.detail.id];!D||this.el.emit(D+"changed",P.detail.state)},onAxisMoved:function(P){f(this,this.mapping.axes,P)},updateModel:function(P,D){!this.data.model||this.updateButtonModel(P,D)},updateButtonModel:function(P,D){var F=this.buttonMeshes;if(!(!F||!F[P])){var k,W;switch(D){case"down":k=this.data.buttonHighlightColor;break;case"touchstart":k=this.data.buttonTouchedColor;break;default:k=this.data.buttonColor}W=F[P],W.material.color.set(k),this.rendererSystem.applyColorCorrection(W.material.color)}}})},{"../core/component":136,"../utils/":212,"../utils/bind":206,"../utils/tracked-controls":221}],98:[function(n,i,o){var s=n("../utils/bind"),c=n("../core/component").registerComponent,u=n("../lib/three"),h=n("../utils/tracked-controls"),f=h.checkControllerPresentAndSetup,p=h.emitIfAxesChanged,m=h.onButtonEvent,y=n("../utils/").device.isWebXRAvailable,g="oculus-touch",_="Oculus Touch",x=y?g:_,b="https://cdn.aframe.io/controllers/oculus/oculus-touch-controller-",E={left:{modelUrl:b+"left.gltf",rayOrigin:{origin:{x:.008,y:-.01,z:0},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new u.Vector3(-.005,.003,-.055),modelPivotRotation:new u.Euler(0,0,0)},right:{modelUrl:b+"right.gltf",rayOrigin:{origin:{x:-.008,y:-.01,z:0},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new u.Vector3(.005,.003,-.055),modelPivotRotation:new u.Euler(0,0,0)}},T={left:{modelUrl:b+"left.gltf",rayOrigin:{origin:{x:.002,y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new u.Vector3(-.005,.036,-.037),modelPivotRotation:new u.Euler(Math.PI/4.5,0,0)},right:{modelUrl:b+"right.gltf",rayOrigin:{origin:{x:-.002,y:-.005,z:-.03},direction:{x:0,y:-.8,z:-1}},modelPivotOffset:new u.Vector3(.005,.036,-.037),modelPivotRotation:new u.Euler(Math.PI/4.5,0,0)}},P=y?T:E,D="oculus-touch",F={"oculus-touch":P,"oculus-touch-v2":{left:{modelUrl:b+"gen2-left.gltf",rayOrigin:{origin:{x:-.01,y:0,z:-.02},direction:{x:0,y:-.5,z:-1}},modelPivotOffset:new u.Vector3(0,0,0),modelPivotRotation:new u.Euler(0,0,0)},right:{modelUrl:b+"gen2-right.gltf",rayOrigin:{origin:{x:.01,y:0,z:-.02},direction:{x:0,y:-.5,z:-1}},modelPivotOffset:new u.Vector3(0,0,0),modelPivotRotation:new u.Euler(0,0,0)}},"oculus-touch-v3":{left:{modelUrl:b+"v3-left.glb",rayOrigin:{origin:{x:.015,y:.005,z:0},direction:{x:0,y:0,z:-1}},modelPivotOffset:new u.Vector3(.01,-.01,.05),modelPivotRotation:new u.Euler(Math.PI/4,0,0)},right:{modelUrl:b+"v3-right.glb",rayOrigin:{origin:{x:-.015,y:.005,z:0},direction:{x:0,y:0,z:-1}},modelPivotOffset:new u.Vector3(-.01,-.01,.05),modelPivotRotation:new u.Euler(Math.PI/4,0,0)}}},k={left:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[0,1]},buttons:["thumbstick","trigger","grip","abutton","bbutton","surface"]}},W={left:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","xbutton","ybutton","surface"]},right:{axes:{thumbstick:[2,3]},buttons:["trigger","grip","none","thumbstick","abutton","bbutton","surface"]}},j=y?W:k;i.exports.Component=c("oculus-touch-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#999"},buttonTouchColor:{type:"color",default:"#8AB"},buttonHighlightColor:{type:"color",default:"#2DF"},model:{default:!0},controllerType:{default:"auto",oneOf:["auto","oculus-touch","oculus-touch-v2","oculus-touch-v3"]},orientationOffset:{type:"vec3",default:{x:43,y:0,z:0}}},mapping:j,bindMethods:function(){this.onModelLoaded=s(this.onModelLoaded,this),this.onControllersUpdate=s(this.onControllersUpdate,this),this.checkIfControllerPresent=s(this.checkIfControllerPresent,this),this.onAxisMoved=s(this.onAxisMoved,this)},init:function(){var J=this;this.onButtonChanged=s(this.onButtonChanged,this),this.onButtonDown=function(de){m(de.detail.id,"down",J,J.data.hand)},this.onButtonUp=function(de){m(de.detail.id,"up",J,J.data.hand)},this.onButtonTouchStart=function(de){m(de.detail.id,"touchstart",J,J.data.hand)},this.onButtonTouchEnd=function(de){m(de.detail.id,"touchend",J,J.data.hand)},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},addEventListeners:function(){var J=this.el;J.addEventListener("buttonchanged",this.onButtonChanged),J.addEventListener("buttondown",this.onButtonDown),J.addEventListener("buttonup",this.onButtonUp),J.addEventListener("touchstart",this.onButtonTouchStart),J.addEventListener("touchend",this.onButtonTouchEnd),J.addEventListener("axismove",this.onAxisMoved),J.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var J=this.el;J.removeEventListener("buttonchanged",this.onButtonChanged),J.removeEventListener("buttondown",this.onButtonDown),J.removeEventListener("buttonup",this.onButtonUp),J.removeEventListener("touchstart",this.onButtonTouchStart),J.removeEventListener("touchend",this.onButtonTouchEnd),J.removeEventListener("axismove",this.onAxisMoved),J.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){f(this,x,{hand:this.data.hand})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},loadModel:function(J){var de=this.data,te;if(!!de.model){if(this.displayModel=F[de.controllerType]||F[D],de.controllerType==="auto"){var N=this.el.sceneEl.systems["tracked-controls-webvr"];if(N&&N.vrDisplay){var L=N.vrDisplay.displayName;/^Oculus Quest$/.test(L)&&(this.displayModel=F["oculus-touch-v2"])}else te=D,te=J.profiles.indexOf("oculus-touch-v2")!==-1?"oculus-touch-v2":te,te=J.profiles.indexOf("oculus-touch-v3")!==-1?"oculus-touch-v3":te,this.displayModel=F[te]}var M=this.displayModel[de.hand].modelUrl;this.el.setAttribute("gltf-model",M)}},injectTrackedControls:function(J){var de=this.data,te=g,N=de.hand==="right"?"Oculus Touch (Right)":"Oculus Touch (Left)",L=y?te:N;this.el.setAttribute("tracked-controls",{id:L,hand:de.hand,orientationOffset:de.orientationOffset,handTrackingEnabled:!1}),this.loadModel(J)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(J){var de=this.mapping[this.data.hand].buttons[J.detail.id],te=this.buttonMeshes,N;!de||((de==="trigger"||de==="grip")&&(N=J.detail.state.value),te&&(de==="trigger"&&te.trigger&&(te.trigger.rotation.x=this.originalXRotationTrigger-N*(Math.PI/26)),de==="grip"&&te.grip&&(te.grip.position.x=this.originalXPositionGrip+(this.data.hand==="left"?-1:1)*N*.004)),this.el.emit(de+"changed",J.detail.state))},onModelLoaded:function(J){var de=this.controllerObject3D=J.detail.model,te;!this.data.model||(te=this.buttonMeshes={},te.grip=de.getObjectByName("buttonHand"),this.originalXPositionGrip=te.grip&&te.grip.position.x,te.thumbstick=de.getObjectByName("stick"),te.trigger=de.getObjectByName("buttonTrigger"),this.originalXRotationTrigger=te.trigger&&te.trigger.rotation.x,te.xbutton=de.getObjectByName("buttonX"),te.abutton=de.getObjectByName("buttonA"),te.ybutton=de.getObjectByName("buttonY"),te.bbutton=de.getObjectByName("buttonB"),de.position.copy(this.displayModel[this.data.hand].modelPivotOffset),de.rotation.copy(this.displayModel[this.data.hand].modelPivotRotation),this.el.emit("controllermodelready",{name:"oculus-touch-controls",model:this.data.model,rayOrigin:this.displayModel[this.data.hand].rayOrigin}))},onAxisMoved:function(J){p(this,this.mapping[this.data.hand].axes,J)},updateModel:function(J,de){!this.data.model||this.updateButtonModel(J,de)},updateButtonModel:function(J,de){var te,N=de==="up"||de==="touchend"?this.data.buttonColor:de==="touchstart"?this.data.buttonTouchColor:this.data.buttonHighlightColor,L=this.buttonMeshes;!this.data.model||L&&L[J]&&(te=L[J],te.material.color.set(N),this.rendererSystem.applyColorCorrection(te.material.color))}})},{"../core/component":136,"../lib/three":184,"../utils/":212,"../utils/bind":206,"../utils/tracked-controls":221}],99:[function(n,i,o){var s=n("../core/component").registerComponent;i.exports.Component=s("position",{schema:{type:"vec3"},update:function(){var c=this.el.object3D,u=this.data;c.position.set(u.x,u.y,u.z)},remove:function(){this.el.object3D.position.set(0,0,0)}})},{"../core/component":136}],100:[function(n,i,o){var s=n("../core/component").registerComponent,c=n("../lib/three"),u=n("../utils/"),h=u.debug("components:raycaster:warn"),f=/^[\w\s-.,[\]#]*$/,p={childList:!0,attributes:!0,subtree:!0},m={INTERSECT:"raycaster-intersected",INTERSECTION:"raycaster-intersection",INTERSECT_CLEAR:"raycaster-intersected-cleared",INTERSECTION_CLEAR:"raycaster-intersection-cleared",INTERSECTION_CLOSEST_ENTITY_CHANGED:"raycaster-closest-entity-changed"};i.exports.Component=s("raycaster",{schema:{autoRefresh:{default:!0},direction:{type:"vec3",default:{x:0,y:0,z:-1}},enabled:{default:!0},far:{default:1e3},interval:{default:0},near:{default:0},objects:{default:""},origin:{type:"vec3"},showLine:{default:!1},lineColor:{default:"white"},lineOpacity:{default:1},useWorldCoordinates:{default:!1}},multiple:!0,init:function(){this.clearedIntersectedEls=[],this.unitLineEndVec3=new c.Vector3,this.intersectedEls=[],this.intersections=[],this.newIntersectedEls=[],this.newIntersections=[],this.objects=[],this.prevCheckTime=void 0,this.prevIntersectedEls=[],this.rawIntersections=[],this.raycaster=new c.Raycaster,this.updateOriginDirection(),this.setDirty=this.setDirty.bind(this),this.updateLine=this.updateLine.bind(this),this.observer=new MutationObserver(this.setDirty),this.dirty=!0,this.lineEndVec3=new c.Vector3,this.otherLineEndVec3=new c.Vector3,this.lineData={end:this.lineEndVec3},this.getIntersection=this.getIntersection.bind(this),this.intersectedDetail={el:this.el,getIntersection:this.getIntersection},this.intersectedClearedDetail={el:this.el},this.intersectionClearedDetail={clearedEls:this.clearedIntersectedEls},this.intersectionDetail={}},update:function(g){var _=this.data,x=this.el,b=this.raycaster;b.far=_.far,b.near=_.near,_.showLine&&(_.far!==g.far||_.origin!==g.origin||_.direction!==g.direction||!g.showLine)&&(this.unitLineEndVec3.copy(_.origin).add(_.direction).normalize(),this.drawLine()),!_.showLine&&g.showLine&&x.removeAttribute("line"),_.objects!==g.objects&&!f.test(_.objects)&&h('[raycaster] Selector "'+_.objects+'" may not update automatically with DOM changes.'),_.objects||h('[raycaster] For performance, please define raycaster.objects when using raycaster or cursor components to whitelist which entities to intersect with. e.g., raycaster="objects: [data-raycastable]".'),_.autoRefresh!==g.autoRefresh&&x.isPlaying&&(_.autoRefresh?this.addEventListeners():this.removeEventListeners()),g.enabled&&!_.enabled&&this.clearAllIntersections(),this.setDirty()},play:function(){this.addEventListeners()},pause:function(){this.removeEventListeners()},remove:function(){this.data.showLine&&this.el.removeAttribute("line"),this.clearAllIntersections()},addEventListeners:function(){!this.data.autoRefresh||(this.observer.observe(this.el.sceneEl,p),this.el.sceneEl.addEventListener("object3dset",this.setDirty),this.el.sceneEl.addEventListener("object3dremove",this.setDirty))},removeEventListeners:function(){this.observer.disconnect(),this.el.sceneEl.removeEventListener("object3dset",this.setDirty),this.el.sceneEl.removeEventListener("object3dremove",this.setDirty)},setDirty:function(){this.dirty=!0},refreshObjects:function(){var g=this.data,_;_=g.objects?this.el.sceneEl.querySelectorAll(g.objects):this.el.sceneEl.querySelectorAll("*"),this.objects=this.flattenObject3DMaps(_),this.dirty=!1},tock:function(g){var _=this.data,x=this.prevCheckTime;!_.enabled||x&&g-x<_.interval||(this.prevCheckTime=g,this.checkIntersections())},checkIntersections:function(){var g=this.clearedIntersectedEls,_=this.el,x=this.data,b,E=this.intersectedEls,T,P=this.intersections,D=this.newIntersectedEls,F=this.newIntersections,k=this.prevIntersectedEls,W=this.rawIntersections;for(this.dirty&&this.refreshObjects(),y(this.prevIntersectedEls,this.intersectedEls),this.updateOriginDirection(),W.length=0,this.raycaster.intersectObjects(this.objects,!0,W),P.length=0,E.length=0,b=0;b<W.length;b++)T=W[b],!(x.showLine&&T.object===_.getObject3D("line"))&&T.object.el&&(P.push(T),E.push(T.object.el));for(F.length=0,D.length=0,b=0;b<P.length;b++)k.indexOf(P[b].object.el)===-1&&(F.push(P[b]),D.push(P[b].object.el));for(g.length=0,b=0;b<k.length;b++)E.indexOf(k[b])===-1&&(k[b].emit(m.INTERSECT_CLEAR,this.intersectedClearedDetail),g.push(k[b]));for(g.length&&_.emit(m.INTERSECTION_CLEAR,this.intersectionClearedDetail),b=0;b<D.length;b++)D[b].emit(m.INTERSECT,this.intersectedDetail);F.length&&(this.intersectionDetail.els=D,this.intersectionDetail.intersections=F,_.emit(m.INTERSECTION,this.intersectionDetail)),(k.length===0&&P.length>0||k.length>0&&P.length===0||k.length&&P.length&&k[0]!==P[0].object.el)&&(this.intersectionDetail.els=this.intersectedEls,this.intersectionDetail.intersections=P,_.emit(m.INTERSECTION_CLOSEST_ENTITY_CHANGED,this.intersectionDetail)),x.showLine&&setTimeout(this.updateLine)},updateLine:function(){var g=this.el,_=this.intersections,x;_.length&&(_[0].object.el===g&&_[1]?x=_[1].distance:x=_[0].distance),this.drawLine(x)},getIntersection:function(g){var _,x;for(_=0;_<this.intersections.length;_++)if(x=this.intersections[_],x.object.el===g)return x;return null},updateOriginDirection:function(){var g=new c.Vector3,_=new c.Vector3;return function(){var b=this.el,E=this.data;if(E.useWorldCoordinates){this.raycaster.set(E.origin,E.direction);return}b.object3D.updateMatrixWorld(),_.setFromMatrixPosition(b.object3D.matrixWorld),(E.origin.x!==0||E.origin.y!==0||E.origin.z!==0)&&(_=b.object3D.localToWorld(_.copy(E.origin))),g.copy(E.direction).transformDirection(b.object3D.matrixWorld).normalize(),this.raycaster.set(_,g)}}(),drawLine:function(g){var _=this.data,x=this.el,b;b=this.lineData.end===this.lineEndVec3?this.otherLineEndVec3:this.lineEndVec3,g===void 0&&(g=_.far===1/0?1e3:_.far),this.lineData.start=_.origin,this.lineData.end=b.copy(this.unitLineEndVec3).multiplyScalar(g),this.lineData.color=_.lineColor,this.lineData.opacity=_.lineOpacity,x.setAttribute("line",this.lineData)},flattenObject3DMaps:function(g){var _,x,b=this.objects;for(b.length=0,x=0;x<g.length;x++)if(g[x].isEntity&&g[x].object3D)for(_ in g[x].object3DMap)b.push(g[x].getObject3D(_));return b},clearAllIntersections:function(){var g;for(g=0;g<this.intersectedEls.length;g++)this.intersectedEls[g].emit(m.INTERSECT_CLEAR,this.intersectedClearedDetail);y(this.clearedIntersectedEls,this.intersectedEls),this.intersectedEls.length=0,this.intersections.length=0,this.el.emit(m.INTERSECTION_CLEAR,this.intersectionClearedDetail)}});function y(g,_){var x;for(g.length=_.length,x=0;x<_.length;x++)g[x]=_[x]}},{"../core/component":136,"../lib/three":184,"../utils/":212}],101:[function(n,i,o){var s=n("../lib/three").Math.degToRad,c=n("../core/component").registerComponent;i.exports.Component=c("rotation",{schema:{type:"vec3"},update:function(){var u=this.data,h=this.el.object3D;h.rotation.set(s(u.x),s(u.y),s(u.z)),h.rotation.order="YXZ"},remove:function(){this.el.object3D.rotation.set(0,0,0)}})},{"../core/component":136,"../lib/three":184}],102:[function(n,i,o){var s=n("../core/component").registerComponent,c=1e-5;i.exports.Component=s("scale",{schema:{type:"vec3",default:{x:1,y:1,z:1}},update:function(){var u=this.data,h=this.el.object3D,f=u.x===0?c:u.x,p=u.y===0?c:u.y,m=u.z===0?c:u.z;h.scale.set(f,p,m)},remove:function(){this.el.object3D.scale.set(1,1,1)}})},{"../core/component":136}],103:[function(n,i,o){var s="data:image/webp;base64,UklGRkQHAABXRUJQVlA4WAoAAAAQAAAA/wEA/wEAQUxQSL0DAAARDzD/ERGCjrY9sYYFfgo6aa1kJ7K0w9Lo3AadLSVeFxevQwj5kuM8RfR/Atw/C0+ozB/oUBrloFZs6ElSW88j1KA4yExNWQaqRZquIDF0JYmlq0hAuUDTFu66tng3teW7pa3cQf1V1edvur54M/Slm6Wv3Gx9zw0MXlQLntcsBN6wkHjTQuYtC4W3LTw8mGRVG57TbAROtxHfZNhInGkjc5aNwtk2Hg6Mvki14k+NkZzCwQgCxalcAv3kddRTPI1DcUrXId1FLf1uHpzaQz4tquhZVLlKesbVpqKeTj0n0F5PpXDlFN9UqmhalL/ImuZFo6KmToWLoKlddMprqlS8cKovBvHo2kTiFV2LN4msaxKZl3QNiair8xYRdDWivIvXVXmbcMqJ51UebZuFXxZt6xd4laxtciqRtA3Cv0nU1t+kEUFbI8JvCa+tvkm3FDlO/W+OR99+kWEp/YYo+tYfTVnf/K8cE/F///3vv//993eeL+a+uvjawLcX3xjYvJotBFY3kVjTRGFtE+BU2AiMbiQyhpHMWEYeBozAH5qNBYRDB5KBCaTDBKKBAZTDBoKBDjwHAN5ABeCJBsAZcAAC0YHHxAYSMYBiYgGZWEA2MYFCbCCZGAAIANFEB+AnYgMQTDQAYSJ2AN5EBZAm4gDgTDgAeSIu4DGygTIRN1CMLOCZiACykQlg4jsAycgA8AO+BxCNdJyDkcbwRirDGXGnx8w+FDPrkM3MQ9JQZMYhiiwV/RDMtIM3U1/DmXHUo+IR2kSR2ToWkQ1NIn2qf2J8LCqJKiDUiSADHY3whirhdHgZ94HKaR97PhE+twEUJUFoAcgyTct8hfSxSkShASDKdMJ/ritKHwgyQ0sD4D/miCxU5SbhOOUDTnZpccCjYP/i0bZ/8bAgtVGEoGapWIQXyzKVKLwgNJFk2rtMIgoNRJlOZF7SNSSyUEeQmbxBFKEmtYjEe8S8zOZ1AkJVCmS88FJOtF40Ksg4oUaFiygk3C8qlTVNyl8UTevCUdAE2t14PfVqU1FPp57TopKeQZWromddTQp6QOfTOEQt/ZDuipZ11w/wOiqO8dRORcc6BQEkDQMClaHcn5wV9yLbxsNZNgpn2sicYSNxuo34Js1G4FQbnuNsOPa28PCWhcKbFjJvWEi8ZiHwqgXPcxbc5db33Cx95WboSzddX7yp+vyN0+eul7ZyN7Xlu64t3jVt4c5pc4JLV5EYupJE0xUknC4nOjVlmaYpyLit53HCQ0+ScnqceNcS5dzUkd0/CwMAVlA4IGADAAAQXwCdASoAAgACP8ne6Wy/tjCpqJ/IA/A5CWlu4XYBG/Pz8AfwD8APz//f3v8E1fuHZnxKYACtfuHZnxKYACrYTb5mOslhxu843ecbvON3nG7zjd3a0VCn7G1MABVxwH/Xd25gAK1+4dmfEpe2+PHhQaj75++riG6FuYACtfuHZnxKYACRrK3q9xO8Ss3uWKnMhs/rDF1hi6wxdYYusMXWGI5QRcCFDZog5OgqNlse1NDuz/UoFa/cOzPiUwAEsAOK4/nu5eZHK2tlXxJfNYlMABWv3Dsz4bvNJ5YA/LtxJ38SmAArX7h2Z8Sk5vdZUYv7mZPiUwAFa/cOzPh21s5OgZxf1mfEpemRyFr/rM+JS9noA/LtxJ38SmAAlUJIotzAASn6TjdhK+D3Dsz4dyvB7h2Z8O2tnJ0DOL+sz4lL2nKLT4lL/+iSLOocxq639w7M34MNZdm55uJ8v8ra2cpVZnxKTq2F3PN/cNksAfl24k7+JTAASqrD37h2Z7b1W+VtbOUqsz4lJ1bC7nm/uGyWAPy7cSd/EpgAJVVh79w7M9t6rfK2tnKVWZ8Sk6thdzzf3DZLAH5duJO/iUwAEqqw9+4dme29VvlbWzlKrM+JSdWwu55v7hslgD8u3EnfxKYACVVYe/cOzPbeq3ytrZylVme0kYJ8557FLerqFrzIbPrrf3DZLAH5duJO/iUvaVMS9BoaF4p7pSDFTP1XMyfElelrM0DOL+sz4eBJ13nV1OppBGPuKb4YzXQgq9uH19uS/0+JS9t9fr6ZUlQBelDG6GMgq97otb5QMPJwtKyBTbFp8Sl7b6/X0ykkawEOsgdiE6Fi0vb/Eve6xkwsmug0Z4nGNHQO8839bpTsjpz7SWIJxKagvd1QWMa6FYT1KEw3j4XDT6vJ9Xk+nyfT5Pq8n1eEmk5dinMM/9Fcfz4Z3Dsz3KD2dw7LxBRxKrqUUGQPH/7zxr1KIfNpLEJ0MZB2ITM/0Z2EFoh12NlXnEcpYcbvON3nG7zjd5xu84vfcNIAAP7+y8ceyzbVxkakPYY4lcr72fqOnDwipv+yxC71wAADBrjKnAAAAAAAAAAAAAAw7oNGHttqWONcoFN/2WIDc2pa6WVFtFYROlsaMaTXdcOjXHz93+YxAglKa4AAAAA=",c=n("../../core/component").registerComponent,u=n("../../lib/three"),h=21,f=function(){var g=new u.Quaternion,_=new u.Vector3;function x(b,E,T){E.position.copy(b.transform.position),E.quaternion.copy(b.transform.orientation),_.copy(T),g.copy(b.transform.orientation),_.applyQuaternion(g),E.position.sub(_)}return x}();f.tempFakePose={transform:{orientation:new u.Quaternion,position:new u.Vector3}};function p(g,_){this.renderer=g,this.xrHitTestSource=null,g.xr.addEventListener("sessionend",function(){this.xrHitTestSource=null}.bind(this)),g.xr.addEventListener("sessionstart",function(){this.sessionStart(_)}.bind(this)),this.renderer.xr.isPresenting&&this.sessionStart(_)}p.prototype.previousFrameAnchors=new Set,p.prototype.anchorToObject3D=new Map;function m(g){console.warn(g.message),console.warn('Cannot requestHitTestSource Are you missing: webxr="optionalFeatures: hit-test;" from <a-scene>?')}p.prototype.sessionStart=function(_){if(this.session=this.renderer.xr.getSession(),!("requestHitTestSource"in this.session)){m({message:"No requestHitTestSource on the session."});return}_.space?this.session.requestHitTestSource(_).then(function(x){this.xrHitTestSource=x}.bind(this)).catch(m):_.profile&&this.session.requestHitTestSourceForTransientInput(_).then(function(x){this.xrHitTestSource=x,this.transient=!0}.bind(this)).catch(m)},p.prototype.anchorFromLastHitTestResult=function(g,_){var x=this.lastHitTest;if(!!x){var b={object3D:g,offset:_};Array.from(this.anchorToObject3D.entries()).forEach(function(E){var T=E[1].object3D,P=E[0];T===g&&(this.anchorToObject3D.delete(P),P.delete())}.bind(this)),x.createAnchor&&x.createAnchor().then(function(E){this.anchorToObject3D.set(E,b)}.bind(this)).catch(function(E){console.warn(E.message),console.warn('Cannot create anchor, are you missing: webxr="optionalFeatures: anchors;" from <a-scene>?')})}},p.prototype.doHit=function(_){if(!!this.renderer.xr.isPresenting){var x=this.renderer.xr.getReferenceSpace(),b=_.getViewerPose(x),E,T;if(this.xrHitTestSource&&b)return this.transient?(E=_.getHitTestResultsForTransientInput(this.xrHitTestSource),E.length>0?(T=E[0].results,T.length>0?(this.lastHitTest=T[0],T[0].getPose(x)):!1):!1):(E=_.getHitTestResults(this.xrHitTestSource),E.length>0?(this.lastHitTest=E[0],E[0].getPose(x)):!1)}},p.updateAnchorPoses=function(g,_){var x=g.trackedAnchors||p.prototype.previousFrameAnchors;p.prototype.previousFrameAnchors.forEach(function(b){x.has(b)||p.prototype.anchorToObject3D.delete(b)}),x.forEach(function(b){var E,T,P,D;try{E=g.getPose(b.anchorSpace,_)}catch{}E&&(T=p.prototype.anchorToObject3D.get(b),P=T.offset,D=T.object3D,f(E,D,P))})};var y;i.exports.Component=c("ar-hit-test",{schema:{target:{type:"selector"},enabled:{default:!0},src:{default:s,type:"map"},type:{default:"footprint",oneOf:["footprint","map"]},footprintDepth:{default:.1},mapSize:{type:"vec2",default:{x:.5,y:.5}}},init:function(){this.hitTest=null,this.imageDataArray=new Uint8ClampedArray(512*512*4),this.imageData=new ImageData(this.imageDataArray,512,512),this.textureCache=new Map,this.orthoCam=new u.OrthographicCamera,this.orthoCam.layers.set(h),this.textureTarget=new u.WebGLRenderTarget(512,512,{}),this.basicMaterial=new u.MeshBasicMaterial({color:0,side:u.DoubleSide}),this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.context.imageSmoothingEnabled=!1,this.canvas.width=512,this.canvas.height=512,this.canvasTexture=new u.CanvasTexture(this.canvas,{alpha:!0}),this.canvasTexture.flipY=!1;var g=this.el.getAttribute("webxr"),_=g.optionalFeatures;(!_.includes("hit-test")||!_.includes("anchors"))&&(_.push("hit-test"),_.push("anchors"),this.el.setAttribute("webxr",g)),this.el.sceneEl.renderer.xr.addEventListener("sessionend",function(){this.hitTest=null}.bind(this)),this.el.sceneEl.renderer.xr.addEventListener("sessionstart",function(){if(!!this.el.is("ar-mode")){var x=this.el.sceneEl.renderer,b=this.session=x.xr.getSession();this.hasPosedOnce=!1,this.bboxMesh.visible=!1,y||(y=new Map),b.requestReferenceSpace("viewer").then(function(P){this.hitTest=new p(x,{space:P}),y.set(P,this.hitTest),this.el.emit("ar-hit-test-start")}.bind(this));var E="generic-touchscreen",T=new p(x,{profile:E});b.addEventListener("selectstart",function(P){if(this.data.enabled===!0){var D=P.inputSource;this.bboxMesh.visible=!0,this.hasPosedOnce===!0&&(this.el.emit("ar-hit-test-select-start",{inputSource:D,position:this.bboxMesh.position,orientation:this.bboxMesh.quaternion}),D.profiles[0]===E?this.hitTest=T:(this.hitTest=y.get(D)||new p(x,{space:D.targetRaySpace}),y.set(D,this.hitTest)))}}.bind(this)),b.addEventListener("selectend",function(P){if(!this.hitTest||this.data.enabled!==!0){this.hitTest=null;return}var D=P.inputSource,F;this.hasPosedOnce===!0&&(this.bboxMesh.visible=!1,this.data.target&&(F=this.data.target.object3D,F&&(f.tempFakePose.transform.position.copy(this.bboxMesh.position),f.tempFakePose.transform.orientation.copy(this.bboxMesh.quaternion),f(f.tempFakePose,F,this.bboxOffset),F.visible=!0,this.hitTest.anchorFromLastHitTestResult(F,this.bboxOffset))),this.el.emit("ar-hit-test-select",{inputSource:D,position:this.bboxMesh.position,orientation:this.bboxMesh.quaternion})),this.hitTest=null}.bind(this))}}.bind(this)),this.bboxOffset=new u.Vector3,this.update=this.update.bind(this),this.makeBBox()},update:function(){this.data.target&&(this.data.target.object3D?(this.data.target.addEventListener("model-loaded",this.update),this.data.target.object3D.layers.enable(h),this.data.target.object3D.traverse(function(g){g.layers.enable(h)})):this.data.target.addEventListener("loaded",this.update,{once:!0})),this.bboxNeedsUpdate=!0},makeBBox:function(){var g=new u.PlaneGeometry(1,1),_=new u.MeshBasicMaterial({transparent:!0,color:16777215});g.rotateX(-Math.PI/2),g.rotateY(-Math.PI/2),this.bbox=new u.Box3,this.bboxMesh=new u.Mesh(g,_),this.el.setObject3D("ar-hit-test",this.bboxMesh),this.bboxMesh.visible=!1},updateFootprint:function(){var g,_=this.el.sceneEl.renderer,x,b,E=_.xr.enabled;this.bboxMesh.material.map=this.canvasTexture,this.bboxMesh.material.needsUpdate=!0,this.orthoCam.rotation.set(-Math.PI/2,0,-Math.PI/2),this.orthoCam.position.copy(this.bboxMesh.position),this.orthoCam.position.y-=this.bboxMesh.scale.y/2,this.orthoCam.near=.1,this.orthoCam.far=this.orthoCam.near+this.data.footprintDepth*this.bboxMesh.scale.y,this.orthoCam.position.y+=this.orthoCam.far,this.orthoCam.right=this.bboxMesh.scale.z/2,this.orthoCam.left=-this.bboxMesh.scale.z/2,this.orthoCam.top=this.bboxMesh.scale.x/2,this.orthoCam.bottom=-this.bboxMesh.scale.x/2,this.orthoCam.updateProjectionMatrix(),x=_.getRenderTarget(),_.setRenderTarget(this.textureTarget),_.xr.enabled=!1,b=this.el.object3D.background,this.el.object3D.overrideMaterial=this.basicMaterial,this.el.object3D.background=null,_.render(this.el.object3D,this.orthoCam),this.el.object3D.background=b,this.el.object3D.overrideMaterial=null,_.xr.enabled=E,_.setRenderTarget(x),_.readRenderTargetPixels(this.textureTarget,0,0,512,512,this.imageDataArray),this.context.putImageData(this.imageData,0,0),this.context.shadowColor="white",this.context.shadowBlur=10,this.context.drawImage(this.canvas,0,0),g=this.context.getImageData(0,0,512,512);for(var T=0;T<512*512;T++)g.data[T*4+3]!==0&&g.data[T*4+3]!==255&&(g.data[T*4+3]=128);this.context.putImageData(g,0,0),this.canvasTexture.needsUpdate=!0},tick:function(){var g,_=this.el.sceneEl.frame,x=this.el.sceneEl.renderer;if(_&&p.updateAnchorPoses(_,x.xr.getReferenceSpace()),this.bboxNeedsUpdate){if(this.bboxNeedsUpdate=!1,!this.data.target||this.data.type==="map"){var b;this.textureCache.has(this.data.src)?b=this.textureCache.get(this.data.src):(b=new u.TextureLoader().load(this.data.src),this.textureCache.set(this.data.src,b)),this.bboxMesh.material.map=b,this.bboxMesh.material.needsUpdate=!0}this.data.target&&this.data.target.object3D?(this.bbox.setFromObject(this.data.target.object3D),this.bbox.getCenter(this.bboxMesh.position),this.bbox.getSize(this.bboxMesh.scale),this.data.type==="footprint"&&(this.bboxMesh.scale.x*=1.04,this.bboxMesh.scale.z*=1.04,this.updateFootprint()),this.bboxMesh.position.y-=this.bboxMesh.scale.y/2,this.bboxOffset.copy(this.bboxMesh.position),this.bboxOffset.sub(this.data.target.object3D.position)):this.bboxMesh.scale.set(this.data.mapSize.x,1,this.data.mapSize.y)}this.hitTest&&(g=this.hitTest.doHit(_),g&&(this.hasPosedOnce!==!0&&(this.hasPosedOnce=!0,this.el.emit("ar-hit-test-achieved")),this.bboxMesh.visible=!0,this.bboxMesh.position.copy(g.transform.position),this.bboxMesh.quaternion.copy(g.transform.orientation)))}})},{"../../core/component":136,"../../lib/three":184}],104:[function(n,i,o){var s=n("../../core/component").registerComponent,c=n("../../core/component").components;i.exports.Component=s("background",{schema:{color:{type:"color",default:"black"},transparent:{default:!1}},update:function(){var u=this.data,h=this.el.object3D;u.transparent?h.background=null:h.background=new THREE.Color(u.color)},remove:function(){var u=this.data,h=this.el.object3D;if(u.transparent){h.background=null;return}h.background=c[this.name].schema.color.default}})},{"../../core/component":136}],105:[function(n,i,o){var s=n("../../core/component").registerComponent;i.exports.Component=s("debug",{schema:{default:!0}})},{"../../core/component":136}],106:[function(n,i,o){var s=n("../../core/component").registerComponent,c=n("../../utils/"),u=c.bind,h=n("../../constants/"),f="a-modal",p="a-dialog",m="a-dialog-text",y="a-dialog-text-container",g="a-dialog-buttons-container",_="a-dialog-button",x="a-dialog-allow-button",b="a-dialog-deny-button",E="a-dialog-ok-button";i.exports.Component=s("device-orientation-permission-ui",{schema:{enabled:{default:!0},deviceMotionMessage:{default:"This immersive website requires access to your device motion sensors."},httpsMessage:{default:"Access this site over HTTPS to enter VR mode and grant access to the device sensors."},denyButtonText:{default:"Deny"},allowButtonText:{default:"Allow"},cancelButtonText:{default:"Cancel"}},init:function(){var F=this;if(!!this.data.enabled){if(location.hostname!=="localhost"&&location.hostname!=="127.0.0.1"&&location.protocol==="http:"&&this.showHTTPAlert(),typeof DeviceOrientationEvent=="undefined"||!DeviceOrientationEvent.requestPermission){this.permissionGranted=!0;return}this.onDeviceMotionDialogAllowClicked=u(this.onDeviceMotionDialogAllowClicked,this),this.onDeviceMotionDialogDenyClicked=u(this.onDeviceMotionDialogDenyClicked,this),DeviceOrientationEvent.requestPermission().catch(function(){F.devicePermissionDialogEl=T(F.data.denyButtonText,F.data.allowButtonText,F.data.deviceMotionMessage,F.onDeviceMotionDialogAllowClicked,F.onDeviceMotionDialogDenyClicked),F.el.appendChild(F.devicePermissionDialogEl)}).then(function(){F.el.emit("deviceorientationpermissiongranted"),F.permissionGranted=!0})}},remove:function(){this.devicePermissionDialogEl&&this.el.removeChild(this.devicePermissionDialogEl)},onDeviceMotionDialogDenyClicked:function(){this.remove()},showHTTPAlert:function(){var F=this,k=P(F.data.cancelButtonText,F.data.httpsMessage,function(){F.el.removeChild(k)});this.el.appendChild(k)},onDeviceMotionDialogAllowClicked:function(){var F=this;this.el.emit("deviceorientationpermissionrequested"),DeviceOrientationEvent.requestPermission().then(function(k){k==="granted"?(F.el.emit("deviceorientationpermissiongranted"),F.permissionGranted=!0):F.el.emit("deviceorientationpermissionrejected"),F.remove()}).catch(console.error)}});function T(F,k,W,j,J){var de,te,N;return de=document.createElement("div"),de.classList.add(g),te=document.createElement("button"),te.classList.add(_,b),te.setAttribute(h.AFRAME_INJECTED,""),te.innerHTML=F,de.appendChild(te),N=document.createElement("button"),N.classList.add(_,x),N.setAttribute(h.AFRAME_INJECTED,""),N.innerHTML=k,de.appendChild(N),N.addEventListener("click",function(L){L.stopPropagation(),j()}),te.addEventListener("click",function(L){L.stopPropagation(),J()}),D(W,de)}function P(F,k,W){var j,J;return j=document.createElement("div"),j.classList.add(g),J=document.createElement("button"),J.classList.add(_,E),J.setAttribute(h.AFRAME_INJECTED,""),J.innerHTML=F,j.appendChild(J),J.addEventListener("click",function(de){de.stopPropagation(),W()}),D(k,j)}function D(F,k){var W,j,J,de;return W=document.createElement("div"),W.classList.add(f),W.setAttribute(h.AFRAME_INJECTED,""),j=document.createElement("div"),j.className=p,j.setAttribute(h.AFRAME_INJECTED,""),W.appendChild(j),J=document.createElement("div"),J.classList.add(y),j.appendChild(J),de=document.createElement("div"),de.classList.add(m),de.innerHTML=F,J.appendChild(de),j.appendChild(k),W}},{"../../constants/":128,"../../core/component":136,"../../utils/":212}],107:[function(n,i,o){var s=n("../../core/component").registerComponent;i.exports.Component=s("embedded",{dependencies:["vr-mode-ui"],schema:{default:!0},update:function(){var c=this.el,u=c.querySelector(".a-enter-vr");this.data===!0?(u&&u.classList.add("embedded"),c.removeFullScreenStyles()):(u&&u.classList.remove("embedded"),c.addFullScreenStyles())}})},{"../../core/component":136}],108:[function(n,i,o){var s=n("../../core/component").registerComponent,c=n("../../lib/three"),u=n("../../utils/debug"),h=u("components:fog:warn");i.exports.Component=s("fog",{schema:{color:{type:"color",default:"#000"},density:{default:25e-5},far:{default:1e3,min:0},near:{default:1,min:0},type:{default:"linear",oneOf:["linear","exponential"]}},update:function(){var p=this.data,m=this.el,y=this.el.object3D.fog;if(!m.isScene){h("Fog component can only be applied to <a-scene>");return}if(!y||p.type!==y.name){m.object3D.fog=f(p),m.systems.material.updateMaterials();return}Object.keys(this.schema).forEach(function(g){var _=p[g];g==="color"&&(_=new c.Color(_)),y[g]=_})},remove:function(){var p=this.el.object3D.fog;!p||(p.far=0,p.near=.1)}});function f(p){var m;return p.type==="exponential"?m=new c.FogExp2(p.color,p.density):m=new c.Fog(p.color,p.near,p.far),m.name=p.type,m}},{"../../core/component":136,"../../lib/three":184,"../../utils/debug":208}],109:[function(n,i,o){(function(s){var c=n("../../constants").AFRAME_INJECTED,u=n("../../../package"),h=n("../../core/component").registerComponent,f=n("../../utils/");function p(b){var E=b.split(".");return E[2]="x",E.join(".")}var m="https://aframe.io/aframe-inspector/dist/aframe-inspector.js",y="https://unpkg.com/aframe-inspector@"+p(u.version)+"/dist/aframe-inspector.min.js",g={}.INSPECTOR_VERSION==="dev"?m:y,_="Loading Inspector",x="Error loading Inspector";i.exports.Component=h("inspector",{schema:{url:{default:g}},init:function(){this.firstPlay=!0,this.onKeydown=this.onKeydown.bind(this),this.onMessage=this.onMessage.bind(this),this.initOverlay(),window.addEventListener("keydown",this.onKeydown),window.addEventListener("message",this.onMessage)},play:function(){var b;!this.firstPlay||(b=f.getUrlParameter("inspector"),b!=="false"&&!!b&&(this.openInspector(),this.firstPlay=!1))},initOverlay:function(){var b='<span class="dots"><span>.</span><span>.</span><span>.</span></span>';this.loadingMessageEl=document.createElement("div"),this.loadingMessageEl.classList.add("a-inspector-loader"),this.loadingMessageEl.innerHTML=_+b},remove:function(){this.removeEventListeners()},onKeydown:function(b){var E=b.keyCode===73&&(b.ctrlKey&&b.altKey||b.getModifierState("AltGraph"));!E||this.openInspector()},showLoader:function(){document.body.appendChild(this.loadingMessageEl)},hideLoader:function(){document.body.removeChild(this.loadingMessageEl)},onMessage:function(b){b.data==="INJECT_AFRAME_INSPECTOR"&&this.openInspector()},openInspector:function(b){var E=this,T;if(AFRAME.INSPECTOR||AFRAME.inspectorInjected){AFRAME.INSPECTOR.open(b);return}this.showLoader(),T=document.createElement("script"),T.src=this.data.url,T.setAttribute("data-name","aframe-inspector"),T.setAttribute(c,""),T.onload=function(){AFRAME.INSPECTOR.open(b),E.hideLoader(),E.removeEventListeners()},T.onerror=function(){E.loadingMessageEl.innerHTML=x},document.head.appendChild(T),AFRAME.inspectorInjected=!0},removeEventListeners:function(){window.removeEventListener("keydown",this.onKeydown),window.removeEventListener("message",this.onMessage)}})}).call(this,n("_process"))},{"../../../package":74,"../../constants":128,"../../core/component":136,"../../utils/":212,_process:49}],110:[function(n,i,o){var s=n("../../core/component").registerComponent,c=n("../../utils/").shouldCaptureKeyEvent;i.exports.Component=s("keyboard-shortcuts",{schema:{enterVR:{default:!0},exitVR:{default:!0}},init:function(){this.onKeyup=this.onKeyup.bind(this)},update:function(u){var h=this.data;this.enterVREnabled=h.enterVR},play:function(){window.addEventListener("keyup",this.onKeyup,!1)},pause:function(){window.removeEventListener("keyup",this.onKeyup)},onKeyup:function(u){var h=this.el;!c(u)||(this.enterVREnabled&&u.keyCode===70&&h.enterVR(),this.enterVREnabled&&u.keyCode===27&&h.exitVR())}})},{"../../core/component":136,"../../utils/":212}],111:[function(n,i,o){var s=n("../../utils/debug"),c=n("../../core/component").registerComponent,u=s("components:pool:warn");i.exports.Component=c("pool",{schema:{container:{default:""},mixin:{default:""},size:{default:0},dynamic:{default:!1}},multiple:!0,initPool:function(){var h;for(this.availableEls=[],this.usedEls=[],this.data.mixin||u("No mixin provided for pool component."),this.data.container&&(this.container=document.querySelector(this.data.container),this.container||u("Container "+this.data.container+" not found.")),this.container=this.container||this.el,h=0;h<this.data.size;++h)this.createEntity()},update:function(h){var f=this.data;(h.mixin!==f.mixin||h.size!==f.size)&&this.initPool()},createEntity:function(){var h;h=document.createElement("a-entity"),h.play=this.wrapPlay(h.play),h.setAttribute("mixin",this.data.mixin),h.object3D.visible=!1,h.pause(),this.container.appendChild(h),this.availableEls.push(h)},wrapPlay:function(h){var f=this.usedEls;return function(){f.indexOf(this)!==-1&&h.call(this)}},requestEntity:function(){var h;if(this.availableEls.length===0){if(this.data.dynamic===!1){u("Requested entity from empty pool: "+this.attrName);return}else u("Requested entity from empty pool. This pool is dynamic and will resize automatically. You might want to increase its initial size: "+this.attrName);this.createEntity()}return h=this.availableEls.shift(),this.usedEls.push(h),h.object3D.visible=!0,h},returnEntity:function(h){var f=this.usedEls.indexOf(h);if(f===-1){u("The returned entity was not previously pooled from "+this.attrName);return}return this.usedEls.splice(f,1),this.availableEls.push(h),h.object3D.visible=!1,h.pause(),h}})},{"../../core/component":136,"../../utils/debug":208}],112:[function(n,i,o){var s=n("../../core/component").registerComponent;function c(u,h,f,p){var m=Math.max(u.primaryLightIntensity.x,Math.max(u.primaryLightIntensity.y,u.primaryLightIntensity.z));h.sh.fromArray(u.sphericalHarmonicsCoefficients),h.intensity=1,f&&(f.color.setRGB(u.primaryLightIntensity.x/m,u.primaryLightIntensity.y/m,u.primaryLightIntensity.z/m),f.intensity=m,p.copy(u.primaryLightDirection))}i.exports.Component=s("reflection",{schema:{directionalLight:{type:"selector"}},init:function(){var u=this;this.cubeRenderTarget=new THREE.WebGLCubeRenderTarget(16),this.cubeCamera=new THREE.CubeCamera(.1,1e3,this.cubeRenderTarget),this.lightingEstimationTexture=new THREE.WebGLCubeRenderTarget(16).texture,this.needsVREnvironmentUpdate=!0;var h=this.el.getAttribute("webxr"),f=h.optionalFeatures;f.includes("light-estimation")||(f.push("light-estimation"),this.el.setAttribute("webxr",h)),this.el.addEventListener("enter-vr",function(){var p=u.el.renderer,m=p.xr.getSession();m.requestLightProbe&&u.el.is("ar-mode")&&u.startLightProbe()}),this.el.addEventListener("exit-vr",function(){u.stopLightProbe()}),this.el.object3D.environment=this.cubeRenderTarget.texture},stopLightProbe:function(){this.xrLightProbe=null,this.probeLight&&(this.probeLight.components.light.light.intensity=0),this.needsVREnvironmentUpdate=!0,this.el.object3D.environment=this.cubeRenderTarget.texture},startLightProbe:function(){this.needsLightProbeUpdate=!0},setupLightProbe:function(){var u=this.el.renderer,h=u.xr.getSession(),f=this,p=u.getContext();if(!this.probeLight){var m=document.createElement("a-light");m.setAttribute("type","probe"),m.setAttribute("intensity",0),this.el.appendChild(m),this.probeLight=m}switch(h.preferredReflectionFormat){case"srgba8":p.getExtension("EXT_sRGB");break;case"rgba16f":p.getExtension("OES_texture_half_float");break}this.glBinding=new XRWebGLBinding(h,p),p.getExtension("EXT_sRGB"),p.getExtension("OES_texture_half_float"),h.requestLightProbe().then(function(y){f.xrLightProbe=y,y.addEventListener("reflectionchange",f.updateXRCubeMap.bind(f))}).catch(function(y){console.warn("Lighting estimation not supported: "+y.message),console.warn('Are you missing: webxr="optionalFeatures: light-estimation;" from <a-scene>?')})},updateXRCubeMap:function(){var u=this.el.renderer,h=this.glBinding.getReflectionCubeMap(this.xrLightProbe);if(h){var f=u.properties.get(this.lightingEstimationTexture);f.__webglTexture=h,this.lightingEstimationTexture.needsPMREMUpdate=!0,this.el.object3D.environment=this.lightingEstimationTexture}},tick:function(){var u=this.el.object3D,h=this.el.renderer,f=this.el.frame;if(f&&this.xrLightProbe){var p=f.getLightEstimate(this.xrLightProbe);p&&c(p,this.probeLight.components.light.light,this.data.directionalLight&&this.data.directionalLight.components.light.light,this.data.directionalLight&&this.data.directionalLight.object3D.position)}this.needsVREnvironmentUpdate&&(u.environment=null,this.needsVREnvironmentUpdate=!1,this.cubeCamera.position.set(0,1.6,0),this.cubeCamera.update(h,u),this.el.object3D.environment=this.cubeRenderTarget.texture),this.needsLightProbeUpdate&&f&&(this.setupLightProbe(),this.needsLightProbeUpdate=!1)},remove:function(){this.el.object3D.environment=null,this.removeChild(this.probeLight)}})},{"../../core/component":136}],113:[function(n,i,o){var s=n("../../core/component").registerComponent,c=n("../../lib/three"),u=["attribute vec3 position;","attribute vec2 uv;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUv;","void main()  {","  vUv = vec2( 1.- uv.x, uv.y );","  gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join(`
`),h=["precision mediump float;","uniform samplerCube map;","varying vec2 vUv;","#define M_PI 3.141592653589793238462643383279","void main() {","  vec2 uv = vUv;","  float longitude = uv.x * 2. * M_PI - M_PI + M_PI / 2.;","  float latitude = uv.y * M_PI;","  vec3 dir = vec3(","    - sin( longitude ) * sin( latitude ),","    cos( latitude ),","    - cos( longitude ) * sin( latitude )","  );","  normalize( dir );","  gl_FragColor = vec4( textureCube( map, dir ).rgb, 1.0 );","}"].join(`
`);i.exports.Component=s("screenshot",{schema:{width:{default:4096},height:{default:2048},camera:{type:"selector"}},init:function(){var f=this.el,p=this;f.renderer?m():f.addEventListener("render-target-loaded",m);function m(){var y=f.renderer.getContext();!y||(p.cubeMapSize=y.getParameter(y.MAX_CUBE_MAP_TEXTURE_SIZE),p.material=new c.RawShaderMaterial({uniforms:{map:{type:"t",value:null}},vertexShader:u,fragmentShader:h,side:c.DoubleSide}),p.quad=new c.Mesh(new c.PlaneBufferGeometry(1,1),p.material),p.quad.visible=!1,p.camera=new c.OrthographicCamera(-1/2,1/2,1/2,-1/2,-1e4,1e4),p.canvas=document.createElement("canvas"),p.ctx=p.canvas.getContext("2d"),f.object3D.add(p.quad),p.onKeyDown=p.onKeyDown.bind(p))}},getRenderTarget:function(f,p){return new c.WebGLRenderTarget(f,p,{encoding:c.sRGBEncoding,minFilter:c.LinearFilter,magFilter:c.LinearFilter,wrapS:c.ClampToEdgeWrapping,wrapT:c.ClampToEdgeWrapping,format:c.RGBAFormat,type:c.UnsignedByteType})},resize:function(f,p){this.quad.scale.set(f,p,1),this.camera.left=-1*f/2,this.camera.right=f/2,this.camera.top=p/2,this.camera.bottom=-1*p/2,this.camera.updateProjectionMatrix(),this.canvas.width=f,this.canvas.height=p},play:function(){window.addEventListener("keydown",this.onKeyDown)},onKeyDown:function(f){var p=f.keyCode===83&&f.ctrlKey&&f.altKey;if(!(!this.data||!p)){var m=f.shiftKey?"equirectangular":"perspective";this.capture(m)}},setCapture:function(f){var p=this.el,m,y,g,_;return f==="perspective"?(this.quad.visible=!1,y=this.data.camera&&this.data.camera.components.camera.camera||p.camera,m={width:this.data.width,height:this.data.height}):(y=this.camera,_=new c.WebGLCubeRenderTarget(Math.min(this.cubeMapSize,2048),{format:c.RGBFormat,generateMipmaps:!0,minFilter:c.LinearMipmapLinearFilter,encoding:c.sRGBEncoding}),g=new c.CubeCamera(p.camera.near,p.camera.far,_),p.camera.getWorldPosition(g.position),p.camera.getWorldQuaternion(g.quaternion),g.update(p.renderer,p.object3D),this.quad.material.uniforms.map.value=g.renderTarget.texture,m={width:this.data.width,height:this.data.height},this.quad.visible=!0),{camera:y,size:m,projection:f}},capture:function(f){var p=this.el.renderer.xr.enabled,m=this.el.renderer,y;m.xr.enabled=!1,y=this.setCapture(f),this.renderCapture(y.camera,y.size,y.projection),this.saveCapture(),m.xr.enabled=p},getCanvas:function(f){var p=this.el.renderer.xr.enabled,m=this.el.renderer,y=this.setCapture(f);return m.xr.enabled=!1,this.renderCapture(y.camera,y.size,y.projection),m.xr.enabled=p,this.canvas},renderCapture:function(f,p,m){var y=this.el.renderer.autoClear,g=this.el,_,x,b,E=g.renderer;x=this.getRenderTarget(p.width,p.height),b=new Uint8Array(4*p.width*p.height),this.resize(p.width,p.height),E.autoClear=!0,E.clear(),E.setRenderTarget(x),E.render(g.object3D,f),E.autoClear=y,E.readRenderTargetPixels(x,0,0,p.width,p.height,b),E.setRenderTarget(null),m==="perspective"&&(b=this.flipPixelsVertically(b,p.width,p.height)),_=new ImageData(new Uint8ClampedArray(b),p.width,p.height),this.quad.visible=!1,this.ctx.putImageData(_,0,0)},flipPixelsVertically:function(f,p,m){for(var y=f.slice(0),g=0;g<p;++g)for(var _=0;_<m;++_)y[g*4+_*p*4]=f[g*4+(m-_)*p*4],y[g*4+1+_*p*4]=f[g*4+1+(m-_)*p*4],y[g*4+2+_*p*4]=f[g*4+2+(m-_)*p*4],y[g*4+3+_*p*4]=f[g*4+3+(m-_)*p*4];return y},saveCapture:function(){this.canvas.toBlob(function(f){var p="screenshot-"+document.title.toLowerCase()+"-"+Date.now()+".png",m=document.createElement("a"),y=URL.createObjectURL(f);m.href=y,m.setAttribute("download",p),m.innerHTML="downloading...",m.style.display="none",document.body.appendChild(m),setTimeout(function(){m.click(),document.body.removeChild(m)},1)},"image/png")}})},{"../../core/component":136,"../../lib/three":184}],114:[function(n,i,o){var s=n("../../core/component").registerComponent,c=n("../../../vendor/rStats"),u=n("../../utils");n("../../../vendor/rStats.extras"),n("../../lib/rStatsAframe");var h=window.aframeStats,f=u.bind,p="a-hidden",m=window.threeStats;i.exports.Component=s("stats",{schema:{default:!0},init:function(){var g=this.el;u.getUrlParameter("stats")!=="false"&&(this.stats=y(g),this.statsEl=document.querySelector(".rs-base"),this.hideBound=f(this.hide,this),this.showBound=f(this.show,this),g.addEventListener("enter-vr",this.hideBound),g.addEventListener("exit-vr",this.showBound))},update:function(){if(!!this.stats)return this.data?this.show():this.hide()},remove:function(){this.el.removeEventListener("enter-vr",this.hideBound),this.el.removeEventListener("exit-vr",this.showBound),this.statsEl&&this.statsEl.parentNode.removeChild(this.statsEl)},tick:function(){var g=this.stats;!g||(g("rAF").tick(),g("FPS").frame(),g().update())},hide:function(){this.statsEl.classList.add(p)},show:function(){this.statsEl.classList.remove(p)}});function y(g){var _=new m(g.renderer),x=new h(g),b=g.isMobile?[]:[_,x];return new c({css:[],values:{fps:{caption:"fps",below:30}},groups:[{caption:"Framerate",values:["fps","raf"]}],plugins:b})}},{"../../../vendor/rStats":224,"../../../vendor/rStats.extras":223,"../../core/component":136,"../../lib/rStatsAframe":183,"../../utils":212}],115:[function(n,i,o){var s=n("../../core/component").registerComponent,c=n("../../constants/"),u=n("../../utils/"),h=u.bind,f="a-enter-vr",p="a-enter-ar",m="a-enter-vr-button",y="a-enter-ar-button",g="a-hidden",_="a-orientation-modal";i.exports.Component=s("vr-mode-ui",{dependencies:["canvas"],schema:{enabled:{default:!0},enterVRButton:{default:""},enterARButton:{default:""}},init:function(){var P=this,D=this.el;u.getUrlParameter("ui")!=="false"&&(this.insideLoader=!1,this.enterVREl=null,this.enterAREl=null,this.orientationModalEl=null,this.bindMethods(),D.addEventListener("enter-vr",this.updateEnterInterfaces),D.addEventListener("exit-vr",this.updateEnterInterfaces),D.addEventListener("update-vr-devices",this.updateEnterInterfaces),window.addEventListener("message",function(F){F.data.type==="loaderReady"&&(P.insideLoader=!0,P.remove())}),window.addEventListener("orientationchange",this.toggleOrientationModalIfNeeded))},bindMethods:function(){this.onEnterVRButtonClick=h(this.onEnterVRButtonClick,this),this.onEnterARButtonClick=h(this.onEnterARButtonClick,this),this.onModalClick=h(this.onModalClick,this),this.toggleOrientationModalIfNeeded=h(this.toggleOrientationModalIfNeeded,this),this.updateEnterInterfaces=h(this.updateEnterInterfaces,this)},onModalClick:function(){this.el.exitVR()},onEnterVRButtonClick:function(){this.el.enterVR()},onEnterARButtonClick:function(){this.el.enterAR()},update:function(){var P=this.data,D=this.el;if(!P.enabled||this.insideLoader||u.getUrlParameter("ui")==="false")return this.remove();this.enterVREl||this.enterAREl||this.orientationModalEl||(P.enterVRButton?(this.enterVREl=document.querySelector(P.enterVRButton),this.enterVREl.addEventListener("click",this.onEnterVRButtonClick)):(this.enterVREl=x(this.onEnterVRButtonClick),D.appendChild(this.enterVREl)),P.enterARButton?(this.enterAREl=document.querySelector(P.enterARButton),this.enterAREl.addEventListener("click",this.onEnterARButtonClick)):(this.enterAREl=b(this.onEnterARButtonClick),D.appendChild(this.enterAREl)),this.orientationModalEl=E(this.onModalClick),D.appendChild(this.orientationModalEl),this.updateEnterInterfaces())},remove:function(){[this.enterVREl,this.enterAREl,this.orientationModalEl].forEach(function(P){P&&P.parentNode&&P.parentNode.removeChild(P)}),this.enterVREl=void 0,this.enterAREl=void 0,this.orientationModalEl=void 0},updateEnterInterfaces:function(){this.toggleEnterVRButtonIfNeeded(),this.toggleEnterARButtonIfNeeded(),this.toggleOrientationModalIfNeeded()},toggleEnterVRButtonIfNeeded:function(){var P=this.el;!this.enterVREl||(P.is("vr-mode")?this.enterVREl.classList.add(g):this.enterVREl.classList.remove(g))},toggleEnterARButtonIfNeeded:function(){var P=this.el;!this.enterAREl||(P.is("vr-mode")||!u.device.checkARSupport()?this.enterAREl.classList.add(g):this.enterAREl.classList.remove(g))},toggleOrientationModalIfNeeded:function(){var P=this.el,D=this.orientationModalEl;!D||!P.isMobile||(!u.device.isLandscape()&&P.is("vr-mode")?D.classList.remove(g):D.classList.add(g))}});function x(P){var D,F;return F=document.createElement("div"),F.classList.add(f),F.setAttribute(c.AFRAME_INJECTED,""),D=document.createElement("button"),D.className=m,D.setAttribute("title","Enter VR mode with a headset or fullscreen mode on a desktop. Visit https://webvr.rocks or https://webvr.info for more information."),D.setAttribute(c.AFRAME_INJECTED,""),u.device.isMobile()&&T(D),F.appendChild(D),D.addEventListener("click",function(k){P(),k.stopPropagation()}),F}function b(P){var D,F;return F=document.createElement("div"),F.classList.add(p),F.setAttribute(c.AFRAME_INJECTED,""),D=document.createElement("button"),D.className=y,D.setAttribute("title","Enter AR mode with a headset or handheld device. Visit https://webvr.rocks or https://webvr.info for more information."),D.setAttribute(c.AFRAME_INJECTED,""),u.device.isMobile()&&T(D),F.appendChild(D),D.addEventListener("click",function(k){P(),k.stopPropagation()}),F}function E(P){var D=document.createElement("div");D.className=_,D.classList.add(g),D.setAttribute(c.AFRAME_INJECTED,"");var F=document.createElement("button");return F.setAttribute(c.AFRAME_INJECTED,""),F.innerHTML="Exit VR",F.addEventListener("click",P),D.appendChild(F),D}function T(P){P.addEventListener("touchstart",function(){P.classList.remove("resethover")}),P.addEventListener("touchend",function(){P.classList.add("resethover")})}},{"../../constants/":128,"../../core/component":136,"../../utils/":212}],116:[function(n,i,o){var s=n("../core/component"),c=n("../lib/three"),u=n("../utils/bind"),h=s.registerComponent;i.exports.Component=h("shadow",{schema:{cast:{default:!0},receive:{default:!0}},init:function(){this.onMeshChanged=u(this.update,this),this.el.addEventListener("object3dset",this.onMeshChanged),this.system.setShadowMapEnabled(!0)},update:function(){var f=this.data;this.updateDescendants(f.cast,f.receive)},remove:function(){var f=this.el;f.removeEventListener("object3dset",this.onMeshChanged),this.updateDescendants(!1,!1)},updateDescendants:function(f,p){var m=this.el.sceneEl;this.el.object3D.traverse(function(y){if(y instanceof c.Mesh&&(y.castShadow=f,y.receiveShadow=p,m.hasLoaded&&y.material))for(var g=Array.isArray(y.material)?y.material:[y.material],_=0;_<g.length;_++)g[_].needsUpdate=!0})}})},{"../core/component":136,"../lib/three":184,"../utils/bind":206}],117:[function(n,i,o){var s=n("../core/component").registerComponent,c=n("../utils/debug"),u=n("../lib/three"),h=c("components:sound:warn");i.exports.Component=s("sound",{schema:{autoplay:{default:!1},distanceModel:{default:"inverse",oneOf:["linear","inverse","exponential"]},loop:{default:!1},maxDistance:{default:1e4},on:{default:""},poolSize:{default:1},positional:{default:!0},refDistance:{default:1},rolloffFactor:{default:1},src:{type:"audio"},volume:{default:1}},multiple:!0,init:function(){var f=this;this.listener=null,this.audioLoader=new u.AudioLoader,this.pool=new u.Group,this.loaded=!1,this.mustPlay=!1,this.playSoundBound=function(){f.playSound()}},update:function(f){var p=this.data,m,y,g=p.src!==f.src;if(g){if(!p.src)return;this.setupSound()}for(m=0;m<this.pool.children.length;m++)y=this.pool.children[m],p.positional&&(y.setDistanceModel(p.distanceModel),y.setMaxDistance(p.maxDistance),y.setRefDistance(p.refDistance),y.setRolloffFactor(p.rolloffFactor)),y.setLoop(p.loop),y.setVolume(p.volume),y.isPaused=!1;if(p.on!==f.on&&this.updateEventListener(f.on),g){var _=this;this.loaded=!1,this.audioLoader.load(p.src,function(x){for(m=0;m<_.pool.children.length;m++)y=_.pool.children[m],y.setBuffer(x);_.loaded=!0,u.Cache.remove(p.src),(_.data.autoplay||_.mustPlay)&&_.playSound(),_.el.emit("sound-loaded",_.evtDetail,!1)})}},pause:function(){this.stopSound(),this.removeEventListener()},play:function(){this.data.autoplay&&this.playSound(),this.updateEventListener()},remove:function(){var f,p;this.removeEventListener(),this.el.getObject3D(this.attrName)&&this.el.removeObject3D(this.attrName);try{for(f=0;f<this.pool.children.length;f++)p=this.pool.children[f],p.disconnect()}catch{h("Audio source not properly disconnected")}},updateEventListener:function(f){var p=this.el;f&&p.removeEventListener(f,this.playSoundBound),p.addEventListener(this.data.on,this.playSoundBound)},removeEventListener:function(){this.el.removeEventListener(this.data.on,this.playSoundBound)},setupSound:function(){var f=this.el,p,m=f.sceneEl,y=this,g;this.pool.children.length>0&&(this.stopSound(),f.removeObject3D("sound"));var _=this.listener=m.audioListener||new u.AudioListener;for(m.audioListener=_,m.camera&&m.camera.add(_),m.addEventListener("camera-set-active",function(x){x.detail.cameraEl.getObject3D("camera").add(_)}),this.pool=new u.Group,p=0;p<this.data.poolSize;p++)g=this.data.positional?new u.PositionalAudio(_):new u.Audio(_),this.pool.add(g);for(f.setObject3D(this.attrName,this.pool),p=0;p<this.pool.children.length;p++)g=this.pool.children[p],g.onEnded=function(){this.isPlaying=!1,y.el.emit("sound-ended",y.evtDetail,!1)}},pauseSound:function(){var f,p;for(this.isPlaying=!1,f=0;f<this.pool.children.length;f++)p=this.pool.children[f],!(!p.source||!p.source.buffer||!p.isPlaying||p.isPaused)&&(p.isPaused=!0,p.pause())},playSound:function(f){var p,m,y;if(!this.loaded){h("Sound not loaded yet. It will be played once it finished loading"),this.mustPlay=!0;return}for(p=!1,this.isPlaying=!0,m=0;m<this.pool.children.length;m++)if(y=this.pool.children[m],!y.isPlaying&&y.buffer&&!p){f&&f(y),y.play(),y.isPaused=!1,p=!0;continue}if(!p){h("All the sounds are playing. If you need to play more sounds simultaneously consider increasing the size of pool with the `poolSize` attribute.",this.el);return}this.mustPlay=!1},stopSound:function(){var f,p;for(this.isPlaying=!1,f=0;f<this.pool.children.length;f++){if(p=this.pool.children[f],!p.source||!p.source.buffer)return;p.stop()}}})},{"../core/component":136,"../lib/three":184,"../utils/debug":208}],118:[function(n,i,o){var s=n("three-bmfont-text"),c=n("load-bmfont"),u=n("../core/component").registerComponent,h=n("../core/shader"),f=n("../lib/three"),p=n("../utils/"),m=p.debug("components:text:error"),y=h.shaders,g=p.debug("components:text:warn"),_=1,x=16,b="https://cdn.aframe.io/fonts/",E={aileronsemibold:b+"Aileron-Semibold.fnt",dejavu:b+"DejaVu-sdf.fnt",exo2bold:b+"Exo2Bold.fnt",exo2semibold:b+"Exo2SemiBold.fnt",kelsonsans:b+"KelsonSans.fnt",monoid:b+"Monoid.fnt",mozillavr:b+"mozillavr.fnt",roboto:b+"Roboto-msdf.json",sourcecodepro:b+"SourceCodePro.fnt"},T=["roboto"],P="roboto";i.exports.FONTS=E;var D=new M,F={},k={},W=/^\w+:/;i.exports.Component=u("text",{multiple:!0,schema:{align:{type:"string",default:"left",oneOf:["left","right","center"]},alphaTest:{default:.5},anchor:{default:"center",oneOf:["left","right","center","align"]},baseline:{default:"center",oneOf:["top","center","bottom"]},color:{type:"color",default:"#FFF"},font:{type:"string",default:P},fontImage:{type:"string"},height:{type:"number"},letterSpacing:{type:"number",default:0},lineHeight:{type:"number"},negate:{type:"boolean",default:!0},opacity:{type:"number",default:1},shader:{default:"sdf",oneOf:y},side:{default:"front",oneOf:["front","back","double"]},tabSize:{default:4},transparent:{default:!0},value:{type:"string"},whiteSpace:{default:"normal",oneOf:["normal","pre","nowrap"]},width:{type:"number"},wrapCount:{type:"number",default:40},wrapPixels:{type:"number"},xOffset:{type:"number",default:0},yOffset:{type:"number",default:0},zOffset:{type:"number",default:.001}},init:function(){this.shaderData={},this.geometry=s(),this.createOrUpdateMaterial()},update:function(I){var U=this.data,$=this.currentFont;if(k[U.font]?this.texture=k[U.font]:(this.texture=k[U.font]=new f.Texture,this.texture.anisotropy=x),this.createOrUpdateMaterial(),I.font!==U.font){this.updateFont();return}$&&(this.updateGeometry(this.geometry,$),this.updateLayout())},remove:function(){this.geometry.dispose(),this.geometry=null,this.el.removeObject3D(this.attrName),this.material.dispose(),this.material=null,this.texture.dispose(),this.texture=null,this.shaderObject&&delete this.shaderObject},createOrUpdateMaterial:function(){var I=this.data,U,$=this.material,ee,Q=this.shaderData,G;if(G=I.shader,T.indexOf(I.font)!==-1||I.font.indexOf("-msdf.")>=0?G="msdf":I.font in E&&T.indexOf(I.font)===-1&&(G="sdf"),U=(this.shaderObject&&this.shaderObject.name)!==G,Q.alphaTest=I.alphaTest,Q.color=I.color,Q.map=this.texture,Q.opacity=I.opacity,Q.side=j(I.side),Q.transparent=I.transparent,Q.negate=I.negate,!U){this.shaderObject.update(Q),$.transparent=Q.transparent,$.side=Q.side;return}ee=te(this.el,G,Q),this.material=ee.material,this.shaderObject=ee.shader,this.material.side=Q.side,this.mesh&&(this.mesh.material=this.material)},updateFont:function(){var I=this.data,U=this.el,$,ee=this.geometry,Q=this;I.font||g("No font specified. Using the default font."),this.mesh&&(this.mesh.visible=!1),$=this.lookupFont(I.font||P)||I.font,D.get($,function(){return J($,I.yOffset)}).then(function(K){var Y;if(K.pages.length!==1)throw new Error("Currently only single-page bitmap fonts are supported.");F[$]||(K.widthFactor=F[K]=L(K)),Q.currentFont=K,Y=Q.getFontImageSrc(),D.get(Y,function(){return de(Y)}).then(function(we){var Ke=Q.texture;Ke.image=we,Ke.needsUpdate=!0,k[I.font]=Ke,Q.texture=Ke,Q.initMesh(),Q.currentFont=K,Q.updateGeometry(ee,K),Q.updateLayout(),Q.mesh.visible=!0,U.emit("textfontset",{font:I.font,fontObj:K})}).catch(function(we){m(we.message),m(we.stack)})}).catch(function(G){m(G.message),m(G.stack)})},initMesh:function(){this.mesh||(this.mesh=new f.Mesh(this.geometry,this.material),this.el.setObject3D(this.attrName,this.mesh))},getFontImageSrc:function(){if(this.data.fontImage)return this.data.fontImage;var I=this.lookupFont(this.data.font||P)||this.data.font,U=this.currentFont.pages[0];return U.match(W)&&U.indexOf("http")!==0?I.replace(/(\.fnt)|(\.json)/,".png"):f.LoaderUtils.extractUrlBase(I)+U},updateLayout:function(){var I,U,$=this.el,ee=this.data,Q=this.geometry,G,K,Y,we=this.mesh,Ke,ge,me,De,ze;if(!(!we||!Q.layout)){if(G=$.getAttribute("geometry"),me=ee.width||G&&G.width||_,Ke=N(ee.wrapPixels,ee.wrapCount,this.currentFont.widthFactor),ge=me/Ke,Y=Q.layout,K=ge*(Y.height+Y.descender),G&&G.primitive==="plane"&&(G.width||$.setAttribute("geometry","width",me),G.height||$.setAttribute("geometry","height",K)),I=ee.anchor==="align"?ee.align:ee.anchor,I==="left")De=0;else if(I==="right")De=-1*Y.width;else if(I==="center")De=-1*Y.width/2;else throw new TypeError("Invalid text.anchor property value",I);if(U=ee.baseline,U==="bottom")ze=0;else if(U==="top")ze=-1*Y.height+Y.ascender;else if(U==="center")ze=-1*Y.height/2;else throw new TypeError("Invalid text.baseline property value",U);we.position.x=De*ge+ee.xOffset,we.position.y=ze*ge,we.position.z=ee.zOffset,we.scale.set(ge,-1*ge,ge)}},lookupFont:function(I){return E[I]},updateGeometry:function(){var I={},U={},$=/\\n/g,ee=/\\t/g;return function(Q,G){var K=this.data;U.font=G,U.lineHeight=K.lineHeight&&isFinite(K.lineHeight)?K.lineHeight:G.common.lineHeight,U.text=K.value.toString().replace($,`
`).replace(ee,"	"),U.width=N(K.wrapPixels,K.wrapCount,G.widthFactor),Q.update(p.extend(I,K,U))}}()});function j(I){switch(I){case"back":return f.FrontSide;case"double":return f.DoubleSide;default:return f.BackSide}}function J(I,U){return new Promise(function($,ee){c(I,function(Q,G){if(Q){m("Error loading font",I),ee(Q);return}I.indexOf("/Roboto-msdf.json")>=0&&(U=30),U&&G.chars.map(function(Y){Y.yoffset+=U}),$(G)})})}function de(I){return new Promise(function(U,$){new f.ImageLoader().load(I,function(ee){U(ee)},void 0,function(){m("Error loading font image",I),$(null)})})}function te(I,U,$){var ee,Q;return Q=new y[U].Shader,Q.el=I,Q.init($),Q.update($),ee=Q.material,ee.transparent=$.transparent,{material:ee,shader:Q}}function N(I,U,$){return I||(.5+U)*$}function L(I){var U=0,$=0,ee=0;return I.chars.map(function(Q){U+=Q.xadvance,Q.id>=48&&Q.id<=57&&(ee++,$+=Q.xadvance)}),ee?$/ee:U/I.chars.length}function M(){var I=this.cache={};this.get=function(U,$){return U in I||(I[U]=$()),I[U]}}},{"../core/component":136,"../core/shader":146,"../lib/three":184,"../utils/":212,"load-bmfont":37,"three-bmfont-text":64}],119:[function(n,i,o){var s=n("../core/component").registerComponent,c=n("../utils/tracked-controls"),u=n("../constants").DEFAULT_CAMERA_HEIGHT,h=n("../lib/three"),f=n("../constants").DEFAULT_HANDEDNESS,p={x:.175,y:-.3,z:-.03},m={x:0,y:0,z:-.175},y={touches:[]},g={AXISMOVE:"axismove",BUTTONCHANGED:"buttonchanged",BUTTONDOWN:"buttondown",BUTTONUP:"buttonup",TOUCHSTART:"touchstart",TOUCHEND:"touchend"};i.exports.Component=s("tracked-controls-webvr",{schema:{autoHide:{default:!0},controller:{default:0},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},orientationOffset:{type:"vec3"},armModel:{default:!1},headElement:{type:"selector"}},init:function(){this.axis=this.el.components["tracked-controls"].axis=[0,0,0],this.buttonStates=this.el.components["tracked-controls"].buttonStates={},this.changedAxes=[],this.targetControllerNumber=this.data.controller,this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes},this.deltaControllerPosition=new h.Vector3,this.controllerQuaternion=new h.Quaternion,this.controllerEuler=new h.Euler,this.updateGamepad(),this.buttonEventDetails={}},tick:function(_,x){var b=this.el.getObject3D("mesh");b&&b.update&&b.update(x/1e3),this.updateGamepad(),this.updatePose(),this.updateButtons()},defaultUserHeight:function(){return u},getHeadElement:function(){return this.data.headElement||this.el.sceneEl.camera.el},updateGamepad:function(){var _=this.data,x=c.findMatchingControllerWebVR(this.system.controllers,_.id,_.idPrefix,_.hand,_.controller);this.controller=x,this.el.components["tracked-controls"].controller=x,this.data.autoHide&&(this.el.object3D.visible=!!this.controller)},applyArmModel:function(_){var x=this.controller,b=this.controllerEuler,E=this.controllerQuaternion,T=this.deltaControllerPosition,P,D,F,k,W;D=this.getHeadElement(),F=D.object3D,W=this.defaultUserHeight(),k=x.pose,P=(x?x.hand:void 0)||f,_.copy(F.position),T.set(p.x*(P==="left"?-1:P==="right"?1:0),p.y,p.z),T.multiplyScalar(W),T.applyAxisAngle(F.up,F.rotation.y),_.add(T),T.set(m.x,m.y,m.z),T.multiplyScalar(W),k.orientation?E.fromArray(k.orientation):E.copy(F.quaternion),b.setFromQuaternion(E),b.set(b.x,b.y,0),T.applyEuler(b),_.add(T)},updatePose:function(){var _=this.controller,x=this.data,b=this.el.object3D,E,T=this.system.vrDisplay,P;!_||(E=_.pose,E.position?b.position.fromArray(E.position):x.armModel&&this.applyArmModel(b.position),E.orientation&&b.quaternion.fromArray(E.orientation),T&&E.position&&(P=this.el.sceneEl.renderer.xr.getStandingMatrix(),b.matrix.compose(b.position,b.quaternion,b.scale),b.matrix.multiplyMatrices(P,b.matrix),b.matrix.decompose(b.position,b.quaternion,b.scale)),b.rotateX(this.data.orientationOffset.x*h.Math.DEG2RAD),b.rotateY(this.data.orientationOffset.y*h.Math.DEG2RAD),b.rotateZ(this.data.orientationOffset.z*h.Math.DEG2RAD))},updateButtons:function(){var _,x=this.controller,b;if(!!x){for(b=0;b<x.buttons.length;++b)this.buttonStates[b]||(this.buttonStates[b]={pressed:!1,touched:!1,value:0}),this.buttonEventDetails[b]||(this.buttonEventDetails[b]={id:b,state:this.buttonStates[b]}),_=x.buttons[b],this.handleButton(b,_);this.handleAxes()}},handleButton:function(_,x){var b;return b=this.handlePress(_,x)|this.handleTouch(_,x)|this.handleValue(_,x),b?(this.el.emit(g.BUTTONCHANGED,this.buttonEventDetails[_],!1),!0):!1},handleAxes:function(){var _=!1,x=this.controller.axes,b,E=this.axis,T=this.changedAxes;for(this.changedAxes.splice(0,this.changedAxes.length),b=0;b<x.length;++b)T.push(E[b]!==x[b]),T[b]&&(_=!0);if(!_)return!1;for(this.axis.splice(0,this.axis.length),b=0;b<x.length;b++)this.axis.push(x[b]);return this.el.emit(g.AXISMOVE,this.axisMoveEventDetail,!1),!0},handlePress:function(_,x){var b,E=this.buttonStates[_];return x.pressed===E.pressed?!1:(b=x.pressed?g.BUTTONDOWN:g.BUTTONUP,this.el.emit(b,this.buttonEventDetails[_],!1),E.pressed=x.pressed,!0)},handleTouch:function(_,x){var b,E=this.buttonStates[_];return x.touched===E.touched?!1:(b=x.touched?g.TOUCHSTART:g.TOUCHEND,this.el.emit(b,this.buttonEventDetails[_],!1,y),E.touched=x.touched,!0)},handleValue:function(_,x){var b=this.buttonStates[_];return x.value===b.value?!1:(b.value=x.value,!0)}})},{"../constants":128,"../core/component":136,"../lib/three":184,"../utils/tracked-controls":221}],120:[function(n,i,o){var s=n("../utils/tracked-controls"),c=n("../core/component").registerComponent,u={AXISMOVE:"axismove",BUTTONCHANGED:"buttonchanged",BUTTONDOWN:"buttondown",BUTTONUP:"buttonup",TOUCHSTART:"touchstart",TOUCHEND:"touchend"};i.exports.Component=c("tracked-controls-webxr",{schema:{id:{type:"string",default:""},hand:{type:"string",default:""},handTrackingEnabled:{default:!1},index:{type:"int",default:-1},iterateControllerProfiles:{default:!1}},init:function(){this.updateController=this.updateController.bind(this),this.buttonEventDetails={},this.buttonStates=this.el.components["tracked-controls"].buttonStates={},this.axis=this.el.components["tracked-controls"].axis=[0,0,0],this.changedAxes=[],this.axisMoveEventDetail={axis:this.axis,changed:this.changedAxes}},update:function(){this.updateController()},play:function(){var h=this.el.sceneEl;this.updateController(),h.addEventListener("controllersupdated",this.updateController)},pause:function(){var h=this.el.sceneEl;h.removeEventListener("controllersupdated",this.updateController)},isControllerPresent:function(h){return!(!this.controller||this.controller.gamepad||h.inputSource.handedness!=="none"&&h.inputSource.handedness!==this.data.hand)},updateController:function(){this.controller=s.findMatchingControllerWebXR(this.system.controllers,this.data.id,this.data.hand,this.data.index,this.data.iterateControllerProfiles,this.data.handTrackingEnabled),this.el.components["tracked-controls"].controller=this.controller,this.data.autoHide&&(this.el.object3D.visible=!!this.controller)},tick:function(){var h=this.el.sceneEl,f=this.controller,p=h.frame;!f||!h.frame||!this.system.referenceSpace||f.hand||(this.pose=p.getPose(f.targetRaySpace,this.system.referenceSpace),this.updatePose(),this.updateButtons())},updatePose:function(){var h=this.el.object3D,f=this.pose;!f||(h.matrix.elements=f.transform.matrix,h.matrix.decompose(h.position,h.rotation,h.scale))},updateButtons:function(){var h,f,p=this.controller,m;if(!(!p||!p.gamepad)){for(m=p.gamepad,f=0;f<m.buttons.length;++f)this.buttonStates[f]||(this.buttonStates[f]={pressed:!1,touched:!1,value:0}),this.buttonEventDetails[f]||(this.buttonEventDetails[f]={id:f,state:this.buttonStates[f]}),h=m.buttons[f],this.handleButton(f,h);this.handleAxes()}},handleButton:function(h,f){var p;return p=this.handlePress(h,f)|this.handleTouch(h,f)|this.handleValue(h,f),p?(this.el.emit(u.BUTTONCHANGED,this.buttonEventDetails[h],!1),!0):!1},handleAxes:function(){var h=!1,f=this.controller.gamepad.axes,p,m=this.axis,y=this.changedAxes;for(this.changedAxes.splice(0,this.changedAxes.length),p=0;p<f.length;++p)y.push(m[p]!==f[p]),y[p]&&(h=!0);if(!h)return!1;for(this.axis.splice(0,this.axis.length),p=0;p<f.length;p++)this.axis.push(f[p]);return this.el.emit(u.AXISMOVE,this.axisMoveEventDetail,!1),!0},handlePress:function(h,f){var p,m=this.buttonStates[h];return f.pressed===m.pressed?!1:(p=f.pressed?u.BUTTONDOWN:u.BUTTONUP,this.el.emit(p,this.buttonEventDetails[h],!1),m.pressed=f.pressed,!0)},handleTouch:function(h,f){var p,m=this.buttonStates[h];return f.touched===m.touched?!1:(p=f.touched?u.TOUCHSTART:u.TOUCHEND,this.el.emit(p,this.buttonEventDetails[h],!1),m.touched=f.touched,!0)},handleValue:function(h,f){var p=this.buttonStates[h];return f.value===p.value?!1:(p.value=f.value,!0)}})},{"../core/component":136,"../utils/tracked-controls":221}],121:[function(n,i,o){var s=n("../core/component").registerComponent;i.exports.Component=s("tracked-controls",{schema:{autoHide:{default:!0},controller:{default:-1},id:{type:"string",default:""},hand:{type:"string",default:""},idPrefix:{type:"string",default:""},handTrackingEnabled:{default:!1},orientationOffset:{type:"vec3"},armModel:{default:!1},headElement:{type:"selector"},iterateControllerProfiles:{default:!1}},update:function(){var c=this.data,u=this.el;u.sceneEl.hasWebXR?u.setAttribute("tracked-controls-webxr",{id:c.id,hand:c.hand,index:c.controller,iterateControllerProfiles:c.iterateControllerProfiles,handTrackingEnabled:c.handTrackingEnabled}):u.setAttribute("tracked-controls-webvr",c)}})},{"../core/component":136}],122:[function(n,i,o){var s=n("../core/component").registerComponent,c=n("../utils/bind"),u=n("../lib/three"),h=n("../utils/tracked-controls"),f=h.checkControllerPresentAndSetup,p=h.emitIfAxesChanged,m=h.onButtonEvent,y="https://cdn.aframe.io/controllers/valve/index/valve-index-",g={left:y+"left.glb",right:y+"right.glb"},_="valve",x=n("../utils/").device.isWebXRAvailable,b={left:{x:-.00023692678902063457,y:.04724540367838371,z:-.061959880395271096},right:{x:.002471558599671131,y:.055765208987076195,z:-.061068168708348844}},E={left:{x:0,y:-.05,z:.06},right:{x:0,y:-.05,z:.06}},T={left:{_x:.692295102620542,_y:-.0627618864318427,_z:-.06265893149611756,_order:"XYZ"},right:{_x:.6484021229942998,_y:-.032563619881892894,_z:-.1327973171917482,_order:"XYZ"}},P={left:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"},right:{_x:Math.PI/3,_y:0,_z:0,_order:"XYZ"}},D=x?P:T,F=x?E:b;i.exports.Component=s("valve-index-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:{axes:{trackpad:[0,1],thumbstick:[2,3]},buttons:["trigger","grip","trackpad","thumbstick","abutton"]},init:function(){var k=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=c(this.onButtonChanged,this),this.onButtonDown=function(W){m(W.detail.id,"down",k)},this.onButtonUp=function(W){m(W.detail.id,"up",k)},this.onButtonTouchEnd=function(W){m(W.detail.id,"touchend",k)},this.onButtonTouchStart=function(W){m(W.detail.id,"touchstart",k)},this.previousButtonValues={},this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=c(this.onModelLoaded,this),this.onControllersUpdate=c(this.onControllersUpdate,this),this.checkIfControllerPresent=c(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=c(this.removeControllersUpdateListener,this),this.onAxisMoved=c(this.onAxisMoved,this)},addEventListeners:function(){var k=this.el;k.addEventListener("buttonchanged",this.onButtonChanged),k.addEventListener("buttondown",this.onButtonDown),k.addEventListener("buttonup",this.onButtonUp),k.addEventListener("touchend",this.onButtonTouchEnd),k.addEventListener("touchstart",this.onButtonTouchStart),k.addEventListener("model-loaded",this.onModelLoaded),k.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var k=this.el;k.removeEventListener("buttonchanged",this.onButtonChanged),k.removeEventListener("buttondown",this.onButtonDown),k.removeEventListener("buttonup",this.onButtonUp),k.removeEventListener("touchend",this.onButtonTouchEnd),k.removeEventListener("touchstart",this.onButtonTouchStart),k.removeEventListener("model-loaded",this.onModelLoaded),k.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var k=this.data,W=k.hand==="right"?0:k.hand==="left"?1:2;f(this,_,{index:W,iterateControllerProfiles:!0,hand:k.hand})},injectTrackedControls:function(){var k=this.el,W=this.data;k.setAttribute("tracked-controls",{idPrefix:_,controller:W.hand==="right"?1:W.hand==="left"?0:2,hand:W.hand,orientationOffset:W.orientationOffset}),this.loadModel()},loadModel:function(){var k=this.data;!k.model||this.el.setAttribute("gltf-model",""+g[k.hand])},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(k){var W=this.mapping.buttons[k.detail.id],j=this.buttonMeshes,J;!W||(W==="trigger"&&(J=k.detail.state.value,j&&j.trigger&&(j.trigger.rotation.x=this.triggerOriginalRotationX-J*(Math.PI/40))),this.el.emit(W+"changed",k.detail.state))},onModelLoaded:function(k){var W,j=k.detail.model,J=this;!this.data.model||(W=this.buttonMeshes={},W.grip={left:j.getObjectByName("leftgrip"),right:j.getObjectByName("rightgrip")},W.menu=j.getObjectByName("menubutton"),W.system=j.getObjectByName("systembutton"),W.trackpad=j.getObjectByName("touchpad"),W.trigger=j.getObjectByName("trigger"),this.triggerOriginalRotationX=W.trigger.rotation.x,Object.keys(W).forEach(function(de){J.setButtonColor(de,J.data.buttonColor)}),j.position.copy(F[this.data.hand]),j.rotation.copy(D[this.data.hand]),this.el.emit("controllermodelready",{name:"valve-index-controlls",model:this.data.model,rayOrigin:new u.Vector3(0,0,0)}))},onAxisMoved:function(k){p(this,this.mapping.axes,k)},updateModel:function(k,W){var j,J;!this.data.model||(J=W.indexOf("touch")!==-1,!J&&(j=W==="up"?this.data.buttonColor:this.data.buttonHighlightColor,this.setButtonColor(k,j)))},setButtonColor:function(k,W){}})},{"../core/component":136,"../lib/three":184,"../utils/":212,"../utils/bind":206,"../utils/tracked-controls":221}],123:[function(n,i,o){var s=n("../core/component").registerComponent;i.exports.Component=s("visible",{schema:{default:!0},update:function(){this.el.object3D.visible=this.data}})},{"../core/component":136}],124:[function(n,i,o){var s=n("../core/component").registerComponent,c=n("../utils/bind"),u=n("../utils/tracked-controls"),h=u.checkControllerPresentAndSetup,f=u.emitIfAxesChanged,p=u.onButtonEvent,m="https://cdn.aframe.io/controllers/vive/vr_controller_vive.obj",y="https://cdn.aframe.io/controllers/vive/vr_controller_vive.mtl",g=n("../utils/").device.isWebXRAvailable,_="htc-vive",x="OpenVR ",b=g?_:x,E={axes:{trackpad:[0,1]},buttons:["trackpad","trigger","grip","menu","system"]},T={axes:{thumbstick:[0,1]},buttons:["trigger","grip","trackpad","none","menu"]},P=g?T:E;i.exports.Component=s("vive-controls",{schema:{hand:{default:"left"},buttonColor:{type:"color",default:"#FAFAFA"},buttonHighlightColor:{type:"color",default:"#22D1EE"},model:{default:!0},orientationOffset:{type:"vec3"}},mapping:P,init:function(){var D=this;this.controllerPresent=!1,this.lastControllerCheck=0,this.onButtonChanged=c(this.onButtonChanged,this),this.onButtonDown=function(F){p(F.detail.id,"down",D)},this.onButtonUp=function(F){p(F.detail.id,"up",D)},this.onButtonTouchEnd=function(F){p(F.detail.id,"touchend",D)},this.onButtonTouchStart=function(F){p(F.detail.id,"touchstart",D)},this.previousButtonValues={},this.rendererSystem=this.el.sceneEl.systems.renderer,this.bindMethods()},update:function(){var D=this.data;this.controllerIndex=D.hand==="right"?0:D.hand==="left"?1:2},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},bindMethods:function(){this.onModelLoaded=c(this.onModelLoaded,this),this.onControllersUpdate=c(this.onControllersUpdate,this),this.checkIfControllerPresent=c(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=c(this.removeControllersUpdateListener,this),this.onAxisMoved=c(this.onAxisMoved,this)},addEventListeners:function(){var D=this.el;D.addEventListener("buttonchanged",this.onButtonChanged),D.addEventListener("buttondown",this.onButtonDown),D.addEventListener("buttonup",this.onButtonUp),D.addEventListener("touchend",this.onButtonTouchEnd),D.addEventListener("touchstart",this.onButtonTouchStart),D.addEventListener("model-loaded",this.onModelLoaded),D.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0},removeEventListeners:function(){var D=this.el;D.removeEventListener("buttonchanged",this.onButtonChanged),D.removeEventListener("buttondown",this.onButtonDown),D.removeEventListener("buttonup",this.onButtonUp),D.removeEventListener("touchend",this.onButtonTouchEnd),D.removeEventListener("touchstart",this.onButtonTouchStart),D.removeEventListener("model-loaded",this.onModelLoaded),D.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1},checkIfControllerPresent:function(){var D=this.data;h(this,b,{index:this.controllerIndex,hand:D.hand})},injectTrackedControls:function(){var D=this.el,F=this.data;D.setAttribute("tracked-controls",{idPrefix:b,hand:F.hand,controller:this.controllerIndex,orientationOffset:F.orientationOffset}),this.data.model&&this.el.setAttribute("obj-model",{obj:m,mtl:y})},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onButtonChanged:function(D){var F=this.mapping.buttons[D.detail.id],k=this.buttonMeshes,W;!F||(F==="trigger"&&(W=D.detail.state.value,k&&k.trigger&&(k.trigger.rotation.x=-W*(Math.PI/12))),this.el.emit(F+"changed",D.detail.state))},onModelLoaded:function(D){var F,k=D.detail.model,W=this;!this.data.model||(F=this.buttonMeshes={},F.grip={left:k.getObjectByName("leftgrip"),right:k.getObjectByName("rightgrip")},F.menu=k.getObjectByName("menubutton"),F.system=k.getObjectByName("systembutton"),F.trackpad=k.getObjectByName("touchpad"),F.trigger=k.getObjectByName("trigger"),Object.keys(F).forEach(function(j){W.setButtonColor(j,W.data.buttonColor)}),k.position.set(0,-.015,.04))},onAxisMoved:function(D){f(this,this.mapping.axes,D)},updateModel:function(D,F){var k,W;!this.data.model||(W=F.indexOf("touch")!==-1,!W&&(k=F==="up"?this.data.buttonColor:this.data.buttonHighlightColor,this.setButtonColor(D,k)))},setButtonColor:function(D,F){var k=this.buttonMeshes,W=this.rendererSystem;if(!!k){if(D==="grip"){k.grip.left.material.color.set(F),k.grip.right.material.color.set(F),W.applyColorCorrection(k.grip.left.material.color),W.applyColorCorrection(k.grip.right.material.color);return}k[D].material.color.set(F),W.applyColorCorrection(k[D].material.color)}}})},{"../core/component":136,"../utils/":212,"../utils/bind":206,"../utils/tracked-controls":221}],125:[function(n,i,o){var s=n("../core/component").registerComponent,c=n("../utils/bind"),u=n("../utils/tracked-controls"),h=u.checkControllerPresentAndSetup,f=u.emitIfAxesChanged,p=u.onButtonEvent,m="HTC Vive Focus",y="https://cdn.aframe.io/controllers/vive/focus-controller/focus-controller.gltf";i.exports.Component=s("vive-focus-controls",{schema:{hand:{default:""},buttonTouchedColor:{type:"color",default:"#BBBBBB"},buttonHighlightColor:{type:"color",default:"#7A7A7A"},model:{default:!0},orientationOffset:{type:"vec3"},armModel:{default:!0}},mapping:{axes:{trackpad:[0,1]},buttons:["trackpad","trigger"]},bindMethods:function(){this.onModelLoaded=c(this.onModelLoaded,this),this.onControllersUpdate=c(this.onControllersUpdate,this),this.checkIfControllerPresent=c(this.checkIfControllerPresent,this),this.removeControllersUpdateListener=c(this.removeControllersUpdateListener,this),this.onAxisMoved=c(this.onAxisMoved,this)},init:function(){var g=this;this.onButtonChanged=c(this.onButtonChanged,this),this.onButtonDown=function(_){p(_.detail.id,"down",g)},this.onButtonUp=function(_){p(_.detail.id,"up",g)},this.onButtonTouchStart=function(_){p(_.detail.id,"touchstart",g)},this.onButtonTouchEnd=function(_){p(_.detail.id,"touchend",g)},this.controllerPresent=!1,this.lastControllerCheck=0,this.bindMethods()},addEventListeners:function(){var g=this.el;g.addEventListener("buttonchanged",this.onButtonChanged),g.addEventListener("buttondown",this.onButtonDown),g.addEventListener("buttonup",this.onButtonUp),g.addEventListener("touchstart",this.onButtonTouchStart),g.addEventListener("touchend",this.onButtonTouchEnd),g.addEventListener("model-loaded",this.onModelLoaded),g.addEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!0,this.addControllersUpdateListener()},removeEventListeners:function(){var g=this.el;g.removeEventListener("buttonchanged",this.onButtonChanged),g.removeEventListener("buttondown",this.onButtonDown),g.removeEventListener("buttonup",this.onButtonUp),g.removeEventListener("touchstart",this.onButtonTouchStart),g.removeEventListener("touchend",this.onButtonTouchEnd),g.removeEventListener("model-loaded",this.onModelLoaded),g.removeEventListener("axismove",this.onAxisMoved),this.controllerEventsActive=!1,this.removeControllersUpdateListener()},checkIfControllerPresent:function(){h(this,m,this.data.hand?{hand:this.data.hand}:{})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},injectTrackedControls:function(){var g=this.el,_=this.data;g.setAttribute("tracked-controls",{armModel:_.armModel,idPrefix:m,orientationOffset:_.orientationOffset}),this.data.model&&this.el.setAttribute("gltf-model",y)},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelLoaded:function(g){var _=g.detail.model,x;!this.data.model||(x=this.buttonMeshes={},x.trigger=_.getObjectByName("BumperKey"),x.triggerPressed=_.getObjectByName("BumperKey_Press"),x.triggerPressed&&(x.triggerPressed.visible=!1),x.trackpad=_.getObjectByName("TouchPad"),x.trackpadPressed=_.getObjectByName("TouchPad_Press"),x.trackpadPressed&&(x.trackpadPressed.visible=!1))},onButtonChanged:function(g){var _=this.mapping.buttons[g.detail.id];!_||this.el.emit(_+"changed",g.detail.state)},onAxisMoved:function(g){f(this,this.mapping.axes,g)},updateModel:function(g,_){!this.data.model||this.updateButtonModel(g,_)},updateButtonModel:function(g,_){var x=this.buttonMeshes,b=g+"Pressed";if(!(!x||!x[g]||!x[b])){var E;switch(_){case"down":E=this.data.buttonHighlightColor;break;case"touchstart":E=this.data.buttonTouchedColor;break}E&&x[b].material.color.set(E),x[b].visible=!!E,x[g].visible=!E}}})},{"../core/component":136,"../utils/bind":206,"../utils/tracked-controls":221}],126:[function(n,i,o){var s=n("../constants").keyboardevent.KEYCODE_TO_CODE,c=n("../core/component").registerComponent,u=n("../lib/three"),h=n("../utils/"),f=h.bind,p=h.shouldCaptureKeyEvent,m=1e-5,y=.2,g=["KeyW","KeyA","KeyS","KeyD","ArrowUp","ArrowLeft","ArrowRight","ArrowDown"];i.exports.Component=c("wasd-controls",{schema:{acceleration:{default:65},adAxis:{default:"x",oneOf:["x","y","z"]},adEnabled:{default:!0},adInverted:{default:!1},enabled:{default:!0},fly:{default:!1},wsAxis:{default:"z",oneOf:["x","y","z"]},wsEnabled:{default:!0},wsInverted:{default:!1}},init:function(){this.keys={},this.easing=1.1,this.velocity=new u.Vector3,this.onBlur=f(this.onBlur,this),this.onContextMenu=f(this.onContextMenu,this),this.onFocus=f(this.onFocus,this),this.onKeyDown=f(this.onKeyDown,this),this.onKeyUp=f(this.onKeyUp,this),this.onVisibilityChange=f(this.onVisibilityChange,this),this.attachVisibilityEventListeners()},tick:function(x,b){var E=this.data,T=this.el,P=this.velocity;!P[E.adAxis]&&!P[E.wsAxis]&&_(this.keys)||(b=b/1e3,this.updateVelocity(b),!(!P[E.adAxis]&&!P[E.wsAxis])&&T.object3D.position.add(this.getMovementVector(b)))},remove:function(){this.removeKeyEventListeners(),this.removeVisibilityEventListeners()},play:function(){this.attachKeyEventListeners()},pause:function(){this.keys={},this.removeKeyEventListeners()},updateVelocity:function(x){var b,E,T,P=this.data,D=this.keys,F=this.velocity,k,W;if(E=P.adAxis,k=P.wsAxis,x>y){F[E]=0,F[k]=0;return}var j=Math.pow(1/this.easing,x*60);F[E]!==0&&(F[E]=F[E]*j),F[k]!==0&&(F[k]=F[k]*j),Math.abs(F[E])<m&&(F[E]=0),Math.abs(F[k])<m&&(F[k]=0),P.enabled&&(b=P.acceleration,P.adEnabled&&(T=P.adInverted?-1:1,(D.KeyA||D.ArrowLeft)&&(F[E]-=T*b*x),(D.KeyD||D.ArrowRight)&&(F[E]+=T*b*x)),P.wsEnabled&&(W=P.wsInverted?-1:1,(D.KeyW||D.ArrowUp)&&(F[k]-=W*b*x),(D.KeyS||D.ArrowDown)&&(F[k]+=W*b*x)))},getMovementVector:function(){var x=new u.Vector3(0,0,0),b=new u.Euler(0,0,0,"YXZ");return function(E){var T=this.el.getAttribute("rotation"),P=this.velocity,D;return x.copy(P),x.multiplyScalar(E),T&&(D=this.data.fly?T.x:0,b.set(u.Math.degToRad(D),u.Math.degToRad(T.y),0),x.applyEuler(b)),x}}(),attachVisibilityEventListeners:function(){window.oncontextmenu=this.onContextMenu,window.addEventListener("blur",this.onBlur),window.addEventListener("focus",this.onFocus),document.addEventListener("visibilitychange",this.onVisibilityChange)},removeVisibilityEventListeners:function(){window.removeEventListener("blur",this.onBlur),window.removeEventListener("focus",this.onFocus),document.removeEventListener("visibilitychange",this.onVisibilityChange)},attachKeyEventListeners:function(){window.addEventListener("keydown",this.onKeyDown),window.addEventListener("keyup",this.onKeyUp)},removeKeyEventListeners:function(){window.removeEventListener("keydown",this.onKeyDown),window.removeEventListener("keyup",this.onKeyUp)},onContextMenu:function(){for(var x=Object.keys(this.keys),b=0;b<x.length;b++)delete this.keys[x[b]]},onBlur:function(){this.pause()},onFocus:function(){this.play()},onVisibilityChange:function(){document.hidden?this.onBlur():this.onFocus()},onKeyDown:function(x){var b;!p(x)||(b=x.code||s[x.keyCode],g.indexOf(b)!==-1&&(this.keys[b]=!0))},onKeyUp:function(x){var b;b=x.code||s[x.keyCode],delete this.keys[b]}});function _(x){var b;for(b in x)return!1;return!0}},{"../constants":128,"../core/component":136,"../lib/three":184,"../utils/":212}],127:[function(n,i,o){var s=n("../core/component").registerComponent,c=n("../utils/bind"),u=n("../utils/tracked-controls"),h=u.checkControllerPresentAndSetup,f=u.emitIfAxesChanged,p=u.onButtonEvent,m=n("../utils/"),y=m.debug("components:windows-motion-controls:debug"),g=m.debug("components:windows-motion-controls:warn"),_=n("../constants").DEFAULT_HANDEDNESS,x="https://cdn.aframe.io/controllers/microsoft/",b={left:"left.glb",right:"right.glb",default:"universal.glb"},E=n("../utils/").device.isWebXRAvailable,T="windows-mixed-reality",P="Spatial Controller (Spatial Interaction Source) ",D=/([0-9a-zA-Z]+-[0-9a-zA-Z]+)$/,F=E?T:P,k={axes:{thumbstick:[0,1],trackpad:[2,3]},buttons:["thumbstick","trigger","grip","menu","trackpad"],axisMeshNames:["THUMBSTICK_X","THUMBSTICK_Y","TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",grip:"GRASP",thumbstick:"THUMBSTICK_PRESS",trackpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"},W={axes:{touchpad:[0,1],thumbstick:[2,3]},buttons:["trigger","squeeze","touchpad","thumbstick","menu"],axisMeshNames:["TOUCHPAD_TOUCH_X","TOUCHPAD_TOUCH_X","THUMBSTICK_X","THUMBSTICK_Y"],buttonMeshNames:{trigger:"SELECT",menu:"MENU",squeeze:"GRASP",thumbstick:"THUMBSTICK_PRESS",touchpad:"TOUCHPAD_PRESS"},pointingPoseMeshName:"POINTING_POSE"},j=E?W:k;i.exports.Component=s("windows-motion-controls",{schema:{hand:{default:_},pair:{default:0},model:{default:!0},hideDisconnected:{default:!0}},mapping:j,bindMethods:function(){this.onModelError=c(this.onModelError,this),this.onModelLoaded=c(this.onModelLoaded,this),this.onControllersUpdate=c(this.onControllersUpdate,this),this.checkIfControllerPresent=c(this.checkIfControllerPresent,this),this.onAxisMoved=c(this.onAxisMoved,this)},init:function(){var J=this,de=this.el;this.onButtonChanged=c(this.onButtonChanged,this),this.onButtonDown=function(te){p(te.detail.id,"down",J)},this.onButtonUp=function(te){p(te.detail.id,"up",J)},this.onButtonTouchStart=function(te){p(te.detail.id,"touchstart",J)},this.onButtonTouchEnd=function(te){p(te.detail.id,"touchend",J)},this.onControllerConnected=function(){J.setModelVisibility(!0)},this.onControllerDisconnected=function(){J.setModelVisibility(!1)},this.controllerPresent=!1,this.lastControllerCheck=0,this.previousButtonValues={},this.bindMethods(),this.loadedMeshInfo={buttonMeshes:null,axisMeshes:null},this.rayOrigin={origin:new THREE.Vector3,direction:new THREE.Vector3(0,0,-1),createdFromMesh:!1},de.addEventListener("controllerconnected",this.onControllerConnected),de.addEventListener("controllerdisconnected",this.onControllerDisconnected)},addEventListeners:function(){var J=this.el;J.addEventListener("buttonchanged",this.onButtonChanged),J.addEventListener("buttondown",this.onButtonDown),J.addEventListener("buttonup",this.onButtonUp),J.addEventListener("touchstart",this.onButtonTouchStart),J.addEventListener("touchend",this.onButtonTouchEnd),J.addEventListener("axismove",this.onAxisMoved),J.addEventListener("model-error",this.onModelError),J.addEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!0},removeEventListeners:function(){var J=this.el;J.removeEventListener("buttonchanged",this.onButtonChanged),J.removeEventListener("buttondown",this.onButtonDown),J.removeEventListener("buttonup",this.onButtonUp),J.removeEventListener("touchstart",this.onButtonTouchStart),J.removeEventListener("touchend",this.onButtonTouchEnd),J.removeEventListener("axismove",this.onAxisMoved),J.removeEventListener("model-error",this.onModelError),J.removeEventListener("model-loaded",this.onModelLoaded),this.controllerEventsActive=!1},checkIfControllerPresent:function(){h(this,F,{hand:this.data.hand,index:this.data.pair,iterateControllerProfiles:!0})},play:function(){this.checkIfControllerPresent(),this.addControllersUpdateListener()},pause:function(){this.removeEventListeners(),this.removeControllersUpdateListener()},updateControllerModel:function(){if(!this.data.model||this.rayOrigin.createdFromMesh){this.modelReady();return}var J=this.createControllerModelUrl();this.loadModel(J)},createControllerModelUrl:function(J){var de=this.el.components["tracked-controls"],te=de?de.controller:null,N="default",L=this.data.hand,M;if(te&&!window.hasNativeWebXRImplementation&&(L=te.hand,!J)){var I=te.id.match(D);N=I&&I[0]||N}return M=b[L]||b.default,x+N+"/"+M},injectTrackedControls:function(){var J=this.data;this.el.setAttribute("tracked-controls",{idPrefix:F,controller:J.pair,hand:J.hand,armModel:!1}),this.updateControllerModel()},addControllersUpdateListener:function(){this.el.sceneEl.addEventListener("controllersupdated",this.onControllersUpdate,!1)},removeControllersUpdateListener:function(){this.el.sceneEl.removeEventListener("controllersupdated",this.onControllersUpdate,!1)},onControllersUpdate:function(){this.checkIfControllerPresent()},onModelError:function(J){var de=this.createControllerModelUrl(!0);J.detail.src!==de?(g("Failed to load controller model for device, attempting to load default."),this.loadModel(de)):g("Failed to load default controller model.")},loadModel:function(J){this.el.setAttribute("gltf-model","url("+J+")")},onModelLoaded:function(J){var de=this.controllerModel=J.detail.model,te=this.loadedMeshInfo,N,L,M,I;if(y("Processing model"),te.buttonMeshes={},te.axisMeshes={},de){for(N=0;N<this.mapping.buttons.length;N++){if(L=this.mapping.buttonMeshNames[this.mapping.buttons[N]],!L){y("Skipping unknown button at index: "+N+" with mapped name: "+this.mapping.buttons[N]);continue}if(M=de.getObjectByName(L),!M){g("Missing button mesh with name: "+L);continue}I={index:N,value:U(M,"VALUE"),pressed:U(M,"PRESSED"),unpressed:U(M,"UNPRESSED")},I.value&&I.pressed&&I.unpressed?te.buttonMeshes[this.mapping.buttons[N]]=I:g("Missing button submesh under mesh with name: "+L+"(VALUE: "+!!I.value+", PRESSED: "+!!I.pressed+", UNPRESSED:"+!!I.unpressed+")")}for(N=0;N<this.mapping.axisMeshNames.length;N++){if(L=this.mapping.axisMeshNames[N],!L){y("Skipping unknown axis at index: "+N);continue}if(M=de.getObjectByName(L),!M){g("Missing axis mesh with name: "+L);continue}I={index:N,value:U(M,"VALUE"),min:U(M,"MIN"),max:U(M,"MAX")},I.value&&I.min&&I.max?te.axisMeshes[N]=I:g("Missing axis submesh under mesh with name: "+L+"(VALUE: "+!!I.value+", MIN: "+!!I.min+", MAX:"+!!I.max+")")}this.calculateRayOriginFromMesh(de),this.setModelVisibility()}y("Model load complete.");function U($,ee){for(var Q=0,G=$.children.length;Q<G;Q++){var K=$.children[Q];if(K&&K.name===ee)return K}}},calculateRayOriginFromMesh:function(){var J=new THREE.Quaternion;return function(de){var te;if(this.rayOrigin.origin.set(0,0,0),this.rayOrigin.direction.set(0,0,-1),this.rayOrigin.createdFromMesh=!0,te=de.getObjectByName(this.mapping.pointingPoseMeshName),te){var N=de.parent;N&&(de.parent=null,de.updateMatrixWorld(!0),de.parent=N),te.getWorldPosition(this.rayOrigin.origin),te.getWorldQuaternion(J),this.rayOrigin.direction.applyQuaternion(J),N&&de.updateMatrixWorld(!0)}else y("Mesh does not contain pointing origin data, defaulting to none.");this.modelReady()}}(),lerpAxisTransform:function(){var J=new THREE.Quaternion;return function(de,te){var N=this.loadedMeshInfo.axisMeshes[de];if(!!N){var L=N.min,M=N.max,I=N.value,U=te*.5+.5;I.setRotationFromQuaternion(J.copy(L.quaternion).slerp(M.quaternion,U)),I.position.lerpVectors(L.position,M.position,U)}}}(),lerpButtonTransform:function(){var J=new THREE.Quaternion;return function(de,te){var N=this.loadedMeshInfo.buttonMeshes[de];if(!!N){var L=N.unpressed,M=N.pressed,I=N.value;I.setRotationFromQuaternion(J.copy(L.quaternion).slerp(M.quaternion,te)),I.position.lerpVectors(L.position,M.position,te)}}}(),modelReady:function(){this.el.emit("controllermodelready",{name:"windows-motion-controls",model:this.data.model,rayOrigin:this.rayOrigin})},onButtonChanged:function(J){var de=this.mapping.buttons[J.detail.id];de&&(this.loadedMeshInfo&&this.loadedMeshInfo.buttonMeshes&&this.lerpButtonTransform(de,J.detail.state.value),this.el.emit(de+"changed",J.detail.state))},onAxisMoved:function(J){var de=this.mapping.axisMeshNames.length;if(this.loadedMeshInfo&&this.loadedMeshInfo.axisMeshes)for(var te=0;te<de;te++)this.lerpAxisTransform(te,J.detail.axis[te]||0);f(this,this.mapping.axes,J)},setModelVisibility:function(J){var de=this.el.getObject3D("mesh");J=J!==void 0?J:this.modelVisible,this.modelVisible=J,de&&(de.visible=J)}})},{"../constants":128,"../core/component":136,"../utils/":212,"../utils/bind":206,"../utils/tracked-controls":221}],128:[function(n,i,o){i.exports={AFRAME_INJECTED:"aframe-injected",DEFAULT_CAMERA_HEIGHT:1.6,DEFAULT_HANDEDNESS:"right",keyboardevent:n("./keyboardevent")}},{"./keyboardevent":129}],129:[function(n,i,o){i.exports={KEYCODE_TO_CODE:{"38":"ArrowUp","37":"ArrowLeft","40":"ArrowDown","39":"ArrowRight","87":"KeyW","65":"KeyA","83":"KeyS","68":"KeyD"}}},{}],130:[function(n,i,o){var s=n("./a-node"),c=n("../utils/bind"),u=n("../utils/debug"),h=n("./a-register-element").registerElement,f=n("../lib/three"),p=new f.FileLoader,m=u("core:a-assets:warn");i.exports=h("a-assets",{prototype:Object.create(s.prototype,{createdCallback:{value:function(){this.isAssets=!0,this.fileLoader=p,this.timeout=null}},attachedCallback:{value:function(){var T=this,P,D=[],F,k,W,j,J;if(!this.parentNode.isScene)throw new Error("<a-assets> must be a child of a <a-scene>.");for(j=this.querySelectorAll("img"),P=0;P<j.length;P++)W=g(j[P]),D.push(new Promise(function(de,te){f.Cache.add(j[P].getAttribute("src"),W),W.onload=de,W.onerror=te}));for(k=this.querySelectorAll("audio, video"),P=0;P<k.length;P++)F=g(k[P]),!F.src&&!F.srcObject&&m("Audio/video asset has neither `src` nor `srcObject` attributes."),D.push(y(F));Promise.all(D).then(c(this.load,this)),J=parseInt(this.getAttribute("timeout"),10)||3e3,this.timeout=setTimeout(function(){T.hasLoaded||(m("Asset loading timed out in ",J,"ms"),T.emit("timeout"),T.load())},J)}},detachedCallback:{value:function(){this.timeout&&clearTimeout(this.timeout)}},load:{value:function(){s.prototype.load.call(this,null,function(P){return P.isAssetItem&&P.hasAttribute("src")})}}})}),h("a-asset-item",{prototype:Object.create(s.prototype,{createdCallback:{value:function(){this.data=null,this.isAssetItem=!0}},attachedCallback:{value:function(){var T=this,P=this.getAttribute("src");p.setResponseType(this.getAttribute("response-type")||b(P)),p.load(P,function(F){T.data=F,setTimeout(function(){s.prototype.load.call(T)})},function(F){T.emit("progress",{loadedBytes:F.loaded,totalBytes:F.total,xhr:F})},function(F){T.emit("error",{xhr:F})})}}})});function y(T){if(!(!T.hasAttribute("autoplay")&&T.getAttribute("preload")!=="auto"))return new Promise(function(P,D){if(T.readyState===4)return P();if(T.error)return D();T.addEventListener("loadeddata",F,!1),T.addEventListener("progress",F,!1),T.addEventListener("error",D,!1);function F(){for(var k=0,W=0;W<T.buffered.length;W++)k+=T.buffered.end(W)-T.buffered.start(W);k>=T.duration&&(T.tagName==="VIDEO"&&f.Cache.add(T.getAttribute("src"),T),P())}})}function g(T){var P=_(T);return P.tagName&&P.tagName.toLowerCase()==="video"&&(P.setAttribute("playsinline",""),P.setAttribute("webkit-playsinline","")),P!==T&&(T.parentNode.appendChild(P),T.parentNode.removeChild(T)),P}function _(T){var P,D;return T.hasAttribute("crossorigin")||(D=T.getAttribute("src"),D!==null&&(D.indexOf("://")===-1||x(D)===window.location.host))?T:(m('Cross-origin element (e.g., <img>) was requested without `crossorigin` set. A-Frame will re-request the asset with `crossorigin` attribute set. Please set `crossorigin` on the element (e.g., <img crossorigin="anonymous">)',D),T.crossOrigin="anonymous",P=T.cloneNode(!0),P)}function x(T){var P=T.indexOf("://")>-1?T.split("/")[2]:T.split("/")[0];return P.substring(0,P.indexOf(":"))}function b(T){var P=E(T),D=P.lastIndexOf(".");if(D>=0){var F=P.slice(D,T.search(/\?|#|$/));if(F===".glb")return"arraybuffer"}return"text"}i.exports.inferResponseType=b;function E(T){var P=document.createElement("a");P.href=T;var D=P.search.replace(/^\?/,""),F=T.replace(D,"").replace("?","");return F.substring(F.lastIndexOf("/")+1)}i.exports.getFileNameFromURL=E},{"../lib/three":184,"../utils/bind":206,"../utils/debug":208,"./a-node":134,"./a-register-element":135}],131:[function(n,i,o){var s=n("../utils/debug"),c=n("./a-register-element").registerElement,u=s("core:cubemap:warn");i.exports=c("a-cubemap",{prototype:Object.create(window.HTMLElement.prototype,{attachedCallback:{value:function(){this.srcs=this.validate()},writable:window.debug},validate:{value:function(){var h=this.querySelectorAll("[src]"),f,p=[];if(h.length===6){for(f=0;f<h.length;f++)p.push(h[f].getAttribute("src"));return p}u("<a-cubemap> did not contain exactly six elements each with a `src` attribute.")},writable:window.debug}})})},{"../utils/debug":208,"./a-register-element":135}],132:[function(n,i,o){var s=n("./a-node"),c=n("./component").components,u=n("./a-register-element").registerElement,h=n("../lib/three"),f=n("../utils/"),p,m=f.debug("core:a-entity:debug"),y=f.debug("core:a-entity:warn"),g="__",_=["position","rotation","scale","visible"],x={once:!0},b=Object.create(s.prototype,{createdCallback:{value:function(){this.components={},this.initializingComponents={},this.componentsToUpdate={},this.isEntity=!0,this.isPlaying=!1,this.object3D=new h.Group,this.object3D.el=this,this.object3DMap={},this.parentEl=null,this.rotationObj={},this.states=[]}},attributeChangedCallback:{value:function(k,W,j){var J=this.components[k];if(J&&J.justInitialized&&j===""){delete J.justInitialized;return}!J&&j===null||this.setEntityAttribute(k,W,j)}},attachedCallback:{value:function(){var k,W=this.sceneEl,j=this;if(this.addToParent(),!this.isScene){if(!W){this.load();return}if(k=W.querySelector("a-assets"),k&&!k.hasLoaded){k.addEventListener("loaded",function(){j.load()});return}this.load()}}},detachedCallback:{value:function(){var k;if(!!this.parentEl){for(k in this.components)this.removeComponent(k,!1);this.isScene||(this.removeFromParent(),s.prototype.detachedCallback.call(this),this.object3D.el=null)}}},getObject3D:{value:function(k){return this.object3DMap[k]}},setObject3D:{value:function(k,W){var j,J=this;if(!(W instanceof h.Object3D))throw new Error("`Entity.setObject3D` was called with an object that was not an instance of THREE.Object3D.");j=this.getObject3D(k),j&&this.object3D.remove(j),W.el=this,W.children.length&&W.traverse(function(te){te.el=J}),this.object3D.add(W),this.object3DMap[k]=W,this.emit("object3dset",{object:W,type:k})}},removeObject3D:{value:function(k){var W=this.getObject3D(k);if(!W){y("Tried to remove `Object3D` of type:",k,"which was not defined.");return}this.object3D.remove(W),delete this.object3DMap[k],this.emit("object3dremove",{type:k})}},getOrCreateObject3D:{value:function(k,W){var j=this.getObject3D(k);return!j&&W&&(j=new W,this.setObject3D(k,j)),y("`getOrCreateObject3D` has been deprecated. Use `setObject3D()` and `object3dset` event instead."),j}},add:{value:function(k){if(!k.object3D)throw new Error("Trying to add an element that doesn't have an `object3D`");this.object3D.add(k.object3D),this.emit("child-attached",{el:k})}},addToParent:{value:function(){var k=this.parentEl=this.parentNode;!k||!k.add||this.attachedToParent||(k.add(this),this.attachedToParent=!0)}},removeFromParent:{value:function(){var k=this.parentEl;this.parentEl.remove(this),this.attachedToParent=!1,this.parentEl=null,k.emit("child-detached",{el:this})}},load:{value:function(){var k=this;this.hasLoaded||!this.parentEl||s.prototype.load.call(this,function(){!k.parentEl||(k.updateComponents(),(k.isScene||k.parentEl.isPlaying)&&k.play())})},writable:window.debug},remove:{value:function(k){k?this.object3D.remove(k.object3D):this.parentNode.removeChild(this)}},getChildEntities:{value:function(){for(var k=this.children,W=[],j=0;j<k.length;j++){var J=k[j];J instanceof p&&W.push(J)}return W}},initComponent:{value:function(k,W,j){var J,de,te,N,L;if(te=f.split(k,g),N=te[0],de=te.length>2?te.slice(1).join("__"):te[1],!!c[N]&&(L=E(this,k)||W!==void 0,!(!L&&!j)&&!(k in this.components))){if(this.initComponentDependencies(N),de&&!c[N].multiple)throw new Error("Trying to initialize multiple components of type `"+N+"`. There can only be one component of this type per entity.");J=new c[N].Component(this,W,de),this.isPlaying&&J.play(),this.hasAttribute(k)||(J.justInitialized=!0,window.HTMLElement.prototype.setAttribute.call(this,k,"")),m("Component initialized: %s",k)}},writable:window.debug},initComponentDependencies:{value:function(k){var W=this,j=c[k],J,de;if(!!j&&(J=c[k].dependencies,!!J))for(de=0;de<J.length;de++)W.initComponent(J[de],window.HTMLElement.prototype.getAttribute.call(W,J[de])||void 0,!0)}},removeComponent:{value:function(k,W){var j;if(j=this.components[k],!!j){if(!j.initialized){this.addEventListener("componentinitialized",function J(de){de.detail.name===k&&(this.removeComponent(k,W),this.removeEventListener("componentinitialized",J))});return}j.pause(),j.remove(),W&&(j.destroy(),delete this.components[k]),this.emit("componentremoved",j.evtDetail,!1)}},writable:window.debug},updateComponents:{value:function(){var k,W,j,J,de=this.componentsToUpdate;if(!!this.hasLoaded){for(j=0;j<this.mixinEls.length;j++)for(J in this.mixinEls[j].componentCache)D(J)&&(de[J]=!0);if(this.getExtraComponents){W=this.getExtraComponents();for(J in W)D(J)&&(de[J]=!0)}for(j=0;j<this.attributes.length;++j)J=this.attributes[j].name,_.indexOf(J)===-1&&D(J)&&(de[J]=!0);for(j=0;j<_.length;j++)J=_[j],this.hasAttribute(J)&&this.updateComponent(J,this.getDOMAttribute(J));for(J in de)k=P(this.getDOMAttribute(J),W&&W[J]),this.updateComponent(J,k),delete de[J]}},writable:window.debug},updateComponent:{value:function(k,W,j){var J=this.components[k];if(J){if(W===null&&!E(this,k)){this.removeComponent(k,!0);return}J.updateProperties(W,j);return}this.initComponent(k,W,!1)}},removeAttribute:{value:function(k,W){var j=this.components[k];if(j&&W===void 0&&this.removeComponent(k,!0),j&&W!==void 0){j.resetProperty(W);return}k==="mixin"&&this.mixinUpdate(""),window.HTMLElement.prototype.removeAttribute.call(this,k)}},play:{value:function(){var k,W,j;if(!(this.isPlaying||!this.hasLoaded)){this.isPlaying=!0;for(j in this.components)this.components[j].play();for(k=this.getChildEntities(),W=0;W<k.length;W++)k[W].play();this.emit("play")}},writable:!0},pause:{value:function(){var k,W,j;if(!!this.isPlaying){this.isPlaying=!1;for(j in this.components)this.components[j].pause();for(k=this.getChildEntities(),W=0;W<k.length;W++)k[W].pause();this.emit("pause")}},writable:!0},setEntityAttribute:{value:function(k,W,j){if(c[k]||this.components[k]){this.updateComponent(k,j);return}if(k==="mixin"){if(j===this.computedMixinStr)return;this.mixinUpdate(j,W)}}},mixinUpdate:{value:function(){var k=[];return function(W,j){var J,de,te,N,L=this;if(!this.hasLoaded){this.addEventListener("loaded",function(){L.mixinUpdate(W,j)},x);return}for(j=j||this.getAttribute("mixin"),te=this.updateMixins(W,j),k.length=0,N=0;N<this.mixinEls.length;N++)for(J in this.mixinEls[N].componentCache)k.indexOf(J)===-1&&(this.components[J]?this.components[J].handleMixinUpdate():this.initComponent(J,null),k.push(J));for(N=0;N<te.oldMixinIds.length;N++)if(de=document.getElementById(te.oldMixinIds[N]),!!de)for(J in de.componentCache)k.indexOf(J)===-1&&this.components[J]&&(this.getDOMAttribute(J)?this.components[J].handleMixinUpdate():this.removeComponent(J,!0))}}()},setAttribute:{value:function(){var k={};return function(W,j,J){var de,te,N,L,M,I;if(L=W.indexOf(g),N=L>0?W.substring(0,L):W,!c[N]){W==="mixin"&&this.mixinUpdate(j),s.prototype.setAttribute.call(this,W,j);return}if(!this.components[W]&&this.hasAttribute(W)&&this.updateComponent(W,window.HTMLElement.prototype.getAttribute.call(this,W)),typeof J!="undefined"&&typeof j=="string"&&j.length>0&&typeof f.styleParser.parse(j)=="string"){for(I in k)delete k[I];de=k,de[j]=J,te=!1}else de=j,te=J===!0;this.updateComponent(W,de,te),M=this.sceneEl&&this.sceneEl.getAttribute("debug"),M&&this.components[W].flushToDOM()}}(),writable:window.debug},flushToDOM:{value:function(k){var W=this.components,j,J=this.children,de,te;for(te in W)W[te].flushToDOM();if(!!k)for(de=0;de<J.length;++de)j=J[de],j.flushToDOM&&j.flushToDOM(k)}},getAttribute:{value:function(k){var W;return k==="position"?this.object3D.position:k==="rotation"?F(this):k==="scale"?this.object3D.scale:k==="visible"?this.object3D.visible:(W=this.components[k],W?W.data:window.HTMLElement.prototype.getAttribute.call(this,k))},writable:window.debug},getDOMAttribute:{value:function(k){var W=this.components[k];return W?W.attrValue:window.HTMLElement.prototype.getAttribute.call(this,k)},writable:window.debug},addState:{value:function(k){this.is(k)||(this.states.push(k),this.emit("stateadded",k))}},removeState:{value:function(k){var W=this.states.indexOf(k);W!==-1&&(this.states.splice(W,1),this.emit("stateremoved",k))}},is:{value:function(k){return this.states.indexOf(k)!==-1}},inspect:{value:function(){this.sceneEl.components.inspector.openInspector(this)}},destroy:{value:function(){var k;if(this.parentNode){y("Entity can only be destroyed if detached from scenegraph.");return}for(k in this.components)this.components[k].destroy()}}});function E(k,W){return k.components[W]&&k.components[W].attrValue?!0:T(W,k.mixinEls)}function T(k,W){var j,J=!1;for(j=0;j<W.length&&(J=W[j].hasAttribute(k),!J);++j);return J}function P(k,W){return W?W.constructor===Object?f.extend(W,f.styleParser.parse(k||{})):k||W:k}function D(k){return k.indexOf(g)!==-1&&(k=f.split(k,g)[0]),!!c[k]}function F(k){var W=h.Math.radToDeg,j=k.object3D.rotation,J=k.rotationObj;return J.x=W(j.x),J.y=W(j.y),J.z=W(j.z),J}p=u("a-entity",{prototype:b}),i.exports=p},{"../lib/three":184,"../utils/":212,"./a-node":134,"./a-register-element":135,"./component":136}],133:[function(n,i,o){var s=n("./a-node"),c=n("./a-register-element").registerElement,u=n("./component").components,h=n("../utils"),f="__";i.exports=c("a-mixin",{prototype:Object.create(s.prototype,{createdCallback:{value:function(){this.componentCache={},this.id=this.getAttribute("id"),this.isMixin=!0}},attributeChangedCallback:{value:function(p,m,y){this.cacheAttribute(p,y),this.updateEntities()}},attachedCallback:{value:function(){this.sceneEl=this.closestScene(),this.cacheAttributes(),this.updateEntities(),this.load()}},setAttribute:{value:function(p,m){window.HTMLElement.prototype.setAttribute.call(this,p,m),this.cacheAttribute(p,m)}},cacheAttribute:{value:function(p,m){var y,g;g=h.split(p,f)[0],y=u[g],y&&(m===void 0&&(m=window.HTMLElement.prototype.getAttribute.call(this,p)),this.componentCache[p]=y.parseAttrValueForCache(m))}},getAttribute:{value:function(p){return this.componentCache[p]||window.HTMLElement.prototype.getAttribute.call(this,p)}},cacheAttributes:{value:function(){var p=this.attributes,m,y;for(y=0;y<p.length;y++)m=p[y].name,this.cacheAttribute(m)}},updateEntities:{value:function(){var p,m,y;if(!!this.sceneEl)for(m=this.sceneEl.querySelectorAll("[mixin~="+this.id+"]"),y=0;y<m.length;y++)p=m[y],!(!p.hasLoaded||p.isMixin)&&p.mixinUpdate(this.id)}}})})},{"../utils":212,"./a-node":134,"./a-register-element":135,"./component":136}],134:[function(n,i,o){var s=n("./a-register-element").registerElement,c=n("./a-register-element").isNode,u=n("../utils/"),h=u.debug("core:a-node:warn"),f=u.debug("core:a-node:error");i.exports=s("a-node",{prototype:Object.create(window.HTMLElement.prototype,{createdCallback:{value:function(){this.computedMixinStr="",this.hasLoaded=!1,this.isNode=!0,this.mixinEls=[]},writable:window.debug},attachedCallback:{value:function(){var p;this.sceneEl=this.closestScene(),this.sceneEl||h("You are attempting to attach <"+this.tagName+"> outside of an A-Frame scene. Append this element to `<a-scene>` instead."),this.hasLoaded=!1,this.emit("nodeready",void 0,!1),this.isMixin||(p=this.getAttribute("mixin"),p&&this.updateMixins(p))},writable:window.debug},attributeChangedCallback:{value:function(p,m,y){y!==this.computedMixinStr&&p==="mixin"&&!this.isMixin&&this.updateMixins(y,m)}},closestScene:{value:function(){for(var m=this;m&&!m.isScene;)m=m.parentElement;return m}},closest:{value:function(m){for(var y=this.matches||this.mozMatchesSelector||this.msMatchesSelector||this.oMatchesSelector||this.webkitMatchesSelector,g=this;g&&!y.call(g,m);)g=g.parentElement;return g}},detachedCallback:{value:function(){this.hasLoaded=!1}},load:{value:function(p,m){var y,g,_=this;this.hasLoaded||(m=m||c,y=this.getChildren(),g=y.filter(m).map(function(x){return new Promise(function(E){if(x.hasLoaded)return E();x.addEventListener("loaded",E)})}),Promise.all(g).then(function(){_.hasLoaded=!0,p&&p(),_.emit("loaded",void 0,!1)}).catch(function(x){f("Failure loading node: ",x)}))},writable:!0},getChildren:{value:function(){return Array.prototype.slice.call(this.children,0)}},updateMixins:{value:function(){var p=[],m=[],y={};return function(g,_){var x,b,E;for(p.length=0,m.length=0,b=g?u.split(g.trim(),/\s+/):p,E=_?u.split(_.trim(),/\s+/):m,y.newMixinIds=b,y.oldMixinIds=E,x=0;x<E.length;x++)b.indexOf(E[x])===-1&&this.unregisterMixin(E[x]);for(this.computedMixinStr="",this.mixinEls.length=0,x=0;x<b.length;x++)this.registerMixin(document.getElementById(b[x]));return this.computedMixinStr&&(this.computedMixinStr=this.computedMixinStr.trim(),window.HTMLElement.prototype.setAttribute.call(this,"mixin",this.computedMixinStr)),y}}()},registerMixin:{value:function(p){var m,y,g;if(!!p){if(g=p.getAttribute("mixin"),g)for(m=u.split(g.trim(),/\s+/),y=0;y<m.length;y++)this.registerMixin(document.getElementById(m[y]));this.computedMixinStr=this.computedMixinStr+" "+p.id,this.mixinEls.push(p)}}},setAttribute:{value:function(p,m){p==="mixin"&&this.updateMixins(m),window.HTMLElement.prototype.setAttribute.call(this,p,m)}},unregisterMixin:{value:function(p){var m,y=this.mixinEls,g;for(m=0;m<y.length;++m)if(g=y[m],p===g.id){y.splice(m,1);break}}},emit:{value:function(){var p={};return function(m,y,g,_){g===void 0&&(g=!0),p.bubbles=!!g,p.detail=y,_&&(p=u.extend({},_,p)),this.dispatchEvent(new CustomEvent(m,p))}}(),writable:window.debug}})})},{"../utils/":212,"./a-register-element":135}],135:[function(n,i,o){n("document-register-element");var s,c,u=i.exports.knownTags={};function h(_){u[_.toLowerCase()]=!0}i.exports.isNode=function(_){return _.tagName.toLowerCase()in u||_.isNode},i.exports.registerElement=function(_,x){var b=Object.getPrototypeOf(x.prototype),E=x,T=s&&b===s.prototype,P=c&&b===c.prototype;return(T||P)&&h(_),T&&(E=f(x.prototype),E={prototype:Object.create(b,E)}),P&&(E=p(x.prototype),E={prototype:Object.create(b,E)}),Object.getOwnPropertyNames(E.prototype).forEach(function(D){var F=E.prototype[D];typeof F=="function"&&(F.displayName=D)}),document.registerElement(_,E)};function f(_){var x={},b=["attachedCallback","attributeChangedCallback","createdCallback","detachedCallback"];return m(x,b,_,s.prototype),g(_,x),x}function p(_){var x={},b=["attachedCallback","attributeChangedCallback","createdCallback","detachedCallback"],E=["attachedCallback","attributeChangedCallback","createdCallback","detachedCallback"];return m(x,b,_,s.prototype),m(x,E,_,c.prototype),g(_,x),x}function m(_,x,b,E){x.forEach(function(T){y(_,T,b,E)})}i.exports.wrapMethods=m;function y(_,x,b,E){var T=b[x],P=E[x];!T||!P||T!==P&&(_[x]={value:function(){return P.apply(this,arguments),T.apply(this,arguments)},writable:window.debug})}function g(_,x){var b=Object.getOwnPropertyNames(_);b.forEach(function(E){var T;x[E]||(T=Object.getOwnPropertyDescriptor(_,E),x[E]={value:_[E],writable:T.writable})})}s=n("./a-node"),c=n("./a-entity")},{"./a-entity":132,"./a-node":134,"document-register-element":12}],136:[function(n,i,o){var s=n("./schema"),c=n("./scene/scenes"),u=n("./system"),h=n("../utils/"),f=i.exports.components={},p=s.parseProperties,m=s.parseProperty,y=s.process,g=s.isSingleProperty,_=s.stringifyProperties,x=s.stringifyProperty,b=h.styleParser,E=h.debug("core:component:warn"),T=document.currentScript,P=new RegExp("[A-Z]+"),D={},F=i.exports.Component=function(I,U,$){var ee=this;this.el=I,this.id=$,this.attrName=this.name+($?"__"+$:""),this.evtDetail={id:this.id,name:this.name},this.initialized=!1,this.isSingleProperty=g(this.schema),this.isSinglePropertyObject=this.isSingleProperty&&L(m(void 0,this.schema))&&!(this.schema.default instanceof window.HTMLElement),this.isObjectBased=!this.isSingleProperty||this.isSinglePropertyObject,this.el.components[this.attrName]=this,this.objectPool=D[this.name];const Q=this.events;this.events={},k(this,Q),this.attrValue=void 0,this.isObjectBased?(this.nextData=this.objectPool.use(),h.objectPool.removeUnusedKeys(this.nextData,this.schema),this.oldData=this.objectPool.use(),h.objectPool.removeUnusedKeys(this.oldData,this.schema),this.previousOldData=this.objectPool.use(),h.objectPool.removeUnusedKeys(this.previousOldData,this.schema),this.parsingAttrValue=this.objectPool.use(),h.objectPool.removeUnusedKeys(this.parsingAttrValue,this.schema)):(this.nextData=void 0,this.oldData=void 0,this.previousOldData=void 0,this.parsingAttrValue=void 0),this.throttledEmitComponentChanged=h.throttleComponentChanged(function(){I.emit("componentchanged",ee.evtDetail,!1)},200),this.updateProperties(U)};F.prototype={schema:{},init:function(){},events:{},update:function(I){},updateSchema:void 0,tick:void 0,tock:void 0,play:function(){},pause:function(){},remove:function(){},parse:function(I,U){var $=this.schema;return this.isSingleProperty?m(I,$):p(b.parse(I),$,!0,this.name,U)},stringify:function(I){var U=this.schema;return typeof I=="string"?I:this.isSingleProperty?x(I,U):(I=_(I,U),b.stringify(I))},updateCachedAttrValue:function(I,U){var $,ee,Q;if(I!==void 0){if(I===null){this.isObjectBased&&this.attrValue&&this.objectPool.recycle(this.attrValue),this.attrValue=void 0;return}if(I instanceof Object&&!(I instanceof window.HTMLElement)?(ee=this.objectPool.use(),$=h.extend(ee,I)):$=this.parseAttrValueForCache(I),this.isObjectBased&&!U&&this.attrValue)for(Q in this.attrValue)$[Q]===void 0&&($[Q]=this.attrValue[Q]);this.isObjectBased&&!this.attrValue&&(this.attrValue=this.objectPool.use()),h.objectPool.clearObject(this.attrValue),this.attrValue=J(this.attrValue,$,this.isObjectBased),h.objectPool.clearObject(ee)}},parseAttrValueForCache:function(I){var U;return typeof I!="string"?I:(this.isSingleProperty?(U=this.schema.parse(I),typeof U=="string"&&(U=I)):(h.objectPool.clearObject(this.parsingAttrValue),U=b.parse(I,this.parsingAttrValue)),U)},flushToDOM:function(I){var U=I?this.data:this.attrValue;U!=null&&window.HTMLElement.prototype.setAttribute.call(this.el,this.attrName,this.stringify(U))},updateProperties:function(I,U){var $=this.el;if(!$.hasLoaded){this.updateCachedAttrValue(I);return}I!==null&&(I=this.parseAttrValueForCache(I)),this.updateCachedAttrValue(I,U),this.initialized?(this.updateComponent(I,U),this.callUpdateHandler()):this.initComponent()},initComponent:function(){var I=this.el,U;this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!1,!0)),this.data=this.buildData(this.attrValue),!I.initializingComponents[this.name]&&(I.initializingComponents[this.name]=!0,this.init(),this.initialized=!0,delete I.initializingComponents[this.name],this.oldData=J(this.oldData,this.data,this.isObjectBased),U=this.isObjectBased?this.objectPool.use():void 0,this.update(U),this.isObjectBased&&this.objectPool.recycle(U),I.isPlaying&&this.play(),I.emit("componentinitialized",this.evtDetail,!1))},updateComponent:function(I,U){var $,ee;if(U){this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!0,!0)),this.data=this.buildData(this.attrValue,!0,!1);return}if(this.isSingleProperty){this.isObjectBased&&m(I,this.schema),this.data=I;return}if(p(I,this.schema,!0,this.name),this.schemaChangeKeys.length){for($ in I)if(this.schema[$].schemaChange){ee=!0;break}}if(ee){this.updateSchema&&this.updateSchema(this.buildData(this.attrValue,!0,!0)),this.data=this.buildData(this.attrValue,!0,!1);return}for($ in I)I[$]!==void 0&&(this.data[$]=I[$])},callUpdateHandler:function(){var I;this.previousOldData instanceof Object&&h.objectPool.clearObject(this.previousOldData),this.isObjectBased?j(this.previousOldData,this.oldData):this.previousOldData=this.oldData,I=!h.deepEqual(this.oldData,this.data),!(!this.isPositionRotationScale&&!I)&&(this.oldData instanceof Object&&h.objectPool.clearObject(this.oldData),this.oldData=J(this.oldData,this.data,this.isObjectBased),this.update(this.previousOldData),this.throttledEmitComponentChanged())},handleMixinUpdate:function(){this.data=this.buildData(this.attrValue),this.callUpdateHandler()},resetProperty:function(I){if(this.isObjectBased){if(!(I in this.attrValue))return;delete this.attrValue[I],this.data[I]=this.schema[I].default}else this.attrValue=this.schema.default,this.data=this.schema.default;this.updateProperties(this.attrValue)},extendSchema:function(I){var U;U=h.extend({},f[this.name].schema),h.extend(U,I),this.schema=y(U),this.el.emit("schemachanged",this.evtDetail)},buildData:function(I,U,$){var ee,Q,G,K,Y,we=this.nextData,Ke=this.schema,ge,me=this.el.mixinEls,De;if(ee=I&&I.constructor===Array?I.length:I!=null,this.isObjectBased&&h.objectPool.clearObject(we),this.isSingleProperty)this.isObjectBased?Q=j(we,Ke.default):Q=M(Ke.default)?h.clone(Ke.default):Ke.default;else{De=!U&&this.attrValue,Q=De instanceof Object?j(we,De):we;for(K in Ke)G=Ke[K].default,Q[K]===void 0&&(Q[K]=M(G)?h.clone(G):G)}for(ge=0;ge<me.length;ge++)Y=me[ge].getAttribute(this.attrName),Y&&(Q=J(Q,Y,this.isObjectBased));if(ee){if(this.isSingleProperty)return L(I)?(j(this.parsingAttrValue,I),m(this.parsingAttrValue,Ke)):m(I,Ke);Q=J(Q,I,this.isObjectBased)}else if(this.isSingleProperty)return m(Q,Ke);return p(Q,Ke,void 0,this.name,$)},eventsAttach:function(){var I;this.eventsDetach();for(I in this.events)this.el.addEventListener(I,this.events[I])},eventsDetach:function(){var I;for(I in this.events)this.el.removeEventListener(I,this.events[I])},destroy:function(){this.objectPool.recycle(this.attrValue),this.objectPool.recycle(this.oldData),this.objectPool.recycle(this.parsingAttrValue),this.attrValue=this.oldData=this.parsingAttrValue=void 0}};function k(I,U){var $;for($ in U)I.events[$]=U[$].bind(I)}if(window.debug)var W=i.exports.registrationOrderWarnings={};i.exports.registerComponent=function(I,U){var $,ee,Q={},G,K;if(document.currentScript&&document.currentScript!==T&&c.forEach(function(we){we.hasLoaded||document.currentScript.compareDocumentPosition(we)!==Node.DOCUMENT_POSITION_FOLLOWING&&(E("The component `"+I+"` was registered in a <script> tag after the scene. Component <script> tags in an HTML file should be declared *before* the scene such that the component is available to entities during scene initialization."),window.debug&&(W[I]=!0))}),P.test(I)===!0&&E("The component name `"+I+"` contains uppercase characters, but HTML will ignore the capitalization of attribute names. Change the name to be lowercase: `"+I.toLowerCase()+"`"),I.indexOf("__")!==-1)throw new Error("The component name `"+I+"` is not allowed. The sequence __ (double underscore) is reserved to specify an id for multiple components of the same type");if(Object.keys(U).forEach(function(Y){Q[Y]={value:U[Y],writable:!0}}),f[I])throw new Error("The component `"+I+"` has been already registered. Check that you are not loading two versions of the same component or two different components of the same name.");if($=function(Y,we,Ke){F.call(this,Y,we,Ke)},$.prototype=Object.create(F.prototype,Q),$.prototype.name=I,$.prototype.isPositionRotationScale=I==="position"||I==="rotation"||I==="scale",$.prototype.constructor=$,$.prototype.system=u&&u.systems[I],$.prototype.play=N($.prototype.play),$.prototype.pause=te($.prototype.pause),G=h.extend(y($.prototype.schema,$.prototype.name)),K=g($.prototype.schema),!K){$.prototype.schemaChangeKeys=[];for(ee in G)G[ee].schemaChange&&$.prototype.schemaChangeKeys.push(ee)}return D[I]=h.objectPool.createPool(),f[I]={Component:$,dependencies:$.prototype.dependencies,isSingleProp:K,multiple:$.prototype.multiple,name:I,parse:$.prototype.parse,parseAttrValueForCache:$.prototype.parseAttrValueForCache,schema:G,stringify:$.prototype.stringify,type:$.prototype.type},$};function j(I,U){var $,ee;for(ee in U)U[ee]!==void 0&&($=U[ee],I[ee]=M($)?h.clone($):$);return I}function J(I,U,$){var ee;if($&&U.constructor===Object){for(ee in U)U[ee]!==void 0&&(U[ee]&&U[ee].constructor===Object?I[ee]=h.clone(U[ee]):I[ee]=U[ee]);return I}return U}function de(I){return I.tick||I.tock}function te(I){return function(){var $=this.el.sceneEl;!this.isPlaying||(I.call(this),this.isPlaying=!1,this.eventsDetach(),de(this)&&$.removeBehavior(this))}}function N(I){return function(){var $=this.el.sceneEl,ee=this.el.isPlaying&&!this.isPlaying;!this.initialized||!ee||(I.call(this),this.isPlaying=!0,this.eventsAttach(),de(this)&&$.addBehavior(this))}}function L(I){return I&&I.constructor===Object&&!(I instanceof window.HTMLElement)}function M(I){return I&&(I.constructor===Object||I.constructor===Array)&&!(I instanceof window.HTMLElement)}},{"../utils/":212,"./scene/scenes":143,"./schema":145,"./system":147}],137:[function(n,i,o){var s=n("./schema"),c=s.process,u=i.exports.geometries={},h=i.exports.geometryNames=[],f=n("../lib/three"),p=i.exports.Geometry=function(){};p.prototype={schema:{},init:function(m){return this.geometry=new f.BufferGeometry,this.geometry},update:function(m){}},i.exports.registerGeometry=function(m,y){var g,_={};if(Object.keys(y).forEach(function(b){_[b]={value:y[b],writable:!0}}),u[m])throw new Error("The geometry `"+m+"` has been already registered");return g=function(){p.call(this)},g.prototype=Object.create(p.prototype,_),g.prototype.name=m,g.prototype.constructor=g,u[m]={Geometry:g,schema:c(g.prototype.schema)},h.push(m),g}},{"../lib/three":184,"./schema":145}],138:[function(n,i,o){var s=n("../utils/coordinates"),c=n("debug"),u=c("core:propertyTypes:warn"),h=c("core:propertyTypes:warn"),f=i.exports.propertyTypes={},p=/[,> .[\]:]/,m=/\url\((.+)\)/;y("audio","",x),y("array",[],g,_),y("asset","",x),y("boolean",!1,T),y("color","#FFF",b,E),y("int",0,P),y("number",0,D),y("map","",x),y("model","",x),y("selector",null,F,W),y("selectorAll",null,k,j),y("src","",J),y("string","",b,E),y("time",0,P),y("vec2",{x:0,y:0},de,s.stringify),y("vec3",{x:0,y:0,z:0},de,s.stringify),y("vec4",{x:0,y:0,z:0,w:1},de,s.stringify);function y(L,M,I,U){if("type"in f){u("Property type "+L+" is already registered.");return}f[L]={default:M,parse:I||b,stringify:U||E}}i.exports.registerPropertyType=y;function g(L){if(Array.isArray(L))return L;if(!L||typeof L!="string")return[];return L.split(",").map(M);function M(I){return I.trim()}}function _(L){return L.join(", ")}function x(L){var M,I;if(typeof L!="string")return L;if(I=L.match(m),I)return I[1];if(L.charAt(0)==="#"){if(M=document.getElementById(L.substring(1)),M)return M.tagName==="CANVAS"||M.tagName==="VIDEO"||M.tagName==="IMG"?M:M.getAttribute("src");h('"'+L+'" asset not found.');return}return L}function b(L){return L}function E(L){return L===null?"null":L.toString()}function T(L){return L!=="false"&&L!==!1}function P(L){return parseInt(L,10)}function D(L){return parseFloat(L,10)}function F(L){return L?typeof L!="string"?L:L[0]==="#"&&!p.test(L)?document.getElementById(L.substring(1)):document.querySelector(L):null}function k(L){return L?typeof L!="string"?L:Array.prototype.slice.call(document.querySelectorAll(L),0):null}function W(L){return L.getAttribute?"#"+L.getAttribute("id"):E(L)}function j(L){return L instanceof Array?L.map(function(M){return"#"+M.getAttribute("id")}).join(", "):E(L)}function J(L){return h("`src` property type is deprecated. Use `asset` instead."),x(L)}function de(L){return s.parse(L,this.default)}function te(L,M){return L==="audio"&&typeof M!="string"||L==="array"&&!Array.isArray(M)||L==="asset"&&typeof M!="string"||L==="boolean"&&typeof M!="boolean"||L==="color"&&typeof M!="string"||L==="int"&&typeof M!="number"||L==="number"&&typeof M!="number"||L==="map"&&typeof M!="string"||L==="model"&&typeof M!="string"||L==="selector"&&typeof M!="string"&&M!==null||L==="selectorAll"&&typeof M!="string"&&M!==null||L==="src"&&typeof M!="string"||L==="string"&&typeof M!="string"||L==="time"&&typeof M!="number"?!1:L==="vec2"?N(M,2):L==="vec3"?N(M,3):L==="vec4"?N(M,4):!0}i.exports.isValidDefaultValue=te;function N(L,M){if(L===null)return!0;if(typeof L!="object"||Object.keys(L).length!==M)return!1;var I=L.x,U=L.y,$=L.z,ee=L.w;return!(typeof I!="number"||typeof U!="number"||M>2&&typeof $!="number"||M>3&&typeof ee!="number")}i.exports.isValidDefaultCoordinate=N},{"../utils/coordinates":207,debug:8}],139:[function(n,i,o){var s=n("./metaTags").inject,c=n("./wakelock"),u=n("./loadingScreen"),h=n("../a-register-element"),f=n("./scenes"),p=n("../system").systems,m=n("../../lib/three"),y=n("../../utils/"),g=n("../a-entity"),_=n("../a-node"),x=n("./postMessage"),b=y.bind,E=y.device.isIOS(),T=y.device.isMobile(),P=y.device.isWebXRAvailable,D=h.registerElement,F=y.debug("core:a-scene:warn");E&&n("../../utils/ios-orientationchange-blank-bug"),i.exports.AScene=D("a-scene",{prototype:Object.create(g.prototype,{createdCallback:{value:function(){this.clock=new m.Clock,this.isIOS=E,this.isMobile=T,this.hasWebXR=P,this.isAR=!1,this.isScene=!0,this.object3D=new m.Scene;var N=this;this.object3D.onAfterRender=function(L,M,I){N.isPlaying&&N.tock(N.time,N.delta,I)},this.resize=b(this.resize,this),this.render=b(this.render,this),this.systems={},this.systemNames=[],this.time=this.delta=0,this.behaviors={tick:[],tock:[]},this.hasLoaded=!1,this.isPlaying=!1,this.originalHTML=this.innerHTML,this.setAttribute("inspector",""),this.setAttribute("keyboard-shortcuts",""),this.setAttribute("screenshot",""),this.setAttribute("vr-mode-ui",""),this.setAttribute("device-orientation-permission-ui","")}},addFullScreenStyles:{value:function(){document.documentElement.classList.add("a-fullscreen")}},removeFullScreenStyles:{value:function(){document.documentElement.classList.remove("a-fullscreen")}},attachedCallback:{value:function(){var N=this,L=this.hasAttribute("embedded");te(this),this.setupRenderer(),u.setup(this,W),this.resize(),L||this.addFullScreenStyles(),x(this),s(this),c(this),this.onVRPresentChangeBound=b(this.onVRPresentChange,this),window.addEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),this.enterVRBound=function(){N.enterVR()},this.exitVRBound=function(){N.exitVR()},this.exitVRTrueBound=function(){N.exitVR(!0)},this.pointerRestrictedBound=function(){N.pointerRestricted()},this.pointerUnrestrictedBound=function(){N.pointerUnrestricted()},P||(window.addEventListener("vrdisplaydeactivate",this.exitVRBound),window.addEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.addEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.addEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound)),window.addEventListener("sessionend",this.resize),this.addEventListener("cameraready",function(){N.attachedCallbackPostCamera()}),this.initSystems(),this.hasWebXR&&navigator.xr&&navigator.xr.addEventListener&&navigator.xr.addEventListener("sessiongranted",function(){N.enterVR()})}},attachedCallbackPostCamera:{value:function(){var N,L=this;window.addEventListener("load",N),window.addEventListener("resize",function(){L.isIOS?setTimeout(L.resize,100):L.resize()}),this.play(),f.push(this)},writable:window.debug},initSystems:{value:function(){var N;this.initSystem("camera");for(N in p)N!=="camera"&&this.initSystem(N)}},initSystem:{value:function(N){this.systems[N]||(this.systems[N]=new p[N](this),this.systemNames.push(N))}},detachedCallback:{value:function(){var N=f.indexOf(this);f.splice(N,1),window.removeEventListener("vrdisplaypresentchange",this.onVRPresentChangeBound),window.removeEventListener("vrdisplayactivate",this.enterVRBound),window.removeEventListener("vrdisplaydeactivate",this.exitVRBound),window.removeEventListener("vrdisplayconnect",this.enterVRBound),window.removeEventListener("vrdisplaydisconnect",this.exitVRTrueBound),window.removeEventListener("vrdisplaypointerrestricted",this.pointerRestrictedBound),window.removeEventListener("vrdisplaypointerunrestricted",this.pointerUnrestrictedBound),window.removeEventListener("sessionend",this.resize),this.renderer.xr.dispose()}},addBehavior:{value:function(N){var L,M=this.behaviors,I;for(I in M)!N[I]||(L=this.behaviors[I],L.indexOf(N)===-1&&L.push(N))}},getPointerLockElement:{value:function(){return document.pointerLockElement},writable:window.debug},checkHeadsetConnected:{value:y.device.checkHeadsetConnected,writable:window.debug},enterAR:{value:function(){var N;if(!this.hasWebXR)throw N="Failed to enter AR mode, WebXR not supported.",new Error(N);if(!y.device.checkARSupport())throw N="Failed to enter AR, WebXR immersive-ar mode not supported in your browser or device.",new Error(N);return this.enterVR(!0)}},enterVR:{value:function(N){var L=this,M,I=L.renderer.xr,U;if(this.is("vr-mode"))return Promise.resolve("Already in VR.");if(this.checkHeadsetConnected()||this.isMobile)if(I.enabled=!0,this.hasWebXR){this.xrSession&&this.xrSession.removeEventListener("end",this.exitVRBound);var $=this.sceneEl.systems.webxr.sessionReferenceSpaceType;I.setReferenceSpaceType($);var ee=N?"immersive-ar":"immersive-vr";return U=this.sceneEl.systems.webxr.sessionConfiguration,new Promise(function(we,Ke){navigator.xr.requestSession(ee,U).then(function(me){L.xrSession=me,I.layersEnabled=U.requiredFeatures.indexOf("layers")!==-1,I.setSession(me),me.addEventListener("end",L.exitVRBound),K(we)},function(me){var De=ee==="immersive-ar",ze=De?"AR":"VR";throw new Error("Failed to enter "+ze+" mode (`requestSession`) "+me)})})}else{if(M=y.device.getVRDisplay(),I.setDevice(M),M.isPresenting&&!window.hasNativeWebVRImplementation)return K(),Promise.resolve();var Q=this.getAttribute("renderer"),G={highRefreshRate:Q.highRefreshRate,foveationLevel:Q.foveationLevel};return M.requestPresent([{source:this.canvas,attributes:G}]).then(K,Y)}return K(),Promise.resolve();function K(we){var Ke;window.hasNativeWebVRImplementation&&!window.hasNativeWebXRImplementation&&(Ke=new CustomEvent("vrdisplaypresentchange",{detail:{display:y.device.getVRDisplay()}}),window.dispatchEvent(Ke)),N?L.addState("ar-mode"):L.addState("vr-mode"),L.emit("enter-vr",{target:L}),!P&&L.isMobile&&screen.orientation&&screen.orientation.lock&&screen.orientation.lock("landscape"),L.addFullScreenStyles(),!L.isMobile&&!L.checkHeadsetConnected()&&J(L.canvas),L.resize(),we&&we()}function Y(we){throw L.removeState("vr-mode"),we&&we.message?new Error("Failed to enter VR mode (`requestPresent`): "+we.message):new Error("Failed to enter VR mode (`requestPresent`).")}},writable:!0},exitVR:{value:function(){var N=this,L,M=this.renderer.xr;if(!this.is("vr-mode")&&!this.is("ar-mode"))return Promise.resolve("Not in immersive mode.");if(this.checkHeadsetConnected()||this.isMobile){if(M.enabled=!1,L=y.device.getVRDisplay(),this.hasWebXR)this.xrSession.removeEventListener("end",this.exitVRBound),this.xrSession.end().then(function(){},function(){}),this.xrSession=void 0,M.setSession(null);else if(L.isPresenting)return L.exitPresent().then(I,U)}else de();return I(),Promise.resolve();function I(){N.removeState("vr-mode"),N.removeState("ar-mode"),N.isMobile&&screen.orientation&&screen.orientation.unlock&&screen.orientation.unlock(),N.hasAttribute("embedded")&&N.removeFullScreenStyles(),N.resize(),N.isIOS&&y.forceCanvasResizeSafariMobile(N.canvas),N.renderer.setPixelRatio(window.devicePixelRatio),N.emit("exit-vr",{target:N})}function U($){throw $&&$.message?new Error("Failed to exit VR mode (`exitPresent`): "+$.message):new Error("Failed to exit VR mode (`exitPresent`).")}},writable:!0},pointerRestricted:{value:function(){if(this.canvas){var N=this.getPointerLockElement();N&&N!==this.canvas&&document.exitPointerLock&&document.exitPointerLock(),this.canvas.requestPointerLock&&this.canvas.requestPointerLock()}}},pointerUnrestricted:{value:function(){var N=this.getPointerLockElement();N&&N===this.canvas&&document.exitPointerLock&&document.exitPointerLock()}},onVRPresentChange:{value:function(N){var L=N.display||N.detail.display;if(L&&L.isPresenting){this.enterVR();return}this.exitVR()}},getAttribute:{value:function(N){var L=this.systems[N];return L?L.data:g.prototype.getAttribute.call(this,N)}},getComputedAttribute:{value:function(N){F("`getComputedAttribute` is deprecated. Use `getAttribute` instead."),this.getAttribute(N)}},getDOMAttribute:{value:function(N){var L=this.systems[N];return L?L.data:g.prototype.getDOMAttribute.call(this,N)}},setAttribute:{value:function(N,L,M){var I=this.systems[N];if(I){_.prototype.setAttribute.call(this,N,L),I.updateProperties(L);return}g.prototype.setAttribute.call(this,N,L,M)}},removeBehavior:{value:function(N){var L,M,I=this.behaviors,U;for(M in I)!N[M]||(L=this.behaviors[M],U=L.indexOf(N),U!==-1&&L.splice(U,1))}},resize:{value:function(){var N=this.camera,L=this.canvas,M,I,U,$=this.renderer.xr.isPresenting;I=this.renderer.xr.enabled&&$,!(!N||!L||this.is("vr-mode")&&(this.isMobile||I))&&(M=this.getAttribute("embedded")&&!this.is("vr-mode"),U=W(L,M,this.maxCanvasSize,this.is("vr-mode")),N.aspect=U.width/U.height,N.updateProjectionMatrix(),this.renderer.setSize(U.width,U.height,!1),this.emit("rendererresize",null,!1))},writable:!0},setupRenderer:{value:function(){var N=this,L,M,I,U;U={alpha:!0,antialias:!T,canvas:this.canvas,logarithmicDepthBuffer:!1,powerPreference:"high-performance"},this.maxCanvasSize={height:1920,width:1920},this.hasAttribute("renderer")&&(I=this.getAttribute("renderer"),M=y.styleParser.parse(I),M.precision&&(U.precision=M.precision+"p"),M.antialias&&M.antialias!=="auto"&&(U.antialias=M.antialias==="true"),M.logarithmicDepthBuffer&&M.logarithmicDepthBuffer!=="auto"&&(U.logarithmicDepthBuffer=M.logarithmicDepthBuffer==="true"),M.alpha&&(U.alpha=M.alpha==="true"),this.maxCanvasSize={width:M.maxCanvasWidth?parseInt(M.maxCanvasWidth):this.maxCanvasSize.width,height:M.maxCanvasHeight?parseInt(M.maxCanvasHeight):this.maxCanvasSize.height}),L=this.renderer=new m.WebGLRenderer(U),L.setPixelRatio(window.devicePixelRatio),L.sortObjects=!1,this.camera&&L.xr.setPoseTarget(this.camera.el.object3D),this.addEventListener("camera-set-active",function(){L.xr.setPoseTarget(N.camera.el.object3D)})},writable:window.debug},play:{value:function(){var N=this,L=this;if(this.renderStarted){g.prototype.play.call(this);return}this.addEventListener("loaded",function(){var M=this.renderer,I,U=this.renderer.xr;g.prototype.play.call(this),!L.renderStarted&&(L.resize(),L.renderer&&(window.performance&&window.performance.mark("render-started"),u.remove(),I=y.device.getVRDisplay(),I&&I.isPresenting&&(U.setDevice(I),U.enabled=!0,L.enterVR()),M.setAnimationLoop(this.render),L.renderStarted=!0,L.emit("renderstart")))}),setTimeout(function(){g.prototype.load.call(N)})}},updateComponent:{value:function(N){N in p||g.prototype.updateComponent.apply(this,arguments)}},tick:{value:function(N,L){var M,I=this.systems;for(M=0;M<this.behaviors.tick.length;M++)!this.behaviors.tick[M].el.isPlaying||this.behaviors.tick[M].tick(N,L);for(M=0;M<this.systemNames.length;M++)!I[this.systemNames[M]].tick||I[this.systemNames[M]].tick(N,L)}},tock:{value:function(N,L,M){var I,U=this.systems;for(I=0;I<this.behaviors.tock.length;I++)!this.behaviors.tock[I].el.isPlaying||this.behaviors.tock[I].tock(N,L,M);for(I=0;I<this.systemNames.length;I++)!U[this.systemNames[I]].tock||U[this.systemNames[I]].tock(N,L,M)}},render:{value:function(N,L){var M=this.renderer;this.frame=L,this.delta=this.clock.getDelta()*1e3,this.time=this.clock.elapsedTime*1e3,this.isPlaying&&this.tick(this.time,this.delta);var I=null;this.is("ar-mode")&&(I=this.object3D.background,this.object3D.background=null),M.render(this.object3D,this.camera),I&&(this.object3D.background=I)},writable:!0}})});function k(N,L){var M,I=window.devicePixelRatio;return!L||L.width===-1&&L.height===-1||N.width*I<L.width&&N.height*I<L.height||(M=N.width/N.height,N.width*I>L.width&&L.width!==-1&&(N.width=Math.round(L.width/I),N.height=Math.round(L.width/M/I)),N.height*I>L.height&&L.height!==-1&&(N.height=Math.round(L.height/I),N.width=Math.round(L.height*M/I))),N}function W(N,L,M,I){if(!N.parentElement)return{height:0,width:0};if(L){var U;return U={height:N.parentElement.offsetHeight,width:N.parentElement.offsetWidth},k(U,M)}return j(M,I)}function j(N,L){var M;return M={height:document.body.offsetHeight,width:document.body.offsetWidth},L?M:k(M,N)}function J(N){var L=N.requestFullscreen||N.webkitRequestFullscreen||N.mozRequestFullScreen||N.msRequestFullscreen;L.apply(N,[{navigationUI:"hide"}])}function de(){var N=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement;!N||(document.exitFullscreen?document.exitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitExitFullscreen&&document.webkitExitFullscreen())}function te(N){var L;L=document.createElement("canvas"),L.classList.add("a-canvas"),L.dataset.aframeCanvas=!0,N.appendChild(L),document.addEventListener("fullscreenchange",M),document.addEventListener("mozfullscreenchange",M),document.addEventListener("webkitfullscreenchange",M),document.addEventListener("MSFullscreenChange",M),L.addEventListener("touchmove",function(I){I.preventDefault()}),N.canvas=L,N.emit("render-target-loaded",{target:L}),setTimeout(b(N.resize,N),0);function M(){var I=document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement;I||N.exitVR(),document.activeElement.blur(),document.body.focus()}}i.exports.setupCanvas=te},{"../../lib/three":184,"../../utils/":212,"../../utils/ios-orientationchange-blank-bug":213,"../a-entity":132,"../a-node":134,"../a-register-element":135,"../system":147,"./loadingScreen":140,"./metaTags":141,"./postMessage":142,"./scenes":143,"./wakelock":144}],140:[function(n,i,o){var s=n("../../utils/"),c=s.styleParser,u,h,f,p="loading-screen",m="a-loader-title";i.exports.setup=function(x,b){u=x,f=b;var E=u.hasAttribute(p)?c.parse(u.getAttribute(p)):void 0,T=E&&E.dotsColor||"white",P=E&&E.backgroundColor||"#24CAFF",D=E===void 0||E.enabled==="true"||E.enabled===void 0,F,k,W,j,J,de,te,N,L,M;!D||(F=new THREE.Scene,k=new THREE.SphereGeometry(.2,36,18,0,2*Math.PI,0,Math.PI),W=new THREE.MeshBasicMaterial({color:T}),j=new THREE.Mesh(k,W),J=j.clone(),de=j.clone(),te=new THREE.PerspectiveCamera(80,window.innerWidth/window.innerHeight,5e-4,1e4),N=new THREE.Clock,L=0,M=function(){u.renderer.render(F,te),L=N.getElapsedTime()%4,j.visible=L>=1,J.visible=L>=2,de.visible=L>=3},F.background=new THREE.Color(P),F.add(te),j.position.set(-1,0,-15),J.position.set(0,0,-15),de.position.set(1,0,-15),te.add(j),te.add(J),te.add(de),g(),setTimeout(function(){u.hasLoaded||(y(te),h.style.display="block",window.addEventListener("resize",function(){y(te)}),u.renderer.setAnimationLoop(M))},200))},i.exports.remove=function(){window.removeEventListener("resize",y),h&&(h.style.display="none")};function y(_){var x=u.hasAttribute("embedded"),b=f(u.canvas,x,u.maxCanvasSize,u.is("vr-mode"));_.aspect=b.width/b.height,_.updateProjectionMatrix(),u.renderer.setSize(b.width,b.height,!1)}function g(){h=document.createElement("div"),h.className=m,h.innerHTML=document.title,h.style.display="none",u.appendChild(h)}},{"../../utils/":212}],141:[function(n,i,o){var s=n("../../constants/"),c=n("../../utils").extend,u=i.exports.MOBILE_HEAD_TAGS=[f({name:"viewport",content:"width=device-width,initial-scale=1,maximum-scale=1,shrink-to-fit=no,user-scalable=no,minimal-ui,viewport-fit=cover"}),f({name:"mobile-web-app-capable",content:"yes"}),f({name:"theme-color",content:"black"})],h=[f({name:"apple-mobile-web-app-capable",content:"yes"}),f({name:"apple-mobile-web-app-status-bar-style",content:"black"}),p({rel:"apple-touch-icon",href:"https://aframe.io/images/aframe-logo-152.png"})];function f(y){return{tagName:"meta",attributes:y,exists:function(){return document.querySelector('meta[name="'+y.name+'"]')}}}function p(y){return{tagName:"link",attributes:y,exists:function(){return document.querySelector('link[rel="'+y.rel+'"]')}}}i.exports.inject=function(g){var _=document.head,x=_.querySelector("script"),b,E=[];return u.forEach(T),g.isIOS&&h.forEach(T),E;function T(P){!P||P.exists()||(b=m(P),b&&(x?x.parentNode.insertBefore(b,x):_.appendChild(b),E.push(b)))}};function m(y){if(!(!y||!y.tagName)){var g=document.createElement(y.tagName);return g.setAttribute(s.AFRAME_INJECTED,""),c(g,y.attributes)}}},{"../../constants/":128,"../../utils":212}],142:[function(n,i,o){var s=n("../../utils/bind"),c=n("../../utils/").isIframed;i.exports=function(f){!c()||window.addEventListener("message",s(u,f))};function u(h){var f=this;if(!!h.data)switch(h.data.type){case"vr":switch(h.data.data){case"enter":f.enterVR();break;case"exit":f.exitVR();break}}}},{"../../utils/":212,"../../utils/bind":206}],143:[function(n,i,o){i.exports=[]},{}],144:[function(n,i,o){var s=n("../../../vendor/wakelock/wakelock");i.exports=function(u){if(!!u.isMobile){var h=u.wakelock=new s;u.addEventListener("enter-vr",function(){h.request()}),u.addEventListener("exit-vr",function(){h.release()})}}},{"../../../vendor/wakelock/wakelock":227}],145:[function(n,i,o){var s=n("../utils/"),c=n("./propertyTypes"),u=s.debug,h=c.isValidDefaultValue,f=c.propertyTypes,p=u("core:schema:warn");function m(x){return"type"in x?typeof x.type=="string":"default"in x}i.exports.isSingleProperty=m,i.exports.process=function(x,b){var E;if(m(x))return y(x,b);for(E in x)x[E]=y(x[E],b);return x};function y(x,b){var E=x.default,T,P,D=x.type;return x.type?x.type==="bool"?D="boolean":x.type==="float"&&(D="number"):E!==void 0&&(typeof E=="boolean"||typeof E=="number")?D=typeof E:Array.isArray(E)?D="array":D="string",P=f[D],P||p("Unknown property type for component `"+b+"`: "+D),T=!!x.parse,x.parse=x.parse||P.parse,x.stringify=x.stringify||P.stringify,x.type=D,"default"in x?!T&&!h(D,E)&&p("Default value `"+E+"` does not match type `"+D+"` in component `"+b+"`"):x.default=P.default,x}i.exports.processPropertyDefinition=y,i.exports.parseProperties=function(){var x=[];return function(b,E,T,P,D){var F,k,W,j;x.length=0;for(k in T?b:E)T&&b[k]===void 0||x.push(k);if(b===null||typeof b!="object")return b;for(k in b)b[k]!==void 0&&!E[k]&&!D&&p("Unknown property `"+k+"` for component/system `"+P+"`.");for(F=0;F<x.length;F++){if(k=x[F],W=E[k],j=b[k],!E[k])return;b[k]=g(j,W)}return b}}();function g(x,b){return(x==null||x==="")&&(x=b.default,Array.isArray(x)&&(x=x.slice())),b.parse(x,b.default)}i.exports.parseProperty=g,i.exports.stringifyProperties=function(x,b){var E,T,P,D={},F;for(E in x)T=b[E],P=x[E],F=P,typeof F=="object"&&(F=_(P,T),T||p("Unknown component property: "+E)),D[E]=F;return D};function _(x,b){return typeof x!="object"?x:!b||x===null?JSON.stringify(x):b.stringify(x)}i.exports.stringifyProperty=_},{"../utils/":212,"./propertyTypes":138}],146:[function(n,i,o){var s=n("./schema"),c=s.process,u=i.exports.shaders={},h=i.exports.shaderNames=[],f=n("../lib/three"),p=n("../utils"),m={array:"v3",color:"v3",int:"i",number:"f",map:"t",time:"f",vec2:"v2",vec3:"v3",vec4:"v4"},y=i.exports.Shader=function(){};y.prototype={schema:{},vertexShader:"void main() {gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);}",fragmentShader:"void main() {gl_FragColor = vec4(1.0, 0.0, 1.0, 1.0);}",init:function(g){return this.attributes=this.initVariables(g,"attribute"),this.uniforms=this.initVariables(g,"uniform"),this.material=new(this.raw?f.RawShaderMaterial:f.ShaderMaterial)({uniforms:this.uniforms,vertexShader:this.vertexShader,fragmentShader:this.fragmentShader}),this.material},initVariables:function(g,_){var x,b=this.schema,E={},T;for(x in b)b[x].is===_&&(T=m[b[x].type],E[x]={type:T,value:void 0});return E},update:function(g){this.updateVariables(g,"attribute"),this.updateVariables(g,"uniform")},updateVariables:function(g,_){var x,b,E=this.schema,T;T=_==="uniform"?this.uniforms:this.attributes;for(x in g)if(!(!E[x]||E[x].is!==_)){if(E[x].type==="map"){if(!T[x]||T[x].value===g[x])continue;b="_texture_"+x,this.setMapOnTextureLoad(T,x,b),p.material.updateMapMaterialFromData(b,x,this,g);continue}T[x].value=this.parseValue(E[x].type,g[x]),T[x].needsUpdate=!0}},parseValue:function(g,_){var x;switch(g){case"vec2":return new f.Vector2(_.x,_.y);case"vec3":return new f.Vector3(_.x,_.y,_.z);case"vec4":return new f.Vector4(_.x,_.y,_.z,_.w);case"color":return x=new f.Color(_),new f.Vector3(x.r,x.g,x.b);case"map":return f.ImageUtils.loadTexture(_);default:return _}},setMapOnTextureLoad:function(g,_,x){var b=this;this.el.addEventListener("materialtextureloaded",function(){g[_].value=b.material[x],g[_].needsUpdate=!0})}},i.exports.registerShader=function(g,_){var x,b={};if(Object.keys(_).forEach(function(E){b[E]={value:_[E],writable:!0}}),u[g])throw new Error("The shader "+g+" has been already registered");return x=function(){y.call(this)},x.prototype=Object.create(y.prototype,b),x.prototype.name=g,x.prototype.constructor=x,u[g]={Shader:x,schema:c(x.prototype.schema)},h.push(g),x}},{"../lib/three":184,"../utils":212,"./schema":145}],147:[function(n,i,o){var s=n("./component"),c=n("./schema"),u=n("../utils/"),h=c.parseProperties,f=c.parseProperty,p=c.process,m=c.isSingleProperty,y=u.styleParser,g=i.exports.systems={},_=i.exports.System=function(x){var b=s&&s.components[this.name];this.el=x,this.sceneEl=x,b&&(b.Component.prototype.system=this),this.buildData(),this.init(),this.update({})};_.prototype={schema:{},init:function(){},update:function(x){},updateProperties:function(x){var b=this.data;!Object.keys(c).length||(this.buildData(x),this.update(b))},buildData:function(x){var b=this.schema;!Object.keys(b).length||(x=x||window.HTMLElement.prototype.getAttribute.call(this.sceneEl,this.name),m(b)?this.data=f(x,b):this.data=h(y.parse(x)||{},b))},tick:void 0,tock:void 0,play:function(){},pause:function(){}},i.exports.registerSystem=function(x,b){var E,T,P={},D=u.findAllScenes(document);if(Object.keys(b).forEach(function(F){P[F]={value:b[F],writable:!0}}),g[x])throw new Error("The system `"+x+"` has been already registered. Check that you are not loading two versions of the same system or two different systems of the same name.");for(T=function(F){_.call(this,F)},T.prototype=Object.create(_.prototype,P),T.prototype.name=x,T.prototype.constructor=T,T.prototype.schema=u.extend(p(T.prototype.schema)),g[x]=T,E=0;E<D.length;E++)D[E].initSystem(x)}},{"../utils/":212,"./component":136,"./schema":145}],148:[function(n,i,o){n("./pivot")},{"./pivot":149}],149:[function(n,i,o){var s=n("../../core/component").registerComponent,c=n("../../lib/three"),u=new c.Vector3,h=new c.Vector3;s("pivot",{dependencies:["position"],schema:{type:"vec3"},init:function(){var f=this.data,p=this.el,m=p.object3D.parent,y=p.object3D,g=new c.Group;u.copy(y.position),h.copy(y.rotation),m.remove(y),g.add(y),m.add(g),p.object3D=g,y.position.set(-1*f.x,-1*f.y,-1*f.z),g.position.set(f.x+u.x,f.y+u.y,f.z+u.z),g.rotation.copy(y.rotation),y.rotation.set(0,0,0)}})},{"../../core/component":136,"../../lib/three":184}],150:[function(n,i,o){var s=n("../../core/component").components,c=n("../../core/shader").shaders,u=n("../../utils/"),h={};Object.keys(s.material.schema).forEach(f),Object.keys(c.standard.schema).forEach(f);function f(p){var m=p.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();p==="fog"&&(m="material-fog"),p==="visible"&&(m="material-visible"),h[m]="material."+p}i.exports=function(){return{defaultComponents:{material:{}},mappings:u.extend({},h)}}},{"../../core/component":136,"../../core/shader":146,"../../utils/":212}],151:[function(n,i,o){n("./primitives/a-camera"),n("./primitives/a-cursor"),n("./primitives/a-curvedimage"),n("./primitives/a-gltf-model"),n("./primitives/a-image"),n("./primitives/a-light"),n("./primitives/a-link"),n("./primitives/a-obj-model"),n("./primitives/a-sky"),n("./primitives/a-sound"),n("./primitives/a-text"),n("./primitives/a-video"),n("./primitives/a-videosphere"),n("./primitives/meshPrimitives")},{"./primitives/a-camera":153,"./primitives/a-cursor":154,"./primitives/a-curvedimage":155,"./primitives/a-gltf-model":156,"./primitives/a-image":157,"./primitives/a-light":158,"./primitives/a-link":159,"./primitives/a-obj-model":160,"./primitives/a-sky":161,"./primitives/a-sound":162,"./primitives/a-text":163,"./primitives/a-video":164,"./primitives/a-videosphere":165,"./primitives/meshPrimitives":166}],152:[function(n,i,o){var s=n("../../core/a-entity"),c=n("../../core/component").components,u=n("../../core/a-register-element").registerElement,h=n("../../utils/"),f=h.debug,p=h.entity.setComponentProperty,m=f("extras:primitives:debug"),y=f("extras:primitives:warn"),g=i.exports.primitives={};i.exports.registerPrimitive=function(E,T){E=E.toLowerCase(),m("Registering <%s>",E),T.defaultAttributes&&y("The 'defaultAttributes' object is deprecated. Use 'defaultComponents' instead.");var P=u(E,{prototype:Object.create(s.prototype,{defaultComponentsFromPrimitive:{value:T.defaultComponents||T.defaultAttributes||{}},deprecated:{value:T.deprecated||null},deprecatedMappings:{value:T.deprecatedMappings||{}},mappings:{value:T.mappings||{}},createdCallback:{value:function(){T.deprecated&&console.warn(T.deprecated),this.resolveMappingCollisions()}},resolveMappingCollisions:{value:function(){var D=this.mappings,F=this;Object.keys(D).forEach(function(W){var j;W!==W.toLowerCase()&&y("Mapping keys should be specified in lower case. The mapping key "+W+" may not be recognized"),c[W]&&(j=D[W].replace(".","-"),D[j]=D[W],delete D[W],console.warn("The primitive "+F.tagName.toLowerCase()+" has a mapping collision. The attribute "+W+" has the same name as a registered component and has been renamed to "+j))})}},getExtraComponents:{value:function(){var D,F,k,W,j,J,de=this;for(F=h.clone(this.defaultComponentsFromPrimitive),j=this.getAttribute("mixin"),j&&(j=j.trim().split(" "),j.forEach(function(U){var $=de.sceneEl.querySelector("#"+U).componentCache;Object.keys($).forEach(function(Q){F[Q]=te(F[Q],$[Q])})})),k=0;k<this.attributes.length;k++)if(D=this.attributes[k],W=this.mappings[D.name],W){J=h.entity.getComponentPropertyPath(W),J.constructor===Array?(F[J[0]]=F[J[0]]||{},F[J[0]][J[1]]=D.value.trim()):F[J]=D.value.trim();continue}return F;function te(I,U){return N(I)?L(U):N(U)?L(I):M(I)&&M(U)?h.extendDeep(I,U):L(U)}function N(I){return typeof I=="undefined"}function L(I){return M(I)?h.extendDeep({},I):I}function M(I){return I!==null&&I.constructor===Object}}},attributeChangedCallback:{value:function(D,F,k){var W=this.mappings[D];D in this.deprecatedMappings&&console.warn(this.deprecatedMappings[D]),!(!D||!W)&&p(this,W,k)}}})});return g[E]=P,P};function _(b,E){var T=c[b].schema;Object.keys(T).map(function(P){var D=P.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();E[D]!==void 0&&(D=b+"-"+P),E[D]=b+"."+P})}function x(b,E,T){T=T||{},Object.keys(E).map(function(D){_(D,T)}),i.exports.registerPrimitive(b,h.extendDeep({},null,{defaultComponents:E,mappings:T}))}i.exports.definePrimitive=x},{"../../core/a-entity":132,"../../core/a-register-element":135,"../../core/component":136,"../../utils/":212}],153:[function(n,i,o){var s=n("../primitives").registerPrimitive;s("a-camera",{defaultComponents:{camera:{},"look-controls":{},"wasd-controls":{},position:{x:0,y:1.6,z:0}},mappings:{active:"camera.active",far:"camera.far",fov:"camera.fov","look-controls-enabled":"look-controls.enabled",near:"camera.near","pointer-lock-enabled":"look-controls.pointerLockEnabled","wasd-controls-enabled":"wasd-controls.enabled","reverse-mouse-drag":"look-controls.reverseMouseDrag",zoom:"camera.zoom"}})},{"../primitives":152}],154:[function(n,i,o){var s=n("../getMeshMixin"),c=n("../primitives").registerPrimitive,u=n("../../../utils/");c("a-cursor",u.extendDeep({},s(),{defaultComponents:{cursor:{},geometry:{primitive:"ring",radiusOuter:.016,radiusInner:.01,segmentsTheta:32},material:{color:"#000",shader:"flat",opacity:.8},position:{x:0,y:0,z:-1}},mappings:{far:"raycaster.far",fuse:"cursor.fuse","fuse-timeout":"cursor.fuseTimeout",interval:"raycaster.interval",objects:"raycaster.objects"}}))},{"../../../utils/":212,"../getMeshMixin":150,"../primitives":152}],155:[function(n,i,o){var s=n("../getMeshMixin"),c=n("../primitives").registerPrimitive,u=n("../../../utils/");c("a-curvedimage",u.extendDeep({},s(),{defaultComponents:{geometry:{height:1,primitive:"cylinder",radius:2,segmentsRadial:48,thetaLength:270,openEnded:!0,thetaStart:0},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0,repeat:"-1 1"}},mappings:{height:"geometry.height","open-ended":"geometry.openEnded",radius:"geometry.radius",segments:"geometry.segmentsRadial",start:"geometry.thetaStart","theta-length":"geometry.thetaLength","theta-start":"geometry.thetaStart",width:"geometry.thetaLength"}}))},{"../../../utils/":212,"../getMeshMixin":150,"../primitives":152}],156:[function(n,i,o){var s=n("../primitives").registerPrimitive;s("a-gltf-model",{mappings:{src:"gltf-model"}})},{"../primitives":152}],157:[function(n,i,o){var s=n("../getMeshMixin"),c=n("../primitives").registerPrimitive,u=n("../../../utils/");c("a-image",u.extendDeep({},s(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},{"../../../utils/":212,"../getMeshMixin":150,"../primitives":152}],158:[function(n,i,o){var s=n("../primitives").registerPrimitive;s("a-light",{defaultComponents:{light:{}},mappings:{angle:"light.angle",color:"light.color","ground-color":"light.groundColor",decay:"light.decay",distance:"light.distance",intensity:"light.intensity",penumbra:"light.penumbra",type:"light.type",target:"light.target",envmap:"light.envMap"}})},{"../primitives":152}],159:[function(n,i,o){var s=n("../primitives").registerPrimitive;s("a-link",{defaultComponents:{link:{visualAspectEnabled:!0}},mappings:{href:"link.href",image:"link.image",title:"link.title"}})},{"../primitives":152}],160:[function(n,i,o){var s=n("../getMeshMixin")(),c=n("../primitives").registerPrimitive,u=n("../../../utils/");c("a-obj-model",u.extendDeep({},s,{defaultComponents:{"obj-model":{}},mappings:{src:"obj-model.obj",mtl:"obj-model.mtl"}}))},{"../../../utils/":212,"../getMeshMixin":150,"../primitives":152}],161:[function(n,i,o){var s=n("../getMeshMixin"),c=n("../primitives").registerPrimitive,u=n("../../../utils/"),h=n("./meshPrimitives");c("a-sky",u.extendDeep({},s(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",side:"back",shader:"flat",npot:!0},scale:"-1 1 1"},mappings:u.extendDeep({},h["a-sphere"].prototype.mappings)}))},{"../../../utils/":212,"../getMeshMixin":150,"../primitives":152,"./meshPrimitives":166}],162:[function(n,i,o){var s=n("../primitives").registerPrimitive;s("a-sound",{defaultComponents:{sound:{}},mappings:{src:"sound.src",on:"sound.on",autoplay:"sound.autoplay",loop:"sound.loop",volume:"sound.volume"}})},{"../primitives":152}],163:[function(n,i,o){var s=n("../primitives").definePrimitive;s("a-text",{text:{anchor:"align",width:5}})},{"../primitives":152}],164:[function(n,i,o){var s=n("../getMeshMixin"),c=n("../primitives").registerPrimitive,u=n("../../../utils/");c("a-video",u.extendDeep({},s(),{defaultComponents:{geometry:{primitive:"plane"},material:{color:"#FFF",shader:"flat",side:"double",transparent:!0}},mappings:{height:"geometry.height",width:"geometry.width"}}))},{"../../../utils/":212,"../getMeshMixin":150,"../primitives":152}],165:[function(n,i,o){var s=n("../getMeshMixin"),c=n("../primitives").registerPrimitive,u=n("../../../utils/");c("a-videosphere",u.extendDeep({},s(),{defaultComponents:{geometry:{primitive:"sphere",radius:500,segmentsWidth:64,segmentsHeight:32},material:{color:"#FFF",shader:"flat",side:"back",npot:!0},scale:"-1 1 1"},mappings:{radius:"geometry.radius","segments-height":"geometry.segmentsHeight","segments-width":"geometry.segmentsWidth"}}))},{"../../../utils/":212,"../getMeshMixin":150,"../primitives":152}],166:[function(n,i,o){var s=n("../getMeshMixin"),c=n("../../../core/geometry").geometries,u=n("../../../core/geometry").geometryNames,h=n("../primitives").registerPrimitive,f=n("../../../utils/"),p=i.exports={};u.forEach(function(g){var _=c[g],x=m(g),b={};Object.keys(_.schema).forEach(function(D){b[m(D)]="geometry."+D});var E="a-"+x,T=h(E,f.extendDeep({},s(),{defaultComponents:{geometry:{primitive:g}},mappings:b}));p[E]=T});function m(y){return y.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}},{"../../../core/geometry":137,"../../../utils/":212,"../getMeshMixin":150,"../primitives":152}],167:[function(n,i,o){var s=n("../core/geometry").registerGeometry,c=n("../lib/three");s("box",{schema:{depth:{default:1,min:0},height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"},segmentsDepth:{default:1,min:1,max:20,type:"int"}},init:function(u){this.geometry=new c.BoxGeometry(u.width,u.height,u.depth,u.segmentsWidth,u.segmentsHeight,u.segmentsDepth)}})},{"../core/geometry":137,"../lib/three":184}],168:[function(n,i,o){var s=n("../core/geometry").registerGeometry,c=n("../lib/three"),u=c.Math.degToRad;s("circle",{schema:{radius:{default:1,min:0},segments:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(h){this.geometry=new c.CircleGeometry(h.radius,h.segments,u(h.thetaStart),u(h.thetaLength))}})},{"../core/geometry":137,"../lib/three":184}],169:[function(n,i,o){var s=n("../core/geometry").registerGeometry,c=n("../lib/three"),u=c.Math.degToRad;s("cone",{schema:{height:{default:1,min:0},openEnded:{default:!1},radiusBottom:{default:1,min:0},radiusTop:{default:.01,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(h){this.geometry=new c.CylinderGeometry(h.radiusTop,h.radiusBottom,h.height,h.segmentsRadial,h.segmentsHeight,h.openEnded,u(h.thetaStart),u(h.thetaLength))}})},{"../core/geometry":137,"../lib/three":184}],170:[function(n,i,o){var s=n("../core/geometry").registerGeometry,c=n("../lib/three"),u=c.Math.degToRad;s("cylinder",{schema:{height:{default:1,min:0},openEnded:{default:!1},radius:{default:1,min:0},segmentsHeight:{default:18,min:1,type:"int"},segmentsRadial:{default:36,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(h){this.geometry=new c.CylinderGeometry(h.radius,h.radius,h.height,h.segmentsRadial,h.segmentsHeight,h.openEnded,u(h.thetaStart),u(h.thetaLength))}})},{"../core/geometry":137,"../lib/three":184}],171:[function(n,i,o){var s=n("../core/geometry").registerGeometry,c=n("../lib/three");s("dodecahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(u){this.geometry=new c.DodecahedronGeometry(u.radius,u.detail)}})},{"../core/geometry":137,"../lib/three":184}],172:[function(n,i,o){var s=n("../core/geometry").registerGeometry,c=n("../lib/three");s("icosahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(u){this.geometry=new c.IcosahedronGeometry(u.radius,u.detail)}})},{"../core/geometry":137,"../lib/three":184}],173:[function(n,i,o){n("./box.js"),n("./circle.js"),n("./cone.js"),n("./cylinder.js"),n("./dodecahedron.js"),n("./icosahedron.js"),n("./octahedron.js"),n("./plane.js"),n("./ring.js"),n("./sphere.js"),n("./tetrahedron.js"),n("./torus.js"),n("./torusKnot.js"),n("./triangle.js")},{"./box.js":167,"./circle.js":168,"./cone.js":169,"./cylinder.js":170,"./dodecahedron.js":171,"./icosahedron.js":172,"./octahedron.js":174,"./plane.js":175,"./ring.js":176,"./sphere.js":177,"./tetrahedron.js":178,"./torus.js":179,"./torusKnot.js":180,"./triangle.js":181}],174:[function(n,i,o){var s=n("../core/geometry").registerGeometry,c=n("../lib/three");s("octahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(u){this.geometry=new c.OctahedronGeometry(u.radius,u.detail)}})},{"../core/geometry":137,"../lib/three":184}],175:[function(n,i,o){var s=n("../core/geometry").registerGeometry,c=n("../lib/three");s("plane",{schema:{height:{default:1,min:0},width:{default:1,min:0},segmentsHeight:{default:1,min:1,max:20,type:"int"},segmentsWidth:{default:1,min:1,max:20,type:"int"}},init:function(u){this.geometry=new c.PlaneGeometry(u.width,u.height,u.segmentsWidth,u.segmentsHeight)}})},{"../core/geometry":137,"../lib/three":184}],176:[function(n,i,o){var s=n("../core/geometry").registerGeometry,c=n("../lib/three"),u=c.Math.degToRad;s("ring",{schema:{radiusInner:{default:.8,min:0},radiusOuter:{default:1.2,min:0},segmentsPhi:{default:10,min:1,type:"int"},segmentsTheta:{default:32,min:3,type:"int"},thetaLength:{default:360,min:0},thetaStart:{default:0}},init:function(h){this.geometry=new c.RingGeometry(h.radiusInner,h.radiusOuter,h.segmentsTheta,h.segmentsPhi,u(h.thetaStart),u(h.thetaLength))}})},{"../core/geometry":137,"../lib/three":184}],177:[function(n,i,o){var s=n("../core/geometry").registerGeometry,c=n("../lib/three"),u=c.Math.degToRad;s("sphere",{schema:{radius:{default:1,min:0},phiLength:{default:360},phiStart:{default:0,min:0},thetaLength:{default:180,min:0},thetaStart:{default:0},segmentsHeight:{default:18,min:2,type:"int"},segmentsWidth:{default:36,min:3,type:"int"}},init:function(h){this.geometry=new c.SphereGeometry(h.radius,h.segmentsWidth,h.segmentsHeight,u(h.phiStart),u(h.phiLength),u(h.thetaStart),u(h.thetaLength))}})},{"../core/geometry":137,"../lib/three":184}],178:[function(n,i,o){var s=n("../core/geometry").registerGeometry,c=n("../lib/three");s("tetrahedron",{schema:{detail:{default:0,min:0,max:5,type:"int"},radius:{default:1,min:0}},init:function(u){this.geometry=new c.TetrahedronGeometry(u.radius,u.detail)}})},{"../core/geometry":137,"../lib/three":184}],179:[function(n,i,o){var s=n("../core/geometry").registerGeometry,c=n("../lib/three"),u=c.Math.degToRad;s("torus",{schema:{arc:{default:360},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:36,min:2,type:"int"},segmentsTubular:{default:32,min:3,type:"int"}},init:function(h){this.geometry=new c.TorusGeometry(h.radius,h.radiusTubular*2,h.segmentsRadial,h.segmentsTubular,u(h.arc))}})},{"../core/geometry":137,"../lib/three":184}],180:[function(n,i,o){var s=n("../core/geometry").registerGeometry,c=n("../lib/three");s("torusKnot",{schema:{p:{default:2,min:1},q:{default:3,min:1},radius:{default:1,min:0},radiusTubular:{default:.2,min:0},segmentsRadial:{default:8,min:3,type:"int"},segmentsTubular:{default:100,min:3,type:"int"}},init:function(u){this.geometry=new c.TorusKnotGeometry(u.radius,u.radiusTubular*2,u.segmentsTubular,u.segmentsRadial,u.p,u.q)}})},{"../core/geometry":137,"../lib/three":184}],181:[function(n,i,o){var s=n("../core/geometry").registerGeometry,c=n("../lib/three"),u=new c.Quaternion,h=new c.Vector3(0,0,1),f=new c.Vector2,p=new c.Vector2,m=new c.Vector2;s("triangle",{schema:{vertexA:{type:"vec3",default:{x:0,y:.5,z:0}},vertexB:{type:"vec3",default:{x:-.5,y:-.5,z:0}},vertexC:{type:"vec3",default:{x:.5,y:-.5,z:0}}},init:function(y){var g,_,x,b,E,T,P,D,F;x=new c.Triangle,x.a.set(y.vertexA.x,y.vertexA.y,y.vertexA.z),x.b.set(y.vertexB.x,y.vertexB.y,y.vertexB.z),x.c.set(y.vertexC.x,y.vertexC.y,y.vertexC.z),_=x.getNormal(new c.Vector3),u.setFromUnitVectors(_,h),b=x.a.clone().applyQuaternion(u),E=x.b.clone().applyQuaternion(u),T=x.c.clone().applyQuaternion(u),f.set(Math.min(b.x,E.x,T.x),Math.min(b.y,E.y,T.y)),p.set(Math.max(b.x,E.x,T.x),Math.max(b.y,E.y,T.y)),m.set(0,0).subVectors(p,f),b=new c.Vector2().subVectors(b,f).divide(m),E=new c.Vector2().subVectors(E,f).divide(m),T=new c.Vector2().subVectors(T,f).divide(m),g=this.geometry=new c.BufferGeometry,P=[x.a.x,x.a.y,x.a.z,x.b.x,x.b.y,x.b.z,x.c.x,x.c.y,x.c.z],D=[_.x,_.y,_.z,_.x,_.y,_.z,_.x,_.y,_.z],F=[b.x,b.y,E.x,E.y,T.x,T.y],g.setAttribute("position",new c.Float32BufferAttribute(P,3)),g.setAttribute("normal",new c.Float32BufferAttribute(D,3)),g.setAttribute("uv",new c.Float32BufferAttribute(F,2))}})},{"../core/geometry":137,"../lib/three":184}],182:[function(n,i,o){if(window.Promise=window.Promise||n("promise-polyfill"),window.hasNativeWebVRImplementation=!!window.navigator.getVRDisplays||!!window.navigator.getVRDevices,window.hasNativeWebXRImplementation=navigator.xr!==void 0,!window.hasNativeWebXRImplementation&&!window.hasNativeWebVRImplementation){var s=n("./utils/isIOSOlderThan10"),c=s(window.navigator.userAgent)?1/window.devicePixelRatio:1,u=n("webvr-polyfill"),h={BUFFER_SCALE:c,CARDBOARD_UI_DISABLED:!0,ROTATE_INSTRUCTIONS_DISABLED:!0,MOBILE_WAKE_LOCK:!!window.cordova};window.webvrpolyfill=new u(h)}var f=n("./utils/"),p=f.debug;f.isIE11&&(n("custom-event-polyfill"),n("../vendor/starts-with-polyfill"));var m=p("A-Frame:error"),y=p("A-Frame:warn");window.document.currentScript&&window.document.currentScript.parentNode!==window.document.head&&!window.debug&&y("Put the A-Frame <script> tag in the <head> of the HTML *before* the scene to ensure everything for A-Frame is properly registered before they are used from HTML."),!window.cordova&&window.location.protocol==="file:"&&m("This HTML file is currently being served via the file:// protocol. Assets, textures, and models WILL NOT WORK due to cross-origin policy! Please use a local or hosted server: https://aframe.io/docs/0.5.0/introduction/getting-started.html#using-a-local-server."),n("present"),f.device.isBrowserEnvironment&&(n("./style/aframe.css"),n("./style/rStats.css"));var g=n("./core/scene/a-scene").AScene,_=n("./core/component").components,x=n("./core/component").registerComponent,b=n("./core/geometry").registerGeometry,E=n("./extras/primitives/primitives").registerPrimitive,T=n("./core/shader").registerShader,P=n("./core/system").registerSystem,D=n("./core/shader").shaders,F=n("./core/system").systems,k=window.THREE=n("./lib/three"),W=n("../package");n("./components/index"),n("./geometries/index"),n("./shaders/index"),n("./systems/index");var j=n("./core/a-node"),J=n("./core/a-entity");n("./core/a-assets"),n("./core/a-cubemap"),n("./core/a-mixin"),n("./extras/components/"),n("./extras/primitives/"),console.log("A-Frame Version: 1.3.0 (Date 2022-02-04, Commit #cc3516ce)"),console.log("THREE Version (https://github.com/supermedium/three.js):",W.dependencies["super-three"]),console.log("WebVR Polyfill Version:",W.dependencies["webvr-polyfill"]),i.exports=window.AFRAME={AComponent:n("./core/component").Component,AEntity:J,ANode:j,ANIME:n("super-animejs"),AScene:g,components:_,coreComponents:Object.keys(_),geometries:n("./core/geometry").geometries,registerComponent:x,registerElement:n("./core/a-register-element").registerElement,registerGeometry:b,registerPrimitive:E,registerShader:T,registerSystem:P,primitives:{getMeshMixin:n("./extras/primitives/getMeshMixin"),primitives:n("./extras/primitives/primitives").primitives},scenes:n("./core/scene/scenes"),schema:n("./core/schema"),shaders:D,systems:F,THREE:k,utils:f,version:W.version}},{"../package":74,"../vendor/starts-with-polyfill":225,"./components/index":87,"./core/a-assets":130,"./core/a-cubemap":131,"./core/a-entity":132,"./core/a-mixin":133,"./core/a-node":134,"./core/a-register-element":135,"./core/component":136,"./core/geometry":137,"./core/scene/a-scene":139,"./core/scene/scenes":143,"./core/schema":145,"./core/shader":146,"./core/system":147,"./extras/components/":148,"./extras/primitives/":151,"./extras/primitives/getMeshMixin":150,"./extras/primitives/primitives":152,"./geometries/index":173,"./lib/three":184,"./shaders/index":186,"./style/aframe.css":193,"./style/rStats.css":194,"./systems/index":198,"./utils/":212,"./utils/isIOSOlderThan10":215,"custom-event-polyfill":7,present:48,"promise-polyfill":50,"super-animejs":56,"webvr-polyfill":69}],183:[function(n,i,o){window.aframeStats=function(s){var c=null,u=s,h={te:{caption:"Entities"},lt:{caption:"Load Time"}},f=[{caption:"A-Frame",values:["te","lt"]}];function p(){c("te").set(m()),window.performance.getEntriesByName&&c("lt").set(window.performance.getEntriesByName("render-started")[0].startTime.toFixed(0))}function m(){var x=u.querySelectorAll("*");return Array.prototype.slice.call(x).filter(function(b){return b.isEntity}),x.length}function y(){}function g(){}function _(x){c=x}return{update:p,start:y,end:g,attach:_,values:h,groups:f,fractions:[]}},typeof i=="object"&&(i.exports={aframeStats:window.aframeStats})},{}],184:[function(n,i,o){(function(s){var c=s.THREE=n("super-three");c.TextureLoader&&(c.TextureLoader.prototype.crossOrigin="anonymous"),c.ImageLoader&&(c.ImageLoader.prototype.crossOrigin="anonymous"),c.Cache&&(c.Cache.enabled=!0),n("../../vendor/DeviceOrientationControls"),n("super-three/examples/js/loaders/DRACOLoader"),n("super-three/examples/js/loaders/GLTFLoader"),n("super-three/examples/js/loaders/OBJLoader"),n("super-three/examples/js/loaders/MTLLoader"),n("super-three/examples/js/utils/BufferGeometryUtils"),n("super-three/examples/js/lights/LightProbeGenerator"),c.DRACOLoader.prototype.crossOrigin="anonymous",c.GLTFLoader.prototype.crossOrigin="anonymous",c.MTLLoader.prototype.crossOrigin="anonymous",c.OBJLoader.prototype.crossOrigin="anonymous",i.exports=c}).call(this,typeof Tr!="undefined"?Tr:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{"../../vendor/DeviceOrientationControls":222,"super-three":57,"super-three/examples/js/lights/LightProbeGenerator":58,"super-three/examples/js/loaders/DRACOLoader":59,"super-three/examples/js/loaders/GLTFLoader":60,"super-three/examples/js/loaders/MTLLoader":61,"super-three/examples/js/loaders/OBJLoader":62,"super-three/examples/js/utils/BufferGeometryUtils":63}],185:[function(n,i,o){var s=n("../core/shader").registerShader,c=n("../lib/three"),u=n("../utils/");i.exports.Shader=s("flat",{schema:{color:{type:"color"},fog:{default:!0},height:{default:256},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2}},init:function(f){this.rendererSystem=this.el.sceneEl.systems.renderer,this.materialData={color:new c.Color},this.textureSrc=null,h(f,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color),this.material=new c.MeshBasicMaterial(this.materialData),u.material.updateMap(this,f)},update:function(f){this.updateMaterial(f),u.material.updateMap(this,f)},updateMaterial:function(f){var p;h(f,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color);for(p in this.materialData)this.material[p]=this.materialData[p]}});function h(f,p){return p.color.set(f.color),p.fog=f.fog,p.wireframe=f.wireframe,p.wireframeLinewidth=f.wireframeLinewidth,p}},{"../core/shader":146,"../lib/three":184,"../utils/":212}],186:[function(n,i,o){n("./flat"),n("./standard"),n("./phong"),n("./sdf"),n("./msdf"),n("./ios10hls"),n("./shadow")},{"./flat":185,"./ios10hls":187,"./msdf":188,"./phong":189,"./sdf":190,"./shadow":191,"./standard":192}],187:[function(n,i,o){var s=n("../core/shader").registerShader;i.exports.Shader=s("ios10hls",{schema:{src:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},vertexShader:["varying vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join(`
`),fragmentShader:["uniform sampler2D src;","uniform float opacity;","varying vec2 vUV;","void main() {","  vec2 offset = vec2(0, 0);","  vec2 repeat = vec2(1, 1);","  vec4 color = texture2D(src, vec2(vUV.x / repeat.x + offset.x, (1.0 - vUV.y) / repeat.y + offset.y)).bgra;","  gl_FragColor = vec4(color.rgb, opacity);","}"].join(`
`)})},{"../core/shader":146}],188:[function(n,i,o){var s=n("../core/shader").registerShader,c=!!document.createElement("canvas").getContext("webgl2"),u=["attribute vec2 uv;","attribute vec3 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join(`
`),h=["#version 300 es","in vec2 uv;","in vec3 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","out vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join(`
`),f=c?h:u,p=["#ifdef GL_OES_standard_derivatives","#extension GL_OES_standard_derivatives: enable","#endif","precision highp float;","uniform bool negate;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","varying vec2 vUV;","float median(float r, float g, float b) {","  return max(min(r, g), min(max(r, g), b));","}","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","void main() {","  vec3 sampleColor = texture2D(map, vUV).rgb;","  if (negate) { sampleColor = 1.0 - sampleColor; }","  float sigDist = median(sampleColor.r, sampleColor.g, sampleColor.b) - 0.5;","  float alpha = clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(vUV) + dFdy(vUV));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  // Do modified alpha test.","  if (isBigEnough > BIG_ENOUGH) {","    float ratio = BIG_ENOUGH / isBigEnough;","    alpha = ratio * alpha + (1.0 - ratio) * (sigDist + 0.5);","  }","  // Do modified alpha test.","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  gl_FragColor = vec4(color.xyz, alpha * opacity);","}"].join(`
`),m=["#version 300 es","precision highp float;","uniform bool negate;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","in vec2 vUV;","out vec4 fragColor;","float median(float r, float g, float b) {","  return max(min(r, g), min(max(r, g), b));","}","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","void main() {","  vec3 sampleColor = texture(map, vUV).rgb;","  if (negate) { sampleColor = 1.0 - sampleColor; }","  float sigDist = median(sampleColor.r, sampleColor.g, sampleColor.b) - 0.5;","  float alpha = clamp(sigDist / fwidth(sigDist) + 0.5, 0.0, 1.0);","  float dscale = 0.353505;","  vec2 duv = dscale * (dFdx(vUV) + dFdy(vUV));","  float isBigEnough = max(abs(duv.x), abs(duv.y));","  // Do modified alpha test.","  if (isBigEnough > BIG_ENOUGH) {","    float ratio = BIG_ENOUGH / isBigEnough;","    alpha = ratio * alpha + (1.0 - ratio) * (sigDist + 0.5);","  }","  // Do modified alpha test.","  if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  fragColor = vec4(color.xyz, alpha * opacity);","}"].join(`
`),y=c?m:p;i.exports.Shader=s("msdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},negate:{type:"boolean",is:"uniform",default:!0},opacity:{type:"number",is:"uniform",default:1}},raw:!0,vertexShader:f,fragmentShader:y})},{"../core/shader":146}],189:[function(n,i,o){var s=n("../core/shader").registerShader,c=n("../lib/three"),u=n("../utils/"),h=new c.CubeTextureLoader,f={};i.exports.Shader=s("phong",{schema:{color:{type:"color"},emissive:{type:"color",default:"black"},emissiveIntensity:{default:1},specular:{type:"color",default:"#111111"},transparent:{default:!1},fog:{default:!0},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},src:{type:"map"},envMap:{default:""},sphericalEnvMap:{type:"map"},shininess:{default:30},flatShading:{default:!1},wireframe:{default:!1},wireframeLinewidth:{default:2},combine:{oneOF:["multiply","mix","add"],default:"mix"},reflectivity:{default:.9},refractionRatio:{default:.98},refract:{default:!1},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},bumpMap:{type:"map"},bumpMapScale:{default:1},bumpTextureOffset:{type:"vec2"},bumpTextureRepeat:{type:"vec2",default:{x:1,y:1}}},init:function(m){this.rendererSystem=this.el.sceneEl.systems.renderer,this.materialData={color:new c.Color,specular:new c.Color,emissive:new c.Color},this.textureSrc=null,p(m,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color),this.material=new c.MeshPhongMaterial(this.materialData),u.material.updateMap(this,m)},update:function(m){this.updateMaterial(m),u.material.updateMap(this,m),m.normalMap&&u.material.updateDistortionMap("normal",this,m),m.displacementMap&&u.material.updateDistortionMap("displacement",this,m),m.ambientOcclusionMap&&u.material.updateDistortionMap("ambientOcclusion",this,m),m.bump&&u.material.updateDistortionMap("bump",this,m),this.updateEnvMap(m)},updateMaterial:function(m){var y;p(m,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color);for(y in this.materialData)this.material[y]=this.materialData[y]},updateEnvMap:function(m){var y=this,g=this.material,_=m.envMap,x=m.sphericalEnvMap,b=m.refract,E=this.el.sceneEl;if(!_&&!x||this.isLoadingEnvMap){Object.defineProperty(g,"envMap",{get:function(){return E.object3D.environment},set:function(T){delete this.envMap,this.envMap=T}}),g.needsUpdate=!0;return}if(this.isLoadingEnvMap=!0,delete g.envMap,x){this.el.sceneEl.systems.material.loadTexture(x,{src:x},function(P){y.isLoadingEnvMap=!1,P.mapping=b?c.EquirectangularRefractionMapping:c.EquirectangularReflectionMapping,g.envMap=P,u.material.handleTextureEvents(y.el,P),g.needsUpdate=!0});return}if(f[_]){f[_].then(function(T){y.isLoadingEnvMap=!1,g.envMap=T,u.material.handleTextureEvents(y.el,T),g.needsUpdate=!0});return}f[_]=new Promise(function(T){u.srcLoader.validateCubemapSrc(_,function(D){h.load(D,function(F){y.isLoadingEnvMap=!1,g.envMap=F,F.mapping=b?c.CubeRefractionMapping:c.CubeReflectionMapping,u.material.handleTextureEvents(y.el,F),T(F)})})})}});function p(m,y){switch(y.color.set(m.color),y.specular.set(m.emissive),y.emissive.set(m.emissive),y.emissiveIntensity=m.emissiveIntensity,y.fog=m.fog,y.transparent=m.transparent,y.wireframe=m.wireframe,y.wireframeLinewidth=m.wireframeLinewidth,y.shininess=m.shininess,y.flatShading=m.flatShading,y.wireframe=m.wireframe,y.wireframeLinewidth=m.wireframeLinewidth,y.reflectivity=m.reflectivity,y.refractionRatio=m.refractionRatio,m.combine){case"mix":y.combine=c.MixOperation;break;case"multiply":y.combine=c.MultiplyOperation;break;case"add":y.combine=c.AddOperation;break}return m.normalMap&&(y.normalScale=m.normalScale),m.ambientOcclusionMap&&(y.aoMapIntensity=m.ambientOcclusionMapIntensity),m.bumpMap&&(y.aoMapIntensity=m.bumpMapScale),m.displacementMap&&(y.displacementScale=m.displacementScale,y.displacementBias=m.displacementBias),y}},{"../core/shader":146,"../lib/three":184,"../utils/":212}],190:[function(n,i,o){var s=n("../core/shader").registerShader,c=!!document.createElement("canvas").getContext("webgl2"),u=["attribute vec2 uv;","attribute vec3 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","varying vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join(`
`),h=["#version 300 es","in vec2 uv;","in vec3 position;","uniform mat4 projectionMatrix;","uniform mat4 modelViewMatrix;","out vec2 vUV;","void main(void) {","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","  vUV = uv;","}"].join(`
`),f=c?h:u,p=["#ifdef GL_OES_standard_derivatives","#extension GL_OES_standard_derivatives: enable","#endif","precision highp float;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","varying vec2 vUV;","#ifdef GL_OES_standard_derivatives","  float contour(float width, float value) {","    return smoothstep(0.5 - value, 0.5 + value, width);","  }","#else","  float aastep(float value, float afwidth) {","    return smoothstep(0.5 - afwidth, 0.5 + afwidth, value);","  }","#endif","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","#define ALL_SMOOTH 0.4","#define ALL_ROUGH 0.02","#define DISCARD_ALPHA (alphaTest / (2.2 - 1.2 * ratio))","void main() {","  #ifdef GL_OES_standard_derivatives","    vec2 uv = vUV;","    vec4 texColor = texture2D(map, uv);","    float dist = texColor.a;","    float width = fwidth(dist);","    float alpha = contour(dist, width);","    float dscale = 0.353505;","    vec2 duv = dscale * (dFdx(uv) + dFdy(uv));","    float isBigEnough = max(abs(duv.x), abs(duv.y));","    if (isBigEnough > BIG_ENOUGH) {","      float ratio = BIG_ENOUGH / isBigEnough;","      alpha = ratio * alpha + (1.0 - ratio) * dist;","    }","    if (isBigEnough <= BIG_ENOUGH) {","      vec4 box = vec4 (uv - duv, uv + duv);","      alpha = (alpha + 0.5 * (","        contour(texture2D(map, box.xy).a, width)","        + contour(texture2D(map, box.zw).a, width)","        + contour(texture2D(map, box.xw).a, width)","        + contour(texture2D(map, box.zy).a, width)","      )) / 3.0;","    }","    if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  #else","    vec4 texColor = texture2D(map, vUV);","    float value = texColor.a;","    float afwidth = (1.0 / 32.0) * (1.4142135623730951 / (2.0 * gl_FragCoord.w));","    float alpha = aastep(value, afwidth);","    float ratio = (gl_FragCoord.w >= ALL_SMOOTH) ? 1.0 : (gl_FragCoord.w < ALL_ROUGH) ? 0.0 : (gl_FragCoord.w - ALL_ROUGH) / (ALL_SMOOTH - ALL_ROUGH);","    if (alpha < alphaTest) { if (ratio >= 1.0) { discard; return; } alpha = 0.0; }","    alpha = alpha * ratio + (1.0 - ratio) * value;","    if (ratio < 1.0 && alpha <= DISCARD_ALPHA) { discard; return; }","  #endif","  gl_FragColor = vec4(color, opacity * alpha);","}"].join(`
`),m=["#version 300 es","precision highp float;","uniform float alphaTest;","uniform float opacity;","uniform sampler2D map;","uniform vec3 color;","in vec2 vUV;","out vec4 fragColor;","#ifdef GL_OES_standard_derivatives","  float contour(float width, float value) {","    return smoothstep(0.5 - value, 0.5 + value, width);","  }","#else","  float aastep(float value, float afwidth) {","    return smoothstep(0.5 - afwidth, 0.5 + afwidth, value);","  }","#endif","#define BIG_ENOUGH 0.001","#define MODIFIED_ALPHATEST (0.02 * isBigEnough / BIG_ENOUGH)","#define ALL_SMOOTH 0.4","#define ALL_ROUGH 0.02","#define DISCARD_ALPHA (alphaTest / (2.2 - 1.2 * ratio))","void main() {","  #ifdef GL_OES_standard_derivatives","    vec2 uv = vUV;","    vec4 texColor = texture(map, uv);","    float dist = texColor.a;","    float width = fwidth(dist);","    float alpha = contour(dist, width);","    float dscale = 0.353505;","    vec2 duv = dscale * (dFdx(uv) + dFdy(uv));","    float isBigEnough = max(abs(duv.x), abs(duv.y));","    if (isBigEnough > BIG_ENOUGH) {","      float ratio = BIG_ENOUGH / isBigEnough;","      alpha = ratio * alpha + (1.0 - ratio) * dist;","    }","    if (isBigEnough <= BIG_ENOUGH) {","      vec4 box = vec4 (uv - duv, uv + duv);","      alpha = (alpha + 0.5 * (","        contour(texture(map, box.xy).a, width)","        + contour(texture(map, box.zw).a, width)","        + contour(texture(map, box.xw).a, width)","        + contour(texture(map, box.zy).a, width)","      )) / 3.0;","    }","    if (alpha < alphaTest * MODIFIED_ALPHATEST) { discard; return; }","  #else","    vec4 texColor = texture(map, vUV);","    float value = texColor.a;","    float afwidth = (1.0 / 32.0) * (1.4142135623730951 / (2.0 * gl_FragCoord.w));","    float alpha = aastep(value, afwidth);","    float ratio = (gl_FragCoord.w >= ALL_SMOOTH) ? 1.0 : (gl_FragCoord.w < ALL_ROUGH) ? 0.0 : (gl_FragCoord.w - ALL_ROUGH) / (ALL_SMOOTH - ALL_ROUGH);","    if (alpha < alphaTest) { if (ratio >= 1.0) { discard; return; } alpha = 0.0; }","    alpha = alpha * ratio + (1.0 - ratio) * value;","    if (ratio < 1.0 && alpha <= DISCARD_ALPHA) { discard; return; }","  #endif","  fragColor = vec4(color, opacity * alpha);","}"].join(`
`),y=c?m:p;i.exports.Shader=s("sdf",{schema:{alphaTest:{type:"number",is:"uniform",default:.5},color:{type:"color",is:"uniform",default:"white"},map:{type:"map",is:"uniform"},opacity:{type:"number",is:"uniform",default:1}},raw:!0,vertexShader:f,fragmentShader:y})},{"../core/shader":146}],191:[function(n,i,o){var s=n("../core/shader").registerShader,c=n("../lib/three");i.exports.Shader=s("shadow",{schema:{opacity:{default:.5},transparent:{default:!0},alphaToCoverage:{default:!0}},init:function(u){this.rendererSystem=this.el.sceneEl.systems.renderer,this.material=new c.ShadowMaterial},update:function(u){this.material.opacity=u.opacity,this.material.alphaToCoverage=u.alphaToCoverage,this.material.transparent=u.transparent}})},{"../core/shader":146,"../lib/three":184}],192:[function(n,i,o){var s=n("../core/shader").registerShader,c=n("../lib/three"),u=n("../utils/"),h=new c.CubeTextureLoader,f={};i.exports.Shader=s("standard",{schema:{ambientOcclusionMap:{type:"map"},ambientOcclusionMapIntensity:{default:1},ambientOcclusionTextureOffset:{type:"vec2"},ambientOcclusionTextureRepeat:{type:"vec2",default:{x:1,y:1}},color:{type:"color"},displacementMap:{type:"map"},displacementScale:{default:1},displacementBias:{default:.5},displacementTextureOffset:{type:"vec2"},displacementTextureRepeat:{type:"vec2",default:{x:1,y:1}},emissive:{type:"color",default:"#000"},emissiveIntensity:{default:1},envMap:{default:""},fog:{default:!0},height:{default:256},metalness:{default:0,min:0,max:1},metalnessMap:{type:"map"},metalnessTextureOffset:{type:"vec2"},metalnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},normalMap:{type:"map"},normalScale:{type:"vec2",default:{x:1,y:1}},normalTextureOffset:{type:"vec2"},normalTextureRepeat:{type:"vec2",default:{x:1,y:1}},offset:{type:"vec2",default:{x:0,y:0}},repeat:{type:"vec2",default:{x:1,y:1}},roughness:{default:.5,min:0,max:1},roughnessMap:{type:"map"},roughnessTextureOffset:{type:"vec2"},roughnessTextureRepeat:{type:"vec2",default:{x:1,y:1}},sphericalEnvMap:{type:"map"},src:{type:"map"},width:{default:512},wireframe:{default:!1},wireframeLinewidth:{default:2}},init:function(m){this.rendererSystem=this.el.sceneEl.systems.renderer,this.materialData={color:new c.Color,emissive:new c.Color},p(m,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color),this.rendererSystem.applyColorCorrection(this.materialData.emissive),this.material=new c.MeshStandardMaterial(this.materialData),u.material.updateMap(this,m),m.normalMap&&u.material.updateDistortionMap("normal",this,m),m.displacementMap&&u.material.updateDistortionMap("displacement",this,m),m.ambientOcclusionMap&&u.material.updateDistortionMap("ambientOcclusion",this,m),m.metalnessMap&&u.material.updateDistortionMap("metalness",this,m),m.roughnessMap&&u.material.updateDistortionMap("roughness",this,m),this.updateEnvMap(m)},update:function(m){this.updateMaterial(m),u.material.updateMap(this,m),m.normalMap&&u.material.updateDistortionMap("normal",this,m),m.displacementMap&&u.material.updateDistortionMap("displacement",this,m),m.ambientOcclusionMap&&u.material.updateDistortionMap("ambientOcclusion",this,m),m.metalnessMap&&u.material.updateDistortionMap("metalness",this,m),m.roughnessMap&&u.material.updateDistortionMap("roughness",this,m),this.updateEnvMap(m)},updateMaterial:function(m){var y,g=this.material;p(m,this.materialData),this.rendererSystem.applyColorCorrection(this.materialData.color),this.rendererSystem.applyColorCorrection(this.materialData.emissive);for(y in this.materialData)g[y]=this.materialData[y]},updateEnvMap:function(m){var y=this,g=this.material,_=m.envMap,x=m.sphericalEnvMap;if(!_&&!x||this.isLoadingEnvMap){g.envMap=null,g.needsUpdate=!0;return}if(this.isLoadingEnvMap=!0,x){this.el.sceneEl.systems.material.loadTexture(x,{src:x},function(E){y.isLoadingEnvMap=!1,E.mapping=c.EquirectangularReflectionMapping,g.envMap=E,u.material.handleTextureEvents(y.el,E),g.needsUpdate=!0});return}if(f[_]){f[_].then(function(b){y.isLoadingEnvMap=!1,g.envMap=b,u.material.handleTextureEvents(y.el,b),g.needsUpdate=!0});return}f[_]=new Promise(function(b){u.srcLoader.validateCubemapSrc(_,function(T){h.load(T,function(P){y.isLoadingEnvMap=!1,g.envMap=P,u.material.handleTextureEvents(y.el,P),b(P)})})})}});function p(m,y){return y.color.set(m.color),y.emissive.set(m.emissive),y.emissiveIntensity=m.emissiveIntensity,y.fog=m.fog,y.metalness=m.metalness,y.roughness=m.roughness,y.wireframe=m.wireframe,y.wireframeLinewidth=m.wireframeLinewidth,m.normalMap&&(y.normalScale=m.normalScale),m.ambientOcclusionMap&&(y.aoMapIntensity=m.ambientOcclusionMapIntensity),m.displacementMap&&(y.displacementScale=m.displacementScale,y.displacementBias=m.displacementBias),y}},{"../core/shader":146,"../lib/three":184,"../utils/":212}],193:[function(n,i,o){var s=`html.a-fullscreen{bottom:0;left:0;position:fixed;right:0;top:0}html.a-fullscreen body{height:100%;margin:0;overflow:hidden;padding:0;width:100%}html.a-fullscreen .a-canvas{width:100%!important;height:100%!important;top:0!important;left:0!important;right:0!important;bottom:0!important;position:fixed!important}html:not(.a-fullscreen) .a-enter-ar,html:not(.a-fullscreen) .a-enter-vr{right:5px;bottom:5px}:-webkit-full-screen{background-color:transparent}.a-hidden{display:none!important}.a-canvas{height:100%;left:0;position:absolute;top:0;width:100%}.a-canvas.a-grab-cursor:hover{cursor:grab;cursor:-moz-grab;cursor:-webkit-grab}canvas.a-canvas.a-mouse-cursor-hover:hover{cursor:pointer}.a-inspector-loader{background-color:#ed3160;position:fixed;left:3px;top:3px;padding:6px 10px;color:#fff;text-decoration:none;font-size:12px;font-family:Roboto,sans-serif;text-align:center;z-index:99999;width:204px}@keyframes dots-1{from{opacity:0}25%{opacity:1}}@keyframes dots-2{from{opacity:0}50%{opacity:1}}@keyframes dots-3{from{opacity:0}75%{opacity:1}}@-webkit-keyframes dots-1{from{opacity:0}25%{opacity:1}}@-webkit-keyframes dots-2{from{opacity:0}50%{opacity:1}}@-webkit-keyframes dots-3{from{opacity:0}75%{opacity:1}}.a-inspector-loader .dots span{animation:dots-1 2s infinite steps(1);-webkit-animation:dots-1 2s infinite steps(1)}.a-inspector-loader .dots span:first-child+span{animation-name:dots-2;-webkit-animation-name:dots-2}.a-inspector-loader .dots span:first-child+span+span{animation-name:dots-3;-webkit-animation-name:dots-3}a-scene{display:block;position:relative;height:100%;width:100%}a-assets,a-scene audio,a-scene img,a-scene video{display:none}.a-enter-vr-modal,.a-orientation-modal{font-family:Consolas,Andale Mono,Courier New,monospace}.a-enter-vr-modal a{border-bottom:1px solid #fff;padding:2px 0;text-decoration:none;transition:.1s color ease-in}.a-enter-vr-modal a:hover{background-color:#fff;color:#111;padding:2px 4px;position:relative;left:-4px}.a-enter-ar,.a-enter-vr{font-family:sans-serif,monospace;font-size:13px;width:100%;font-weight:200;line-height:16px;position:absolute;right:20px;bottom:20px}.a-enter-ar{right:80px}.a-enter-vr-button,.a-enter-vr-modal,.a-enter-vr-modal a{color:#fff;user-select:none;outline:0}.a-enter-vr-button{background:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='108' height='62' viewBox='0 0 108 62'%3E%3Ctitle%3Eaframe-vrmode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M68.81,21.56H64.23v8.27h4.58a4.13,4.13,0,0,0,3.1-1.09,4.2,4.2,0,0,0,1-3,4.24,4.24,0,0,0-1-3A4.05,4.05,0,0,0,68.81,21.56Z' fill='%23fff'/%3E%3Cpath d='M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0ZM41.9,46H34L24,16h8l6,21.84,6-21.84H52Zm39.29,0H73.44L68.15,35.39H64.23V46H57V16H68.81q5.32,0,8.34,2.37a8,8,0,0,1,3,6.69,9.68,9.68,0,0,1-1.27,5.18,8.9,8.9,0,0,1-4,3.34l6.26,12.11Z' fill='%23fff'/%3E%3C/svg%3E") 50% 50% no-repeat rgba(0,0,0,.35)}.a-enter-ar-button{background:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='108' height='62' viewBox='0 0 108 62'%3E%3Ctitle%3Eaframe-armode-noborder-reduced-tracking%3C/title%3E%3Cpath d='M96,0H12A12,12,0,0,0,0,12V50A12,12,0,0,0,12,62H96a12,12,0,0,0,12-12V12A12,12,0,0,0,96,0Zm8,50a8,8,0,0,1-8,8H12a8,8,0,0,1-8-8V12a8,8,0,0,1,8-8H96a8,8,0,0,1,8,8Z' fill='%23fff'/%3E%3Cpath d='M43.35,39.82H32.51L30.45,46H23.88L35,16h5.73L52,46H45.43Zm-9.17-5h7.5L37.91,23.58Z' fill='%23fff'/%3E%3Cpath d='M68.11,35H63.18V46H57V16H68.15q5.31,0,8.2,2.37a8.18,8.18,0,0,1,2.88,6.7,9.22,9.22,0,0,1-1.33,5.12,9.09,9.09,0,0,1-4,3.26l6.49,12.26V46H73.73Zm-4.93-5h5a5.09,5.09,0,0,0,3.6-1.18,4.21,4.21,0,0,0,1.28-3.27,4.56,4.56,0,0,0-1.2-3.34A5,5,0,0,0,68.15,21h-5Z' fill='%23fff'/%3E%3C/svg%3E") 50% 50% no-repeat rgba(0,0,0,.2)}.a-enter-ar-button,.a-enter-vr-button{background-size:90% 90%;border:0;bottom:0;cursor:pointer;min-width:58px;min-height:34px;padding-right:0;padding-top:0;position:absolute;right:0;transition:background-color .05s ease;-webkit-transition:background-color .05s ease;z-index:9999;border-radius:8px;touch-action:manipulation}.a-enter-ar-button{background-size:100% 90%;margin-right:10px;border-radius:7px}.a-enter-ar-button:active,.a-enter-ar-button:hover,.a-enter-vr-button:active,.a-enter-vr-button:hover{background-color:#ef2d5e}.a-enter-vr-button.resethover{background-color:rgba(0,0,0,.35)}[data-a-enter-vr-no-webvr] .a-enter-vr-button{border-color:#666;opacity:.65}[data-a-enter-vr-no-webvr] .a-enter-vr-button:active,[data-a-enter-vr-no-webvr] .a-enter-vr-button:hover{background-color:rgba(0,0,0,.35);cursor:not-allowed}.a-enter-vr-modal{background-color:#666;border-radius:0;display:none;min-height:32px;margin-right:70px;padding:9px;width:280px;right:2%;position:absolute}.a-enter-vr-modal:after{border-bottom:10px solid transparent;border-left:10px solid #666;border-top:10px solid transparent;display:inline-block;content:'';position:absolute;right:-5px;top:5px;width:0;height:0}.a-enter-vr-modal a,.a-enter-vr-modal p{display:inline}.a-enter-vr-modal p{margin:0}.a-enter-vr-modal p:after{content:' '}[data-a-enter-vr-no-headset].a-enter-vr:hover .a-enter-vr-modal,[data-a-enter-vr-no-webvr].a-enter-vr:hover .a-enter-vr-modal{display:block}.a-orientation-modal{background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%2090%2090%22%20enable-background%3D%22new%200%200%2090%2090%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpolygon%20points%3D%220%2C0%200%2C0%200%2C0%20%22%3E%3C/polygon%3E%3Cg%3E%3Cpath%20d%3D%22M71.545%2C48.145h-31.98V20.743c0-2.627-2.138-4.765-4.765-4.765H18.456c-2.628%2C0-4.767%2C2.138-4.767%2C4.765v42.789%20%20%20c0%2C2.628%2C2.138%2C4.766%2C4.767%2C4.766h5.535v0.959c0%2C2.628%2C2.138%2C4.765%2C4.766%2C4.765h42.788c2.628%2C0%2C4.766-2.137%2C4.766-4.765V52.914%20%20%20C76.311%2C50.284%2C74.173%2C48.145%2C71.545%2C48.145z%20M18.455%2C16.935h16.344c2.1%2C0%2C3.808%2C1.708%2C3.808%2C3.808v27.401H37.25V22.636%20%20%20c0-0.264-0.215-0.478-0.479-0.478H16.482c-0.264%2C0-0.479%2C0.214-0.479%2C0.478v36.585c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h7.507v7.644%20%20%20h-5.534c-2.101%2C0-3.81-1.709-3.81-3.81V20.743C14.645%2C18.643%2C16.354%2C16.935%2C18.455%2C16.935z%20M16.96%2C23.116h19.331v25.031h-7.535%20%20%20c-2.628%2C0-4.766%2C2.139-4.766%2C4.768v5.828h-7.03V23.116z%20M71.545%2C73.064H28.757c-2.101%2C0-3.81-1.708-3.81-3.808V52.914%20%20%20c0-2.102%2C1.709-3.812%2C3.81-3.812h42.788c2.1%2C0%2C3.809%2C1.71%2C3.809%2C3.812v16.343C75.354%2C71.356%2C73.645%2C73.064%2C71.545%2C73.064z%22%3E%3C/path%3E%3Cpath%20d%3D%22M28.919%2C58.424c-1.466%2C0-2.659%2C1.193-2.659%2C2.66c0%2C1.466%2C1.193%2C2.658%2C2.659%2C2.658c1.468%2C0%2C2.662-1.192%2C2.662-2.658%20%20%20C31.581%2C59.617%2C30.387%2C58.424%2C28.919%2C58.424z%20M28.919%2C62.786c-0.939%2C0-1.703-0.764-1.703-1.702c0-0.939%2C0.764-1.704%2C1.703-1.704%20%20%20c0.94%2C0%2C1.705%2C0.765%2C1.705%2C1.704C30.623%2C62.022%2C29.858%2C62.786%2C28.919%2C62.786z%22%3E%3C/path%3E%3Cpath%20d%3D%22M69.654%2C50.461H33.069c-0.264%2C0-0.479%2C0.215-0.479%2C0.479v20.288c0%2C0.264%2C0.215%2C0.478%2C0.479%2C0.478h36.585%20%20%20c0.263%2C0%2C0.477-0.214%2C0.477-0.478V50.939C70.131%2C50.676%2C69.917%2C50.461%2C69.654%2C50.461z%20M69.174%2C51.417V70.75H33.548V51.417H69.174z%22%3E%3C/path%3E%3Cpath%20d%3D%22M45.201%2C30.296c6.651%2C0%2C12.233%2C5.351%2C12.551%2C11.977l-3.033-2.638c-0.193-0.165-0.507-0.142-0.675%2C0.048%20%20%20c-0.174%2C0.198-0.153%2C0.501%2C0.045%2C0.676l3.883%2C3.375c0.09%2C0.075%2C0.198%2C0.115%2C0.312%2C0.115c0.141%2C0%2C0.273-0.061%2C0.362-0.166%20%20%20l3.371-3.877c0.173-0.2%2C0.151-0.502-0.047-0.675c-0.194-0.166-0.508-0.144-0.676%2C0.048l-2.592%2C2.979%20%20%20c-0.18-3.417-1.629-6.605-4.099-9.001c-2.538-2.461-5.877-3.817-9.404-3.817c-0.264%2C0-0.479%2C0.215-0.479%2C0.479%20%20%20C44.72%2C30.083%2C44.936%2C30.296%2C45.201%2C30.296z%22%3E%3C/path%3E%3C/g%3E%3C/svg%3E) center/50% 50% no-repeat rgba(244,244,244,1);bottom:0;font-size:14px;font-weight:600;left:0;line-height:20px;right:0;position:fixed;top:0;z-index:9999999}.a-orientation-modal:after{color:#666;content:"Insert phone into Cardboard holder.";display:block;position:absolute;text-align:center;top:70%;transform:translateY(-70%);width:100%}.a-orientation-modal button{background:url(data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20xmlns%3Axlink%3D%22http%3A//www.w3.org/1999/xlink%22%20version%3D%221.1%22%20x%3D%220px%22%20y%3D%220px%22%20viewBox%3D%220%200%20100%20100%22%20enable-background%3D%22new%200%200%20100%20100%22%20xml%3Aspace%3D%22preserve%22%3E%3Cpath%20fill%3D%22%23000000%22%20d%3D%22M55.209%2C50l17.803-17.803c1.416-1.416%2C1.416-3.713%2C0-5.129c-1.416-1.417-3.713-1.417-5.129%2C0L50.08%2C44.872%20%20L32.278%2C27.069c-1.416-1.417-3.714-1.417-5.129%2C0c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129L44.951%2C50L27.149%2C67.803%20%20c-1.417%2C1.416-1.417%2C3.713%2C0%2C5.129c0.708%2C0.708%2C1.636%2C1.062%2C2.564%2C1.062c0.928%2C0%2C1.856-0.354%2C2.564-1.062L50.08%2C55.13l17.803%2C17.802%20%20c0.708%2C0.708%2C1.637%2C1.062%2C2.564%2C1.062s1.856-0.354%2C2.564-1.062c1.416-1.416%2C1.416-3.713%2C0-5.129L55.209%2C50z%22%3E%3C/path%3E%3C/svg%3E) no-repeat;border:none;height:50px;text-indent:-9999px;width:50px}.a-loader-title{background-color:rgba(0,0,0,.6);font-family:sans-serif,monospace;text-align:center;font-size:20px;height:50px;font-weight:300;line-height:50px;position:absolute;right:0;left:0;top:0;color:#fff}.a-modal{background:0 0/50% 50% rgba(0,0,0,.6);bottom:0;font-size:14px;font-weight:600;left:0;line-height:20px;right:0;position:fixed;top:0;z-index:9999999}.a-dialog{position:relative;left:50%;top:50%;transform:translate(-50%,-50%);z-index:199995;width:300px;height:200px;background-size:contain;background-color:#fff;font-family:sans-serif,monospace;font-size:20px;border-radius:3px;padding:6px}.a-dialog-text-container{width:100%;height:70%;align-self:flex-start;display:flex;justify-content:center;align-content:center;flex-direction:column}.a-dialog-text{display:inline-block;font-weight:400;font-size:14pt;margin:8px}.a-dialog-buttons-container{display:inline-flex;align-self:flex-end;width:100%;height:30%}.a-dialog-button{cursor:pointer;align-self:center;opacity:.9;height:80%;width:50%;font-size:12pt;margin:4px;border-radius:2px;text-align:center;border:none;display:inline-block;-webkit-transition:all .25s ease-in-out;transition:all .25s ease-in-out;box-shadow:0 1px 3px rgba(0,0,0,.1),0 1px 2px rgba(0,0,0,.2);user-select:none}.a-dialog-permission-button:hover{box-shadow:0 7px 14px rgba(0,0,0,.2),0 2px 2px rgba(0,0,0,.2)}.a-dialog-allow-button{background-color:#00ceff}.a-dialog-deny-button{background-color:#ff005b}.a-dialog-ok-button{background-color:#00ceff;width:100%}.a-dom-overlay:not(.a-no-style){overflow:hidden;position:absolute;pointer-events:none;box-sizing:border-box;bottom:0;left:0;right:0;top:0;padding:1em}.a-dom-overlay:not(.a-no-style)>*{pointer-events:auto}`;n("browserify-css").createStyle(s,{href:"src/style/aframe.css"}),i.exports=s},{"browserify-css":4}],194:[function(n,i,o){var s=".rs-base{background-color:#333;color:#fafafa;border-radius:0;font:10px monospace;left:5px;line-height:1em;opacity:.85;overflow:hidden;padding:10px;position:fixed;top:5px;width:300px;z-index:10000}.rs-base div.hidden{display:none}.rs-base h1{color:#fff;cursor:pointer;font-size:1.4em;font-weight:300;margin:0 0 5px;padding:0}.rs-group{display:-webkit-box;display:-webkit-flex;display:flex;-webkit-flex-direction:column-reverse;flex-direction:column-reverse;margin-bottom:5px}.rs-group:last-child{margin-bottom:0}.rs-counter-base{align-items:center;display:-webkit-box;display:-webkit-flex;display:flex;height:10px;-webkit-justify-content:space-between;justify-content:space-between;margin:2px 0}.rs-counter-base.alarm{color:#b70000;text-shadow:0 0 0 #b70000,0 0 1px #fff,0 0 1px #fff,0 0 2px #fff,0 0 2px #fff,0 0 3px #fff,0 0 3px #fff,0 0 4px #fff,0 0 4px #fff}.rs-counter-id{font-weight:300;-webkit-box-ordinal-group:0;-webkit-order:0;order:0;width:54px}.rs-counter-value{font-weight:300;-webkit-box-ordinal-group:1;-webkit-order:1;order:1;text-align:right;width:35px}.rs-canvas{-webkit-box-ordinal-group:2;-webkit-order:2;order:2}@media (min-width:480px){.rs-base{left:20px;top:20px}}";n("browserify-css").createStyle(s,{href:"src/style/rStats.css"}),i.exports=s},{"browserify-css":4}],195:[function(n,i,o){var s=n("../constants/"),c=n("../core/system").registerSystem,u="data-aframe-default-camera";i.exports.System=c("camera",{init:function(){this.activeCameraEl=null,this.render=this.render.bind(this),this.unwrapRender=this.unwrapRender.bind(this),this.wrapRender=this.wrapRender.bind(this),this.initialCameraFound=!1,this.numUserCameras=0,this.numUserCamerasChecked=0,this.setupInitialCamera()},setupInitialCamera:function(){var f,p,m=this.sceneEl,y=this;if(m.camera&&!m.camera.el.getAttribute("camera").spectator){m.emit("cameraready",{cameraEl:m.camera.el});return}if(f=m.querySelectorAll("a-camera, [camera]"),!f.length){this.createDefaultCamera();return}for(this.numUserCameras=f.length,p=0;p<f.length;p++)f[p].addEventListener("object3dset",function(g){g.detail.type==="camera"&&y.checkUserCamera(this)}),f[p].isNode?f[p].load():f[p].addEventListener("nodeready",function(){this.load()})},checkUserCamera:function(f){var p,m=this.el.sceneEl;if(this.numUserCamerasChecked++,!this.initialCameraFound){if(p=f.getAttribute("camera"),!p.active||p.spectator){this.numUserCamerasChecked===this.numUserCameras&&this.createDefaultCamera();return}this.initialCameraFound=!0,m.camera=f.getObject3D("camera"),m.emit("cameraready",{cameraEl:f})}},createDefaultCamera:function(){var f,p=this.sceneEl;f=document.createElement("a-entity"),f.setAttribute("camera",{active:!0}),f.setAttribute("position",{x:0,y:s.DEFAULT_CAMERA_HEIGHT,z:0}),f.setAttribute("wasd-controls",""),f.setAttribute("look-controls",""),f.setAttribute(s.AFRAME_INJECTED,""),f.addEventListener("object3dset",function(m){m.detail.type==="camera"&&(p.camera=m.detail.object,p.emit("cameraready",{cameraEl:f}))}),p.appendChild(f)},disableActiveCamera:function(){var f,p;f=this.sceneEl.querySelectorAll("[camera]"),p=f[f.length-1],p.setAttribute("camera","active",!0)},setActiveCamera:function(f){var p,m,y,g,_=this.activeCameraEl,x=this.sceneEl;if(g=f.getObject3D("camera"),!(!g||f===this.activeCameraEl)){var b=x.querySelector("["+u+"]"),E=b&&b.querySelector("[camera]");for(f!==E&&h(x),this.activeCameraEl=f,this.activeCameraEl.play(),x.camera=g,_&&_.setAttribute("camera","active",!1),m=x.querySelectorAll("[camera]"),y=0;y<m.length;y++)p=m[y],!(!p.isEntity||f===p)&&(p.setAttribute("camera","active",!1),p.pause());x.emit("camera-set-active",{cameraEl:f})}},setSpectatorCamera:function(f){var p,m=this.spectatorCameraEl,y=this.sceneEl,g;p=f.getObject3D("camera"),!(!p||f===this.spectatorCameraEl)&&(m&&m.setAttribute("camera","spectator",!1),g=this.spectatorCameraEl=f,y.addEventListener("enter-vr",this.wrapRender),y.addEventListener("exit-vr",this.unwrapRender),g.setAttribute("camera","active",!1),g.play(),y.emit("camera-set-spectator",{cameraEl:f}))},disableSpectatorCamera:function(){this.spectatorCameraEl=void 0},wrapRender:function(){!this.spectatorCameraEl||this.originalRender||(this.originalRender=this.sceneEl.renderer.render,this.sceneEl.renderer.render=this.render)},unwrapRender:function(){!this.originalRender||(this.sceneEl.renderer.render=this.originalRender,this.originalRender=void 0)},render:function(f,p){var m,y=this.sceneEl,g;m=y.renderer.xr.enabled,this.originalRender.call(y.renderer,f,p),!(!this.spectatorCameraEl||y.isMobile||!m)&&(g=this.spectatorCameraEl.components.camera.camera,y.renderer.xr.enabled=!1,this.originalRender.call(y.renderer,f,g),y.renderer.xr.enabled=m)}});function h(f){var p,m=f.camera;!m||(p=f.querySelector("["+u+"]"),p&&f.removeChild(p))}},{"../constants/":128,"../core/system":147}],196:[function(n,i,o){var s=n("../core/geometry").geometries,c=n("../core/system").registerSystem;i.exports.System=c("geometry",{init:function(){this.cache={},this.cacheCount={}},clearCache:function(){this.cache={},this.cacheCount={}},getOrCreateGeometry:function(p){var m=this.cache,y,g;return p.skipCache?u(p):(g=this.hash(p),y=m[g],f(this.cacheCount,g),y||(y=u(p),m[g]=y,y))},unuseGeometry:function(p){var m=this.cache,y=this.cacheCount,g,_;p.skipCache||(_=this.hash(p),m[_]&&(h(y,_),!(y[_]>0)&&(g=m[_],g.dispose(),delete m[_],delete y[_])))},hash:function(p){return JSON.stringify(p)}});function u(p){var m=p.primitive,y=s[m]&&s[m].Geometry,g=new y;if(!y)throw new Error("Unknown geometry `"+m+"`");return g.init(p),g.geometry}function h(p,m){p[m]--}function f(p,m){p[m]=p[m]===void 0?1:p[m]+1}},{"../core/geometry":137,"../core/system":147}],197:[function(n,i,o){var s=n("../core/system").registerSystem,c=n("../lib/three");function u(h){return new Promise(function(f,p){var m=document.createElement("script");document.body.appendChild(m),m.onload=f,m.onerror=p,m.async=!0,m.src=h})}i.exports.System=s("gltf-model",{schema:{dracoDecoderPath:{default:""},meshoptDecoderPath:{default:""}},init:function(){this.update()},update:function(){var h=this.data.dracoDecoderPath,f=this.data.meshoptDecoderPath;!this.dracoLoader&&h&&(this.dracoLoader=new c.DRACOLoader,this.dracoLoader.setDecoderPath(h)),!this.meshoptDecoder&&f&&(this.meshoptDecoder=u(f).then(function(){return window.MeshoptDecoder.ready}).then(function(){return window.MeshoptDecoder}))},getDRACOLoader:function(){return this.dracoLoader},getMeshoptDecoder:function(){return this.meshoptDecoder}})},{"../core/system":147,"../lib/three":184}],198:[function(n,i,o){n("./camera"),n("./geometry"),n("./gltf-model"),n("./light"),n("./material"),n("./renderer"),n("./shadow"),n("./tracked-controls-webvr"),n("./tracked-controls-webxr"),n("./webxr")},{"./camera":195,"./geometry":196,"./gltf-model":197,"./light":199,"./material":200,"./renderer":201,"./shadow":202,"./tracked-controls-webvr":203,"./tracked-controls-webxr":204,"./webxr":205}],199:[function(n,i,o){var s=n("../core/system").registerSystem,c=n("../utils/bind"),u=n("../constants/"),h="data-aframe-default-light";i.exports.System=s("light",{schema:{defaultLightsEnabled:{default:!0}},init:function(){this.defaultLights=!1,this.userDefinedLights=!1,this.sceneEl.addEventListener("loaded",c(this.setupDefaultLights,this))},registerLight:function(f){f.hasAttribute(h)||(this.removeDefaultLights(),this.userDefinedLights=!0)},removeDefaultLights:function(){var f,p=this.sceneEl;if(!!this.defaultLights){f=document.querySelectorAll("["+h+"]");for(var m=0;m<f.length;m++)p.removeChild(f[m]);this.defaultLights=!1}},setupDefaultLights:function(){var f=this.sceneEl,p,m;this.userDefinedLights||this.defaultLights||!this.data.defaultLightsEnabled||(p=document.createElement("a-entity"),p.setAttribute("light",{color:"#BBB",type:"ambient"}),p.setAttribute(h,""),p.setAttribute(u.AFRAME_INJECTED,""),f.appendChild(p),m=document.createElement("a-entity"),m.setAttribute("light",{color:"#FFF",intensity:.6,castShadow:!0}),m.setAttribute("position",{x:-.5,y:1,z:1}),m.setAttribute(h,""),m.setAttribute(u.AFRAME_INJECTED,""),f.appendChild(m),this.defaultLights=!0)}})},{"../constants/":128,"../core/system":147,"../utils/bind":206}],200:[function(n,i,o){var s=n("../core/system").registerSystem,c=n("../lib/three"),u=n("../utils/"),h=n("../utils/material").isHLS,f=n("../utils/material").setTextureProperties,p=u.bind,m=u.debug,y=m("components:texture:error"),g=new c.TextureLoader,_=m("components:texture:warn");g.setCrossOrigin("anonymous"),i.exports.System=s("material",{init:function(){this.materials={},this.textureCounts={},this.textureCache={},this.sceneEl.addEventListener("materialtextureloaded",p(this.onMaterialTextureLoaded,this))},clearTextureCache:function(){this.textureCache={}},loadTexture:function(P,D,F){var k=this;if(P.tagName==="CANVAS"){this.loadCanvas(P,D,F);return}if(P.tagName==="VIDEO"){!P.src&&!P.srcObject&&!P.childElementCount&&_("Video element was defined with neither `source` elements nor `src` / `srcObject` attributes."),this.loadVideo(P,D,F);return}u.srcLoader.validateSrc(P,W,j);function W(J){k.loadImage(J,D,F)}function j(J){k.loadVideo(J,D,F)}},loadImage:function(P,D,F){var k=this.hash(D),W=this.textureCache;if(W[k]){W[k].then(F);return}W[k]=b(P,D),W[k].then(F)},loadCanvas:function(P,D,F){var k;k=new c.CanvasTexture(P),f(k,D),F(k)},loadVideo:function(P,D,F){var k,W,j=this.textureCache,J,de;function te(N){N.texture.needsUpdate=!0,F(N.texture,N.videoEl)}if(typeof P!="string"){if(J=P,k=this.hashVideo(D,J),j[k]){j[k].then(te);return}T(J)}if(J=J||E(P,D.width,D.height),k=this.hashVideo(D,J),j[k]){j[k].then(te);return}W=new c.VideoTexture(J),W.minFilter=c.LinearFilter,f(W,D),this.sceneEl.isIOS&&h(J.src||J.getAttribute("src"),J.type||J.getAttribute("type"))&&(W.format=c.RGBAFormat,W.needsCorrectionBGRA=!0,W.flipY=!1,W.needsCorrectionFlipY=!0),de={texture:W,videoEl:J},j[k]=Promise.resolve(de),te(de)},hash:function(P){return P.src.tagName&&(P=u.extendDeep({},P),P.src=P.src.src),JSON.stringify(P)},hashVideo:function(P,D){return x(P,D)},registerMaterial:function(P){this.materials[P.uuid]=P},unregisterMaterial:function(P){delete this.materials[P.uuid];var D=this.textureCounts;Object.keys(P).filter(function(F){return P[F]&&P[F].isTexture}).forEach(function(F){D[P[F].uuid]--,D[P[F].uuid]<=0&&P[F].dispose()})},updateMaterials:function(P){var D=this.materials;Object.keys(D).forEach(function(F){D[F].needsUpdate=!0})},onMaterialTextureLoaded:function(P){this.textureCounts[P.detail.texture.uuid]||(this.textureCounts[P.detail.texture.uuid]=0),this.textureCounts[P.detail.texture.uuid]++}});function x(P,D){var F,k=D.getAttribute("id"),W,j;if(k)return k;for(W="",j=P||{},F=0;F<D.attributes.length;F++)j[D.attributes[F].name]=D.attributes[F].value;return Object.keys(j).sort().forEach(function(J){W+=J+":"+j[J]+";"}),W}function b(P,D){return new Promise(F);function F(k,W){var j=typeof P!="string";function J(de){f(de,D),de.needsUpdate=!0,k(de)}if(j){J(new c.Texture(P));return}g.load(P,J,function(){},function(de){y("`$s` could not be fetched (Error code: %s; Response: %s)",de.status,de.statusText)})}}function E(P,D,F){var k=document.createElement("video");return k.width=D,k.height=F,k.setAttribute("playsinline",""),k.setAttribute("webkit-playsinline",""),k.autoplay=!0,k.loop=!0,k.crossOrigin="anonymous",k.addEventListener("error",function(){_("`$s` is not a valid video",P)},!0),k.src=P,k}function T(P){return P.autoplay=P.hasAttribute("autoplay")&&P.getAttribute("autoplay")!=="false",P.controls=P.hasAttribute("controls")&&P.getAttribute("controls")!=="false",P.getAttribute("loop")==="false"&&P.removeAttribute("loop"),P.getAttribute("preload")==="false"&&(P.preload="none"),P.crossOrigin=P.crossOrigin||"anonymous",P.setAttribute("playsinline",""),P.setAttribute("webkit-playsinline",""),P}},{"../core/system":147,"../lib/three":184,"../utils/":212,"../utils/material":216}],201:[function(n,i,o){var s=n("../core/system").registerSystem,c=n("../utils/"),u=n("../lib/three"),h=c.debug,f=h("components:renderer:warn");i.exports.System=s("renderer",{schema:{antialias:{default:"auto",oneOf:["true","false","auto"]},highRefreshRate:{default:c.device.isOculusBrowser()},logarithmicDepthBuffer:{default:"auto",oneOf:["true","false","auto"]},maxCanvasWidth:{default:1920},maxCanvasHeight:{default:1920},physicallyCorrectLights:{default:!1},precision:{default:"high",oneOf:["high","medium","low"]},sortObjects:{default:!1},colorManagement:{default:!1},gammaOutput:{default:!1},alpha:{default:!0},foveationLevel:{default:0}},init:function(){var p=this.data,m=this.el,y=m.renderer;y.sortObjects=p.sortObjects,y.physicallyCorrectLights=p.physicallyCorrectLights,(p.colorManagement||p.gammaOutput)&&(y.outputEncoding=u.sRGBEncoding,p.gammaOutput&&f('Property `gammaOutput` is deprecated. Use `renderer="colorManagement: true;"` instead.')),m.hasAttribute("antialias")&&f('Component `antialias` is deprecated. Use `renderer="antialias: true"` instead.'),m.hasAttribute("logarithmicDepthBuffer")&&f('Component `logarithmicDepthBuffer` is deprecated. Use `renderer="logarithmicDepthBuffer: true"` instead.')},applyColorCorrection:function(p){!this.data.colorManagement||!p||(p.isColor?p.convertSRGBToLinear():p.isTexture&&(p.encoding=u.sRGBEncoding))}})},{"../core/system":147,"../lib/three":184,"../utils/":212}],202:[function(n,i,o){var s=n("../core/system").registerSystem,c=n("../lib/three"),u={basic:c.BasicShadowMap,pcf:c.PCFShadowMap,pcfsoft:c.PCFSoftShadowMap};i.exports.System=s("shadow",{schema:{enabled:{default:!0},autoUpdate:{default:!0},type:{default:"pcf",oneOf:["basic","pcf","pcfsoft"]}},init:function(){var h=this.sceneEl,f=this.data;this.shadowMapEnabled=!1,h.renderer&&(h.renderer.shadowMap.type=u[f.type],h.renderer.shadowMap.autoUpdate=f.autoUpdate,this.setShadowMapEnabled(this.shadowMapEnabled))},update:function(h){h.enabled!==this.data.enabled&&this.setShadowMapEnabled(this.data.enabled)},setShadowMapEnabled:function(h){var f=this.sceneEl.renderer;this.shadowMapEnabled=this.data.enabled&&h,f&&(f.shadowMap.enabled=this.shadowMapEnabled)}})},{"../core/system":147,"../lib/three":184}],203:[function(n,i,o){var s=n("../core/system").registerSystem,c=n("../utils"),u=c.device.isWebXRAvailable;i.exports.System=s("tracked-controls-webvr",{init:function(){var h=this;this.controllers=[],this.isChrome=navigator.userAgent.indexOf("Chrome")!==-1,this.updateControllerList(),this.throttledUpdateControllerList=c.throttle(this.updateControllerList,500,this),!u&&(!navigator.getVRDisplays||this.sceneEl.addEventListener("enter-vr",function(){navigator.getVRDisplays().then(function(f){f.length&&(h.vrDisplay=f[0])})}))},tick:function(){this.isChrome?this.updateControllerList():this.throttledUpdateControllerList()},updateControllerList:function(){var h=this.controllers,f,p,m,y;if(p=navigator.getGamepads&&navigator.getGamepads(),!!p){for(y=h.length,h.length=0,m=0;m<p.length;++m)f=p[m],f&&f.pose&&h.push(f);h.length!==y&&this.el.emit("controllersupdated",void 0,!1)}}})},{"../core/system":147,"../utils":212}],204:[function(n,i,o){var s=n("../core/system").registerSystem,c=n("../utils");i.exports.System=s("tracked-controls-webxr",{init:function(){this.controllers=[],this.oldControllers=[],this.oldControllersLength=0,this.throttledUpdateControllerList=c.throttle(this.updateControllerList,500,this),this.updateReferenceSpace=this.updateReferenceSpace.bind(this),this.el.addEventListener("enter-vr",this.updateReferenceSpace),this.el.addEventListener("exit-vr",this.updateReferenceSpace)},tick:function(){this.throttledUpdateControllerList()},updateReferenceSpace:function(){var u=this,h=this.el.xrSession;if(!h){this.referenceSpace=void 0,this.controllers=[],this.oldControllersLength>0&&(this.oldControllersLength=0,this.el.emit("controllersupdated",void 0,!1));return}var f=u.el.sceneEl.systems.webxr.sessionReferenceSpaceType;h.requestReferenceSpace(f).then(function(p){u.referenceSpace=p}).catch(function(p){throw u.el.sceneEl.systems.webxr.warnIfFeatureNotRequested(f,'tracked-controls-webxr uses reference space "'+f+'".'),p})},updateControllerList:function(){var u=this.el.xrSession,h=this.oldControllers,f;if(!u){if(this.oldControllersLength===0)return;this.oldControllersLength=0,this.controllers=[],this.el.emit("controllersupdated",void 0,!1);return}if(!!u.inputSources){if(this.controllers=u.inputSources,this.oldControllersLength===this.controllers.length){var p=!0;for(f=0;f<this.controllers.length;++f)if(!(this.controllers[f]===h[f]&&this.controllers[f].gamepad===h[f].gamepad)){p=!1;break}if(p)return}for(h.length=0,f=0;f<this.controllers.length;f++)h.push(this.controllers[f]);this.oldControllersLength=this.controllers.length,this.el.emit("controllersupdated",void 0,!1)}}})},{"../core/system":147,"../utils":212}],205:[function(n,i,o){var s=n("../core/system").registerSystem,c=n("../utils/"),u=c.debug("systems:webxr:warn");i.exports.System=s("webxr",{schema:{referenceSpaceType:{type:"string",default:"local-floor"},requiredFeatures:{type:"array",default:["local-floor"]},optionalFeatures:{type:"array",default:["bounded-floor"]},overlayElement:{type:"selector"}},update:function(){var h=this.data;this.sessionConfiguration={requiredFeatures:h.requiredFeatures,optionalFeatures:h.optionalFeatures},this.sessionReferenceSpaceType=h.referenceSpaceType,h.overlayElement&&(h.overlayElement.classList.remove("a-dom-overlay"),h.optionalFeatures.includes("dom-overlay")||(h.optionalFeatures.push("dom-overlay"),this.el.setAttribute("webxr",h)),this.warnIfFeatureNotRequested("dom-overlay"),this.sessionConfiguration.domOverlay={root:h.overlayElement},h.overlayElement.classList.add("a-dom-overlay"))},wasFeatureRequested:function(h){return!!(h==="viewer"||h==="local"||this.sessionConfiguration.requiredFeatures.includes(h)||this.sessionConfiguration.optionalFeatures.includes(h))},warnIfFeatureNotRequested:function(h,f){if(!this.wasFeatureRequested(h)){var p='Please add the feature "'+h+`" to a-scene's webxr system options in requiredFeatures/optionalFeatures.`;u((f?f+" ":"")+p)}}})},{"../core/system":147,"../utils/":212}],206:[function(n,i,o){i.exports=function(c,u){return function(h){return function(){var p=h.concat(Array.prototype.slice.call(arguments,0));return c.apply(u,p)}}(Array.prototype.slice.call(arguments,2))}},{}],207:[function(n,i,o){var s=n("./debug"),c=n("object-assign"),u=s("utils:coordinates:warn"),h=["x","y","z","w"],f=/^\s*((-?\d*\.{0,1}\d+(e-?\d+)?)\s+){2,3}(-?\d*\.{0,1}\d+(e-?\d+)?)\s*$/;i.exports.regex=f;var p="object",m=/\s+/g;function y(b,E){var T,P,D,F,k,W,j,J,de;if(b&&b instanceof Object)return W=b.x===void 0?E&&E.x:b.x,j=b.y===void 0?E&&E.y:b.y,J=b.z===void 0?E&&E.z:b.z,de=b.w===void 0?E&&E.w:b.w,W!=null&&(b.x=x(W)),j!=null&&(b.y=x(j)),J!=null&&(b.z=x(J)),de!=null&&(b.w=x(de)),b;if(b==null)return typeof E===p?c({},E):E;for(T=b.trim().split(m),k={},F=0;F<h.length;F++)if(D=h[F],T[F])k[D]=parseFloat(T[F],10);else{if(P=E&&E[D],P===void 0)continue;k[D]=x(P)}return k}i.exports.parse=y;function g(b){var E;return typeof b!==p?b:(E=b.x+" "+b.y,b.z!=null&&(E+=" "+b.z),b.w!=null&&(E+=" "+b.w),E)}i.exports.stringify=g;function _(b){return f.test(b)}i.exports.isCoordinates=_,i.exports.isCoordinate=function(b){return u("`AFRAME.utils.isCoordinate` has been renamed to `AFRAME.utils.isCoordinates`"),_(b)};function x(b){return b!=null&&b.constructor===String?parseFloat(b,10):b}i.exports.toVector3=function(b){return new THREE.Vector3(b.x,b.y,b.z)}},{"./debug":208,"object-assign":39}],208:[function(n,i,o){(function(s){var c=n("debug"),u=n("object-assign"),h={colors:{debug:"gray",error:"red",info:"gray",warn:"orange"}},f=function(_){var x=c(_);return x.color=m(_),x};u(f,c);function p(_){var x=_.split(":");return x[x.length-1]}function m(_){var x=p(_),b=h.colors&&h.colors[x];return b||null}function y(){try{return window.localStorage}catch{}}var g=y();g&&(parseInt(g.logs,10)||g.logs==="true")?f.enable("*"):f.enable("*:error,*:info,*:warn"),s.browser&&(window.logs=f),i.exports=f}).call(this,n("_process"))},{_process:49,debug:8,"object-assign":39}],209:[function(n,i,o){(function(s){var c=n("debug")("device:error"),u,h=!1,f=!1,p=i.exports.isWebXRAvailable=!window.debug&&navigator.xr!==void 0;if(window.addEventListener("vrdisplayactivate",function(j){var J;p||(J=document.createElement("canvas"),u=j.display,J.getContext("webgl",{}),u.requestPresent([{source:J}]).then(function(){},function(){}))}),p){var m=function(){var j=document.querySelector("a-scene");if(!j){window.addEventListener("DOMContentLoaded",m);return}j.hasLoaded?j.components["vr-mode-ui"].updateEnterInterfaces():j.addEventListener("loaded",m)},y=function(j){c("WebXR session support error: "+j.message)};navigator.xr.isSessionSupported?(navigator.xr.isSessionSupported("immersive-vr").then(function(j){h=j,m()}).catch(y),navigator.xr.isSessionSupported("immersive-ar").then(function(j){f=j,m()}).catch(function(){})):navigator.xr.supportsSession?(navigator.xr.supportsSession("immersive-vr").then(function(){h=!0,m()}).catch(y),navigator.xr.supportsSession("immersive-ar").then(function(){f=!0,m()}).catch(function(){})):c("WebXR has neither isSessionSupported or supportsSession?!")}else navigator.getVRDisplays&&navigator.getVRDisplays().then(function(j){var J=document.querySelector("a-scene");u=j.length&&j[0],J&&J.emit("displayconnected",{vrDisplay:u})});function g(){return u}i.exports.getVRDisplay=g;function _(){return h||f||!!g()}i.exports.checkHeadsetConnected=_;function x(){return f}i.exports.checkARSupport=x;var b=function(){var j=!1;return function(J){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(J)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(J.substr(0,4)))&&(j=!0),(T()||E()||W())&&(j=!0),k()&&(j=!1)}(window.navigator.userAgent||window.navigator.vendor||window.opera),function(){return j}}();i.exports.isMobile=b;function E(j){var J=j||window.navigator.userAgent;return/ipad|Nexus (7|9)|xoom|sch-i800|playbook|tablet|kindle/i.test(J)}i.exports.isTablet=E;function T(){return/iPad|iPhone|iPod/.test(window.navigator.platform)}i.exports.isIOS=T;function P(){return!b()&&!k()&&window.orientation!==void 0}i.exports.isMobileDeviceRequestingDesktopSite=P;function D(){return/(OculusBrowser)/i.test(window.navigator.userAgent)}i.exports.isOculusBrowser=D;function F(){return/(Mobile VR)/i.test(window.navigator.userAgent)}i.exports.isFirefoxReality=F;function k(){return D()||F()}i.exports.isMobileVR=k;function W(){return/R7 Build/.test(window.navigator.userAgent)}i.exports.isR7=W,i.exports.isLandscape=function(){var j=window.orientation;return W()&&(j+=90),j===90||j===-90},i.exports.isBrowserEnvironment=!!(!s||s.browser),i.exports.isNodeEnvironment=!i.exports.isBrowserEnvironment}).call(this,n("_process"))},{_process:49,debug:8}],210:[function(n,i,o){var s={};function c(u,h){return h=h||".",s[h]||(s[h]={}),u.indexOf(h)!==-1?s[h][u]=u.split(h):s[h][u]=u,s[h][u]}i.exports.getComponentPropertyPath=c,i.exports.propertyPathCache=s,i.exports.getComponentProperty=function(u,h,f){var p;return f=f||".",h.indexOf(f)!==-1?(p=c(h,f),p.constructor===String?u.getAttribute(p):u.getAttribute(p[0])[p[1]]):u.getAttribute(h)},i.exports.setComponentProperty=function(u,h,f,p){var m;if(p=p||".",h.indexOf(p)!==-1){m=c(h,p),m.constructor===String?u.setAttribute(m,f):u.setAttribute(m[0],m[1],f);return}u.setAttribute(h,f)}},{}],211:[function(n,i,o){i.exports=function(c){var u=c.style.width,h=c.style.height;c.style.width=parseInt(u,10)+1+"px",c.style.height=parseInt(h,10)+1+"px",setTimeout(function(){c.style.width=u,c.style.height=h},200)}},{}],212:[function(n,i,o){var s=n("./debug"),c=n("deep-assign"),u=n("./device"),h=n("object-assign"),f=n("./object-pool"),p=s("utils:warn");i.exports.bind=n("./bind"),i.exports.coordinates=n("./coordinates"),i.exports.debug=s,i.exports.device=u,i.exports.entity=n("./entity"),i.exports.forceCanvasResizeSafariMobile=n("./forceCanvasResizeSafariMobile"),i.exports.isIE11=n("./is-ie11"),i.exports.material=n("./material"),i.exports.objectPool=f,i.exports.split=n("./split").split,i.exports.styleParser=n("./styleParser"),i.exports.trackedControls=n("./tracked-controls"),i.exports.checkHeadsetConnected=function(){return p("`utils.checkHeadsetConnected` has moved to `utils.device.checkHeadsetConnected`"),u.checkHeadsetConnected(arguments)},i.exports.isGearVR=i.exports.device.isGearVR=function(){p("`utils.isGearVR` has been deprecated, use `utils.device.isMobileVR`")},i.exports.isIOS=function(){return p("`utils.isIOS` has moved to `utils.device.isIOS`"),u.isIOS(arguments)},i.exports.isOculusGo=i.exports.device.isOculusGo=function(){p("`utils.isOculusGo` has been deprecated, use `utils.device.isMobileVR`")},i.exports.isMobile=function(){return p("`utils.isMobile has moved to `utils.device.isMobile`"),u.isMobile(arguments)},i.exports.throttle=function(y,g,_){var x;return _&&(y=i.exports.bind(y,_)),function(){var b=Date.now(),E=typeof x=="undefined"?g:b-x;(typeof x=="undefined"||E>=g)&&(x=b,y.apply(null,arguments))}},i.exports.throttleComponentChanged=function(y,g,_){var x,b;return _&&(y=i.exports.bind(y,_)),function(){var E=Date.now(),T=typeof x=="undefined"?g:E-x,P=arguments;typeof x=="undefined"||T>=g?(clearTimeout(b),x=E,y.apply(null,P)):(clearTimeout(b),b=setTimeout(function(){x=Date.now(),y.apply(this,P)},g-T))}},i.exports.throttleTick=function(y,g,_){var x;return _&&(y=i.exports.bind(y,_)),function(b,E){var T=typeof x=="undefined"?E:b-x;(typeof x=="undefined"||T>=g)&&(x=b,y(b,T))}},i.exports.debounce=function(y,g,_){var x;return function(){var b=this,E=arguments,T=function(){x=null,_||y.apply(b,E)},P=_&&!x;clearTimeout(x),x=setTimeout(T,g),P&&y.apply(b,E)}},i.exports.extend=h,i.exports.extendDeep=c,i.exports.clone=function(y){return JSON.parse(JSON.stringify(y))};var m=function(){var y=f.createPool(function(){return[]});return function(g,_){var x,b,E,T,P,D;if(g===void 0||_===void 0||g===null||_===null||!(g&&_&&g.constructor===Object&&_.constructor===Object||g.constructor===Array&&_.constructor===Array))return g===_;b=y.use(),E=y.use(),b.length=0,E.length=0;for(x in g)b.push(x);for(x in _)E.push(x);if(b.length!==E.length)return y.recycle(b),y.recycle(E),!1;for(T=0;T<b.length;++T)if(P=g[b[T]],D=_[b[T]],typeof P=="object"||typeof D=="object"||Array.isArray(P)&&Array.isArray(D)){if(P===D)continue;if(!m(P,D))return y.recycle(b),y.recycle(E),!1}else if(P!==D)return y.recycle(b),y.recycle(E),!1;return y.recycle(b),y.recycle(E),!0}}();i.exports.deepEqual=m,i.exports.diff=function(){var y=[];return function(g,_,x){var b,E,T,P,D,F,k;P=x||{},y.length=0;for(D in g)y.push(D);if(!_)return P;for(T in _)y.indexOf(T)===-1&&y.push(T);for(F=0;F<y.length;F++)D=y[F],b=g[D],E=_[D],k=b&&E&&b.constructor===Object&&E.constructor===Object,(k&&!m(b,E)||!k&&b!==E)&&(P[D]=E);return P}}(),i.exports.shouldCaptureKeyEvent=function(y){return y.metaKey?!1:document.activeElement===document.body},i.exports.splitString=function(y,g){typeof g=="undefined"&&(g=" ");var _=new RegExp(g,"g");return y=(y||"").replace(_,g),y.split(g)},i.exports.getElData=function(y,g){g=g||{};var _={};Object.keys(g).forEach(x);function x(b){y.hasAttribute(b)&&(_[b]=y.getAttribute(b))}return _},i.exports.getUrlParameter=function(y){y=y.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var g=new RegExp("[\\?&]"+y+"=([^&#]*)"),_=g.exec(location.search);return _===null?"":decodeURIComponent(_[1].replace(/\+/g," "))},i.exports.isIframed=function(){return window.top!==window.self},i.exports.findAllScenes=function(y){for(var g=[],_=y.getElementsByTagName("*"),x=0,b=_.length;x<b;x++)_[x].isScene&&g.push(_[x]);return g},i.exports.srcLoader=n("./src-loader")},{"./bind":206,"./coordinates":207,"./debug":208,"./device":209,"./entity":210,"./forceCanvasResizeSafariMobile":211,"./is-ie11":214,"./material":216,"./object-pool":217,"./split":218,"./src-loader":219,"./styleParser":220,"./tracked-controls":221,"deep-assign":10,"object-assign":39}],213:[function(n,i,o){window.addEventListener("orientationchange",function(){document.documentElement.style.height="initial",setTimeout(function(){document.documentElement.style.height="100%",setTimeout(function(){window.scrollTo(0,1)},500)},500)})},{}],214:[function(n,i,o){function s(){var c=-1,u=navigator.userAgent,h;return navigator.appName==="Microsoft Internet Explorer"?(h=new RegExp("MSIE ([0-9]{1,}[\\.0-9]{0,})"),h.exec(u)!=null&&(c=parseFloat(RegExp.$1))):navigator.appName==="Netscape"&&(h=new RegExp("Trident/.*rv:([0-9]{1,}[\\.0-9]{0,})"),h.exec(u)!=null&&(c=parseFloat(RegExp.$1))),c}i.exports=s()===11},{}],215:[function(n,i,o){i.exports=function(c){return/(iphone|ipod|ipad).*os.(7_|8_|9_)/i.test(c)}},{}],216:[function(n,i,o){var s=n("../lib/three"),c=["application/x-mpegurl","application/vnd.apple.mpegurl"],u=new Set(["emissiveMap","envMap","map","specularMap"]);function h(p,m){var y=m.offset||{x:0,y:0},g=m.repeat||{x:1,y:1},_=m.npot||!1;_&&(p.wrapS=s.ClampToEdgeWrapping,p.wrapT=s.ClampToEdgeWrapping,p.magFilter=s.LinearFilter,p.minFilter=s.LinearFilter),(g.x!==1||g.y!==1)&&(p.wrapS=s.RepeatWrapping,p.wrapT=s.RepeatWrapping,p.repeat.set(g.x,g.y)),(y.x!==0||y.y!==0)&&p.offset.set(y.x,y.y)}i.exports.setTextureProperties=h,i.exports.updateMapMaterialFromData=function(p,m,y,g){var _=y.el,x=y.material,b=_.sceneEl.systems.renderer,E=g[m];if(y.materialSrcs||(y.materialSrcs={}),!E){delete y.materialSrcs[p],P(null);return}if(E===y.materialSrcs[p]&&x[p]){h(x[p],g);return}y.materialSrcs[p]=E,E instanceof s.Texture?P(E):_.sceneEl.systems.material.loadTexture(E,{src:E,repeat:g.repeat,offset:g.offset,npot:g.npot},T);function T(D){y.materialSrcs[p]===E&&P(D)}function P(D){x[p]=D,D&&u.has(p)&&b.applyColorCorrection(D),x.needsUpdate=!0,f(_,D)}},i.exports.updateMap=function(p,m){return i.exports.updateMapMaterialFromData("map","src",p,m)},i.exports.updateDistortionMap=function(p,m,y){var g=p;p==="ambientOcclusion"&&(g="ao");var _=m.el,x=m.material,b=_.sceneEl.systems.renderer,E=y[p+"Map"],T={};if(T.src=E,T.offset=y[p+"TextureOffset"],T.repeat=y[p+"TextureRepeat"],T.wrap=y[p+"TextureWrap"],E){if(E===m[p+"TextureSrc"])return;m[p+"TextureSrc"]=E,_.sceneEl.systems.material.loadTexture(E,T,P);return}if(!x.map)return;P(null);function P(D){var F=g+"Map";x[F]=D,D&&u.has(F)&&b.applyColorCorrection(D),D&&h(D,y),x.needsUpdate=!0,f(_,D)}};function f(p,m){!m||(p.emit("materialtextureloaded",{src:m.image,texture:m}),!(!m.image||m.image.tagName!=="VIDEO")&&(m.image.addEventListener("loadeddata",function(){!p.components||!p.components.material||(m.needsCorrectionBGRA&&m.needsCorrectionFlipY&&["standard","flat"].indexOf(p.components.material.data.shader)!==-1&&p.setAttribute("material","shader","ios10hls"),p.emit("materialvideoloadeddata",{src:m.image,texture:m}))}),m.image.addEventListener("ended",function(){p.emit("materialvideoended",{src:m.image,texture:m})})))}i.exports.handleTextureEvents=f,i.exports.isHLS=function(p,m){return!!(m&&c.includes(m.toLowerCase())||p&&p.toLowerCase().indexOf(".m3u8")>0)}},{"../lib/three":184}],217:[function(n,i,o){var s=Object.freeze(Object.create(null));function c(){return{}}i.exports.createPool=function(p){var m=[],y=null;p=p||c;function g(){var E;return(y===null||y===m.length)&&x(m.length||5),E=m[y],m[y++]=s,u(E),E}function _(E){if(E instanceof Object){if(y===null||y===-1){m[m.length]=E;return}m[--y]=E}}function x(E){var T,P;if(E=E===void 0?m.length:E,E>0&&y==null&&(y=0),E>0)for(T=m.length,m.length+=Number(E),P=T;P<m.length;P++)m[P]=p();return m.length}function b(){return m.length}return{grow:x,pool:m,recycle:_,size:b,use:g}};function u(f){var p;if(!(!f||f.constructor!==Object))for(p in f)f[p]=void 0}i.exports.clearObject=u;function h(f,p){var m;if(!(!f||f.constructor!==Object))for(m in f)m in p||delete f[m]}i.exports.removeUnusedKeys=h},{}],218:[function(n,i,o){i.exports.split=function(){var s={};return function(c,u){return u in s||(s[u]={}),c in s[u]||(s[u][c]=c.split(u)),s[u][c]}}()},{}],219:[function(n,i,o){var s=n("./debug"),c=s("utils:src-loader:warn");function u(g,_,x){p(g,function(E){if(E){_(g);return}x(g)})}function h(g,_){var x,b="",E,T,P=[];for(E=0;E<5;E++)b+="(url\\((?:[^\\)]+)\\),\\s*)";b+="(url\\((?:[^\\)]+)\\)\\s*)",T=g.match(new RegExp(b));function D(F){P.push(F),P.length===6&&_(P)}if(T){for(E=1;E<7;E++)u(f(T[E]),D);return}if(x=y(g),!!x){if(x.tagName==="A-CUBEMAP"&&x.srcs)return _(x.srcs);c('Selector "%s" does not point to <a-cubemap>',g)}}function f(g){var _=g.match(/\url\((.+)\)/);if(!!_)return _[1]}function p(g,_){var x;if(g.tagName){_(g.tagName==="IMG");return}x=new XMLHttpRequest,x.open("HEAD",g),x.addEventListener("load",function(b){var E;x.status>=200&&x.status<300?(E=x.getResponseHeader("Content-Type"),E==null?m(g,_):E.startsWith("image")?_(!0):_(!1)):m(g,_),x.abort()}),x.send()}function m(g,_){var x=new Image;x.addEventListener("load",b);function b(){_(!0)}x.addEventListener("error",E);function E(){_(!1)}x.src=g}function y(g){try{var _=document.querySelector(g);return _||c('No element was found matching the selector: "%s"',g),_}catch{c('"%s" is not a valid selector',g);return}}i.exports={parseUrl:f,validateSrc:u,validateCubemapSrc:h}},{"./debug":208}],220:[function(n,i,o){var s=/-([a-z])/g;i.exports.parse=function(y,g){var _;return typeof y!="string"||(_=f(y,g),_[""])?y:u(_)},i.exports.stringify=function(y){return typeof y=="string"?y:p(y)};function c(y){return y.replace(s,m)}i.exports.toCamelCase=c;function u(y){var g,_;for(_ in y)g=c(_),_!==g&&(y[g]=y[_],delete y[_]);return y}i.exports.transformKeysToCamelCase=u;var h=function(){var y=[],g=/url\([^)]+$/;return function(x){var b="",E,T=0,P=";";for(y.length=0;T<x.length;){if(E=x.indexOf(P,T),E===-1&&(E=x.length),b+=x.substring(T,E),g.test(b)){b+=";",T=E+1;continue}y.push(b.trim()),b="",T=E+1}return y}}();function f(y,g){var _,x,b,E,T,P;for(g=g||{},_=h(y),x=0;x<_.length;x++)b=_[x],b&&(E=b.indexOf(":"),T=b.substr(0,E).trim(),P=b.substr(E+1).trim(),g[T]=P);return g}function p(y){var g,_=0,x=0,b="";for(g in y)_++;for(g in y)b+=g+": "+y[g],x<_-1&&(b+="; "),x++;return b}function m(y){return y[1].toUpperCase()}},{}],221:[function(n,i,o){var s=n("../constants").DEFAULT_HANDEDNESS,c=["x","y","z","w"],u=2;i.exports.checkControllerPresentAndSetup=function(y,g,_){var x=y.el,b,E=x.sceneEl.hasWebXR,T=E?f:h,P;if(b=T(y,g,_),P=!!b,y.controllerPresent&&!y.controllerEventsActive&&!E&&y.addEventListeners(),P===y.controllerPresent)return P;y.controllerPresent=P,P?(y.addEventListeners(),y.injectTrackedControls(b),x.emit("controllerconnected",{name:y.name,component:y})):(y.removeEventListeners(),x.emit("controllerdisconnected",{name:y.name,component:y}))};function h(y,g,_){var x,b=y.el.sceneEl,E,T=_.index||0;return!g||(E=b&&b.systems["tracked-controls-webvr"],!E)||(x=E.controllers,!x.length)?!1:!!p(x,null,g,_.hand,T)}function f(y,g,_){var x,b=y.el.sceneEl,E=b&&b.systems["tracked-controls-webxr"];return!E||(x=E.controllers,!x||!x.length)?!1:m(x,g,_.hand,_.index,_.iterateControllerProfiles,_.handTracking)}i.exports.isControllerPresentWebVR=h,i.exports.isControllerPresentWebXR=f;function p(y,g,_,x,b){var E,T,P=0,D=b>=0?b:0;for(T=0;T<y.length;T++)if(E=y[T],!(_&&!E.id.startsWith(_))&&!(!_&&E.id!==g)&&!(x&&E.hand&&x!==E.hand)){if(x&&!E.hand)D=u*b+(x===s?0:1);else return E;if(P===D)return E;++P}}function m(y,g,_,x,b,E){var T,P,D,F=!1,k,W;for(T=0;T<y.length;T++){if(D=y[T],W=D.profiles,E)F=D.hand;else if(b)for(P=0;P<W.length&&(F=W[P].startsWith(g),!F);P++);else F=W.length>0&&W[0].startsWith(g);if(!!F){if(k=D.handedness==="right"||D.handedness==="left",k){if(D.handedness===_)return y[T]}else if(T===x)return y[T]}}}i.exports.findMatchingControllerWebVR=p,i.exports.findMatchingControllerWebXR=m,i.exports.emitIfAxesChanged=function(y,g,_){var x,b,E,T,P;for(b in g){for(x=g[b],E=!1,P=0;P<x.length;P++)_.detail.changed[x[P]]&&(E=!0);if(!!E){for(T={},P=0;P<x.length;P++)T[c[P]]=_.detail.axis[x[P]];y.el.emit(b+"moved",T)}}},i.exports.onButtonEvent=function(y,g,_,x){var b=x?_.mapping[x]:_.mapping,E=b.buttons[y];_.el.emit(E+g),_.updateModel&&_.updateModel(E,g)}},{"../constants":128}],222:[function(n,i,o){THREE.DeviceOrientationControls=function(s){var c=this;this.object=s,this.object.rotation.reorder("YXZ"),this.enabled=!0,this.deviceOrientation={},this.screenOrientation=0,this.alphaOffset=0;var u=function(p){c.deviceOrientation=p},h=function(){c.screenOrientation=window.orientation||0},f=function(){var p=new THREE.Vector3(0,0,1),m=new THREE.Euler,y=new THREE.Quaternion,g=new THREE.Quaternion(-Math.sqrt(.5),0,0,Math.sqrt(.5));return function(_,x,b,E,T){m.set(b,x,-E,"YXZ"),_.setFromEuler(m),_.multiply(g),_.multiply(y.setFromAxisAngle(p,-T))}}();this.connect=function(){h(),window.addEventListener("orientationchange",h,!1),window.addEventListener("deviceorientation",u,!1),c.enabled=!0},this.disconnect=function(){window.removeEventListener("orientationchange",h,!1),window.removeEventListener("deviceorientation",u,!1),c.enabled=!1},this.update=function(){if(c.enabled!==!1){var p=c.deviceOrientation;if(p){var m=p.alpha?THREE.Math.degToRad(p.alpha)+c.alphaOffset:0,y=p.beta?THREE.Math.degToRad(p.beta):0,g=p.gamma?THREE.Math.degToRad(p.gamma):0,_=c.screenOrientation?THREE.Math.degToRad(c.screenOrientation):0;f(c.object.quaternion,m,y,g,_)}}},this.dispose=function(){c.disconnect()},this.connect()}},{}],223:[function(n,i,o){window.glStats=function(){var s=null,c=0,u=0,h=0,f=0,p=0,m=0,y=0;function g(F,k){return function(){k.apply(this,arguments),F.apply(this,arguments)}}WebGLRenderingContext.prototype.drawArrays=g(WebGLRenderingContext.prototype.drawArrays,function(){c++,arguments[0]==this.POINTS?m+=arguments[2]:p+=arguments[2]}),WebGLRenderingContext.prototype.drawElements=g(WebGLRenderingContext.prototype.drawElements,function(){u++,f+=arguments[1]/3,p+=arguments[1]}),WebGLRenderingContext.prototype.useProgram=g(WebGLRenderingContext.prototype.useProgram,function(){h++}),WebGLRenderingContext.prototype.bindTexture=g(WebGLRenderingContext.prototype.bindTexture,function(){y++});var _={allcalls:{over:3e3,caption:"Calls (hook)"},drawelements:{caption:"drawElements (hook)"},drawarrays:{caption:"drawArrays (hook)"}},x=[{caption:"WebGL",values:["allcalls","drawelements","drawarrays","useprogram","bindtexture","glfaces","glvertices","glpoints"]}],b=[{base:"allcalls",steps:["drawelements","drawarrays"]}];function E(){s("allcalls").set(c+u),s("drawElements").set(u),s("drawArrays").set(c),s("bindTexture").set(y),s("useProgram").set(h),s("glfaces").set(f),s("glvertices").set(p),s("glpoints").set(m)}function T(){c=0,u=0,h=0,f=0,p=0,m=0,y=0}function P(){}function D(F){s=F}return{update:E,start:T,end:P,attach:D,values:_,groups:x,fractions:b}},window.threeStats=function(s){var c=null,u={"renderer.info.memory.geometries":{caption:"Geometries"},"renderer.info.memory.textures":{caption:"Textures"},"renderer.info.programs":{caption:"Programs"},"renderer.info.render.calls":{caption:"Calls"},"renderer.info.render.triangles":{caption:"Triangles",over:1e3},"renderer.info.render.points":{caption:"Points"}},h=[{caption:"Three.js - Memory",values:["renderer.info.memory.geometries","renderer.info.programs","renderer.info.memory.textures"]},{caption:"Three.js - Render",values:["renderer.info.render.calls","renderer.info.render.triangles","renderer.info.render.points"]}],f=[];function p(){c("renderer.info.memory.geometries").set(s.info.memory.geometries),c("renderer.info.programs").set(s.info.programs.length),c("renderer.info.memory.textures").set(s.info.memory.textures),c("renderer.info.render.calls").set(s.info.render.calls),c("renderer.info.render.triangles").set(s.info.render.triangles),c("renderer.info.render.points").set(s.info.render.points)}function m(){}function y(){}function g(_){c=_}return{update:p,start:m,end:y,attach:g,values:u,groups:h,fractions:f}},window.BrowserStats=function(){var s=null,c=0,u=0;window.performance&&!performance.memory&&(performance.memory={usedJSHeapSize:0,totalJSHeapSize:0}),performance.memory.totalJSHeapSize===0&&console.warn("totalJSHeapSize === 0... performance.memory is only available in Chrome .");var h={memory:{caption:"Used Memory",average:!0,avgMs:1e3,over:22},total:{caption:"Total Memory"}},f=[{caption:"Browser",values:["memory","total"]}],p=[{base:"total",steps:["memory"]}],m=Math.log(1024);function y(E){var T=100,P=Math.floor(Math.log(E)/m);return Math.round(E*T/Math.pow(1024,P))/T}function g(){c=y(performance.memory.usedJSHeapSize),u=y(performance.memory.totalJSHeapSize),s("memory").set(c),s("total").set(u)}function _(){c=0}function x(){}function b(E){s=E}return{update:g,start:_,end:x,attach:b,values:h,groups:f,fractions:p}},typeof i=="object"&&(i.exports={glStats:window.glStats,threeStats:window.threeStats,BrowserStats:window.BrowserStats})},{}],224:[function(n,i,o){(function(){"performance"in window||(window.performance={});var s=window.performance;if(!("now"in s)){var c=Date.now();s.timing&&s.timing.navigationStart&&(c=s.timing.navigationStart),s.now=function(){return Date.now()-c}}s.mark||(s.mark=function(){}),s.measure||(s.measure=function(){})})(),window.rStats=function(c){function u(J,de){for(var te=Object.keys(J),N=0,L=te.length;N<L;N++)de(te[N])}function h(J){var de=document.createElement("link");de.href=J,de.rel="stylesheet",de.type="text/css",document.getElementsByTagName("head")[0].appendChild(de)}var f=c||{},p=f.colours||["#850700","#c74900","#fcb300","#284280","#4c7c0c"],m="https://fonts.googleapis.com/css?family=Roboto+Condensed:400,700,300",y=(f.CSSPath?f.CSSPath:"")+"rStats.css",g=f.css||[m,y];g.forEach(function(J){h(J)}),f.values||(f.values={});var _,x,b=10,E=200,T={};function P(J,de,te){var N=te||{},L=document.createElement("canvas"),M=L.getContext("2d"),I=0,U=0,$=N.color?N.color:"#666666",ee=document.createElement("canvas"),Q=ee.getContext("2d");ee.width=1,ee.height=2*b,Q.fillStyle="#444444",Q.fillRect(0,0,1,2*b),Q.fillStyle=$,Q.fillRect(0,b,1,b),Q.fillStyle="#ffffff",Q.globalAlpha=.5,Q.fillRect(0,b,1,1),Q.globalAlpha=1;var G=document.createElement("canvas"),K=G.getContext("2d");G.width=1,G.height=2*b,K.fillStyle="#444444",K.fillRect(0,0,1,2*b),K.fillStyle="#b70000",K.fillRect(0,b,1,b),K.globalAlpha=.5,K.fillStyle="#ffffff",K.fillRect(0,b,1,1),K.globalAlpha=1;function Y(){L.width=E,L.height=b,L.style.width=L.width+"px",L.style.height=L.height+"px",L.className="rs-canvas",J.appendChild(L),M.fillStyle="#444444",M.fillRect(0,0,L.width,L.height)}function we(Ke,ge){U+=(Ke-U)*.1,I*=.99,U>I&&(I=U),M.drawImage(L,1,0,L.width-1,L.height,0,0,L.width-1,L.height),ge?M.drawImage(G,L.width-1,L.height-U*L.height/I-b):M.drawImage(ee,L.width-1,L.height-U*L.height/I-b)}return Y(),{draw:we}}function D(J,de){var te=document.createElement("canvas"),N=te.getContext("2d");function L(){te.width=E,te.height=b*de,te.style.width=te.width+"px",te.style.height=te.height+"px",te.className="rs-canvas",J.appendChild(te),N.fillStyle="#444444",N.fillRect(0,0,te.width,te.height)}function M(I){N.drawImage(te,1,0,te.width-1,te.height,0,0,te.width-1,te.height);var U=0;u(I,function($){var ee=I[$]*te.height;N.fillStyle=p[$],N.fillRect(te.width-1,U,1,ee),U+=ee})}return L(),{draw:M}}function F(J,de){var te=J,N,L=0,M=0,I=0,U=0,$=performance.now(),ee=0,Q=document.createElement("div"),G=document.createElement("span"),K=document.createElement("div"),Y=document.createTextNode(""),we=f?f.values[te.toLowerCase()]:null,Ke=new P(Q,te,we),ge=!1;G.className="rs-counter-id",G.textContent=we&&we.caption?we.caption:te,K.className="rs-counter-value",K.appendChild(Y),Q.appendChild(G),Q.appendChild(K),de?de.div.appendChild(Q):x.appendChild(Q),N=performance.now();function me(Pe){if(we&&we.average){U+=Pe,ee++;var Be=performance.now();Be-$>=(we.avgMs||1e3)&&(I=U/ee,U=0,$=Be,ee=0)}}function De(){N=performance.now(),f.userTimingAPI&&performance.mark(te+"-start"),ge=!0}function ze(){L=performance.now()-N,f.userTimingAPI&&(performance.mark(te+"-end"),ge&&performance.measure(te,te+"-start",te+"-end")),me(L)}function tt(){ze(),De()}function rt(){var Pe=we&&we.average?I:L;Y.nodeValue=Math.round(Pe*100)/100;var Be=we&&(we.below&&L<we.below||we.over&&L>we.over);Ke.draw(L,Be),Q.className=Be?"rs-counter-base alarm":"rs-counter-base"}function vt(){var Pe=performance.now(),Be=Pe-N;M++,Be>1e3&&(we&&we.interpolate===!1?L=M:L=M*1e3/Be,M=0,N=Pe,me(L))}function Ye(Pe){L=Pe,me(L)}return{set:Ye,start:De,tick:tt,end:ze,frame:vt,value:function(){return L},draw:rt}}function k(J){var de=J.toLowerCase();if(de===void 0&&(de="default"),T[de])return T[de];var te=null;f&&f.groups&&u(f.groups,function(L){var M=f.groups[parseInt(L,10)];!te&&M.values.indexOf(de.toLowerCase())!==-1&&(te=M)});var N=new F(de,te);return T[de]=N,N}function W(){if(f.plugins){f.values||(f.values={}),f.groups||(f.groups=[]),f.fractions||(f.fractions=[]);for(var J=0;J<f.plugins.length;J++)f.plugins[J].attach(k),u(f.plugins[J].values,function(de){f.values[de]=f.plugins[J].values[de]}),f.groups=f.groups.concat(f.plugins[J].groups),f.fractions=f.fractions.concat(f.plugins[J].fractions)}else f.plugins={};_=document.createElement("div"),_.className="rs-base",x=document.createElement("div"),x.className="rs-container",x.style.height="auto",_.appendChild(x),document.body.appendChild(_),f&&(f.groups&&u(f.groups,function(de){var te=f.groups[parseInt(de,10)],N=document.createElement("div");N.className="rs-group",te.div=N;var L=document.createElement("h1");L.textContent=te.caption,L.addEventListener("click",function(M){this.classList.toggle("hidden"),M.preventDefault()}.bind(N)),x.appendChild(L),x.appendChild(N)}),f.fractions&&u(f.fractions,function(de){var te=f.fractions[parseInt(de,10)],N=document.createElement("div");N.className="rs-fraction";var L=document.createElement("div");L.className="rs-legend";var M=0;u(f.fractions[de].steps,function(U){var $=document.createElement("p");$.textContent=f.fractions[de].steps[U],$.style.color=p[M],L.appendChild($),M++}),N.appendChild(L),N.style.height=M*b+"px",te.div=N;var I=new D(N,M);te.graph=I,x.appendChild(N)}))}function j(){u(f.plugins,function(J){f.plugins[J].update()}),u(T,function(J){T[J].draw()}),f&&f.fractions&&u(f.fractions,function(J){var de=f.fractions[parseInt(J,10)],te=[],N=T[de.base.toLowerCase()];N&&(N=N.value(),u(f.fractions[J].steps,function(L){var M=f.fractions[J].steps[parseInt(L,10)].toLowerCase(),I=T[M];I&&te.push(I.value()/N)})),de.graph.draw(te)})}return W(),function(J){return J?k(J):{element:_,update:j}}},typeof i=="object"&&(i.exports=window.rStats)},{}],225:[function(n,i,o){String.prototype.startsWith||(String.prototype.startsWith=function(s,c){return c=c||0,this.substr(c,s.length)===s})},{}],226:[function(n,i,o){var s={};s.base64=function(c,u){return"data:"+c+";base64,"+u},s.isMobile=function(){var c=!1;return function(u){(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(u)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(u.substr(0,4)))&&(c=!0)}(navigator.userAgent||navigator.vendor||window.opera),c},s.isIOS=function(){return/(iPad|iPhone|iPod)/g.test(navigator.userAgent)},s.isIFrame=function(){try{return window.self!==window.top}catch{return!0}},s.appendQueryParameter=function(c,u,h){var f=c.indexOf("?")<0?"?":"&";return c+=f+u+"="+h,c},s.getQueryParameter=function(c){c=c.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var u=new RegExp("[\\?&]"+c+"=([^&#]*)"),h=u.exec(location.search);return h===null?"":decodeURIComponent(h[1].replace(/\+/g," "))},s.isLandscapeMode=function(){return window.orientation==90||window.orientation==-90},i.exports=s},{}],227:[function(n,i,o){var s=n("./util.js");function c(){var f=document.createElement("video");f.addEventListener("ended",function(){f.play()}),this.request=function(){f.paused&&(f.src=s.base64("video/webm","GkXfowEAAAAAAAAfQoaBAUL3gQFC8oEEQvOBCEKChHdlYm1Ch4ECQoWBAhhTgGcBAAAAAAAH4xFNm3RALE27i1OrhBVJqWZTrIHfTbuMU6uEFlSua1OsggEwTbuMU6uEHFO7a1OsggfG7AEAAAAAAACkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmAQAAAAAAAEUq17GDD0JATYCNTGF2ZjU2LjQwLjEwMVdBjUxhdmY1Ni40MC4xMDFzpJAGSJTMbsLpDt/ySkipgX1fRImIQO1MAAAAAAAWVK5rAQAAAAAAADuuAQAAAAAAADLXgQFzxYEBnIEAIrWcg3VuZIaFVl9WUDmDgQEj44OEO5rKAOABAAAAAAAABrCBsLqBkB9DtnUBAAAAAAAAo+eBAKOmgQAAgKJJg0IAAV4BHsAHBIODCoAACmH2MAAAZxgz4dPSTFi5JACjloED6ACmAECSnABMQAADYAAAWi0quoCjloEH0ACmAECSnABNwAADYAAAWi0quoCjloELuACmAECSnABNgAADYAAAWi0quoCjloEPoACmAECSnABNYAADYAAAWi0quoCjloETiACmAECSnABNIAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTnghdwo5aBAAAApgBAkpwATOAAA2AAAFotKrqAo5aBA+gApgBAkpwATMAAA2AAAFotKrqAo5aBB9AApgBAkpwATIAAA2AAAFotKrqAo5aBC7gApgBAkpwATEAAA2AAAFotKrqAo5aBD6AApgDAkpwAQ2AAA2AAAFotKrqAo5aBE4gApgBAkpwATCAAA2AAAFotKrqAH0O2dQEAAAAAAACU54Iu4KOWgQAAAKYAQJKcAEvAAANgAABaLSq6gKOWgQPoAKYAQJKcAEtgAANgAABaLSq6gKOWgQfQAKYAQJKcAEsAAANgAABaLSq6gKOWgQu4AKYAQJKcAEqAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEogAANgAABaLSq6gKOWgROIAKYAQJKcAEnAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCRlCjloEAAACmAECSnABJgAADYAAAWi0quoCjloED6ACmAECSnABJIAADYAAAWi0quoCjloEH0ACmAMCSnABDYAADYAAAWi0quoCjloELuACmAECSnABI4AADYAAAWi0quoCjloEPoACmAECSnABIoAADYAAAWi0quoCjloETiACmAECSnABIYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngl3Ao5aBAAAApgBAkpwASCAAA2AAAFotKrqAo5aBA+gApgBAkpwASAAAA2AAAFotKrqAo5aBB9AApgBAkpwAR8AAA2AAAFotKrqAo5aBC7gApgBAkpwAR4AAA2AAAFotKrqAo5aBD6AApgBAkpwAR2AAA2AAAFotKrqAo5aBE4gApgBAkpwARyAAA2AAAFotKrqAH0O2dQEAAAAAAACU54J1MKOWgQAAAKYAwJKcAENgAANgAABaLSq6gKOWgQPoAKYAQJKcAEbgAANgAABaLSq6gKOWgQfQAKYAQJKcAEagAANgAABaLSq6gKOWgQu4AKYAQJKcAEaAAANgAABaLSq6gKOWgQ+gAKYAQJKcAEZAAANgAABaLSq6gKOWgROIAKYAQJKcAEYAAANgAABaLSq6gB9DtnUBAAAAAAAAlOeCjKCjloEAAACmAECSnABF4AADYAAAWi0quoCjloED6ACmAECSnABFwAADYAAAWi0quoCjloEH0ACmAECSnABFoAADYAAAWi0quoCjloELuACmAECSnABFgAADYAAAWi0quoCjloEPoACmAMCSnABDYAADYAAAWi0quoCjloETiACmAECSnABFYAADYAAAWi0quoAfQ7Z1AQAAAAAAAJTngqQQo5aBAAAApgBAkpwARUAAA2AAAFotKrqAo5aBA+gApgBAkpwARSAAA2AAAFotKrqAo5aBB9AApgBAkpwARQAAA2AAAFotKrqAo5aBC7gApgBAkpwARQAAA2AAAFotKrqAo5aBD6AApgBAkpwAROAAA2AAAFotKrqAo5aBE4gApgBAkpwARMAAA2AAAFotKrqAH0O2dQEAAAAAAACU54K7gKOWgQAAAKYAQJKcAESgAANgAABaLSq6gKOWgQPoAKYAQJKcAESAAANgAABaLSq6gKOWgQfQAKYAwJKcAENgAANgAABaLSq6gKOWgQu4AKYAQJKcAERgAANgAABaLSq6gKOWgQ+gAKYAQJKcAERAAANgAABaLSq6gKOWgROIAKYAQJKcAEQgAANgAABaLSq6gB9DtnUBAAAAAAAAlOeC0vCjloEAAACmAECSnABEIAADYAAAWi0quoCjloED6ACmAECSnABEAAADYAAAWi0quoCjloEH0ACmAECSnABD4AADYAAAWi0quoCjloELuACmAECSnABDwAADYAAAWi0quoCjloEPoACmAECSnABDoAADYAAAWi0quoCjloETiACmAECSnABDgAADYAAAWi0quoAcU7trAQAAAAAAABG7j7OBALeK94EB8YIBd/CBAw=="),f.play())},this.release=function(){f.pause(),f.src=""}}function u(){var f=null;this.request=function(){f||(f=setInterval(function(){window.location.href="/",setTimeout(window.stop,0)},15e3))},this.release=function(){f&&(clearInterval(f),f=null)}}function h(){var f=navigator.userAgent||navigator.vendor||window.opera;return f.match(/iPhone/i)||f.match(/iPod/i)?u:c}i.exports=h()},{"./util.js":226}]},{},[182])(182)})})(CN);var Ai={clampColors:!1,models:{},MATSTANDARD:"standard",MATBASIC:"basic",MATLAMBERT:"lambert",MATPHONG:"phong",MATMATCAP:"matcap",MATTOON:"toon",MATNORMAL:"normal",FLAT:"flat",SMOOTH:"smooth",BOTH:"both",FRONT:"front",BACK:"back",DOUBLE:"double",_FACES:["nx","px","ny","py","nz","pz"],_VERTICES:{nx:[{x:0,y:0,z:0},{x:0,y:1,z:0},{x:0,y:1,z:1},{x:0,y:0,z:1}],px:[{x:1,y:0,z:1},{x:1,y:1,z:1},{x:1,y:1,z:0},{x:1,y:0,z:0}],ny:[{x:0,y:0,z:0},{x:0,y:0,z:1},{x:1,y:0,z:1},{x:1,y:0,z:0}],py:[{x:0,y:1,z:1},{x:0,y:1,z:0},{x:1,y:1,z:0},{x:1,y:1,z:1}],nz:[{x:1,y:0,z:0},{x:1,y:1,z:0},{x:0,y:1,z:0},{x:0,y:0,z:0}],pz:[{x:0,y:0,z:1},{x:0,y:1,z:1},{x:1,y:1,z:1},{x:1,y:0,z:1}]},_NEIGHBORS:{nx:{x:-1,y:0,z:0},px:{x:1,y:0,z:0},ny:{x:0,y:-1,z:0},py:{x:0,y:1,z:0},nz:{x:0,y:0,z:-1},pz:{x:0,y:0,z:1}},_FACEUVS:{nx:{u:"z",v:"y",order:[0,1,2,3],ud:1,vd:1,uo:0,vo:0},px:{u:"z",v:"y",order:[3,2,1,0],ud:-1,vd:1,uo:.75,vo:0},ny:{u:"x",v:"z",order:[0,1,2,3],ud:1,vd:1,uo:.75,vo:.5},py:{u:"x",v:"z",order:[1,0,3,2],ud:1,vd:-1,uo:.25,vo:1},nz:{u:"x",v:"y",order:[3,2,1,0],ud:-1,vd:1,uo:1,vo:0},pz:{u:"x",v:"y",order:[0,1,2,3],ud:1,vd:1,uo:.25,vo:0}}};let RN=typeof Float32Array!="undefined";class er{constructor(){let t=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1];this.m=RN?new Float32Array(t):t}transformPoint(t){let n=this.m,i=n[12]*t.x+n[13]*t.y+n[14]*t.z+n[15],o=(n[0]*t.x+n[1]*t.y+n[2]*t.z+n[3])/i,s=(n[4]*t.x+n[5]*t.y+n[6]*t.z+n[7])/i,c=(n[8]*t.x+n[9]*t.y+n[10]*t.z+n[11])/i;t.x=o,t.y=s,t.z=c}transformVector(t){let n=this.m,i=n[0]*t.x+n[1]*t.y+n[2]*t.z,o=n[4]*t.x+n[5]*t.y+n[6]*t.z,s=n[8]*t.x+n[9]*t.y+n[10]*t.z;t.x=i,t.y=o,t.z=s}static identity(t){let n=(t=t||new er).m;return n[0]=n[5]=n[10]=n[15]=1,n[1]=n[2]=n[3]=n[4]=n[6]=n[7]=n[8]=n[9]=n[11]=n[12]=n[13]=n[14]=0,t}static multiply(t,n,i){i=i||new er;let o=t.m,s=n.m,c=i.m;return c[0]=o[0]*s[0]+o[1]*s[4]+o[2]*s[8]+o[3]*s[12],c[1]=o[0]*s[1]+o[1]*s[5]+o[2]*s[9]+o[3]*s[13],c[2]=o[0]*s[2]+o[1]*s[6]+o[2]*s[10]+o[3]*s[14],c[3]=o[0]*s[3]+o[1]*s[7]+o[2]*s[11]+o[3]*s[15],c[4]=o[4]*s[0]+o[5]*s[4]+o[6]*s[8]+o[7]*s[12],c[5]=o[4]*s[1]+o[5]*s[5]+o[6]*s[9]+o[7]*s[13],c[6]=o[4]*s[2]+o[5]*s[6]+o[6]*s[10]+o[7]*s[14],c[7]=o[4]*s[3]+o[5]*s[7]+o[6]*s[11]+o[7]*s[15],c[8]=o[8]*s[0]+o[9]*s[4]+o[10]*s[8]+o[11]*s[12],c[9]=o[8]*s[1]+o[9]*s[5]+o[10]*s[9]+o[11]*s[13],c[10]=o[8]*s[2]+o[9]*s[6]+o[10]*s[10]+o[11]*s[14],c[11]=o[8]*s[3]+o[9]*s[7]+o[10]*s[11]+o[11]*s[15],c[12]=o[12]*s[0]+o[13]*s[4]+o[14]*s[8]+o[15]*s[12],c[13]=o[12]*s[1]+o[13]*s[5]+o[14]*s[9]+o[15]*s[13],c[14]=o[12]*s[2]+o[13]*s[6]+o[14]*s[10]+o[15]*s[14],c[15]=o[12]*s[3]+o[13]*s[7]+o[14]*s[11]+o[15]*s[15],i}static transpose(t,n){n=n||new er;let i=t.m,o=n.m;return o[0]=i[0],o[1]=i[4],o[2]=i[8],o[3]=i[12],o[4]=i[1],o[5]=i[5],o[6]=i[9],o[7]=i[13],o[8]=i[2],o[9]=i[6],o[10]=i[10],o[11]=i[14],o[12]=i[3],o[13]=i[7],o[14]=i[11],o[15]=i[15],n}static inverse(t,n){n=n||new er;let i=t.m,o=n.m;o[0]=i[5]*i[10]*i[15]-i[5]*i[14]*i[11]-i[6]*i[9]*i[15]+i[6]*i[13]*i[11]+i[7]*i[9]*i[14]-i[7]*i[13]*i[10],o[1]=-i[1]*i[10]*i[15]+i[1]*i[14]*i[11]+i[2]*i[9]*i[15]-i[2]*i[13]*i[11]-i[3]*i[9]*i[14]+i[3]*i[13]*i[10],o[2]=i[1]*i[6]*i[15]-i[1]*i[14]*i[7]-i[2]*i[5]*i[15]+i[2]*i[13]*i[7]+i[3]*i[5]*i[14]-i[3]*i[13]*i[6],o[3]=-i[1]*i[6]*i[11]+i[1]*i[10]*i[7]+i[2]*i[5]*i[11]-i[2]*i[9]*i[7]-i[3]*i[5]*i[10]+i[3]*i[9]*i[6],o[4]=-i[4]*i[10]*i[15]+i[4]*i[14]*i[11]+i[6]*i[8]*i[15]-i[6]*i[12]*i[11]-i[7]*i[8]*i[14]+i[7]*i[12]*i[10],o[5]=i[0]*i[10]*i[15]-i[0]*i[14]*i[11]-i[2]*i[8]*i[15]+i[2]*i[12]*i[11]+i[3]*i[8]*i[14]-i[3]*i[12]*i[10],o[6]=-i[0]*i[6]*i[15]+i[0]*i[14]*i[7]+i[2]*i[4]*i[15]-i[2]*i[12]*i[7]-i[3]*i[4]*i[14]+i[3]*i[12]*i[6],o[7]=i[0]*i[6]*i[11]-i[0]*i[10]*i[7]-i[2]*i[4]*i[11]+i[2]*i[8]*i[7]+i[3]*i[4]*i[10]-i[3]*i[8]*i[6],o[8]=i[4]*i[9]*i[15]-i[4]*i[13]*i[11]-i[5]*i[8]*i[15]+i[5]*i[12]*i[11]+i[7]*i[8]*i[13]-i[7]*i[12]*i[9],o[9]=-i[0]*i[9]*i[15]+i[0]*i[13]*i[11]+i[1]*i[8]*i[15]-i[1]*i[12]*i[11]-i[3]*i[8]*i[13]+i[3]*i[12]*i[9],o[10]=i[0]*i[5]*i[15]-i[0]*i[13]*i[7]-i[1]*i[4]*i[15]+i[1]*i[12]*i[7]+i[3]*i[4]*i[13]-i[3]*i[12]*i[5],o[11]=-i[0]*i[5]*i[11]+i[0]*i[9]*i[7]+i[1]*i[4]*i[11]-i[1]*i[8]*i[7]-i[3]*i[4]*i[9]+i[3]*i[8]*i[5],o[12]=-i[4]*i[9]*i[14]+i[4]*i[13]*i[10]+i[5]*i[8]*i[14]-i[5]*i[12]*i[10]-i[6]*i[8]*i[13]+i[6]*i[12]*i[9],o[13]=i[0]*i[9]*i[14]-i[0]*i[13]*i[10]-i[1]*i[8]*i[14]+i[1]*i[12]*i[10]+i[2]*i[8]*i[13]-i[2]*i[12]*i[9],o[14]=-i[0]*i[5]*i[14]+i[0]*i[13]*i[6]+i[1]*i[4]*i[14]-i[1]*i[12]*i[6]-i[2]*i[4]*i[13]+i[2]*i[12]*i[5],o[15]=i[0]*i[5]*i[10]-i[0]*i[9]*i[6]-i[1]*i[4]*i[10]+i[1]*i[8]*i[6]+i[2]*i[4]*i[9]-i[2]*i[8]*i[5];let s=i[0]*o[0]+i[1]*o[4]+i[2]*o[8]+i[3]*o[12];for(let c=0;c<16;c++)o[c]/=s;return n}static scale(t,n,i,o){let s=(o=o||new er).m;return s[0]=t,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=n,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=i,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,o}static translate(t,n,i,o){let s=(o=o||new er).m;return s[0]=1,s[1]=0,s[2]=0,s[3]=t,s[4]=0,s[5]=1,s[6]=0,s[7]=n,s[8]=0,s[9]=0,s[10]=1,s[11]=i,s[12]=0,s[13]=0,s[14]=0,s[15]=1,o}static rotate(t,n,i,o,s){if(!t||!n&&!i&&!o)return er.identity(s);let c=(s=s||new er).m,u=Math.sqrt(n*n+i*i+o*o);t*=Math.PI/180,n/=u,i/=u,o/=u;let h=Math.cos(t),f=Math.sin(t),p=1-h;return c[0]=n*n*p+h,c[1]=n*i*p-o*f,c[2]=n*o*p+i*f,c[3]=0,c[4]=i*n*p+o*f,c[5]=i*i*p+h,c[6]=i*o*p-n*f,c[7]=0,c[8]=o*n*p-i*f,c[9]=o*i*p+n*f,c[10]=o*o*p+h,c[11]=0,c[12]=0,c[13]=0,c[14]=0,c[15]=1,s}static lookAtORIGINAL(t,n,i,o,s,c,u,h,f,p){let m=(p=p||new er).m,y=t-o,g=n-s,_=i-c,x=Math.sqrt(y*y+g*g+_*_),b=h*(_/=x)-f*(g/=x),E=f*(y/=x)-u*_,T=u*g-h*y,P=g*(T/=x=Math.sqrt(b*b+E*E+T*T))-_*(E/=x),D=_*(b/=x)-y*T,F=y*E-g*b;return P/=x=Math.sqrt(P*P+D*D+F*F),D/=x,F/=x,m[0]=b,m[1]=E,m[2]=T,m[3]=-(b*t+E*n+T*i),m[4]=P,m[5]=D,m[6]=F,m[7]=-(P*t+D*n+F*i),m[8]=y,m[9]=g,m[10]=_,m[11]=-(y*t+g*n+_*i),m[12]=0,m[13]=0,m[14]=0,m[15]=1,p}static lookAtTRYOUT(t,n,i,o){let s=(o=o||new er).m,c=Math.sqrt(t*t+i*i);return s[0]=i/c,s[1]=0,s[2]=-t/c,s[3]=0,s[4]=t*n/c,s[5]=-c,s[6]=i*n/c,s[7]=0,s[8]=t,s[9]=n,s[10]=i,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,o}static lookAt(t,n,i,o){let s=(o=o||new er).m,c=Math.sqrt(t*t+i*i),u=c?t/c:1,h=c?i/c:0;return s[0]=t,s[1]=-h,s[2]=-i*u,s[3]=0,s[4]=n,s[5]=0,s[6]=c,s[7]=0,s[8]=i,s[9]=u,s[10]=-i*h,s[11]=0,s[12]=0,s[13]=0,s[14]=0,s[15]=1,o}rotation_matrix(t){}}class Ji{static parse(t){if((t=" "+(t||"").toLowerCase())!=" "&&!/^(?!$)(\s+(?:none|-x|x|\+x|-y|y|\+y|-z|z|\+z|\s))+\s*$/.test(t))throw{name:"SyntaxError",message:`Planar expression '${t}' is only allowed to be 'none' or contain -x x +x -y y +y -z z +z.`};return{nx:t.includes("-x"),x:t.includes(" x"),px:t.includes("+x"),ny:t.includes("-y"),y:t.includes(" y"),py:t.includes("+y"),nz:t.includes("-z"),z:t.includes(" z"),pz:t.includes("+z")}}static toString(t){return((t.nx?" -x":"")+(t.x?" x":"")+(t.px?" +x":"")+(t.ny?" -y":"")+(t.y?" y":"")+(t.py?" +y":"")+(t.nz?" -z":"")+(t.z?" z":"")+(t.pz?" +z":"")).trim()}static combine(t,n,i){return t||n?t?n?t===n?t:{nx:t.nx||n.nx,x:t.x||n.x,px:t.px||n.px,ny:t.ny||n.ny,y:t.y||n.y,py:t.py||n.py,nz:t.nz||n.nz,z:t.z||n.z,pz:t.pz||n.pz}:t:n:i}}class hC{get size(){return this.minX>this.maxX?{x:0,y:0,z:0}:{x:this.maxX-this.minX+1,y:this.maxY-this.minY+1,z:this.maxZ-this.minZ+1}}contructor(){this.reset()}reset(){this.minX=Number.POSITIVE_INFINITY,this.minY=Number.POSITIVE_INFINITY,this.minZ=Number.POSITIVE_INFINITY,this.maxX=Number.NEGATIVE_INFINITY,this.maxY=Number.NEGATIVE_INFINITY,this.maxZ=Number.NEGATIVE_INFINITY}set(t,n,i){this.minX=Math.min(this.minX,t),this.minY=Math.min(this.minY,n),this.minZ=Math.min(this.minZ,i),this.maxX=Math.max(this.maxX,t),this.maxY=Math.max(this.maxY,n),this.maxZ=Math.max(this.maxZ,i)}}class fC{constructor(t){this.color=t,this.material=t.material,this.faces={},this.visible=!0}dispose(){this.color=null,this.material=null,this.faces=null}}class LN{get minX(){return this.bounds.minX}get minY(){return this.bounds.minY}get minZ(){return this.bounds.minZ}get maxX(){return this.bounds.maxX}get maxY(){return this.bounds.maxY}get maxZ(){return this.bounds.maxZ}get size(){return this.minX>this.maxX?{x:0,y:0,z:0}:{x:this.maxX-this.minX+1,y:this.maxY-this.minY+1,z:this.maxZ-this.minZ+1}}get count(){return this._count}constructor(){this.bounds=new hC,this._voxels=[],this._count=0,this.prepareForWrite()}reset(){this.forEach(function(t){t.reset},this,!0),this.bounds.reset(),this._voxels=[],this._count=0}setVoxel(t,n,i,o){if(!(o instanceof fC))throw new Error("setVoxel requires a Voxel set to an existing color of a material of this model.");this.bounds.set(t,n,i),o.material.bounds.set(t,n,i),o.x=t,o.y=n,o.z=i;let s=this._voxels[i+1e6];s||(s=[],this._voxels[i+1e6]=s);let c=s[n+1e6];c||(c=[],s[n+1e6]=c),c[t+1e6]||this._count++,c[t+1e6]=o}clearVoxel(t,n,i){let o=this._voxels[i+1e6];if(o&&(o=o[n+1e6])){let s=o[t+1e6];s&&(s.color--,this._count++,o.splice(t,1))}}getVoxel(t,n,i){let o=this._voxels[i+1e6];return o&&(o=o[n+1e6])?o[t+1e6]:null}forEach(t,n,i){for(let o in this._voxels){let s=this._voxels[o];for(let c in s){let u=s[c];for(let h in u){let f=u[h];if(f&&(!i||f.visible)&&t.apply(n,[f])===!0)return}}}}forEachInBoundary(t,n){for(let i=this.bounds.minZ;i<=this.bounds.maxZ;i++)for(let o=this.bounds.minY;o<=this.bounds.maxY;o++)for(let s=this.bounds.minX;s<=this.bounds.maxX;s++)if(t.apply(n,[this.getVoxel(s,o,i)])===!0)return}prepareForWrite(){this.bounds.reset(),this._count=0,this.forEach(function(t){this.setVoxel(t.x,t.y,t.z,t)},this)}}const Ux=(a,t,n)=>Math.min(Math.max(a,t),n);class _s{static fromHex(t){let n=new _s;return n._set(t),n.id="",n.exId=null,n.count=0,n}static fromRgb(t,n,i){t=Math.round(255*Ux(t,0,1)),n=Math.round(255*Ux(n,0,1)),i=Math.round(255*Ux(i,0,1));let o="#"+(t<16?"0":"")+t.toString(16)+(n<16?"0":"")+n.toString(16)+(i<16?"0":"")+i.toString(16);return _s.fromHex(o)}clone(){let t=new _s;return t._color=this._color,t.r=this.r,t.g=this.g,t.b=this.b,t._material=this._material,t}multiply(t){return t instanceof _s?_s.fromRgb(this.r*t.r,this.g*t.g,this.b*t.b):_s.fromRgb(this.r*t,this.g*t,this.b*t)}add(...t){let n=this.r+t.reduce((s,c)=>s+c.r,0),i=this.g+t.reduce((s,c)=>s+c.g,0),o=this.b+t.reduce((s,c)=>s+c.b,0);return _s.fromRgb(n,i,o)}_setMaterial(t){if(this._material!==void 0)throw"A Color can only be added once.";this._material=t,this.count=0}get material(){return this._material}_set(t){let n=t;if((typeof n=="string"||n instanceof String)&&(n=n.trim().toUpperCase()).match(/^#([0-9a-fA-F]{3}|#?[0-9a-fA-F]{6})$/)){n=n.replace("#",""),this._color="#"+n,n.length===3&&(n=n[0]+n[0]+n[1]+n[1]+n[2]+n[2]);let i=parseInt(n,16);return this.r=(i>>16&255)/255,this.g=(i>>8&255)/255,void(this.b=(255&i)/255)}throw{name:"SyntaxError",message:`Color ${t} is not a hexadecimal color of the form #000 or #000000.`}}toString(){return this._color}}class PN{constructor(t,n,i,o,s,c,u,h,f,p,m,y,g,_,x,b,E,T,P,D,F,k){switch(t=t||Ai.MATSTANDARD){case Ai.MATSTANDARD:case Ai.MATBASIC:case Ai.MATLAMBERT:case Ai.MATPHONG:case Ai.MATTOON:case Ai.MATMATCAP:case Ai.MATNORMAL:break;default:throw{name:"SyntaxError",message:`Unknown material type '${t}'.`}}if(this.type=t,(y&&y.cube||g&&g.cube||_&&_.cube||x&&x.cube||b&&b.cube)&&(T!==-1||P!==-1))throw{name:"SyntaxError",message:"Cube textures can not be combined with maptransform"};this.index=0,this.roughness=typeof n=="number"?n:1,this.metalness=typeof i=="number"?i:0,this.opacity=typeof o=="number"?o:1,this.alphaTest=typeof s=="number"?s:0,this.transparent=!!c,this.wireframe=!!u,this.side=h||"front",["front","back","double"].includes(this.side)||(this.side="front"),this.setEmissive(f,p),this.fog=typeof m!="boolean"||m,this.map=y,this.normalMap=g,this.roughnessMap=_,this.metalnessMap=x,this.emissiveMap=b,this.matcap=E,this.mapTransform={uscale:T||-1,vscale:P||-1,uoffset:D||0,voffset:F||0,rotation:k||0},this.aoActive=!1,this._colors=[]}get baseId(){return`${this.type}|${this.roughness}|${this.metalness}|${this.opacity}|${this.alphaTest}|${this.wireframe?1:0}|${this.side}|`+(this.emissive?`${this.emissive.color}|${this.emissive.intensity}|`:"||")+`${this.fog?1:0}|`+(this.map?`${this.map.id}|`:"|")+(this.normalMap?`${this.normalMap.id}|`:"|")+(this.roughnessMap?`${this.roughnessMap.id}|`:"|")+(this.metalnessMap?`${this.metalnessMap.id}|`:"|")+(this.emissiveMap?`${this.emissiveMap.id}|`:"|")+(this.matcap?`${this.matcap.id}|`:"|")+`${this.mapTransform.uscale}|${this.mapTransform.vscale}|${this.mapTransform.uoffset}|${this.mapTransform.voffset}|${this.mapTransform.rotation}`}get isTransparent(){return this.transparent||this.opacity<1}setEmissive(t,n){this._emissive=t!==void 0&&t!=="#000"&&t!=="#000000"&&n?{color:_s.fromHex(t),intensity:n}:void 0}get emissive(){return this._emissive}get colors(){return this._colors}get colorCount(){return this._colors.length}get colorUsageCount(){return this._colors.reduce((t,n)=>t+n.count,0)}}class IN{constructor(t,n,i){this._baseMaterial=t,this.lighting=n,this.fade=!!i,this._deform=void 0,this._warp=void 0,this._scatter=void 0,this._flatten=Ji.parse(""),this._clamp=Ji.parse(""),this._skip=Ji.parse(""),this._ao=void 0,this.lights=!0,this._colors=[],this.bounds=new hC}get baseId(){return this._baseMaterial.baseId}get index(){return this._baseMaterial.index}get colors(){return this._colors}get colorCount(){return this._baseMaterial.colorCount}get type(){return this._baseMaterial.type}get roughness(){return this._baseMaterial.roughness}get metalness(){return this._baseMaterial.metalness}get opacity(){return this._baseMaterial.opacity}get alphaTest(){return this._baseMaterial.alphaTest}get transparent(){return this._baseMaterial.transparent}get isTransparent(){return this._baseMaterial.isTransparent}get emissive(){return this._baseMaterial.emissive}get side(){return this._baseMaterial.side}get fog(){return this._baseMaterial.fog}get map(){return this._baseMaterial.map}get normalMap(){return this._baseMaterial.normalMap}get roughnessMap(){return this._baseMaterial.roughnessMap}get metalnessMap(){return this._baseMaterial.metalnessMap}get emissiveMap(){return this._baseMaterial.emissiveMap}get matcap(){return this._baseMaterial.matcap}get mapTransform(){return this._baseMaterial.mapTransform}setDeform(t,n,i){t=Math.max(t==null?1:t,0),n=n==null?1:n,i=i==null?1:i,this._deform=t>0&&n!==0?{count:t,strength:n,damping:i}:void 0}get deform(){return this._deform}setWarp(t,n){t=t===void 0?1:Math.abs(t),n=n===void 0?1:Math.abs(n),this._warp=t>.001&&n>.001?{amplitude:t,frequency:n}:void 0}get warp(){return this._warp}set scatter(t){t===0&&(t=void 0),this._scatter=Math.abs(t)}get scatter(){return this._scatter}set flatten(t){this._flatten=Ji.parse(t)}get flatten(){return Ji.toString(this._flatten)}set clamp(t){this._clamp=Ji.parse(t)}get clamp(){return Ji.toString(this._clamp)}set skip(t){this._skip=Ji.parse(t)}get skip(){return Ji.toString(this._skip)}setAo(t){this._ao=t}get ao(){return this._ao}set aoSides(t){this._aoSides=Ji.parse(t)}get aoSides(){return Ji.toString(this._aoSides)}get colors(){return this._colors}addColorHEX(t){return this.addColor(_s.fromHex(t))}addColorRGB(t,n,i){return this.addColor(_s.fromRgb(t,n,i))}addColor(t){if(!(t instanceof _s))throw"addColor requires a Color object, e.g. material.addColor(Color.fromHex('#FFFFFF'))";return t._setMaterial(this),this._colors.push(t),this._baseMaterial._colors.push(t),t}}class ON{constructor(){this.baseMaterials=[],this.materials=[]}createMaterial(t,n,i,o,s,c,u,h,f,p,m,y,g,_,x,b,E,T,P,D,F,k,W,j){let J=new PN(t,i,o,c,u,h,f,p,m,y,g,_,x,b,E,T,P,D,F,k,W,j),de=J.baseId,te=this.baseMaterials.find(L=>L.baseId===de);te?J=te:this.baseMaterials.push(J);let N=new IN(J,n,s);return this.materials.push(N),N}forEach(t,n,i){i?this.baseMaterials.foreach(t,n):this.materials.forEach(t,n)}find(t){return this.materials.find(t)}findColorByExId(t){let n=null;return this.forEach(function(i){n||(n=i.colors.find(o=>o.exId===t))},this),n}}Ai.Noise=function(){let a=[];for(let o=0;o<256;o++)a[o]=Math.floor(256*Math.random()),a[o+256]=a[o];function t(o){return o*o*o*(o*(6*o-15)+10)}function n(o,s,c){return s+o*(c-s)}function i(o,s,c,u){let h=15&o,f=h<8?s:c,p=h<4?c:h==12||h==14?s:u;return((1&h)==0?f:-f)+((2&h)==0?p:-p)}return{noise:function(o,s,c){let u=Math.floor(o),h=Math.floor(s),f=Math.floor(c),p=255&u,m=255&h,y=255&f,g=(o-=u)-1,_=(s-=h)-1,x=(c-=f)-1,b=t(o),E=t(s),T=t(c),P=a[p]+m,D=a[P]+y,F=a[P+1]+y,k=a[p+1]+m,W=a[k]+y,j=a[k+1]+y;return n(T,n(E,n(b,i(a[D],o,s,c),i(a[W],g,s,c)),n(b,i(a[F],o,_,c),i(a[j],g,_,c))),n(E,n(b,i(a[D+1],o,s,x),i(a[W+1],g,s,c-1)),n(b,i(a[F+1],o,_,x),i(a[j+1],g,_,x))))}}};class _o{static changeShape(t,n){switch(n){case"sphere":_o._circularDeform(t,1,1,1);break;case"cylinder-x":_o._circularDeform(t,0,1,1);break;case"cylinder-y":_o._circularDeform(t,1,0,1);break;case"cylinder-z":_o._circularDeform(t,1,1,0)}}static _circularDeform(t,n,i,o){let s=(t.voxels.minX+t.voxels.maxX)/2+.5,c=(t.voxels.minY+t.voxels.maxY)/2+.5,u=(t.voxels.minZ+t.voxels.maxZ)/2+.5;t.forEachVertex(function(h){let f=h.x-s,p=h.y-c,m=h.z-u,y=Math.max(Math.abs(f*n),Math.abs(p*i),Math.abs(m*o)),g=Math.sqrt(f*f*n+p*p*i+m*m*o);if(g===0)return;let _=y/g;h.newPos.x=f*(1-n+n*_)+s,h.newPos.y=p*(1-i+i*_)+c,h.newPos.z=m*(1-o+o*_)+u,h.newPos.set=!0,h.ring=y},this),_o._repositionChangedVertices(t,!0),_o._markEquidistantFaces(t)}static _markEquidistantFaces(t){t.voxels.forEach(function(n){for(let i in n.faces){let o=n.faces[i];if(o.skipped)continue;o.equidistant=!0;let s=o.vertices[0].ring;for(let c=1;c<4;c++)if(o.vertices[c].ring!==s){o.equidistant=!1;break}}},this)}static maximumDeformCount(t){let n=0;return t.materials.forEach(function(i){i.deform&&(n=Math.max(n,i.deform.count))}),n}static deform(t,n){for(let i=0;i<n;i++)t.forEachVertex(function(o){if(o.deform&&o.deform.count>i){let s=o.links;if(s.length>0){let c=0,u=0,h=0;for(let g=0;g<s.length;g++)c+=s[g].x,u+=s[g].y,h+=s[g].z;let f=c/s.length-o.x,p=u/s.length-o.y,m=h/s.length-o.z,y=Math.pow(o.deform.damping,i)*o.deform.strength;y!==0&&(o.newPos.x=o.x+f*y,o.newPos.y=o.y+p*y,o.newPos.z=o.z+m*y,o.newPos.set=!0)}}},this),_o._repositionChangedVertices(t)}static warpAndScatter(t){let n=Ai.Noise().noise,i=t.voxels,o=t._tile;t.forEachVertex(function(s){if(o.nx&&s.x<i.minX+.1||o.px&&s.x>i.maxX+.9||o.ny&&s.y<i.minY+.1||o.py&&s.y>i.maxY+.9||o.nz&&s.z<i.minZ+.1||o.pz&&s.z>i.maxZ+.9)return;let c=s.warp?s.warp.amplitude:0,u=s.warp?s.warp.frequency:0,h=s.scatter||0;if(c||h){let f=0,p=0,m=0;c&&(f=n((s.x+.19)*u,s.y*u,s.z*u)*c,p=n((s.y+.17)*u,s.z*u,s.x*u)*c,m=n((s.z+.13)*u,s.x*u,s.y*u)*c),h&&(f+=(2*Math.random()-1)*h,p+=(2*Math.random()-1)*h,m+=(2*Math.random()-1)*h),s.newPos.x=s.x+f,s.newPos.y=s.y+p,s.newPos.z=s.z+m,s.newPos.set=!0}},this),_o._repositionChangedVertices(t)}static _repositionChangedVertices(t,n){t.voxels.minX,t.voxels.maxX,t.voxels.minY,t.voxels.maxY,t.voxels.minZ,t.voxels.maxZ,n?t.forEachVertex(function(i){i.newPos.set&&(i.x=i.newPos.x,i.y=i.newPos.y,i.z=i.newPos.z,i.newPos.set=!1)},this):t.forEachVertex(function(i){i.newPos.set&&(i.x=i.flatten.x||i.clamp.x?i.x:i.newPos.x,i.y=i.flatten.y||i.clamp.y?i.y:i.newPos.y,i.z=i.flatten.z||i.clamp.z?i.z:i.newPos.z,i.newPos.set=!1)},this)}}class DN{static transformVertices(t){let n=t._determineBounds(),i=new er;i=er.multiply(i,er.translate(t.position.x,t.position.y,t.position.z)),i=er.multiply(i,er.rotate(t.rotation.z,0,0,1)),i=er.multiply(i,er.rotate(t.rotation.y,0,1,0)),i=er.multiply(i,er.rotate(t.rotation.x,1,0,0)),i=er.multiply(i,er.scale(t.scale.x,t.scale.y,t.scale.z)),i=er.multiply(i,er.scale(n.scale.x,n.scale.y,n.scale.z)),i=er.multiply(i,er.translate(n.offset.x,n.offset.y,n.offset.z));let o=er.inverse(i);o=er.transpose(o),t.forEachVertex(function(s){i.transformPoint(s),s.averageNormal&&(o.transformVector(s.averageNormal),t._normalize(s.averageNormal))},this),t.voxels.forEach(function(s){for(let c in s.faces){let u=s.faces[c];if(u&&!u.skipped)for(let h=0;h<u.normals.length;h++)u.normals[h].transformed||(o.transformVector(u.normals[h]),t._normalize(u.normals[h]),u.normals[h].transformed=!0)}},this)}}class BN{static calculateNormals(t){let n=t.tile,i=t.voxels;i.forEach(function(o){for(let s in o.faces){let c=o.faces[s];if(c.skipped)continue;let u={x:(c.vertices[0].x+c.vertices[1].x+c.vertices[2].x+c.vertices[3].x)/4,y:(c.vertices[0].y+c.vertices[1].y+c.vertices[2].y+c.vertices[3].y)/4,z:(c.vertices[0].z+c.vertices[1].z+c.vertices[2].z+c.vertices[3].z)/4};c.normals=[];for(let h=0;h<4;h++){let f=c.vertices[h],p=c.vertices[(h+3)%4];f.normal||(f.normal={x:0,y:0,z:0},f.averageNormal={x:0,y:0,z:0});let m={x:p.x-f.x,y:p.y-f.y,z:p.z-f.z},y={x:u.x-f.x,y:u.y-f.y,z:u.z-f.z};t._normalize(m),t._normalize(y);let g={x:m.y*y.z-m.z*y.y,y:m.z*y.x-m.x*y.z,z:m.x*y.y-m.y*y.x};n&&((n.nx&&s==="nx"||n.px&&s==="px")&&(f.y<i.minY+.1||f.y>i.maxY+.9||f.z<i.minZ+.1||f.z>i.maxZ+.9)&&(g.y=0,g.z=0),(n.ny&&s==="ny"||n.py&&s==="py")&&(f.x<i.minX+.1||f.x>i.maxX+.9||f.z<i.minZ+.1||f.z>i.maxZ+.9)&&(g.x=0,g.z=0),(n.nz&&s==="nz"||n.pz&&s==="pz")&&(f.x<i.minX+.1||f.x>i.maxX+.9||f.y<i.minY+.1||f.y>i.maxY+.9)&&(g.x=0,g.y=0)),t._normalize(g),c.normals[h]=g;let _=m.x*y.x+m.y*y.y+m.z*y.z,x=Math.acos(_);o.material.lighting!==Ai.SMOOTH&&(o.material.lighting!==Ai.BOTH||c.flattened||c.clamped||c.equidistant===!1)||(f.normal.x+=x*g.x,f.normal.y+=x*g.y,f.normal.z+=x*g.z),f.averageNormal.x+=x*g.x,f.averageNormal.y+=x*g.y,f.averageNormal.z+=x*g.z}}},this),t.forEachVertex(function(o){t._normalize(o.normal),t._normalize(o.averageNormal)},this),t.voxels.forEach(function(o){for(let s in o.faces){let c=o.faces[s];c.skipped||o.material.lighting!==Ai.SMOOTH&&(o.material.lighting!==Ai.BOTH||c.flattened||c.clamped||c.equidistant===!1)||(c.normals=[t._isZero(c.vertices[0].normal)?c.normals[0]:c.vertices[0].normal,t._isZero(c.vertices[1].normal)?c.normals[1]:c.vertices[1].normal,t._isZero(c.vertices[2].normal)?c.normals[2]:c.vertices[2].normal,t._isZero(c.vertices[3].normal)?c.normals[3]:c.vertices[3].normal])}},this),t.forEachVertex(function(o){delete o.normal},this)}}class FN{static calculateLights(t){let n=t.lights;if(n.length!==0){for(let i=0;i<n.length;i++)n[i].direction&&(n[i].normalizedDirection=t._normalize({x:n[i].direction.x,y:n[i].direction.y,z:n[i].direction.z}));t.voxels.forEach(function(i){if(i.material.lights)for(let o in i.faces){let s=i.faces[o];if(!s.skipped){s.light=[{r:0,g:0,b:0},{r:0,g:0,b:0},{r:0,g:0,b:0},{r:0,g:0,b:0}];for(let c=0;c<4;c++){let u=s.vertices[c],h=s.normals[c];for(let f=0;f<n.length;f++){let p=n[f],m=p.strength,y=p.normalizedDirection,g=0;if(p.position){let _={x:p.position.x-u.x,y:p.position.y-u.y,z:p.position.z-u.z};g=Math.sqrt(_.x*_.x+_.y*_.y+_.z*_.z),y={x:_.x/g,y:_.y/g,z:_.z/g}}y&&(m=p.strength*Math.max(h.x*y.x+h.y*y.y+h.z*y.z,0)),p.position&&p.distance&&(m*=1-Math.min(g/p.distance,1)),s.light[c].r+=p.color.r*m,s.light[c].g+=p.color.g*m,s.light[c].b+=p.color.b*m}}}}},this,!0)}}}class Ec{static calculateAmbientOcclusion(t){if(!(t.ao||t.materials.find(function(u){return u.ao})))return;let n=this._getAllFaceTriangles(t),i=this._trianglesToOctree(n);i=this._aoSidesToOctree(t,i);let o=t.aoSamples,s=this._generateFibonacciSamples(o);t.triCount=0,t.octCount=0;let c={};t.voxels.forEach(function(u){let h=u.material.ao||t.ao;if(!h||h.maxDistance===0||h.strength===0||h.angle<1||u.material.opacity===0)return;let f=h.maxDistance*Math.max(t.scale.x,t.scale.y,t.scale.z),p=h.strength,m=Math.cos(h.angle/180*Math.PI);for(let y in u.faces){let g=u.faces[y];if(!g.skipped){g.ao[0]=0,g.ao[1]=0,g.ao[2]=0,g.ao[3]=0;for(let _=0;_<4;_++){let x=g.vertices[_],b=g.normals[_],E=`${x.x}|${x.y}|${x.z}|${b.x}|${b.y}|${b.z}`,T=c[E];if(T){g.ao[_]=T;continue}let P=g.vertices[(_+2)%4],D={x:.99999*x.x+1e-5*P.x+b.x/1e4,y:.99999*x.y+1e-5*P.y+b.y/1e4,z:.99999*x.z+1e-5*P.z+b.z/1e4},F=0,k=0;for(let W=0;W<o;W++){let j=s[W];if(j.x*b.x+j.y*b.y+j.z*b.z<=m)continue;let J=Ec._distanceToOctree(t,D,j,f,i);F+=J=(J||f)/f,k++}k===0?g.ao[_]=0:(F=Math.max(Math.min(F/k,1),0),g.ao[_]=1-Math.pow(F,p)),c[E]=g.ao[_]}}}},this,!0)}static _getAllFaceTriangles(t){let n=[];return t.voxels.forEach(function(i){if(!(i.material.opacity<.75))for(let o in i.faces){let s=i.faces[o];s.skipped||(n.push([s.vertices[2],s.vertices[1],s.vertices[0]]),n.push([s.vertices[0],s.vertices[3],s.vertices[2]]))}},this,!0),n}static _trianglesToOctree(t){let n=t.length;if(n<=32){let i={minx:Number.MAX_VALUE,miny:Number.MAX_VALUE,minz:Number.MAX_VALUE,maxx:-Number.MAX_VALUE,maxy:-Number.MAX_VALUE,maxz:-Number.MAX_VALUE,triangles:t};for(let o=0;o<n;o++){let s=t[o];i.minx=Math.min(i.minx,s[0].x,s[1].x,s[2].x),i.miny=Math.min(i.miny,s[0].y,s[1].y,s[2].y),i.minz=Math.min(i.minz,s[0].z,s[1].z,s[2].z),i.maxx=Math.max(i.maxx,s[0].x,s[1].x,s[2].x),i.maxy=Math.max(i.maxy,s[0].y,s[1].y,s[2].y),i.maxz=Math.max(i.maxz,s[0].z,s[1].z,s[2].z)}return i}{let i=0,o=0,s=0;for(let h=0;h<n;h++){let f=t[h];i+=f[0].x+f[1].x+f[2].x,o+=f[0].y+f[1].y+f[2].y,s+=f[0].z+f[1].z+f[2].z}i/=n,o/=n,s/=n;let c=[];for(let h=0;h<n;h++){let f=t[h],p=(f[0].x+f[1].x+f[2].x<i?0:1)+2*(f[0].y+f[1].y+f[2].y<o?0:1)+4*(f[0].z+f[1].z+f[2].z<s?0:1);c[p]?c[p].push(f):c[p]=[f]}let u={minx:Number.MAX_VALUE,miny:Number.MAX_VALUE,minz:Number.MAX_VALUE,maxx:-Number.MAX_VALUE,maxy:-Number.MAX_VALUE,maxz:-Number.MAX_VALUE,partitions:c};for(let h=7;h>=0;h--)c[h]?(c[h]=Ec._trianglesToOctree(c[h]),u.minx=Math.min(u.minx,c[h].minx),u.miny=Math.min(u.miny,c[h].miny),u.minz=Math.min(u.minz,c[h].minz),u.maxx=Math.max(u.maxx,c[h].maxx),u.maxy=Math.max(u.maxy,c[h].maxy),u.maxz=Math.max(u.maxz,c[h].maxz)):c.splice(h,1);return u}}static _distanceToOctree(t,n,i,o,s,c){if(t.octCount++,c||(c={x:n.x+i.x*o,y:n.y+i.y*o,z:n.z+i.z*o}),!Ec._hitsBox(n,c,s))return null;if(s.triangles){let h=Ec._distanceToModel(t,n,i,o,s.triangles);return h||t.octMissCount++,h}let u=o;for(let h=0;h<s.partitions.length;h++){let f=Ec._distanceToOctree(t,n,i,o,s.partitions[h],c);f&&(u=Math.min(u,f))}return u}static _aoSidesToOctree(t,n){let i=t._determineBounds().bounds,o=[];if(t._aoSides.nx&&o.push([{x:i.minX-.05,y:1e6,z:-1e6},{x:i.minX-.05,y:1e6,z:1e6},{x:i.minX-.05,y:-1e7,z:0}]),t._aoSides.px&&o.push([{x:i.maxX+.05,y:1e6,z:1e6},{x:i.maxX+.05,y:1e6,z:-1e6},{x:i.maxX+.05,y:-1e7,z:0}]),t._aoSides.ny&&o.push([{x:1e6,y:i.minY-.05,z:-1e6},{x:-1e6,y:i.minY-.05,z:-1e6},{x:0,y:i.minY-.05,z:1e7}]),t._aoSides.py&&o.push([{x:-1e6,y:i.maxY+.05,z:-1e6},{x:1e6,y:i.maxY+.05,z:-1e6},{x:0,y:i.maxY+.05,z:1e7}]),t._aoSides.nz&&o.push([{x:1e6,y:1e6,z:i.minZ-.05},{x:-1e6,y:1e6,z:i.minZ-.05},{x:0,y:-1e7,z:i.minZ-.05}]),t._aoSides.pz&&o.push([{x:-1e6,y:1e6,z:i.maxZ+.05},{x:1e6,y:1e6,z:i.maxZ+.05},{x:0,y:-1e7,z:i.maxZ+.05}]),o.length>0){let s=Ec._trianglesToOctree(o);n={minx:-Number.MAX_VALUE,miny:-Number.MAX_VALUE,minz:-Number.MAX_VALUE,maxx:Number.MAX_VALUE,maxy:Number.MAX_VALUE,maxz:Number.MAX_VALUE,partitions:[n,s]}}return n}static _hitsBox(t,n,i){if(t.x<i.minx&&n.x<i.minx||t.x>i.maxx&&n.x>i.maxx||t.y<i.miny&&n.y<i.miny||t.y>i.maxy&&n.y>i.maxy||t.z<i.minz&&n.z<i.minz||t.z>i.maxz&&n.z>i.maxz)return!1;if(t.x>=i.minx&&t.x<=i.maxx&&t.y>=i.miny&&t.y<=i.maxy&&t.z>=i.minz&&t.z<=i.maxz)return!0;if(t.x<n.x){let o=(i.minx-t.x)/(n.x-t.x),s=t.y+o*(n.y-t.y),c=t.z+o*(n.z-t.z);if(s>=i.miny&&s<=i.maxy&&c>=i.minz&&c<=i.maxz)return!0}if(t.x>n.x){let o=(i.maxx-t.x)/(n.x-t.x),s=t.y+o*(n.y-t.y),c=t.z+o*(n.z-t.z);if(s>=i.miny&&s<=i.maxy&&c>=i.minz&&c<=i.maxz)return!0}if(t.y<n.y){let o=(i.miny-t.y)/(n.y-t.y),s=t.x+o*(n.x-t.x),c=t.z+o*(n.z-t.z);if(s>=i.minx&&s<=i.maxx&&c>=i.minz&&c<=i.maxz)return!0}if(t.y>n.y){let o=(i.maxy-t.y)/(n.y-t.y),s=t.x+o*(n.x-t.x),c=t.z+o*(n.z-t.z);if(s>=i.minx&&s<=i.maxx&&c>=i.minz&&c<=i.maxz)return!0}if(t.z<n.z){let o=(i.minz-t.z)/(n.z-t.z),s=t.x+o*(n.x-t.x),c=t.y+o*(n.y-t.y);if(s>=i.minx&&s<=i.maxx&&c>=i.miny&&c<=i.maxy)return!0}if(t.z>n.z){let o=(i.maxz-t.z)/(n.z-t.z),s=t.x+o*(n.x-t.x),c=t.y+o*(n.y-t.y);if(s>=i.minx&&s<=i.maxx&&c>=i.miny&&c<=i.maxy)return!0}return!1}static _distanceToModel(t,n,i,o,s){let c=null;for(let u=0;u<s.length;u++){let h=s[u],f=this._triangleDistance(t,n,i,h[0],h[1],h[2]);f&&(c?c=Math.min(c,f):f<o&&(c=f))}return c}static _triangleDistance(t,n,i,o,s,c){t.triCount++;let u=s.x-o.x,h=s.y-o.y,f=s.z-o.z,p=c.x-o.x,m=c.y-o.y,y=c.z-o.z,g=i.y*y-i.z*m,_=i.z*p-i.x*y,x=i.x*m-i.y*p,b=u*g+h*_+f*x;if(b<Number.EPSILON)return null;let E=1/b,T=n.x-o.x,P=n.y-o.y,D=n.z-o.z,F=E*(T*g+P*_+D*x);if(F<0||F>1)return null;let k=P*f-D*h,W=D*u-T*f,j=T*h-P*u,J=E*(i.x*k+i.y*W+i.z*j);if(J<0||F+J>1)return null;let de=E*(p*k+m*W+y*j);return de<=Number.EPSILON?null:de}static _generateFibonacciSamples(t){let n=[],i=(2-(Math.sqrt(5)+1)/2)*(2*Math.PI);for(let o=1;o<=t;++o){let s=Math.asin(2*o/(t+1)-1),c=i*o,u=Math.cos(c)*Math.cos(s),h=Math.sin(s),f=Math.sin(c)*Math.cos(s);n.push({x:u,y:h,z:f})}return n}static _generateOctahedronSamples(t){let n=[],i=Math.PI/2/t;for(let o=0;o<=t;o++){let s=o*i,c=Math.cos(s),u=Math.sin(s),h=Math.max(1,4*o),f=2*Math.PI/h;for(let p=0;p<h;p++){let m=p*f,y=u*Math.sin(m),g=u*Math.cos(m);n.push({x:y,y:c,z:g}),o<t&&n.push({x:y,y:-c,z:g})}h+=4}return n}}class NN{static combineColors(t){let n=!!t.materials.find(i=>i.colors.length>1&&i.fade);t.voxels.forEach(function(i){let o=n&&i.material.fade&&i.material.colors.length>1;for(let s in i.faces){let c=i.faces[s];c&&!c.skipped&&(o?this._fadeFaceColor(i,c):delete c.vertexColors,this._combineFaceColors(t,i,c))}},this)}static _fadeFaceColor(t,n){n.vertexColors=[null,null,null,null];for(let i=0;i<4;i++){let o=n.vertices[i],s=0,c=0,u=0,h=0;for(let f=0;f<o.colors.length;f++){let p=o.colors[f];p.material===t.material&&(s+=p.r,c+=p.g,u+=p.b,h++)}n.vertexColors[i]=_s.fromRgb(s/h,c/h,u/h)}}static _combineFaceColors(t,n,i){if(n.material.colorCount!==1||n.material.ao||t.ao||t.lights.length!==0)if(n.material.colorCount>1&&!n.material.ao&&!t.ao&&t.lights.length===0&&!i.vertexColors)i.color=n.color;else{i.vertexColors=i.vertexColors||[n.color.clone(),n.color.clone(),n.color.clone(),n.color.clone()];let o=i.vertexColors,s=i.light||[{r:1,g:1,b:1},{r:1,g:1,b:1},{r:1,g:1,b:1},{r:1,g:1,b:1}],c=i.ao;for(let u=0;u<4;u++){let h=o[u],f=s[u],p=1-c[u],m=n.material.ao?n.material.ao.color:t.ao?t.ao.color:h;h.r=f.r*p*h.r+m.r*(1-p),h.g=f.g*p*h.g+m.g*(1-p),h.b=f.b*p*h.b+m.b*(1-p)}}}}class UN{static assignUVs(t){t.voxels.forEach(function(n){let i=n.material,o=0,s=1,c=1;(i.map||i.normalMap||i.roughnessMap||i.metalnessMap||i.emissiveMap)&&(i.mapTransform.uscale===-1&&(s=1/Math.max(t.voxels.size.x,t.voxels.size.y,t.voxels.size.z)),i.mapTransform.vscale===-1&&(c=1/Math.max(t.voxels.size.x,t.voxels.size.y,t.voxels.size.z)),(i.map&&i.map.cube||i.normalMap&&i.normalMap.cube||i.roughnessMap&&i.roughnessMap.cube||i.metalnessMap&&i.metalnessMap.cube||i.emissiveMap&&i.emissiveMap.cube)&&(o=1,s/=4,c/=2));for(let u in n.faces){let h=n.faces[u];if(h.skipped)continue;let f=Ai._FACEUVS[u];h.uv=[],h.uv[f.order[0]]={u:o*f.uo+(n[f.u]+1e-4)*f.ud*s,v:o*f.vo+(n[f.v]+1e-4)*f.vd*c},h.uv[f.order[1]]={u:o*f.uo+(n[f.u]+1e-4)*f.ud*s,v:o*f.vo+(n[f.v]+.9999)*f.vd*c},h.uv[f.order[2]]={u:o*f.uo+(n[f.u]+.9999)*f.ud*s,v:o*f.vo+(n[f.v]+.9999)*f.vd*c},h.uv[f.order[3]]={u:o*f.uo+(n[f.u]+.9999)*f.ud*s,v:o*f.vo+(n[f.v]+1e-4)*f.vd*c}}},this,!1)}}class yr{static simplify(t){let n={},i={},o={},s={},c=function(){n.lastVoxel=null,i.lastVoxel=null,o.lastVoxel=null,s.lastVoxel=null};for(let u=t.voxels.minX;u<=t.voxels.maxX;u++)for(let h=t.voxels.minZ;h<=t.voxels.maxZ;h++)for(let f=t.voxels.minY;f<=t.voxels.maxY;f++){let p=t.voxels.getVoxel(u,f,h);p?(yr._mergeFaces(n,p,"x","z","y","nx",0,1,2,3),yr._mergeFaces(i,p,"x","z","y","px",0,1,2,3),yr._mergeFaces(o,p,"x","z","y","nz",0,1,2,3),yr._mergeFaces(s,p,"x","z","y","pz",0,1,2,3)):c()}c();for(let u=t.voxels.minX;u<=t.voxels.maxX;u++)for(let h=t.voxels.minY;h<=t.voxels.maxY;h++)for(let f=t.voxels.minZ;f<=t.voxels.maxZ;f++){let p=t.voxels.getVoxel(u,h,f);p?(yr._mergeFaces(n,p,"x","y","z","nx",1,2,3,0),yr._mergeFaces(i,p,"x","y","z","px",3,0,1,2),yr._mergeFaces(o,p,"x","y","z","ny",0,1,2,3),yr._mergeFaces(s,p,"x","y","z","py",2,3,0,1)):c()}c();for(let u=t.voxels.minY;u<=t.voxels.maxY;u++)for(let h=t.voxels.minZ;h<=t.voxels.maxZ;h++)for(let f=t.voxels.minX;f<=t.voxels.maxX;f++){let p=t.voxels.getVoxel(f,u,h);p?(yr._mergeFaces(n,p,"y","z","x","ny",1,2,3,0),yr._mergeFaces(i,p,"y","z","x","py",1,2,3,0),yr._mergeFaces(o,p,"y","z","x","nz",3,0,1,2),yr._mergeFaces(s,p,"y","z","x","pz",1,2,3,0)):c()}}static _mergeFaces(t,n,i,o,s,c,u,h,f,p){let m=null;if(n&&(m=n.faces[c]),n&&t.lastVoxel&&m&&!m.skipped&&t.lastFace&&n.color===t.lastVoxel.color&&n[i]===t.lastVoxel[i]&&n[o]===t.lastVoxel[o]){let y=m.normals,g=t.lastFace.normals,_=m.vertexColors,x=t.lastFace.vertexColors,b=m.vertices,E=t.lastFace.vertices,T=m.ao,P=t.lastFace.ao,D=Math.sqrt((b[h].x-b[u].x)*(b[h].x-b[u].x)+(b[h].y-b[u].y)*(b[h].y-b[u].y)+(b[h].z-b[u].z)*(b[h].z-b[u].z))/Math.sqrt((b[h].x-E[u].x)*(b[h].x-E[u].x)+(b[h].y-E[u].y)*(b[h].y-E[u].y)+(b[h].z-E[u].z)*(b[h].z-E[u].z));if(yr._normalEquals(y[0],g[0])&&yr._normalEquals(y[1],g[1])&&yr._normalEquals(y[2],g[2])&&yr._normalEquals(y[3],g[3])&&(!_&&!x||yr._colorEquals(_[0],x[0])&&yr._colorEquals(_[1],x[1])&&yr._colorEquals(_[2],x[2])&&yr._colorEquals(_[3],x[3]))&&T[0]===P[0]&&T[1]===P[1]&&T[2]===P[2]&&T[3]===P[3]&&Math.abs(E[h][i]-(1-D)*b[h][i]-D*E[u][i])<=10*Number.EPSILON&&Math.abs(E[h][o]-(1-D)*b[h][o]-D*E[u][o])<=10*Number.EPSILON&&Math.abs(E[h][s]-(1-D)*b[h][s]-D*E[u][s])<=10*Number.EPSILON&&Math.abs(E[f][i]-(1-D)*b[f][i]-D*E[p][i])<=10*Number.EPSILON&&Math.abs(E[f][o]-(1-D)*b[f][o]-D*E[p][o])<=10*Number.EPSILON&&Math.abs(E[f][s]-(1-D)*b[f][s]-D*E[p][s])<=10*Number.EPSILON)return E[h]=b[h],E[f]=b[f],t.lastFace.uv[h]=m.uv[h],t.lastFace.uv[f]=m.uv[f],void delete n.faces[c]}t.lastVoxel=n,t.lastFace=m}static _normalEquals(t,n){return Math.abs(t.x-n.x)<.01&&Math.abs(t.y-n.y)<.01&&Math.abs(t.z-n.z)<.01}static _colorEquals(t,n){return t.r===n.r&&t.g===n.g&&t.b===n.b}static _faceVerticesToString(t){return`[${yr._vertexToString(t[0],0)},${yr._vertexToString(t[1],0)},${yr._vertexToString(t[2],0)},${yr._vertexToString(t[3],0)}]`}static _vertexToString(t,n){return`{${t.x.toFixed(n)},${t.y.toFixed(n)},${t.z.toFixed(n)}}`}}class ju{static alignFaceDiagonals(t){t.forEachVertex(function(i){i.count=0},this);let n=.1*Math.min(t.scale.x,t.scale.y,t.scale.z);n*=n,t.voxels.forEach(function(i){for(let o in i.faces){let s=i.faces[o];if(s.skipped)continue;s.vertices[0].count++,s.vertices[1].count++,s.vertices[2].count++,s.vertices[3].count++;let c=(s.vertices[0].x+s.vertices[2].x)/2,u=(s.vertices[0].y+s.vertices[2].y)/2,h=(s.vertices[0].z+s.vertices[2].z)/2,f=(s.vertices[1].x-c)*(s.vertices[1].x-c)+(s.vertices[1].y-u)*(s.vertices[1].y-u)+(s.vertices[1].z-h)*(s.vertices[1].z-h),p=(s.vertices[3].x-c)*(s.vertices[3].x-c)+(s.vertices[3].y-u)*(s.vertices[3].y-u)+(s.vertices[3].z-h)*(s.vertices[3].z-h),m=(s.vertices[1].x+s.vertices[3].x)/2,y=(s.vertices[1].y+s.vertices[3].y)/2,g=(s.vertices[1].z+s.vertices[3].z)/2,_=(s.vertices[0].x-m)*(s.vertices[0].x-m)+(s.vertices[0].y-y)*(s.vertices[0].y-y)+(s.vertices[0].z-g)*(s.vertices[0].z-g),x=(s.vertices[2].x-m)*(s.vertices[2].x-m)+(s.vertices[2].y-y)*(s.vertices[2].y-y)+(s.vertices[2].z-g)*(s.vertices[2].z-g);if(f<n||p<n)s.vertices.push(s.vertices.shift()),s.normals.push(s.normals.shift()),s.ao.push(s.ao.shift()),s.uv.push(s.uv.shift()),s.vertexColors&&s.vertexColors.push(s.vertexColors.shift());else if(!(_<n||x<n))if(s.ao&&Math.min(s.ao[0],s.ao[1],s.ao[2],s.ao[3])!==Math.max(s.ao[0],s.ao[1],s.ao[2],s.ao[3]))Math.abs(s.ao[0]-s.ao[2])<Math.abs(s.ao[1]-s.ao[3])&&(s.vertices.push(s.vertices.shift()),s.normals.push(s.normals.shift()),s.ao.push(s.ao.shift()),s.uv.push(s.uv.shift()),s.vertexColors&&s.vertexColors.push(s.vertexColors.shift()));else{let b=ju._getVertexSum(s.vertices[0]);for(;ju._getVertexSum(s.vertices[1])<b||ju._getVertexSum(s.vertices[2])<b||ju._getVertexSum(s.vertices[3])<b;)s.vertices.push(s.vertices.shift()),s.normals.push(s.normals.shift()),s.ao.push(s.ao.shift()),s.uv.push(s.uv.shift()),s.vertexColors&&s.vertexColors.push(s.vertexColors.shift()),b=ju._getVertexSum(s.vertices[0])}}},this)}static _getVertexSum(t){return Math.abs(t.x)+Math.abs(t.y)+Math.abs(t.z)}}class kN{constructor(t,n,i,o,s,c,u){this.color=t,this.strength=n,this.direction=i,this.position=o,this.distance=s,this.size=c,this.detail=u}}class zN{set origin(t){this._origin=Ji.parse(t)}get origin(){return Ji.toString(this._origin)}set flatten(t){this._flatten=Ji.parse(t)}get flatten(){return Ji.toString(this._flatten)}set clamp(t){this._clamp=Ji.parse(t)}get clamp(){return Ji.toString(this._clamp)}set skip(t){this._skip=Ji.parse(t)}get skip(){return Ji.toString(this._skip)}set tile(t){this._tile=Ji.parse(t),this._tile.x&&(this._tile=Ji.combine(this._tile,{nx:!0,px:!0})),this._tile.y&&(this._tile=Ji.combine(this._tile,{ny:!0,py:!0})),this._tile.z&&(this._tile=Ji.combine(this._tile,{nz:!0,pz:!0})),this._tile.x=!1,this._tile.y=!1,this._tile.z=!1}get tile(){return Ji.toString(this._tile)}set shape(t){if(this._shape=(t||"box").trim(),!["box","sphere","cylinder-x","cylinder-y","cylinder-z"].includes(this._shape))throw{name:"SyntaxError",message:`Unrecognized shape ${this._shape}. Allowed are box, sphere, cylinder-x, cylinder-y and cylinder-z`}}get shape(){return this._shape}setAo(t){this._ao=t}get ao(){return this._ao}set aoSides(t){this._aoSides=Ji.parse(t)}get aoSides(){return Ji.toString(this._aoSides)}set aoSamples(t){this._aoSamples=Math.round(t)}get aoSamples(){return this._aoSamples}constructor(){this.name="main",this.lights=[],this.textures={},this.materials=new ON,this.voxels=new LN,this.vertices=[],this.scale={x:1,y:1,z:1},this.rotation={x:0,y:0,z:0},this.position={x:0,y:0,z:0},this.autoResize=!1,this._origin=Ji.parse("x y z"),this._flatten=Ji.parse(""),this._clamp=Ji.parse(""),this._skip=Ji.parse(""),this._tile=Ji.parse(""),this._ao=void 0,this._aoSamples=50,this._aoSides=Ji.parse(""),this.shape="box",this.wireframe=!1,this.triCount=0,this.octCount=0,this.octMissCount=0}_setVertex(t,n,i,o){o.x=t,o.y=n,o.z=i;let s=this.vertices[i+1e6];s||(s=[],this.vertices[i+1e6]=s);let c=s[n+1e6];c||(c=[],s[n+1e6]=c),c[t+1e6]=o}_getVertex(t,n,i){let o=this.vertices[i+1e6];return o&&(o=o[n+1e6])?o[t+1e6]:null}forEachVertex(t,n){for(let i in this.vertices){let o=this.vertices[i];for(let s in o){let c=o[s];for(let u in c)t.apply(n,[c[u]])}}}prepareForWrite(){this.materials.forEach(function(t){t.bounds.reset(),t.colors.forEach(function(n){n.count=0},this)},this),this.shell&&this.shell.forEach(function(t){t.color.count++},this),this.materials.forEach(function(t){t.shell&&t.shell.forEach(function(n){n.color.count++},this)},this),this.lights.some(t=>t.size)&&(this.materials.materials[0].colors[0].count=1),this.voxels.prepareForWrite()}prepareForRender(){this.prepareForWrite();let t=_o.maximumDeformCount(this);this.vertices=[],this.voxels.forEach(function(n){let i=0;for(let o=0;o<Ai._FACES.length;o++){let s=Ai._FACES[o],c=Ai._NEIGHBORS[s],u=this._createFace(n,s,this.voxels.getVoxel(n.x+c.x,n.y+c.y,n.z+c.z),t>0);u&&(n.faces[s]=u,u.skipped||n.color.count++,i++)}n.visible=i>0},this,!1),this._fixClampedLinks(),_o.changeShape(this,this._shape),_o.deform(this,t),_o.warpAndScatter(this),BN.calculateNormals(this),DN.transformVertices(this),FN.calculateLights(this),Ec.calculateAmbientOcclusion(this),NN.combineColors(this),UN.assignUVs(this),yr.simplify(this),ju.alignFaceDiagonals(this)}_logLinks(){this.voxels.forEach(function(t){for(let n in t.faces){let i=t.faces[n];if(i.skipped)continue;let o=`VOXEL (${t.x},${t.y},${t.z}):${n}\r
`;for(let s=0;s<4;s++){let c=i.vertices[s];c.fullyClamped=c.fullyClamped||c.nrOfClampedLinks===c.links.length,o+=`    VERTEX (${c.x},${c.y},${c.z}):${c.fullyClampes?"fully":""} :`;for(let u=0;u<c.links.length;u++){let h=c.links[u];o+=`(${h.x},${h.y},${h.z}) `}o+=`\r
`}console.log(o)}},this)}_fixClampedLinks(){this.voxels.forEach(function(t){for(let n in t.faces){let i=t.faces[n];if(i.clamped)for(let o=0;o<4;o++){let s=i.vertices[o];s.fullyClamped=s.fullyClamped||s.nrOfClampedLinks===s.links.length,s.fullyClamped&&(s.links=[])}}}),this.voxels.forEach(function(t){for(let n in t.faces){let i=t.faces[n];if(i.clamped)for(let o=0;o<4;o++){let s=i.vertices[o],c=i.vertices[(o+1)%4];s.fullyClamped&&s.links.indexOf(c)===-1&&s.links.push(c),c.fullyClamped&&c.links.indexOf(s)===-1&&c.links.push(s)}}})}_determineBounds(){let t=Number.POSITIVE_INFINITY,n=Number.POSITIVE_INFINITY,i=Number.POSITIVE_INFINITY,o=Number.NEGATIVE_INFINITY,s=Number.NEGATIVE_INFINITY,c=Number.NEGATIVE_INFINITY;this.voxels.forEach(function(g){for(let _ in g.faces){let x=g.faces[_];if(!x.skipped)for(let b=0;b<4;b++){let E=x.vertices[b];E.x<t&&(t=E.x),E.y<n&&(n=E.y),E.z<i&&(i=E.z),E.x>o&&(o=E.x),E.y>s&&(s=E.y),E.z>c&&(c=E.z)}}});let u=-(t+o)/2,h=-(n+s)/2,f=-(i+c)/2;this._origin.nx&&(u=-t),this._origin.px&&(u=-o),this._origin.ny&&(h=-n),this._origin.py&&(h=-s),this._origin.nz&&(f=-i),this._origin.pz&&(f=-c);let p=(this.voxels.maxX-this.voxels.minX+1)/(o-t),m=(this.voxels.maxY-this.voxels.minY+1)/(s-n),y=(this.voxels.maxZ-this.voxels.minZ+1)/(c-i);return p=m=y=this.autoResize?Math.min(p,m,y):1,{bounds:{minX:t,minY:n,minZ:i,maxX:o,maxY:s,maxZ:c},offset:{x:u,y:h,z:f},scale:{x:p,y:m,z:y}}}_lookAtVertices(t,n,i,o,s,c,u,h,f){let p=er.lookAt(t,n,i,o,s,c,u,h,f);this.forEachVertex(function(y){p.transformPoint(y)},this);let m=er.inverse(p);m=er.transpose(m),this.voxels.forEach(function(y){for(let g in y.faces){let _=y.faces[g];for(let x=0;x<_.normals.length;x++)_.normals[x].transformed||(m.transformVector(_.normals[x]),_.normals[x].transformed=!0)}},this)}_createFace(t,n,i,o){if(!t||!t.material||t.material.opacity===0||i&&i.material&&(!i.material.isTransparent&&!i.material.wireframe||(t.material.isTransparent||t.material.wireframe)&&(!t.material.isTransparent||t.material.wireframe||!i.material.wireframe)))return null;let s=this._isFacePlanar(t,n,t.material._flatten,this._flatten),c=this._isFacePlanar(t,n,t.material._clamp,this._clamp),u=this._isFacePlanar(t,n,t.material._skip,this._skip),h={vertices:[this._createVertex(t,n,0,s,c),this._createVertex(t,n,1,s,c),this._createVertex(t,n,2,s,c),this._createVertex(t,n,3,s,c)],ao:[0,0,0,0],uv:[null,null,null,null],flattened:s,clamped:c,skipped:u};return o&&this._linkVertices(t,h,n),h}_createVertex(t,n,i,o,s){let c=Ai._VERTICES[n][i],u=t.x+c.x,h=t.y+c.y,f=t.z+c.z,p=t.material,m={x:!1,y:!1,z:!1},y={x:!1,y:!1,z:!1};m[n[1]]=o,y[n[1]]=s;let g=this._getVertex(u,h,f);return g?(g.colors.push(t.color),g.flatten.x=g.flatten.x||m.x,g.flatten.y=g.flatten.y||m.y,g.flatten.z=g.flatten.z||m.z,g.clamp.x=g.clamp.x||y.x,g.clamp.y=g.clamp.y||y.y,g.clamp.z=g.clamp.z||y.z,p.deform?g.deform&&this._getDeformIntegral(p.deform)<this._getDeformIntegral(g.deform)&&(g.deform=p.deform):g.deform=null,p.warp?g.warp&&(p.warp.amplitude<g.warp.amplitude||p.warp.amplitude===g.warp.amplitude&&p.warp.frequency>g.warp.frequency)&&(g.warp=p.warp):g.warp=null,p.scatter?g.scatter&&Math.abs(p.scatter)<Math.abs(g.scatter)&&(g.scatter=p.scatter):g.scatter=null):(g={x:u,y:h,z:f,links:[],nrOfClampedLinks:0,colors:[t.color],newPos:{x:0,y:0,z:0,set:!1},deform:p.deform,warp:p.warp,scatter:p.scatter,flatten:m,clamp:y,count:1},this._setVertex(u,h,f,g)),g}_getDeformIntegral(t){return t.damping===1?t.strength*(t.count+1):t.strength*(1-Math.pow(t.damping,t.count+1))/(1-t.damping)}_isFacePlanar(t,n,i,o){let s=t.material;switch(n){case"nx":return i.x||o.x||i.nx&&t.x===s.bounds.minX||o.nx&&t.x===this.voxels.minX;case"px":return i.x||o.x||i.px&&t.x===s.bounds.maxX||o.px&&t.x===this.voxels.maxX;case"ny":return i.y||o.y||i.ny&&t.y===s.bounds.minY||o.ny&&t.y===this.voxels.minY;case"py":return i.y||o.y||i.py&&t.y===s.bounds.maxY||o.py&&t.y===this.voxels.maxY;case"nz":return i.z||o.z||i.nz&&t.z===s.bounds.minZ||o.nz&&t.z===this.voxels.minZ;case"pz":return i.z||o.z||i.pz&&t.z===s.bounds.maxZ||o.pz&&t.z===this.voxels.maxZ;default:return!1}}_linkVertices(t,n,i){if(n.clamped)for(let o=0;o<4;o++){let s=n.vertices[o];s.links.indexOf(s)===-1&&(s.links.push(s),s.nrOfClampedLinks++)}else for(let o=0;o<4;o++){let s=n.vertices[o],c=n.vertices[(o+1)%4];s.links.indexOf(c)===-1&&s.links.push(c),c.links.indexOf(s)===-1&&c.links.push(s)}}_normalize(t){if(t){let n=Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z);n>0&&(t.x/=n,t.y/=n,t.z/=n)}return t}_isZero(t){return!t||t.x===0&&t.y===0&&t.z===0}}class tS{static readFromString(t){let n=this._parse(t);return this._validateModel(n),this._createModel(n)}static _parse(t){const n={linecontinuation:new RegExp(/_\s*[\r\n]/gm),modelparts:new RegExp(/\s*(\/\/(.*?)\r?\n)/.source+"|"+/\s*(texture|light|model|material|voxels)\s+/.source+"|"+/\s*([^=,\r\n]+=\s*data:image.*?base64,.*$)\s*/.source+"|"+/\s*([^=,\r\n]+=[^\r\n=;,\/]+)\s*/.source+"|"+/\s*([A-Za-z \(\)\d -]+)\s*/.source,"gm")};let i={lights:[],textures:[],materials:[]},o=i,s=null;return Array.from(t.replaceAll(n.linecontinuation," ").matchAll(n.modelparts),c=>c[0].trim()).filter(c=>c).forEach(function(c){if(!c.startsWith("//"))if(c==="texture")o={id:"<no-name>",cube:!1},i.textures.push(o);else if(c==="light")o={color:"#FFF"},i.lights.push(o);else if(c==="model")o=i;else if(c==="material")o={},i.materials.push(o);else if(c==="voxels")o=i,s="";else if(s!==null)s+=c.replace(/\s/g,"");else{let u=c.indexOf("=");if(u===-1)throw{name:"SyntaxError",message:`Invalid definition '${c}'.`};let h=c.substring(0,u).trim().toLowerCase(),f=c.substring(u+1).trim();o[h]=f}},this),i.voxels=s,i}static _createModel(t){let n=new zN;return n.size=this._parseXYZInt("size",t.size,null,!0),n.scale=this._parseXYZFloat("scale",t.scale,"1",!0),n.rotation=this._parseXYZFloat("rotation",t.rotation,"0 0 0",!1),n.position=this._parseXYZFloat("position",t.position,"0 0 0",!1),n.autoResize=t.autoresize==="true"||!1,n.shape=t.shape,n.wireframe=t.wireframe==="true"||!1,n.origin=t.origin,n.flatten=t.flatten,n.clamp=t.clamp,n.skip=t.skip,n.tile=t.tile,n.setAo(this._parseAo(t.ao)),n.aoSides=t.aosides,n.aoSamples=parseInt(t.aosamples||50,10),n.shell=this._parseShell(t.shell),t.lights.some(i=>i.size)&&n.materials.createMaterial(Ai.MATBASIC,Ai.FLAT,1,0,!1,1,0,!1,!1,Ai.FRONT,"#FFF",0,!1,null,null,null,null,null,null,-1,-1,0,0,0,0).addColorHEX("#FFFFFF"),t.lights.forEach(function(i){this._createLight(n,i)},this),t.textures.forEach(function(i){this._createTexture(n,i)},this),t.materials.forEach(function(i){this._createMaterial(n,i)},this),n.colors={},n.materials.forEach(function(i){i.colors.forEach(function(o){n.colors[o.id]=o})}),this._resolveShellColors(n.shell,n),n.materials.forEach(function(i){this._resolveShellColors(i.shell,n)},this),this._createVoxels(n,t.voxels),n}static _createLight(t,n){n.color||(n.color="#FFF 1"),n.color.startsWith("#")||(n.color="#FFF "+n.color),n.strength=parseFloat(n.color.split(" ")[1]||1),n.color=_s.fromHex(n.color.split(" ")[0]),n.direction=this._parseXYZFloat("direction",n.direction,null,!1),n.position=this._parseXYZFloat("position",n.position,null,!1),n.distance=parseFloat(n.distance||0),n.size=Math.max(0,parseFloat(n.size||0)),n.detail=Math.min(3,Math.max(0,parseInt(n.detail||1,10)));let i=new kN(n.color,n.strength,n.direction,n.position,n.distance,n.size,n.detail);t.lights.push(i)}static _createTexture(t,n){n.cube=n.cube==="true"||!1,t.textures[n.id]=n}static _createMaterial(t,n){let i=Ai.FLAT;n.lighting===Ai.SMOOTH&&(i=Ai.SMOOTH),n.lighting===Ai.BOTH&&(i=Ai.BOTH),n.emissive||(n.emissivemap?n.emissive="#FFF 1":n.emissive="#000 0"),n.emissive.startsWith("#")||(n.emissive="#FFF "+n.emissive),n.emissiveColor=n.emissive.split(" ")[0],n.emissiveIntensity=n.emissive.split(" ")[1]||1,n.ao&&!n.ao.startsWith("#")&&(n.ao="#000 "+n.ao),n.maptransform=n.maptransform||"";let o=t.materials.createMaterial(n.type||Ai.MATSTANDARD,i,parseFloat(n.roughness||(n.roughnessmap,1)),parseFloat(n.metalness||(n.metalnessmap?1:0)),n.fade==="true"||!1,parseFloat(n.opacity||1),parseFloat(n.alphatest||0),n.transparent==="true"||!1,n.wireframe==="true"||!1,n.side,n.emissiveColor,n.emissiveIntensity,n.fog!=="false",n.map?t.textures[n.map]:null,n.normalmap?t.textures[n.normalmap]:null,n.roughnessmap?t.textures[n.roughnessmap]:null,n.metalnessmap?t.textures[n.metalnessmap]:null,n.emissivemap?t.textures[n.emissivemap]:null,n.matcap?t.textures[n.matcap]:null,parseFloat(n.maptransform.split(" ")[0]||-1),parseFloat(n.maptransform.split(" ")[1]||-1),parseFloat(n.maptransform.split(" ")[2]||0),parseFloat(n.maptransform.split(" ")[3]||0),parseFloat(n.maptransform.split(" ")[4]||0));n.deform&&o.setDeform(parseFloat(n.deform.split(" ")[0]),parseFloat(n.deform.split(" ")[1]||1),parseFloat(n.deform.split(" ")[2]||1)),n.warp&&o.setWarp(parseFloat(n.warp.split(" ")[0]),parseFloat(n.warp.split(" ")[1]||1)),n.scatter&&(o.scatter=parseFloat(n.scatter)),o.flatten=n.flatten,o.clamp=n.clamp,o.skip=n.skip,o.setAo(this._parseAo(n.ao)),o.shell=this._parseShell(n.shell),o.lights=n.lights!=="false",n.colors=n.colors.replace(/\s*\(\s*(\d+)\s*\)\s*/g,"($1)"),n.colors=n.colors.replace(/([A-Z][a-z]*)\s*(\(\d+\))?[:]\s*(#[a-fA-F0-9]*)\s*/g,"$1$2:$3 "),n.colors.split(" ").filter(s=>s).forEach(function(s){let c=s.split(":")[0],u=null;c.includes("(")&&(u=Number(c.split("(")[1].replace(")","")),c=c.split("(")[0]);let h=s.split(":")[1];if(!o.colors[c]){if(h=o.addColor(_s.fromHex(h)),!/^[A-Z][a-z]*$/.test(c))throw{name:"SyntaxError",message:`Invalid color ID '${c}'.`};h.id=c,h.exId=u}},this)}static _createVoxels(t,n){let i=t.colors,o=null,s=[];if(n.matchAll)s=n.matchAll(/[0-9]+|[A-Z][a-z]*|-+|[()]/g);else{let p,m=RegExp("[0-9]+|[A-Z][a-z]*|-+|[()]","g");for(;(p=m.exec(n))!==null;)console.log(p),s.push(p);s=s[Symbol.iterator]()}let c=this._unpackRle(s),u=t.size.x*t.size.y*t.size.z,h=0;for(let p=0;p<c.length;p++)h+=c[p][1];if(h!==u)throw{name:"SyntaxError",message:`The specified size is ${t.size.x} x ${t.size.y} x ${t.size.z} (= ${u} voxels) but the voxel matrix contains ${h} voxels.`};let f={minx:0,miny:0,minz:0,maxx:t.size.x-1,maxy:t.size.y-1,maxz:t.size.z-1,x:0,y:0,z:0};for(let p=0;p<c.length;p++){let m=null;c[p][0]!=="-"&&((m=i[c[p][0]])||(o===null&&(o=t.materials.createMaterial(Ai.MATSTANDARD,Ai.FLAT,.5,0,!1,1,!1)),(m=_s.fromHex("#FF00FF")).id=c[p][0],o.addColor(m),i[c[p][0]]=m)),this._setVoxels(t,m,c[p][1],f)}}static _parseAo(t){let n;if(t){t.startsWith("#")||(t="#000 "+t);let i=_s.fromHex(t.split(" ")[0]),o=Math.abs(parseFloat(t.split(" ")[1]||1)),s=parseFloat(t.split(" ")[2]||1),c=parseFloat(t.split(" ")[3]||70);n={color:i,maxDistance:o,strength:s,angle:c=Math.max(0,Math.min(90,Math.round(c)))}}return n}static _parseShell(t){let n,i=!1;if(t&&(n=[],t!=="none")){let o=t.split(/\s+/);if(o.length<2||o.length%2!=0)i=!0;else for(let s=0;s<o.length/2;s++){let c=o[2*s+0],u=o[2*s+1];if(!/^[A-Z][a-z]*$/.test(c)||!/^([-+]?[0-9]*\.?[0-9]+)*$/.test(u)){i=!0;break}n.push({colorId:o[2*s],distance:o[2*s+1]})}}if(i)throw{name:"SyntaxError",message:`shell '${t}' must be 'none' or one or more color ID's and distances, e.g. P 0.2 Q 0.4`};return n&&(n=n.sort(function(o,s){return o.distance-s.distance})),n}static _resolveShellColors(t,n){t&&t.length!==0&&t.forEach(function(i){if(i.color=n.colors[i.colorId],!i.color)throw{name:"SyntaxError",message:`shell color ID '${i.colorId}' not found in one of the materials.`}},this)}static _parseXYZInt(t,n,i,o){let s=this._parseXYZFloat(t,n,i,o);return{x:Math.trunc(s.x),y:Math.trunc(s.y),z:Math.trunc(s.z)}}static _parseXYZFloat(t,n,i,o){if(!n&&i&&(n=i),!n)return null;let s=n.split(/[\s/]+/);if(s.length===1&&o&&(s.push(s[0]),s.push(s[0])),s.length!==3)throw{name:"SyntaxError",message:`'${t}' must have three values.`};if(s={x:parseFloat(s[0]),y:parseFloat(s[1]),z:parseFloat(s[2])},Number.isNaN(s.x)||Number.isNaN(s.y)||Number.isNaN(s.z))throw{name:"SyntaxError",message:`Invalid value '${n}' for ${t}'.`};return s}static _unpackRle(t){let n=[],i=1,o=t.next();for(;!o.done;){let s=o.value[0];if(s[0]>="0"&&s[0]<="9")i=parseInt(s,10);else if(s==="("){let c=this._unpackRle(t);for(let u=0;u<i;u++)Array.prototype.push.apply(n,c);i=1}else{if(s===")")return n;s.length>1&&s[0]>="A"&&s[0]<="Z"&&s[1]===s[0]?(i>1?(n.push([s[0],i]),n.push([s[0],s.length-1])):n.push([s[0],s.length]),i=1):s.length>1&&s[0]==="-"&&s[1]==="-"?(i>1?(n.push(["-",i]),n.push(["-",s.length-1])):n.push(["-",s.length]),i=1):(n.push([s,i]),i=1)}o=t.next()}return n}static _setVoxels(t,n,i,o){for(;i-- >0;)n&&t.voxels.setVoxel(o.x,o.y,o.z,new fC(n)),o.x++,o.x>o.maxx&&(o.x=o.minx,o.y++),o.y>o.maxy&&(o.y=o.miny,o.z++)}static _validateModel(t){this._validateProperties(t,["size","materials","textures","lights","voxels"],["name","shape","scale","rotation","position","origin","autoresize","flatten","clamp","skip","tile","ao","aosides","aosamples","shell","wireframe"],"model"),t.lights.forEach(function(n){this._validateLight(n)},this),t.textures.forEach(function(n){this._validateTexture(n)},this),t.materials.forEach(function(n){this._validateMaterial(n)},this)}static _validateLight(t){if(this._validateProperties(t,["color"],["direction","position","distance","size","detail"],"light"),t.direction&&t.position)throw{name:"SyntaxError",message:"A light cannot have a 'position' as well as a 'direction'."};if(t.direction&&t.distance)throw{name:"SyntaxError",message:"A directional light cannot have a 'distance'."};if(!t.position&&(t.size||t.detail))throw{name:"SyntaxError",message:"Only positional lights can have size and detail."}}static _validateTexture(t){this._validateProperties(t,["id","image"],["cube"],"texture")}static _validateMaterial(t){this._validateProperties(t,["colors"],["type","lighting","fade","roughness","metalness","emissive","fog","opacity","alphatest","transparent","deform","warp","scatter","flatten","clamp","skip","ao","lights","wireframe","side","shell","map","normalmap","roughnessmap","metalnessmap","emissivemap","matcap","maptransform"],"material")}static _validateProperties(t,n,i,o){for(let s of n)if(!t[s])throw{name:"SyntaxError",message:`Mandatory property '${s}' not set in ${o}.`};for(let s in t)if(!n.includes(s)&&!i.includes(s))throw{name:"SyntaxError",message:`Unknown property '${s}' found in ${o}.`}}}class Zi{static generate(t){let n={materials:[],groups:[],positions:[],normals:[],colors:[],uvs:null};t.prepareForRender();let i=!1;return t.materials.baseMaterials.forEach(function(o){o.colorUsageCount>0&&(o.index=n.materials.length,n.materials.push(Zi._generateMaterial(o,t)),i=i||o.map||o.normalMap||o.roughnessMap||o.metalnessMap||o.emissiveMap)},this),i&&(n.uvs=[]),Zi._generateAll(t,n),Zi._generateLights(t,n),n}static _generateMaterial(t,n){t.ao||n.ao;let i={type:t.type,roughness:t.roughness,metalness:t.metalness,opacity:t.opacity,alphaTest:t.alphaTest,transparent:t.isTransparent,wireframe:t.wireframe||n.wireframe,fog:t.fog,vertexColors:"FaceColors",side:t.side===Ai.DOUBLE?Ai.DOUBLE:Ai.FRONT};return t.type!==Ai.MATNORMAL&&(i.vertexColors="VertexColors",i.color="#FFF"),t.emissive&&(i.emissive=t.emissive.color.toString(),i.emissiveIntensity=t.emissive.intensity),t.map&&(i.map={image:t.map.image,uscale:t.mapTransform.uscale===-1?1:t.mapTransform.uscale,vscale:t.mapTransform.vscale===-1?1:t.mapTransform.vscale,uoffset:t.mapTransform.uoffset,voffset:t.mapTransform.voffset,rotation:t.mapTransform.rotation}),t.normalMap&&(i.normalMap={image:t.normalMap.image,uscale:t.mapTransform.uscale===-1?1:t.mapTransform.uscale,vscale:t.mapTransform.vscale===-1?1:t.mapTransform.vscale,uoffset:t.mapTransform.uoffset,voffset:t.mapTransform.voffset,rotation:t.mapTransform.rotation}),t.roughnessMap&&(i.roughnessMap={image:t.roughnessMap.image,uscale:t.mapTransform.uscale===-1?1:t.mapTransform.uscale,vscale:t.mapTransform.vscale===-1?1:t.mapTransform.vscale,uoffset:t.mapTransform.uoffset,voffset:t.mapTransform.voffset,rotation:t.mapTransform.rotation}),t.metalnessMap&&(i.metalnessMap={image:t.metalnessMap.image,uscale:t.mapTransform.uscale===-1?1:t.mapTransform.uscale,vscale:t.mapTransform.vscale===-1?1:t.mapTransform.vscale,uoffset:t.mapTransform.uoffset,voffset:t.mapTransform.voffset,rotation:t.mapTransform.rotation}),t.emissiveMap&&(i.emissiveMap={image:t.emissiveMap.image,uscale:t.mapTransform.uscale===-1?1:t.mapTransform.uscale,vscale:t.mapTransform.vscale===-1?1:t.mapTransform.vscale,uoffset:t.mapTransform.uoffset,voffset:t.mapTransform.voffset,rotation:t.mapTransform.rotation}),t.matcap&&(i.matcap={image:t.matcap.image}),i}static _generateAll(t,n){let i=Zi._getAllShells(t);t.materials.baseMaterials.forEach(function(o){if(o.colorUsageCount>0){let s=n.positions.length;t.voxels.forEach(function(u){u.material.index===o.index&&Zi._generateVoxel(t,u,n),i.forEach(function(h){h.shellMaterialIndex===o.index&&h.voxelMaterial===u.color.material&&Zi._generateVoxelShell(t,u,n,h.distance,h.color)},this)},this);let c=n.positions.length;n.groups.push({start:s/3,count:(c-s)/3,materialIndex:o.index})}},this)}static _generateVoxels(t,n){t.materials.baseMaterials.forEach(function(i){if(i.colorUsageCount>0){let o=n.positions.length;t.voxels.forEach(function(c){c.material.index===i.index&&Zi._generateVoxel(t,c,n)},this);let s=n.positions.length;n.groups.push({start:o/3,count:(s-o)/3,materialIndex:i.index})}},this)}static _generateVoxel(t,n,i){for(let o=0;o<Ai._FACES.length;o++){let s=n.faces[Ai._FACES[o]];s&&!s.skipped&&Zi._generateVoxelFace(t,n,s,i)}}static _generateVoxelFace(t,n,i,o){let s,c,u,h,f,p,m,y,g,_,x,b,E,T,P,D;if(s=i.vertices[0],c=i.vertices[1],u=i.vertices[2],h=i.vertices[3],f=i.normals[0],p=i.normals[1],m=i.normals[2],y=i.normals[3],i.vertexColors&&(g=i.vertexColors[0],_=i.vertexColors[1],x=i.vertexColors[2],b=i.vertexColors[3]),o.uvs&&(E=i.uv[0]||{u:0,v:0},T=i.uv[1]||{u:0,v:0},P=i.uv[2]||{u:0,v:0},D=i.uv[3]||{u:0,v:0}),n.color.material.side==="back"){let F;F=s,s=u,u=F,F=f,f=m,m=F,F=g,g=x,x=F,F=E,E=P,P=F}if(i.vertexColors&&Ai.clampColors&&(Zi._clampColor(g),Zi._clampColor(_),Zi._clampColor(x),Zi._clampColor(b)),o.positions.push(u.x,u.y,u.z),o.positions.push(c.x,c.y,c.z),o.positions.push(s.x,s.y,s.z),o.positions.push(s.x,s.y,s.z),o.positions.push(h.x,h.y,h.z),o.positions.push(u.x,u.y,u.z),n.material.lighting===Ai.FLAT){let F=i.normals[1],k=i.normals[3];o.normals.push(F.x,F.y,F.z),o.normals.push(F.x,F.y,F.z),o.normals.push(F.x,F.y,F.z),o.normals.push(k.x,k.y,k.z),o.normals.push(k.x,k.y,k.z),o.normals.push(k.x,k.y,k.z)}else o.normals.push(m.x,m.y,m.z),o.normals.push(p.x,p.y,p.z),o.normals.push(f.x,f.y,f.z),o.normals.push(f.x,f.y,f.z),o.normals.push(y.x,y.y,y.z),o.normals.push(m.x,m.y,m.z);if(i.vertexColors)o.colors.push(x.r,x.g,x.b),o.colors.push(_.r,_.g,_.b),o.colors.push(g.r,g.g,g.b),o.colors.push(g.r,g.g,g.b),o.colors.push(b.r,b.g,b.b),o.colors.push(x.r,x.g,x.b);else if(i.color)for(let F=0;F<6;F++)o.colors.push(i.color.r,i.color.g,i.color.b);else{let F=n.color;for(let k=0;k<6;k++)o.colors.push(F.r,F.g,F.b)}o.uvs&&(o.uvs.push(P.u,P.v),o.uvs.push(T.u,T.v),o.uvs.push(E.u,E.v),o.uvs.push(E.u,E.v),o.uvs.push(D.u,D.v),o.uvs.push(P.u,P.v))}static _clampColor(t){t.r=Math.max(Math.min(t.r,1),0),t.g=Math.max(Math.min(t.g,1),0),t.b=Math.max(Math.min(t.b,1),0)}static _generateLights(t,n){if(t.lights.some(i=>i.size)){let i={x:0,y:1,z:0},o={x:0,y:0,z:-1},s={x:1,y:0,z:0},c={x:0,y:0,z:1},u={x:-1,y:0,z:0},h={x:0,y:-1,z:0},f=n.positions.length;t.lights.filter(m=>m.position).forEach(function(m){if(m.size>0){let y=m.size/2,g=m.detail;Zi._createLightFace(m.position,m.color,y,g,o,s,i,n),Zi._createLightFace(m.position,m.color,y,g,s,c,i,n),Zi._createLightFace(m.position,m.color,y,g,c,u,i,n),Zi._createLightFace(m.position,m.color,y,g,u,o,i,n),Zi._createLightFace(m.position,m.color,y,g,o,h,s,n),Zi._createLightFace(m.position,m.color,y,g,s,h,c,n),Zi._createLightFace(m.position,m.color,y,g,c,h,u,n),Zi._createLightFace(m.position,m.color,y,g,u,h,o,n)}});let p=n.positions.length;n.groups.push({start:f/3,count:(p-f)/3,materialIndex:0})}}static _createLightFace(t,n,i,o,s,c,u,h){if(o===0)h.positions.push(t.x+u.x*i,t.y+u.y*i,t.z+u.z*i),h.positions.push(t.x+c.x*i,t.y+c.y*i,t.z+c.z*i),h.positions.push(t.x+s.x*i,t.y+s.y*i,t.z+s.z*i),h.normals.push(0,0,1),h.normals.push(0,0,1),h.normals.push(0,0,1),h.colors.push(n.r,n.g,n.b),h.colors.push(n.r,n.g,n.b),h.colors.push(n.r,n.g,n.b),h.uvs&&(h.uvs.push(0,0),h.uvs.push(0,0),h.uvs.push(0,0));else{let f=Zi._normalize({x:(c.x+s.x)/2,y:(c.y+s.y)/2,z:(c.z+s.z)/2}),p=Zi._normalize({x:(c.x+u.x)/2,y:(c.y+u.y)/2,z:(c.z+u.z)/2}),m=Zi._normalize({x:(s.x+u.x)/2,y:(s.y+u.y)/2,z:(s.z+u.z)/2});Zi._createLightFace(t,n,i,o-1,f,c,p,h),Zi._createLightFace(t,n,i,o-1,s,f,m,h),Zi._createLightFace(t,n,i,o-1,m,p,u,h),Zi._createLightFace(t,n,i,o-1,f,p,m,h)}}static _getAllShells(t){let n=[];return t.materials.forEach(function(i){let o;t.shell&&t.shell.length>0&&!i.shell&&(o=t.shell),i.shell&&i.shell.length>0&&(o=i.shell),o&&o.forEach(function(s){n.push({voxelMaterial:i,shellMaterialIndex:s.color.material.index,color:s.color,distance:s.distance})},this)},this),n.sort(function(i,o){i.shellMaterialIndex,o.shellMaterialIndex}),n}static _generateShells(t,n){Zi._getAllShells(t).forEach(function(i){let o=n.positions.length;t.voxels.forEach(function(c){c.color.material===i.voxelMaterial&&Zi._generateVoxelShell(t,c,n,i.distance,i.color)},this);let s=n.positions.length;n.groups.push({start:o/3,count:(s-o)/3,materialIndex:i.shellMaterialIndex})})}static _generateVoxelShell(t,n,i,o,s){for(let c=0;c<Ai._FACES.length;c++){let u=n.faces[Ai._FACES[c]];u&&!u.skipped&&Zi._generateVoxelShellFace(t,n,u,i,o,s)}}static _generateVoxelShellFace(t,n,i,o,s,c){let u,h,f,p,m,y,g,_,x,b,E,T,P,D;if(u=i.vertices[0],h=i.vertices[1],f=i.vertices[2],p=i.vertices[3],m=u.averageNormal,y=h.averageNormal,g=f.averageNormal,_=p.averageNormal,o.uvs&&(E=i.uv[0]||{u:1e-4,v:1e-4},T=i.uv[1]||{u:1e-4,v:.9999},P=i.uv[2]||{u:.9999,v:.9999},D=i.uv[3]||{u:.9999,v:1e-4}),c.material.side==="back"){let F;F=u,u=f,f=F,F=m,m=g,g=F,F=x,x=b,b=F,F=E,E=P,P=F}u={x:u.x+m.x*s*t.scale.x,y:u.y+m.y*s*t.scale.y,z:u.z+m.z*s*t.scale.z},h={x:h.x+y.x*s*t.scale.x,y:h.y+y.y*s*t.scale.y,z:h.z+y.z*s*t.scale.z},f={x:f.x+g.x*s*t.scale.x,y:f.y+g.y*s*t.scale.y,z:f.z+g.z*s*t.scale.z},p={x:p.x+_.x*s*t.scale.x,y:p.y+_.y*s*t.scale.y,z:p.z+_.z*s*t.scale.z},o.positions.push(f.x,f.y,f.z),o.positions.push(h.x,h.y,h.z),o.positions.push(u.x,u.y,u.z),o.positions.push(u.x,u.y,u.z),o.positions.push(p.x,p.y,p.z),o.positions.push(f.x,f.y,f.z),o.normals.push(g.x,g.y,g.z),o.normals.push(y.x,y.y,y.z),o.normals.push(m.x,m.y,m.z),o.normals.push(m.x,m.y,m.z),o.normals.push(_.x,_.y,_.z),o.normals.push(g.x,g.y,g.z);for(let F=0;F<6;F++)o.colors.push(c.r,c.g,c.b);o.uvs&&(o.uvs.push(P.u,P.v),o.uvs.push(T.u,T.v),o.uvs.push(E.u,E.v),o.uvs.push(E.u,E.v),o.uvs.push(D.u,D.v),o.uvs.push(P.u,P.v))}static _normalize(t){let n=Math.sqrt(t.x*t.x+t.y*t.y+t.z*t.z);return t.x/=n,t.y/=n,t.z/=n,t}}class Fa{static generate(t){let n=[];t.materials.forEach(function(s){n.push(Fa._generateMaterial(s))},this);let i=new THREE.BufferGeometry;i.setAttribute("position",new THREE.Float32BufferAttribute(t.positions,3)),i.setAttribute("normal",new THREE.Float32BufferAttribute(t.normals,3)),i.setAttribute("color",new THREE.Float32BufferAttribute(t.colors,3)),t.uvs&&i.setAttribute("uv",new THREE.Float32BufferAttribute(t.uvs,2));let o=[];for(let s=0;s<t.positions.length/3;s++)o.push(s);return i.setIndex(o),t.groups.forEach(function(s){i.addGroup(s.start,s.count,s.materialIndex)},this),i.computeBoundingBox(),i.uvsNeedUpdate=!0,new THREE.Mesh(i,n)}static _generateMaterial(t){switch(t.type!=="standard"&&(delete t.roughness,delete t.metalness),delete t.index,t.type==="matcap"&&delete t.wireframe,t.type!=="basic"&&t.type!=="lambert"&&t.type!=="phong"||(t.reflectivity=1-t.roughness),t.side){case"back":t.side=THREE.BackSide;break;case"double":t.side=THREE.DoubleSide;break;default:t.side=THREE.FrontSide}t.map&&(t.map=Fa._generateTexture(t.map.image,THREE.sRGBEncoding,t.map.uscale,t.map.vscale,t.map.uoffset,t.map.voffset,t.map.rotation)),t.normalMap&&(t.normalMap=Fa._generateTexture(t.normalMap.image,THREE.LinearEncoding,t.normalMap.uscale,t.normalMap.vscale,t.normalMap.uoffset,t.normalMap.voffset,t.normalMap.rotation)),t.roughnessMap&&(t.roughnessMap=Fa._generateTexture(t.roughnessMap.image,THREE.LinearEncoding,t.roughnessMap.uscale,t.roughnessMap.vscale,t.roughnessMap.uoffset,t.roughnessMap.voffset,t.roughnessMap.rotation)),t.metalnessMap&&(t.metalnessMap=Fa._generateTexture(t.metalnessMap.image,THREE.LinearEncoding,t.metalnessMap.uscale,t.metalnessMap.vscale,t.metalnessMap.uoffset,t.metalnessMap.voffset,t.metalnessMap.rotation)),t.emissiveMap&&(t.emissiveMap=Fa._generateTexture(t.emissiveMap.image,THREE.sRGBEncoding,t.emissiveMap.uscale,t.emissiveMap.vscale,t.emissiveMap.uoffset,t.emissiveMap.voffset,t.emissiveMap.rotation)),t.matcap&&(t.matcap=Fa._generateTexture(t.matcap.image,THREE.sRGBEncoding));let n=null,i=t.type;switch(delete t.type,i){case"standard":n=new THREE.MeshStandardMaterial(t);break;case"basic":n=new THREE.MeshBasicMaterial(t);break;case"lambert":n=new THREE.MeshLambertMaterial(t);break;case"phong":n=new THREE.MeshPhongMaterial(t);break;case"matcap":n=new THREE.MeshMatcapMaterial(t);break;case"toon":n=new THREE.MeshToonMaterial(t);break;case"normal":n=new THREE.MeshNormalMaterial(t);break;default:throw{name:"SyntaxError",message:`Unknown material type '${i}'.`}}return n}static _generateTexture(t,n,i,o,s,c,u){let h=new THREE.TextureLoader().load(t);return h.encoding=n,h.repeat.set(1/i,1/o),h.wrapS=THREE.RepeatWrapping,h.wrapT=THREE.RepeatWrapping,h.offset=new THREE.Vector2(s,c),h.rotation=u*Math.PI/180,h}}class HN{constructor(t,n,i){this._workerFile=t,this._resultHandler=n,this._resultCallback=i,this._nrOfWorkers=window.navigator.hardwareConcurrency,this._workers=[],this._free=[],this._tasks=[]}executeTask(t){if(this._workers.length<this._nrOfWorkers){let n=new Worker(this._workerFile),i=this;n.onmessage=function(o){i._free.push(event.data.worker),i._processNextTask(),i._resultCallback.apply(i._resultHandler,[event.data])},this._free.push(this._workers.length),this._workers.push(n)}this._tasks.push(t),this._processNextTask()}_processNextTask(){if(this._tasks.length>0&&this._free.length>0){let t=this._tasks.shift();t.worker=this._free.shift(),this._workers[t.worker].postMessage(t)}}}if(typeof window!="undefined"){if(typeof AFRAME=="undefined")throw new Error("Component attempted to register before AFRAME was available.");Ai.WORKERPOOL=null,AFRAME.registerComponent("svox",{schema:{model:{type:"string"},worker:{type:"boolean",default:!1}},multiple:!1,_MISSING:"model size=9,scale=0.05,material lighting=flat,colors=A:#FFFFFF B:#FF8800 C:#FF0000,voxels 10B7-2B-C3-C-2B2-C-C2-2B3-C3-2B2-C-C2-2B-C3-C-2B7-11B7-B-6(7A2-)7A-B7-2B-C3-C-B-7A-C7AC-2(7A2-)7A-C7AC-7A-B-C3-C-2B2-C-C2-B-7A2-2(7A-C7AC-)7A2-7A-B2-C-C2-2B3-C3-B-2(7A2-)7A-C7AC-2(7A2-)7A-B3-C3-2B2-C-C2-B-7A2-2(7A-C7AC-)7A2-7A-B2-C-C2-2B-C3-C-B-7A-C7AC-2(7A2-)7A-C7AC-7A-B-C3-C-2B7-B-6(7A2-)7A-B7-11B7-2B-C3-C-2B2-C-C2-2B3-C3-2B2-C-C2-2B-C3-C-2B7-10B",_ERROR:"model size=9,scale=0.05,material lighting=flat,colors=B:#FF8800 C:#FF0000 A:#FFFFFF,voxels 10B7-2(2B2-3C2-2B4-C2-)2B2-3C2-2B7-11B7-B-6(7A2-)7A-B7-2B2-3C2-B-6(7A2-)7A-B2-3C2-2B2-C4-B-2(7A-C7A2C)7A-C7AC-7A-B2-C4-2B2-3C2-B3(-7A-C7AC)-7A-B2-3C2-2B2-C4-B-7A-C2(7AC-7A2C)7AC-7A-B2-C4-2B2-3C2-B-6(7A2-)7A-B2-3C2-2B7-B-6(7A2-)7A-B7-11B7-2(2B2-3C2-2B2-C4-)2B2-3C2-2B7-10B",_workerPool:null,init:function(){let a=this.el,t=this.data,n=t.worker,i=!1,o=t.model,s=Ai.models[o];s||(this._logError(t.model,{name:"ConfigError",message:"Model not found"}),s=this._MISSING,i=!0,n=!1),n?this._generateModelInWorker(s,a):this._generateModel(s,a,i)},_generateModel:function(a,t,n){let i,o=performance.now();try{i=tS.readFromString(a)}catch(s){this._logError(s),i=tS.readFromString(this._ERROR),n=!0}try{let s=Zi.generate(i);this.mesh=Fa.generate(s);let c=performance.now(),u=`Time: ${Math.round(c-o)}ms. Verts:${this.mesh.geometry.attributes.position.count} Faces:${this.mesh.geometry.attributes.position.count/3} Materials:${this.mesh.material.length}`,h=document.getElementById("svoxstats");h&&!n&&(h.innerHTML="Last render: "+u),t.setObject3D("mesh",this.mesh)}catch(s){this._logError(s)}},_generateModelInWorker:function(a,t){t.id||(t.id=new Date().valueOf().toString(36)+Math.random().toString(36).substr(2));let n={svoxmodel:a,elementId:t.id};Ai.WORKERPOOL||(Ai.WORKERPOOL=new HN("/smoothvoxelworker.1.1.0.js",this,this._processResult)),Ai.WORKERPOOL.executeTask(n)},_processResult:function(a){if(a.svoxmesh.error)this._logError(a.svoxmesh.error);else{let t=Fa.generate(a.svoxmesh);document.querySelector("#"+a.elementId).setObject3D("mesh",t)}},_toSharedArrayBuffer(a){let t=new Float32Array(new ArrayBuffer(4*a.length));return t.set(a,0),t},_logError:function(a){let t=a.name+": "+a.message,n=document.getElementById("svoxerrors");n&&(n.innerHTML=t),console.error(`SVOXERROR (${this.data.model}) ${t}`)},update:function(a){},remove:function(){let a=["map","normalMap","roughnessMap","metalnessMap","emissiveMap","matcap"];if(this.mesh){for(;this.mesh.material.length>0;)a.forEach(function(t){this.mesh.material[0][t]&&this.mesh.material[0][t].dispose},this),this.mesh.material[0].dispose(),this.mesh.material.shift();this.mesh.geometry.dispose(),this.el.removeObject3D("mesh"),delete this.mesh}},pause:function(){},play:function(){},events:{}})}/**
 * @license
 * Copyright 2010-2022 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const cy="141",GN={LEFT:0,MIDDLE:1,RIGHT:2,ROTATE:0,DOLLY:1,PAN:2},VN={ROTATE:0,PAN:1,DOLLY_PAN:2,DOLLY_ROTATE:3},dC=0,rb=1,pC=2,WN=3,jN=0,E_=1,mC=2,$f=3,hh=0,To=1,fh=2,gC=1,XN=2,Ul=0,rh=1,sb=2,ob=3,ab=4,vC=5,Xu=100,yC=101,xC=102,lb=103,cb=104,AC=200,bC=201,_C=202,wC=203,M_=204,S_=205,EC=206,MC=207,SC=208,TC=209,CC=210,RC=0,LC=1,PC=2,Dv=3,IC=4,OC=5,DC=6,BC=7,Dm=0,FC=1,NC=2,za=0,UC=1,kC=2,zC=3,HC=4,GC=5,uy=300,kc=301,zc=302,dm=303,pm=304,Fd=306,mm=1e3,Qs=1001,gm=1002,Qr=1003,Bv=1004,$N=1004,Fv=1005,qN=1005,Vr=1006,T_=1007,YN=1007,_h=1008,QN=1008,Hc=1009,VC=1010,WC=1011,C_=1012,jC=1013,Tc=1014,Bl=1015,od=1016,XC=1017,$C=1018,sh=1020,qC=1021,YC=1022,Mo=1023,QC=1024,KC=1025,Bc=1026,dh=1027,ZC=1028,JC=1029,eR=1030,tR=1031,nR=1033,dv=33776,pv=33777,mv=33778,gv=33779,ub=35840,hb=35841,fb=35842,db=35843,iR=36196,pb=37492,mb=37496,gb=37808,vb=37809,yb=37810,xb=37811,Ab=37812,bb=37813,_b=37814,wb=37815,Eb=37816,Mb=37817,Sb=37818,Tb=37819,Cb=37820,Rb=37821,Lb=36492,rR=2200,sR=2201,oR=2202,vm=2300,ym=2301,vv=2302,Ku=2400,Zu=2401,xm=2402,hy=2500,R_=2501,KN=0,ZN=1,JN=2,Gc=3e3,_r=3001,aR=3200,lR=3201,wh=0,cR=1,eU="",Na="srgb",Cc="srgb-linear",tU=0,yv=7680,nU=7681,iU=7682,rU=7683,sU=34055,oU=34056,aU=5386,lU=512,cU=513,uU=514,hU=515,fU=516,dU=517,pU=518,uR=519,Nv=35044,mU=35048,gU=35040,vU=35045,yU=35049,xU=35041,AU=35046,bU=35050,_U=35042,wU="100",Pb="300 es",Uv=1035;class $c{addEventListener(t,n){this._listeners===void 0&&(this._listeners={});const i=this._listeners;i[t]===void 0&&(i[t]=[]),i[t].indexOf(n)===-1&&i[t].push(n)}hasEventListener(t,n){if(this._listeners===void 0)return!1;const i=this._listeners;return i[t]!==void 0&&i[t].indexOf(n)!==-1}removeEventListener(t,n){if(this._listeners===void 0)return;const o=this._listeners[t];if(o!==void 0){const s=o.indexOf(n);s!==-1&&o.splice(s,1)}}dispatchEvent(t){if(this._listeners===void 0)return;const i=this._listeners[t.type];if(i!==void 0){t.target=this;const o=i.slice(0);for(let s=0,c=o.length;s<c;s++)o[s].call(this,t);t.target=null}}}const xs=[];for(let a=0;a<256;a++)xs[a]=(a<16?"0":"")+a.toString(16);let nS=1234567;const oh=Math.PI/180,Am=180/Math.PI;function Co(){const a=Math.random()*4294967295|0,t=Math.random()*4294967295|0,n=Math.random()*4294967295|0,i=Math.random()*4294967295|0;return(xs[a&255]+xs[a>>8&255]+xs[a>>16&255]+xs[a>>24&255]+"-"+xs[t&255]+xs[t>>8&255]+"-"+xs[t>>16&15|64]+xs[t>>24&255]+"-"+xs[n&63|128]+xs[n>>8&255]+"-"+xs[n>>16&255]+xs[n>>24&255]+xs[i&255]+xs[i>>8&255]+xs[i>>16&255]+xs[i>>24&255]).toLowerCase()}function Wr(a,t,n){return Math.max(t,Math.min(n,a))}function L_(a,t){return(a%t+t)%t}function EU(a,t,n,i,o){return i+(a-t)*(o-i)/(n-t)}function MU(a,t,n){return a!==t?(n-a)/(t-a):0}function nm(a,t,n){return(1-n)*a+n*t}function SU(a,t,n,i){return nm(a,t,1-Math.exp(-n*i))}function TU(a,t=1){return t-Math.abs(L_(a,t*2)-t)}function CU(a,t,n){return a<=t?0:a>=n?1:(a=(a-t)/(n-t),a*a*(3-2*a))}function RU(a,t,n){return a<=t?0:a>=n?1:(a=(a-t)/(n-t),a*a*a*(a*(a*6-15)+10))}function LU(a,t){return a+Math.floor(Math.random()*(t-a+1))}function PU(a,t){return a+Math.random()*(t-a)}function IU(a){return a*(.5-Math.random())}function OU(a){a!==void 0&&(nS=a);let t=nS+=1831565813;return t=Math.imul(t^t>>>15,t|1),t^=t+Math.imul(t^t>>>7,t|61),((t^t>>>14)>>>0)/4294967296}function DU(a){return a*oh}function BU(a){return a*Am}function Ib(a){return(a&a-1)===0&&a!==0}function hR(a){return Math.pow(2,Math.ceil(Math.log(a)/Math.LN2))}function kv(a){return Math.pow(2,Math.floor(Math.log(a)/Math.LN2))}function FU(a,t,n,i,o){const s=Math.cos,c=Math.sin,u=s(n/2),h=c(n/2),f=s((t+i)/2),p=c((t+i)/2),m=s((t-i)/2),y=c((t-i)/2),g=s((i-t)/2),_=c((i-t)/2);switch(o){case"XYX":a.set(u*p,h*m,h*y,u*f);break;case"YZY":a.set(h*y,u*p,h*m,u*f);break;case"ZXZ":a.set(h*m,h*y,u*p,u*f);break;case"XZX":a.set(u*p,h*_,h*g,u*f);break;case"YXY":a.set(h*g,u*p,h*_,u*f);break;case"ZYZ":a.set(h*_,h*g,u*p,u*f);break;default:console.warn("THREE.MathUtils: .setQuaternionFromProperEuler() encountered an unknown order: "+o)}}function NU(a,t){switch(t.constructor){case Float32Array:return a;case Uint16Array:return a/65535;case Uint8Array:return a/255;case Int16Array:return Math.max(a/32767,-1);case Int8Array:return Math.max(a/127,-1);default:throw new Error("Invalid component type.")}}function UU(a,t){switch(t.constructor){case Float32Array:return a;case Uint16Array:return Math.round(a*65535);case Uint8Array:return Math.round(a*255);case Int16Array:return Math.round(a*32767);case Int8Array:return Math.round(a*127);default:throw new Error("Invalid component type.")}}var kU=Object.freeze({__proto__:null,DEG2RAD:oh,RAD2DEG:Am,generateUUID:Co,clamp:Wr,euclideanModulo:L_,mapLinear:EU,inverseLerp:MU,lerp:nm,damp:SU,pingpong:TU,smoothstep:CU,smootherstep:RU,randInt:LU,randFloat:PU,randFloatSpread:IU,seededRandom:OU,degToRad:DU,radToDeg:BU,isPowerOfTwo:Ib,ceilPowerOfTwo:hR,floorPowerOfTwo:kv,setQuaternionFromProperEuler:FU,normalize:UU,denormalize:NU});class yn{constructor(t=0,n=0){this.isVector2=!0,this.x=t,this.y=n}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,n){return this.x=t,this.y=n,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,n){switch(t){case 0:this.x=n;break;case 1:this.y=n;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t,n){return n!==void 0?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,n)):(this.x+=t.x,this.y+=t.y,this)}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,n){return this.x=t.x+n.x,this.y=t.y+n.y,this}addScaledVector(t,n){return this.x+=t.x*n,this.y+=t.y*n,this}sub(t,n){return n!==void 0?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,n)):(this.x-=t.x,this.y-=t.y,this)}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,n){return this.x=t.x-n.x,this.y=t.y-n.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const n=this.x,i=this.y,o=t.elements;return this.x=o[0]*n+o[3]*i+o[6],this.y=o[1]*n+o[4]*i+o[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,n){return this.x=Math.max(t.x,Math.min(n.x,this.x)),this.y=Math.max(t.y,Math.min(n.y,this.y)),this}clampScalar(t,n){return this.x=Math.max(t,Math.min(n,this.x)),this.y=Math.max(t,Math.min(n,this.y)),this}clampLength(t,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const n=this.x-t.x,i=this.y-t.y;return n*n+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,n){return this.x+=(t.x-this.x)*n,this.y+=(t.y-this.y)*n,this}lerpVectors(t,n,i){return this.x=t.x+(n.x-t.x)*i,this.y=t.y+(n.y-t.y)*i,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,n=0){return this.x=t[n],this.y=t[n+1],this}toArray(t=[],n=0){return t[n]=this.x,t[n+1]=this.y,t}fromBufferAttribute(t,n,i){return i!==void 0&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(n),this.y=t.getY(n),this}rotateAround(t,n){const i=Math.cos(n),o=Math.sin(n),s=this.x-t.x,c=this.y-t.y;return this.x=s*i-c*o+t.x,this.y=s*o+c*i+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Ho{constructor(){this.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}set(t,n,i,o,s,c,u,h,f){const p=this.elements;return p[0]=t,p[1]=o,p[2]=u,p[3]=n,p[4]=s,p[5]=h,p[6]=i,p[7]=c,p[8]=f,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const n=this.elements,i=t.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],this}extractBasis(t,n,i){return t.setFromMatrix3Column(this,0),n.setFromMatrix3Column(this,1),i.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const n=t.elements;return this.set(n[0],n[4],n[8],n[1],n[5],n[9],n[2],n[6],n[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,n){const i=t.elements,o=n.elements,s=this.elements,c=i[0],u=i[3],h=i[6],f=i[1],p=i[4],m=i[7],y=i[2],g=i[5],_=i[8],x=o[0],b=o[3],E=o[6],T=o[1],P=o[4],D=o[7],F=o[2],k=o[5],W=o[8];return s[0]=c*x+u*T+h*F,s[3]=c*b+u*P+h*k,s[6]=c*E+u*D+h*W,s[1]=f*x+p*T+m*F,s[4]=f*b+p*P+m*k,s[7]=f*E+p*D+m*W,s[2]=y*x+g*T+_*F,s[5]=y*b+g*P+_*k,s[8]=y*E+g*D+_*W,this}multiplyScalar(t){const n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=t,n[4]*=t,n[7]*=t,n[2]*=t,n[5]*=t,n[8]*=t,this}determinant(){const t=this.elements,n=t[0],i=t[1],o=t[2],s=t[3],c=t[4],u=t[5],h=t[6],f=t[7],p=t[8];return n*c*p-n*u*f-i*s*p+i*u*h+o*s*f-o*c*h}invert(){const t=this.elements,n=t[0],i=t[1],o=t[2],s=t[3],c=t[4],u=t[5],h=t[6],f=t[7],p=t[8],m=p*c-u*f,y=u*h-p*s,g=f*s-c*h,_=n*m+i*y+o*g;if(_===0)return this.set(0,0,0,0,0,0,0,0,0);const x=1/_;return t[0]=m*x,t[1]=(o*f-p*i)*x,t[2]=(u*i-o*c)*x,t[3]=y*x,t[4]=(p*n-o*h)*x,t[5]=(o*s-u*n)*x,t[6]=g*x,t[7]=(i*h-f*n)*x,t[8]=(c*n-i*s)*x,this}transpose(){let t;const n=this.elements;return t=n[1],n[1]=n[3],n[3]=t,t=n[2],n[2]=n[6],n[6]=t,t=n[5],n[5]=n[7],n[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const n=this.elements;return t[0]=n[0],t[1]=n[3],t[2]=n[6],t[3]=n[1],t[4]=n[4],t[5]=n[7],t[6]=n[2],t[7]=n[5],t[8]=n[8],this}setUvTransform(t,n,i,o,s,c,u){const h=Math.cos(s),f=Math.sin(s);return this.set(i*h,i*f,-i*(h*c+f*u)+c+t,-o*f,o*h,-o*(-f*c+h*u)+u+n,0,0,1),this}scale(t,n){const i=this.elements;return i[0]*=t,i[3]*=t,i[6]*=t,i[1]*=n,i[4]*=n,i[7]*=n,this}rotate(t){const n=Math.cos(t),i=Math.sin(t),o=this.elements,s=o[0],c=o[3],u=o[6],h=o[1],f=o[4],p=o[7];return o[0]=n*s+i*h,o[3]=n*c+i*f,o[6]=n*u+i*p,o[1]=-i*s+n*h,o[4]=-i*c+n*f,o[7]=-i*u+n*p,this}translate(t,n){const i=this.elements;return i[0]+=t*i[2],i[3]+=t*i[5],i[6]+=t*i[8],i[1]+=n*i[2],i[4]+=n*i[5],i[7]+=n*i[8],this}equals(t){const n=this.elements,i=t.elements;for(let o=0;o<9;o++)if(n[o]!==i[o])return!1;return!0}fromArray(t,n=0){for(let i=0;i<9;i++)this.elements[i]=t[i+n];return this}toArray(t=[],n=0){const i=this.elements;return t[n]=i[0],t[n+1]=i[1],t[n+2]=i[2],t[n+3]=i[3],t[n+4]=i[4],t[n+5]=i[5],t[n+6]=i[6],t[n+7]=i[7],t[n+8]=i[8],t}clone(){return new this.constructor().fromArray(this.elements)}}function fR(a){for(let t=a.length-1;t>=0;--t)if(a[t]>65535)return!0;return!1}const zU={Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array};function qf(a,t){return new zU[a](t)}function bm(a){return document.createElementNS("http://www.w3.org/1999/xhtml",a)}function ah(a){return a<.04045?a*.0773993808:Math.pow(a*.9478672986+.0521327014,2.4)}function xv(a){return a<.0031308?a*12.92:1.055*Math.pow(a,.41666)-.055}const kx={[Na]:{[Cc]:ah},[Cc]:{[Na]:xv}},Fo={legacyMode:!0,get workingColorSpace(){return Cc},set workingColorSpace(a){console.warn("THREE.ColorManagement: .workingColorSpace is readonly.")},convert:function(a,t,n){if(this.legacyMode||t===n||!t||!n)return a;if(kx[t]&&kx[t][n]!==void 0){const i=kx[t][n];return a.r=i(a.r),a.g=i(a.g),a.b=i(a.b),a}throw new Error("Unsupported color space conversion.")},fromWorkingColorSpace:function(a,t){return this.convert(a,this.workingColorSpace,t)},toWorkingColorSpace:function(a,t){return this.convert(a,t,this.workingColorSpace)}},dR={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},ns={r:0,g:0,b:0},ea={h:0,s:0,l:0},xg={h:0,s:0,l:0};function zx(a,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?a+(t-a)*6*n:n<1/2?t:n<2/3?a+(t-a)*6*(2/3-n):a}function Ag(a,t){return t.r=a.r,t.g=a.g,t.b=a.b,t}class qn{constructor(t,n,i){return this.isColor=!0,this.r=1,this.g=1,this.b=1,n===void 0&&i===void 0?this.set(t):this.setRGB(t,n,i)}set(t){return t&&t.isColor?this.copy(t):typeof t=="number"?this.setHex(t):typeof t=="string"&&this.setStyle(t),this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,n=Na){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,Fo.toWorkingColorSpace(this,n),this}setRGB(t,n,i,o=Cc){return this.r=t,this.g=n,this.b=i,Fo.toWorkingColorSpace(this,o),this}setHSL(t,n,i,o=Cc){if(t=L_(t,1),n=Wr(n,0,1),i=Wr(i,0,1),n===0)this.r=this.g=this.b=i;else{const s=i<=.5?i*(1+n):i+n-i*n,c=2*i-s;this.r=zx(c,s,t+1/3),this.g=zx(c,s,t),this.b=zx(c,s,t-1/3)}return Fo.toWorkingColorSpace(this,o),this}setStyle(t,n=Na){function i(s){s!==void 0&&parseFloat(s)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let o;if(o=/^((?:rgb|hsl)a?)\(([^\)]*)\)/.exec(t)){let s;const c=o[1],u=o[2];switch(c){case"rgb":case"rgba":if(s=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return this.r=Math.min(255,parseInt(s[1],10))/255,this.g=Math.min(255,parseInt(s[2],10))/255,this.b=Math.min(255,parseInt(s[3],10))/255,Fo.toWorkingColorSpace(this,n),i(s[4]),this;if(s=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u))return this.r=Math.min(100,parseInt(s[1],10))/100,this.g=Math.min(100,parseInt(s[2],10))/100,this.b=Math.min(100,parseInt(s[3],10))/100,Fo.toWorkingColorSpace(this,n),i(s[4]),this;break;case"hsl":case"hsla":if(s=/^\s*(\d*\.?\d+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(u)){const h=parseFloat(s[1])/360,f=parseInt(s[2],10)/100,p=parseInt(s[3],10)/100;return i(s[4]),this.setHSL(h,f,p,n)}break}}else if(o=/^\#([A-Fa-f\d]+)$/.exec(t)){const s=o[1],c=s.length;if(c===3)return this.r=parseInt(s.charAt(0)+s.charAt(0),16)/255,this.g=parseInt(s.charAt(1)+s.charAt(1),16)/255,this.b=parseInt(s.charAt(2)+s.charAt(2),16)/255,Fo.toWorkingColorSpace(this,n),this;if(c===6)return this.r=parseInt(s.charAt(0)+s.charAt(1),16)/255,this.g=parseInt(s.charAt(2)+s.charAt(3),16)/255,this.b=parseInt(s.charAt(4)+s.charAt(5),16)/255,Fo.toWorkingColorSpace(this,n),this}return t&&t.length>0?this.setColorName(t,n):this}setColorName(t,n=Na){const i=dR[t.toLowerCase()];return i!==void 0?this.setHex(i,n):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=ah(t.r),this.g=ah(t.g),this.b=ah(t.b),this}copyLinearToSRGB(t){return this.r=xv(t.r),this.g=xv(t.g),this.b=xv(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=Na){return Fo.fromWorkingColorSpace(Ag(this,ns),t),Wr(ns.r*255,0,255)<<16^Wr(ns.g*255,0,255)<<8^Wr(ns.b*255,0,255)<<0}getHexString(t=Na){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,n=Cc){Fo.fromWorkingColorSpace(Ag(this,ns),n);const i=ns.r,o=ns.g,s=ns.b,c=Math.max(i,o,s),u=Math.min(i,o,s);let h,f;const p=(u+c)/2;if(u===c)h=0,f=0;else{const m=c-u;switch(f=p<=.5?m/(c+u):m/(2-c-u),c){case i:h=(o-s)/m+(o<s?6:0);break;case o:h=(s-i)/m+2;break;case s:h=(i-o)/m+4;break}h/=6}return t.h=h,t.s=f,t.l=p,t}getRGB(t,n=Cc){return Fo.fromWorkingColorSpace(Ag(this,ns),n),t.r=ns.r,t.g=ns.g,t.b=ns.b,t}getStyle(t=Na){return Fo.fromWorkingColorSpace(Ag(this,ns),t),t!==Na?`color(${t} ${ns.r} ${ns.g} ${ns.b})`:`rgb(${ns.r*255|0},${ns.g*255|0},${ns.b*255|0})`}offsetHSL(t,n,i){return this.getHSL(ea),ea.h+=t,ea.s+=n,ea.l+=i,this.setHSL(ea.h,ea.s,ea.l),this}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,n){return this.r=t.r+n.r,this.g=t.g+n.g,this.b=t.b+n.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,n){return this.r+=(t.r-this.r)*n,this.g+=(t.g-this.g)*n,this.b+=(t.b-this.b)*n,this}lerpColors(t,n,i){return this.r=t.r+(n.r-t.r)*i,this.g=t.g+(n.g-t.g)*i,this.b=t.b+(n.b-t.b)*i,this}lerpHSL(t,n){this.getHSL(ea),t.getHSL(xg);const i=nm(ea.h,xg.h,n),o=nm(ea.s,xg.s,n),s=nm(ea.l,xg.l,n);return this.setHSL(i,o,s),this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,n=0){return this.r=t[n],this.g=t[n+1],this.b=t[n+2],this}toArray(t=[],n=0){return t[n]=this.r,t[n+1]=this.g,t[n+2]=this.b,t}fromBufferAttribute(t,n){return this.r=t.getX(n),this.g=t.getY(n),this.b=t.getZ(n),t.normalized===!0&&(this.r/=255,this.g/=255,this.b/=255),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}qn.NAMES=dR;let Mf;class P_{static getDataURL(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement=="undefined")return t.src;let n;if(t instanceof HTMLCanvasElement)n=t;else{Mf===void 0&&(Mf=bm("canvas")),Mf.width=t.width,Mf.height=t.height;const i=Mf.getContext("2d");t instanceof ImageData?i.putImageData(t,0,0):i.drawImage(t,0,0,t.width,t.height),n=Mf}return n.width>2048||n.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),n.toDataURL("image/jpeg",.6)):n.toDataURL("image/png")}static sRGBToLinear(t){if(typeof HTMLImageElement!="undefined"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&t instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&t instanceof ImageBitmap){const n=bm("canvas");n.width=t.width,n.height=t.height;const i=n.getContext("2d");i.drawImage(t,0,0,t.width,t.height);const o=i.getImageData(0,0,t.width,t.height),s=o.data;for(let c=0;c<s.length;c++)s[c]=ah(s[c]/255)*255;return i.putImageData(o,0,0),n}else if(t.data){const n=t.data.slice(0);for(let i=0;i<n.length;i++)n instanceof Uint8Array||n instanceof Uint8ClampedArray?n[i]=Math.floor(ah(n[i]/255)*255):n[i]=ah(n[i]);return{data:n,width:t.width,height:t.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}class Ju{constructor(t=null){this.isSource=!0,this.uuid=Co(),this.data=t,this.version=0}set needsUpdate(t){t===!0&&this.version++}toJSON(t){const n=t===void 0||typeof t=="string";if(!n&&t.images[this.uuid]!==void 0)return t.images[this.uuid];const i={uuid:this.uuid,url:""},o=this.data;if(o!==null){let s;if(Array.isArray(o)){s=[];for(let c=0,u=o.length;c<u;c++)o[c].isDataTexture?s.push(Hx(o[c].image)):s.push(Hx(o[c]))}else s=Hx(o);i.url=s}return n||(t.images[this.uuid]=i),i}}function Hx(a){return typeof HTMLImageElement!="undefined"&&a instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&a instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&a instanceof ImageBitmap?P_.getDataURL(a):a.data?{data:Array.prototype.slice.call(a.data),width:a.width,height:a.height,type:a.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let HU=0;class is extends $c{constructor(t=is.DEFAULT_IMAGE,n=is.DEFAULT_MAPPING,i=Qs,o=Qs,s=Vr,c=_h,u=Mo,h=Hc,f=1,p=Gc){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:HU++}),this.uuid=Co(),this.name="",this.source=new Ju(t),this.mipmaps=[],this.mapping=n,this.wrapS=i,this.wrapT=o,this.magFilter=s,this.minFilter=c,this.anisotropy=f,this.format=u,this.internalFormat=null,this.type=h,this.offset=new yn(0,0),this.repeat=new yn(1,1),this.center=new yn(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Ho,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=p,this.userData={},this.version=0,this.onUpdate=null,this.isRenderTargetTexture=!1,this.needsPMREMUpdate=!1}get image(){return this.source.data}set image(t){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const n=t===void 0||typeof t=="string";if(!n&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];const i={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,type:this.type,encoding:this.encoding,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return JSON.stringify(this.userData)!=="{}"&&(i.userData=this.userData),n||(t.textures[this.uuid]=i),i}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==uy)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case mm:t.x=t.x-Math.floor(t.x);break;case Qs:t.x=t.x<0?0:1;break;case gm:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case mm:t.y=t.y-Math.floor(t.y);break;case Qs:t.y=t.y<0?0:1;break;case gm:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}}is.DEFAULT_IMAGE=null;is.DEFAULT_MAPPING=uy;class ur{constructor(t=0,n=0,i=0,o=1){this.isVector4=!0,this.x=t,this.y=n,this.z=i,this.w=o}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,n,i,o){return this.x=t,this.y=n,this.z=i,this.w=o,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,n){switch(t){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;case 3:this.w=n;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this}add(t,n){return n!==void 0?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,n)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,n){return this.x=t.x+n.x,this.y=t.y+n.y,this.z=t.z+n.z,this.w=t.w+n.w,this}addScaledVector(t,n){return this.x+=t.x*n,this.y+=t.y*n,this.z+=t.z*n,this.w+=t.w*n,this}sub(t,n){return n!==void 0?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,n)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,n){return this.x=t.x-n.x,this.y=t.y-n.y,this.z=t.z-n.z,this.w=t.w-n.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const n=this.x,i=this.y,o=this.z,s=this.w,c=t.elements;return this.x=c[0]*n+c[4]*i+c[8]*o+c[12]*s,this.y=c[1]*n+c[5]*i+c[9]*o+c[13]*s,this.z=c[2]*n+c[6]*i+c[10]*o+c[14]*s,this.w=c[3]*n+c[7]*i+c[11]*o+c[15]*s,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const n=Math.sqrt(1-t.w*t.w);return n<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/n,this.y=t.y/n,this.z=t.z/n),this}setAxisAngleFromRotationMatrix(t){let n,i,o,s;const h=t.elements,f=h[0],p=h[4],m=h[8],y=h[1],g=h[5],_=h[9],x=h[2],b=h[6],E=h[10];if(Math.abs(p-y)<.01&&Math.abs(m-x)<.01&&Math.abs(_-b)<.01){if(Math.abs(p+y)<.1&&Math.abs(m+x)<.1&&Math.abs(_+b)<.1&&Math.abs(f+g+E-3)<.1)return this.set(1,0,0,0),this;n=Math.PI;const P=(f+1)/2,D=(g+1)/2,F=(E+1)/2,k=(p+y)/4,W=(m+x)/4,j=(_+b)/4;return P>D&&P>F?P<.01?(i=0,o=.707106781,s=.707106781):(i=Math.sqrt(P),o=k/i,s=W/i):D>F?D<.01?(i=.707106781,o=0,s=.707106781):(o=Math.sqrt(D),i=k/o,s=j/o):F<.01?(i=.707106781,o=.707106781,s=0):(s=Math.sqrt(F),i=W/s,o=j/s),this.set(i,o,s,n),this}let T=Math.sqrt((b-_)*(b-_)+(m-x)*(m-x)+(y-p)*(y-p));return Math.abs(T)<.001&&(T=1),this.x=(b-_)/T,this.y=(m-x)/T,this.z=(y-p)/T,this.w=Math.acos((f+g+E-1)/2),this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,n){return this.x=Math.max(t.x,Math.min(n.x,this.x)),this.y=Math.max(t.y,Math.min(n.y,this.y)),this.z=Math.max(t.z,Math.min(n.z,this.z)),this.w=Math.max(t.w,Math.min(n.w,this.w)),this}clampScalar(t,n){return this.x=Math.max(t,Math.min(n,this.x)),this.y=Math.max(t,Math.min(n,this.y)),this.z=Math.max(t,Math.min(n,this.z)),this.w=Math.max(t,Math.min(n,this.w)),this}clampLength(t,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,n){return this.x+=(t.x-this.x)*n,this.y+=(t.y-this.y)*n,this.z+=(t.z-this.z)*n,this.w+=(t.w-this.w)*n,this}lerpVectors(t,n,i){return this.x=t.x+(n.x-t.x)*i,this.y=t.y+(n.y-t.y)*i,this.z=t.z+(n.z-t.z)*i,this.w=t.w+(n.w-t.w)*i,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,n=0){return this.x=t[n],this.y=t[n+1],this.z=t[n+2],this.w=t[n+3],this}toArray(t=[],n=0){return t[n]=this.x,t[n+1]=this.y,t[n+2]=this.z,t[n+3]=this.w,t}fromBufferAttribute(t,n,i){return i!==void 0&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(n),this.y=t.getY(n),this.z=t.getZ(n),this.w=t.getW(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Ro extends $c{constructor(t,n,i={}){super(),this.isWebGLRenderTarget=!0,this.width=t,this.height=n,this.depth=1,this.scissor=new ur(0,0,t,n),this.scissorTest=!1,this.viewport=new ur(0,0,t,n);const o={width:t,height:n,depth:1};this.texture=new is(o,i.mapping,i.wrapS,i.wrapT,i.magFilter,i.minFilter,i.format,i.type,i.anisotropy,i.encoding),this.texture.isRenderTargetTexture=!0,this.texture.flipY=!1,this.texture.generateMipmaps=i.generateMipmaps!==void 0?i.generateMipmaps:!1,this.texture.internalFormat=i.internalFormat!==void 0?i.internalFormat:null,this.texture.minFilter=i.minFilter!==void 0?i.minFilter:Vr,this.depthBuffer=i.depthBuffer!==void 0?i.depthBuffer:!0,this.stencilBuffer=i.stencilBuffer!==void 0?i.stencilBuffer:!1,this.depthTexture=i.depthTexture!==void 0?i.depthTexture:null,this.samples=i.samples!==void 0?i.samples:0}setSize(t,n,i=1){(this.width!==t||this.height!==n||this.depth!==i)&&(this.width=t,this.height=n,this.depth=i,this.texture.image.width=t,this.texture.image.height=n,this.texture.image.depth=i,this.dispose()),this.viewport.set(0,0,t,n),this.scissor.set(0,0,t,n)}clone(){return new this.constructor().copy(this)}copy(t){this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.texture.isRenderTargetTexture=!0;const n=Object.assign({},t.texture.image);return this.texture.source=new Ju(n),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,t.depthTexture!==null&&(this.depthTexture=t.depthTexture.clone()),this.samples=t.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Bm extends is{constructor(t=null,n=1,i=1,o=1){super(null),this.isDataArrayTexture=!0,this.image={data:t,width:n,height:i,depth:o},this.magFilter=Qr,this.minFilter=Qr,this.wrapR=Qs,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class GU extends Ro{constructor(t,n,i){super(t,n),this.isWebGLArrayRenderTarget=!0,this.depth=i,this.texture=new Bm(null,t,n,i),this.texture.isRenderTargetTexture=!0}}class fy extends is{constructor(t=null,n=1,i=1,o=1){super(null),this.isData3DTexture=!0,this.image={data:t,width:n,height:i,depth:o},this.magFilter=Qr,this.minFilter=Qr,this.wrapR=Qs,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class VU extends Ro{constructor(t,n,i){super(t,n),this.isWebGL3DRenderTarget=!0,this.depth=i,this.texture=new fy(null,t,n,i),this.texture.isRenderTargetTexture=!0}}class WU extends Ro{constructor(t,n,i,o={}){super(t,n,o),this.isWebGLMultipleRenderTargets=!0;const s=this.texture;this.texture=[];for(let c=0;c<i;c++)this.texture[c]=s.clone(),this.texture[c].isRenderTargetTexture=!0}setSize(t,n,i=1){if(this.width!==t||this.height!==n||this.depth!==i){this.width=t,this.height=n,this.depth=i;for(let o=0,s=this.texture.length;o<s;o++)this.texture[o].image.width=t,this.texture[o].image.height=n,this.texture[o].image.depth=i;this.dispose()}return this.viewport.set(0,0,t,n),this.scissor.set(0,0,t,n),this}copy(t){this.dispose(),this.width=t.width,this.height=t.height,this.depth=t.depth,this.viewport.set(0,0,this.width,this.height),this.scissor.set(0,0,this.width,this.height),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,t.depthTexture!==null&&(this.depthTexture=t.depthTexture.clone()),this.texture.length=0;for(let n=0,i=t.texture.length;n<i;n++)this.texture[n]=t.texture[n].clone(),this.texture[n].isRenderTargetTexture=!0;return this}}class ao{constructor(t=0,n=0,i=0,o=1){this.isQuaternion=!0,this._x=t,this._y=n,this._z=i,this._w=o}static slerp(t,n,i,o){return console.warn("THREE.Quaternion: Static .slerp() has been deprecated. Use qm.slerpQuaternions( qa, qb, t ) instead."),i.slerpQuaternions(t,n,o)}static slerpFlat(t,n,i,o,s,c,u){let h=i[o+0],f=i[o+1],p=i[o+2],m=i[o+3];const y=s[c+0],g=s[c+1],_=s[c+2],x=s[c+3];if(u===0){t[n+0]=h,t[n+1]=f,t[n+2]=p,t[n+3]=m;return}if(u===1){t[n+0]=y,t[n+1]=g,t[n+2]=_,t[n+3]=x;return}if(m!==x||h!==y||f!==g||p!==_){let b=1-u;const E=h*y+f*g+p*_+m*x,T=E>=0?1:-1,P=1-E*E;if(P>Number.EPSILON){const F=Math.sqrt(P),k=Math.atan2(F,E*T);b=Math.sin(b*k)/F,u=Math.sin(u*k)/F}const D=u*T;if(h=h*b+y*D,f=f*b+g*D,p=p*b+_*D,m=m*b+x*D,b===1-u){const F=1/Math.sqrt(h*h+f*f+p*p+m*m);h*=F,f*=F,p*=F,m*=F}}t[n]=h,t[n+1]=f,t[n+2]=p,t[n+3]=m}static multiplyQuaternionsFlat(t,n,i,o,s,c){const u=i[o],h=i[o+1],f=i[o+2],p=i[o+3],m=s[c],y=s[c+1],g=s[c+2],_=s[c+3];return t[n]=u*_+p*m+h*g-f*y,t[n+1]=h*_+p*y+f*m-u*g,t[n+2]=f*_+p*g+u*y-h*m,t[n+3]=p*_-u*m-h*y-f*g,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,n,i,o){return this._x=t,this._y=n,this._z=i,this._w=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,n){if(!(t&&t.isEuler))throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");const i=t._x,o=t._y,s=t._z,c=t._order,u=Math.cos,h=Math.sin,f=u(i/2),p=u(o/2),m=u(s/2),y=h(i/2),g=h(o/2),_=h(s/2);switch(c){case"XYZ":this._x=y*p*m+f*g*_,this._y=f*g*m-y*p*_,this._z=f*p*_+y*g*m,this._w=f*p*m-y*g*_;break;case"YXZ":this._x=y*p*m+f*g*_,this._y=f*g*m-y*p*_,this._z=f*p*_-y*g*m,this._w=f*p*m+y*g*_;break;case"ZXY":this._x=y*p*m-f*g*_,this._y=f*g*m+y*p*_,this._z=f*p*_+y*g*m,this._w=f*p*m-y*g*_;break;case"ZYX":this._x=y*p*m-f*g*_,this._y=f*g*m+y*p*_,this._z=f*p*_-y*g*m,this._w=f*p*m+y*g*_;break;case"YZX":this._x=y*p*m+f*g*_,this._y=f*g*m+y*p*_,this._z=f*p*_-y*g*m,this._w=f*p*m-y*g*_;break;case"XZY":this._x=y*p*m-f*g*_,this._y=f*g*m-y*p*_,this._z=f*p*_+y*g*m,this._w=f*p*m+y*g*_;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+c)}return n!==!1&&this._onChangeCallback(),this}setFromAxisAngle(t,n){const i=n/2,o=Math.sin(i);return this._x=t.x*o,this._y=t.y*o,this._z=t.z*o,this._w=Math.cos(i),this._onChangeCallback(),this}setFromRotationMatrix(t){const n=t.elements,i=n[0],o=n[4],s=n[8],c=n[1],u=n[5],h=n[9],f=n[2],p=n[6],m=n[10],y=i+u+m;if(y>0){const g=.5/Math.sqrt(y+1);this._w=.25/g,this._x=(p-h)*g,this._y=(s-f)*g,this._z=(c-o)*g}else if(i>u&&i>m){const g=2*Math.sqrt(1+i-u-m);this._w=(p-h)/g,this._x=.25*g,this._y=(o+c)/g,this._z=(s+f)/g}else if(u>m){const g=2*Math.sqrt(1+u-i-m);this._w=(s-f)/g,this._x=(o+c)/g,this._y=.25*g,this._z=(h+p)/g}else{const g=2*Math.sqrt(1+m-i-u);this._w=(c-o)/g,this._x=(s+f)/g,this._y=(h+p)/g,this._z=.25*g}return this._onChangeCallback(),this}setFromUnitVectors(t,n){let i=t.dot(n)+1;return i<Number.EPSILON?(i=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=i):(this._x=0,this._y=-t.z,this._z=t.y,this._w=i)):(this._x=t.y*n.z-t.z*n.y,this._y=t.z*n.x-t.x*n.z,this._z=t.x*n.y-t.y*n.x,this._w=i),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(Wr(this.dot(t),-1,1)))}rotateTowards(t,n){const i=this.angleTo(t);if(i===0)return this;const o=Math.min(1,n/i);return this.slerp(t,o),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t,n){return n!==void 0?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,n)):this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,n){const i=t._x,o=t._y,s=t._z,c=t._w,u=n._x,h=n._y,f=n._z,p=n._w;return this._x=i*p+c*u+o*f-s*h,this._y=o*p+c*h+s*u-i*f,this._z=s*p+c*f+i*h-o*u,this._w=c*p-i*u-o*h-s*f,this._onChangeCallback(),this}slerp(t,n){if(n===0)return this;if(n===1)return this.copy(t);const i=this._x,o=this._y,s=this._z,c=this._w;let u=c*t._w+i*t._x+o*t._y+s*t._z;if(u<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,u=-u):this.copy(t),u>=1)return this._w=c,this._x=i,this._y=o,this._z=s,this;const h=1-u*u;if(h<=Number.EPSILON){const g=1-n;return this._w=g*c+n*this._w,this._x=g*i+n*this._x,this._y=g*o+n*this._y,this._z=g*s+n*this._z,this.normalize(),this._onChangeCallback(),this}const f=Math.sqrt(h),p=Math.atan2(f,u),m=Math.sin((1-n)*p)/f,y=Math.sin(n*p)/f;return this._w=c*m+this._w*y,this._x=i*m+this._x*y,this._y=o*m+this._y*y,this._z=s*m+this._z*y,this._onChangeCallback(),this}slerpQuaternions(t,n,i){return this.copy(t).slerp(n,i)}random(){const t=Math.random(),n=Math.sqrt(1-t),i=Math.sqrt(t),o=2*Math.PI*Math.random(),s=2*Math.PI*Math.random();return this.set(n*Math.cos(o),i*Math.sin(s),i*Math.cos(s),n*Math.sin(o))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,n=0){return this._x=t[n],this._y=t[n+1],this._z=t[n+2],this._w=t[n+3],this._onChangeCallback(),this}toArray(t=[],n=0){return t[n]=this._x,t[n+1]=this._y,t[n+2]=this._z,t[n+3]=this._w,t}fromBufferAttribute(t,n){return this._x=t.getX(n),this._y=t.getY(n),this._z=t.getZ(n),this._w=t.getW(n),this}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class Ze{constructor(t=0,n=0,i=0){this.isVector3=!0,this.x=t,this.y=n,this.z=i}set(t,n,i){return i===void 0&&(i=this.z),this.x=t,this.y=n,this.z=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,n){switch(t){case 0:this.x=n;break;case 1:this.y=n;break;case 2:this.z=n;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t,n){return n!==void 0?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,n)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,n){return this.x=t.x+n.x,this.y=t.y+n.y,this.z=t.z+n.z,this}addScaledVector(t,n){return this.x+=t.x*n,this.y+=t.y*n,this.z+=t.z*n,this}sub(t,n){return n!==void 0?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,n)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,n){return this.x=t.x-n.x,this.y=t.y-n.y,this.z=t.z-n.z,this}multiply(t,n){return n!==void 0?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,n)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,n){return this.x=t.x*n.x,this.y=t.y*n.y,this.z=t.z*n.z,this}applyEuler(t){return t&&t.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(iS.setFromEuler(t))}applyAxisAngle(t,n){return this.applyQuaternion(iS.setFromAxisAngle(t,n))}applyMatrix3(t){const n=this.x,i=this.y,o=this.z,s=t.elements;return this.x=s[0]*n+s[3]*i+s[6]*o,this.y=s[1]*n+s[4]*i+s[7]*o,this.z=s[2]*n+s[5]*i+s[8]*o,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const n=this.x,i=this.y,o=this.z,s=t.elements,c=1/(s[3]*n+s[7]*i+s[11]*o+s[15]);return this.x=(s[0]*n+s[4]*i+s[8]*o+s[12])*c,this.y=(s[1]*n+s[5]*i+s[9]*o+s[13])*c,this.z=(s[2]*n+s[6]*i+s[10]*o+s[14])*c,this}applyQuaternion(t){const n=this.x,i=this.y,o=this.z,s=t.x,c=t.y,u=t.z,h=t.w,f=h*n+c*o-u*i,p=h*i+u*n-s*o,m=h*o+s*i-c*n,y=-s*n-c*i-u*o;return this.x=f*h+y*-s+p*-u-m*-c,this.y=p*h+y*-c+m*-s-f*-u,this.z=m*h+y*-u+f*-c-p*-s,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const n=this.x,i=this.y,o=this.z,s=t.elements;return this.x=s[0]*n+s[4]*i+s[8]*o,this.y=s[1]*n+s[5]*i+s[9]*o,this.z=s[2]*n+s[6]*i+s[10]*o,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,n){return this.x=Math.max(t.x,Math.min(n.x,this.x)),this.y=Math.max(t.y,Math.min(n.y,this.y)),this.z=Math.max(t.z,Math.min(n.z,this.z)),this}clampScalar(t,n){return this.x=Math.max(t,Math.min(n,this.x)),this.y=Math.max(t,Math.min(n,this.y)),this.z=Math.max(t,Math.min(n,this.z)),this}clampLength(t,n){const i=this.length();return this.divideScalar(i||1).multiplyScalar(Math.max(t,Math.min(n,i)))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,n){return this.x+=(t.x-this.x)*n,this.y+=(t.y-this.y)*n,this.z+=(t.z-this.z)*n,this}lerpVectors(t,n,i){return this.x=t.x+(n.x-t.x)*i,this.y=t.y+(n.y-t.y)*i,this.z=t.z+(n.z-t.z)*i,this}cross(t,n){return n!==void 0?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,n)):this.crossVectors(this,t)}crossVectors(t,n){const i=t.x,o=t.y,s=t.z,c=n.x,u=n.y,h=n.z;return this.x=o*h-s*u,this.y=s*c-i*h,this.z=i*u-o*c,this}projectOnVector(t){const n=t.lengthSq();if(n===0)return this.set(0,0,0);const i=t.dot(this)/n;return this.copy(t).multiplyScalar(i)}projectOnPlane(t){return Gx.copy(this).projectOnVector(t),this.sub(Gx)}reflect(t){return this.sub(Gx.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const n=Math.sqrt(this.lengthSq()*t.lengthSq());if(n===0)return Math.PI/2;const i=this.dot(t)/n;return Math.acos(Wr(i,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const n=this.x-t.x,i=this.y-t.y,o=this.z-t.z;return n*n+i*i+o*o}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,n,i){const o=Math.sin(n)*t;return this.x=o*Math.sin(i),this.y=Math.cos(n)*t,this.z=o*Math.cos(i),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,n,i){return this.x=t*Math.sin(n),this.y=i,this.z=t*Math.cos(n),this}setFromMatrixPosition(t){const n=t.elements;return this.x=n[12],this.y=n[13],this.z=n[14],this}setFromMatrixScale(t){const n=this.setFromMatrixColumn(t,0).length(),i=this.setFromMatrixColumn(t,1).length(),o=this.setFromMatrixColumn(t,2).length();return this.x=n,this.y=i,this.z=o,this}setFromMatrixColumn(t,n){return this.fromArray(t.elements,n*4)}setFromMatrix3Column(t,n){return this.fromArray(t.elements,n*3)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,n=0){return this.x=t[n],this.y=t[n+1],this.z=t[n+2],this}toArray(t=[],n=0){return t[n]=this.x,t[n+1]=this.y,t[n+2]=this.z,t}fromBufferAttribute(t,n,i){return i!==void 0&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(n),this.y=t.getY(n),this.z=t.getZ(n),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=(Math.random()-.5)*2,n=Math.random()*Math.PI*2,i=Math.sqrt(1-t**2);return this.x=i*Math.cos(n),this.y=i*Math.sin(n),this.z=t,this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const Gx=new Ze,iS=new ao;class Eh{constructor(t=new Ze(1/0,1/0,1/0),n=new Ze(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=n}set(t,n){return this.min.copy(t),this.max.copy(n),this}setFromArray(t){let n=1/0,i=1/0,o=1/0,s=-1/0,c=-1/0,u=-1/0;for(let h=0,f=t.length;h<f;h+=3){const p=t[h],m=t[h+1],y=t[h+2];p<n&&(n=p),m<i&&(i=m),y<o&&(o=y),p>s&&(s=p),m>c&&(c=m),y>u&&(u=y)}return this.min.set(n,i,o),this.max.set(s,c,u),this}setFromBufferAttribute(t){let n=1/0,i=1/0,o=1/0,s=-1/0,c=-1/0,u=-1/0;for(let h=0,f=t.count;h<f;h++){const p=t.getX(h),m=t.getY(h),y=t.getZ(h);p<n&&(n=p),m<i&&(i=m),y<o&&(o=y),p>s&&(s=p),m>c&&(c=m),y>u&&(u=y)}return this.min.set(n,i,o),this.max.set(s,c,u),this}setFromPoints(t){this.makeEmpty();for(let n=0,i=t.length;n<i;n++)this.expandByPoint(t[n]);return this}setFromCenterAndSize(t,n){const i=Ou.copy(n).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}setFromObject(t,n=!1){return this.makeEmpty(),this.expandByObject(t,n)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,n=!1){t.updateWorldMatrix(!1,!1);const i=t.geometry;if(i!==void 0)if(n&&i.attributes!=null&&i.attributes.position!==void 0){const s=i.attributes.position;for(let c=0,u=s.count;c<u;c++)Ou.fromBufferAttribute(s,c).applyMatrix4(t.matrixWorld),this.expandByPoint(Ou)}else i.boundingBox===null&&i.computeBoundingBox(),Vx.copy(i.boundingBox),Vx.applyMatrix4(t.matrixWorld),this.union(Vx);const o=t.children;for(let s=0,c=o.length;s<c;s++)this.expandByObject(o[s],n);return this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,n){return n.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)}intersectsSphere(t){return this.clampPoint(t.center,Ou),Ou.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let n,i;return t.normal.x>0?(n=t.normal.x*this.min.x,i=t.normal.x*this.max.x):(n=t.normal.x*this.max.x,i=t.normal.x*this.min.x),t.normal.y>0?(n+=t.normal.y*this.min.y,i+=t.normal.y*this.max.y):(n+=t.normal.y*this.max.y,i+=t.normal.y*this.min.y),t.normal.z>0?(n+=t.normal.z*this.min.z,i+=t.normal.z*this.max.z):(n+=t.normal.z*this.max.z,i+=t.normal.z*this.min.z),n<=-t.constant&&i>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(Ip),bg.subVectors(this.max,Ip),Sf.subVectors(t.a,Ip),Tf.subVectors(t.b,Ip),Cf.subVectors(t.c,Ip),fc.subVectors(Tf,Sf),dc.subVectors(Cf,Tf),Du.subVectors(Sf,Cf);let n=[0,-fc.z,fc.y,0,-dc.z,dc.y,0,-Du.z,Du.y,fc.z,0,-fc.x,dc.z,0,-dc.x,Du.z,0,-Du.x,-fc.y,fc.x,0,-dc.y,dc.x,0,-Du.y,Du.x,0];return!Wx(n,Sf,Tf,Cf,bg)||(n=[1,0,0,0,1,0,0,0,1],!Wx(n,Sf,Tf,Cf,bg))?!1:(_g.crossVectors(fc,dc),n=[_g.x,_g.y,_g.z],Wx(n,Sf,Tf,Cf,bg))}clampPoint(t,n){return n.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return Ou.copy(t).clamp(this.min,this.max).sub(t).length()}getBoundingSphere(t){return this.getCenter(t.center),t.radius=this.getSize(Ou).length()*.5,t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:(Ml[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),Ml[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),Ml[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),Ml[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),Ml[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),Ml[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),Ml[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),Ml[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(Ml),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const Ml=[new Ze,new Ze,new Ze,new Ze,new Ze,new Ze,new Ze,new Ze],Ou=new Ze,Vx=new Eh,Sf=new Ze,Tf=new Ze,Cf=new Ze,fc=new Ze,dc=new Ze,Du=new Ze,Ip=new Ze,bg=new Ze,_g=new Ze,Bu=new Ze;function Wx(a,t,n,i,o){for(let s=0,c=a.length-3;s<=c;s+=3){Bu.fromArray(a,s);const u=o.x*Math.abs(Bu.x)+o.y*Math.abs(Bu.y)+o.z*Math.abs(Bu.z),h=t.dot(Bu),f=n.dot(Bu),p=i.dot(Bu);if(Math.max(-Math.max(h,f,p),Math.min(h,f,p))>u)return!1}return!0}const jU=new Eh,rS=new Ze,wg=new Ze,jx=new Ze;class Mh{constructor(t=new Ze,n=-1){this.center=t,this.radius=n}set(t,n){return this.center.copy(t),this.radius=n,this}setFromPoints(t,n){const i=this.center;n!==void 0?i.copy(n):jU.setFromPoints(t).getCenter(i);let o=0;for(let s=0,c=t.length;s<c;s++)o=Math.max(o,i.distanceToSquared(t[s]));return this.radius=Math.sqrt(o),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const n=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=n*n}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,n){const i=this.center.distanceToSquared(t);return n.copy(t),i>this.radius*this.radius&&(n.sub(this.center).normalize(),n.multiplyScalar(this.radius).add(this.center)),n}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){jx.subVectors(t,this.center);const n=jx.lengthSq();if(n>this.radius*this.radius){const i=Math.sqrt(n),o=(i-this.radius)*.5;this.center.add(jx.multiplyScalar(o/i)),this.radius+=o}return this}union(t){return this.center.equals(t.center)===!0?wg.set(0,0,1).multiplyScalar(t.radius):wg.subVectors(t.center,this.center).normalize().multiplyScalar(t.radius),this.expandByPoint(rS.copy(t.center).add(wg)),this.expandByPoint(rS.copy(t.center).sub(wg)),this}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}}const Sl=new Ze,Xx=new Ze,Eg=new Ze,pc=new Ze,$x=new Ze,Mg=new Ze,qx=new Ze;class Fm{constructor(t=new Ze,n=new Ze(0,0,-1)){this.origin=t,this.direction=n}set(t,n){return this.origin.copy(t),this.direction.copy(n),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,n){return n.copy(this.direction).multiplyScalar(t).add(this.origin)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,Sl)),this}closestPointToPoint(t,n){n.subVectors(t,this.origin);const i=n.dot(this.direction);return i<0?n.copy(this.origin):n.copy(this.direction).multiplyScalar(i).add(this.origin)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const n=Sl.subVectors(t,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(t):(Sl.copy(this.direction).multiplyScalar(n).add(this.origin),Sl.distanceToSquared(t))}distanceSqToSegment(t,n,i,o){Xx.copy(t).add(n).multiplyScalar(.5),Eg.copy(n).sub(t).normalize(),pc.copy(this.origin).sub(Xx);const s=t.distanceTo(n)*.5,c=-this.direction.dot(Eg),u=pc.dot(this.direction),h=-pc.dot(Eg),f=pc.lengthSq(),p=Math.abs(1-c*c);let m,y,g,_;if(p>0)if(m=c*h-u,y=c*u-h,_=s*p,m>=0)if(y>=-_)if(y<=_){const x=1/p;m*=x,y*=x,g=m*(m+c*y+2*u)+y*(c*m+y+2*h)+f}else y=s,m=Math.max(0,-(c*y+u)),g=-m*m+y*(y+2*h)+f;else y=-s,m=Math.max(0,-(c*y+u)),g=-m*m+y*(y+2*h)+f;else y<=-_?(m=Math.max(0,-(-c*s+u)),y=m>0?-s:Math.min(Math.max(-s,-h),s),g=-m*m+y*(y+2*h)+f):y<=_?(m=0,y=Math.min(Math.max(-s,-h),s),g=y*(y+2*h)+f):(m=Math.max(0,-(c*s+u)),y=m>0?s:Math.min(Math.max(-s,-h),s),g=-m*m+y*(y+2*h)+f);else y=c>0?-s:s,m=Math.max(0,-(c*y+u)),g=-m*m+y*(y+2*h)+f;return i&&i.copy(this.direction).multiplyScalar(m).add(this.origin),o&&o.copy(Eg).multiplyScalar(y).add(Xx),g}intersectSphere(t,n){Sl.subVectors(t.center,this.origin);const i=Sl.dot(this.direction),o=Sl.dot(Sl)-i*i,s=t.radius*t.radius;if(o>s)return null;const c=Math.sqrt(s-o),u=i-c,h=i+c;return u<0&&h<0?null:u<0?this.at(h,n):this.at(u,n)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const n=t.normal.dot(this.direction);if(n===0)return t.distanceToPoint(this.origin)===0?0:null;const i=-(this.origin.dot(t.normal)+t.constant)/n;return i>=0?i:null}intersectPlane(t,n){const i=this.distanceToPlane(t);return i===null?null:this.at(i,n)}intersectsPlane(t){const n=t.distanceToPoint(this.origin);return n===0||t.normal.dot(this.direction)*n<0}intersectBox(t,n){let i,o,s,c,u,h;const f=1/this.direction.x,p=1/this.direction.y,m=1/this.direction.z,y=this.origin;return f>=0?(i=(t.min.x-y.x)*f,o=(t.max.x-y.x)*f):(i=(t.max.x-y.x)*f,o=(t.min.x-y.x)*f),p>=0?(s=(t.min.y-y.y)*p,c=(t.max.y-y.y)*p):(s=(t.max.y-y.y)*p,c=(t.min.y-y.y)*p),i>c||s>o||((s>i||i!==i)&&(i=s),(c<o||o!==o)&&(o=c),m>=0?(u=(t.min.z-y.z)*m,h=(t.max.z-y.z)*m):(u=(t.max.z-y.z)*m,h=(t.min.z-y.z)*m),i>h||u>o)||((u>i||i!==i)&&(i=u),(h<o||o!==o)&&(o=h),o<0)?null:this.at(i>=0?i:o,n)}intersectsBox(t){return this.intersectBox(t,Sl)!==null}intersectTriangle(t,n,i,o,s){$x.subVectors(n,t),Mg.subVectors(i,t),qx.crossVectors($x,Mg);let c=this.direction.dot(qx),u;if(c>0){if(o)return null;u=1}else if(c<0)u=-1,c=-c;else return null;pc.subVectors(this.origin,t);const h=u*this.direction.dot(Mg.crossVectors(pc,Mg));if(h<0)return null;const f=u*this.direction.dot($x.cross(pc));if(f<0||h+f>c)return null;const p=-u*pc.dot(qx);return p<0?null:this.at(p/c,s)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class Oi{constructor(){this.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}set(t,n,i,o,s,c,u,h,f,p,m,y,g,_,x,b){const E=this.elements;return E[0]=t,E[4]=n,E[8]=i,E[12]=o,E[1]=s,E[5]=c,E[9]=u,E[13]=h,E[2]=f,E[6]=p,E[10]=m,E[14]=y,E[3]=g,E[7]=_,E[11]=x,E[15]=b,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new Oi().fromArray(this.elements)}copy(t){const n=this.elements,i=t.elements;return n[0]=i[0],n[1]=i[1],n[2]=i[2],n[3]=i[3],n[4]=i[4],n[5]=i[5],n[6]=i[6],n[7]=i[7],n[8]=i[8],n[9]=i[9],n[10]=i[10],n[11]=i[11],n[12]=i[12],n[13]=i[13],n[14]=i[14],n[15]=i[15],this}copyPosition(t){const n=this.elements,i=t.elements;return n[12]=i[12],n[13]=i[13],n[14]=i[14],this}setFromMatrix3(t){const n=t.elements;return this.set(n[0],n[3],n[6],0,n[1],n[4],n[7],0,n[2],n[5],n[8],0,0,0,0,1),this}extractBasis(t,n,i){return t.setFromMatrixColumn(this,0),n.setFromMatrixColumn(this,1),i.setFromMatrixColumn(this,2),this}makeBasis(t,n,i){return this.set(t.x,n.x,i.x,0,t.y,n.y,i.y,0,t.z,n.z,i.z,0,0,0,0,1),this}extractRotation(t){const n=this.elements,i=t.elements,o=1/Rf.setFromMatrixColumn(t,0).length(),s=1/Rf.setFromMatrixColumn(t,1).length(),c=1/Rf.setFromMatrixColumn(t,2).length();return n[0]=i[0]*o,n[1]=i[1]*o,n[2]=i[2]*o,n[3]=0,n[4]=i[4]*s,n[5]=i[5]*s,n[6]=i[6]*s,n[7]=0,n[8]=i[8]*c,n[9]=i[9]*c,n[10]=i[10]*c,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromEuler(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");const n=this.elements,i=t.x,o=t.y,s=t.z,c=Math.cos(i),u=Math.sin(i),h=Math.cos(o),f=Math.sin(o),p=Math.cos(s),m=Math.sin(s);if(t.order==="XYZ"){const y=c*p,g=c*m,_=u*p,x=u*m;n[0]=h*p,n[4]=-h*m,n[8]=f,n[1]=g+_*f,n[5]=y-x*f,n[9]=-u*h,n[2]=x-y*f,n[6]=_+g*f,n[10]=c*h}else if(t.order==="YXZ"){const y=h*p,g=h*m,_=f*p,x=f*m;n[0]=y+x*u,n[4]=_*u-g,n[8]=c*f,n[1]=c*m,n[5]=c*p,n[9]=-u,n[2]=g*u-_,n[6]=x+y*u,n[10]=c*h}else if(t.order==="ZXY"){const y=h*p,g=h*m,_=f*p,x=f*m;n[0]=y-x*u,n[4]=-c*m,n[8]=_+g*u,n[1]=g+_*u,n[5]=c*p,n[9]=x-y*u,n[2]=-c*f,n[6]=u,n[10]=c*h}else if(t.order==="ZYX"){const y=c*p,g=c*m,_=u*p,x=u*m;n[0]=h*p,n[4]=_*f-g,n[8]=y*f+x,n[1]=h*m,n[5]=x*f+y,n[9]=g*f-_,n[2]=-f,n[6]=u*h,n[10]=c*h}else if(t.order==="YZX"){const y=c*h,g=c*f,_=u*h,x=u*f;n[0]=h*p,n[4]=x-y*m,n[8]=_*m+g,n[1]=m,n[5]=c*p,n[9]=-u*p,n[2]=-f*p,n[6]=g*m+_,n[10]=y-x*m}else if(t.order==="XZY"){const y=c*h,g=c*f,_=u*h,x=u*f;n[0]=h*p,n[4]=-m,n[8]=f*p,n[1]=y*m+x,n[5]=c*p,n[9]=g*m-_,n[2]=_*m-g,n[6]=u*p,n[10]=x*m+y}return n[3]=0,n[7]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,this}makeRotationFromQuaternion(t){return this.compose(XU,t,$U)}lookAt(t,n,i){const o=this.elements;return xo.subVectors(t,n),xo.lengthSq()===0&&(xo.z=1),xo.normalize(),mc.crossVectors(i,xo),mc.lengthSq()===0&&(Math.abs(i.z)===1?xo.x+=1e-4:xo.z+=1e-4,xo.normalize(),mc.crossVectors(i,xo)),mc.normalize(),Sg.crossVectors(xo,mc),o[0]=mc.x,o[4]=Sg.x,o[8]=xo.x,o[1]=mc.y,o[5]=Sg.y,o[9]=xo.y,o[2]=mc.z,o[6]=Sg.z,o[10]=xo.z,this}multiply(t,n){return n!==void 0?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,n)):this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,n){const i=t.elements,o=n.elements,s=this.elements,c=i[0],u=i[4],h=i[8],f=i[12],p=i[1],m=i[5],y=i[9],g=i[13],_=i[2],x=i[6],b=i[10],E=i[14],T=i[3],P=i[7],D=i[11],F=i[15],k=o[0],W=o[4],j=o[8],J=o[12],de=o[1],te=o[5],N=o[9],L=o[13],M=o[2],I=o[6],U=o[10],$=o[14],ee=o[3],Q=o[7],G=o[11],K=o[15];return s[0]=c*k+u*de+h*M+f*ee,s[4]=c*W+u*te+h*I+f*Q,s[8]=c*j+u*N+h*U+f*G,s[12]=c*J+u*L+h*$+f*K,s[1]=p*k+m*de+y*M+g*ee,s[5]=p*W+m*te+y*I+g*Q,s[9]=p*j+m*N+y*U+g*G,s[13]=p*J+m*L+y*$+g*K,s[2]=_*k+x*de+b*M+E*ee,s[6]=_*W+x*te+b*I+E*Q,s[10]=_*j+x*N+b*U+E*G,s[14]=_*J+x*L+b*$+E*K,s[3]=T*k+P*de+D*M+F*ee,s[7]=T*W+P*te+D*I+F*Q,s[11]=T*j+P*N+D*U+F*G,s[15]=T*J+P*L+D*$+F*K,this}multiplyScalar(t){const n=this.elements;return n[0]*=t,n[4]*=t,n[8]*=t,n[12]*=t,n[1]*=t,n[5]*=t,n[9]*=t,n[13]*=t,n[2]*=t,n[6]*=t,n[10]*=t,n[14]*=t,n[3]*=t,n[7]*=t,n[11]*=t,n[15]*=t,this}determinant(){const t=this.elements,n=t[0],i=t[4],o=t[8],s=t[12],c=t[1],u=t[5],h=t[9],f=t[13],p=t[2],m=t[6],y=t[10],g=t[14],_=t[3],x=t[7],b=t[11],E=t[15];return _*(+s*h*m-o*f*m-s*u*y+i*f*y+o*u*g-i*h*g)+x*(+n*h*g-n*f*y+s*c*y-o*c*g+o*f*p-s*h*p)+b*(+n*f*m-n*u*g-s*c*m+i*c*g+s*u*p-i*f*p)+E*(-o*u*p-n*h*m+n*u*y+o*c*m-i*c*y+i*h*p)}transpose(){const t=this.elements;let n;return n=t[1],t[1]=t[4],t[4]=n,n=t[2],t[2]=t[8],t[8]=n,n=t[6],t[6]=t[9],t[9]=n,n=t[3],t[3]=t[12],t[12]=n,n=t[7],t[7]=t[13],t[13]=n,n=t[11],t[11]=t[14],t[14]=n,this}setPosition(t,n,i){const o=this.elements;return t.isVector3?(o[12]=t.x,o[13]=t.y,o[14]=t.z):(o[12]=t,o[13]=n,o[14]=i),this}invert(){const t=this.elements,n=t[0],i=t[1],o=t[2],s=t[3],c=t[4],u=t[5],h=t[6],f=t[7],p=t[8],m=t[9],y=t[10],g=t[11],_=t[12],x=t[13],b=t[14],E=t[15],T=m*b*f-x*y*f+x*h*g-u*b*g-m*h*E+u*y*E,P=_*y*f-p*b*f-_*h*g+c*b*g+p*h*E-c*y*E,D=p*x*f-_*m*f+_*u*g-c*x*g-p*u*E+c*m*E,F=_*m*h-p*x*h-_*u*y+c*x*y+p*u*b-c*m*b,k=n*T+i*P+o*D+s*F;if(k===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const W=1/k;return t[0]=T*W,t[1]=(x*y*s-m*b*s-x*o*g+i*b*g+m*o*E-i*y*E)*W,t[2]=(u*b*s-x*h*s+x*o*f-i*b*f-u*o*E+i*h*E)*W,t[3]=(m*h*s-u*y*s-m*o*f+i*y*f+u*o*g-i*h*g)*W,t[4]=P*W,t[5]=(p*b*s-_*y*s+_*o*g-n*b*g-p*o*E+n*y*E)*W,t[6]=(_*h*s-c*b*s-_*o*f+n*b*f+c*o*E-n*h*E)*W,t[7]=(c*y*s-p*h*s+p*o*f-n*y*f-c*o*g+n*h*g)*W,t[8]=D*W,t[9]=(_*m*s-p*x*s-_*i*g+n*x*g+p*i*E-n*m*E)*W,t[10]=(c*x*s-_*u*s+_*i*f-n*x*f-c*i*E+n*u*E)*W,t[11]=(p*u*s-c*m*s-p*i*f+n*m*f+c*i*g-n*u*g)*W,t[12]=F*W,t[13]=(p*x*o-_*m*o+_*i*y-n*x*y-p*i*b+n*m*b)*W,t[14]=(_*u*o-c*x*o-_*i*h+n*x*h+c*i*b-n*u*b)*W,t[15]=(c*m*o-p*u*o+p*i*h-n*m*h-c*i*y+n*u*y)*W,this}scale(t){const n=this.elements,i=t.x,o=t.y,s=t.z;return n[0]*=i,n[4]*=o,n[8]*=s,n[1]*=i,n[5]*=o,n[9]*=s,n[2]*=i,n[6]*=o,n[10]*=s,n[3]*=i,n[7]*=o,n[11]*=s,this}getMaxScaleOnAxis(){const t=this.elements,n=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],o=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(n,i,o))}makeTranslation(t,n,i){return this.set(1,0,0,t,0,1,0,n,0,0,1,i,0,0,0,1),this}makeRotationX(t){const n=Math.cos(t),i=Math.sin(t);return this.set(1,0,0,0,0,n,-i,0,0,i,n,0,0,0,0,1),this}makeRotationY(t){const n=Math.cos(t),i=Math.sin(t);return this.set(n,0,i,0,0,1,0,0,-i,0,n,0,0,0,0,1),this}makeRotationZ(t){const n=Math.cos(t),i=Math.sin(t);return this.set(n,-i,0,0,i,n,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,n){const i=Math.cos(n),o=Math.sin(n),s=1-i,c=t.x,u=t.y,h=t.z,f=s*c,p=s*u;return this.set(f*c+i,f*u-o*h,f*h+o*u,0,f*u+o*h,p*u+i,p*h-o*c,0,f*h-o*u,p*h+o*c,s*h*h+i,0,0,0,0,1),this}makeScale(t,n,i){return this.set(t,0,0,0,0,n,0,0,0,0,i,0,0,0,0,1),this}makeShear(t,n,i,o,s,c){return this.set(1,i,s,0,t,1,c,0,n,o,1,0,0,0,0,1),this}compose(t,n,i){const o=this.elements,s=n._x,c=n._y,u=n._z,h=n._w,f=s+s,p=c+c,m=u+u,y=s*f,g=s*p,_=s*m,x=c*p,b=c*m,E=u*m,T=h*f,P=h*p,D=h*m,F=i.x,k=i.y,W=i.z;return o[0]=(1-(x+E))*F,o[1]=(g+D)*F,o[2]=(_-P)*F,o[3]=0,o[4]=(g-D)*k,o[5]=(1-(y+E))*k,o[6]=(b+T)*k,o[7]=0,o[8]=(_+P)*W,o[9]=(b-T)*W,o[10]=(1-(y+x))*W,o[11]=0,o[12]=t.x,o[13]=t.y,o[14]=t.z,o[15]=1,this}decompose(t,n,i){const o=this.elements;let s=Rf.set(o[0],o[1],o[2]).length();const c=Rf.set(o[4],o[5],o[6]).length(),u=Rf.set(o[8],o[9],o[10]).length();this.determinant()<0&&(s=-s),t.x=o[12],t.y=o[13],t.z=o[14],ta.copy(this);const f=1/s,p=1/c,m=1/u;return ta.elements[0]*=f,ta.elements[1]*=f,ta.elements[2]*=f,ta.elements[4]*=p,ta.elements[5]*=p,ta.elements[6]*=p,ta.elements[8]*=m,ta.elements[9]*=m,ta.elements[10]*=m,n.setFromRotationMatrix(ta),i.x=s,i.y=c,i.z=u,this}makePerspective(t,n,i,o,s,c){c===void 0&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");const u=this.elements,h=2*s/(n-t),f=2*s/(i-o),p=(n+t)/(n-t),m=(i+o)/(i-o),y=-(c+s)/(c-s),g=-2*c*s/(c-s);return u[0]=h,u[4]=0,u[8]=p,u[12]=0,u[1]=0,u[5]=f,u[9]=m,u[13]=0,u[2]=0,u[6]=0,u[10]=y,u[14]=g,u[3]=0,u[7]=0,u[11]=-1,u[15]=0,this}makeOrthographic(t,n,i,o,s,c){const u=this.elements,h=1/(n-t),f=1/(i-o),p=1/(c-s),m=(n+t)*h,y=(i+o)*f,g=(c+s)*p;return u[0]=2*h,u[4]=0,u[8]=0,u[12]=-m,u[1]=0,u[5]=2*f,u[9]=0,u[13]=-y,u[2]=0,u[6]=0,u[10]=-2*p,u[14]=-g,u[3]=0,u[7]=0,u[11]=0,u[15]=1,this}equals(t){const n=this.elements,i=t.elements;for(let o=0;o<16;o++)if(n[o]!==i[o])return!1;return!0}fromArray(t,n=0){for(let i=0;i<16;i++)this.elements[i]=t[i+n];return this}toArray(t=[],n=0){const i=this.elements;return t[n]=i[0],t[n+1]=i[1],t[n+2]=i[2],t[n+3]=i[3],t[n+4]=i[4],t[n+5]=i[5],t[n+6]=i[6],t[n+7]=i[7],t[n+8]=i[8],t[n+9]=i[9],t[n+10]=i[10],t[n+11]=i[11],t[n+12]=i[12],t[n+13]=i[13],t[n+14]=i[14],t[n+15]=i[15],t}}const Rf=new Ze,ta=new Oi,XU=new Ze(0,0,0),$U=new Ze(1,1,1),mc=new Ze,Sg=new Ze,xo=new Ze,sS=new Oi,oS=new ao;class Nd{constructor(t=0,n=0,i=0,o=Nd.DefaultOrder){this.isEuler=!0,this._x=t,this._y=n,this._z=i,this._order=o}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,n,i,o=this._order){return this._x=t,this._y=n,this._z=i,this._order=o,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,n=this._order,i=!0){const o=t.elements,s=o[0],c=o[4],u=o[8],h=o[1],f=o[5],p=o[9],m=o[2],y=o[6],g=o[10];switch(n){case"XYZ":this._y=Math.asin(Wr(u,-1,1)),Math.abs(u)<.9999999?(this._x=Math.atan2(-p,g),this._z=Math.atan2(-c,s)):(this._x=Math.atan2(y,f),this._z=0);break;case"YXZ":this._x=Math.asin(-Wr(p,-1,1)),Math.abs(p)<.9999999?(this._y=Math.atan2(u,g),this._z=Math.atan2(h,f)):(this._y=Math.atan2(-m,s),this._z=0);break;case"ZXY":this._x=Math.asin(Wr(y,-1,1)),Math.abs(y)<.9999999?(this._y=Math.atan2(-m,g),this._z=Math.atan2(-c,f)):(this._y=0,this._z=Math.atan2(h,s));break;case"ZYX":this._y=Math.asin(-Wr(m,-1,1)),Math.abs(m)<.9999999?(this._x=Math.atan2(y,g),this._z=Math.atan2(h,s)):(this._x=0,this._z=Math.atan2(-c,f));break;case"YZX":this._z=Math.asin(Wr(h,-1,1)),Math.abs(h)<.9999999?(this._x=Math.atan2(-p,f),this._y=Math.atan2(-m,s)):(this._x=0,this._y=Math.atan2(u,g));break;case"XZY":this._z=Math.asin(-Wr(c,-1,1)),Math.abs(c)<.9999999?(this._x=Math.atan2(y,f),this._y=Math.atan2(u,s)):(this._x=Math.atan2(-p,g),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+n)}return this._order=n,i===!0&&this._onChangeCallback(),this}setFromQuaternion(t,n,i){return sS.makeRotationFromQuaternion(t),this.setFromRotationMatrix(sS,n,i)}setFromVector3(t,n=this._order){return this.set(t.x,t.y,t.z,n)}reorder(t){return oS.setFromEuler(this),this.setFromQuaternion(oS,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],n=0){return t[n]=this._x,t[n+1]=this._y,t[n+2]=this._z,t[n+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}toVector3(){console.error("THREE.Euler: .toVector3() has been removed. Use Vector3.setFromEuler() instead")}}Nd.DefaultOrder="XYZ";Nd.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"];class dy{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!==0}isEnabled(t){return(this.mask&(1<<t|0))!==0}}let qU=0;const aS=new Ze,Lf=new ao,Tl=new Oi,Tg=new Ze,Op=new Ze,YU=new Ze,QU=new ao,lS=new Ze(1,0,0),cS=new Ze(0,1,0),uS=new Ze(0,0,1),KU={type:"added"},hS={type:"removed"};class or extends $c{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:qU++}),this.uuid=Co(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=or.DefaultUp.clone();const t=new Ze,n=new Nd,i=new ao,o=new Ze(1,1,1);function s(){i.setFromEuler(n,!1)}function c(){n.setFromQuaternion(i,void 0,!1)}n._onChange(s),i._onChange(c),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:n},quaternion:{configurable:!0,enumerable:!0,value:i},scale:{configurable:!0,enumerable:!0,value:o},modelViewMatrix:{value:new Oi},normalMatrix:{value:new Ho}}),this.matrix=new Oi,this.matrixWorld=new Oi,this.matrixAutoUpdate=or.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new dy,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,n){this.quaternion.setFromAxisAngle(t,n)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,n){return Lf.setFromAxisAngle(t,n),this.quaternion.multiply(Lf),this}rotateOnWorldAxis(t,n){return Lf.setFromAxisAngle(t,n),this.quaternion.premultiply(Lf),this}rotateX(t){return this.rotateOnAxis(lS,t)}rotateY(t){return this.rotateOnAxis(cS,t)}rotateZ(t){return this.rotateOnAxis(uS,t)}translateOnAxis(t,n){return aS.copy(t).applyQuaternion(this.quaternion),this.position.add(aS.multiplyScalar(n)),this}translateX(t){return this.translateOnAxis(lS,t)}translateY(t){return this.translateOnAxis(cS,t)}translateZ(t){return this.translateOnAxis(uS,t)}localToWorld(t){return t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return t.applyMatrix4(Tl.copy(this.matrixWorld).invert())}lookAt(t,n,i){t.isVector3?Tg.copy(t):Tg.set(t,n,i);const o=this.parent;this.updateWorldMatrix(!0,!1),Op.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?Tl.lookAt(Op,Tg,this.up):Tl.lookAt(Tg,Op,this.up),this.quaternion.setFromRotationMatrix(Tl),o&&(Tl.extractRotation(o.matrixWorld),Lf.setFromRotationMatrix(Tl),this.quaternion.premultiply(Lf.invert()))}add(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.add(arguments[n]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.parent!==null&&t.parent.remove(t),t.parent=this,this.children.push(t),t.dispatchEvent(KU)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let i=0;i<arguments.length;i++)this.remove(arguments[i]);return this}const n=this.children.indexOf(t);return n!==-1&&(t.parent=null,this.children.splice(n,1),t.dispatchEvent(hS)),this}removeFromParent(){const t=this.parent;return t!==null&&t.remove(this),this}clear(){for(let t=0;t<this.children.length;t++){const n=this.children[t];n.parent=null,n.dispatchEvent(hS)}return this.children.length=0,this}attach(t){return this.updateWorldMatrix(!0,!1),Tl.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),Tl.multiply(t.parent.matrixWorld)),t.applyMatrix4(Tl),this.add(t),t.updateWorldMatrix(!1,!0),this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,n){if(this[t]===n)return this;for(let i=0,o=this.children.length;i<o;i++){const c=this.children[i].getObjectByProperty(t,n);if(c!==void 0)return c}}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Op,t,YU),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Op,QU,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return t.set(n[8],n[9],n[10]).normalize()}raycast(){}traverse(t){t(this);const n=this.children;for(let i=0,o=n.length;i<o;i++)n[i].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);const n=this.children;for(let i=0,o=n.length;i<o;i++)n[i].traverseVisible(t)}traverseAncestors(t){const n=this.parent;n!==null&&(t(n),n.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);const n=this.children;for(let i=0,o=n.length;i<o;i++)n[i].updateMatrixWorld(t)}updateWorldMatrix(t,n){const i=this.parent;if(t===!0&&i!==null&&i.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),n===!0){const o=this.children;for(let s=0,c=o.length;s<c;s++)o[s].updateWorldMatrix(!1,!0)}}toJSON(t){const n=t===void 0||typeof t=="string",i={};n&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});const o={};o.uuid=this.uuid,o.type=this.type,this.name!==""&&(o.name=this.name),this.castShadow===!0&&(o.castShadow=!0),this.receiveShadow===!0&&(o.receiveShadow=!0),this.visible===!1&&(o.visible=!1),this.frustumCulled===!1&&(o.frustumCulled=!1),this.renderOrder!==0&&(o.renderOrder=this.renderOrder),JSON.stringify(this.userData)!=="{}"&&(o.userData=this.userData),o.layers=this.layers.mask,o.matrix=this.matrix.toArray(),this.matrixAutoUpdate===!1&&(o.matrixAutoUpdate=!1),this.isInstancedMesh&&(o.type="InstancedMesh",o.count=this.count,o.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(o.instanceColor=this.instanceColor.toJSON()));function s(u,h){return u[h.uuid]===void 0&&(u[h.uuid]=h.toJSON(t)),h.uuid}if(this.isScene)this.background&&(this.background.isColor?o.background=this.background.toJSON():this.background.isTexture&&(o.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&(o.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){o.geometry=s(t.geometries,this.geometry);const u=this.geometry.parameters;if(u!==void 0&&u.shapes!==void 0){const h=u.shapes;if(Array.isArray(h))for(let f=0,p=h.length;f<p;f++){const m=h[f];s(t.shapes,m)}else s(t.shapes,h)}}if(this.isSkinnedMesh&&(o.bindMode=this.bindMode,o.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(s(t.skeletons,this.skeleton),o.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const u=[];for(let h=0,f=this.material.length;h<f;h++)u.push(s(t.materials,this.material[h]));o.material=u}else o.material=s(t.materials,this.material);if(this.children.length>0){o.children=[];for(let u=0;u<this.children.length;u++)o.children.push(this.children[u].toJSON(t).object)}if(this.animations.length>0){o.animations=[];for(let u=0;u<this.animations.length;u++){const h=this.animations[u];o.animations.push(s(t.animations,h))}}if(n){const u=c(t.geometries),h=c(t.materials),f=c(t.textures),p=c(t.images),m=c(t.shapes),y=c(t.skeletons),g=c(t.animations),_=c(t.nodes);u.length>0&&(i.geometries=u),h.length>0&&(i.materials=h),f.length>0&&(i.textures=f),p.length>0&&(i.images=p),m.length>0&&(i.shapes=m),y.length>0&&(i.skeletons=y),g.length>0&&(i.animations=g),_.length>0&&(i.nodes=_)}return i.object=o,i;function c(u){const h=[];for(const f in u){const p=u[f];delete p.metadata,h.push(p)}return h}}clone(t){return new this.constructor().copy(this,t)}copy(t,n=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),n===!0)for(let i=0;i<t.children.length;i++){const o=t.children[i];this.add(o.clone())}return this}}or.DefaultUp=new Ze(0,1,0);or.DefaultMatrixAutoUpdate=!0;const na=new Ze,Cl=new Ze,Yx=new Ze,Rl=new Ze,Pf=new Ze,If=new Ze,fS=new Ze,Qx=new Ze,Kx=new Ze,Zx=new Ze;class zo{constructor(t=new Ze,n=new Ze,i=new Ze){this.a=t,this.b=n,this.c=i}static getNormal(t,n,i,o){o.subVectors(i,n),na.subVectors(t,n),o.cross(na);const s=o.lengthSq();return s>0?o.multiplyScalar(1/Math.sqrt(s)):o.set(0,0,0)}static getBarycoord(t,n,i,o,s){na.subVectors(o,n),Cl.subVectors(i,n),Yx.subVectors(t,n);const c=na.dot(na),u=na.dot(Cl),h=na.dot(Yx),f=Cl.dot(Cl),p=Cl.dot(Yx),m=c*f-u*u;if(m===0)return s.set(-2,-1,-1);const y=1/m,g=(f*h-u*p)*y,_=(c*p-u*h)*y;return s.set(1-g-_,_,g)}static containsPoint(t,n,i,o){return this.getBarycoord(t,n,i,o,Rl),Rl.x>=0&&Rl.y>=0&&Rl.x+Rl.y<=1}static getUV(t,n,i,o,s,c,u,h){return this.getBarycoord(t,n,i,o,Rl),h.set(0,0),h.addScaledVector(s,Rl.x),h.addScaledVector(c,Rl.y),h.addScaledVector(u,Rl.z),h}static isFrontFacing(t,n,i,o){return na.subVectors(i,n),Cl.subVectors(t,n),na.cross(Cl).dot(o)<0}set(t,n,i){return this.a.copy(t),this.b.copy(n),this.c.copy(i),this}setFromPointsAndIndices(t,n,i,o){return this.a.copy(t[n]),this.b.copy(t[i]),this.c.copy(t[o]),this}setFromAttributeAndIndices(t,n,i,o){return this.a.fromBufferAttribute(t,n),this.b.fromBufferAttribute(t,i),this.c.fromBufferAttribute(t,o),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return na.subVectors(this.c,this.b),Cl.subVectors(this.a,this.b),na.cross(Cl).length()*.5}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return zo.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,n){return zo.getBarycoord(t,this.a,this.b,this.c,n)}getUV(t,n,i,o,s){return zo.getUV(t,this.a,this.b,this.c,n,i,o,s)}containsPoint(t){return zo.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return zo.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,n){const i=this.a,o=this.b,s=this.c;let c,u;Pf.subVectors(o,i),If.subVectors(s,i),Qx.subVectors(t,i);const h=Pf.dot(Qx),f=If.dot(Qx);if(h<=0&&f<=0)return n.copy(i);Kx.subVectors(t,o);const p=Pf.dot(Kx),m=If.dot(Kx);if(p>=0&&m<=p)return n.copy(o);const y=h*m-p*f;if(y<=0&&h>=0&&p<=0)return c=h/(h-p),n.copy(i).addScaledVector(Pf,c);Zx.subVectors(t,s);const g=Pf.dot(Zx),_=If.dot(Zx);if(_>=0&&g<=_)return n.copy(s);const x=g*f-h*_;if(x<=0&&f>=0&&_<=0)return u=f/(f-_),n.copy(i).addScaledVector(If,u);const b=p*_-g*m;if(b<=0&&m-p>=0&&g-_>=0)return fS.subVectors(s,o),u=(m-p)/(m-p+(g-_)),n.copy(o).addScaledVector(fS,u);const E=1/(b+x+y);return c=x*E,u=y*E,n.copy(i).addScaledVector(Pf,c).addScaledVector(If,u)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}let ZU=0;class rs extends $c{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:ZU++}),this.uuid=Co(),this.name="",this.type="Material",this.blending=rh,this.side=hh,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.blendSrc=M_,this.blendDst=S_,this.blendEquation=Xu,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=Dv,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=uR,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=yv,this.stencilZFail=yv,this.stencilZPass=yv,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBuild(){}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t!==void 0)for(const n in t){const i=t[n];if(i===void 0){console.warn("THREE.Material: '"+n+"' parameter is undefined.");continue}if(n==="shading"){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=i===gC;continue}const o=this[n];if(o===void 0){console.warn("THREE."+this.type+": '"+n+"' is not a property of this material.");continue}o&&o.isColor?o.set(i):o&&o.isVector3&&i&&i.isVector3?o.copy(i):this[n]=i}}toJSON(t){const n=t===void 0||typeof t=="string";n&&(t={textures:{},images:{}});const i={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.color&&this.color.isColor&&(i.color=this.color.getHex()),this.roughness!==void 0&&(i.roughness=this.roughness),this.metalness!==void 0&&(i.metalness=this.metalness),this.sheen!==void 0&&(i.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(i.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(i.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(i.emissive=this.emissive.getHex()),this.emissiveIntensity&&this.emissiveIntensity!==1&&(i.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(i.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(i.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(i.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(i.shininess=this.shininess),this.clearcoat!==void 0&&(i.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(i.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(i.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(i.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(i.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,i.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.iridescence!==void 0&&(i.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(i.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(i.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(i.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(i.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(i.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(i.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(i.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(i.lightMap=this.lightMap.toJSON(t).uuid,i.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(i.aoMap=this.aoMap.toJSON(t).uuid,i.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(i.bumpMap=this.bumpMap.toJSON(t).uuid,i.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(i.normalMap=this.normalMap.toJSON(t).uuid,i.normalMapType=this.normalMapType,i.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(i.displacementMap=this.displacementMap.toJSON(t).uuid,i.displacementScale=this.displacementScale,i.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(i.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(i.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(i.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(i.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(i.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(i.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(i.envMap=this.envMap.toJSON(t).uuid,this.combine!==void 0&&(i.combine=this.combine)),this.envMapIntensity!==void 0&&(i.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(i.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(i.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(i.gradientMap=this.gradientMap.toJSON(t).uuid),this.transmission!==void 0&&(i.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(i.transmissionMap=this.transmissionMap.toJSON(t).uuid),this.thickness!==void 0&&(i.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(i.thicknessMap=this.thicknessMap.toJSON(t).uuid),this.attenuationDistance!==void 0&&(i.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(i.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(i.size=this.size),this.shadowSide!==null&&(i.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(i.sizeAttenuation=this.sizeAttenuation),this.blending!==rh&&(i.blending=this.blending),this.side!==hh&&(i.side=this.side),this.vertexColors&&(i.vertexColors=!0),this.opacity<1&&(i.opacity=this.opacity),this.transparent===!0&&(i.transparent=this.transparent),i.depthFunc=this.depthFunc,i.depthTest=this.depthTest,i.depthWrite=this.depthWrite,i.colorWrite=this.colorWrite,i.stencilWrite=this.stencilWrite,i.stencilWriteMask=this.stencilWriteMask,i.stencilFunc=this.stencilFunc,i.stencilRef=this.stencilRef,i.stencilFuncMask=this.stencilFuncMask,i.stencilFail=this.stencilFail,i.stencilZFail=this.stencilZFail,i.stencilZPass=this.stencilZPass,this.rotation!==void 0&&this.rotation!==0&&(i.rotation=this.rotation),this.polygonOffset===!0&&(i.polygonOffset=!0),this.polygonOffsetFactor!==0&&(i.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(i.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(i.linewidth=this.linewidth),this.dashSize!==void 0&&(i.dashSize=this.dashSize),this.gapSize!==void 0&&(i.gapSize=this.gapSize),this.scale!==void 0&&(i.scale=this.scale),this.dithering===!0&&(i.dithering=!0),this.alphaTest>0&&(i.alphaTest=this.alphaTest),this.alphaToCoverage===!0&&(i.alphaToCoverage=this.alphaToCoverage),this.premultipliedAlpha===!0&&(i.premultipliedAlpha=this.premultipliedAlpha),this.wireframe===!0&&(i.wireframe=this.wireframe),this.wireframeLinewidth>1&&(i.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(i.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(i.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(i.flatShading=this.flatShading),this.visible===!1&&(i.visible=!1),this.toneMapped===!1&&(i.toneMapped=!1),this.fog===!1&&(i.fog=!1),JSON.stringify(this.userData)!=="{}"&&(i.userData=this.userData);function o(s){const c=[];for(const u in s){const h=s[u];delete h.metadata,c.push(h)}return c}if(n){const s=o(t.textures),c=o(t.images);s.length>0&&(i.textures=s),c.length>0&&(i.images=c)}return i}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const n=t.clippingPlanes;let i=null;if(n!==null){const o=n.length;i=new Array(o);for(let s=0;s!==o;++s)i[s]=n[s].clone()}return this.clippingPlanes=i,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){t===!0&&this.version++}get vertexTangents(){return console.warn("THREE."+this.type+": .vertexTangents has been removed."),!1}set vertexTangents(t){console.warn("THREE."+this.type+": .vertexTangents has been removed.")}}rs.fromType=function(){return null};class qc extends rs{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new qn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Dm,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}const Yr=new Ze,Cg=new yn;class mr{constructor(t,n,i){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=n,this.count=t!==void 0?t.length/n:0,this.normalized=i===!0,this.usage=Nv,this.updateRange={offset:0,count:-1},this.version=0}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this}copyAt(t,n,i){t*=this.itemSize,i*=n.itemSize;for(let o=0,s=this.itemSize;o<s;o++)this.array[t+o]=n.array[i+o];return this}copyArray(t){return this.array.set(t),this}copyColorsArray(t){const n=this.array;let i=0;for(let o=0,s=t.length;o<s;o++){let c=t[o];c===void 0&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",o),c=new qn),n[i++]=c.r,n[i++]=c.g,n[i++]=c.b}return this}copyVector2sArray(t){const n=this.array;let i=0;for(let o=0,s=t.length;o<s;o++){let c=t[o];c===void 0&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",o),c=new yn),n[i++]=c.x,n[i++]=c.y}return this}copyVector3sArray(t){const n=this.array;let i=0;for(let o=0,s=t.length;o<s;o++){let c=t[o];c===void 0&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",o),c=new Ze),n[i++]=c.x,n[i++]=c.y,n[i++]=c.z}return this}copyVector4sArray(t){const n=this.array;let i=0;for(let o=0,s=t.length;o<s;o++){let c=t[o];c===void 0&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",o),c=new ur),n[i++]=c.x,n[i++]=c.y,n[i++]=c.z,n[i++]=c.w}return this}applyMatrix3(t){if(this.itemSize===2)for(let n=0,i=this.count;n<i;n++)Cg.fromBufferAttribute(this,n),Cg.applyMatrix3(t),this.setXY(n,Cg.x,Cg.y);else if(this.itemSize===3)for(let n=0,i=this.count;n<i;n++)Yr.fromBufferAttribute(this,n),Yr.applyMatrix3(t),this.setXYZ(n,Yr.x,Yr.y,Yr.z);return this}applyMatrix4(t){for(let n=0,i=this.count;n<i;n++)Yr.fromBufferAttribute(this,n),Yr.applyMatrix4(t),this.setXYZ(n,Yr.x,Yr.y,Yr.z);return this}applyNormalMatrix(t){for(let n=0,i=this.count;n<i;n++)Yr.fromBufferAttribute(this,n),Yr.applyNormalMatrix(t),this.setXYZ(n,Yr.x,Yr.y,Yr.z);return this}transformDirection(t){for(let n=0,i=this.count;n<i;n++)Yr.fromBufferAttribute(this,n),Yr.transformDirection(t),this.setXYZ(n,Yr.x,Yr.y,Yr.z);return this}set(t,n=0){return this.array.set(t,n),this}getX(t){return this.array[t*this.itemSize]}setX(t,n){return this.array[t*this.itemSize]=n,this}getY(t){return this.array[t*this.itemSize+1]}setY(t,n){return this.array[t*this.itemSize+1]=n,this}getZ(t){return this.array[t*this.itemSize+2]}setZ(t,n){return this.array[t*this.itemSize+2]=n,this}getW(t){return this.array[t*this.itemSize+3]}setW(t,n){return this.array[t*this.itemSize+3]=n,this}setXY(t,n,i){return t*=this.itemSize,this.array[t+0]=n,this.array[t+1]=i,this}setXYZ(t,n,i,o){return t*=this.itemSize,this.array[t+0]=n,this.array[t+1]=i,this.array[t+2]=o,this}setXYZW(t,n,i,o,s){return t*=this.itemSize,this.array[t+0]=n,this.array[t+1]=i,this.array[t+2]=o,this.array[t+3]=s,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.prototype.slice.call(this.array),normalized:this.normalized};return this.name!==""&&(t.name=this.name),this.usage!==Nv&&(t.usage=this.usage),(this.updateRange.offset!==0||this.updateRange.count!==-1)&&(t.updateRange=this.updateRange),t}}class JU extends mr{constructor(t,n,i){super(new Int8Array(t),n,i)}}class ek extends mr{constructor(t,n,i){super(new Uint8Array(t),n,i)}}class tk extends mr{constructor(t,n,i){super(new Uint8ClampedArray(t),n,i)}}class nk extends mr{constructor(t,n,i){super(new Int16Array(t),n,i)}}class I_ extends mr{constructor(t,n,i){super(new Uint16Array(t),n,i)}}class ik extends mr{constructor(t,n,i){super(new Int32Array(t),n,i)}}class O_ extends mr{constructor(t,n,i){super(new Uint32Array(t),n,i)}}class rk extends mr{constructor(t,n,i){super(new Uint16Array(t),n,i),this.isFloat16BufferAttribute=!0}}class ni extends mr{constructor(t,n,i){super(new Float32Array(t),n,i)}}class sk extends mr{constructor(t,n,i){super(new Float64Array(t),n,i)}}let ok=0;const Bo=new Oi,Jx=new or,Of=new Ze,Ao=new Eh,Dp=new Eh,us=new Ze;class Ii extends $c{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:ok++}),this.uuid=Co(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(fR(t)?O_:I_)(t,1):this.index=t,this}getAttribute(t){return this.attributes[t]}setAttribute(t,n){return this.attributes[t]=n,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,n,i=0){this.groups.push({start:t,count:n,materialIndex:i})}clearGroups(){this.groups=[]}setDrawRange(t,n){this.drawRange.start=t,this.drawRange.count=n}applyMatrix4(t){const n=this.attributes.position;n!==void 0&&(n.applyMatrix4(t),n.needsUpdate=!0);const i=this.attributes.normal;if(i!==void 0){const s=new Ho().getNormalMatrix(t);i.applyNormalMatrix(s),i.needsUpdate=!0}const o=this.attributes.tangent;return o!==void 0&&(o.transformDirection(t),o.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(t){return Bo.makeRotationFromQuaternion(t),this.applyMatrix4(Bo),this}rotateX(t){return Bo.makeRotationX(t),this.applyMatrix4(Bo),this}rotateY(t){return Bo.makeRotationY(t),this.applyMatrix4(Bo),this}rotateZ(t){return Bo.makeRotationZ(t),this.applyMatrix4(Bo),this}translate(t,n,i){return Bo.makeTranslation(t,n,i),this.applyMatrix4(Bo),this}scale(t,n,i){return Bo.makeScale(t,n,i),this.applyMatrix4(Bo),this}lookAt(t){return Jx.lookAt(t),Jx.updateMatrix(),this.applyMatrix4(Jx.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Of).negate(),this.translate(Of.x,Of.y,Of.z),this}setFromPoints(t){const n=[];for(let i=0,o=t.length;i<o;i++){const s=t[i];n.push(s.x,s.y,s.z||0)}return this.setAttribute("position",new ni(n,3)),this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Eh);const t=this.attributes.position,n=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingBox.set(new Ze(-1/0,-1/0,-1/0),new Ze(1/0,1/0,1/0));return}if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),n)for(let i=0,o=n.length;i<o;i++){const s=n[i];Ao.setFromBufferAttribute(s),this.morphTargetsRelative?(us.addVectors(this.boundingBox.min,Ao.min),this.boundingBox.expandByPoint(us),us.addVectors(this.boundingBox.max,Ao.max),this.boundingBox.expandByPoint(us)):(this.boundingBox.expandByPoint(Ao.min),this.boundingBox.expandByPoint(Ao.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new Mh);const t=this.attributes.position,n=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error('THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere. Alternatively set "mesh.frustumCulled" to "false".',this),this.boundingSphere.set(new Ze,1/0);return}if(t){const i=this.boundingSphere.center;if(Ao.setFromBufferAttribute(t),n)for(let s=0,c=n.length;s<c;s++){const u=n[s];Dp.setFromBufferAttribute(u),this.morphTargetsRelative?(us.addVectors(Ao.min,Dp.min),Ao.expandByPoint(us),us.addVectors(Ao.max,Dp.max),Ao.expandByPoint(us)):(Ao.expandByPoint(Dp.min),Ao.expandByPoint(Dp.max))}Ao.getCenter(i);let o=0;for(let s=0,c=t.count;s<c;s++)us.fromBufferAttribute(t,s),o=Math.max(o,i.distanceToSquared(us));if(n)for(let s=0,c=n.length;s<c;s++){const u=n[s],h=this.morphTargetsRelative;for(let f=0,p=u.count;f<p;f++)us.fromBufferAttribute(u,f),h&&(Of.fromBufferAttribute(t,f),us.add(Of)),o=Math.max(o,i.distanceToSquared(us))}this.boundingSphere.radius=Math.sqrt(o),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,n=this.attributes;if(t===null||n.position===void 0||n.normal===void 0||n.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const i=t.array,o=n.position.array,s=n.normal.array,c=n.uv.array,u=o.length/3;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new mr(new Float32Array(4*u),4));const h=this.getAttribute("tangent").array,f=[],p=[];for(let de=0;de<u;de++)f[de]=new Ze,p[de]=new Ze;const m=new Ze,y=new Ze,g=new Ze,_=new yn,x=new yn,b=new yn,E=new Ze,T=new Ze;function P(de,te,N){m.fromArray(o,de*3),y.fromArray(o,te*3),g.fromArray(o,N*3),_.fromArray(c,de*2),x.fromArray(c,te*2),b.fromArray(c,N*2),y.sub(m),g.sub(m),x.sub(_),b.sub(_);const L=1/(x.x*b.y-b.x*x.y);!isFinite(L)||(E.copy(y).multiplyScalar(b.y).addScaledVector(g,-x.y).multiplyScalar(L),T.copy(g).multiplyScalar(x.x).addScaledVector(y,-b.x).multiplyScalar(L),f[de].add(E),f[te].add(E),f[N].add(E),p[de].add(T),p[te].add(T),p[N].add(T))}let D=this.groups;D.length===0&&(D=[{start:0,count:i.length}]);for(let de=0,te=D.length;de<te;++de){const N=D[de],L=N.start,M=N.count;for(let I=L,U=L+M;I<U;I+=3)P(i[I+0],i[I+1],i[I+2])}const F=new Ze,k=new Ze,W=new Ze,j=new Ze;function J(de){W.fromArray(s,de*3),j.copy(W);const te=f[de];F.copy(te),F.sub(W.multiplyScalar(W.dot(te))).normalize(),k.crossVectors(j,te);const L=k.dot(p[de])<0?-1:1;h[de*4]=F.x,h[de*4+1]=F.y,h[de*4+2]=F.z,h[de*4+3]=L}for(let de=0,te=D.length;de<te;++de){const N=D[de],L=N.start,M=N.count;for(let I=L,U=L+M;I<U;I+=3)J(i[I+0]),J(i[I+1]),J(i[I+2])}}computeVertexNormals(){const t=this.index,n=this.getAttribute("position");if(n!==void 0){let i=this.getAttribute("normal");if(i===void 0)i=new mr(new Float32Array(n.count*3),3),this.setAttribute("normal",i);else for(let y=0,g=i.count;y<g;y++)i.setXYZ(y,0,0,0);const o=new Ze,s=new Ze,c=new Ze,u=new Ze,h=new Ze,f=new Ze,p=new Ze,m=new Ze;if(t)for(let y=0,g=t.count;y<g;y+=3){const _=t.getX(y+0),x=t.getX(y+1),b=t.getX(y+2);o.fromBufferAttribute(n,_),s.fromBufferAttribute(n,x),c.fromBufferAttribute(n,b),p.subVectors(c,s),m.subVectors(o,s),p.cross(m),u.fromBufferAttribute(i,_),h.fromBufferAttribute(i,x),f.fromBufferAttribute(i,b),u.add(p),h.add(p),f.add(p),i.setXYZ(_,u.x,u.y,u.z),i.setXYZ(x,h.x,h.y,h.z),i.setXYZ(b,f.x,f.y,f.z)}else for(let y=0,g=n.count;y<g;y+=3)o.fromBufferAttribute(n,y+0),s.fromBufferAttribute(n,y+1),c.fromBufferAttribute(n,y+2),p.subVectors(c,s),m.subVectors(o,s),p.cross(m),i.setXYZ(y+0,p.x,p.y,p.z),i.setXYZ(y+1,p.x,p.y,p.z),i.setXYZ(y+2,p.x,p.y,p.z);this.normalizeNormals(),i.needsUpdate=!0}}merge(t,n){if(!(t&&t.isBufferGeometry)){console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);return}n===void 0&&(n=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));const i=this.attributes;for(const o in i){if(t.attributes[o]===void 0)continue;const c=i[o].array,u=t.attributes[o],h=u.array,f=u.itemSize*n,p=Math.min(h.length,c.length-f);for(let m=0,y=f;m<p;m++,y++)c[y]=h[m]}return this}normalizeNormals(){const t=this.attributes.normal;for(let n=0,i=t.count;n<i;n++)us.fromBufferAttribute(t,n),us.normalize(),t.setXYZ(n,us.x,us.y,us.z)}toNonIndexed(){function t(u,h){const f=u.array,p=u.itemSize,m=u.normalized,y=new f.constructor(h.length*p);let g=0,_=0;for(let x=0,b=h.length;x<b;x++){u.isInterleavedBufferAttribute?g=h[x]*u.data.stride+u.offset:g=h[x]*p;for(let E=0;E<p;E++)y[_++]=f[g++]}return new mr(y,p,m)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const n=new Ii,i=this.index.array,o=this.attributes;for(const u in o){const h=o[u],f=t(h,i);n.setAttribute(u,f)}const s=this.morphAttributes;for(const u in s){const h=[],f=s[u];for(let p=0,m=f.length;p<m;p++){const y=f[p],g=t(y,i);h.push(g)}n.morphAttributes[u]=h}n.morphTargetsRelative=this.morphTargetsRelative;const c=this.groups;for(let u=0,h=c.length;u<h;u++){const f=c[u];n.addGroup(f.start,f.count,f.materialIndex)}return n}toJSON(){const t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){const h=this.parameters;for(const f in h)h[f]!==void 0&&(t[f]=h[f]);return t}t.data={attributes:{}};const n=this.index;n!==null&&(t.data.index={type:n.array.constructor.name,array:Array.prototype.slice.call(n.array)});const i=this.attributes;for(const h in i){const f=i[h];t.data.attributes[h]=f.toJSON(t.data)}const o={};let s=!1;for(const h in this.morphAttributes){const f=this.morphAttributes[h],p=[];for(let m=0,y=f.length;m<y;m++){const g=f[m];p.push(g.toJSON(t.data))}p.length>0&&(o[h]=p,s=!0)}s&&(t.data.morphAttributes=o,t.data.morphTargetsRelative=this.morphTargetsRelative);const c=this.groups;c.length>0&&(t.data.groups=JSON.parse(JSON.stringify(c)));const u=this.boundingSphere;return u!==null&&(t.data.boundingSphere={center:u.center.toArray(),radius:u.radius}),t}clone(){return new this.constructor().copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const n={};this.name=t.name;const i=t.index;i!==null&&this.setIndex(i.clone(n));const o=t.attributes;for(const f in o){const p=o[f];this.setAttribute(f,p.clone(n))}const s=t.morphAttributes;for(const f in s){const p=[],m=s[f];for(let y=0,g=m.length;y<g;y++)p.push(m[y].clone(n));this.morphAttributes[f]=p}this.morphTargetsRelative=t.morphTargetsRelative;const c=t.groups;for(let f=0,p=c.length;f<p;f++){const m=c[f];this.addGroup(m.start,m.count,m.materialIndex)}const u=t.boundingBox;u!==null&&(this.boundingBox=u.clone());const h=t.boundingSphere;return h!==null&&(this.boundingSphere=h.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,t.parameters!==void 0&&(this.parameters=Object.assign({},t.parameters)),this}dispose(){this.dispatchEvent({type:"dispose"})}}const dS=new Oi,Df=new Fm,eA=new Mh,gc=new Ze,vc=new Ze,yc=new Ze,tA=new Ze,nA=new Ze,iA=new Ze,Rg=new Ze,Lg=new Ze,Pg=new Ze,Ig=new yn,Og=new yn,Dg=new yn,rA=new Ze,Bg=new Ze;class Ss extends or{constructor(t=new Ii,n=new qc){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=n,this.updateMorphTargets()}copy(t,n){return super.copy(t,n),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=t.material,this.geometry=t.geometry,this}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const o=n[i[0]];if(o!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,c=o.length;s<c;s++){const u=o[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=s}}}}raycast(t,n){const i=this.geometry,o=this.material,s=this.matrixWorld;if(o===void 0||(i.boundingSphere===null&&i.computeBoundingSphere(),eA.copy(i.boundingSphere),eA.applyMatrix4(s),t.ray.intersectsSphere(eA)===!1)||(dS.copy(s).invert(),Df.copy(t.ray).applyMatrix4(dS),i.boundingBox!==null&&Df.intersectsBox(i.boundingBox)===!1))return;let c;const u=i.index,h=i.attributes.position,f=i.morphAttributes.position,p=i.morphTargetsRelative,m=i.attributes.uv,y=i.attributes.uv2,g=i.groups,_=i.drawRange;if(u!==null)if(Array.isArray(o))for(let x=0,b=g.length;x<b;x++){const E=g[x],T=o[E.materialIndex],P=Math.max(E.start,_.start),D=Math.min(u.count,Math.min(E.start+E.count,_.start+_.count));for(let F=P,k=D;F<k;F+=3){const W=u.getX(F),j=u.getX(F+1),J=u.getX(F+2);c=Fg(this,T,t,Df,h,f,p,m,y,W,j,J),c&&(c.faceIndex=Math.floor(F/3),c.face.materialIndex=E.materialIndex,n.push(c))}}else{const x=Math.max(0,_.start),b=Math.min(u.count,_.start+_.count);for(let E=x,T=b;E<T;E+=3){const P=u.getX(E),D=u.getX(E+1),F=u.getX(E+2);c=Fg(this,o,t,Df,h,f,p,m,y,P,D,F),c&&(c.faceIndex=Math.floor(E/3),n.push(c))}}else if(h!==void 0)if(Array.isArray(o))for(let x=0,b=g.length;x<b;x++){const E=g[x],T=o[E.materialIndex],P=Math.max(E.start,_.start),D=Math.min(h.count,Math.min(E.start+E.count,_.start+_.count));for(let F=P,k=D;F<k;F+=3){const W=F,j=F+1,J=F+2;c=Fg(this,T,t,Df,h,f,p,m,y,W,j,J),c&&(c.faceIndex=Math.floor(F/3),c.face.materialIndex=E.materialIndex,n.push(c))}}else{const x=Math.max(0,_.start),b=Math.min(h.count,_.start+_.count);for(let E=x,T=b;E<T;E+=3){const P=E,D=E+1,F=E+2;c=Fg(this,o,t,Df,h,f,p,m,y,P,D,F),c&&(c.faceIndex=Math.floor(E/3),n.push(c))}}}}function ak(a,t,n,i,o,s,c,u){let h;if(t.side===To?h=i.intersectTriangle(c,s,o,!0,u):h=i.intersectTriangle(o,s,c,t.side!==fh,u),h===null)return null;Bg.copy(u),Bg.applyMatrix4(a.matrixWorld);const f=n.ray.origin.distanceTo(Bg);return f<n.near||f>n.far?null:{distance:f,point:Bg.clone(),object:a}}function Fg(a,t,n,i,o,s,c,u,h,f,p,m){gc.fromBufferAttribute(o,f),vc.fromBufferAttribute(o,p),yc.fromBufferAttribute(o,m);const y=a.morphTargetInfluences;if(s&&y){Rg.set(0,0,0),Lg.set(0,0,0),Pg.set(0,0,0);for(let _=0,x=s.length;_<x;_++){const b=y[_],E=s[_];b!==0&&(tA.fromBufferAttribute(E,f),nA.fromBufferAttribute(E,p),iA.fromBufferAttribute(E,m),c?(Rg.addScaledVector(tA,b),Lg.addScaledVector(nA,b),Pg.addScaledVector(iA,b)):(Rg.addScaledVector(tA.sub(gc),b),Lg.addScaledVector(nA.sub(vc),b),Pg.addScaledVector(iA.sub(yc),b)))}gc.add(Rg),vc.add(Lg),yc.add(Pg)}a.isSkinnedMesh&&(a.boneTransform(f,gc),a.boneTransform(p,vc),a.boneTransform(m,yc));const g=ak(a,t,n,i,gc,vc,yc,rA);if(g){u&&(Ig.fromBufferAttribute(u,f),Og.fromBufferAttribute(u,p),Dg.fromBufferAttribute(u,m),g.uv=zo.getUV(rA,gc,vc,yc,Ig,Og,Dg,new yn)),h&&(Ig.fromBufferAttribute(h,f),Og.fromBufferAttribute(h,p),Dg.fromBufferAttribute(h,m),g.uv2=zo.getUV(rA,gc,vc,yc,Ig,Og,Dg,new yn));const _={a:f,b:p,c:m,normal:new Ze,materialIndex:0};zo.getNormal(gc,vc,yc,_.normal),g.face=_}return g}class zl extends Ii{constructor(t=1,n=1,i=1,o=1,s=1,c=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:n,depth:i,widthSegments:o,heightSegments:s,depthSegments:c};const u=this;o=Math.floor(o),s=Math.floor(s),c=Math.floor(c);const h=[],f=[],p=[],m=[];let y=0,g=0;_("z","y","x",-1,-1,i,n,t,c,s,0),_("z","y","x",1,-1,i,n,-t,c,s,1),_("x","z","y",1,1,t,i,n,o,c,2),_("x","z","y",1,-1,t,i,-n,o,c,3),_("x","y","z",1,-1,t,n,i,o,s,4),_("x","y","z",-1,-1,t,n,-i,o,s,5),this.setIndex(h),this.setAttribute("position",new ni(f,3)),this.setAttribute("normal",new ni(p,3)),this.setAttribute("uv",new ni(m,2));function _(x,b,E,T,P,D,F,k,W,j,J){const de=D/W,te=F/j,N=D/2,L=F/2,M=k/2,I=W+1,U=j+1;let $=0,ee=0;const Q=new Ze;for(let G=0;G<U;G++){const K=G*te-L;for(let Y=0;Y<I;Y++){const we=Y*de-N;Q[x]=we*T,Q[b]=K*P,Q[E]=M,f.push(Q.x,Q.y,Q.z),Q[x]=0,Q[b]=0,Q[E]=k>0?1:-1,p.push(Q.x,Q.y,Q.z),m.push(Y/W),m.push(1-G/j),$+=1}}for(let G=0;G<j;G++)for(let K=0;K<W;K++){const Y=y+K+I*G,we=y+K+I*(G+1),Ke=y+(K+1)+I*(G+1),ge=y+(K+1)+I*G;h.push(Y,we,ge),h.push(we,Ke,ge),ee+=6}u.addGroup(g,ee,J),g+=ee,y+=$}}static fromJSON(t){return new zl(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function ad(a){const t={};for(const n in a){t[n]={};for(const i in a[n]){const o=a[n][i];o&&(o.isColor||o.isMatrix3||o.isMatrix4||o.isVector2||o.isVector3||o.isVector4||o.isTexture||o.isQuaternion)?t[n][i]=o.clone():Array.isArray(o)?t[n][i]=o.slice():t[n][i]=o}}return t}function Us(a){const t={};for(let n=0;n<a.length;n++){const i=ad(a[n]);for(const o in i)t[o]=i[o]}return t}const pR={clone:ad,merge:Us};var lk=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,ck=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Ya extends rs{constructor(t){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader=lk,this.fragmentShader=ck,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,t!==void 0&&(t.attributes!==void 0&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=ad(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const n=super.toJSON(t);n.glslVersion=this.glslVersion,n.uniforms={};for(const o in this.uniforms){const c=this.uniforms[o].value;c&&c.isTexture?n.uniforms[o]={type:"t",value:c.toJSON(t).uuid}:c&&c.isColor?n.uniforms[o]={type:"c",value:c.getHex()}:c&&c.isVector2?n.uniforms[o]={type:"v2",value:c.toArray()}:c&&c.isVector3?n.uniforms[o]={type:"v3",value:c.toArray()}:c&&c.isVector4?n.uniforms[o]={type:"v4",value:c.toArray()}:c&&c.isMatrix3?n.uniforms[o]={type:"m3",value:c.toArray()}:c&&c.isMatrix4?n.uniforms[o]={type:"m4",value:c.toArray()}:n.uniforms[o]={value:c}}Object.keys(this.defines).length>0&&(n.defines=this.defines),n.vertexShader=this.vertexShader,n.fragmentShader=this.fragmentShader;const i={};for(const o in this.extensions)this.extensions[o]===!0&&(i[o]=!0);return Object.keys(i).length>0&&(n.extensions=i),n}}class py extends or{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new Oi,this.projectionMatrix=new Oi,this.projectionMatrixInverse=new Oi}copy(t,n){return super.copy(t,n),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const n=this.matrixWorld.elements;return t.set(-n[8],-n[9],-n[10]).normalize()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,n){super.updateWorldMatrix(t,n),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}class Es extends py{constructor(t=50,n=1,i=.1,o=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=i,this.far=o,this.focus=10,this.aspect=n,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,n){return super.copy(t,n),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const n=.5*this.getFilmHeight()/t;this.fov=Am*2*Math.atan(n),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(oh*.5*this.fov);return .5*this.getFilmHeight()/t}getEffectiveFOV(){return Am*2*Math.atan(Math.tan(oh*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}setViewOffset(t,n,i,o,s,c){this.aspect=t/n,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=o,this.view.width=s,this.view.height=c,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let n=t*Math.tan(oh*.5*this.fov)/this.zoom,i=2*n,o=this.aspect*i,s=-.5*o;const c=this.view;if(this.view!==null&&this.view.enabled){const h=c.fullWidth,f=c.fullHeight;s+=c.offsetX*o/h,n-=c.offsetY*i/f,o*=c.width/h,i*=c.height/f}const u=this.filmOffset;u!==0&&(s+=t*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(s,s+o,n,n-i,t,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const n=super.toJSON(t);return n.object.fov=this.fov,n.object.zoom=this.zoom,n.object.near=this.near,n.object.far=this.far,n.object.focus=this.focus,n.object.aspect=this.aspect,this.view!==null&&(n.object.view=Object.assign({},this.view)),n.object.filmGauge=this.filmGauge,n.object.filmOffset=this.filmOffset,n}}const Bf=90,Ff=1;class mR extends or{constructor(t,n,i){if(super(),this.type="CubeCamera",i.isWebGLCubeRenderTarget!==!0){console.error("THREE.CubeCamera: The constructor now expects an instance of WebGLCubeRenderTarget as third parameter.");return}this.renderTarget=i;const o=new Es(Bf,Ff,t,n);o.layers=this.layers,o.up.set(0,-1,0),o.lookAt(new Ze(1,0,0)),this.add(o);const s=new Es(Bf,Ff,t,n);s.layers=this.layers,s.up.set(0,-1,0),s.lookAt(new Ze(-1,0,0)),this.add(s);const c=new Es(Bf,Ff,t,n);c.layers=this.layers,c.up.set(0,0,1),c.lookAt(new Ze(0,1,0)),this.add(c);const u=new Es(Bf,Ff,t,n);u.layers=this.layers,u.up.set(0,0,-1),u.lookAt(new Ze(0,-1,0)),this.add(u);const h=new Es(Bf,Ff,t,n);h.layers=this.layers,h.up.set(0,-1,0),h.lookAt(new Ze(0,0,1)),this.add(h);const f=new Es(Bf,Ff,t,n);f.layers=this.layers,f.up.set(0,-1,0),f.lookAt(new Ze(0,0,-1)),this.add(f)}update(t,n){this.parent===null&&this.updateMatrixWorld();const i=this.renderTarget,[o,s,c,u,h,f]=this.children,p=t.getRenderTarget(),m=t.toneMapping,y=t.xr.enabled;t.toneMapping=za,t.xr.enabled=!1;const g=i.texture.generateMipmaps;i.texture.generateMipmaps=!1,t.setRenderTarget(i,0),t.render(n,o),t.setRenderTarget(i,1),t.render(n,s),t.setRenderTarget(i,2),t.render(n,c),t.setRenderTarget(i,3),t.render(n,u),t.setRenderTarget(i,4),t.render(n,h),i.texture.generateMipmaps=g,t.setRenderTarget(i,5),t.render(n,f),t.setRenderTarget(p),t.toneMapping=m,t.xr.enabled=y,i.texture.needsPMREMUpdate=!0}}class Nm extends is{constructor(t,n,i,o,s,c,u,h,f,p){t=t!==void 0?t:[],n=n!==void 0?n:kc,super(t,n,i,o,s,c,u,h,f,p),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}class gR extends Ro{constructor(t,n={}){super(t,t,n),this.isWebGLCubeRenderTarget=!0;const i={width:t,height:t,depth:1},o=[i,i,i,i,i,i];this.texture=new Nm(o,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=n.generateMipmaps!==void 0?n.generateMipmaps:!1,this.texture.minFilter=n.minFilter!==void 0?n.minFilter:Vr}fromEquirectangularTexture(t,n){this.texture.type=n.type,this.texture.encoding=n.encoding,this.texture.generateMipmaps=n.generateMipmaps,this.texture.minFilter=n.minFilter,this.texture.magFilter=n.magFilter;const i={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},o=new zl(5,5,5),s=new Ya({name:"CubemapFromEquirect",uniforms:ad(i.uniforms),vertexShader:i.vertexShader,fragmentShader:i.fragmentShader,side:To,blending:Ul});s.uniforms.tEquirect.value=n;const c=new Ss(o,s),u=n.minFilter;return n.minFilter===_h&&(n.minFilter=Vr),new mR(1,10,this).update(t,c),n.minFilter=u,c.geometry.dispose(),c.material.dispose(),this}clear(t,n,i,o){const s=t.getRenderTarget();for(let c=0;c<6;c++)t.setRenderTarget(this,c),t.clear(n,i,o);t.setRenderTarget(s)}}const sA=new Ze,uk=new Ze,hk=new Ho;class Mc{constructor(t=new Ze(1,0,0),n=0){this.isPlane=!0,this.normal=t,this.constant=n}set(t,n){return this.normal.copy(t),this.constant=n,this}setComponents(t,n,i,o){return this.normal.set(t,n,i),this.constant=o,this}setFromNormalAndCoplanarPoint(t,n){return this.normal.copy(t),this.constant=-n.dot(this.normal),this}setFromCoplanarPoints(t,n,i){const o=sA.subVectors(i,n).cross(uk.subVectors(t,n)).normalize();return this.setFromNormalAndCoplanarPoint(o,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,n){return n.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)}intersectLine(t,n){const i=t.delta(sA),o=this.normal.dot(i);if(o===0)return this.distanceToPoint(t.start)===0?n.copy(t.start):null;const s=-(t.start.dot(this.normal)+this.constant)/o;return s<0||s>1?null:n.copy(i).multiplyScalar(s).add(t.start)}intersectsLine(t){const n=this.distanceToPoint(t.start),i=this.distanceToPoint(t.end);return n<0&&i>0||i<0&&n>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,n){const i=n||hk.getNormalMatrix(t),o=this.coplanarPoint(sA).applyMatrix4(t),s=this.normal.applyMatrix3(i).normalize();return this.constant=-o.dot(s),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Nf=new Mh,Ng=new Ze;class my{constructor(t=new Mc,n=new Mc,i=new Mc,o=new Mc,s=new Mc,c=new Mc){this.planes=[t,n,i,o,s,c]}set(t,n,i,o,s,c){const u=this.planes;return u[0].copy(t),u[1].copy(n),u[2].copy(i),u[3].copy(o),u[4].copy(s),u[5].copy(c),this}copy(t){const n=this.planes;for(let i=0;i<6;i++)n[i].copy(t.planes[i]);return this}setFromProjectionMatrix(t){const n=this.planes,i=t.elements,o=i[0],s=i[1],c=i[2],u=i[3],h=i[4],f=i[5],p=i[6],m=i[7],y=i[8],g=i[9],_=i[10],x=i[11],b=i[12],E=i[13],T=i[14],P=i[15];return n[0].setComponents(u-o,m-h,x-y,P-b).normalize(),n[1].setComponents(u+o,m+h,x+y,P+b).normalize(),n[2].setComponents(u+s,m+f,x+g,P+E).normalize(),n[3].setComponents(u-s,m-f,x-g,P-E).normalize(),n[4].setComponents(u-c,m-p,x-_,P-T).normalize(),n[5].setComponents(u+c,m+p,x+_,P+T).normalize(),this}intersectsObject(t){const n=t.geometry;return n.boundingSphere===null&&n.computeBoundingSphere(),Nf.copy(n.boundingSphere).applyMatrix4(t.matrixWorld),this.intersectsSphere(Nf)}intersectsSprite(t){return Nf.center.set(0,0,0),Nf.radius=.7071067811865476,Nf.applyMatrix4(t.matrixWorld),this.intersectsSphere(Nf)}intersectsSphere(t){const n=this.planes,i=t.center,o=-t.radius;for(let s=0;s<6;s++)if(n[s].distanceToPoint(i)<o)return!1;return!0}intersectsBox(t){const n=this.planes;for(let i=0;i<6;i++){const o=n[i];if(Ng.x=o.normal.x>0?t.max.x:t.min.x,Ng.y=o.normal.y>0?t.max.y:t.min.y,Ng.z=o.normal.z>0?t.max.z:t.min.z,o.distanceToPoint(Ng)<0)return!1}return!0}containsPoint(t){const n=this.planes;for(let i=0;i<6;i++)if(n[i].distanceToPoint(t)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}function vR(){let a=null,t=!1,n=null,i=null;function o(s,c){n(s,c),i=a.requestAnimationFrame(o)}return{start:function(){t!==!0&&n!==null&&(i=a.requestAnimationFrame(o),t=!0)},stop:function(){a.cancelAnimationFrame(i),t=!1},setAnimationLoop:function(s){n=s},setContext:function(s){a=s}}}function fk(a,t){const n=t.isWebGL2,i=new WeakMap;function o(f,p){const m=f.array,y=f.usage,g=a.createBuffer();a.bindBuffer(p,g),a.bufferData(p,m,y),f.onUploadCallback();let _;if(m instanceof Float32Array)_=5126;else if(m instanceof Uint16Array)if(f.isFloat16BufferAttribute)if(n)_=5131;else throw new Error("THREE.WebGLAttributes: Usage of Float16BufferAttribute requires WebGL2.");else _=5123;else if(m instanceof Int16Array)_=5122;else if(m instanceof Uint32Array)_=5125;else if(m instanceof Int32Array)_=5124;else if(m instanceof Int8Array)_=5120;else if(m instanceof Uint8Array)_=5121;else if(m instanceof Uint8ClampedArray)_=5121;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+m);return{buffer:g,type:_,bytesPerElement:m.BYTES_PER_ELEMENT,version:f.version}}function s(f,p,m){const y=p.array,g=p.updateRange;a.bindBuffer(m,f),g.count===-1?a.bufferSubData(m,0,y):(n?a.bufferSubData(m,g.offset*y.BYTES_PER_ELEMENT,y,g.offset,g.count):a.bufferSubData(m,g.offset*y.BYTES_PER_ELEMENT,y.subarray(g.offset,g.offset+g.count)),g.count=-1)}function c(f){return f.isInterleavedBufferAttribute&&(f=f.data),i.get(f)}function u(f){f.isInterleavedBufferAttribute&&(f=f.data);const p=i.get(f);p&&(a.deleteBuffer(p.buffer),i.delete(f))}function h(f,p){if(f.isGLBufferAttribute){const y=i.get(f);(!y||y.version<f.version)&&i.set(f,{buffer:f.buffer,type:f.type,bytesPerElement:f.elementSize,version:f.version});return}f.isInterleavedBufferAttribute&&(f=f.data);const m=i.get(f);m===void 0?i.set(f,o(f,p)):m.version<f.version&&(s(m.buffer,f,p),m.version=f.version)}return{get:c,remove:u,update:h}}class ph extends Ii{constructor(t=1,n=1,i=1,o=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:n,widthSegments:i,heightSegments:o};const s=t/2,c=n/2,u=Math.floor(i),h=Math.floor(o),f=u+1,p=h+1,m=t/u,y=n/h,g=[],_=[],x=[],b=[];for(let E=0;E<p;E++){const T=E*y-c;for(let P=0;P<f;P++){const D=P*m-s;_.push(D,-T,0),x.push(0,0,1),b.push(P/u),b.push(1-E/h)}}for(let E=0;E<h;E++)for(let T=0;T<u;T++){const P=T+f*E,D=T+f*(E+1),F=T+1+f*(E+1),k=T+1+f*E;g.push(P,D,k),g.push(D,F,k)}this.setIndex(g),this.setAttribute("position",new ni(_,3)),this.setAttribute("normal",new ni(x,3)),this.setAttribute("uv",new ni(b,2))}static fromJSON(t){return new ph(t.width,t.height,t.widthSegments,t.heightSegments)}}var dk=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vUv ).g;
#endif`,pk=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,mk=`#ifdef USE_ALPHATEST
	if ( diffuseColor.a < alphaTest ) discard;
#endif`,gk=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,vk=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,yk=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,xk="vec3 transformed = vec3( position );",Ak=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,bk=`vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#ifdef USE_IRIDESCENCE
vec3 BRDF_GGX_Iridescence( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 f0, const in float f90, const in float iridescence, const in vec3 iridescenceFresnel, const in float roughness ) {
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = mix(F_Schlick( f0, f90, dotVH ), iridescenceFresnel, iridescence);
	float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
	float D = D_GGX( alpha, dotNH );
	return F * ( V * D );
}
#endif
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif`,_k=`#ifdef USE_IRIDESCENCE
const mat3 XYZ_TO_REC709 = mat3(
    3.2404542, -0.9692660,  0.0556434,
   -1.5371385,  1.8760108, -0.2040259,
   -0.4985314,  0.0415560,  1.0572252
);
vec3 Fresnel0ToIor( vec3 fresnel0 ) {
   vec3 sqrtF0 = sqrt( fresnel0 );
   return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
}
vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
   return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
}
float IorToFresnel0( float transmittedIor, float incidentIor ) {
   return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
}
vec3 evalSensitivity( float OPD, vec3 shift ) {
   float phase = 2.0 * PI * OPD * 1.0e-9;
   vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
   vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
   vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
   vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( -pow2( phase ) * var );
   xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[0] ) * exp( -4.5282e+09 * pow2( phase ) );
   xyz /= 1.0685e-7;
   vec3 srgb = XYZ_TO_REC709 * xyz;
   return srgb;
}
vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
   vec3 I;
   float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
   float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
   float cosTheta2Sq = 1.0 - sinTheta2Sq;
   if ( cosTheta2Sq < 0.0 ) {
       return vec3( 1.0 );
   }
   float cosTheta2 = sqrt( cosTheta2Sq );
   float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
   float R12 = F_Schlick( R0, 1.0, cosTheta1 );
   float R21 = R12;
   float T121 = 1.0 - R12;
   float phi12 = 0.0;
   if ( iridescenceIOR < outsideIOR ) phi12 = PI;
   float phi21 = PI - phi12;
   vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );   vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
   vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
   vec3 phi23 = vec3( 0.0 );
   if ( baseIOR[0] < iridescenceIOR ) phi23[0] = PI;
   if ( baseIOR[1] < iridescenceIOR ) phi23[1] = PI;
   if ( baseIOR[2] < iridescenceIOR ) phi23[2] = PI;
   float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
   vec3 phi = vec3( phi21 ) + phi23;
   vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
   vec3 r123 = sqrt( R123 );
   vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
   vec3 C0 = R12 + Rs;
   I = C0;
   vec3 Cm = Rs - T121;
   for ( int m = 1; m <= 2; ++m ) {
       Cm *= r123;
       vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
       I += Cm * Sm;
   }
   return max( I, vec3( 0.0 ) );
}
#endif`,wk=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vUv );
		vec2 dSTdy = dFdy( vUv );
		float Hll = bumpScale * texture2D( bumpMap, vUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );
		vec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Ek=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#pragma unroll_loop_start
	for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
		plane = clippingPlanes[ i ];
		if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
	}
	#pragma unroll_loop_end
	#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
		bool clipped = true;
		#pragma unroll_loop_start
		for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
		}
		#pragma unroll_loop_end
		if ( clipped ) discard;
	#endif
#endif`,Mk=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Sk=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Tk=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,Ck=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,Rk=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,Lk=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	varying vec3 vColor;
#endif`,Pk=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif`,Ik=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
struct GeometricContext {
	vec3 position;
	vec3 normal;
	vec3 viewDir;
#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal;
#endif
};
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
float linearToRelativeLuminance( const in vec3 color ) {
	vec3 weights = vec3( 0.2126, 0.7152, 0.0722 );
	return dot( weights, color.rgb );
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}`,Ok=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define r0 1.0
	#define v0 0.339
	#define m0 - 2.0
	#define r1 0.8
	#define v1 0.276
	#define m1 - 1.0
	#define r4 0.4
	#define v4 0.046
	#define m4 2.0
	#define r5 0.305
	#define v5 0.016
	#define m5 3.0
	#define r6 0.21
	#define v6 0.0038
	#define m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= r1 ) {
			mip = ( r0 - roughness ) * ( m1 - m0 ) / ( r0 - r1 ) + m0;
		} else if ( roughness >= r4 ) {
			mip = ( r1 - roughness ) * ( m4 - m1 ) / ( r1 - r4 ) + m1;
		} else if ( roughness >= r5 ) {
			mip = ( r4 - roughness ) * ( m5 - m4 ) / ( r4 - r5 ) + m4;
		} else if ( roughness >= r6 ) {
			mip = ( r5 - roughness ) * ( m6 - m5 ) / ( r5 - r6 ) + m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Dk=`vec3 transformedNormal = objectNormal;
#ifdef USE_INSTANCING
	mat3 m = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( m[ 0 ], m[ 0 ] ), dot( m[ 1 ], m[ 1 ] ), dot( m[ 2 ], m[ 2 ] ) );
	transformedNormal = m * transformedNormal;
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	vec3 transformedTangent = ( modelViewMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Bk=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Fk=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vUv ).x * displacementScale + displacementBias );
#endif`,Nk=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vUv );
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,Uk=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,kk="gl_FragColor = linearToOutputTexel( gl_FragColor );",zk=`vec4 LinearToLinear( in vec4 value ) {
	return value;
}
vec4 LinearTosRGB( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,Hk=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 envColor = textureCubeUV( envMap, reflectVec, 0.0 );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Gk=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,Vk=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,Wk=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) ||defined( PHONG )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,jk=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,Xk=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,$k=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,qk=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,Yk=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,Qk=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		return ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );
	#endif
}`,Kk=`#ifdef USE_LIGHTMAP
	vec4 lightMapTexel = texture2D( lightMap, vUv2 );
	vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
	reflectedLight.indirectDiffuse += lightMapIrradiance;
#endif`,Zk=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,Jk=`vec3 diffuse = vec3( 1.0 );
GeometricContext geometry;
geometry.position = mvPosition.xyz;
geometry.normal = normalize( transformedNormal );
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( -mvPosition.xyz );
GeometricContext backGeometry;
backGeometry.position = geometry.position;
backGeometry.normal = -geometry.normal;
backGeometry.viewDir = geometry.viewDir;
vLightFront = vec3( 0.0 );
vIndirectFront = vec3( 0.0 );
#ifdef DOUBLE_SIDED
	vLightBack = vec3( 0.0 );
	vIndirectBack = vec3( 0.0 );
#endif
IncidentLight directLight;
float dotNL;
vec3 directLightColor_Diffuse;
vIndirectFront += getAmbientLightIrradiance( ambientLightColor );
vIndirectFront += getLightProbeIrradiance( lightProbe, geometry.normal );
#ifdef DOUBLE_SIDED
	vIndirectBack += getAmbientLightIrradiance( ambientLightColor );
	vIndirectBack += getLightProbeIrradiance( lightProbe, backGeometry.normal );
#endif
#if NUM_POINT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		getPointLightInfo( pointLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_SPOT_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		getSpotLightInfo( spotLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_DIR_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		getDirectionalLightInfo( directionalLights[ i ], geometry, directLight );
		dotNL = dot( geometry.normal, directLight.direction );
		directLightColor_Diffuse = directLight.color;
		vLightFront += saturate( dotNL ) * directLightColor_Diffuse;
		#ifdef DOUBLE_SIDED
			vLightBack += saturate( - dotNL ) * directLightColor_Diffuse;
		#endif
	}
	#pragma unroll_loop_end
#endif
#if NUM_HEMI_LIGHTS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
		vIndirectFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		#ifdef DOUBLE_SIDED
			vIndirectBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry.normal );
		#endif
	}
	#pragma unroll_loop_end
#endif`,ez=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
uniform vec3 lightProbe[ 9 ];
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	#if defined ( PHYSICALLY_CORRECT_LIGHTS )
		float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
		if ( cutoffDistance > 0.0 ) {
			distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
		}
		return distanceFalloff;
	#else
		if ( cutoffDistance > 0.0 && decayExponent > 0.0 ) {
			return pow( saturate( - lightDistance / cutoffDistance + 1.0 ), decayExponent );
		}
		return 1.0;
	#endif
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometry.position;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometry.position;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,tz=`#if defined( USE_ENVMAP )
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#if defined( ENVMAP_TYPE_CUBE_UV )
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
#endif`,nz=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,iz=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in GeometricContext geometry, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon
#define Material_LightProbeLOD( material )	(0)`,rz=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,sz=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong
#define Material_LightProbeLOD( material )	(0)`,oz=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( geometryNormal ) ), abs( dFdy( geometryNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	#ifdef SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULARINTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vUv ).a;
		#endif
		#ifdef USE_SPECULARCOLORMAP
			specularColorFactor *= texture2D( specularColorMap, vUv ).rgb;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( ior - 1.0 ) / ( ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEENCOLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEENROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vUv ).a;
	#endif
#endif`,az=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
};
vec3 clearcoatSpecular = vec3( 0.0 );
vec3 sheenSpecular = vec3( 0.0 );
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometry.normal;
		vec3 viewDir = geometry.viewDir;
		vec3 position = geometry.position;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometry.normal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometry.clearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecular += ccIrradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.clearcoatNormal, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * BRDF_Sheen( directLight.direction, geometry.viewDir, geometry.normal, material.sheenColor, material.sheenRoughness );
	#endif
	#ifdef USE_IRIDESCENCE
		reflectedLight.directSpecular += irradiance * BRDF_GGX_Iridescence( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness );
	#else
		reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometry.viewDir, geometry.normal, material.specularColor, material.specularF90, material.roughness );
	#endif
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecular += clearcoatRadiance * EnvironmentBRDF( geometry.clearcoatNormal, geometry.viewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecular += irradiance * material.sheenColor * IBLSheenBRDF( geometry.normal, geometry.viewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometry.normal, geometry.viewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,lz=`
GeometricContext geometry;
geometry.position = - vViewPosition;
geometry.normal = normal;
geometry.viewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
#ifdef USE_CLEARCOAT
	geometry.clearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
float dotNVi = saturate( dot( normal, geometry.viewDir ) );
if ( material.iridescenceThickness == 0.0 ) {
	material.iridescence = 0.0;
} else {
	material.iridescence = saturate( material.iridescence );
}
if ( material.iridescence > 0.0 ) {
	material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
	material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, geometry, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= all( bvec2( directLight.visible, receiveShadow ) ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	irradiance += getLightProbeIrradiance( lightProbe, geometry.normal );
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry.normal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,cz=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometry.normal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	radiance += getIBLRadiance( geometry.viewDir, geometry.normal, material.roughness );
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometry.viewDir, geometry.clearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,uz=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometry, material, reflectedLight );
#endif`,hz=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	gl_FragDepthEXT = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,fz=`#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,dz=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		varying float vFragDepth;
		varying float vIsPerspective;
	#else
		uniform float logDepthBufFC;
	#endif
#endif`,pz=`#ifdef USE_LOGDEPTHBUF
	#ifdef USE_LOGDEPTHBUF_EXT
		vFragDepth = 1.0 + gl_Position.w;
		vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
	#else
		if ( isPerspectiveMatrix( projectionMatrix ) ) {
			gl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;
			gl_Position.z *= gl_Position.w;
		}
	#endif
#endif`,mz=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = vec4( mix( pow( sampledDiffuseColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), sampledDiffuseColor.rgb * 0.0773993808, vec3( lessThanEqual( sampledDiffuseColor.rgb, vec3( 0.04045 ) ) ) ), sampledDiffuseColor.w );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,gz=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,vz=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,yz=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	uniform mat3 uvTransform;
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,xz=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Az=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,bz=`#if defined( USE_MORPHCOLORS ) && defined( MORPHTARGETS_TEXTURE )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,_z=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		objectNormal += morphNormal0 * morphTargetInfluences[ 0 ];
		objectNormal += morphNormal1 * morphTargetInfluences[ 1 ];
		objectNormal += morphNormal2 * morphTargetInfluences[ 2 ];
		objectNormal += morphNormal3 * morphTargetInfluences[ 3 ];
	#endif
#endif`,wz=`#ifdef USE_MORPHTARGETS
	uniform float morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
		uniform sampler2DArray morphTargetsTexture;
		uniform ivec2 morphTargetsTextureSize;
		vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
			int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
			int y = texelIndex / morphTargetsTextureSize.x;
			int x = texelIndex - y * morphTargetsTextureSize.x;
			ivec3 morphUV = ivec3( x, y, morphTargetIndex );
			return texelFetch( morphTargetsTexture, morphUV, 0 );
		}
	#else
		#ifndef USE_MORPHNORMALS
			uniform float morphTargetInfluences[ 8 ];
		#else
			uniform float morphTargetInfluences[ 4 ];
		#endif
	#endif
#endif`,Ez=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	#ifdef MORPHTARGETS_TEXTURE
		for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
			if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
		}
	#else
		transformed += morphTarget0 * morphTargetInfluences[ 0 ];
		transformed += morphTarget1 * morphTargetInfluences[ 1 ];
		transformed += morphTarget2 * morphTargetInfluences[ 2 ];
		transformed += morphTarget3 * morphTargetInfluences[ 3 ];
		#ifndef USE_MORPHNORMALS
			transformed += morphTarget4 * morphTargetInfluences[ 4 ];
			transformed += morphTarget5 * morphTargetInfluences[ 5 ];
			transformed += morphTarget6 * morphTargetInfluences[ 6 ];
			transformed += morphTarget7 * morphTargetInfluences[ 7 ];
		#endif
	#endif
#endif`,Mz=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );
	vec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	#ifdef USE_TANGENT
		vec3 tangent = normalize( vTangent );
		vec3 bitangent = normalize( vBitangent );
		#ifdef DOUBLE_SIDED
			tangent = tangent * faceDirection;
			bitangent = bitangent * faceDirection;
		#endif
		#if defined( TANGENTSPACE_NORMALMAP ) || defined( USE_CLEARCOAT_NORMALMAP )
			mat3 vTBN = mat3( tangent, bitangent, normal );
		#endif
	#endif
#endif
vec3 geometryNormal = normal;`,Sz=`#ifdef OBJECTSPACE_NORMALMAP
	normal = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( TANGENTSPACE_NORMALMAP )
	vec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	#ifdef USE_TANGENT
		normal = normalize( vTBN * mapN );
	#else
		normal = perturbNormal2Arb( - vViewPosition, normal, mapN, faceDirection );
	#endif
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,Tz=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Cz=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Rz=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Lz=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef OBJECTSPACE_NORMALMAP
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( TANGENTSPACE_NORMALMAP ) || defined ( USE_CLEARCOAT_NORMALMAP ) )
	vec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm, vec3 mapN, float faceDirection ) {
		vec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );
		vec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );
		vec2 st0 = dFdx( vUv.st );
		vec2 st1 = dFdy( vUv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : faceDirection * inversesqrt( det );
		return normalize( T * ( mapN.x * scale ) + B * ( mapN.y * scale ) + N * mapN.z );
	}
#endif`,Pz=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = geometryNormal;
#endif`,Iz=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	#ifdef USE_TANGENT
		clearcoatNormal = normalize( vTBN * clearcoatMapN );
	#else
		clearcoatNormal = perturbNormal2Arb( - vViewPosition, clearcoatNormal, clearcoatMapN, faceDirection );
	#endif
#endif`,Oz=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif`,Dz=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Bz=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= transmissionAlpha + 0.1;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,Fz=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;
const vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256., 256. );
const vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );
const float ShiftRight8 = 1. / 256.;
vec4 packDepthToRGBA( const in float v ) {
	vec4 r = vec4( fract( v * PackFactors ), v );
	r.yzw -= r.xyz * ShiftRight8;	return r * PackUpscale;
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors );
}
vec4 pack2HalfToRGBA( vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {
	return linearClipZ * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * invClipZ - far );
}`,Nz=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Uz=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,kz=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,zz=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Hz=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vUv );
	roughnessFactor *= texelRoughness.g;
#endif`,Gz=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,Vz=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );
		bool inFrustum = all( inFrustumVec );
		bvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );
		bool frustumTest = all( frustumTestVec );
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ), 
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ), 
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return shadow;
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
		vec3 lightToPosition = shadowCoord.xyz;
		float dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );		dp += shadowBias;
		vec3 bd3D = normalize( lightToPosition );
		#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
			vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
			return (
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
				texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
			) * ( 1.0 / 9.0 );
		#else
			return texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
		#endif
	}
#endif`,Wz=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHT_SHADOWS ];
		varying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,jz=`#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0 || NUM_SPOT_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0
		vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		vec4 shadowWorldPosition;
	#endif
	#if NUM_DIR_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
		vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias, 0 );
		vSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
		vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
	#endif
#endif`,Xz=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,$z=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,qz=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	uniform int boneTextureSize;
	mat4 getBoneMatrix( const in float i ) {
		float j = i * 4.0;
		float x = mod( j, float( boneTextureSize ) );
		float y = floor( j / float( boneTextureSize ) );
		float dx = 1.0 / float( boneTextureSize );
		float dy = 1.0 / float( boneTextureSize );
		y = dy * ( y + 0.5 );
		vec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );
		vec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );
		vec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );
		vec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );
		mat4 bone = mat4( v1, v2, v3, v4 );
		return bone;
	}
#endif`,Yz=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,Qz=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,Kz=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,Zz=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,Jz=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,e7=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return toneMappingExposure * color;
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 OptimizedCineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,t7=`#ifdef USE_TRANSMISSION
	float transmissionAlpha = 1.0;
	float transmissionFactor = transmission;
	float thicknessFactor = thickness;
	#ifdef USE_TRANSMISSIONMAP
		transmissionFactor *= texture2D( transmissionMap, vUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		thicknessFactor *= texture2D( thicknessMap, vUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmission = getIBLVolumeRefraction(
		n, v, roughnessFactor, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, ior, thicknessFactor,
		attenuationColor, attenuationDistance );
	totalDiffuse = mix( totalDiffuse, transmission.rgb, transmissionFactor );
	transmissionAlpha = mix( transmissionAlpha, transmission.a, transmissionFactor );
#endif`,n7=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float framebufferLod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		#ifdef texture2DLodEXT
			return texture2DLodEXT( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#else
			return texture2D( transmissionSamplerMap, fragCoord.xy, framebufferLod );
		#endif
	}
	vec3 applyVolumeAttenuation( const in vec3 radiance, const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( attenuationDistance == 0.0 ) {
			return radiance;
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance * radiance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
		vec3 refractedRayExit = position + transmissionRay;
		vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
		vec2 refractionCoords = ndcPos.xy / ndcPos.w;
		refractionCoords += 1.0;
		refractionCoords /= 2.0;
		vec4 transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
		vec3 attenuatedColor = applyVolumeAttenuation( transmittedLight.rgb, length( transmissionRay ), attenuationColor, attenuationDistance );
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		return vec4( ( 1.0 - F ) * attenuatedColor * diffuseColor, transmittedLight.a );
	}
#endif`,i7=`#if ( defined( USE_UV ) && ! defined( UVS_VERTEX_ONLY ) )
	varying vec2 vUv;
#endif`,r7=`#ifdef USE_UV
	#ifdef UVS_VERTEX_ONLY
		vec2 vUv;
	#else
		varying vec2 vUv;
	#endif
	uniform mat3 uvTransform;
#endif`,s7=`#ifdef USE_UV
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
#endif`,o7=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	varying vec2 vUv2;
#endif`,a7=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	attribute vec2 uv2;
	varying vec2 vUv2;
	uniform mat3 uv2Transform;
#endif`,l7=`#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )
	vUv2 = ( uv2Transform * vec3( uv2, 1 ) ).xy;
#endif`,c7=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION )
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const u7=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,h7=`uniform sampler2D t2D;
varying vec2 vUv;
void main() {
	gl_FragColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		gl_FragColor = vec4( mix( pow( gl_FragColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), gl_FragColor.rgb * 0.0773993808, vec3( lessThanEqual( gl_FragColor.rgb, vec3( 0.04045 ) ) ) ), gl_FragColor.w );
	#endif
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,f7=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,d7=`#include <envmap_common_pars_fragment>
uniform float opacity;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	vec3 vReflect = vWorldDirection;
	#include <envmap_fragment>
	gl_FragColor = envColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,p7=`#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,m7=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#endif
}`,g7=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <skinbase_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,v7=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( 1.0 );
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,y7=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,x7=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
}`,A7=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,b7=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,_7=`#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,w7=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vUv2 );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,E7=`#define LAMBERT
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <envmap_pars_vertex>
#include <bsdfs>
#include <lights_pars_begin>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <lights_lambert_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,M7=`uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
varying vec3 vLightFront;
varying vec3 vIndirectFront;
#ifdef DOUBLE_SIDED
	varying vec3 vLightBack;
	varying vec3 vIndirectBack;
#endif
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <fog_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <emissivemap_fragment>
	#ifdef DOUBLE_SIDED
		reflectedLight.indirectDiffuse += ( gl_FrontFacing ) ? vIndirectFront : vIndirectBack;
	#else
		reflectedLight.indirectDiffuse += vIndirectFront;
	#endif
	#include <lightmap_fragment>
	reflectedLight.indirectDiffuse *= BRDF_Lambert( diffuseColor.rgb );
	#ifdef DOUBLE_SIDED
		reflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;
	#else
		reflectedLight.directDiffuse = vLightFront;
	#endif
	reflectedLight.directDiffuse *= BRDF_Lambert( diffuseColor.rgb ) * getShadowMask();
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,S7=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,T7=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,C7=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	vViewPosition = - mvPosition.xyz;
#endif
}`,R7=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( TANGENTSPACE_NORMALMAP )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), opacity );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,L7=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,P7=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <cube_uv_reflection_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,I7=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,O7=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULARINTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
	#ifdef USE_SPECULARCOLORMAP
		uniform sampler2D specularColorMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEENCOLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEENROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <bsdfs>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecular;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometry.clearcoatNormal, geometry.viewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + clearcoatSpecular * material.clearcoat;
	#endif
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,D7=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <uv_pars_vertex>
#include <uv2_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <uv2_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,B7=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <uv2_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec4 diffuseColor = vec4( diffuse, opacity );
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,F7=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,N7=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,U7=`#include <common>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,k7=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,z7=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );
	vec2 scale;
	scale.x = length( vec3( modelMatrix[ 0 ].x, modelMatrix[ 0 ].y, modelMatrix[ 0 ].z ) );
	scale.y = length( vec3( modelMatrix[ 1 ].x, modelMatrix[ 1 ].y, modelMatrix[ 1 ].z ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,H7=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <output_fragment>
	#include <tonemapping_fragment>
	#include <encodings_fragment>
	#include <fog_fragment>
}`,Ui={alphamap_fragment:dk,alphamap_pars_fragment:pk,alphatest_fragment:mk,alphatest_pars_fragment:gk,aomap_fragment:vk,aomap_pars_fragment:yk,begin_vertex:xk,beginnormal_vertex:Ak,bsdfs:bk,iridescence_fragment:_k,bumpmap_pars_fragment:wk,clipping_planes_fragment:Ek,clipping_planes_pars_fragment:Mk,clipping_planes_pars_vertex:Sk,clipping_planes_vertex:Tk,color_fragment:Ck,color_pars_fragment:Rk,color_pars_vertex:Lk,color_vertex:Pk,common:Ik,cube_uv_reflection_fragment:Ok,defaultnormal_vertex:Dk,displacementmap_pars_vertex:Bk,displacementmap_vertex:Fk,emissivemap_fragment:Nk,emissivemap_pars_fragment:Uk,encodings_fragment:kk,encodings_pars_fragment:zk,envmap_fragment:Hk,envmap_common_pars_fragment:Gk,envmap_pars_fragment:Vk,envmap_pars_vertex:Wk,envmap_physical_pars_fragment:tz,envmap_vertex:jk,fog_vertex:Xk,fog_pars_vertex:$k,fog_fragment:qk,fog_pars_fragment:Yk,gradientmap_pars_fragment:Qk,lightmap_fragment:Kk,lightmap_pars_fragment:Zk,lights_lambert_vertex:Jk,lights_pars_begin:ez,lights_toon_fragment:nz,lights_toon_pars_fragment:iz,lights_phong_fragment:rz,lights_phong_pars_fragment:sz,lights_physical_fragment:oz,lights_physical_pars_fragment:az,lights_fragment_begin:lz,lights_fragment_maps:cz,lights_fragment_end:uz,logdepthbuf_fragment:hz,logdepthbuf_pars_fragment:fz,logdepthbuf_pars_vertex:dz,logdepthbuf_vertex:pz,map_fragment:mz,map_pars_fragment:gz,map_particle_fragment:vz,map_particle_pars_fragment:yz,metalnessmap_fragment:xz,metalnessmap_pars_fragment:Az,morphcolor_vertex:bz,morphnormal_vertex:_z,morphtarget_pars_vertex:wz,morphtarget_vertex:Ez,normal_fragment_begin:Mz,normal_fragment_maps:Sz,normal_pars_fragment:Tz,normal_pars_vertex:Cz,normal_vertex:Rz,normalmap_pars_fragment:Lz,clearcoat_normal_fragment_begin:Pz,clearcoat_normal_fragment_maps:Iz,clearcoat_pars_fragment:Oz,iridescence_pars_fragment:Dz,output_fragment:Bz,packing:Fz,premultiplied_alpha_fragment:Nz,project_vertex:Uz,dithering_fragment:kz,dithering_pars_fragment:zz,roughnessmap_fragment:Hz,roughnessmap_pars_fragment:Gz,shadowmap_pars_fragment:Vz,shadowmap_pars_vertex:Wz,shadowmap_vertex:jz,shadowmask_pars_fragment:Xz,skinbase_vertex:$z,skinning_pars_vertex:qz,skinning_vertex:Yz,skinnormal_vertex:Qz,specularmap_fragment:Kz,specularmap_pars_fragment:Zz,tonemapping_fragment:Jz,tonemapping_pars_fragment:e7,transmission_fragment:t7,transmission_pars_fragment:n7,uv_pars_fragment:i7,uv_pars_vertex:r7,uv_vertex:s7,uv2_pars_fragment:o7,uv2_pars_vertex:a7,uv2_vertex:l7,worldpos_vertex:c7,background_vert:u7,background_frag:h7,cube_vert:f7,cube_frag:d7,depth_vert:p7,depth_frag:m7,distanceRGBA_vert:g7,distanceRGBA_frag:v7,equirect_vert:y7,equirect_frag:x7,linedashed_vert:A7,linedashed_frag:b7,meshbasic_vert:_7,meshbasic_frag:w7,meshlambert_vert:E7,meshlambert_frag:M7,meshmatcap_vert:S7,meshmatcap_frag:T7,meshnormal_vert:C7,meshnormal_frag:R7,meshphong_vert:L7,meshphong_frag:P7,meshphysical_vert:I7,meshphysical_frag:O7,meshtoon_vert:D7,meshtoon_frag:B7,points_vert:F7,points_frag:N7,shadow_vert:U7,shadow_frag:k7,sprite_vert:z7,sprite_frag:H7},Fn={common:{diffuse:{value:new qn(16777215)},opacity:{value:1},map:{value:null},uvTransform:{value:new Ho},uv2Transform:{value:new Ho},alphaMap:{value:null},alphaTest:{value:0}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new yn(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new qn(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new qn(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Ho}},sprite:{diffuse:{value:new qn(16777215)},opacity:{value:1},center:{value:new yn(.5,.5)},rotation:{value:0},map:{value:null},alphaMap:{value:null},alphaTest:{value:0},uvTransform:{value:new Ho}}},ua={basic:{uniforms:Us([Fn.common,Fn.specularmap,Fn.envmap,Fn.aomap,Fn.lightmap,Fn.fog]),vertexShader:Ui.meshbasic_vert,fragmentShader:Ui.meshbasic_frag},lambert:{uniforms:Us([Fn.common,Fn.specularmap,Fn.envmap,Fn.aomap,Fn.lightmap,Fn.emissivemap,Fn.fog,Fn.lights,{emissive:{value:new qn(0)}}]),vertexShader:Ui.meshlambert_vert,fragmentShader:Ui.meshlambert_frag},phong:{uniforms:Us([Fn.common,Fn.specularmap,Fn.envmap,Fn.aomap,Fn.lightmap,Fn.emissivemap,Fn.bumpmap,Fn.normalmap,Fn.displacementmap,Fn.fog,Fn.lights,{emissive:{value:new qn(0)},specular:{value:new qn(1118481)},shininess:{value:30}}]),vertexShader:Ui.meshphong_vert,fragmentShader:Ui.meshphong_frag},standard:{uniforms:Us([Fn.common,Fn.envmap,Fn.aomap,Fn.lightmap,Fn.emissivemap,Fn.bumpmap,Fn.normalmap,Fn.displacementmap,Fn.roughnessmap,Fn.metalnessmap,Fn.fog,Fn.lights,{emissive:{value:new qn(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Ui.meshphysical_vert,fragmentShader:Ui.meshphysical_frag},toon:{uniforms:Us([Fn.common,Fn.aomap,Fn.lightmap,Fn.emissivemap,Fn.bumpmap,Fn.normalmap,Fn.displacementmap,Fn.gradientmap,Fn.fog,Fn.lights,{emissive:{value:new qn(0)}}]),vertexShader:Ui.meshtoon_vert,fragmentShader:Ui.meshtoon_frag},matcap:{uniforms:Us([Fn.common,Fn.bumpmap,Fn.normalmap,Fn.displacementmap,Fn.fog,{matcap:{value:null}}]),vertexShader:Ui.meshmatcap_vert,fragmentShader:Ui.meshmatcap_frag},points:{uniforms:Us([Fn.points,Fn.fog]),vertexShader:Ui.points_vert,fragmentShader:Ui.points_frag},dashed:{uniforms:Us([Fn.common,Fn.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Ui.linedashed_vert,fragmentShader:Ui.linedashed_frag},depth:{uniforms:Us([Fn.common,Fn.displacementmap]),vertexShader:Ui.depth_vert,fragmentShader:Ui.depth_frag},normal:{uniforms:Us([Fn.common,Fn.bumpmap,Fn.normalmap,Fn.displacementmap,{opacity:{value:1}}]),vertexShader:Ui.meshnormal_vert,fragmentShader:Ui.meshnormal_frag},sprite:{uniforms:Us([Fn.sprite,Fn.fog]),vertexShader:Ui.sprite_vert,fragmentShader:Ui.sprite_frag},background:{uniforms:{uvTransform:{value:new Ho},t2D:{value:null}},vertexShader:Ui.background_vert,fragmentShader:Ui.background_frag},cube:{uniforms:Us([Fn.envmap,{opacity:{value:1}}]),vertexShader:Ui.cube_vert,fragmentShader:Ui.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Ui.equirect_vert,fragmentShader:Ui.equirect_frag},distanceRGBA:{uniforms:Us([Fn.common,Fn.displacementmap,{referencePosition:{value:new Ze},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Ui.distanceRGBA_vert,fragmentShader:Ui.distanceRGBA_frag},shadow:{uniforms:Us([Fn.lights,Fn.fog,{color:{value:new qn(0)},opacity:{value:1}}]),vertexShader:Ui.shadow_vert,fragmentShader:Ui.shadow_frag}};ua.physical={uniforms:Us([ua.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatNormalScale:{value:new yn(1,1)},clearcoatNormalMap:{value:null},iridescence:{value:0},iridescenceMap:{value:null},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},sheen:{value:0},sheenColor:{value:new qn(0)},sheenColorMap:{value:null},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},transmission:{value:0},transmissionMap:{value:null},transmissionSamplerSize:{value:new yn},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},attenuationDistance:{value:0},attenuationColor:{value:new qn(0)},specularIntensity:{value:1},specularIntensityMap:{value:null},specularColor:{value:new qn(1,1,1)},specularColorMap:{value:null}}]),vertexShader:Ui.meshphysical_vert,fragmentShader:Ui.meshphysical_frag};function G7(a,t,n,i,o,s){const c=new qn(0);let u=o===!0?0:1,h,f,p=null,m=0,y=null;function g(x,b){let E=!1,T=b.isScene===!0?b.background:null;T&&T.isTexture&&(T=t.get(T));const P=a.xr,D=P.getSession&&P.getSession();D&&D.environmentBlendMode==="additive"&&(T=null),T===null?_(c,u):T&&T.isColor&&(_(T,1),E=!0),(a.autoClear||E)&&a.clear(a.autoClearColor,a.autoClearDepth,a.autoClearStencil),T&&(T.isCubeTexture||T.mapping===Fd)?(f===void 0&&(f=new Ss(new zl(1,1,1),new Ya({name:"BackgroundCubeMaterial",uniforms:ad(ua.cube.uniforms),vertexShader:ua.cube.vertexShader,fragmentShader:ua.cube.fragmentShader,side:To,depthTest:!1,depthWrite:!1,fog:!1})),f.geometry.deleteAttribute("normal"),f.geometry.deleteAttribute("uv"),f.onBeforeRender=function(F,k,W){this.matrixWorld.copyPosition(W.matrixWorld)},Object.defineProperty(f.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(f)),f.material.uniforms.envMap.value=T,f.material.uniforms.flipEnvMap.value=T.isCubeTexture&&T.isRenderTargetTexture===!1?-1:1,(p!==T||m!==T.version||y!==a.toneMapping)&&(f.material.needsUpdate=!0,p=T,m=T.version,y=a.toneMapping),f.layers.enableAll(),x.unshift(f,f.geometry,f.material,0,0,null)):T&&T.isTexture&&(h===void 0&&(h=new Ss(new ph(2,2),new Ya({name:"BackgroundMaterial",uniforms:ad(ua.background.uniforms),vertexShader:ua.background.vertexShader,fragmentShader:ua.background.fragmentShader,side:hh,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),Object.defineProperty(h.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(h)),h.material.uniforms.t2D.value=T,T.matrixAutoUpdate===!0&&T.updateMatrix(),h.material.uniforms.uvTransform.value.copy(T.matrix),(p!==T||m!==T.version||y!==a.toneMapping)&&(h.material.needsUpdate=!0,p=T,m=T.version,y=a.toneMapping),h.layers.enableAll(),x.unshift(h,h.geometry,h.material,0,0,null))}function _(x,b){n.buffers.color.setClear(x.r,x.g,x.b,b,s)}return{getClearColor:function(){return c},setClearColor:function(x,b=1){c.set(x),u=b,_(c,u)},getClearAlpha:function(){return u},setClearAlpha:function(x){u=x,_(c,u)},render:g}}function V7(a,t,n,i){const o=a.getParameter(34921),s=i.isWebGL2?null:t.get("OES_vertex_array_object"),c=i.isWebGL2||s!==null,u={},h=b(null);let f=h,p=!1;function m(M,I,U,$,ee){let Q=!1;if(c){const G=x($,U,I);f!==G&&(f=G,g(f.object)),Q=E(M,$,U,ee),Q&&T(M,$,U,ee)}else{const G=I.wireframe===!0;(f.geometry!==$.id||f.program!==U.id||f.wireframe!==G)&&(f.geometry=$.id,f.program=U.id,f.wireframe=G,Q=!0)}ee!==null&&n.update(ee,34963),(Q||p)&&(p=!1,j(M,I,U,$),ee!==null&&a.bindBuffer(34963,n.get(ee).buffer))}function y(){return i.isWebGL2?a.createVertexArray():s.createVertexArrayOES()}function g(M){return i.isWebGL2?a.bindVertexArray(M):s.bindVertexArrayOES(M)}function _(M){return i.isWebGL2?a.deleteVertexArray(M):s.deleteVertexArrayOES(M)}function x(M,I,U){const $=U.wireframe===!0;let ee=u[M.id];ee===void 0&&(ee={},u[M.id]=ee);let Q=ee[I.id];Q===void 0&&(Q={},ee[I.id]=Q);let G=Q[$];return G===void 0&&(G=b(y()),Q[$]=G),G}function b(M){const I=[],U=[],$=[];for(let ee=0;ee<o;ee++)I[ee]=0,U[ee]=0,$[ee]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:I,enabledAttributes:U,attributeDivisors:$,object:M,attributes:{},index:null}}function E(M,I,U,$){const ee=f.attributes,Q=I.attributes;let G=0;const K=U.getAttributes();for(const Y in K)if(K[Y].location>=0){const Ke=ee[Y];let ge=Q[Y];if(ge===void 0&&(Y==="instanceMatrix"&&M.instanceMatrix&&(ge=M.instanceMatrix),Y==="instanceColor"&&M.instanceColor&&(ge=M.instanceColor)),Ke===void 0||Ke.attribute!==ge||ge&&Ke.data!==ge.data)return!0;G++}return f.attributesNum!==G||f.index!==$}function T(M,I,U,$){const ee={},Q=I.attributes;let G=0;const K=U.getAttributes();for(const Y in K)if(K[Y].location>=0){let Ke=Q[Y];Ke===void 0&&(Y==="instanceMatrix"&&M.instanceMatrix&&(Ke=M.instanceMatrix),Y==="instanceColor"&&M.instanceColor&&(Ke=M.instanceColor));const ge={};ge.attribute=Ke,Ke&&Ke.data&&(ge.data=Ke.data),ee[Y]=ge,G++}f.attributes=ee,f.attributesNum=G,f.index=$}function P(){const M=f.newAttributes;for(let I=0,U=M.length;I<U;I++)M[I]=0}function D(M){F(M,0)}function F(M,I){const U=f.newAttributes,$=f.enabledAttributes,ee=f.attributeDivisors;U[M]=1,$[M]===0&&(a.enableVertexAttribArray(M),$[M]=1),ee[M]!==I&&((i.isWebGL2?a:t.get("ANGLE_instanced_arrays"))[i.isWebGL2?"vertexAttribDivisor":"vertexAttribDivisorANGLE"](M,I),ee[M]=I)}function k(){const M=f.newAttributes,I=f.enabledAttributes;for(let U=0,$=I.length;U<$;U++)I[U]!==M[U]&&(a.disableVertexAttribArray(U),I[U]=0)}function W(M,I,U,$,ee,Q){i.isWebGL2===!0&&(U===5124||U===5125)?a.vertexAttribIPointer(M,I,U,ee,Q):a.vertexAttribPointer(M,I,U,$,ee,Q)}function j(M,I,U,$){if(i.isWebGL2===!1&&(M.isInstancedMesh||$.isInstancedBufferGeometry)&&t.get("ANGLE_instanced_arrays")===null)return;P();const ee=$.attributes,Q=U.getAttributes(),G=I.defaultAttributeValues;for(const K in Q){const Y=Q[K];if(Y.location>=0){let we=ee[K];if(we===void 0&&(K==="instanceMatrix"&&M.instanceMatrix&&(we=M.instanceMatrix),K==="instanceColor"&&M.instanceColor&&(we=M.instanceColor)),we!==void 0){const Ke=we.normalized,ge=we.itemSize,me=n.get(we);if(me===void 0)continue;const De=me.buffer,ze=me.type,tt=me.bytesPerElement;if(we.isInterleavedBufferAttribute){const rt=we.data,vt=rt.stride,Ye=we.offset;if(rt.isInstancedInterleavedBuffer){for(let Pe=0;Pe<Y.locationSize;Pe++)F(Y.location+Pe,rt.meshPerAttribute);M.isInstancedMesh!==!0&&$._maxInstanceCount===void 0&&($._maxInstanceCount=rt.meshPerAttribute*rt.count)}else for(let Pe=0;Pe<Y.locationSize;Pe++)D(Y.location+Pe);a.bindBuffer(34962,De);for(let Pe=0;Pe<Y.locationSize;Pe++)W(Y.location+Pe,ge/Y.locationSize,ze,Ke,vt*tt,(Ye+ge/Y.locationSize*Pe)*tt)}else{if(we.isInstancedBufferAttribute){for(let rt=0;rt<Y.locationSize;rt++)F(Y.location+rt,we.meshPerAttribute);M.isInstancedMesh!==!0&&$._maxInstanceCount===void 0&&($._maxInstanceCount=we.meshPerAttribute*we.count)}else for(let rt=0;rt<Y.locationSize;rt++)D(Y.location+rt);a.bindBuffer(34962,De);for(let rt=0;rt<Y.locationSize;rt++)W(Y.location+rt,ge/Y.locationSize,ze,Ke,ge*tt,ge/Y.locationSize*rt*tt)}}else if(G!==void 0){const Ke=G[K];if(Ke!==void 0)switch(Ke.length){case 2:a.vertexAttrib2fv(Y.location,Ke);break;case 3:a.vertexAttrib3fv(Y.location,Ke);break;case 4:a.vertexAttrib4fv(Y.location,Ke);break;default:a.vertexAttrib1fv(Y.location,Ke)}}}}k()}function J(){N();for(const M in u){const I=u[M];for(const U in I){const $=I[U];for(const ee in $)_($[ee].object),delete $[ee];delete I[U]}delete u[M]}}function de(M){if(u[M.id]===void 0)return;const I=u[M.id];for(const U in I){const $=I[U];for(const ee in $)_($[ee].object),delete $[ee];delete I[U]}delete u[M.id]}function te(M){for(const I in u){const U=u[I];if(U[M.id]===void 0)continue;const $=U[M.id];for(const ee in $)_($[ee].object),delete $[ee];delete U[M.id]}}function N(){L(),p=!0,f!==h&&(f=h,g(f.object))}function L(){h.geometry=null,h.program=null,h.wireframe=!1}return{setup:m,reset:N,resetDefaultState:L,dispose:J,releaseStatesOfGeometry:de,releaseStatesOfProgram:te,initAttributes:P,enableAttribute:D,disableUnusedAttributes:k}}function W7(a,t,n,i){const o=i.isWebGL2;let s;function c(f){s=f}function u(f,p){a.drawArrays(s,f,p),n.update(p,s,1)}function h(f,p,m){if(m===0)return;let y,g;if(o)y=a,g="drawArraysInstanced";else if(y=t.get("ANGLE_instanced_arrays"),g="drawArraysInstancedANGLE",y===null){console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}y[g](s,f,p,m),n.update(p,s,m)}this.setMode=c,this.render=u,this.renderInstances=h}function j7(a,t,n){let i;function o(){if(i!==void 0)return i;if(t.has("EXT_texture_filter_anisotropic")===!0){const W=t.get("EXT_texture_filter_anisotropic");i=a.getParameter(W.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function s(W){if(W==="highp"){if(a.getShaderPrecisionFormat(35633,36338).precision>0&&a.getShaderPrecisionFormat(35632,36338).precision>0)return"highp";W="mediump"}return W==="mediump"&&a.getShaderPrecisionFormat(35633,36337).precision>0&&a.getShaderPrecisionFormat(35632,36337).precision>0?"mediump":"lowp"}const c=typeof WebGL2RenderingContext!="undefined"&&a instanceof WebGL2RenderingContext||typeof WebGL2ComputeRenderingContext!="undefined"&&a instanceof WebGL2ComputeRenderingContext;let u=n.precision!==void 0?n.precision:"highp";const h=s(u);h!==u&&(console.warn("THREE.WebGLRenderer:",u,"not supported, using",h,"instead."),u=h);const f=c||t.has("WEBGL_draw_buffers"),p=n.logarithmicDepthBuffer===!0,m=a.getParameter(34930),y=a.getParameter(35660),g=a.getParameter(3379),_=a.getParameter(34076),x=a.getParameter(34921),b=a.getParameter(36347),E=a.getParameter(36348),T=a.getParameter(36349),P=y>0,D=c||t.has("OES_texture_float"),F=P&&D,k=c?a.getParameter(36183):0;return{isWebGL2:c,drawBuffers:f,getMaxAnisotropy:o,getMaxPrecision:s,precision:u,logarithmicDepthBuffer:p,maxTextures:m,maxVertexTextures:y,maxTextureSize:g,maxCubemapSize:_,maxAttributes:x,maxVertexUniforms:b,maxVaryings:E,maxFragmentUniforms:T,vertexTextures:P,floatFragmentTextures:D,floatVertexTextures:F,maxSamples:k}}function X7(a){const t=this;let n=null,i=0,o=!1,s=!1;const c=new Mc,u=new Ho,h={value:null,needsUpdate:!1};this.uniform=h,this.numPlanes=0,this.numIntersection=0,this.init=function(m,y,g){const _=m.length!==0||y||i!==0||o;return o=y,n=p(m,g,0),i=m.length,_},this.beginShadows=function(){s=!0,p(null)},this.endShadows=function(){s=!1,f()},this.setState=function(m,y,g){const _=m.clippingPlanes,x=m.clipIntersection,b=m.clipShadows,E=a.get(m);if(!o||_===null||_.length===0||s&&!b)s?p(null):f();else{const T=s?0:i,P=T*4;let D=E.clippingState||null;h.value=D,D=p(_,y,P,g);for(let F=0;F!==P;++F)D[F]=n[F];E.clippingState=D,this.numIntersection=x?this.numPlanes:0,this.numPlanes+=T}};function f(){h.value!==n&&(h.value=n,h.needsUpdate=i>0),t.numPlanes=i,t.numIntersection=0}function p(m,y,g,_){const x=m!==null?m.length:0;let b=null;if(x!==0){if(b=h.value,_!==!0||b===null){const E=g+x*4,T=y.matrixWorldInverse;u.getNormalMatrix(T),(b===null||b.length<E)&&(b=new Float32Array(E));for(let P=0,D=g;P!==x;++P,D+=4)c.copy(m[P]).applyMatrix4(T,u),c.normal.toArray(b,D),b[D+3]=c.constant}h.value=b,h.needsUpdate=!0}return t.numPlanes=x,t.numIntersection=0,b}}function $7(a){let t=new WeakMap;function n(c,u){return u===dm?c.mapping=kc:u===pm&&(c.mapping=zc),c}function i(c){if(c&&c.isTexture&&c.isRenderTargetTexture===!1){const u=c.mapping;if(u===dm||u===pm)if(t.has(c)){const h=t.get(c).texture;return n(h,c.mapping)}else{const h=c.image;if(h&&h.height>0){const f=new gR(h.height/2);return f.fromEquirectangularTexture(a,c),t.set(c,f),c.addEventListener("dispose",o),n(f.texture,c.mapping)}else return null}}return c}function o(c){const u=c.target;u.removeEventListener("dispose",o);const h=t.get(u);h!==void 0&&(t.delete(u),h.dispose())}function s(){t=new WeakMap}return{get:i,dispose:s}}class gy extends py{constructor(t=-1,n=1,i=1,o=-1,s=.1,c=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=n,this.top=i,this.bottom=o,this.near=s,this.far=c,this.updateProjectionMatrix()}copy(t,n){return super.copy(t,n),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=t.view===null?null:Object.assign({},t.view),this}setViewOffset(t,n,i,o,s,c){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=n,this.view.offsetX=i,this.view.offsetY=o,this.view.width=s,this.view.height=c,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),n=(this.top-this.bottom)/(2*this.zoom),i=(this.right+this.left)/2,o=(this.top+this.bottom)/2;let s=i-t,c=i+t,u=o+n,h=o-n;if(this.view!==null&&this.view.enabled){const f=(this.right-this.left)/this.view.fullWidth/this.zoom,p=(this.top-this.bottom)/this.view.fullHeight/this.zoom;s+=f*this.view.offsetX,c=s+f*this.view.width,u-=p*this.view.offsetY,h=u-p*this.view.height}this.projectionMatrix.makeOrthographic(s,c,u,h,this.near,this.far),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const n=super.toJSON(t);return n.object.zoom=this.zoom,n.object.left=this.left,n.object.right=this.right,n.object.top=this.top,n.object.bottom=this.bottom,n.object.near=this.near,n.object.far=this.far,this.view!==null&&(n.object.view=Object.assign({},this.view)),n}}const Yf=4,pS=[.125,.215,.35,.446,.526,.582],$u=20,oA=new gy,mS=new qn;let aA=null;const Vu=(1+Math.sqrt(5))/2,Uf=1/Vu,gS=[new Ze(1,1,1),new Ze(-1,1,1),new Ze(1,1,-1),new Ze(-1,1,-1),new Ze(0,Vu,Uf),new Ze(0,Vu,-Uf),new Ze(Uf,0,Vu),new Ze(-Uf,0,Vu),new Ze(Vu,Uf,0),new Ze(-Vu,Uf,0)];class Ob{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(t,n=0,i=.1,o=100){aA=this._renderer.getRenderTarget(),this._setSize(256);const s=this._allocateTargets();return s.depthBuffer=!0,this._sceneToCubeUV(t,i,o,s),n>0&&this._blur(s,0,0,n),this._applyPMREM(s),this._cleanup(s),s}fromEquirectangular(t,n=null){return this._fromTexture(t,n)}fromCubemap(t,n=null){return this._fromTexture(t,n)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=xS(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=yS(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(t){this._lodMax=Math.floor(Math.log2(t)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let t=0;t<this._lodPlanes.length;t++)this._lodPlanes[t].dispose()}_cleanup(t){this._renderer.setRenderTarget(aA),t.scissorTest=!1,Ug(t,0,0,t.width,t.height)}_fromTexture(t,n){t.mapping===kc||t.mapping===zc?this._setSize(t.image.length===0?16:t.image[0].width||t.image[0].image.width):this._setSize(t.image.width/4),aA=this._renderer.getRenderTarget();const i=n||this._allocateTargets();return this._textureToCubeUV(t,i),this._applyPMREM(i),this._cleanup(i),i}_allocateTargets(){const t=3*Math.max(this._cubeSize,112),n=4*this._cubeSize,i={magFilter:Vr,minFilter:Vr,generateMipmaps:!1,type:od,format:Mo,encoding:Gc,depthBuffer:!1},o=vS(t,n,i);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==t){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=vS(t,n,i);const{_lodMax:s}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=q7(s)),this._blurMaterial=Y7(s,t,n)}return o}_compileMaterial(t){const n=new Ss(this._lodPlanes[0],t);this._renderer.compile(n,oA)}_sceneToCubeUV(t,n,i,o){const u=new Es(90,1,n,i),h=[1,-1,1,1,1,1],f=[1,1,1,-1,-1,-1],p=this._renderer,m=p.autoClear,y=p.toneMapping;p.getClearColor(mS),p.toneMapping=za,p.autoClear=!1;const g=new qc({name:"PMREM.Background",side:To,depthWrite:!1,depthTest:!1}),_=new Ss(new zl,g);let x=!1;const b=t.background;b?b.isColor&&(g.color.copy(b),t.background=null,x=!0):(g.color.copy(mS),x=!0);for(let E=0;E<6;E++){const T=E%3;T===0?(u.up.set(0,h[E],0),u.lookAt(f[E],0,0)):T===1?(u.up.set(0,0,h[E]),u.lookAt(0,f[E],0)):(u.up.set(0,h[E],0),u.lookAt(0,0,f[E]));const P=this._cubeSize;Ug(o,T*P,E>2?P:0,P,P),p.setRenderTarget(o),x&&p.render(_,u),p.render(t,u)}_.geometry.dispose(),_.material.dispose(),p.toneMapping=y,p.autoClear=m,t.background=b}_textureToCubeUV(t,n){const i=this._renderer,o=t.mapping===kc||t.mapping===zc;o?(this._cubemapMaterial===null&&(this._cubemapMaterial=xS()),this._cubemapMaterial.uniforms.flipEnvMap.value=t.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=yS());const s=o?this._cubemapMaterial:this._equirectMaterial,c=new Ss(this._lodPlanes[0],s),u=s.uniforms;u.envMap.value=t;const h=this._cubeSize;Ug(n,0,0,3*h,2*h),i.setRenderTarget(n),i.render(c,oA)}_applyPMREM(t){const n=this._renderer,i=n.autoClear;n.autoClear=!1;for(let o=1;o<this._lodPlanes.length;o++){const s=Math.sqrt(this._sigmas[o]*this._sigmas[o]-this._sigmas[o-1]*this._sigmas[o-1]),c=gS[(o-1)%gS.length];this._blur(t,o-1,o,s,c)}n.autoClear=i}_blur(t,n,i,o,s){const c=this._pingPongRenderTarget;this._halfBlur(t,c,n,i,o,"latitudinal",s),this._halfBlur(c,t,i,i,o,"longitudinal",s)}_halfBlur(t,n,i,o,s,c,u){const h=this._renderer,f=this._blurMaterial;c!=="latitudinal"&&c!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const p=3,m=new Ss(this._lodPlanes[o],f),y=f.uniforms,g=this._sizeLods[i]-1,_=isFinite(s)?Math.PI/(2*g):2*Math.PI/(2*$u-1),x=s/_,b=isFinite(s)?1+Math.floor(p*x):$u;b>$u&&console.warn(`sigmaRadians, ${s}, is too large and will clip, as it requested ${b} samples when the maximum is set to ${$u}`);const E=[];let T=0;for(let W=0;W<$u;++W){const j=W/x,J=Math.exp(-j*j/2);E.push(J),W===0?T+=J:W<b&&(T+=2*J)}for(let W=0;W<E.length;W++)E[W]=E[W]/T;y.envMap.value=t.texture,y.samples.value=b,y.weights.value=E,y.latitudinal.value=c==="latitudinal",u&&(y.poleAxis.value=u);const{_lodMax:P}=this;y.dTheta.value=_,y.mipInt.value=P-i;const D=this._sizeLods[o],F=3*D*(o>P-Yf?o-P+Yf:0),k=4*(this._cubeSize-D);Ug(n,F,k,3*D,2*D),h.setRenderTarget(n),h.render(m,oA)}}function q7(a){const t=[],n=[],i=[];let o=a;const s=a-Yf+1+pS.length;for(let c=0;c<s;c++){const u=Math.pow(2,o);n.push(u);let h=1/u;c>a-Yf?h=pS[c-a+Yf-1]:c===0&&(h=0),i.push(h);const f=1/(u-2),p=-f,m=1+f,y=[p,p,m,p,m,m,p,p,m,m,p,m],g=6,_=6,x=3,b=2,E=1,T=new Float32Array(x*_*g),P=new Float32Array(b*_*g),D=new Float32Array(E*_*g);for(let k=0;k<g;k++){const W=k%3*2/3-1,j=k>2?0:-1,J=[W,j,0,W+2/3,j,0,W+2/3,j+1,0,W,j,0,W+2/3,j+1,0,W,j+1,0];T.set(J,x*_*k),P.set(y,b*_*k);const de=[k,k,k,k,k,k];D.set(de,E*_*k)}const F=new Ii;F.setAttribute("position",new mr(T,x)),F.setAttribute("uv",new mr(P,b)),F.setAttribute("faceIndex",new mr(D,E)),t.push(F),o>Yf&&o--}return{lodPlanes:t,sizeLods:n,sigmas:i}}function vS(a,t,n){const i=new Ro(a,t,n);return i.texture.mapping=Fd,i.texture.name="PMREM.cubeUv",i.scissorTest=!0,i}function Ug(a,t,n,i,o){a.viewport.set(t,n,i,o),a.scissor.set(t,n,i,o)}function Y7(a,t,n){const i=new Float32Array($u),o=new Ze(0,1,0);return new Ya({name:"SphericalGaussianBlur",defines:{n:$u,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/n,CUBEUV_MAX_MIP:`${a}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:i},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:o}},vertexShader:D_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Ul,depthTest:!1,depthWrite:!1})}function yS(){return new Ya({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:D_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Ul,depthTest:!1,depthWrite:!1})}function xS(){return new Ya({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:D_(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Ul,depthTest:!1,depthWrite:!1})}function D_(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function Q7(a){let t=new WeakMap,n=null;function i(u){if(u&&u.isTexture){const h=u.mapping,f=h===dm||h===pm,p=h===kc||h===zc;if(f||p)if(u.isRenderTargetTexture&&u.needsPMREMUpdate===!0){u.needsPMREMUpdate=!1;let m=t.get(u);return n===null&&(n=new Ob(a)),m=f?n.fromEquirectangular(u,m):n.fromCubemap(u,m),t.set(u,m),m.texture}else{if(t.has(u))return t.get(u).texture;{const m=u.image;if(f&&m&&m.height>0||p&&m&&o(m)){n===null&&(n=new Ob(a));const y=f?n.fromEquirectangular(u):n.fromCubemap(u);return t.set(u,y),u.addEventListener("dispose",s),y.texture}else return null}}}return u}function o(u){let h=0;const f=6;for(let p=0;p<f;p++)u[p]!==void 0&&h++;return h===f}function s(u){const h=u.target;h.removeEventListener("dispose",s);const f=t.get(h);f!==void 0&&(t.delete(h),f.dispose())}function c(){t=new WeakMap,n!==null&&(n.dispose(),n=null)}return{get:i,dispose:c}}function K7(a){const t={};function n(i){if(t[i]!==void 0)return t[i];let o;switch(i){case"WEBGL_depth_texture":o=a.getExtension("WEBGL_depth_texture")||a.getExtension("MOZ_WEBGL_depth_texture")||a.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":o=a.getExtension("EXT_texture_filter_anisotropic")||a.getExtension("MOZ_EXT_texture_filter_anisotropic")||a.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":o=a.getExtension("WEBGL_compressed_texture_s3tc")||a.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":o=a.getExtension("WEBGL_compressed_texture_pvrtc")||a.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:o=a.getExtension(i)}return t[i]=o,o}return{has:function(i){return n(i)!==null},init:function(i){i.isWebGL2?n("EXT_color_buffer_float"):(n("WEBGL_depth_texture"),n("OES_texture_float"),n("OES_texture_half_float"),n("OES_texture_half_float_linear"),n("OES_standard_derivatives"),n("OES_element_index_uint"),n("OES_vertex_array_object"),n("ANGLE_instanced_arrays")),n("OES_texture_float_linear"),n("EXT_color_buffer_half_float"),n("WEBGL_multisampled_render_to_texture")},get:function(i){const o=n(i);return o===null&&console.warn("THREE.WebGLRenderer: "+i+" extension not supported."),o}}}function Z7(a,t,n,i){const o={},s=new WeakMap;function c(m){const y=m.target;y.index!==null&&t.remove(y.index);for(const _ in y.attributes)t.remove(y.attributes[_]);y.removeEventListener("dispose",c),delete o[y.id];const g=s.get(y);g&&(t.remove(g),s.delete(y)),i.releaseStatesOfGeometry(y),y.isInstancedBufferGeometry===!0&&delete y._maxInstanceCount,n.memory.geometries--}function u(m,y){return o[y.id]===!0||(y.addEventListener("dispose",c),o[y.id]=!0,n.memory.geometries++),y}function h(m){const y=m.attributes;for(const _ in y)t.update(y[_],34962);const g=m.morphAttributes;for(const _ in g){const x=g[_];for(let b=0,E=x.length;b<E;b++)t.update(x[b],34962)}}function f(m){const y=[],g=m.index,_=m.attributes.position;let x=0;if(g!==null){const T=g.array;x=g.version;for(let P=0,D=T.length;P<D;P+=3){const F=T[P+0],k=T[P+1],W=T[P+2];y.push(F,k,k,W,W,F)}}else{const T=_.array;x=_.version;for(let P=0,D=T.length/3-1;P<D;P+=3){const F=P+0,k=P+1,W=P+2;y.push(F,k,k,W,W,F)}}const b=new(fR(y)?O_:I_)(y,1);b.version=x;const E=s.get(m);E&&t.remove(E),s.set(m,b)}function p(m){const y=s.get(m);if(y){const g=m.index;g!==null&&y.version<g.version&&f(m)}else f(m);return s.get(m)}return{get:u,update:h,getWireframeAttribute:p}}function J7(a,t,n,i){const o=i.isWebGL2;let s;function c(y){s=y}let u,h;function f(y){u=y.type,h=y.bytesPerElement}function p(y,g){a.drawElements(s,g,u,y*h),n.update(g,s,1)}function m(y,g,_){if(_===0)return;let x,b;if(o)x=a,b="drawElementsInstanced";else if(x=t.get("ANGLE_instanced_arrays"),b="drawElementsInstancedANGLE",x===null){console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");return}x[b](s,g,u,y*h,_),n.update(g,s,_)}this.setMode=c,this.setIndex=f,this.render=p,this.renderInstances=m}function e9(a){const t={geometries:0,textures:0},n={frame:0,calls:0,triangles:0,points:0,lines:0};function i(s,c,u){switch(n.calls++,c){case 4:n.triangles+=u*(s/3);break;case 1:n.lines+=u*(s/2);break;case 3:n.lines+=u*(s-1);break;case 2:n.lines+=u*s;break;case 0:n.points+=u*s;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",c);break}}function o(){n.frame++,n.calls=0,n.triangles=0,n.points=0,n.lines=0}return{memory:t,render:n,programs:null,autoReset:!0,reset:o,update:i}}function t9(a,t){return a[0]-t[0]}function n9(a,t){return Math.abs(t[1])-Math.abs(a[1])}function lA(a,t){let n=1;const i=t.isInterleavedBufferAttribute?t.data.array:t.array;i instanceof Int8Array?n=127:i instanceof Int16Array?n=32767:i instanceof Int32Array?n=2147483647:console.error("THREE.WebGLMorphtargets: Unsupported morph attribute data type: ",i),a.divideScalar(n)}function i9(a,t,n){const i={},o=new Float32Array(8),s=new WeakMap,c=new ur,u=[];for(let f=0;f<8;f++)u[f]=[f,0];function h(f,p,m,y){const g=f.morphTargetInfluences;if(t.isWebGL2===!0){const x=p.morphAttributes.position||p.morphAttributes.normal||p.morphAttributes.color,b=x!==void 0?x.length:0;let E=s.get(p);if(E===void 0||E.count!==b){let U=function(){M.dispose(),s.delete(p),p.removeEventListener("dispose",U)};var _=U;E!==void 0&&E.texture.dispose();const D=p.morphAttributes.position!==void 0,F=p.morphAttributes.normal!==void 0,k=p.morphAttributes.color!==void 0,W=p.morphAttributes.position||[],j=p.morphAttributes.normal||[],J=p.morphAttributes.color||[];let de=0;D===!0&&(de=1),F===!0&&(de=2),k===!0&&(de=3);let te=p.attributes.position.count*de,N=1;te>t.maxTextureSize&&(N=Math.ceil(te/t.maxTextureSize),te=t.maxTextureSize);const L=new Float32Array(te*N*4*b),M=new Bm(L,te,N,b);M.type=Bl,M.needsUpdate=!0;const I=de*4;for(let $=0;$<b;$++){const ee=W[$],Q=j[$],G=J[$],K=te*N*4*$;for(let Y=0;Y<ee.count;Y++){const we=Y*I;D===!0&&(c.fromBufferAttribute(ee,Y),ee.normalized===!0&&lA(c,ee),L[K+we+0]=c.x,L[K+we+1]=c.y,L[K+we+2]=c.z,L[K+we+3]=0),F===!0&&(c.fromBufferAttribute(Q,Y),Q.normalized===!0&&lA(c,Q),L[K+we+4]=c.x,L[K+we+5]=c.y,L[K+we+6]=c.z,L[K+we+7]=0),k===!0&&(c.fromBufferAttribute(G,Y),G.normalized===!0&&lA(c,G),L[K+we+8]=c.x,L[K+we+9]=c.y,L[K+we+10]=c.z,L[K+we+11]=G.itemSize===4?c.w:1)}}E={count:b,texture:M,size:new yn(te,N)},s.set(p,E),p.addEventListener("dispose",U)}let T=0;for(let D=0;D<g.length;D++)T+=g[D];const P=p.morphTargetsRelative?1:1-T;y.getUniforms().setValue(a,"morphTargetBaseInfluence",P),y.getUniforms().setValue(a,"morphTargetInfluences",g),y.getUniforms().setValue(a,"morphTargetsTexture",E.texture,n),y.getUniforms().setValue(a,"morphTargetsTextureSize",E.size)}else{const x=g===void 0?0:g.length;let b=i[p.id];if(b===void 0||b.length!==x){b=[];for(let F=0;F<x;F++)b[F]=[F,0];i[p.id]=b}for(let F=0;F<x;F++){const k=b[F];k[0]=F,k[1]=g[F]}b.sort(n9);for(let F=0;F<8;F++)F<x&&b[F][1]?(u[F][0]=b[F][0],u[F][1]=b[F][1]):(u[F][0]=Number.MAX_SAFE_INTEGER,u[F][1]=0);u.sort(t9);const E=p.morphAttributes.position,T=p.morphAttributes.normal;let P=0;for(let F=0;F<8;F++){const k=u[F],W=k[0],j=k[1];W!==Number.MAX_SAFE_INTEGER&&j?(E&&p.getAttribute("morphTarget"+F)!==E[W]&&p.setAttribute("morphTarget"+F,E[W]),T&&p.getAttribute("morphNormal"+F)!==T[W]&&p.setAttribute("morphNormal"+F,T[W]),o[F]=j,P+=j):(E&&p.hasAttribute("morphTarget"+F)===!0&&p.deleteAttribute("morphTarget"+F),T&&p.hasAttribute("morphNormal"+F)===!0&&p.deleteAttribute("morphNormal"+F),o[F]=0)}const D=p.morphTargetsRelative?1:1-P;y.getUniforms().setValue(a,"morphTargetBaseInfluence",D),y.getUniforms().setValue(a,"morphTargetInfluences",o)}}return{update:h}}function r9(a,t,n,i){let o=new WeakMap;function s(h){const f=i.render.frame,p=h.geometry,m=t.get(h,p);return o.get(m)!==f&&(t.update(m),o.set(m,f)),h.isInstancedMesh&&(h.hasEventListener("dispose",u)===!1&&h.addEventListener("dispose",u),n.update(h.instanceMatrix,34962),h.instanceColor!==null&&n.update(h.instanceColor,34962)),m}function c(){o=new WeakMap}function u(h){const f=h.target;f.removeEventListener("dispose",u),n.remove(f.instanceMatrix),f.instanceColor!==null&&n.remove(f.instanceColor)}return{update:s,dispose:c}}const yR=new is,xR=new Bm,AR=new fy,bR=new Nm,AS=[],bS=[],_S=new Float32Array(16),wS=new Float32Array(9),ES=new Float32Array(4);function Ud(a,t,n){const i=a[0];if(i<=0||i>0)return a;const o=t*n;let s=AS[o];if(s===void 0&&(s=new Float32Array(o),AS[o]=s),t!==0){i.toArray(s,0);for(let c=1,u=0;c!==t;++c)u+=n,a[c].toArray(s,u)}return s}function eo(a,t){if(a.length!==t.length)return!1;for(let n=0,i=a.length;n<i;n++)if(a[n]!==t[n])return!1;return!0}function to(a,t){for(let n=0,i=t.length;n<i;n++)a[n]=t[n]}function vy(a,t){let n=bS[t];n===void 0&&(n=new Int32Array(t),bS[t]=n);for(let i=0;i!==t;++i)n[i]=a.allocateTextureUnit();return n}function s9(a,t){const n=this.cache;n[0]!==t&&(a.uniform1f(this.addr,t),n[0]=t)}function o9(a,t){const n=this.cache;if(t.x!==void 0)(n[0]!==t.x||n[1]!==t.y)&&(a.uniform2f(this.addr,t.x,t.y),n[0]=t.x,n[1]=t.y);else{if(eo(n,t))return;a.uniform2fv(this.addr,t),to(n,t)}}function a9(a,t){const n=this.cache;if(t.x!==void 0)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z)&&(a.uniform3f(this.addr,t.x,t.y,t.z),n[0]=t.x,n[1]=t.y,n[2]=t.z);else if(t.r!==void 0)(n[0]!==t.r||n[1]!==t.g||n[2]!==t.b)&&(a.uniform3f(this.addr,t.r,t.g,t.b),n[0]=t.r,n[1]=t.g,n[2]=t.b);else{if(eo(n,t))return;a.uniform3fv(this.addr,t),to(n,t)}}function l9(a,t){const n=this.cache;if(t.x!==void 0)(n[0]!==t.x||n[1]!==t.y||n[2]!==t.z||n[3]!==t.w)&&(a.uniform4f(this.addr,t.x,t.y,t.z,t.w),n[0]=t.x,n[1]=t.y,n[2]=t.z,n[3]=t.w);else{if(eo(n,t))return;a.uniform4fv(this.addr,t),to(n,t)}}function c9(a,t){const n=this.cache,i=t.elements;if(i===void 0){if(eo(n,t))return;a.uniformMatrix2fv(this.addr,!1,t),to(n,t)}else{if(eo(n,i))return;ES.set(i),a.uniformMatrix2fv(this.addr,!1,ES),to(n,i)}}function u9(a,t){const n=this.cache,i=t.elements;if(i===void 0){if(eo(n,t))return;a.uniformMatrix3fv(this.addr,!1,t),to(n,t)}else{if(eo(n,i))return;wS.set(i),a.uniformMatrix3fv(this.addr,!1,wS),to(n,i)}}function h9(a,t){const n=this.cache,i=t.elements;if(i===void 0){if(eo(n,t))return;a.uniformMatrix4fv(this.addr,!1,t),to(n,t)}else{if(eo(n,i))return;_S.set(i),a.uniformMatrix4fv(this.addr,!1,_S),to(n,i)}}function f9(a,t){const n=this.cache;n[0]!==t&&(a.uniform1i(this.addr,t),n[0]=t)}function d9(a,t){const n=this.cache;eo(n,t)||(a.uniform2iv(this.addr,t),to(n,t))}function p9(a,t){const n=this.cache;eo(n,t)||(a.uniform3iv(this.addr,t),to(n,t))}function m9(a,t){const n=this.cache;eo(n,t)||(a.uniform4iv(this.addr,t),to(n,t))}function g9(a,t){const n=this.cache;n[0]!==t&&(a.uniform1ui(this.addr,t),n[0]=t)}function v9(a,t){const n=this.cache;eo(n,t)||(a.uniform2uiv(this.addr,t),to(n,t))}function y9(a,t){const n=this.cache;eo(n,t)||(a.uniform3uiv(this.addr,t),to(n,t))}function x9(a,t){const n=this.cache;eo(n,t)||(a.uniform4uiv(this.addr,t),to(n,t))}function A9(a,t,n){const i=this.cache,o=n.allocateTextureUnit();i[0]!==o&&(a.uniform1i(this.addr,o),i[0]=o),n.setTexture2D(t||yR,o)}function b9(a,t,n){const i=this.cache,o=n.allocateTextureUnit();i[0]!==o&&(a.uniform1i(this.addr,o),i[0]=o),n.setTexture3D(t||AR,o)}function _9(a,t,n){const i=this.cache,o=n.allocateTextureUnit();i[0]!==o&&(a.uniform1i(this.addr,o),i[0]=o),n.setTextureCube(t||bR,o)}function w9(a,t,n){const i=this.cache,o=n.allocateTextureUnit();i[0]!==o&&(a.uniform1i(this.addr,o),i[0]=o),n.setTexture2DArray(t||xR,o)}function E9(a){switch(a){case 5126:return s9;case 35664:return o9;case 35665:return a9;case 35666:return l9;case 35674:return c9;case 35675:return u9;case 35676:return h9;case 5124:case 35670:return f9;case 35667:case 35671:return d9;case 35668:case 35672:return p9;case 35669:case 35673:return m9;case 5125:return g9;case 36294:return v9;case 36295:return y9;case 36296:return x9;case 35678:case 36198:case 36298:case 36306:case 35682:return A9;case 35679:case 36299:case 36307:return b9;case 35680:case 36300:case 36308:case 36293:return _9;case 36289:case 36303:case 36311:case 36292:return w9}}function M9(a,t){a.uniform1fv(this.addr,t)}function S9(a,t){const n=Ud(t,this.size,2);a.uniform2fv(this.addr,n)}function T9(a,t){const n=Ud(t,this.size,3);a.uniform3fv(this.addr,n)}function C9(a,t){const n=Ud(t,this.size,4);a.uniform4fv(this.addr,n)}function R9(a,t){const n=Ud(t,this.size,4);a.uniformMatrix2fv(this.addr,!1,n)}function L9(a,t){const n=Ud(t,this.size,9);a.uniformMatrix3fv(this.addr,!1,n)}function P9(a,t){const n=Ud(t,this.size,16);a.uniformMatrix4fv(this.addr,!1,n)}function I9(a,t){a.uniform1iv(this.addr,t)}function O9(a,t){a.uniform2iv(this.addr,t)}function D9(a,t){a.uniform3iv(this.addr,t)}function B9(a,t){a.uniform4iv(this.addr,t)}function F9(a,t){a.uniform1uiv(this.addr,t)}function N9(a,t){a.uniform2uiv(this.addr,t)}function U9(a,t){a.uniform3uiv(this.addr,t)}function k9(a,t){a.uniform4uiv(this.addr,t)}function z9(a,t,n){const i=t.length,o=vy(n,i);a.uniform1iv(this.addr,o);for(let s=0;s!==i;++s)n.setTexture2D(t[s]||yR,o[s])}function H9(a,t,n){const i=t.length,o=vy(n,i);a.uniform1iv(this.addr,o);for(let s=0;s!==i;++s)n.setTexture3D(t[s]||AR,o[s])}function G9(a,t,n){const i=t.length,o=vy(n,i);a.uniform1iv(this.addr,o);for(let s=0;s!==i;++s)n.setTextureCube(t[s]||bR,o[s])}function V9(a,t,n){const i=t.length,o=vy(n,i);a.uniform1iv(this.addr,o);for(let s=0;s!==i;++s)n.setTexture2DArray(t[s]||xR,o[s])}function W9(a){switch(a){case 5126:return M9;case 35664:return S9;case 35665:return T9;case 35666:return C9;case 35674:return R9;case 35675:return L9;case 35676:return P9;case 5124:case 35670:return I9;case 35667:case 35671:return O9;case 35668:case 35672:return D9;case 35669:case 35673:return B9;case 5125:return F9;case 36294:return N9;case 36295:return U9;case 36296:return k9;case 35678:case 36198:case 36298:case 36306:case 35682:return z9;case 35679:case 36299:case 36307:return H9;case 35680:case 36300:case 36308:case 36293:return G9;case 36289:case 36303:case 36311:case 36292:return V9}}class j9{constructor(t,n,i){this.id=t,this.addr=i,this.cache=[],this.setValue=E9(n.type)}}class X9{constructor(t,n,i){this.id=t,this.addr=i,this.cache=[],this.size=n.size,this.setValue=W9(n.type)}}class $9{constructor(t){this.id=t,this.seq=[],this.map={}}setValue(t,n,i){const o=this.seq;for(let s=0,c=o.length;s!==c;++s){const u=o[s];u.setValue(t,n[u.id],i)}}}const cA=/(\w+)(\])?(\[|\.)?/g;function MS(a,t){a.seq.push(t),a.map[t.id]=t}function q9(a,t,n){const i=a.name,o=i.length;for(cA.lastIndex=0;;){const s=cA.exec(i),c=cA.lastIndex;let u=s[1];const h=s[2]==="]",f=s[3];if(h&&(u=u|0),f===void 0||f==="["&&c+2===o){MS(n,f===void 0?new j9(u,a,t):new X9(u,a,t));break}else{let m=n.map[u];m===void 0&&(m=new $9(u),MS(n,m)),n=m}}}class Av{constructor(t,n){this.seq=[],this.map={};const i=t.getProgramParameter(n,35718);for(let o=0;o<i;++o){const s=t.getActiveUniform(n,o),c=t.getUniformLocation(n,s.name);q9(s,c,this)}}setValue(t,n,i,o){const s=this.map[n];s!==void 0&&s.setValue(t,i,o)}setOptional(t,n,i){const o=n[i];o!==void 0&&this.setValue(t,i,o)}static upload(t,n,i,o){for(let s=0,c=n.length;s!==c;++s){const u=n[s],h=i[u.id];h.needsUpdate!==!1&&u.setValue(t,h.value,o)}}static seqWithValue(t,n){const i=[];for(let o=0,s=t.length;o!==s;++o){const c=t[o];c.id in n&&i.push(c)}return i}}function SS(a,t,n){const i=a.createShader(t);return a.shaderSource(i,n),a.compileShader(i),i}let Y9=0;function Q9(a,t){const n=a.split(`
`),i=[],o=Math.max(t-6,0),s=Math.min(t+6,n.length);for(let c=o;c<s;c++){const u=c+1;i.push(`${u===t?">":" "} ${u}: ${n[c]}`)}return i.join(`
`)}function K9(a){switch(a){case Gc:return["Linear","( value )"];case _r:return["sRGB","( value )"];default:return console.warn("THREE.WebGLProgram: Unsupported encoding:",a),["Linear","( value )"]}}function TS(a,t,n){const i=a.getShaderParameter(t,35713),o=a.getShaderInfoLog(t).trim();if(i&&o==="")return"";const s=/ERROR: 0:(\d+)/.exec(o);if(s){const c=parseInt(s[1]);return n.toUpperCase()+`

`+o+`

`+Q9(a.getShaderSource(t),c)}else return o}function Z9(a,t){const n=K9(t);return"vec4 "+a+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function J9(a,t){let n;switch(t){case UC:n="Linear";break;case kC:n="Reinhard";break;case zC:n="OptimizedCineon";break;case HC:n="ACESFilmic";break;case GC:n="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),n="Linear"}return"vec3 "+a+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function eH(a){return[a.extensionDerivatives||!!a.envMapCubeUVHeight||a.bumpMap||a.tangentSpaceNormalMap||a.clearcoatNormalMap||a.flatShading||a.shaderID==="physical"?"#extension GL_OES_standard_derivatives : enable":"",(a.extensionFragDepth||a.logarithmicDepthBuffer)&&a.rendererExtensionFragDepth?"#extension GL_EXT_frag_depth : enable":"",a.extensionDrawBuffers&&a.rendererExtensionDrawBuffers?"#extension GL_EXT_draw_buffers : require":"",(a.extensionShaderTextureLOD||a.envMap||a.transmission)&&a.rendererExtensionShaderTextureLod?"#extension GL_EXT_shader_texture_lod : enable":""].filter(qp).join(`
`)}function tH(a){const t=[];for(const n in a){const i=a[n];i!==!1&&t.push("#define "+n+" "+i)}return t.join(`
`)}function nH(a,t){const n={},i=a.getProgramParameter(t,35721);for(let o=0;o<i;o++){const s=a.getActiveAttrib(t,o),c=s.name;let u=1;s.type===35674&&(u=2),s.type===35675&&(u=3),s.type===35676&&(u=4),n[c]={type:s.type,location:a.getAttribLocation(t,c),locationSize:u}}return n}function qp(a){return a!==""}function CS(a,t){return a.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function RS(a,t){return a.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const iH=/^[ \t]*#include +<([\w\d./]+)>/gm;function Db(a){return a.replace(iH,rH)}function rH(a,t){const n=Ui[t];if(n===void 0)throw new Error("Can not resolve #include <"+t+">");return Db(n)}const sH=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g,oH=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function LS(a){return a.replace(oH,_R).replace(sH,aH)}function aH(a,t,n,i){return console.warn("WebGLProgram: #pragma unroll_loop shader syntax is deprecated. Please use #pragma unroll_loop_start syntax instead."),_R(a,t,n,i)}function _R(a,t,n,i){let o="";for(let s=parseInt(t);s<parseInt(n);s++)o+=i.replace(/\[\s*i\s*\]/g,"[ "+s+" ]").replace(/UNROLLED_LOOP_INDEX/g,s);return o}function PS(a){let t="precision "+a.precision+` float;
precision `+a.precision+" int;";return a.precision==="highp"?t+=`
#define HIGH_PRECISION`:a.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:a.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function lH(a){let t="SHADOWMAP_TYPE_BASIC";return a.shadowMapType===E_?t="SHADOWMAP_TYPE_PCF":a.shadowMapType===mC?t="SHADOWMAP_TYPE_PCF_SOFT":a.shadowMapType===$f&&(t="SHADOWMAP_TYPE_VSM"),t}function cH(a){let t="ENVMAP_TYPE_CUBE";if(a.envMap)switch(a.envMapMode){case kc:case zc:t="ENVMAP_TYPE_CUBE";break;case Fd:t="ENVMAP_TYPE_CUBE_UV";break}return t}function uH(a){let t="ENVMAP_MODE_REFLECTION";if(a.envMap)switch(a.envMapMode){case zc:t="ENVMAP_MODE_REFRACTION";break}return t}function hH(a){let t="ENVMAP_BLENDING_NONE";if(a.envMap)switch(a.combine){case Dm:t="ENVMAP_BLENDING_MULTIPLY";break;case FC:t="ENVMAP_BLENDING_MIX";break;case NC:t="ENVMAP_BLENDING_ADD";break}return t}function fH(a){const t=a.envMapCubeUVHeight;if(t===null)return null;const n=Math.log2(t)-2,i=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,n),7*16)),texelHeight:i,maxMip:n}}function dH(a,t,n,i){const o=a.getContext(),s=n.defines;let c=n.vertexShader,u=n.fragmentShader;const h=lH(n),f=cH(n),p=uH(n),m=hH(n),y=fH(n),g=n.isWebGL2?"":eH(n),_=tH(s),x=o.createProgram();let b,E,T=n.glslVersion?"#version "+n.glslVersion+`
`:"";n.isRawShaderMaterial?(b=[_].filter(qp).join(`
`),b.length>0&&(b+=`
`),E=[g,_].filter(qp).join(`
`),E.length>0&&(E+=`
`)):(b=[PS(n),"#define SHADER_NAME "+n.shaderName,_,n.instancing?"#define USE_INSTANCING":"",n.instancingColor?"#define USE_INSTANCING_COLOR":"",n.supportsVertexTextures?"#define VERTEX_TEXTURES":"",n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+p:"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.displacementMap&&n.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.flatShading?"#define FLAT_SHADED":"",n.skinning?"#define USE_SKINNING":"",n.morphTargets?"#define USE_MORPHTARGETS":"",n.morphNormals&&n.flatShading===!1?"#define USE_MORPHNORMALS":"",n.morphColors&&n.isWebGL2?"#define USE_MORPHCOLORS":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE":"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_TEXTURE_STRIDE "+n.morphTextureStride:"",n.morphTargetsCount>0&&n.isWebGL2?"#define MORPHTARGETS_COUNT "+n.morphTargetsCount:"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+h:"",n.sizeAttenuation?"#define USE_SIZEATTENUATION":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#if ( defined( USE_MORPHTARGETS ) && ! defined( MORPHTARGETS_TEXTURE ) )","	attribute vec3 morphTarget0;","	attribute vec3 morphTarget1;","	attribute vec3 morphTarget2;","	attribute vec3 morphTarget3;","	#ifdef USE_MORPHNORMALS","		attribute vec3 morphNormal0;","		attribute vec3 morphNormal1;","		attribute vec3 morphNormal2;","		attribute vec3 morphNormal3;","	#else","		attribute vec3 morphTarget4;","		attribute vec3 morphTarget5;","		attribute vec3 morphTarget6;","		attribute vec3 morphTarget7;","	#endif","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(qp).join(`
`),E=[g,PS(n),"#define SHADER_NAME "+n.shaderName,_,n.useFog&&n.fog?"#define USE_FOG":"",n.useFog&&n.fogExp2?"#define FOG_EXP2":"",n.map?"#define USE_MAP":"",n.matcap?"#define USE_MATCAP":"",n.envMap?"#define USE_ENVMAP":"",n.envMap?"#define "+f:"",n.envMap?"#define "+p:"",n.envMap?"#define "+m:"",y?"#define CUBEUV_TEXEL_WIDTH "+y.texelWidth:"",y?"#define CUBEUV_TEXEL_HEIGHT "+y.texelHeight:"",y?"#define CUBEUV_MAX_MIP "+y.maxMip+".0":"",n.lightMap?"#define USE_LIGHTMAP":"",n.aoMap?"#define USE_AOMAP":"",n.emissiveMap?"#define USE_EMISSIVEMAP":"",n.bumpMap?"#define USE_BUMPMAP":"",n.normalMap?"#define USE_NORMALMAP":"",n.normalMap&&n.objectSpaceNormalMap?"#define OBJECTSPACE_NORMALMAP":"",n.normalMap&&n.tangentSpaceNormalMap?"#define TANGENTSPACE_NORMALMAP":"",n.clearcoat?"#define USE_CLEARCOAT":"",n.clearcoatMap?"#define USE_CLEARCOATMAP":"",n.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",n.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",n.iridescence?"#define USE_IRIDESCENCE":"",n.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",n.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",n.specularMap?"#define USE_SPECULARMAP":"",n.specularIntensityMap?"#define USE_SPECULARINTENSITYMAP":"",n.specularColorMap?"#define USE_SPECULARCOLORMAP":"",n.roughnessMap?"#define USE_ROUGHNESSMAP":"",n.metalnessMap?"#define USE_METALNESSMAP":"",n.alphaMap?"#define USE_ALPHAMAP":"",n.alphaTest?"#define USE_ALPHATEST":"",n.sheen?"#define USE_SHEEN":"",n.sheenColorMap?"#define USE_SHEENCOLORMAP":"",n.sheenRoughnessMap?"#define USE_SHEENROUGHNESSMAP":"",n.transmission?"#define USE_TRANSMISSION":"",n.transmissionMap?"#define USE_TRANSMISSIONMAP":"",n.thicknessMap?"#define USE_THICKNESSMAP":"",n.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",n.vertexTangents?"#define USE_TANGENT":"",n.vertexColors||n.instancingColor?"#define USE_COLOR":"",n.vertexAlphas?"#define USE_COLOR_ALPHA":"",n.vertexUvs?"#define USE_UV":"",n.uvsVertexOnly?"#define UVS_VERTEX_ONLY":"",n.gradientMap?"#define USE_GRADIENTMAP":"",n.flatShading?"#define FLAT_SHADED":"",n.doubleSided?"#define DOUBLE_SIDED":"",n.flipSided?"#define FLIP_SIDED":"",n.shadowMapEnabled?"#define USE_SHADOWMAP":"",n.shadowMapEnabled?"#define "+h:"",n.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",n.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",n.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",n.logarithmicDepthBuffer&&n.rendererExtensionFragDepth?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",n.toneMapping!==za?"#define TONE_MAPPING":"",n.toneMapping!==za?Ui.tonemapping_pars_fragment:"",n.toneMapping!==za?J9("toneMapping",n.toneMapping):"",n.dithering?"#define DITHERING":"",n.opaque?"#define OPAQUE":"",Ui.encodings_pars_fragment,Z9("linearToOutputTexel",n.outputEncoding),n.useDepthPacking?"#define DEPTH_PACKING "+n.depthPacking:"",`
`].filter(qp).join(`
`)),c=Db(c),c=CS(c,n),c=RS(c,n),u=Db(u),u=CS(u,n),u=RS(u,n),c=LS(c),u=LS(u),n.isWebGL2&&n.isRawShaderMaterial!==!0&&(T=`#version 300 es
`,b=["precision mediump sampler2DArray;","#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+b,E=["#define varying in",n.glslVersion===Pb?"":"layout(location = 0) out highp vec4 pc_fragColor;",n.glslVersion===Pb?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+E);const P=T+b+c,D=T+E+u,F=SS(o,35633,P),k=SS(o,35632,D);if(o.attachShader(x,F),o.attachShader(x,k),n.index0AttributeName!==void 0?o.bindAttribLocation(x,0,n.index0AttributeName):n.morphTargets===!0&&o.bindAttribLocation(x,0,"position"),o.linkProgram(x),a.debug.checkShaderErrors){const J=o.getProgramInfoLog(x).trim(),de=o.getShaderInfoLog(F).trim(),te=o.getShaderInfoLog(k).trim();let N=!0,L=!0;if(o.getProgramParameter(x,35714)===!1){N=!1;const M=TS(o,F,"vertex"),I=TS(o,k,"fragment");console.error("THREE.WebGLProgram: Shader Error "+o.getError()+" - VALIDATE_STATUS "+o.getProgramParameter(x,35715)+`

Program Info Log: `+J+`
`+M+`
`+I)}else J!==""?console.warn("THREE.WebGLProgram: Program Info Log:",J):(de===""||te==="")&&(L=!1);L&&(this.diagnostics={runnable:N,programLog:J,vertexShader:{log:de,prefix:b},fragmentShader:{log:te,prefix:E}})}o.deleteShader(F),o.deleteShader(k);let W;this.getUniforms=function(){return W===void 0&&(W=new Av(o,x)),W};let j;return this.getAttributes=function(){return j===void 0&&(j=nH(o,x)),j},this.destroy=function(){i.releaseStatesOfProgram(this),o.deleteProgram(x),this.program=void 0},this.name=n.shaderName,this.id=Y9++,this.cacheKey=t,this.usedTimes=1,this.program=x,this.vertexShader=F,this.fragmentShader=k,this}let pH=0;class mH{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){const n=t.vertexShader,i=t.fragmentShader,o=this._getShaderStage(n),s=this._getShaderStage(i),c=this._getShaderCacheForMaterial(t);return c.has(o)===!1&&(c.add(o),o.usedTimes++),c.has(s)===!1&&(c.add(s),s.usedTimes++),this}remove(t){const n=this.materialCache.get(t);for(const i of n)i.usedTimes--,i.usedTimes===0&&this.shaderCache.delete(i.code);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){const n=this.materialCache;return n.has(t)===!1&&n.set(t,new Set),n.get(t)}_getShaderStage(t){const n=this.shaderCache;if(n.has(t)===!1){const i=new gH(t);n.set(t,i)}return n.get(t)}}class gH{constructor(t){this.id=pH++,this.code=t,this.usedTimes=0}}function vH(a,t,n,i,o,s,c){const u=new dy,h=new mH,f=[],p=o.isWebGL2,m=o.logarithmicDepthBuffer,y=o.vertexTextures;let g=o.precision;const _={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function x(j,J,de,te,N){const L=te.fog,M=N.geometry,I=j.isMeshStandardMaterial?te.environment:null,U=(j.isMeshStandardMaterial?n:t).get(j.envMap||I),$=!!U&&U.mapping===Fd?U.image.height:null,ee=_[j.type];j.precision!==null&&(g=o.getMaxPrecision(j.precision),g!==j.precision&&console.warn("THREE.WebGLProgram.getParameters:",j.precision,"not supported, using",g,"instead."));const Q=M.morphAttributes.position||M.morphAttributes.normal||M.morphAttributes.color,G=Q!==void 0?Q.length:0;let K=0;M.morphAttributes.position!==void 0&&(K=1),M.morphAttributes.normal!==void 0&&(K=2),M.morphAttributes.color!==void 0&&(K=3);let Y,we,Ke,ge;if(ee){const vt=ua[ee];Y=vt.vertexShader,we=vt.fragmentShader}else Y=j.vertexShader,we=j.fragmentShader,h.update(j),Ke=h.getVertexShaderID(j),ge=h.getFragmentShaderID(j);const me=a.getRenderTarget(),De=j.alphaTest>0,ze=j.clearcoat>0,tt=j.iridescence>0;return{isWebGL2:p,shaderID:ee,shaderName:j.type,vertexShader:Y,fragmentShader:we,defines:j.defines,customVertexShaderID:Ke,customFragmentShaderID:ge,isRawShaderMaterial:j.isRawShaderMaterial===!0,glslVersion:j.glslVersion,precision:g,instancing:N.isInstancedMesh===!0,instancingColor:N.isInstancedMesh===!0&&N.instanceColor!==null,supportsVertexTextures:y,outputEncoding:me===null?a.outputEncoding:me.isXRRenderTarget===!0?me.texture.encoding:Gc,map:!!j.map,matcap:!!j.matcap,envMap:!!U,envMapMode:U&&U.mapping,envMapCubeUVHeight:$,lightMap:!!j.lightMap,aoMap:!!j.aoMap,emissiveMap:!!j.emissiveMap,bumpMap:!!j.bumpMap,normalMap:!!j.normalMap,objectSpaceNormalMap:j.normalMapType===cR,tangentSpaceNormalMap:j.normalMapType===wh,decodeVideoTexture:!!j.map&&j.map.isVideoTexture===!0&&j.map.encoding===_r,clearcoat:ze,clearcoatMap:ze&&!!j.clearcoatMap,clearcoatRoughnessMap:ze&&!!j.clearcoatRoughnessMap,clearcoatNormalMap:ze&&!!j.clearcoatNormalMap,iridescence:tt,iridescenceMap:tt&&!!j.iridescenceMap,iridescenceThicknessMap:tt&&!!j.iridescenceThicknessMap,displacementMap:!!j.displacementMap,roughnessMap:!!j.roughnessMap,metalnessMap:!!j.metalnessMap,specularMap:!!j.specularMap,specularIntensityMap:!!j.specularIntensityMap,specularColorMap:!!j.specularColorMap,opaque:j.transparent===!1&&j.blending===rh,alphaMap:!!j.alphaMap,alphaTest:De,gradientMap:!!j.gradientMap,sheen:j.sheen>0,sheenColorMap:!!j.sheenColorMap,sheenRoughnessMap:!!j.sheenRoughnessMap,transmission:j.transmission>0,transmissionMap:!!j.transmissionMap,thicknessMap:!!j.thicknessMap,combine:j.combine,vertexTangents:!!j.normalMap&&!!M.attributes.tangent,vertexColors:j.vertexColors,vertexAlphas:j.vertexColors===!0&&!!M.attributes.color&&M.attributes.color.itemSize===4,vertexUvs:!!j.map||!!j.bumpMap||!!j.normalMap||!!j.specularMap||!!j.alphaMap||!!j.emissiveMap||!!j.roughnessMap||!!j.metalnessMap||!!j.clearcoatMap||!!j.clearcoatRoughnessMap||!!j.clearcoatNormalMap||!!j.iridescenceMap||!!j.iridescenceThicknessMap||!!j.displacementMap||!!j.transmissionMap||!!j.thicknessMap||!!j.specularIntensityMap||!!j.specularColorMap||!!j.sheenColorMap||!!j.sheenRoughnessMap,uvsVertexOnly:!(!!j.map||!!j.bumpMap||!!j.normalMap||!!j.specularMap||!!j.alphaMap||!!j.emissiveMap||!!j.roughnessMap||!!j.metalnessMap||!!j.clearcoatNormalMap||!!j.iridescenceMap||!!j.iridescenceThicknessMap||j.transmission>0||!!j.transmissionMap||!!j.thicknessMap||!!j.specularIntensityMap||!!j.specularColorMap||j.sheen>0||!!j.sheenColorMap||!!j.sheenRoughnessMap)&&!!j.displacementMap,fog:!!L,useFog:j.fog===!0,fogExp2:L&&L.isFogExp2,flatShading:!!j.flatShading,sizeAttenuation:j.sizeAttenuation,logarithmicDepthBuffer:m,skinning:N.isSkinnedMesh===!0,morphTargets:M.morphAttributes.position!==void 0,morphNormals:M.morphAttributes.normal!==void 0,morphColors:M.morphAttributes.color!==void 0,morphTargetsCount:G,morphTextureStride:K,numDirLights:J.directional.length,numPointLights:J.point.length,numSpotLights:J.spot.length,numRectAreaLights:J.rectArea.length,numHemiLights:J.hemi.length,numDirLightShadows:J.directionalShadowMap.length,numPointLightShadows:J.pointShadowMap.length,numSpotLightShadows:J.spotShadowMap.length,numClippingPlanes:c.numPlanes,numClipIntersection:c.numIntersection,dithering:j.dithering,shadowMapEnabled:a.shadowMap.enabled&&de.length>0,shadowMapType:a.shadowMap.type,toneMapping:j.toneMapped?a.toneMapping:za,physicallyCorrectLights:a.physicallyCorrectLights,premultipliedAlpha:j.premultipliedAlpha,doubleSided:j.side===fh,flipSided:j.side===To,useDepthPacking:!!j.depthPacking,depthPacking:j.depthPacking||0,index0AttributeName:j.index0AttributeName,extensionDerivatives:j.extensions&&j.extensions.derivatives,extensionFragDepth:j.extensions&&j.extensions.fragDepth,extensionDrawBuffers:j.extensions&&j.extensions.drawBuffers,extensionShaderTextureLOD:j.extensions&&j.extensions.shaderTextureLOD,rendererExtensionFragDepth:p||i.has("EXT_frag_depth"),rendererExtensionDrawBuffers:p||i.has("WEBGL_draw_buffers"),rendererExtensionShaderTextureLod:p||i.has("EXT_shader_texture_lod"),customProgramCacheKey:j.customProgramCacheKey()}}function b(j){const J=[];if(j.shaderID?J.push(j.shaderID):(J.push(j.customVertexShaderID),J.push(j.customFragmentShaderID)),j.defines!==void 0)for(const de in j.defines)J.push(de),J.push(j.defines[de]);return j.isRawShaderMaterial===!1&&(E(J,j),T(J,j),J.push(a.outputEncoding)),J.push(j.customProgramCacheKey),J.join()}function E(j,J){j.push(J.precision),j.push(J.outputEncoding),j.push(J.envMapMode),j.push(J.envMapCubeUVHeight),j.push(J.combine),j.push(J.vertexUvs),j.push(J.fogExp2),j.push(J.sizeAttenuation),j.push(J.morphTargetsCount),j.push(J.morphAttributeCount),j.push(J.numDirLights),j.push(J.numPointLights),j.push(J.numSpotLights),j.push(J.numHemiLights),j.push(J.numRectAreaLights),j.push(J.numDirLightShadows),j.push(J.numPointLightShadows),j.push(J.numSpotLightShadows),j.push(J.shadowMapType),j.push(J.toneMapping),j.push(J.numClippingPlanes),j.push(J.numClipIntersection),j.push(J.depthPacking)}function T(j,J){u.disableAll(),J.isWebGL2&&u.enable(0),J.supportsVertexTextures&&u.enable(1),J.instancing&&u.enable(2),J.instancingColor&&u.enable(3),J.map&&u.enable(4),J.matcap&&u.enable(5),J.envMap&&u.enable(6),J.lightMap&&u.enable(7),J.aoMap&&u.enable(8),J.emissiveMap&&u.enable(9),J.bumpMap&&u.enable(10),J.normalMap&&u.enable(11),J.objectSpaceNormalMap&&u.enable(12),J.tangentSpaceNormalMap&&u.enable(13),J.clearcoat&&u.enable(14),J.clearcoatMap&&u.enable(15),J.clearcoatRoughnessMap&&u.enable(16),J.clearcoatNormalMap&&u.enable(17),J.iridescence&&u.enable(18),J.iridescenceMap&&u.enable(19),J.iridescenceThicknessMap&&u.enable(20),J.displacementMap&&u.enable(21),J.specularMap&&u.enable(22),J.roughnessMap&&u.enable(23),J.metalnessMap&&u.enable(24),J.gradientMap&&u.enable(25),J.alphaMap&&u.enable(26),J.alphaTest&&u.enable(27),J.vertexColors&&u.enable(28),J.vertexAlphas&&u.enable(29),J.vertexUvs&&u.enable(30),J.vertexTangents&&u.enable(31),J.uvsVertexOnly&&u.enable(32),J.fog&&u.enable(33),j.push(u.mask),u.disableAll(),J.useFog&&u.enable(0),J.flatShading&&u.enable(1),J.logarithmicDepthBuffer&&u.enable(2),J.skinning&&u.enable(3),J.morphTargets&&u.enable(4),J.morphNormals&&u.enable(5),J.morphColors&&u.enable(6),J.premultipliedAlpha&&u.enable(7),J.shadowMapEnabled&&u.enable(8),J.physicallyCorrectLights&&u.enable(9),J.doubleSided&&u.enable(10),J.flipSided&&u.enable(11),J.useDepthPacking&&u.enable(12),J.dithering&&u.enable(13),J.specularIntensityMap&&u.enable(14),J.specularColorMap&&u.enable(15),J.transmission&&u.enable(16),J.transmissionMap&&u.enable(17),J.thicknessMap&&u.enable(18),J.sheen&&u.enable(19),J.sheenColorMap&&u.enable(20),J.sheenRoughnessMap&&u.enable(21),J.decodeVideoTexture&&u.enable(22),J.opaque&&u.enable(23),j.push(u.mask)}function P(j){const J=_[j.type];let de;if(J){const te=ua[J];de=pR.clone(te.uniforms)}else de=j.uniforms;return de}function D(j,J){let de;for(let te=0,N=f.length;te<N;te++){const L=f[te];if(L.cacheKey===J){de=L,++de.usedTimes;break}}return de===void 0&&(de=new dH(a,J,j,s),f.push(de)),de}function F(j){if(--j.usedTimes===0){const J=f.indexOf(j);f[J]=f[f.length-1],f.pop(),j.destroy()}}function k(j){h.remove(j)}function W(){h.dispose()}return{getParameters:x,getProgramCacheKey:b,getUniforms:P,acquireProgram:D,releaseProgram:F,releaseShaderCache:k,programs:f,dispose:W}}function yH(){let a=new WeakMap;function t(s){let c=a.get(s);return c===void 0&&(c={},a.set(s,c)),c}function n(s){a.delete(s)}function i(s,c,u){a.get(s)[c]=u}function o(){a=new WeakMap}return{get:t,remove:n,update:i,dispose:o}}function xH(a,t){return a.groupOrder!==t.groupOrder?a.groupOrder-t.groupOrder:a.renderOrder!==t.renderOrder?a.renderOrder-t.renderOrder:a.material.id!==t.material.id?a.material.id-t.material.id:a.z!==t.z?a.z-t.z:a.id-t.id}function IS(a,t){return a.groupOrder!==t.groupOrder?a.groupOrder-t.groupOrder:a.renderOrder!==t.renderOrder?a.renderOrder-t.renderOrder:a.z!==t.z?t.z-a.z:a.id-t.id}function OS(){const a=[];let t=0;const n=[],i=[],o=[];function s(){t=0,n.length=0,i.length=0,o.length=0}function c(m,y,g,_,x,b){let E=a[t];return E===void 0?(E={id:m.id,object:m,geometry:y,material:g,groupOrder:_,renderOrder:m.renderOrder,z:x,group:b},a[t]=E):(E.id=m.id,E.object=m,E.geometry=y,E.material=g,E.groupOrder=_,E.renderOrder=m.renderOrder,E.z=x,E.group=b),t++,E}function u(m,y,g,_,x,b){const E=c(m,y,g,_,x,b);g.transmission>0?i.push(E):g.transparent===!0?o.push(E):n.push(E)}function h(m,y,g,_,x,b){const E=c(m,y,g,_,x,b);g.transmission>0?i.unshift(E):g.transparent===!0?o.unshift(E):n.unshift(E)}function f(m,y){n.length>1&&n.sort(m||xH),i.length>1&&i.sort(y||IS),o.length>1&&o.sort(y||IS)}function p(){for(let m=t,y=a.length;m<y;m++){const g=a[m];if(g.id===null)break;g.id=null,g.object=null,g.geometry=null,g.material=null,g.group=null}}return{opaque:n,transmissive:i,transparent:o,init:s,push:u,unshift:h,finish:p,sort:f}}function AH(){let a=new WeakMap;function t(i,o){let s;return a.has(i)===!1?(s=new OS,a.set(i,[s])):o>=a.get(i).length?(s=new OS,a.get(i).push(s)):s=a.get(i)[o],s}function n(){a=new WeakMap}return{get:t,dispose:n}}function bH(){const a={};return{get:function(t){if(a[t.id]!==void 0)return a[t.id];let n;switch(t.type){case"DirectionalLight":n={direction:new Ze,color:new qn};break;case"SpotLight":n={position:new Ze,direction:new Ze,color:new qn,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":n={position:new Ze,color:new qn,distance:0,decay:0};break;case"HemisphereLight":n={direction:new Ze,skyColor:new qn,groundColor:new qn};break;case"RectAreaLight":n={color:new qn,position:new Ze,halfWidth:new Ze,halfHeight:new Ze};break}return a[t.id]=n,n}}}function _H(){const a={};return{get:function(t){if(a[t.id]!==void 0)return a[t.id];let n;switch(t.type){case"DirectionalLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new yn};break;case"SpotLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new yn};break;case"PointLight":n={shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new yn,shadowCameraNear:1,shadowCameraFar:1e3};break}return a[t.id]=n,n}}}let wH=0;function EH(a,t){return(t.castShadow?1:0)-(a.castShadow?1:0)}function MH(a,t){const n=new bH,i=_H(),o={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadow:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]};for(let p=0;p<9;p++)o.probe.push(new Ze);const s=new Ze,c=new Oi,u=new Oi;function h(p,m){let y=0,g=0,_=0;for(let J=0;J<9;J++)o.probe[J].set(0,0,0);let x=0,b=0,E=0,T=0,P=0,D=0,F=0,k=0;p.sort(EH);const W=m!==!0?Math.PI:1;for(let J=0,de=p.length;J<de;J++){const te=p[J],N=te.color,L=te.intensity,M=te.distance,I=te.shadow&&te.shadow.map?te.shadow.map.texture:null;if(te.isAmbientLight)y+=N.r*L*W,g+=N.g*L*W,_+=N.b*L*W;else if(te.isLightProbe)for(let U=0;U<9;U++)o.probe[U].addScaledVector(te.sh.coefficients[U],L);else if(te.isDirectionalLight){const U=n.get(te);if(U.color.copy(te.color).multiplyScalar(te.intensity*W),te.castShadow){const $=te.shadow,ee=i.get(te);ee.shadowBias=$.bias,ee.shadowNormalBias=$.normalBias,ee.shadowRadius=$.radius,ee.shadowMapSize=$.mapSize,o.directionalShadow[x]=ee,o.directionalShadowMap[x]=I,o.directionalShadowMatrix[x]=te.shadow.matrix,D++}o.directional[x]=U,x++}else if(te.isSpotLight){const U=n.get(te);if(U.position.setFromMatrixPosition(te.matrixWorld),U.color.copy(N).multiplyScalar(L*W),U.distance=M,U.coneCos=Math.cos(te.angle),U.penumbraCos=Math.cos(te.angle*(1-te.penumbra)),U.decay=te.decay,te.castShadow){const $=te.shadow,ee=i.get(te);ee.shadowBias=$.bias,ee.shadowNormalBias=$.normalBias,ee.shadowRadius=$.radius,ee.shadowMapSize=$.mapSize,o.spotShadow[E]=ee,o.spotShadowMap[E]=I,o.spotShadowMatrix[E]=te.shadow.matrix,k++}o.spot[E]=U,E++}else if(te.isRectAreaLight){const U=n.get(te);U.color.copy(N).multiplyScalar(L),U.halfWidth.set(te.width*.5,0,0),U.halfHeight.set(0,te.height*.5,0),o.rectArea[T]=U,T++}else if(te.isPointLight){const U=n.get(te);if(U.color.copy(te.color).multiplyScalar(te.intensity*W),U.distance=te.distance,U.decay=te.decay,te.castShadow){const $=te.shadow,ee=i.get(te);ee.shadowBias=$.bias,ee.shadowNormalBias=$.normalBias,ee.shadowRadius=$.radius,ee.shadowMapSize=$.mapSize,ee.shadowCameraNear=$.camera.near,ee.shadowCameraFar=$.camera.far,o.pointShadow[b]=ee,o.pointShadowMap[b]=I,o.pointShadowMatrix[b]=te.shadow.matrix,F++}o.point[b]=U,b++}else if(te.isHemisphereLight){const U=n.get(te);U.skyColor.copy(te.color).multiplyScalar(L*W),U.groundColor.copy(te.groundColor).multiplyScalar(L*W),o.hemi[P]=U,P++}}T>0&&(t.isWebGL2||a.has("OES_texture_float_linear")===!0?(o.rectAreaLTC1=Fn.LTC_FLOAT_1,o.rectAreaLTC2=Fn.LTC_FLOAT_2):a.has("OES_texture_half_float_linear")===!0?(o.rectAreaLTC1=Fn.LTC_HALF_1,o.rectAreaLTC2=Fn.LTC_HALF_2):console.error("THREE.WebGLRenderer: Unable to use RectAreaLight. Missing WebGL extensions.")),o.ambient[0]=y,o.ambient[1]=g,o.ambient[2]=_;const j=o.hash;(j.directionalLength!==x||j.pointLength!==b||j.spotLength!==E||j.rectAreaLength!==T||j.hemiLength!==P||j.numDirectionalShadows!==D||j.numPointShadows!==F||j.numSpotShadows!==k)&&(o.directional.length=x,o.spot.length=E,o.rectArea.length=T,o.point.length=b,o.hemi.length=P,o.directionalShadow.length=D,o.directionalShadowMap.length=D,o.pointShadow.length=F,o.pointShadowMap.length=F,o.spotShadow.length=k,o.spotShadowMap.length=k,o.directionalShadowMatrix.length=D,o.pointShadowMatrix.length=F,o.spotShadowMatrix.length=k,j.directionalLength=x,j.pointLength=b,j.spotLength=E,j.rectAreaLength=T,j.hemiLength=P,j.numDirectionalShadows=D,j.numPointShadows=F,j.numSpotShadows=k,o.version=wH++)}function f(p,m){let y=0,g=0,_=0,x=0,b=0;const E=m.matrixWorldInverse;for(let T=0,P=p.length;T<P;T++){const D=p[T];if(D.isDirectionalLight){const F=o.directional[y];F.direction.setFromMatrixPosition(D.matrixWorld),s.setFromMatrixPosition(D.target.matrixWorld),F.direction.sub(s),F.direction.transformDirection(E),y++}else if(D.isSpotLight){const F=o.spot[_];F.position.setFromMatrixPosition(D.matrixWorld),F.position.applyMatrix4(E),F.direction.setFromMatrixPosition(D.matrixWorld),s.setFromMatrixPosition(D.target.matrixWorld),F.direction.sub(s),F.direction.transformDirection(E),_++}else if(D.isRectAreaLight){const F=o.rectArea[x];F.position.setFromMatrixPosition(D.matrixWorld),F.position.applyMatrix4(E),u.identity(),c.copy(D.matrixWorld),c.premultiply(E),u.extractRotation(c),F.halfWidth.set(D.width*.5,0,0),F.halfHeight.set(0,D.height*.5,0),F.halfWidth.applyMatrix4(u),F.halfHeight.applyMatrix4(u),x++}else if(D.isPointLight){const F=o.point[g];F.position.setFromMatrixPosition(D.matrixWorld),F.position.applyMatrix4(E),g++}else if(D.isHemisphereLight){const F=o.hemi[b];F.direction.setFromMatrixPosition(D.matrixWorld),F.direction.transformDirection(E),b++}}}return{setup:h,setupView:f,state:o}}function DS(a,t){const n=new MH(a,t),i=[],o=[];function s(){i.length=0,o.length=0}function c(m){i.push(m)}function u(m){o.push(m)}function h(m){n.setup(i,m)}function f(m){n.setupView(i,m)}return{init:s,state:{lightsArray:i,shadowsArray:o,lights:n},setupLights:h,setupLightsView:f,pushLight:c,pushShadow:u}}function SH(a,t){let n=new WeakMap;function i(s,c=0){let u;return n.has(s)===!1?(u=new DS(a,t),n.set(s,[u])):c>=n.get(s).length?(u=new DS(a,t),n.get(s).push(u)):u=n.get(s)[c],u}function o(){n=new WeakMap}return{get:i,dispose:o}}class B_ extends rs{constructor(t){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=aR,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}class F_ extends rs{constructor(t){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.referencePosition=new Ze,this.nearDistance=1,this.farDistance=1e3,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(t)}copy(t){return super.copy(t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}const TH=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,CH=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function RH(a,t,n){let i=new my;const o=new yn,s=new yn,c=new ur,u=new B_({depthPacking:lR}),h=new F_,f={},p=n.maxTextureSize,m={0:To,1:hh,2:fh},y=new Ya({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new yn},radius:{value:4}},vertexShader:TH,fragmentShader:CH}),g=y.clone();g.defines.HORIZONTAL_PASS=1;const _=new Ii;_.setAttribute("position",new mr(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const x=new Ss(_,y),b=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=E_,this.render=function(D,F,k){if(b.enabled===!1||b.autoUpdate===!1&&b.needsUpdate===!1||D.length===0)return;const W=a.getRenderTarget(),j=a.getActiveCubeFace(),J=a.getActiveMipmapLevel(),de=a.state;de.setBlending(Ul),de.buffers.color.setClear(1,1,1,1),de.buffers.depth.setTest(!0),de.setScissorTest(!1);for(let te=0,N=D.length;te<N;te++){const L=D[te],M=L.shadow;if(M===void 0){console.warn("THREE.WebGLShadowMap:",L,"has no shadow.");continue}if(M.autoUpdate===!1&&M.needsUpdate===!1)continue;o.copy(M.mapSize);const I=M.getFrameExtents();if(o.multiply(I),s.copy(M.mapSize),(o.x>p||o.y>p)&&(o.x>p&&(s.x=Math.floor(p/I.x),o.x=s.x*I.x,M.mapSize.x=s.x),o.y>p&&(s.y=Math.floor(p/I.y),o.y=s.y*I.y,M.mapSize.y=s.y)),M.map===null&&!M.isPointLightShadow&&this.type===$f&&(M.map=new Ro(o.x,o.y),M.map.texture.name=L.name+".shadowMap",M.mapPass=new Ro(o.x,o.y),M.camera.updateProjectionMatrix()),M.map===null){const $={minFilter:Qr,magFilter:Qr,format:Mo};M.map=new Ro(o.x,o.y,$),M.map.texture.name=L.name+".shadowMap",M.camera.updateProjectionMatrix()}a.setRenderTarget(M.map),a.clear();const U=M.getViewportCount();for(let $=0;$<U;$++){const ee=M.getViewport($);c.set(s.x*ee.x,s.y*ee.y,s.x*ee.z,s.y*ee.w),de.viewport(c),M.updateMatrices(L,$),i=M.getFrustum(),P(F,k,M.camera,L,this.type)}!M.isPointLightShadow&&this.type===$f&&E(M,k),M.needsUpdate=!1}b.needsUpdate=!1,a.setRenderTarget(W,j,J)};function E(D,F){const k=t.update(x);y.defines.VSM_SAMPLES!==D.blurSamples&&(y.defines.VSM_SAMPLES=D.blurSamples,g.defines.VSM_SAMPLES=D.blurSamples,y.needsUpdate=!0,g.needsUpdate=!0),y.uniforms.shadow_pass.value=D.map.texture,y.uniforms.resolution.value=D.mapSize,y.uniforms.radius.value=D.radius,a.setRenderTarget(D.mapPass),a.clear(),a.renderBufferDirect(F,null,k,y,x,null),g.uniforms.shadow_pass.value=D.mapPass.texture,g.uniforms.resolution.value=D.mapSize,g.uniforms.radius.value=D.radius,a.setRenderTarget(D.map),a.clear(),a.renderBufferDirect(F,null,k,g,x,null)}function T(D,F,k,W,j,J){let de=null;const te=k.isPointLight===!0?D.customDistanceMaterial:D.customDepthMaterial;if(te!==void 0?de=te:de=k.isPointLight===!0?h:u,a.localClippingEnabled&&F.clipShadows===!0&&F.clippingPlanes.length!==0||F.displacementMap&&F.displacementScale!==0||F.alphaMap&&F.alphaTest>0){const N=de.uuid,L=F.uuid;let M=f[N];M===void 0&&(M={},f[N]=M);let I=M[L];I===void 0&&(I=de.clone(),M[L]=I),de=I}return de.visible=F.visible,de.wireframe=F.wireframe,J===$f?de.side=F.shadowSide!==null?F.shadowSide:F.side:de.side=F.shadowSide!==null?F.shadowSide:m[F.side],de.alphaMap=F.alphaMap,de.alphaTest=F.alphaTest,de.clipShadows=F.clipShadows,de.clippingPlanes=F.clippingPlanes,de.clipIntersection=F.clipIntersection,de.displacementMap=F.displacementMap,de.displacementScale=F.displacementScale,de.displacementBias=F.displacementBias,de.wireframeLinewidth=F.wireframeLinewidth,de.linewidth=F.linewidth,k.isPointLight===!0&&de.isMeshDistanceMaterial===!0&&(de.referencePosition.setFromMatrixPosition(k.matrixWorld),de.nearDistance=W,de.farDistance=j),de}function P(D,F,k,W,j){if(D.visible===!1)return;if(D.layers.test(F.layers)&&(D.isMesh||D.isLine||D.isPoints)&&(D.castShadow||D.receiveShadow&&j===$f)&&(!D.frustumCulled||i.intersectsObject(D))){D.modelViewMatrix.multiplyMatrices(k.matrixWorldInverse,D.matrixWorld);const te=t.update(D),N=D.material;if(Array.isArray(N)){const L=te.groups;for(let M=0,I=L.length;M<I;M++){const U=L[M],$=N[U.materialIndex];if($&&$.visible){const ee=T(D,$,W,k.near,k.far,j);a.renderBufferDirect(k,null,te,ee,D,U)}}}else if(N.visible){const L=T(D,N,W,k.near,k.far,j);a.renderBufferDirect(k,null,te,L,D,null)}}const de=D.children;for(let te=0,N=de.length;te<N;te++)P(de[te],F,k,W,j)}}function LH(a,t,n){const i=n.isWebGL2;function o(){let ye=!1;const nt=new ur;let at=null;const mt=new ur(0,0,0,0);return{setMask:function(wt){at!==wt&&!ye&&(a.colorMask(wt,wt,wt,wt),at=wt)},setLocked:function(wt){ye=wt},setClear:function(wt,Lt,Ct,ut,St){St===!0&&(wt*=ut,Lt*=ut,Ct*=ut),nt.set(wt,Lt,Ct,ut),mt.equals(nt)===!1&&(a.clearColor(wt,Lt,Ct,ut),mt.copy(nt))},reset:function(){ye=!1,at=null,mt.set(-1,0,0,0)}}}function s(){let ye=!1,nt=null,at=null,mt=null;return{setTest:function(wt){wt?ge(2929):me(2929)},setMask:function(wt){nt!==wt&&!ye&&(a.depthMask(wt),nt=wt)},setFunc:function(wt){if(at!==wt){if(wt)switch(wt){case RC:a.depthFunc(512);break;case LC:a.depthFunc(519);break;case PC:a.depthFunc(513);break;case Dv:a.depthFunc(515);break;case IC:a.depthFunc(514);break;case OC:a.depthFunc(518);break;case DC:a.depthFunc(516);break;case BC:a.depthFunc(517);break;default:a.depthFunc(515)}else a.depthFunc(515);at=wt}},setLocked:function(wt){ye=wt},setClear:function(wt){mt!==wt&&(a.clearDepth(wt),mt=wt)},reset:function(){ye=!1,nt=null,at=null,mt=null}}}function c(){let ye=!1,nt=null,at=null,mt=null,wt=null,Lt=null,Ct=null,ut=null,St=null;return{setTest:function(Tt){ye||(Tt?ge(2960):me(2960))},setMask:function(Tt){nt!==Tt&&!ye&&(a.stencilMask(Tt),nt=Tt)},setFunc:function(Tt,gn,An){(at!==Tt||mt!==gn||wt!==An)&&(a.stencilFunc(Tt,gn,An),at=Tt,mt=gn,wt=An)},setOp:function(Tt,gn,An){(Lt!==Tt||Ct!==gn||ut!==An)&&(a.stencilOp(Tt,gn,An),Lt=Tt,Ct=gn,ut=An)},setLocked:function(Tt){ye=Tt},setClear:function(Tt){St!==Tt&&(a.clearStencil(Tt),St=Tt)},reset:function(){ye=!1,nt=null,at=null,mt=null,wt=null,Lt=null,Ct=null,ut=null,St=null}}}const u=new o,h=new s,f=new c;let p={},m={},y=new WeakMap,g=[],_=null,x=!1,b=null,E=null,T=null,P=null,D=null,F=null,k=null,W=!1,j=null,J=null,de=null,te=null,N=null;const L=a.getParameter(35661);let M=!1,I=0;const U=a.getParameter(7938);U.indexOf("WebGL")!==-1?(I=parseFloat(/^WebGL (\d)/.exec(U)[1]),M=I>=1):U.indexOf("OpenGL ES")!==-1&&(I=parseFloat(/^OpenGL ES (\d)/.exec(U)[1]),M=I>=2);let $=null,ee={};const Q=a.getParameter(3088),G=a.getParameter(2978),K=new ur().fromArray(Q),Y=new ur().fromArray(G);function we(ye,nt,at){const mt=new Uint8Array(4),wt=a.createTexture();a.bindTexture(ye,wt),a.texParameteri(ye,10241,9728),a.texParameteri(ye,10240,9728);for(let Lt=0;Lt<at;Lt++)a.texImage2D(nt+Lt,0,6408,1,1,0,6408,5121,mt);return wt}const Ke={};Ke[3553]=we(3553,3553,1),Ke[34067]=we(34067,34069,6),u.setClear(0,0,0,1),h.setClear(1),f.setClear(0),ge(2929),h.setFunc(Dv),Be(!1),$e(rb),ge(2884),Ye(Ul);function ge(ye){p[ye]!==!0&&(a.enable(ye),p[ye]=!0)}function me(ye){p[ye]!==!1&&(a.disable(ye),p[ye]=!1)}function De(ye,nt){return m[ye]!==nt?(a.bindFramebuffer(ye,nt),m[ye]=nt,i&&(ye===36009&&(m[36160]=nt),ye===36160&&(m[36009]=nt)),!0):!1}function ze(ye,nt){let at=g,mt=!1;if(ye)if(at=y.get(nt),at===void 0&&(at=[],y.set(nt,at)),ye.isWebGLMultipleRenderTargets){const wt=ye.texture;if(at.length!==wt.length||at[0]!==36064){for(let Lt=0,Ct=wt.length;Lt<Ct;Lt++)at[Lt]=36064+Lt;at.length=wt.length,mt=!0}}else at[0]!==36064&&(at[0]=36064,mt=!0);else at[0]!==1029&&(at[0]=1029,mt=!0);mt&&(n.isWebGL2?a.drawBuffers(at):t.get("WEBGL_draw_buffers").drawBuffersWEBGL(at))}function tt(ye){return _!==ye?(a.useProgram(ye),_=ye,!0):!1}const rt={[Xu]:32774,[yC]:32778,[xC]:32779};if(i)rt[lb]=32775,rt[cb]=32776;else{const ye=t.get("EXT_blend_minmax");ye!==null&&(rt[lb]=ye.MIN_EXT,rt[cb]=ye.MAX_EXT)}const vt={[AC]:0,[bC]:1,[_C]:768,[M_]:770,[CC]:776,[SC]:774,[EC]:772,[wC]:769,[S_]:771,[TC]:775,[MC]:773};function Ye(ye,nt,at,mt,wt,Lt,Ct,ut){if(ye===Ul){x===!0&&(me(3042),x=!1);return}if(x===!1&&(ge(3042),x=!0),ye!==vC){if(ye!==b||ut!==W){if((E!==Xu||D!==Xu)&&(a.blendEquation(32774),E=Xu,D=Xu),ut)switch(ye){case rh:a.blendFuncSeparate(1,771,1,771);break;case sb:a.blendFunc(1,1);break;case ob:a.blendFuncSeparate(0,769,0,1);break;case ab:a.blendFuncSeparate(0,768,0,770);break;default:console.error("THREE.WebGLState: Invalid blending: ",ye);break}else switch(ye){case rh:a.blendFuncSeparate(770,771,1,771);break;case sb:a.blendFunc(770,1);break;case ob:a.blendFuncSeparate(0,769,0,1);break;case ab:a.blendFunc(0,768);break;default:console.error("THREE.WebGLState: Invalid blending: ",ye);break}T=null,P=null,F=null,k=null,b=ye,W=ut}return}wt=wt||nt,Lt=Lt||at,Ct=Ct||mt,(nt!==E||wt!==D)&&(a.blendEquationSeparate(rt[nt],rt[wt]),E=nt,D=wt),(at!==T||mt!==P||Lt!==F||Ct!==k)&&(a.blendFuncSeparate(vt[at],vt[mt],vt[Lt],vt[Ct]),T=at,P=mt,F=Lt,k=Ct),b=ye,W=null}function Pe(ye,nt){ye.side===fh?me(2884):ge(2884);let at=ye.side===To;nt&&(at=!at),Be(at),ye.blending===rh&&ye.transparent===!1?Ye(Ul):Ye(ye.blending,ye.blendEquation,ye.blendSrc,ye.blendDst,ye.blendEquationAlpha,ye.blendSrcAlpha,ye.blendDstAlpha,ye.premultipliedAlpha),h.setFunc(ye.depthFunc),h.setTest(ye.depthTest),h.setMask(ye.depthWrite),u.setMask(ye.colorWrite);const mt=ye.stencilWrite;f.setTest(mt),mt&&(f.setMask(ye.stencilWriteMask),f.setFunc(ye.stencilFunc,ye.stencilRef,ye.stencilFuncMask),f.setOp(ye.stencilFail,ye.stencilZFail,ye.stencilZPass)),We(ye.polygonOffset,ye.polygonOffsetFactor,ye.polygonOffsetUnits),ye.alphaToCoverage===!0?ge(32926):me(32926)}function Be(ye){j!==ye&&(ye?a.frontFace(2304):a.frontFace(2305),j=ye)}function $e(ye){ye!==dC?(ge(2884),ye!==J&&(ye===rb?a.cullFace(1029):ye===pC?a.cullFace(1028):a.cullFace(1032))):me(2884),J=ye}function Je(ye){ye!==de&&(M&&a.lineWidth(ye),de=ye)}function We(ye,nt,at){ye?(ge(32823),(te!==nt||N!==at)&&(a.polygonOffset(nt,at),te=nt,N=at)):me(32823)}function _e(ye){ye?ge(3089):me(3089)}function Ee(ye){ye===void 0&&(ye=33984+L-1),$!==ye&&(a.activeTexture(ye),$=ye)}function Oe(ye,nt){$===null&&Ee();let at=ee[$];at===void 0&&(at={type:void 0,texture:void 0},ee[$]=at),(at.type!==ye||at.texture!==nt)&&(a.bindTexture(ye,nt||Ke[ye]),at.type=ye,at.texture=nt)}function Le(){const ye=ee[$];ye!==void 0&&ye.type!==void 0&&(a.bindTexture(ye.type,null),ye.type=void 0,ye.texture=void 0)}function ce(){try{a.compressedTexImage2D.apply(a,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function he(){try{a.texSubImage2D.apply(a,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function ie(){try{a.texSubImage3D.apply(a,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function V(){try{a.compressedTexSubImage2D.apply(a,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function Z(){try{a.texStorage2D.apply(a,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function B(){try{a.texStorage3D.apply(a,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function S(){try{a.texImage2D.apply(a,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function R(){try{a.texImage3D.apply(a,arguments)}catch(ye){console.error("THREE.WebGLState:",ye)}}function X(ye){K.equals(ye)===!1&&(a.scissor(ye.x,ye.y,ye.z,ye.w),K.copy(ye))}function xe(ye){Y.equals(ye)===!1&&(a.viewport(ye.x,ye.y,ye.z,ye.w),Y.copy(ye))}function Ie(){a.disable(3042),a.disable(2884),a.disable(2929),a.disable(32823),a.disable(3089),a.disable(2960),a.disable(32926),a.blendEquation(32774),a.blendFunc(1,0),a.blendFuncSeparate(1,0,1,0),a.colorMask(!0,!0,!0,!0),a.clearColor(0,0,0,0),a.depthMask(!0),a.depthFunc(513),a.clearDepth(1),a.stencilMask(4294967295),a.stencilFunc(519,0,4294967295),a.stencilOp(7680,7680,7680),a.clearStencil(0),a.cullFace(1029),a.frontFace(2305),a.polygonOffset(0,0),a.activeTexture(33984),a.bindFramebuffer(36160,null),i===!0&&(a.bindFramebuffer(36009,null),a.bindFramebuffer(36008,null)),a.useProgram(null),a.lineWidth(1),a.scissor(0,0,a.canvas.width,a.canvas.height),a.viewport(0,0,a.canvas.width,a.canvas.height),p={},$=null,ee={},m={},y=new WeakMap,g=[],_=null,x=!1,b=null,E=null,T=null,P=null,D=null,F=null,k=null,W=!1,j=null,J=null,de=null,te=null,N=null,K.set(0,0,a.canvas.width,a.canvas.height),Y.set(0,0,a.canvas.width,a.canvas.height),u.reset(),h.reset(),f.reset()}return{buffers:{color:u,depth:h,stencil:f},enable:ge,disable:me,bindFramebuffer:De,drawBuffers:ze,useProgram:tt,setBlending:Ye,setMaterial:Pe,setFlipSided:Be,setCullFace:$e,setLineWidth:Je,setPolygonOffset:We,setScissorTest:_e,activeTexture:Ee,bindTexture:Oe,unbindTexture:Le,compressedTexImage2D:ce,texImage2D:S,texImage3D:R,texStorage2D:Z,texStorage3D:B,texSubImage2D:he,texSubImage3D:ie,compressedTexSubImage2D:V,scissor:X,viewport:xe,reset:Ie}}function PH(a,t,n,i,o,s,c){const u=o.isWebGL2,h=o.maxTextures,f=o.maxCubemapSize,p=o.maxTextureSize,m=o.maxSamples,y=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,g=/OculusBrowser/g.test(navigator.userAgent),_=new WeakMap;let x;const b=new WeakMap;let E=!1;try{E=typeof OffscreenCanvas!="undefined"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function T(ce,he){return E?new OffscreenCanvas(ce,he):bm("canvas")}function P(ce,he,ie,V){let Z=1;if((ce.width>V||ce.height>V)&&(Z=V/Math.max(ce.width,ce.height)),Z<1||he===!0)if(typeof HTMLImageElement!="undefined"&&ce instanceof HTMLImageElement||typeof HTMLCanvasElement!="undefined"&&ce instanceof HTMLCanvasElement||typeof ImageBitmap!="undefined"&&ce instanceof ImageBitmap){const B=he?kv:Math.floor,S=B(Z*ce.width),R=B(Z*ce.height);x===void 0&&(x=T(S,R));const X=ie?T(S,R):x;return X.width=S,X.height=R,X.getContext("2d").drawImage(ce,0,0,S,R),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+ce.width+"x"+ce.height+") to ("+S+"x"+R+")."),X}else return"data"in ce&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+ce.width+"x"+ce.height+")."),ce;return ce}function D(ce){return Ib(ce.width)&&Ib(ce.height)}function F(ce){return u?!1:ce.wrapS!==Qs||ce.wrapT!==Qs||ce.minFilter!==Qr&&ce.minFilter!==Vr}function k(ce,he){return ce.generateMipmaps&&he&&ce.minFilter!==Qr&&ce.minFilter!==Vr}function W(ce){a.generateMipmap(ce)}function j(ce,he,ie,V,Z=!1){if(u===!1)return he;if(ce!==null){if(a[ce]!==void 0)return a[ce];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+ce+"'")}let B=he;return he===6403&&(ie===5126&&(B=33326),ie===5131&&(B=33325),ie===5121&&(B=33321)),he===33319&&(ie===5126&&(B=33328),ie===5131&&(B=33327),ie===5121&&(B=33323)),he===6408&&(ie===5126&&(B=34836),ie===5131&&(B=34842),ie===5121&&(B=V===_r&&Z===!1?35907:32856),ie===32819&&(B=32854),ie===32820&&(B=32855)),(B===33325||B===33326||B===33327||B===33328||B===34842||B===34836)&&t.get("EXT_color_buffer_float"),B}function J(ce,he,ie){return k(ce,ie)===!0||ce.isFramebufferTexture&&ce.minFilter!==Qr&&ce.minFilter!==Vr?Math.log2(Math.max(he.width,he.height))+1:ce.mipmaps!==void 0&&ce.mipmaps.length>0?ce.mipmaps.length:ce.isCompressedTexture&&Array.isArray(ce.image)?he.mipmaps.length:1}function de(ce){return ce===Qr||ce===Bv||ce===Fv?9728:9729}function te(ce){const he=ce.target;he.removeEventListener("dispose",te),L(he),he.isVideoTexture&&_.delete(he)}function N(ce){const he=ce.target;he.removeEventListener("dispose",N),I(he)}function L(ce){const he=i.get(ce);if(he.__webglInit===void 0)return;const ie=ce.source,V=b.get(ie);if(V){const Z=V[he.__cacheKey];Z.usedTimes--,Z.usedTimes===0&&M(ce),Object.keys(V).length===0&&b.delete(ie)}i.remove(ce)}function M(ce){const he=i.get(ce);a.deleteTexture(he.__webglTexture);const ie=ce.source,V=b.get(ie);delete V[he.__cacheKey],c.memory.textures--}function I(ce){const he=ce.texture,ie=i.get(ce),V=i.get(he);if(V.__webglTexture!==void 0&&(a.deleteTexture(V.__webglTexture),c.memory.textures--),ce.depthTexture&&ce.depthTexture.dispose(),ce.isWebGLCubeRenderTarget)for(let Z=0;Z<6;Z++)a.deleteFramebuffer(ie.__webglFramebuffer[Z]),ie.__webglDepthbuffer&&a.deleteRenderbuffer(ie.__webglDepthbuffer[Z]);else{if(a.deleteFramebuffer(ie.__webglFramebuffer),ie.__webglDepthbuffer&&a.deleteRenderbuffer(ie.__webglDepthbuffer),ie.__webglMultisampledFramebuffer&&a.deleteFramebuffer(ie.__webglMultisampledFramebuffer),ie.__webglColorRenderbuffer)for(let Z=0;Z<ie.__webglColorRenderbuffer.length;Z++)ie.__webglColorRenderbuffer[Z]&&a.deleteRenderbuffer(ie.__webglColorRenderbuffer[Z]);ie.__webglDepthRenderbuffer&&a.deleteRenderbuffer(ie.__webglDepthRenderbuffer)}if(ce.isWebGLMultipleRenderTargets)for(let Z=0,B=he.length;Z<B;Z++){const S=i.get(he[Z]);S.__webglTexture&&(a.deleteTexture(S.__webglTexture),c.memory.textures--),i.remove(he[Z])}i.remove(he),i.remove(ce)}let U=0;function $(){U=0}function ee(){const ce=U;return ce>=h&&console.warn("THREE.WebGLTextures: Trying to use "+ce+" texture units while this GPU supports only "+h),U+=1,ce}function Q(ce){const he=[];return he.push(ce.wrapS),he.push(ce.wrapT),he.push(ce.magFilter),he.push(ce.minFilter),he.push(ce.anisotropy),he.push(ce.internalFormat),he.push(ce.format),he.push(ce.type),he.push(ce.generateMipmaps),he.push(ce.premultiplyAlpha),he.push(ce.flipY),he.push(ce.unpackAlignment),he.push(ce.encoding),he.join()}function G(ce,he){const ie=i.get(ce);if(ce.isVideoTexture&&Oe(ce),ce.isRenderTargetTexture===!1&&ce.version>0&&ie.__version!==ce.version){const V=ce.image;if(V===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(V.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{ze(ie,ce,he);return}}n.activeTexture(33984+he),n.bindTexture(3553,ie.__webglTexture)}function K(ce,he){const ie=i.get(ce);if(ce.version>0&&ie.__version!==ce.version){ze(ie,ce,he);return}n.activeTexture(33984+he),n.bindTexture(35866,ie.__webglTexture)}function Y(ce,he){const ie=i.get(ce);if(ce.version>0&&ie.__version!==ce.version){ze(ie,ce,he);return}n.activeTexture(33984+he),n.bindTexture(32879,ie.__webglTexture)}function we(ce,he){const ie=i.get(ce);if(ce.version>0&&ie.__version!==ce.version){tt(ie,ce,he);return}n.activeTexture(33984+he),n.bindTexture(34067,ie.__webglTexture)}const Ke={[mm]:10497,[Qs]:33071,[gm]:33648},ge={[Qr]:9728,[Bv]:9984,[Fv]:9986,[Vr]:9729,[T_]:9985,[_h]:9987};function me(ce,he,ie){if(ie?(a.texParameteri(ce,10242,Ke[he.wrapS]),a.texParameteri(ce,10243,Ke[he.wrapT]),(ce===32879||ce===35866)&&a.texParameteri(ce,32882,Ke[he.wrapR]),a.texParameteri(ce,10240,ge[he.magFilter]),a.texParameteri(ce,10241,ge[he.minFilter])):(a.texParameteri(ce,10242,33071),a.texParameteri(ce,10243,33071),(ce===32879||ce===35866)&&a.texParameteri(ce,32882,33071),(he.wrapS!==Qs||he.wrapT!==Qs)&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping."),a.texParameteri(ce,10240,de(he.magFilter)),a.texParameteri(ce,10241,de(he.minFilter)),he.minFilter!==Qr&&he.minFilter!==Vr&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.")),t.has("EXT_texture_filter_anisotropic")===!0){const V=t.get("EXT_texture_filter_anisotropic");if(he.type===Bl&&t.has("OES_texture_float_linear")===!1||u===!1&&he.type===od&&t.has("OES_texture_half_float_linear")===!1)return;(he.anisotropy>1||i.get(he).__currentAnisotropy)&&(a.texParameterf(ce,V.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(he.anisotropy,o.getMaxAnisotropy())),i.get(he).__currentAnisotropy=he.anisotropy)}}function De(ce,he){let ie=!1;ce.__webglInit===void 0&&(ce.__webglInit=!0,he.addEventListener("dispose",te));const V=he.source;let Z=b.get(V);Z===void 0&&(Z={},b.set(V,Z));const B=Q(he);if(B!==ce.__cacheKey){Z[B]===void 0&&(Z[B]={texture:a.createTexture(),usedTimes:0},c.memory.textures++,ie=!0),Z[B].usedTimes++;const S=Z[ce.__cacheKey];S!==void 0&&(Z[ce.__cacheKey].usedTimes--,S.usedTimes===0&&M(he)),ce.__cacheKey=B,ce.__webglTexture=Z[B].texture}return ie}function ze(ce,he,ie){let V=3553;he.isDataArrayTexture&&(V=35866),he.isData3DTexture&&(V=32879);const Z=De(ce,he),B=he.source;if(n.activeTexture(33984+ie),n.bindTexture(V,ce.__webglTexture),B.version!==B.__currentVersion||Z===!0){a.pixelStorei(37440,he.flipY),a.pixelStorei(37441,he.premultiplyAlpha),a.pixelStorei(3317,he.unpackAlignment),a.pixelStorei(37443,0);const S=F(he)&&D(he.image)===!1;let R=P(he.image,S,!1,p);R=Le(he,R);const X=D(R)||u,xe=s.convert(he.format,he.encoding);let Ie=s.convert(he.type),ye=j(he.internalFormat,xe,Ie,he.encoding,he.isVideoTexture);me(V,he,X);let nt;const at=he.mipmaps,mt=u&&he.isVideoTexture!==!0,wt=B.__currentVersion===void 0||Z===!0,Lt=J(he,R,X);if(he.isDepthTexture)ye=6402,u?he.type===Bl?ye=36012:he.type===Tc?ye=33190:he.type===sh?ye=35056:ye=33189:he.type===Bl&&console.error("WebGLRenderer: Floating point depth texture requires WebGL2."),he.format===Bc&&ye===6402&&he.type!==C_&&he.type!==Tc&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),he.type=Tc,Ie=s.convert(he.type)),he.format===dh&&ye===6402&&(ye=34041,he.type!==sh&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),he.type=sh,Ie=s.convert(he.type))),wt&&(mt?n.texStorage2D(3553,1,ye,R.width,R.height):n.texImage2D(3553,0,ye,R.width,R.height,0,xe,Ie,null));else if(he.isDataTexture)if(at.length>0&&X){mt&&wt&&n.texStorage2D(3553,Lt,ye,at[0].width,at[0].height);for(let Ct=0,ut=at.length;Ct<ut;Ct++)nt=at[Ct],mt?n.texSubImage2D(3553,Ct,0,0,nt.width,nt.height,xe,Ie,nt.data):n.texImage2D(3553,Ct,ye,nt.width,nt.height,0,xe,Ie,nt.data);he.generateMipmaps=!1}else mt?(wt&&n.texStorage2D(3553,Lt,ye,R.width,R.height),n.texSubImage2D(3553,0,0,0,R.width,R.height,xe,Ie,R.data)):n.texImage2D(3553,0,ye,R.width,R.height,0,xe,Ie,R.data);else if(he.isCompressedTexture){mt&&wt&&n.texStorage2D(3553,Lt,ye,at[0].width,at[0].height);for(let Ct=0,ut=at.length;Ct<ut;Ct++)nt=at[Ct],he.format!==Mo?xe!==null?mt?n.compressedTexSubImage2D(3553,Ct,0,0,nt.width,nt.height,xe,nt.data):n.compressedTexImage2D(3553,Ct,ye,nt.width,nt.height,0,nt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):mt?n.texSubImage2D(3553,Ct,0,0,nt.width,nt.height,xe,Ie,nt.data):n.texImage2D(3553,Ct,ye,nt.width,nt.height,0,xe,Ie,nt.data)}else if(he.isDataArrayTexture)mt?(wt&&n.texStorage3D(35866,Lt,ye,R.width,R.height,R.depth),n.texSubImage3D(35866,0,0,0,0,R.width,R.height,R.depth,xe,Ie,R.data)):n.texImage3D(35866,0,ye,R.width,R.height,R.depth,0,xe,Ie,R.data);else if(he.isData3DTexture)mt?(wt&&n.texStorage3D(32879,Lt,ye,R.width,R.height,R.depth),n.texSubImage3D(32879,0,0,0,0,R.width,R.height,R.depth,xe,Ie,R.data)):n.texImage3D(32879,0,ye,R.width,R.height,R.depth,0,xe,Ie,R.data);else if(he.isFramebufferTexture){if(wt)if(mt)n.texStorage2D(3553,Lt,ye,R.width,R.height);else{let Ct=R.width,ut=R.height;for(let St=0;St<Lt;St++)n.texImage2D(3553,St,ye,Ct,ut,0,xe,Ie,null),Ct>>=1,ut>>=1}}else if(at.length>0&&X){mt&&wt&&n.texStorage2D(3553,Lt,ye,at[0].width,at[0].height);for(let Ct=0,ut=at.length;Ct<ut;Ct++)nt=at[Ct],mt?n.texSubImage2D(3553,Ct,0,0,xe,Ie,nt):n.texImage2D(3553,Ct,ye,xe,Ie,nt);he.generateMipmaps=!1}else mt?(wt&&n.texStorage2D(3553,Lt,ye,R.width,R.height),n.texSubImage2D(3553,0,0,0,xe,Ie,R)):n.texImage2D(3553,0,ye,xe,Ie,R);k(he,X)&&W(V),B.__currentVersion=B.version,he.onUpdate&&he.onUpdate(he)}ce.__version=he.version}function tt(ce,he,ie){if(he.image.length!==6)return;const V=De(ce,he),Z=he.source;if(n.activeTexture(33984+ie),n.bindTexture(34067,ce.__webglTexture),Z.version!==Z.__currentVersion||V===!0){a.pixelStorei(37440,he.flipY),a.pixelStorei(37441,he.premultiplyAlpha),a.pixelStorei(3317,he.unpackAlignment),a.pixelStorei(37443,0);const B=he.isCompressedTexture||he.image[0].isCompressedTexture,S=he.image[0]&&he.image[0].isDataTexture,R=[];for(let Ct=0;Ct<6;Ct++)!B&&!S?R[Ct]=P(he.image[Ct],!1,!0,f):R[Ct]=S?he.image[Ct].image:he.image[Ct],R[Ct]=Le(he,R[Ct]);const X=R[0],xe=D(X)||u,Ie=s.convert(he.format,he.encoding),ye=s.convert(he.type),nt=j(he.internalFormat,Ie,ye,he.encoding),at=u&&he.isVideoTexture!==!0,mt=Z.__currentVersion===void 0||V===!0;let wt=J(he,X,xe);me(34067,he,xe);let Lt;if(B){at&&mt&&n.texStorage2D(34067,wt,nt,X.width,X.height);for(let Ct=0;Ct<6;Ct++){Lt=R[Ct].mipmaps;for(let ut=0;ut<Lt.length;ut++){const St=Lt[ut];he.format!==Mo?Ie!==null?at?n.compressedTexSubImage2D(34069+Ct,ut,0,0,St.width,St.height,Ie,St.data):n.compressedTexImage2D(34069+Ct,ut,nt,St.width,St.height,0,St.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):at?n.texSubImage2D(34069+Ct,ut,0,0,St.width,St.height,Ie,ye,St.data):n.texImage2D(34069+Ct,ut,nt,St.width,St.height,0,Ie,ye,St.data)}}}else{Lt=he.mipmaps,at&&mt&&(Lt.length>0&&wt++,n.texStorage2D(34067,wt,nt,R[0].width,R[0].height));for(let Ct=0;Ct<6;Ct++)if(S){at?n.texSubImage2D(34069+Ct,0,0,0,R[Ct].width,R[Ct].height,Ie,ye,R[Ct].data):n.texImage2D(34069+Ct,0,nt,R[Ct].width,R[Ct].height,0,Ie,ye,R[Ct].data);for(let ut=0;ut<Lt.length;ut++){const Tt=Lt[ut].image[Ct].image;at?n.texSubImage2D(34069+Ct,ut+1,0,0,Tt.width,Tt.height,Ie,ye,Tt.data):n.texImage2D(34069+Ct,ut+1,nt,Tt.width,Tt.height,0,Ie,ye,Tt.data)}}else{at?n.texSubImage2D(34069+Ct,0,0,0,Ie,ye,R[Ct]):n.texImage2D(34069+Ct,0,nt,Ie,ye,R[Ct]);for(let ut=0;ut<Lt.length;ut++){const St=Lt[ut];at?n.texSubImage2D(34069+Ct,ut+1,0,0,Ie,ye,St.image[Ct]):n.texImage2D(34069+Ct,ut+1,nt,Ie,ye,St.image[Ct])}}}k(he,xe)&&W(34067),Z.__currentVersion=Z.version,he.onUpdate&&he.onUpdate(he)}ce.__version=he.version}function rt(ce,he,ie,V,Z){const B=s.convert(ie.format,ie.encoding),S=s.convert(ie.type),R=j(ie.internalFormat,B,S,ie.encoding);i.get(he).__hasExternalTextures||(Z===32879||Z===35866?n.texImage3D(Z,0,R,he.width,he.height,he.depth,0,B,S,null):n.texImage2D(Z,0,R,he.width,he.height,0,B,S,null)),n.bindFramebuffer(36160,ce),Ee(he)?y.framebufferTexture2DMultisampleEXT(36160,V,Z,i.get(ie).__webglTexture,0,_e(he)):a.framebufferTexture2D(36160,V,Z,i.get(ie).__webglTexture,0),n.bindFramebuffer(36160,null)}function vt(ce,he,ie){if(a.bindRenderbuffer(36161,ce),he.depthBuffer&&!he.stencilBuffer){let V=33189;if(ie||Ee(he)){const Z=he.depthTexture;Z&&Z.isDepthTexture&&(Z.type===Bl?V=36012:Z.type===Tc&&(V=33190));const B=_e(he);Ee(he)?y.renderbufferStorageMultisampleEXT(36161,B,V,he.width,he.height):a.renderbufferStorageMultisample(36161,B,V,he.width,he.height)}else a.renderbufferStorage(36161,V,he.width,he.height);a.framebufferRenderbuffer(36160,36096,36161,ce)}else if(he.depthBuffer&&he.stencilBuffer){const V=_e(he);ie&&Ee(he)===!1?a.renderbufferStorageMultisample(36161,V,35056,he.width,he.height):Ee(he)?y.renderbufferStorageMultisampleEXT(36161,V,35056,he.width,he.height):a.renderbufferStorage(36161,34041,he.width,he.height),a.framebufferRenderbuffer(36160,33306,36161,ce)}else{const V=he.isWebGLMultipleRenderTargets===!0?he.texture:[he.texture];for(let Z=0;Z<V.length;Z++){const B=V[Z],S=s.convert(B.format,B.encoding),R=s.convert(B.type),X=j(B.internalFormat,S,R,B.encoding),xe=_e(he);ie&&Ee(he)===!1?a.renderbufferStorageMultisample(36161,xe,X,he.width,he.height):Ee(he)?y.renderbufferStorageMultisampleEXT(36161,xe,X,he.width,he.height):a.renderbufferStorage(36161,X,he.width,he.height)}}a.bindRenderbuffer(36161,null)}function Ye(ce,he){if(he&&he.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(n.bindFramebuffer(36160,ce),!(he.depthTexture&&he.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");(!i.get(he.depthTexture).__webglTexture||he.depthTexture.image.width!==he.width||he.depthTexture.image.height!==he.height)&&(he.depthTexture.image.width=he.width,he.depthTexture.image.height=he.height,he.depthTexture.needsUpdate=!0),G(he.depthTexture,0);const V=i.get(he.depthTexture).__webglTexture,Z=_e(he);if(he.depthTexture.format===Bc)Ee(he)?y.framebufferTexture2DMultisampleEXT(36160,36096,3553,V,0,Z):a.framebufferTexture2D(36160,36096,3553,V,0);else if(he.depthTexture.format===dh)Ee(he)?y.framebufferTexture2DMultisampleEXT(36160,33306,3553,V,0,Z):a.framebufferTexture2D(36160,33306,3553,V,0);else throw new Error("Unknown depthTexture format")}function Pe(ce){const he=i.get(ce),ie=ce.isWebGLCubeRenderTarget===!0;if(ce.depthTexture&&!he.__autoAllocateDepthBuffer){if(ie)throw new Error("target.depthTexture not supported in Cube render targets");Ye(he.__webglFramebuffer,ce)}else if(ie){he.__webglDepthbuffer=[];for(let V=0;V<6;V++)n.bindFramebuffer(36160,he.__webglFramebuffer[V]),he.__webglDepthbuffer[V]=a.createRenderbuffer(),vt(he.__webglDepthbuffer[V],ce,!1)}else n.bindFramebuffer(36160,he.__webglFramebuffer),he.__webglDepthbuffer=a.createRenderbuffer(),vt(he.__webglDepthbuffer,ce,!1);n.bindFramebuffer(36160,null)}function Be(ce,he,ie){const V=i.get(ce);he!==void 0&&rt(V.__webglFramebuffer,ce,ce.texture,36064,3553),ie!==void 0&&Pe(ce)}function $e(ce){const he=ce.texture,ie=i.get(ce),V=i.get(he);ce.addEventListener("dispose",N),ce.isWebGLMultipleRenderTargets!==!0&&(V.__webglTexture===void 0&&(V.__webglTexture=a.createTexture()),V.__version=he.version,c.memory.textures++);const Z=ce.isWebGLCubeRenderTarget===!0,B=ce.isWebGLMultipleRenderTargets===!0,S=D(ce)||u;if(Z){ie.__webglFramebuffer=[];for(let R=0;R<6;R++)ie.__webglFramebuffer[R]=a.createFramebuffer()}else{if(ie.__webglFramebuffer=a.createFramebuffer(),B)if(o.drawBuffers){const R=ce.texture;for(let X=0,xe=R.length;X<xe;X++){const Ie=i.get(R[X]);Ie.__webglTexture===void 0&&(Ie.__webglTexture=a.createTexture(),c.memory.textures++)}}else console.warn("THREE.WebGLRenderer: WebGLMultipleRenderTargets can only be used with WebGL2 or WEBGL_draw_buffers extension.");if(u&&ce.samples>0&&Ee(ce)===!1){const R=B?he:[he];ie.__webglMultisampledFramebuffer=a.createFramebuffer(),ie.__webglColorRenderbuffer=[],n.bindFramebuffer(36160,ie.__webglMultisampledFramebuffer);for(let X=0;X<R.length;X++){const xe=R[X];ie.__webglColorRenderbuffer[X]=a.createRenderbuffer(),a.bindRenderbuffer(36161,ie.__webglColorRenderbuffer[X]);const Ie=s.convert(xe.format,xe.encoding),ye=s.convert(xe.type),nt=j(xe.internalFormat,Ie,ye,xe.encoding),at=_e(ce);a.renderbufferStorageMultisample(36161,at,nt,ce.width,ce.height),a.framebufferRenderbuffer(36160,36064+X,36161,ie.__webglColorRenderbuffer[X])}a.bindRenderbuffer(36161,null),ce.depthBuffer&&(ie.__webglDepthRenderbuffer=a.createRenderbuffer(),vt(ie.__webglDepthRenderbuffer,ce,!0)),n.bindFramebuffer(36160,null)}}if(Z){n.bindTexture(34067,V.__webglTexture),me(34067,he,S);for(let R=0;R<6;R++)rt(ie.__webglFramebuffer[R],ce,he,36064,34069+R);k(he,S)&&W(34067),n.unbindTexture()}else if(B){const R=ce.texture;for(let X=0,xe=R.length;X<xe;X++){const Ie=R[X],ye=i.get(Ie);n.bindTexture(3553,ye.__webglTexture),me(3553,Ie,S),rt(ie.__webglFramebuffer,ce,Ie,36064+X,3553),k(Ie,S)&&W(3553)}n.unbindTexture()}else{let R=3553;(ce.isWebGL3DRenderTarget||ce.isWebGLArrayRenderTarget)&&(u?R=ce.isWebGL3DRenderTarget?32879:35866:console.error("THREE.WebGLTextures: THREE.Data3DTexture and THREE.DataArrayTexture only supported with WebGL2.")),n.bindTexture(R,V.__webglTexture),me(R,he,S),rt(ie.__webglFramebuffer,ce,he,36064,R),k(he,S)&&W(R),n.unbindTexture()}ce.depthBuffer&&Pe(ce)}function Je(ce){const he=D(ce)||u,ie=ce.isWebGLMultipleRenderTargets===!0?ce.texture:[ce.texture];for(let V=0,Z=ie.length;V<Z;V++){const B=ie[V];if(k(B,he)){const S=ce.isWebGLCubeRenderTarget?34067:3553,R=i.get(B).__webglTexture;n.bindTexture(S,R),W(S),n.unbindTexture()}}}function We(ce){if(u&&ce.samples>0&&Ee(ce)===!1){const he=ce.isWebGLMultipleRenderTargets?ce.texture:[ce.texture],ie=ce.width,V=ce.height;let Z=16384;const B=[],S=ce.stencilBuffer?33306:36096,R=i.get(ce),X=ce.isWebGLMultipleRenderTargets===!0;if(X)for(let xe=0;xe<he.length;xe++)n.bindFramebuffer(36160,R.__webglMultisampledFramebuffer),a.framebufferRenderbuffer(36160,36064+xe,36161,null),n.bindFramebuffer(36160,R.__webglFramebuffer),a.framebufferTexture2D(36009,36064+xe,3553,null,0);n.bindFramebuffer(36008,R.__webglMultisampledFramebuffer),n.bindFramebuffer(36009,R.__webglFramebuffer);for(let xe=0;xe<he.length;xe++){B.push(36064+xe),ce.depthBuffer&&B.push(S);const Ie=R.__ignoreDepthValues!==void 0?R.__ignoreDepthValues:!1;if(Ie===!1&&(ce.depthBuffer&&(Z|=256),ce.stencilBuffer&&(Z|=1024)),X&&a.framebufferRenderbuffer(36008,36064,36161,R.__webglColorRenderbuffer[xe]),Ie===!0&&(a.invalidateFramebuffer(36008,[S]),a.invalidateFramebuffer(36009,[S])),X){const ye=i.get(he[xe]).__webglTexture;a.framebufferTexture2D(36009,36064,3553,ye,0)}a.blitFramebuffer(0,0,ie,V,0,0,ie,V,Z,9728),g&&a.invalidateFramebuffer(36008,B)}if(n.bindFramebuffer(36008,null),n.bindFramebuffer(36009,null),X)for(let xe=0;xe<he.length;xe++){n.bindFramebuffer(36160,R.__webglMultisampledFramebuffer),a.framebufferRenderbuffer(36160,36064+xe,36161,R.__webglColorRenderbuffer[xe]);const Ie=i.get(he[xe]).__webglTexture;n.bindFramebuffer(36160,R.__webglFramebuffer),a.framebufferTexture2D(36009,36064+xe,3553,Ie,0)}n.bindFramebuffer(36009,R.__webglMultisampledFramebuffer)}}function _e(ce){return Math.min(m,ce.samples)}function Ee(ce){const he=i.get(ce);return u&&ce.samples>0&&t.has("WEBGL_multisampled_render_to_texture")===!0&&he.__useRenderToTexture!==!1}function Oe(ce){const he=c.render.frame;_.get(ce)!==he&&(_.set(ce,he),ce.update())}function Le(ce,he){const ie=ce.encoding,V=ce.format,Z=ce.type;return ce.isCompressedTexture===!0||ce.isVideoTexture===!0||ce.format===Uv||ie!==Gc&&(ie===_r?u===!1?t.has("EXT_sRGB")===!0&&V===Mo?(ce.format=Uv,ce.minFilter=Vr,ce.generateMipmaps=!1):he=P_.sRGBToLinear(he):(V!==Mo||Z!==Hc)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture encoding:",ie)),he}this.allocateTextureUnit=ee,this.resetTextureUnits=$,this.setTexture2D=G,this.setTexture2DArray=K,this.setTexture3D=Y,this.setTextureCube=we,this.rebindTextures=Be,this.setupRenderTarget=$e,this.updateRenderTargetMipmap=Je,this.updateMultisampleRenderTarget=We,this.setupDepthRenderbuffer=Pe,this.setupFrameBufferTexture=rt,this.useMultisampledRTT=Ee}function wR(a,t,n){const i=n.isWebGL2;function o(s,c=null){let u;if(s===Hc)return 5121;if(s===XC)return 32819;if(s===$C)return 32820;if(s===VC)return 5120;if(s===WC)return 5122;if(s===C_)return 5123;if(s===jC)return 5124;if(s===Tc)return 5125;if(s===Bl)return 5126;if(s===od)return i?5131:(u=t.get("OES_texture_half_float"),u!==null?u.HALF_FLOAT_OES:null);if(s===qC)return 6406;if(s===Mo)return 6408;if(s===QC)return 6409;if(s===KC)return 6410;if(s===Bc)return 6402;if(s===dh)return 34041;if(s===ZC)return 6403;if(s===YC)return console.warn("THREE.WebGLRenderer: THREE.RGBFormat has been removed. Use THREE.RGBAFormat instead. https://github.com/mrdoob/three.js/pull/23228"),6408;if(s===Uv)return u=t.get("EXT_sRGB"),u!==null?u.SRGB_ALPHA_EXT:null;if(s===JC)return 36244;if(s===eR)return 33319;if(s===tR)return 33320;if(s===nR)return 36249;if(s===dv||s===pv||s===mv||s===gv)if(c===_r)if(u=t.get("WEBGL_compressed_texture_s3tc_srgb"),u!==null){if(s===dv)return u.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(s===pv)return u.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(s===mv)return u.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(s===gv)return u.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(u=t.get("WEBGL_compressed_texture_s3tc"),u!==null){if(s===dv)return u.COMPRESSED_RGB_S3TC_DXT1_EXT;if(s===pv)return u.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(s===mv)return u.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(s===gv)return u.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(s===ub||s===hb||s===fb||s===db)if(u=t.get("WEBGL_compressed_texture_pvrtc"),u!==null){if(s===ub)return u.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(s===hb)return u.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(s===fb)return u.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(s===db)return u.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(s===iR)return u=t.get("WEBGL_compressed_texture_etc1"),u!==null?u.COMPRESSED_RGB_ETC1_WEBGL:null;if(s===pb||s===mb)if(u=t.get("WEBGL_compressed_texture_etc"),u!==null){if(s===pb)return c===_r?u.COMPRESSED_SRGB8_ETC2:u.COMPRESSED_RGB8_ETC2;if(s===mb)return c===_r?u.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:u.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(s===gb||s===vb||s===yb||s===xb||s===Ab||s===bb||s===_b||s===wb||s===Eb||s===Mb||s===Sb||s===Tb||s===Cb||s===Rb)if(u=t.get("WEBGL_compressed_texture_astc"),u!==null){if(s===gb)return c===_r?u.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:u.COMPRESSED_RGBA_ASTC_4x4_KHR;if(s===vb)return c===_r?u.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:u.COMPRESSED_RGBA_ASTC_5x4_KHR;if(s===yb)return c===_r?u.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:u.COMPRESSED_RGBA_ASTC_5x5_KHR;if(s===xb)return c===_r?u.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:u.COMPRESSED_RGBA_ASTC_6x5_KHR;if(s===Ab)return c===_r?u.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:u.COMPRESSED_RGBA_ASTC_6x6_KHR;if(s===bb)return c===_r?u.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:u.COMPRESSED_RGBA_ASTC_8x5_KHR;if(s===_b)return c===_r?u.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:u.COMPRESSED_RGBA_ASTC_8x6_KHR;if(s===wb)return c===_r?u.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:u.COMPRESSED_RGBA_ASTC_8x8_KHR;if(s===Eb)return c===_r?u.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:u.COMPRESSED_RGBA_ASTC_10x5_KHR;if(s===Mb)return c===_r?u.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:u.COMPRESSED_RGBA_ASTC_10x6_KHR;if(s===Sb)return c===_r?u.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:u.COMPRESSED_RGBA_ASTC_10x8_KHR;if(s===Tb)return c===_r?u.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:u.COMPRESSED_RGBA_ASTC_10x10_KHR;if(s===Cb)return c===_r?u.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:u.COMPRESSED_RGBA_ASTC_12x10_KHR;if(s===Rb)return c===_r?u.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:u.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(s===Lb)if(u=t.get("EXT_texture_compression_bptc"),u!==null){if(s===Lb)return c===_r?u.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:u.COMPRESSED_RGBA_BPTC_UNORM_EXT}else return null;return s===sh?i?34042:(u=t.get("WEBGL_depth_texture"),u!==null?u.UNSIGNED_INT_24_8_WEBGL:null):a[s]!==void 0?a[s]:null}return{convert:o}}class ER extends Es{constructor(t=[]){super(),this.isArrayCamera=!0,this.cameras=t}}class Qf extends or{constructor(){super(),this.isGroup=!0,this.type="Group"}}const IH={type:"move"};class uA{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Qf,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Qf,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new Ze,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new Ze),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Qf,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new Ze,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new Ze),this._grip}dispatchEvent(t){return this._targetRay!==null&&this._targetRay.dispatchEvent(t),this._grip!==null&&this._grip.dispatchEvent(t),this._hand!==null&&this._hand.dispatchEvent(t),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(t,n,i){let o=null,s=null,c=null;const u=this._targetRay,h=this._grip,f=this._hand;if(t&&n.session.visibilityState!=="visible-blurred")if(u!==null&&(o=n.getPose(t.targetRaySpace,i),o!==null&&(u.matrix.fromArray(o.transform.matrix),u.matrix.decompose(u.position,u.rotation,u.scale),o.linearVelocity?(u.hasLinearVelocity=!0,u.linearVelocity.copy(o.linearVelocity)):u.hasLinearVelocity=!1,o.angularVelocity?(u.hasAngularVelocity=!0,u.angularVelocity.copy(o.angularVelocity)):u.hasAngularVelocity=!1,this.dispatchEvent(IH))),f&&t.hand){c=!0;for(const x of t.hand.values()){const b=n.getJointPose(x,i);if(f.joints[x.jointName]===void 0){const T=new Qf;T.matrixAutoUpdate=!1,T.visible=!1,f.joints[x.jointName]=T,f.add(T)}const E=f.joints[x.jointName];b!==null&&(E.matrix.fromArray(b.transform.matrix),E.matrix.decompose(E.position,E.rotation,E.scale),E.jointRadius=b.radius),E.visible=b!==null}const p=f.joints["index-finger-tip"],m=f.joints["thumb-tip"],y=p.position.distanceTo(m.position),g=.02,_=.005;f.inputState.pinching&&y>g+_?(f.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!f.inputState.pinching&&y<=g-_&&(f.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else h!==null&&t.gripSpace&&(s=n.getPose(t.gripSpace,i),s!==null&&(h.matrix.fromArray(s.transform.matrix),h.matrix.decompose(h.position,h.rotation,h.scale),s.linearVelocity?(h.hasLinearVelocity=!0,h.linearVelocity.copy(s.linearVelocity)):h.hasLinearVelocity=!1,s.angularVelocity?(h.hasAngularVelocity=!0,h.angularVelocity.copy(s.angularVelocity)):h.hasAngularVelocity=!1));return u!==null&&(u.visible=o!==null),h!==null&&(h.visible=s!==null),f!==null&&(f.visible=c!==null),this}}class MR extends is{constructor(t,n,i,o,s,c,u,h,f,p){if(p=p!==void 0?p:Bc,p!==Bc&&p!==dh)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");i===void 0&&p===Bc&&(i=Tc),i===void 0&&p===dh&&(i=sh),super(null,o,s,c,u,h,p,i,f),this.isDepthTexture=!0,this.image={width:t,height:n},this.magFilter=u!==void 0?u:Qr,this.minFilter=h!==void 0?h:Qr,this.flipY=!1,this.generateMipmaps=!1}}class OH extends $c{constructor(t,n){super();const i=this;let o=null,s=1,c=null,u="local-floor",h=null,f=null,p=null,m=null,y=null,g=null;const _=n.getContextAttributes();let x=null,b=null;const E=[],T=new Map,P=new Es;P.layers.enable(1),P.viewport=new ur;const D=new Es;D.layers.enable(2),D.viewport=new ur;const F=[P,D],k=new ER;k.layers.enable(1),k.layers.enable(2);let W=null,j=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(Q){let G=E[Q];return G===void 0&&(G=new uA,E[Q]=G),G.getTargetRaySpace()},this.getControllerGrip=function(Q){let G=E[Q];return G===void 0&&(G=new uA,E[Q]=G),G.getGripSpace()},this.getHand=function(Q){let G=E[Q];return G===void 0&&(G=new uA,E[Q]=G),G.getHandSpace()};function J(Q){const G=T.get(Q.inputSource);G!==void 0&&G.dispatchEvent({type:Q.type,data:Q.inputSource})}function de(){o.removeEventListener("select",J),o.removeEventListener("selectstart",J),o.removeEventListener("selectend",J),o.removeEventListener("squeeze",J),o.removeEventListener("squeezestart",J),o.removeEventListener("squeezeend",J),o.removeEventListener("end",de),o.removeEventListener("inputsourceschange",te),T.forEach(function(Q,G){Q!==void 0&&Q.disconnect(G)}),T.clear(),W=null,j=null,t.setRenderTarget(x),y=null,m=null,p=null,o=null,b=null,ee.stop(),i.isPresenting=!1,i.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(Q){s=Q,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(Q){u=Q,i.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return h||c},this.setReferenceSpace=function(Q){h=Q},this.getBaseLayer=function(){return m!==null?m:y},this.getBinding=function(){return p},this.getFrame=function(){return g},this.getSession=function(){return o},this.setSession=async function(Q){if(o=Q,o!==null){if(x=t.getRenderTarget(),o.addEventListener("select",J),o.addEventListener("selectstart",J),o.addEventListener("selectend",J),o.addEventListener("squeeze",J),o.addEventListener("squeezestart",J),o.addEventListener("squeezeend",J),o.addEventListener("end",de),o.addEventListener("inputsourceschange",te),_.xrCompatible!==!0&&await n.makeXRCompatible(),o.renderState.layers===void 0||t.capabilities.isWebGL2===!1){const G={antialias:o.renderState.layers===void 0?_.antialias:!0,alpha:_.alpha,depth:_.depth,stencil:_.stencil,framebufferScaleFactor:s};y=new XRWebGLLayer(o,n,G),o.updateRenderState({baseLayer:y}),b=new Ro(y.framebufferWidth,y.framebufferHeight,{format:Mo,type:Hc,encoding:t.outputEncoding})}else{let G=null,K=null,Y=null;_.depth&&(Y=_.stencil?35056:33190,G=_.stencil?dh:Bc,K=_.stencil?sh:Tc);const we={colorFormat:t.outputEncoding===_r?35907:32856,depthFormat:Y,scaleFactor:s};p=new XRWebGLBinding(o,n),m=p.createProjectionLayer(we),o.updateRenderState({layers:[m]}),b=new Ro(m.textureWidth,m.textureHeight,{format:Mo,type:Hc,depthTexture:new MR(m.textureWidth,m.textureHeight,K,void 0,void 0,void 0,void 0,void 0,void 0,G),stencilBuffer:_.stencil,encoding:t.outputEncoding,samples:_.antialias?4:0});const Ke=t.properties.get(b);Ke.__ignoreDepthValues=m.ignoreDepthValues}b.isXRRenderTarget=!0,this.setFoveation(1),h=null,c=await o.requestReferenceSpace(u),ee.setContext(o),ee.start(),i.isPresenting=!0,i.dispatchEvent({type:"sessionstart"})}};function te(Q){const G=o.inputSources;for(let K=0;K<G.length;K++){const Y=G[K].handedness==="right"?1:0;T.set(G[K],E[Y])}for(let K=0;K<Q.removed.length;K++){const Y=Q.removed[K],we=T.get(Y);we&&(we.dispatchEvent({type:"disconnected",data:Y}),T.delete(Y))}for(let K=0;K<Q.added.length;K++){const Y=Q.added[K],we=T.get(Y);we&&we.dispatchEvent({type:"connected",data:Y})}}const N=new Ze,L=new Ze;function M(Q,G,K){N.setFromMatrixPosition(G.matrixWorld),L.setFromMatrixPosition(K.matrixWorld);const Y=N.distanceTo(L),we=G.projectionMatrix.elements,Ke=K.projectionMatrix.elements,ge=we[14]/(we[10]-1),me=we[14]/(we[10]+1),De=(we[9]+1)/we[5],ze=(we[9]-1)/we[5],tt=(we[8]-1)/we[0],rt=(Ke[8]+1)/Ke[0],vt=ge*tt,Ye=ge*rt,Pe=Y/(-tt+rt),Be=Pe*-tt;G.matrixWorld.decompose(Q.position,Q.quaternion,Q.scale),Q.translateX(Be),Q.translateZ(Pe),Q.matrixWorld.compose(Q.position,Q.quaternion,Q.scale),Q.matrixWorldInverse.copy(Q.matrixWorld).invert();const $e=ge+Pe,Je=me+Pe,We=vt-Be,_e=Ye+(Y-Be),Ee=De*me/Je*$e,Oe=ze*me/Je*$e;Q.projectionMatrix.makePerspective(We,_e,Ee,Oe,$e,Je)}function I(Q,G){G===null?Q.matrixWorld.copy(Q.matrix):Q.matrixWorld.multiplyMatrices(G.matrixWorld,Q.matrix),Q.matrixWorldInverse.copy(Q.matrixWorld).invert()}this.updateCamera=function(Q){if(o===null)return;k.near=D.near=P.near=Q.near,k.far=D.far=P.far=Q.far,(W!==k.near||j!==k.far)&&(o.updateRenderState({depthNear:k.near,depthFar:k.far}),W=k.near,j=k.far);const G=Q.parent,K=k.cameras;I(k,G);for(let we=0;we<K.length;we++)I(K[we],G);k.matrixWorld.decompose(k.position,k.quaternion,k.scale),Q.position.copy(k.position),Q.quaternion.copy(k.quaternion),Q.scale.copy(k.scale),Q.matrix.copy(k.matrix),Q.matrixWorld.copy(k.matrixWorld);const Y=Q.children;for(let we=0,Ke=Y.length;we<Ke;we++)Y[we].updateMatrixWorld(!0);K.length===2?M(k,P,D):k.projectionMatrix.copy(P.projectionMatrix)},this.getCamera=function(){return k},this.getFoveation=function(){if(m!==null)return m.fixedFoveation;if(y!==null)return y.fixedFoveation},this.setFoveation=function(Q){m!==null&&(m.fixedFoveation=Q),y!==null&&y.fixedFoveation!==void 0&&(y.fixedFoveation=Q)};let U=null;function $(Q,G){if(f=G.getViewerPose(h||c),g=G,f!==null){const Y=f.views;y!==null&&(t.setRenderTargetFramebuffer(b,y.framebuffer),t.setRenderTarget(b));let we=!1;Y.length!==k.cameras.length&&(k.cameras.length=0,we=!0);for(let Ke=0;Ke<Y.length;Ke++){const ge=Y[Ke];let me=null;if(y!==null)me=y.getViewport(ge);else{const ze=p.getViewSubImage(m,ge);me=ze.viewport,Ke===0&&(t.setRenderTargetTextures(b,ze.colorTexture,m.ignoreDepthValues?void 0:ze.depthStencilTexture),t.setRenderTarget(b))}let De=F[Ke];De===void 0&&(De=new Es,De.layers.enable(Ke),De.viewport=new ur,F[Ke]=De),De.matrix.fromArray(ge.transform.matrix),De.projectionMatrix.fromArray(ge.projectionMatrix),De.viewport.set(me.x,me.y,me.width,me.height),Ke===0&&k.matrix.copy(De.matrix),we===!0&&k.cameras.push(De)}}const K=o.inputSources;for(let Y=0;Y<E.length;Y++){const we=K[Y],Ke=T.get(we);Ke!==void 0&&Ke.update(we,G,h||c)}U&&U(Q,G),g=null}const ee=new vR;ee.setAnimationLoop($),this.setAnimationLoop=function(Q){U=Q},this.dispose=function(){}}}function DH(a,t){function n(x,b){x.fogColor.value.copy(b.color),b.isFog?(x.fogNear.value=b.near,x.fogFar.value=b.far):b.isFogExp2&&(x.fogDensity.value=b.density)}function i(x,b,E,T,P){b.isMeshBasicMaterial||b.isMeshLambertMaterial?o(x,b):b.isMeshToonMaterial?(o(x,b),p(x,b)):b.isMeshPhongMaterial?(o(x,b),f(x,b)):b.isMeshStandardMaterial?(o(x,b),m(x,b),b.isMeshPhysicalMaterial&&y(x,b,P)):b.isMeshMatcapMaterial?(o(x,b),g(x,b)):b.isMeshDepthMaterial?o(x,b):b.isMeshDistanceMaterial?(o(x,b),_(x,b)):b.isMeshNormalMaterial?o(x,b):b.isLineBasicMaterial?(s(x,b),b.isLineDashedMaterial&&c(x,b)):b.isPointsMaterial?u(x,b,E,T):b.isSpriteMaterial?h(x,b):b.isShadowMaterial?(x.color.value.copy(b.color),x.opacity.value=b.opacity):b.isShaderMaterial&&(b.uniformsNeedUpdate=!1)}function o(x,b){x.opacity.value=b.opacity,b.color&&x.diffuse.value.copy(b.color),b.emissive&&x.emissive.value.copy(b.emissive).multiplyScalar(b.emissiveIntensity),b.map&&(x.map.value=b.map),b.alphaMap&&(x.alphaMap.value=b.alphaMap),b.bumpMap&&(x.bumpMap.value=b.bumpMap,x.bumpScale.value=b.bumpScale,b.side===To&&(x.bumpScale.value*=-1)),b.displacementMap&&(x.displacementMap.value=b.displacementMap,x.displacementScale.value=b.displacementScale,x.displacementBias.value=b.displacementBias),b.emissiveMap&&(x.emissiveMap.value=b.emissiveMap),b.normalMap&&(x.normalMap.value=b.normalMap,x.normalScale.value.copy(b.normalScale),b.side===To&&x.normalScale.value.negate()),b.specularMap&&(x.specularMap.value=b.specularMap),b.alphaTest>0&&(x.alphaTest.value=b.alphaTest);const E=t.get(b).envMap;if(E&&(x.envMap.value=E,x.flipEnvMap.value=E.isCubeTexture&&E.isRenderTargetTexture===!1?-1:1,x.reflectivity.value=b.reflectivity,x.ior.value=b.ior,x.refractionRatio.value=b.refractionRatio),b.lightMap){x.lightMap.value=b.lightMap;const D=a.physicallyCorrectLights!==!0?Math.PI:1;x.lightMapIntensity.value=b.lightMapIntensity*D}b.aoMap&&(x.aoMap.value=b.aoMap,x.aoMapIntensity.value=b.aoMapIntensity);let T;b.map?T=b.map:b.specularMap?T=b.specularMap:b.displacementMap?T=b.displacementMap:b.normalMap?T=b.normalMap:b.bumpMap?T=b.bumpMap:b.roughnessMap?T=b.roughnessMap:b.metalnessMap?T=b.metalnessMap:b.alphaMap?T=b.alphaMap:b.emissiveMap?T=b.emissiveMap:b.clearcoatMap?T=b.clearcoatMap:b.clearcoatNormalMap?T=b.clearcoatNormalMap:b.clearcoatRoughnessMap?T=b.clearcoatRoughnessMap:b.iridescenceMap?T=b.iridescenceMap:b.iridescenceThicknessMap?T=b.iridescenceThicknessMap:b.specularIntensityMap?T=b.specularIntensityMap:b.specularColorMap?T=b.specularColorMap:b.transmissionMap?T=b.transmissionMap:b.thicknessMap?T=b.thicknessMap:b.sheenColorMap?T=b.sheenColorMap:b.sheenRoughnessMap&&(T=b.sheenRoughnessMap),T!==void 0&&(T.isWebGLRenderTarget&&(T=T.texture),T.matrixAutoUpdate===!0&&T.updateMatrix(),x.uvTransform.value.copy(T.matrix));let P;b.aoMap?P=b.aoMap:b.lightMap&&(P=b.lightMap),P!==void 0&&(P.isWebGLRenderTarget&&(P=P.texture),P.matrixAutoUpdate===!0&&P.updateMatrix(),x.uv2Transform.value.copy(P.matrix))}function s(x,b){x.diffuse.value.copy(b.color),x.opacity.value=b.opacity}function c(x,b){x.dashSize.value=b.dashSize,x.totalSize.value=b.dashSize+b.gapSize,x.scale.value=b.scale}function u(x,b,E,T){x.diffuse.value.copy(b.color),x.opacity.value=b.opacity,x.size.value=b.size*E,x.scale.value=T*.5,b.map&&(x.map.value=b.map),b.alphaMap&&(x.alphaMap.value=b.alphaMap),b.alphaTest>0&&(x.alphaTest.value=b.alphaTest);let P;b.map?P=b.map:b.alphaMap&&(P=b.alphaMap),P!==void 0&&(P.matrixAutoUpdate===!0&&P.updateMatrix(),x.uvTransform.value.copy(P.matrix))}function h(x,b){x.diffuse.value.copy(b.color),x.opacity.value=b.opacity,x.rotation.value=b.rotation,b.map&&(x.map.value=b.map),b.alphaMap&&(x.alphaMap.value=b.alphaMap),b.alphaTest>0&&(x.alphaTest.value=b.alphaTest);let E;b.map?E=b.map:b.alphaMap&&(E=b.alphaMap),E!==void 0&&(E.matrixAutoUpdate===!0&&E.updateMatrix(),x.uvTransform.value.copy(E.matrix))}function f(x,b){x.specular.value.copy(b.specular),x.shininess.value=Math.max(b.shininess,1e-4)}function p(x,b){b.gradientMap&&(x.gradientMap.value=b.gradientMap)}function m(x,b){x.roughness.value=b.roughness,x.metalness.value=b.metalness,b.roughnessMap&&(x.roughnessMap.value=b.roughnessMap),b.metalnessMap&&(x.metalnessMap.value=b.metalnessMap),t.get(b).envMap&&(x.envMapIntensity.value=b.envMapIntensity)}function y(x,b,E){x.ior.value=b.ior,b.sheen>0&&(x.sheenColor.value.copy(b.sheenColor).multiplyScalar(b.sheen),x.sheenRoughness.value=b.sheenRoughness,b.sheenColorMap&&(x.sheenColorMap.value=b.sheenColorMap),b.sheenRoughnessMap&&(x.sheenRoughnessMap.value=b.sheenRoughnessMap)),b.clearcoat>0&&(x.clearcoat.value=b.clearcoat,x.clearcoatRoughness.value=b.clearcoatRoughness,b.clearcoatMap&&(x.clearcoatMap.value=b.clearcoatMap),b.clearcoatRoughnessMap&&(x.clearcoatRoughnessMap.value=b.clearcoatRoughnessMap),b.clearcoatNormalMap&&(x.clearcoatNormalScale.value.copy(b.clearcoatNormalScale),x.clearcoatNormalMap.value=b.clearcoatNormalMap,b.side===To&&x.clearcoatNormalScale.value.negate())),b.iridescence>0&&(x.iridescence.value=b.iridescence,x.iridescenceIOR.value=b.iridescenceIOR,x.iridescenceThicknessMinimum.value=b.iridescenceThicknessRange[0],x.iridescenceThicknessMaximum.value=b.iridescenceThicknessRange[1],b.iridescenceMap&&(x.iridescenceMap.value=b.iridescenceMap),b.iridescenceThicknessMap&&(x.iridescenceThicknessMap.value=b.iridescenceThicknessMap)),b.transmission>0&&(x.transmission.value=b.transmission,x.transmissionSamplerMap.value=E.texture,x.transmissionSamplerSize.value.set(E.width,E.height),b.transmissionMap&&(x.transmissionMap.value=b.transmissionMap),x.thickness.value=b.thickness,b.thicknessMap&&(x.thicknessMap.value=b.thicknessMap),x.attenuationDistance.value=b.attenuationDistance,x.attenuationColor.value.copy(b.attenuationColor)),x.specularIntensity.value=b.specularIntensity,x.specularColor.value.copy(b.specularColor),b.specularIntensityMap&&(x.specularIntensityMap.value=b.specularIntensityMap),b.specularColorMap&&(x.specularColorMap.value=b.specularColorMap)}function g(x,b){b.matcap&&(x.matcap.value=b.matcap)}function _(x,b){x.referencePosition.value.copy(b.referencePosition),x.nearDistance.value=b.nearDistance,x.farDistance.value=b.farDistance}return{refreshFogUniforms:n,refreshMaterialUniforms:i}}function BH(){const a=bm("canvas");return a.style.display="block",a}function SR(a={}){this.isWebGLRenderer=!0;const t=a.canvas!==void 0?a.canvas:BH(),n=a.context!==void 0?a.context:null,i=a.depth!==void 0?a.depth:!0,o=a.stencil!==void 0?a.stencil:!0,s=a.antialias!==void 0?a.antialias:!1,c=a.premultipliedAlpha!==void 0?a.premultipliedAlpha:!0,u=a.preserveDrawingBuffer!==void 0?a.preserveDrawingBuffer:!1,h=a.powerPreference!==void 0?a.powerPreference:"default",f=a.failIfMajorPerformanceCaveat!==void 0?a.failIfMajorPerformanceCaveat:!1;let p;n!==null?p=n.getContextAttributes().alpha:p=a.alpha!==void 0?a.alpha:!1;let m=null,y=null;const g=[],_=[];this.domElement=t,this.debug={checkShaderErrors:!0},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.outputEncoding=Gc,this.physicallyCorrectLights=!1,this.toneMapping=za,this.toneMappingExposure=1,Object.defineProperties(this,{gammaFactor:{get:function(){return console.warn("THREE.WebGLRenderer: .gammaFactor has been removed."),2},set:function(){console.warn("THREE.WebGLRenderer: .gammaFactor has been removed.")}}});const x=this;let b=!1,E=0,T=0,P=null,D=-1,F=null;const k=new ur,W=new ur;let j=null,J=t.width,de=t.height,te=1,N=null,L=null;const M=new ur(0,0,J,de),I=new ur(0,0,J,de);let U=!1;const $=new my;let ee=!1,Q=!1,G=null;const K=new Oi,Y=new yn,we=new Ze,Ke={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};function ge(){return P===null?te:1}let me=n;function De(le,be){for(let q=0;q<le.length;q++){const Se=le[q],Ge=t.getContext(Se,be);if(Ge!==null)return Ge}return null}try{const le={alpha:!0,depth:i,stencil:o,antialias:s,premultipliedAlpha:c,preserveDrawingBuffer:u,powerPreference:h,failIfMajorPerformanceCaveat:f};if("setAttribute"in t&&t.setAttribute("data-engine",`three.js r${cy}`),t.addEventListener("webglcontextlost",ye,!1),t.addEventListener("webglcontextrestored",nt,!1),t.addEventListener("webglcontextcreationerror",at,!1),me===null){const be=["webgl2","webgl","experimental-webgl"];if(x.isWebGL1Renderer===!0&&be.shift(),me=De(be,le),me===null)throw De(be)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}me.getShaderPrecisionFormat===void 0&&(me.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(le){throw console.error("THREE.WebGLRenderer: "+le.message),le}let ze,tt,rt,vt,Ye,Pe,Be,$e,Je,We,_e,Ee,Oe,Le,ce,he,ie,V,Z,B,S,R,X;function xe(){ze=new K7(me),tt=new j7(me,ze,a),ze.init(tt),R=new wR(me,ze,tt),rt=new LH(me,ze,tt),vt=new e9(me),Ye=new yH,Pe=new PH(me,ze,rt,Ye,tt,R,vt),Be=new $7(x),$e=new Q7(x),Je=new fk(me,tt),X=new V7(me,ze,Je,tt),We=new Z7(me,Je,vt,X),_e=new r9(me,We,Je,vt),Z=new i9(me,tt,Pe),he=new X7(Ye),Ee=new vH(x,Be,$e,ze,tt,X,he),Oe=new DH(x,Ye),Le=new AH,ce=new SH(ze,tt),V=new G7(x,Be,rt,_e,p,c),ie=new RH(x,_e,tt),B=new W7(me,ze,vt,tt),S=new J7(me,ze,vt,tt),vt.programs=Ee.programs,x.capabilities=tt,x.extensions=ze,x.properties=Ye,x.renderLists=Le,x.shadowMap=ie,x.state=rt,x.info=vt}xe();const Ie=new OH(x,me);this.xr=Ie,this.getContext=function(){return me},this.getContextAttributes=function(){return me.getContextAttributes()},this.forceContextLoss=function(){const le=ze.get("WEBGL_lose_context");le&&le.loseContext()},this.forceContextRestore=function(){const le=ze.get("WEBGL_lose_context");le&&le.restoreContext()},this.getPixelRatio=function(){return te},this.setPixelRatio=function(le){le!==void 0&&(te=le,this.setSize(J,de,!1))},this.getSize=function(le){return le.set(J,de)},this.setSize=function(le,be,q){if(Ie.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}J=le,de=be,t.width=Math.floor(le*te),t.height=Math.floor(be*te),q!==!1&&(t.style.width=le+"px",t.style.height=be+"px"),this.setViewport(0,0,le,be)},this.getDrawingBufferSize=function(le){return le.set(J*te,de*te).floor()},this.setDrawingBufferSize=function(le,be,q){J=le,de=be,te=q,t.width=Math.floor(le*q),t.height=Math.floor(be*q),this.setViewport(0,0,le,be)},this.getCurrentViewport=function(le){return le.copy(k)},this.getViewport=function(le){return le.copy(M)},this.setViewport=function(le,be,q,Se){le.isVector4?M.set(le.x,le.y,le.z,le.w):M.set(le,be,q,Se),rt.viewport(k.copy(M).multiplyScalar(te).floor())},this.getScissor=function(le){return le.copy(I)},this.setScissor=function(le,be,q,Se){le.isVector4?I.set(le.x,le.y,le.z,le.w):I.set(le,be,q,Se),rt.scissor(W.copy(I).multiplyScalar(te).floor())},this.getScissorTest=function(){return U},this.setScissorTest=function(le){rt.setScissorTest(U=le)},this.setOpaqueSort=function(le){N=le},this.setTransparentSort=function(le){L=le},this.getClearColor=function(le){return le.copy(V.getClearColor())},this.setClearColor=function(){V.setClearColor.apply(V,arguments)},this.getClearAlpha=function(){return V.getClearAlpha()},this.setClearAlpha=function(){V.setClearAlpha.apply(V,arguments)},this.clear=function(le=!0,be=!0,q=!0){let Se=0;le&&(Se|=16384),be&&(Se|=256),q&&(Se|=1024),me.clear(Se)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){t.removeEventListener("webglcontextlost",ye,!1),t.removeEventListener("webglcontextrestored",nt,!1),t.removeEventListener("webglcontextcreationerror",at,!1),Le.dispose(),ce.dispose(),Ye.dispose(),Be.dispose(),$e.dispose(),_e.dispose(),X.dispose(),Ee.dispose(),Ie.dispose(),Ie.removeEventListener("sessionstart",St),Ie.removeEventListener("sessionend",Tt),G&&(G.dispose(),G=null),gn.stop()};function ye(le){le.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),b=!0}function nt(){console.log("THREE.WebGLRenderer: Context Restored."),b=!1;const le=vt.autoReset,be=ie.enabled,q=ie.autoUpdate,Se=ie.needsUpdate,Ge=ie.type;xe(),vt.autoReset=le,ie.enabled=be,ie.autoUpdate=q,ie.needsUpdate=Se,ie.type=Ge}function at(le){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",le.statusMessage)}function mt(le){const be=le.target;be.removeEventListener("dispose",mt),wt(be)}function wt(le){Lt(le),Ye.remove(le)}function Lt(le){const be=Ye.get(le).programs;be!==void 0&&(be.forEach(function(q){Ee.releaseProgram(q)}),le.isShaderMaterial&&Ee.releaseShaderCache(le))}this.renderBufferDirect=function(le,be,q,Se,Ge,lt){be===null&&(be=Ke);const dt=Ge.isMesh&&Ge.matrixWorld.determinant()<0,Re=xn(le,be,q,Se,Ge);rt.setMaterial(Se,dt);let Ue=q.index;const Xe=q.attributes.position;if(Ue===null){if(Xe===void 0||Xe.count===0)return}else if(Ue.count===0)return;let ft=1;Se.wireframe===!0&&(Ue=We.getWireframeAttribute(q),ft=2),X.setup(Ge,Se,Re,q,Ue);let it,xt=B;Ue!==null&&(it=Je.get(Ue),xt=S,xt.setIndex(it));const Dt=Ue!==null?Ue.count:Xe.count,Kt=q.drawRange.start*ft,Wt=q.drawRange.count*ft,bt=lt!==null?lt.start*ft:0,jt=lt!==null?lt.count*ft:1/0,on=Math.max(Kt,bt),$t=Math.min(Dt,Kt+Wt,bt+jt)-1,vn=Math.max(0,$t-on+1);if(vn!==0){if(Ge.isMesh)Se.wireframe===!0?(rt.setLineWidth(Se.wireframeLinewidth*ge()),xt.setMode(1)):xt.setMode(4);else if(Ge.isLine){let Jt=Se.linewidth;Jt===void 0&&(Jt=1),rt.setLineWidth(Jt*ge()),Ge.isLineSegments?xt.setMode(1):Ge.isLineLoop?xt.setMode(2):xt.setMode(3)}else Ge.isPoints?xt.setMode(0):Ge.isSprite&&xt.setMode(4);if(Ge.isInstancedMesh)xt.renderInstances(on,vn,Ge.count);else if(q.isInstancedBufferGeometry){const Jt=Math.min(q.instanceCount,q._maxInstanceCount);xt.renderInstances(on,vn,Jt)}else xt.render(on,vn)}},this.compile=function(le,be){y=ce.get(le),y.init(),_.push(y),le.traverseVisible(function(q){q.isLight&&q.layers.test(be.layers)&&(y.pushLight(q),q.castShadow&&y.pushShadow(q))}),y.setupLights(x.physicallyCorrectLights),le.traverse(function(q){const Se=q.material;if(Se)if(Array.isArray(Se))for(let Ge=0;Ge<Se.length;Ge++){const lt=Se[Ge];zn(lt,le,q)}else zn(Se,le,q)}),_.pop(),y=null};let Ct=null;function ut(le){Ct&&Ct(le)}function St(){gn.stop()}function Tt(){gn.start()}const gn=new vR;gn.setAnimationLoop(ut),typeof self!="undefined"&&gn.setContext(self),this.setAnimationLoop=function(le){Ct=le,Ie.setAnimationLoop(le),le===null?gn.stop():gn.start()},Ie.addEventListener("sessionstart",St),Ie.addEventListener("sessionend",Tt),this.render=function(le,be){if(be!==void 0&&be.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(b===!0)return;le.autoUpdate===!0&&le.updateMatrixWorld(),be.parent===null&&be.updateMatrixWorld(),Ie.enabled===!0&&Ie.isPresenting===!0&&(Ie.cameraAutoUpdate===!0&&Ie.updateCamera(be),be=Ie.getCamera()),le.isScene===!0&&le.onBeforeRender(x,le,be,P),y=ce.get(le,_.length),y.init(),_.push(y),K.multiplyMatrices(be.projectionMatrix,be.matrixWorldInverse),$.setFromProjectionMatrix(K),Q=this.localClippingEnabled,ee=he.init(this.clippingPlanes,Q,be),m=Le.get(le,g.length),m.init(),g.push(m),An(le,be,0,x.sortObjects),m.finish(),x.sortObjects===!0&&m.sort(N,L),ee===!0&&he.beginShadows();const q=y.state.shadowsArray;if(ie.render(q,le,be),ee===!0&&he.endShadows(),this.info.autoReset===!0&&this.info.reset(),V.render(m,le),y.setupLights(x.physicallyCorrectLights),be.isArrayCamera){const Se=be.cameras;for(let Ge=0,lt=Se.length;Ge<lt;Ge++){const dt=Se[Ge];un(m,le,dt,dt.viewport)}}else un(m,le,be);P!==null&&(Pe.updateMultisampleRenderTarget(P),Pe.updateRenderTargetMipmap(P)),le.isScene===!0&&le.onAfterRender(x,le,be),X.resetDefaultState(),D=-1,F=null,_.pop(),_.length>0?y=_[_.length-1]:y=null,g.pop(),g.length>0?m=g[g.length-1]:m=null};function An(le,be,q,Se){if(le.visible===!1)return;if(le.layers.test(be.layers)){if(le.isGroup)q=le.renderOrder;else if(le.isLOD)le.autoUpdate===!0&&le.update(be);else if(le.isLight)y.pushLight(le),le.castShadow&&y.pushShadow(le);else if(le.isSprite){if(!le.frustumCulled||$.intersectsSprite(le)){Se&&we.setFromMatrixPosition(le.matrixWorld).applyMatrix4(K);const dt=_e.update(le),Re=le.material;Re.visible&&m.push(le,dt,Re,q,we.z,null)}}else if((le.isMesh||le.isLine||le.isPoints)&&(le.isSkinnedMesh&&le.skeleton.frame!==vt.render.frame&&(le.skeleton.update(),le.skeleton.frame=vt.render.frame),!le.frustumCulled||$.intersectsObject(le))){Se&&we.setFromMatrixPosition(le.matrixWorld).applyMatrix4(K);const dt=_e.update(le),Re=le.material;if(Array.isArray(Re)){const Ue=dt.groups;for(let Xe=0,ft=Ue.length;Xe<ft;Xe++){const it=Ue[Xe],xt=Re[it.materialIndex];xt&&xt.visible&&m.push(le,dt,xt,q,we.z,it)}}else Re.visible&&m.push(le,dt,Re,q,we.z,null)}}const lt=le.children;for(let dt=0,Re=lt.length;dt<Re;dt++)An(lt[dt],be,q,Se)}function un(le,be,q,Se){const Ge=le.opaque,lt=le.transmissive,dt=le.transparent;y.setupLightsView(q),lt.length>0&&Mn(Ge,be,q),Se&&rt.viewport(k.copy(Se)),Ge.length>0&&Cn(Ge,be,q),lt.length>0&&Cn(lt,be,q),dt.length>0&&Cn(dt,be,q),rt.buffers.depth.setTest(!0),rt.buffers.depth.setMask(!0),rt.buffers.color.setMask(!0),rt.setPolygonOffset(!1)}function Mn(le,be,q){const Se=tt.isWebGL2;G===null&&(G=new Ro(1,1,{generateMipmaps:!0,type:ze.has("EXT_color_buffer_half_float")?od:Hc,minFilter:_h,samples:Se&&s===!0?4:0})),x.getDrawingBufferSize(Y),Se?G.setSize(Y.x,Y.y):G.setSize(kv(Y.x),kv(Y.y));const Ge=x.getRenderTarget();x.setRenderTarget(G),x.clear();const lt=x.toneMapping;x.toneMapping=za,Cn(le,be,q),x.toneMapping=lt,Pe.updateMultisampleRenderTarget(G),Pe.updateRenderTargetMipmap(G),x.setRenderTarget(Ge)}function Cn(le,be,q){const Se=be.isScene===!0?be.overrideMaterial:null;for(let Ge=0,lt=le.length;Ge<lt;Ge++){const dt=le[Ge],Re=dt.object,Ue=dt.geometry,Xe=Se===null?dt.material:Se,ft=dt.group;Re.layers.test(q.layers)&&wn(Re,be,q,Ue,Xe,ft)}}function wn(le,be,q,Se,Ge,lt){le.onBeforeRender(x,be,q,Se,Ge,lt),le.modelViewMatrix.multiplyMatrices(q.matrixWorldInverse,le.matrixWorld),le.normalMatrix.getNormalMatrix(le.modelViewMatrix),Ge.onBeforeRender(x,be,q,Se,le,lt),Ge.transparent===!0&&Ge.side===fh?(Ge.side=To,Ge.needsUpdate=!0,x.renderBufferDirect(q,be,Se,Ge,le,lt),Ge.side=hh,Ge.needsUpdate=!0,x.renderBufferDirect(q,be,Se,Ge,le,lt),Ge.side=fh):x.renderBufferDirect(q,be,Se,Ge,le,lt),le.onAfterRender(x,be,q,Se,Ge,lt)}function zn(le,be,q){be.isScene!==!0&&(be=Ke);const Se=Ye.get(le),Ge=y.state.lights,lt=y.state.shadowsArray,dt=Ge.state.version,Re=Ee.getParameters(le,Ge.state,lt,be,q),Ue=Ee.getProgramCacheKey(Re);let Xe=Se.programs;Se.environment=le.isMeshStandardMaterial?be.environment:null,Se.fog=be.fog,Se.envMap=(le.isMeshStandardMaterial?$e:Be).get(le.envMap||Se.environment),Xe===void 0&&(le.addEventListener("dispose",mt),Xe=new Map,Se.programs=Xe);let ft=Xe.get(Ue);if(ft!==void 0){if(Se.currentProgram===ft&&Se.lightsStateVersion===dt)return ai(le,Re),ft}else Re.uniforms=Ee.getUniforms(le),le.onBuild(q,Re,x),le.onBeforeCompile(Re,x),ft=Ee.acquireProgram(Re,Ue),Xe.set(Ue,ft),Se.uniforms=Re.uniforms;const it=Se.uniforms;(!le.isShaderMaterial&&!le.isRawShaderMaterial||le.clipping===!0)&&(it.clippingPlanes=he.uniform),ai(le,Re),Se.needsLights=Me(le),Se.lightsStateVersion=dt,Se.needsLights&&(it.ambientLightColor.value=Ge.state.ambient,it.lightProbe.value=Ge.state.probe,it.directionalLights.value=Ge.state.directional,it.directionalLightShadows.value=Ge.state.directionalShadow,it.spotLights.value=Ge.state.spot,it.spotLightShadows.value=Ge.state.spotShadow,it.rectAreaLights.value=Ge.state.rectArea,it.ltc_1.value=Ge.state.rectAreaLTC1,it.ltc_2.value=Ge.state.rectAreaLTC2,it.pointLights.value=Ge.state.point,it.pointLightShadows.value=Ge.state.pointShadow,it.hemisphereLights.value=Ge.state.hemi,it.directionalShadowMap.value=Ge.state.directionalShadowMap,it.directionalShadowMatrix.value=Ge.state.directionalShadowMatrix,it.spotShadowMap.value=Ge.state.spotShadowMap,it.spotShadowMatrix.value=Ge.state.spotShadowMatrix,it.pointShadowMap.value=Ge.state.pointShadowMap,it.pointShadowMatrix.value=Ge.state.pointShadowMatrix);const xt=ft.getUniforms(),Dt=Av.seqWithValue(xt.seq,it);return Se.currentProgram=ft,Se.uniformsList=Dt,ft}function ai(le,be){const q=Ye.get(le);q.outputEncoding=be.outputEncoding,q.instancing=be.instancing,q.skinning=be.skinning,q.morphTargets=be.morphTargets,q.morphNormals=be.morphNormals,q.morphColors=be.morphColors,q.morphTargetsCount=be.morphTargetsCount,q.numClippingPlanes=be.numClippingPlanes,q.numIntersection=be.numClipIntersection,q.vertexAlphas=be.vertexAlphas,q.vertexTangents=be.vertexTangents,q.toneMapping=be.toneMapping}function xn(le,be,q,Se,Ge){be.isScene!==!0&&(be=Ke),Pe.resetTextureUnits();const lt=be.fog,dt=Se.isMeshStandardMaterial?be.environment:null,Re=P===null?x.outputEncoding:P.isXRRenderTarget===!0?P.texture.encoding:Gc,Ue=(Se.isMeshStandardMaterial?$e:Be).get(Se.envMap||dt),Xe=Se.vertexColors===!0&&!!q.attributes.color&&q.attributes.color.itemSize===4,ft=!!Se.normalMap&&!!q.attributes.tangent,it=!!q.morphAttributes.position,xt=!!q.morphAttributes.normal,Dt=!!q.morphAttributes.color,Kt=Se.toneMapped?x.toneMapping:za,Wt=q.morphAttributes.position||q.morphAttributes.normal||q.morphAttributes.color,bt=Wt!==void 0?Wt.length:0,jt=Ye.get(Se),on=y.state.lights;if(ee===!0&&(Q===!0||le!==F)){const Bt=le===F&&Se.id===D;he.setState(Se,le,Bt)}let $t=!1;Se.version===jt.__version?(jt.needsLights&&jt.lightsStateVersion!==on.state.version||jt.outputEncoding!==Re||Ge.isInstancedMesh&&jt.instancing===!1||!Ge.isInstancedMesh&&jt.instancing===!0||Ge.isSkinnedMesh&&jt.skinning===!1||!Ge.isSkinnedMesh&&jt.skinning===!0||jt.envMap!==Ue||Se.fog===!0&&jt.fog!==lt||jt.numClippingPlanes!==void 0&&(jt.numClippingPlanes!==he.numPlanes||jt.numIntersection!==he.numIntersection)||jt.vertexAlphas!==Xe||jt.vertexTangents!==ft||jt.morphTargets!==it||jt.morphNormals!==xt||jt.morphColors!==Dt||jt.toneMapping!==Kt||tt.isWebGL2===!0&&jt.morphTargetsCount!==bt)&&($t=!0):($t=!0,jt.__version=Se.version);let vn=jt.currentProgram;$t===!0&&(vn=zn(Se,be,Ge));let Jt=!1,nn=!1,hn=!1;const rn=vn.getUniforms(),Rt=jt.uniforms;if(rt.useProgram(vn.program)&&(Jt=!0,nn=!0,hn=!0),Se.id!==D&&(D=Se.id,nn=!0),Jt||F!==le){if(rn.setValue(me,"projectionMatrix",le.projectionMatrix),tt.logarithmicDepthBuffer&&rn.setValue(me,"logDepthBufFC",2/(Math.log(le.far+1)/Math.LN2)),F!==le&&(F=le,nn=!0,hn=!0),Se.isShaderMaterial||Se.isMeshPhongMaterial||Se.isMeshToonMaterial||Se.isMeshStandardMaterial||Se.envMap){const Bt=rn.map.cameraPosition;Bt!==void 0&&Bt.setValue(me,we.setFromMatrixPosition(le.matrixWorld))}(Se.isMeshPhongMaterial||Se.isMeshToonMaterial||Se.isMeshLambertMaterial||Se.isMeshBasicMaterial||Se.isMeshStandardMaterial||Se.isShaderMaterial)&&rn.setValue(me,"isOrthographic",le.isOrthographicCamera===!0),(Se.isMeshPhongMaterial||Se.isMeshToonMaterial||Se.isMeshLambertMaterial||Se.isMeshBasicMaterial||Se.isMeshStandardMaterial||Se.isShaderMaterial||Se.isShadowMaterial||Ge.isSkinnedMesh)&&rn.setValue(me,"viewMatrix",le.matrixWorldInverse)}if(Ge.isSkinnedMesh){rn.setOptional(me,Ge,"bindMatrix"),rn.setOptional(me,Ge,"bindMatrixInverse");const Bt=Ge.skeleton;Bt&&(tt.floatVertexTextures?(Bt.boneTexture===null&&Bt.computeBoneTexture(),rn.setValue(me,"boneTexture",Bt.boneTexture,Pe),rn.setValue(me,"boneTextureSize",Bt.boneTextureSize)):console.warn("THREE.WebGLRenderer: SkinnedMesh can only be used with WebGL 2. With WebGL 1 OES_texture_float and vertex textures support is required."))}const yt=q.morphAttributes;return(yt.position!==void 0||yt.normal!==void 0||yt.color!==void 0&&tt.isWebGL2===!0)&&Z.update(Ge,q,Se,vn),(nn||jt.receiveShadow!==Ge.receiveShadow)&&(jt.receiveShadow=Ge.receiveShadow,rn.setValue(me,"receiveShadow",Ge.receiveShadow)),nn&&(rn.setValue(me,"toneMappingExposure",x.toneMappingExposure),jt.needsLights&&Zn(Rt,hn),lt&&Se.fog===!0&&Oe.refreshFogUniforms(Rt,lt),Oe.refreshMaterialUniforms(Rt,Se,te,de,G),Av.upload(me,jt.uniformsList,Rt,Pe)),Se.isShaderMaterial&&Se.uniformsNeedUpdate===!0&&(Av.upload(me,jt.uniformsList,Rt,Pe),Se.uniformsNeedUpdate=!1),Se.isSpriteMaterial&&rn.setValue(me,"center",Ge.center),rn.setValue(me,"modelViewMatrix",Ge.modelViewMatrix),rn.setValue(me,"normalMatrix",Ge.normalMatrix),rn.setValue(me,"modelMatrix",Ge.matrixWorld),vn}function Zn(le,be){le.ambientLightColor.needsUpdate=be,le.lightProbe.needsUpdate=be,le.directionalLights.needsUpdate=be,le.directionalLightShadows.needsUpdate=be,le.pointLights.needsUpdate=be,le.pointLightShadows.needsUpdate=be,le.spotLights.needsUpdate=be,le.spotLightShadows.needsUpdate=be,le.rectAreaLights.needsUpdate=be,le.hemisphereLights.needsUpdate=be}function Me(le){return le.isMeshLambertMaterial||le.isMeshToonMaterial||le.isMeshPhongMaterial||le.isMeshStandardMaterial||le.isShadowMaterial||le.isShaderMaterial&&le.lights===!0}this.getActiveCubeFace=function(){return E},this.getActiveMipmapLevel=function(){return T},this.getRenderTarget=function(){return P},this.setRenderTargetTextures=function(le,be,q){Ye.get(le.texture).__webglTexture=be,Ye.get(le.depthTexture).__webglTexture=q;const Se=Ye.get(le);Se.__hasExternalTextures=!0,Se.__hasExternalTextures&&(Se.__autoAllocateDepthBuffer=q===void 0,Se.__autoAllocateDepthBuffer||ze.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),Se.__useRenderToTexture=!1))},this.setRenderTargetFramebuffer=function(le,be){const q=Ye.get(le);q.__webglFramebuffer=be,q.__useDefaultFramebuffer=be===void 0},this.setRenderTarget=function(le,be=0,q=0){P=le,E=be,T=q;let Se=!0;if(le){const Ue=Ye.get(le);Ue.__useDefaultFramebuffer!==void 0?(rt.bindFramebuffer(36160,null),Se=!1):Ue.__webglFramebuffer===void 0?Pe.setupRenderTarget(le):Ue.__hasExternalTextures&&Pe.rebindTextures(le,Ye.get(le.texture).__webglTexture,Ye.get(le.depthTexture).__webglTexture)}let Ge=null,lt=!1,dt=!1;if(le){const Ue=le.texture;(Ue.isData3DTexture||Ue.isDataArrayTexture)&&(dt=!0);const Xe=Ye.get(le).__webglFramebuffer;le.isWebGLCubeRenderTarget?(Ge=Xe[be],lt=!0):tt.isWebGL2&&le.samples>0&&Pe.useMultisampledRTT(le)===!1?Ge=Ye.get(le).__webglMultisampledFramebuffer:Ge=Xe,k.copy(le.viewport),W.copy(le.scissor),j=le.scissorTest}else k.copy(M).multiplyScalar(te).floor(),W.copy(I).multiplyScalar(te).floor(),j=U;if(rt.bindFramebuffer(36160,Ge)&&tt.drawBuffers&&Se&&rt.drawBuffers(le,Ge),rt.viewport(k),rt.scissor(W),rt.setScissorTest(j),lt){const Ue=Ye.get(le.texture);me.framebufferTexture2D(36160,36064,34069+be,Ue.__webglTexture,q)}else if(dt){const Ue=Ye.get(le.texture),Xe=be||0;me.framebufferTextureLayer(36160,36064,Ue.__webglTexture,q||0,Xe)}D=-1},this.readRenderTargetPixels=function(le,be,q,Se,Ge,lt,dt){if(!(le&&le.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let Re=Ye.get(le).__webglFramebuffer;if(le.isWebGLCubeRenderTarget&&dt!==void 0&&(Re=Re[dt]),Re){rt.bindFramebuffer(36160,Re);try{const Ue=le.texture,Xe=Ue.format,ft=Ue.type;if(Xe!==Mo&&R.convert(Xe)!==me.getParameter(35739)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}const it=ft===od&&(ze.has("EXT_color_buffer_half_float")||tt.isWebGL2&&ze.has("EXT_color_buffer_float"));if(ft!==Hc&&R.convert(ft)!==me.getParameter(35738)&&!(ft===Bl&&(tt.isWebGL2||ze.has("OES_texture_float")||ze.has("WEBGL_color_buffer_float")))&&!it){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}be>=0&&be<=le.width-Se&&q>=0&&q<=le.height-Ge&&me.readPixels(be,q,Se,Ge,R.convert(Xe),R.convert(ft),lt)}finally{const Ue=P!==null?Ye.get(P).__webglFramebuffer:null;rt.bindFramebuffer(36160,Ue)}}},this.copyFramebufferToTexture=function(le,be,q=0){const Se=Math.pow(2,-q),Ge=Math.floor(be.image.width*Se),lt=Math.floor(be.image.height*Se);Pe.setTexture2D(be,0),me.copyTexSubImage2D(3553,q,0,0,le.x,le.y,Ge,lt),rt.unbindTexture()},this.copyTextureToTexture=function(le,be,q,Se=0){const Ge=be.image.width,lt=be.image.height,dt=R.convert(q.format),Re=R.convert(q.type);Pe.setTexture2D(q,0),me.pixelStorei(37440,q.flipY),me.pixelStorei(37441,q.premultiplyAlpha),me.pixelStorei(3317,q.unpackAlignment),be.isDataTexture?me.texSubImage2D(3553,Se,le.x,le.y,Ge,lt,dt,Re,be.image.data):be.isCompressedTexture?me.compressedTexSubImage2D(3553,Se,le.x,le.y,be.mipmaps[0].width,be.mipmaps[0].height,dt,be.mipmaps[0].data):me.texSubImage2D(3553,Se,le.x,le.y,dt,Re,be.image),Se===0&&q.generateMipmaps&&me.generateMipmap(3553),rt.unbindTexture()},this.copyTextureToTexture3D=function(le,be,q,Se,Ge=0){if(x.isWebGL1Renderer){console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: can only be used with WebGL2.");return}const lt=le.max.x-le.min.x+1,dt=le.max.y-le.min.y+1,Re=le.max.z-le.min.z+1,Ue=R.convert(Se.format),Xe=R.convert(Se.type);let ft;if(Se.isData3DTexture)Pe.setTexture3D(Se,0),ft=32879;else if(Se.isDataArrayTexture)Pe.setTexture2DArray(Se,0),ft=35866;else{console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: only supports THREE.DataTexture3D and THREE.DataTexture2DArray.");return}me.pixelStorei(37440,Se.flipY),me.pixelStorei(37441,Se.premultiplyAlpha),me.pixelStorei(3317,Se.unpackAlignment);const it=me.getParameter(3314),xt=me.getParameter(32878),Dt=me.getParameter(3316),Kt=me.getParameter(3315),Wt=me.getParameter(32877),bt=q.isCompressedTexture?q.mipmaps[0]:q.image;me.pixelStorei(3314,bt.width),me.pixelStorei(32878,bt.height),me.pixelStorei(3316,le.min.x),me.pixelStorei(3315,le.min.y),me.pixelStorei(32877,le.min.z),q.isDataTexture||q.isData3DTexture?me.texSubImage3D(ft,Ge,be.x,be.y,be.z,lt,dt,Re,Ue,Xe,bt.data):q.isCompressedTexture?(console.warn("THREE.WebGLRenderer.copyTextureToTexture3D: untested support for compressed srcTexture."),me.compressedTexSubImage3D(ft,Ge,be.x,be.y,be.z,lt,dt,Re,Ue,bt.data)):me.texSubImage3D(ft,Ge,be.x,be.y,be.z,lt,dt,Re,Ue,Xe,bt),me.pixelStorei(3314,it),me.pixelStorei(32878,xt),me.pixelStorei(3316,Dt),me.pixelStorei(3315,Kt),me.pixelStorei(32877,Wt),Ge===0&&Se.generateMipmaps&&me.generateMipmap(ft),rt.unbindTexture()},this.initTexture=function(le){Pe.setTexture2D(le,0),rt.unbindTexture()},this.resetState=function(){E=0,T=0,P=null,rt.reset(),X.reset()},typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}class TR extends SR{}TR.prototype.isWebGL1Renderer=!0;class yy{constructor(t,n=25e-5){this.isFogExp2=!0,this.name="",this.color=new qn(t),this.density=n}clone(){return new yy(this.color,this.density)}toJSON(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}}}class xy{constructor(t,n=1,i=1e3){this.isFog=!0,this.name="",this.color=new qn(t),this.near=n,this.far=i}clone(){return new xy(this.color,this.near,this.far)}toJSON(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}}}class CR extends or{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0,typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,n){return super.copy(t,n),t.background!==null&&(this.background=t.background.clone()),t.environment!==null&&(this.environment=t.environment.clone()),t.fog!==null&&(this.fog=t.fog.clone()),t.overrideMaterial!==null&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const n=super.toJSON(t);return this.fog!==null&&(n.object.fog=this.fog.toJSON()),n}}class Ay{constructor(t,n){this.isInterleavedBuffer=!0,this.array=t,this.stride=n,this.count=t!==void 0?t.length/n:0,this.usage=Nv,this.updateRange={offset:0,count:-1},this.version=0,this.uuid=Co()}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}copy(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.usage=t.usage,this}copyAt(t,n,i){t*=this.stride,i*=n.stride;for(let o=0,s=this.stride;o<s;o++)this.array[t+o]=n.array[i+o];return this}set(t,n=0){return this.array.set(t,n),this}clone(t){t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Co()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=this.array.slice(0).buffer);const n=new this.array.constructor(t.arrayBuffers[this.array.buffer._uuid]),i=new this.constructor(n,this.stride);return i.setUsage(this.usage),i}onUpload(t){return this.onUploadCallback=t,this}toJSON(t){return t.arrayBuffers===void 0&&(t.arrayBuffers={}),this.array.buffer._uuid===void 0&&(this.array.buffer._uuid=Co()),t.arrayBuffers[this.array.buffer._uuid]===void 0&&(t.arrayBuffers[this.array.buffer._uuid]=Array.prototype.slice.call(new Uint32Array(this.array.buffer))),{uuid:this.uuid,buffer:this.array.buffer._uuid,type:this.array.constructor.name,stride:this.stride}}}const $s=new Ze;class mh{constructor(t,n,i,o=!1){this.isInterleavedBufferAttribute=!0,this.name="",this.data=t,this.itemSize=n,this.offset=i,this.normalized=o===!0}get count(){return this.data.count}get array(){return this.data.array}set needsUpdate(t){this.data.needsUpdate=t}applyMatrix4(t){for(let n=0,i=this.data.count;n<i;n++)$s.fromBufferAttribute(this,n),$s.applyMatrix4(t),this.setXYZ(n,$s.x,$s.y,$s.z);return this}applyNormalMatrix(t){for(let n=0,i=this.count;n<i;n++)$s.fromBufferAttribute(this,n),$s.applyNormalMatrix(t),this.setXYZ(n,$s.x,$s.y,$s.z);return this}transformDirection(t){for(let n=0,i=this.count;n<i;n++)$s.fromBufferAttribute(this,n),$s.transformDirection(t),this.setXYZ(n,$s.x,$s.y,$s.z);return this}setX(t,n){return this.data.array[t*this.data.stride+this.offset]=n,this}setY(t,n){return this.data.array[t*this.data.stride+this.offset+1]=n,this}setZ(t,n){return this.data.array[t*this.data.stride+this.offset+2]=n,this}setW(t,n){return this.data.array[t*this.data.stride+this.offset+3]=n,this}getX(t){return this.data.array[t*this.data.stride+this.offset]}getY(t){return this.data.array[t*this.data.stride+this.offset+1]}getZ(t){return this.data.array[t*this.data.stride+this.offset+2]}getW(t){return this.data.array[t*this.data.stride+this.offset+3]}setXY(t,n,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=n,this.data.array[t+1]=i,this}setXYZ(t,n,i,o){return t=t*this.data.stride+this.offset,this.data.array[t+0]=n,this.data.array[t+1]=i,this.data.array[t+2]=o,this}setXYZW(t,n,i,o,s){return t=t*this.data.stride+this.offset,this.data.array[t+0]=n,this.data.array[t+1]=i,this.data.array[t+2]=o,this.data.array[t+3]=s,this}clone(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.clone(): Cloning an interlaved buffer attribute will deinterleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const o=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)n.push(this.data.array[o+s])}return new mr(new this.array.constructor(n),this.itemSize,this.normalized)}else return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.clone(t)),new mh(t.interleavedBuffers[this.data.uuid],this.itemSize,this.offset,this.normalized)}toJSON(t){if(t===void 0){console.log("THREE.InterleavedBufferAttribute.toJSON(): Serializing an interlaved buffer attribute will deinterleave buffer data.");const n=[];for(let i=0;i<this.count;i++){const o=i*this.data.stride+this.offset;for(let s=0;s<this.itemSize;s++)n.push(this.data.array[o+s])}return{itemSize:this.itemSize,type:this.array.constructor.name,array:n,normalized:this.normalized}}else return t.interleavedBuffers===void 0&&(t.interleavedBuffers={}),t.interleavedBuffers[this.data.uuid]===void 0&&(t.interleavedBuffers[this.data.uuid]=this.data.toJSON(t)),{isInterleavedBufferAttribute:!0,itemSize:this.itemSize,data:this.data.uuid,offset:this.offset,normalized:this.normalized}}}class N_ extends rs{constructor(t){super(),this.isSpriteMaterial=!0,this.type="SpriteMaterial",this.color=new qn(16777215),this.map=null,this.alphaMap=null,this.rotation=0,this.sizeAttenuation=!0,this.transparent=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.rotation=t.rotation,this.sizeAttenuation=t.sizeAttenuation,this.fog=t.fog,this}}let kf;const Bp=new Ze,zf=new Ze,Hf=new Ze,Gf=new yn,Fp=new yn,RR=new Oi,kg=new Ze,Np=new Ze,zg=new Ze,BS=new yn,hA=new yn,FS=new yn;class LR extends or{constructor(t){if(super(),this.isSprite=!0,this.type="Sprite",kf===void 0){kf=new Ii;const n=new Float32Array([-.5,-.5,0,0,0,.5,-.5,0,1,0,.5,.5,0,1,1,-.5,.5,0,0,1]),i=new Ay(n,5);kf.setIndex([0,1,2,0,2,3]),kf.setAttribute("position",new mh(i,3,0,!1)),kf.setAttribute("uv",new mh(i,2,3,!1))}this.geometry=kf,this.material=t!==void 0?t:new N_,this.center=new yn(.5,.5)}raycast(t,n){t.camera===null&&console.error('THREE.Sprite: "Raycaster.camera" needs to be set in order to raycast against sprites.'),zf.setFromMatrixScale(this.matrixWorld),RR.copy(t.camera.matrixWorld),this.modelViewMatrix.multiplyMatrices(t.camera.matrixWorldInverse,this.matrixWorld),Hf.setFromMatrixPosition(this.modelViewMatrix),t.camera.isPerspectiveCamera&&this.material.sizeAttenuation===!1&&zf.multiplyScalar(-Hf.z);const i=this.material.rotation;let o,s;i!==0&&(s=Math.cos(i),o=Math.sin(i));const c=this.center;Hg(kg.set(-.5,-.5,0),Hf,c,zf,o,s),Hg(Np.set(.5,-.5,0),Hf,c,zf,o,s),Hg(zg.set(.5,.5,0),Hf,c,zf,o,s),BS.set(0,0),hA.set(1,0),FS.set(1,1);let u=t.ray.intersectTriangle(kg,Np,zg,!1,Bp);if(u===null&&(Hg(Np.set(-.5,.5,0),Hf,c,zf,o,s),hA.set(0,1),u=t.ray.intersectTriangle(kg,zg,Np,!1,Bp),u===null))return;const h=t.ray.origin.distanceTo(Bp);h<t.near||h>t.far||n.push({distance:h,point:Bp.clone(),uv:zo.getUV(Bp,kg,Np,zg,BS,hA,FS,new yn),face:null,object:this})}copy(t,n){return super.copy(t,n),t.center!==void 0&&this.center.copy(t.center),this.material=t.material,this}}function Hg(a,t,n,i,o,s){Gf.subVectors(a,n).addScalar(.5).multiply(i),o!==void 0?(Fp.x=s*Gf.x-o*Gf.y,Fp.y=o*Gf.x+s*Gf.y):Fp.copy(Gf),a.copy(t),a.x+=Fp.x,a.y+=Fp.y,a.applyMatrix4(RR)}const Gg=new Ze,NS=new Ze;class PR extends or{constructor(){super(),this._currentLevel=0,this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]},isLOD:{value:!0}}),this.autoUpdate=!0}copy(t){super.copy(t,!1);const n=t.levels;for(let i=0,o=n.length;i<o;i++){const s=n[i];this.addLevel(s.object.clone(),s.distance)}return this.autoUpdate=t.autoUpdate,this}addLevel(t,n=0){n=Math.abs(n);const i=this.levels;let o;for(o=0;o<i.length&&!(n<i[o].distance);o++);return i.splice(o,0,{distance:n,object:t}),this.add(t),this}getCurrentLevel(){return this._currentLevel}getObjectForDistance(t){const n=this.levels;if(n.length>0){let i,o;for(i=1,o=n.length;i<o&&!(t<n[i].distance);i++);return n[i-1].object}return null}raycast(t,n){if(this.levels.length>0){Gg.setFromMatrixPosition(this.matrixWorld);const o=t.ray.origin.distanceTo(Gg);this.getObjectForDistance(o).raycast(t,n)}}update(t){const n=this.levels;if(n.length>1){Gg.setFromMatrixPosition(t.matrixWorld),NS.setFromMatrixPosition(this.matrixWorld);const i=Gg.distanceTo(NS)/t.zoom;n[0].object.visible=!0;let o,s;for(o=1,s=n.length;o<s&&i>=n[o].distance;o++)n[o-1].object.visible=!1,n[o].object.visible=!0;for(this._currentLevel=o-1;o<s;o++)n[o].object.visible=!1}}toJSON(t){const n=super.toJSON(t);this.autoUpdate===!1&&(n.object.autoUpdate=!1),n.object.levels=[];const i=this.levels;for(let o=0,s=i.length;o<s;o++){const c=i[o];n.object.levels.push({object:c.object.uuid,distance:c.distance})}return n}}const US=new Ze,kS=new ur,zS=new ur,FH=new Ze,HS=new Oi;class IR extends Ss{constructor(t,n){super(t,n),this.isSkinnedMesh=!0,this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new Oi,this.bindMatrixInverse=new Oi}copy(t,n){return super.copy(t,n),this.bindMode=t.bindMode,this.bindMatrix.copy(t.bindMatrix),this.bindMatrixInverse.copy(t.bindMatrixInverse),this.skeleton=t.skeleton,this}bind(t,n){this.skeleton=t,n===void 0&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),n=this.matrixWorld),this.bindMatrix.copy(n),this.bindMatrixInverse.copy(n).invert()}pose(){this.skeleton.pose()}normalizeSkinWeights(){const t=new ur,n=this.geometry.attributes.skinWeight;for(let i=0,o=n.count;i<o;i++){t.fromBufferAttribute(n,i);const s=1/t.manhattanLength();s!==1/0?t.multiplyScalar(s):t.set(1,0,0,0),n.setXYZW(i,t.x,t.y,t.z,t.w)}}updateMatrixWorld(t){super.updateMatrixWorld(t),this.bindMode==="attached"?this.bindMatrixInverse.copy(this.matrixWorld).invert():this.bindMode==="detached"?this.bindMatrixInverse.copy(this.bindMatrix).invert():console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)}boneTransform(t,n){const i=this.skeleton,o=this.geometry;kS.fromBufferAttribute(o.attributes.skinIndex,t),zS.fromBufferAttribute(o.attributes.skinWeight,t),US.copy(n).applyMatrix4(this.bindMatrix),n.set(0,0,0);for(let s=0;s<4;s++){const c=zS.getComponent(s);if(c!==0){const u=kS.getComponent(s);HS.multiplyMatrices(i.bones[u].matrixWorld,i.boneInverses[u]),n.addScaledVector(FH.copy(US).applyMatrix4(HS),c)}}return n.applyMatrix4(this.bindMatrixInverse)}}class U_ extends or{constructor(){super(),this.isBone=!0,this.type="Bone"}}class id extends is{constructor(t=null,n=1,i=1,o,s,c,u,h,f=Qr,p=Qr,m,y){super(null,c,u,h,f,p,o,s,m,y),this.isDataTexture=!0,this.image={data:t,width:n,height:i},this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}const GS=new Oi,NH=new Oi;class by{constructor(t=[],n=[]){this.uuid=Co(),this.bones=t.slice(0),this.boneInverses=n,this.boneMatrices=null,this.boneTexture=null,this.boneTextureSize=0,this.frame=-1,this.init()}init(){const t=this.bones,n=this.boneInverses;if(this.boneMatrices=new Float32Array(t.length*16),n.length===0)this.calculateInverses();else if(t.length!==n.length){console.warn("THREE.Skeleton: Number of inverse bone matrices does not match amount of bones."),this.boneInverses=[];for(let i=0,o=this.bones.length;i<o;i++)this.boneInverses.push(new Oi)}}calculateInverses(){this.boneInverses.length=0;for(let t=0,n=this.bones.length;t<n;t++){const i=new Oi;this.bones[t]&&i.copy(this.bones[t].matrixWorld).invert(),this.boneInverses.push(i)}}pose(){for(let t=0,n=this.bones.length;t<n;t++){const i=this.bones[t];i&&i.matrixWorld.copy(this.boneInverses[t]).invert()}for(let t=0,n=this.bones.length;t<n;t++){const i=this.bones[t];i&&(i.parent&&i.parent.isBone?(i.matrix.copy(i.parent.matrixWorld).invert(),i.matrix.multiply(i.matrixWorld)):i.matrix.copy(i.matrixWorld),i.matrix.decompose(i.position,i.quaternion,i.scale))}}update(){const t=this.bones,n=this.boneInverses,i=this.boneMatrices,o=this.boneTexture;for(let s=0,c=t.length;s<c;s++){const u=t[s]?t[s].matrixWorld:NH;GS.multiplyMatrices(u,n[s]),GS.toArray(i,s*16)}o!==null&&(o.needsUpdate=!0)}clone(){return new by(this.bones,this.boneInverses)}computeBoneTexture(){let t=Math.sqrt(this.bones.length*4);t=hR(t),t=Math.max(t,4);const n=new Float32Array(t*t*4);n.set(this.boneMatrices);const i=new id(n,t,t,Mo,Bl);return i.needsUpdate=!0,this.boneMatrices=n,this.boneTexture=i,this.boneTextureSize=t,this}getBoneByName(t){for(let n=0,i=this.bones.length;n<i;n++){const o=this.bones[n];if(o.name===t)return o}}dispose(){this.boneTexture!==null&&(this.boneTexture.dispose(),this.boneTexture=null)}fromJSON(t,n){this.uuid=t.uuid;for(let i=0,o=t.bones.length;i<o;i++){const s=t.bones[i];let c=n[s];c===void 0&&(console.warn("THREE.Skeleton: No bone found with UUID:",s),c=new U_),this.bones.push(c),this.boneInverses.push(new Oi().fromArray(t.boneInverses[i]))}return this.init(),this}toJSON(){const t={metadata:{version:4.5,type:"Skeleton",generator:"Skeleton.toJSON"},bones:[],boneInverses:[]};t.uuid=this.uuid;const n=this.bones,i=this.boneInverses;for(let o=0,s=n.length;o<s;o++){const c=n[o];t.bones.push(c.uuid);const u=i[o];t.boneInverses.push(u.toArray())}return t}}class ld extends mr{constructor(t,n,i,o=1){typeof i=="number"&&(o=i,i=!1,console.error("THREE.InstancedBufferAttribute: The constructor now expects normalized as the third argument.")),super(t,n,i),this.isInstancedBufferAttribute=!0,this.meshPerAttribute=o}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}toJSON(){const t=super.toJSON();return t.meshPerAttribute=this.meshPerAttribute,t.isInstancedBufferAttribute=!0,t}}const VS=new Oi,WS=new Oi,Vg=[],Up=new Ss;class OR extends Ss{constructor(t,n,i){super(t,n),this.isInstancedMesh=!0,this.instanceMatrix=new ld(new Float32Array(i*16),16),this.instanceColor=null,this.count=i,this.frustumCulled=!1}copy(t,n){return super.copy(t,n),this.instanceMatrix.copy(t.instanceMatrix),t.instanceColor!==null&&(this.instanceColor=t.instanceColor.clone()),this.count=t.count,this}getColorAt(t,n){n.fromArray(this.instanceColor.array,t*3)}getMatrixAt(t,n){n.fromArray(this.instanceMatrix.array,t*16)}raycast(t,n){const i=this.matrixWorld,o=this.count;if(Up.geometry=this.geometry,Up.material=this.material,Up.material!==void 0)for(let s=0;s<o;s++){this.getMatrixAt(s,VS),WS.multiplyMatrices(i,VS),Up.matrixWorld=WS,Up.raycast(t,Vg);for(let c=0,u=Vg.length;c<u;c++){const h=Vg[c];h.instanceId=s,h.object=this,n.push(h)}Vg.length=0}}setColorAt(t,n){this.instanceColor===null&&(this.instanceColor=new ld(new Float32Array(this.instanceMatrix.count*3),3)),n.toArray(this.instanceColor.array,t*3)}setMatrixAt(t,n){n.toArray(this.instanceMatrix.array,t*16)}updateMorphTargets(){}dispose(){this.dispatchEvent({type:"dispose"})}}class io extends rs{constructor(t){super(),this.isLineBasicMaterial=!0,this.type="LineBasicMaterial",this.color=new qn(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this.fog=t.fog,this}}const jS=new Ze,XS=new Ze,$S=new Oi,fA=new Fm,Wg=new Mh;class Vc extends or{constructor(t=new Ii,n=new io){super(),this.isLine=!0,this.type="Line",this.geometry=t,this.material=n,this.updateMorphTargets()}copy(t,n){return super.copy(t,n),this.material=t.material,this.geometry=t.geometry,this}computeLineDistances(){const t=this.geometry;if(t.index===null){const n=t.attributes.position,i=[0];for(let o=1,s=n.count;o<s;o++)jS.fromBufferAttribute(n,o-1),XS.fromBufferAttribute(n,o),i[o]=i[o-1],i[o]+=jS.distanceTo(XS);t.setAttribute("lineDistance",new ni(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}raycast(t,n){const i=this.geometry,o=this.matrixWorld,s=t.params.Line.threshold,c=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),Wg.copy(i.boundingSphere),Wg.applyMatrix4(o),Wg.radius+=s,t.ray.intersectsSphere(Wg)===!1)return;$S.copy(o).invert(),fA.copy(t.ray).applyMatrix4($S);const u=s/((this.scale.x+this.scale.y+this.scale.z)/3),h=u*u,f=new Ze,p=new Ze,m=new Ze,y=new Ze,g=this.isLineSegments?2:1,_=i.index,b=i.attributes.position;if(_!==null){const E=Math.max(0,c.start),T=Math.min(_.count,c.start+c.count);for(let P=E,D=T-1;P<D;P+=g){const F=_.getX(P),k=_.getX(P+1);if(f.fromBufferAttribute(b,F),p.fromBufferAttribute(b,k),fA.distanceSqToSegment(f,p,y,m)>h)continue;y.applyMatrix4(this.matrixWorld);const j=t.ray.origin.distanceTo(y);j<t.near||j>t.far||n.push({distance:j,point:m.clone().applyMatrix4(this.matrixWorld),index:P,face:null,faceIndex:null,object:this})}}else{const E=Math.max(0,c.start),T=Math.min(b.count,c.start+c.count);for(let P=E,D=T-1;P<D;P+=g){if(f.fromBufferAttribute(b,P),p.fromBufferAttribute(b,P+1),fA.distanceSqToSegment(f,p,y,m)>h)continue;y.applyMatrix4(this.matrixWorld);const k=t.ray.origin.distanceTo(y);k<t.near||k>t.far||n.push({distance:k,point:m.clone().applyMatrix4(this.matrixWorld),index:P,face:null,faceIndex:null,object:this})}}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const o=n[i[0]];if(o!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,c=o.length;s<c;s++){const u=o[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=s}}}}}const qS=new Ze,YS=new Ze;class il extends Vc{constructor(t,n){super(t,n),this.isLineSegments=!0,this.type="LineSegments"}computeLineDistances(){const t=this.geometry;if(t.index===null){const n=t.attributes.position,i=[];for(let o=0,s=n.count;o<s;o+=2)qS.fromBufferAttribute(n,o),YS.fromBufferAttribute(n,o+1),i[o]=o===0?0:i[o-1],i[o+1]=i[o]+qS.distanceTo(YS);t.setAttribute("lineDistance",new ni(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");return this}}class DR extends Vc{constructor(t,n){super(t,n),this.isLineLoop=!0,this.type="LineLoop"}}class k_ extends rs{constructor(t){super(),this.isPointsMaterial=!0,this.type="PointsMaterial",this.color=new qn(16777215),this.map=null,this.alphaMap=null,this.size=1,this.sizeAttenuation=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.alphaMap=t.alphaMap,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this.fog=t.fog,this}}const QS=new Oi,Bb=new Fm,jg=new Mh,Xg=new Ze;class BR extends or{constructor(t=new Ii,n=new k_){super(),this.isPoints=!0,this.type="Points",this.geometry=t,this.material=n,this.updateMorphTargets()}copy(t,n){return super.copy(t,n),this.material=t.material,this.geometry=t.geometry,this}raycast(t,n){const i=this.geometry,o=this.matrixWorld,s=t.params.Points.threshold,c=i.drawRange;if(i.boundingSphere===null&&i.computeBoundingSphere(),jg.copy(i.boundingSphere),jg.applyMatrix4(o),jg.radius+=s,t.ray.intersectsSphere(jg)===!1)return;QS.copy(o).invert(),Bb.copy(t.ray).applyMatrix4(QS);const u=s/((this.scale.x+this.scale.y+this.scale.z)/3),h=u*u,f=i.index,m=i.attributes.position;if(f!==null){const y=Math.max(0,c.start),g=Math.min(f.count,c.start+c.count);for(let _=y,x=g;_<x;_++){const b=f.getX(_);Xg.fromBufferAttribute(m,b),KS(Xg,b,h,o,t,n,this)}}else{const y=Math.max(0,c.start),g=Math.min(m.count,c.start+c.count);for(let _=y,x=g;_<x;_++)Xg.fromBufferAttribute(m,_),KS(Xg,_,h,o,t,n,this)}}updateMorphTargets(){const n=this.geometry.morphAttributes,i=Object.keys(n);if(i.length>0){const o=n[i[0]];if(o!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let s=0,c=o.length;s<c;s++){const u=o[s].name||String(s);this.morphTargetInfluences.push(0),this.morphTargetDictionary[u]=s}}}}}function KS(a,t,n,i,o,s,c){const u=Bb.distanceSqToPoint(a);if(u<n){const h=new Ze;Bb.closestPointToPoint(a,h),h.applyMatrix4(i);const f=o.ray.origin.distanceTo(h);if(f<o.near||f>o.far)return;s.push({distance:f,distanceToRay:Math.sqrt(u),point:h,index:t,face:null,object:c})}}class UH extends is{constructor(t,n,i,o,s,c,u,h,f){super(t,n,i,o,s,c,u,h,f),this.isVideoTexture=!0,this.minFilter=c!==void 0?c:Vr,this.magFilter=s!==void 0?s:Vr,this.generateMipmaps=!1;const p=this;function m(){p.needsUpdate=!0,t.requestVideoFrameCallback(m)}"requestVideoFrameCallback"in t&&t.requestVideoFrameCallback(m)}clone(){return new this.constructor(this.image).copy(this)}update(){const t=this.image;"requestVideoFrameCallback"in t===!1&&t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}class kH extends is{constructor(t,n,i){super({width:t,height:n}),this.isFramebufferTexture=!0,this.format=i,this.magFilter=Qr,this.minFilter=Qr,this.generateMipmaps=!1,this.needsUpdate=!0}}class FR extends is{constructor(t,n,i,o,s,c,u,h,f,p,m,y){super(null,c,u,h,f,p,o,s,m,y),this.isCompressedTexture=!0,this.image={width:n,height:i},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}}class zH extends is{constructor(t,n,i,o,s,c,u,h,f){super(t,n,i,o,s,c,u,h,f),this.isCanvasTexture=!0,this.needsUpdate=!0}}class xa{constructor(){this.type="Curve",this.arcLengthDivisions=200}getPoint(){return console.warn("THREE.Curve: .getPoint() not implemented."),null}getPointAt(t,n){const i=this.getUtoTmapping(t);return this.getPoint(i,n)}getPoints(t=5){const n=[];for(let i=0;i<=t;i++)n.push(this.getPoint(i/t));return n}getSpacedPoints(t=5){const n=[];for(let i=0;i<=t;i++)n.push(this.getPointAt(i/t));return n}getLength(){const t=this.getLengths();return t[t.length-1]}getLengths(t=this.arcLengthDivisions){if(this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;const n=[];let i,o=this.getPoint(0),s=0;n.push(0);for(let c=1;c<=t;c++)i=this.getPoint(c/t),s+=i.distanceTo(o),n.push(s),o=i;return this.cacheArcLengths=n,n}updateArcLengths(){this.needsUpdate=!0,this.getLengths()}getUtoTmapping(t,n){const i=this.getLengths();let o=0;const s=i.length;let c;n?c=n:c=t*i[s-1];let u=0,h=s-1,f;for(;u<=h;)if(o=Math.floor(u+(h-u)/2),f=i[o]-c,f<0)u=o+1;else if(f>0)h=o-1;else{h=o;break}if(o=h,i[o]===c)return o/(s-1);const p=i[o],y=i[o+1]-p,g=(c-p)/y;return(o+g)/(s-1)}getTangent(t,n){let o=t-1e-4,s=t+1e-4;o<0&&(o=0),s>1&&(s=1);const c=this.getPoint(o),u=this.getPoint(s),h=n||(c.isVector2?new yn:new Ze);return h.copy(u).sub(c).normalize(),h}getTangentAt(t,n){const i=this.getUtoTmapping(t);return this.getTangent(i,n)}computeFrenetFrames(t,n){const i=new Ze,o=[],s=[],c=[],u=new Ze,h=new Oi;for(let g=0;g<=t;g++){const _=g/t;o[g]=this.getTangentAt(_,new Ze)}s[0]=new Ze,c[0]=new Ze;let f=Number.MAX_VALUE;const p=Math.abs(o[0].x),m=Math.abs(o[0].y),y=Math.abs(o[0].z);p<=f&&(f=p,i.set(1,0,0)),m<=f&&(f=m,i.set(0,1,0)),y<=f&&i.set(0,0,1),u.crossVectors(o[0],i).normalize(),s[0].crossVectors(o[0],u),c[0].crossVectors(o[0],s[0]);for(let g=1;g<=t;g++){if(s[g]=s[g-1].clone(),c[g]=c[g-1].clone(),u.crossVectors(o[g-1],o[g]),u.length()>Number.EPSILON){u.normalize();const _=Math.acos(Wr(o[g-1].dot(o[g]),-1,1));s[g].applyMatrix4(h.makeRotationAxis(u,_))}c[g].crossVectors(o[g],s[g])}if(n===!0){let g=Math.acos(Wr(s[0].dot(s[t]),-1,1));g/=t,o[0].dot(u.crossVectors(s[0],s[t]))>0&&(g=-g);for(let _=1;_<=t;_++)s[_].applyMatrix4(h.makeRotationAxis(o[_],g*_)),c[_].crossVectors(o[_],s[_])}return{tangents:o,normals:s,binormals:c}}clone(){return new this.constructor().copy(this)}copy(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}toJSON(){const t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t}fromJSON(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}class _y extends xa{constructor(t=0,n=0,i=1,o=1,s=0,c=Math.PI*2,u=!1,h=0){super(),this.isEllipseCurve=!0,this.type="EllipseCurve",this.aX=t,this.aY=n,this.xRadius=i,this.yRadius=o,this.aStartAngle=s,this.aEndAngle=c,this.aClockwise=u,this.aRotation=h}getPoint(t,n){const i=n||new yn,o=Math.PI*2;let s=this.aEndAngle-this.aStartAngle;const c=Math.abs(s)<Number.EPSILON;for(;s<0;)s+=o;for(;s>o;)s-=o;s<Number.EPSILON&&(c?s=0:s=o),this.aClockwise===!0&&!c&&(s===o?s=-o:s=s-o);const u=this.aStartAngle+t*s;let h=this.aX+this.xRadius*Math.cos(u),f=this.aY+this.yRadius*Math.sin(u);if(this.aRotation!==0){const p=Math.cos(this.aRotation),m=Math.sin(this.aRotation),y=h-this.aX,g=f-this.aY;h=y*p-g*m+this.aX,f=y*m+g*p+this.aY}return i.set(h,f)}copy(t){return super.copy(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}toJSON(){const t=super.toJSON();return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t}fromJSON(t){return super.fromJSON(t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this}}class NR extends _y{constructor(t,n,i,o,s,c){super(t,n,i,i,o,s,c),this.isArcCurve=!0,this.type="ArcCurve"}}function z_(){let a=0,t=0,n=0,i=0;function o(s,c,u,h){a=s,t=u,n=-3*s+3*c-2*u-h,i=2*s-2*c+u+h}return{initCatmullRom:function(s,c,u,h,f){o(c,u,f*(u-s),f*(h-c))},initNonuniformCatmullRom:function(s,c,u,h,f,p,m){let y=(c-s)/f-(u-s)/(f+p)+(u-c)/p,g=(u-c)/p-(h-c)/(p+m)+(h-u)/m;y*=p,g*=p,o(c,u,y,g)},calc:function(s){const c=s*s,u=c*s;return a+t*s+n*c+i*u}}}const $g=new Ze,dA=new z_,pA=new z_,mA=new z_;class UR extends xa{constructor(t=[],n=!1,i="centripetal",o=.5){super(),this.isCatmullRomCurve3=!0,this.type="CatmullRomCurve3",this.points=t,this.closed=n,this.curveType=i,this.tension=o}getPoint(t,n=new Ze){const i=n,o=this.points,s=o.length,c=(s-(this.closed?0:1))*t;let u=Math.floor(c),h=c-u;this.closed?u+=u>0?0:(Math.floor(Math.abs(u)/s)+1)*s:h===0&&u===s-1&&(u=s-2,h=1);let f,p;this.closed||u>0?f=o[(u-1)%s]:($g.subVectors(o[0],o[1]).add(o[0]),f=$g);const m=o[u%s],y=o[(u+1)%s];if(this.closed||u+2<s?p=o[(u+2)%s]:($g.subVectors(o[s-1],o[s-2]).add(o[s-1]),p=$g),this.curveType==="centripetal"||this.curveType==="chordal"){const g=this.curveType==="chordal"?.5:.25;let _=Math.pow(f.distanceToSquared(m),g),x=Math.pow(m.distanceToSquared(y),g),b=Math.pow(y.distanceToSquared(p),g);x<1e-4&&(x=1),_<1e-4&&(_=x),b<1e-4&&(b=x),dA.initNonuniformCatmullRom(f.x,m.x,y.x,p.x,_,x,b),pA.initNonuniformCatmullRom(f.y,m.y,y.y,p.y,_,x,b),mA.initNonuniformCatmullRom(f.z,m.z,y.z,p.z,_,x,b)}else this.curveType==="catmullrom"&&(dA.initCatmullRom(f.x,m.x,y.x,p.x,this.tension),pA.initCatmullRom(f.y,m.y,y.y,p.y,this.tension),mA.initCatmullRom(f.z,m.z,y.z,p.z,this.tension));return i.set(dA.calc(h),pA.calc(h),mA.calc(h)),i}copy(t){super.copy(t),this.points=[];for(let n=0,i=t.points.length;n<i;n++){const o=t.points[n];this.points.push(o.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}toJSON(){const t=super.toJSON();t.points=[];for(let n=0,i=this.points.length;n<i;n++){const o=this.points[n];t.points.push(o.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t}fromJSON(t){super.fromJSON(t),this.points=[];for(let n=0,i=t.points.length;n<i;n++){const o=t.points[n];this.points.push(new Ze().fromArray(o))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this}}function ZS(a,t,n,i,o){const s=(i-t)*.5,c=(o-n)*.5,u=a*a,h=a*u;return(2*n-2*i+s+c)*h+(-3*n+3*i-2*s-c)*u+s*a+n}function HH(a,t){const n=1-a;return n*n*t}function GH(a,t){return 2*(1-a)*a*t}function VH(a,t){return a*a*t}function im(a,t,n,i){return HH(a,t)+GH(a,n)+VH(a,i)}function WH(a,t){const n=1-a;return n*n*n*t}function jH(a,t){const n=1-a;return 3*n*n*a*t}function XH(a,t){return 3*(1-a)*a*a*t}function $H(a,t){return a*a*a*t}function rm(a,t,n,i,o){return WH(a,t)+jH(a,n)+XH(a,i)+$H(a,o)}class H_ extends xa{constructor(t=new yn,n=new yn,i=new yn,o=new yn){super(),this.isCubicBezierCurve=!0,this.type="CubicBezierCurve",this.v0=t,this.v1=n,this.v2=i,this.v3=o}getPoint(t,n=new yn){const i=n,o=this.v0,s=this.v1,c=this.v2,u=this.v3;return i.set(rm(t,o.x,s.x,c.x,u.x),rm(t,o.y,s.y,c.y,u.y)),i}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}class kR extends xa{constructor(t=new Ze,n=new Ze,i=new Ze,o=new Ze){super(),this.isCubicBezierCurve3=!0,this.type="CubicBezierCurve3",this.v0=t,this.v1=n,this.v2=i,this.v3=o}getPoint(t,n=new Ze){const i=n,o=this.v0,s=this.v1,c=this.v2,u=this.v3;return i.set(rm(t,o.x,s.x,c.x,u.x),rm(t,o.y,s.y,c.y,u.y),rm(t,o.z,s.z,c.z,u.z)),i}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this}}class wy extends xa{constructor(t=new yn,n=new yn){super(),this.isLineCurve=!0,this.type="LineCurve",this.v1=t,this.v2=n}getPoint(t,n=new yn){const i=n;return t===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(t).add(this.v1)),i}getPointAt(t,n){return this.getPoint(t,n)}getTangent(t,n){const i=n||new yn;return i.copy(this.v2).sub(this.v1).normalize(),i}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class zR extends xa{constructor(t=new Ze,n=new Ze){super(),this.isLineCurve3=!0,this.type="LineCurve3",this.v1=t,this.v2=n}getPoint(t,n=new Ze){const i=n;return t===1?i.copy(this.v2):(i.copy(this.v2).sub(this.v1),i.multiplyScalar(t).add(this.v1)),i}getPointAt(t,n){return this.getPoint(t,n)}copy(t){return super.copy(t),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class G_ extends xa{constructor(t=new yn,n=new yn,i=new yn){super(),this.isQuadraticBezierCurve=!0,this.type="QuadraticBezierCurve",this.v0=t,this.v1=n,this.v2=i}getPoint(t,n=new yn){const i=n,o=this.v0,s=this.v1,c=this.v2;return i.set(im(t,o.x,s.x,c.x),im(t,o.y,s.y,c.y)),i}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class V_ extends xa{constructor(t=new Ze,n=new Ze,i=new Ze){super(),this.isQuadraticBezierCurve3=!0,this.type="QuadraticBezierCurve3",this.v0=t,this.v1=n,this.v2=i}getPoint(t,n=new Ze){const i=n,o=this.v0,s=this.v1,c=this.v2;return i.set(im(t,o.x,s.x,c.x),im(t,o.y,s.y,c.y),im(t,o.z,s.z,c.z)),i}copy(t){return super.copy(t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this}toJSON(){const t=super.toJSON();return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t}fromJSON(t){return super.fromJSON(t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this}}class W_ extends xa{constructor(t=[]){super(),this.isSplineCurve=!0,this.type="SplineCurve",this.points=t}getPoint(t,n=new yn){const i=n,o=this.points,s=(o.length-1)*t,c=Math.floor(s),u=s-c,h=o[c===0?c:c-1],f=o[c],p=o[c>o.length-2?o.length-1:c+1],m=o[c>o.length-3?o.length-1:c+2];return i.set(ZS(u,h.x,f.x,p.x,m.x),ZS(u,h.y,f.y,p.y,m.y)),i}copy(t){super.copy(t),this.points=[];for(let n=0,i=t.points.length;n<i;n++){const o=t.points[n];this.points.push(o.clone())}return this}toJSON(){const t=super.toJSON();t.points=[];for(let n=0,i=this.points.length;n<i;n++){const o=this.points[n];t.points.push(o.toArray())}return t}fromJSON(t){super.fromJSON(t),this.points=[];for(let n=0,i=t.points.length;n<i;n++){const o=t.points[n];this.points.push(new yn().fromArray(o))}return this}}var j_=Object.freeze({__proto__:null,ArcCurve:NR,CatmullRomCurve3:UR,CubicBezierCurve:H_,CubicBezierCurve3:kR,EllipseCurve:_y,LineCurve:wy,LineCurve3:zR,QuadraticBezierCurve:G_,QuadraticBezierCurve3:V_,SplineCurve:W_});class HR extends xa{constructor(){super(),this.type="CurvePath",this.curves=[],this.autoClose=!1}add(t){this.curves.push(t)}closePath(){const t=this.curves[0].getPoint(0),n=this.curves[this.curves.length-1].getPoint(1);t.equals(n)||this.curves.push(new wy(n,t))}getPoint(t,n){const i=t*this.getLength(),o=this.getCurveLengths();let s=0;for(;s<o.length;){if(o[s]>=i){const c=o[s]-i,u=this.curves[s],h=u.getLength(),f=h===0?0:1-c/h;return u.getPointAt(f,n)}s++}return null}getLength(){const t=this.getCurveLengths();return t[t.length-1]}updateArcLengths(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()}getCurveLengths(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;const t=[];let n=0;for(let i=0,o=this.curves.length;i<o;i++)n+=this.curves[i].getLength(),t.push(n);return this.cacheLengths=t,t}getSpacedPoints(t=40){const n=[];for(let i=0;i<=t;i++)n.push(this.getPoint(i/t));return this.autoClose&&n.push(n[0]),n}getPoints(t=12){const n=[];let i;for(let o=0,s=this.curves;o<s.length;o++){const c=s[o],u=c.isEllipseCurve?t*2:c.isLineCurve||c.isLineCurve3?1:c.isSplineCurve?t*c.points.length:t,h=c.getPoints(u);for(let f=0;f<h.length;f++){const p=h[f];i&&i.equals(p)||(n.push(p),i=p)}}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n}copy(t){super.copy(t),this.curves=[];for(let n=0,i=t.curves.length;n<i;n++){const o=t.curves[n];this.curves.push(o.clone())}return this.autoClose=t.autoClose,this}toJSON(){const t=super.toJSON();t.autoClose=this.autoClose,t.curves=[];for(let n=0,i=this.curves.length;n<i;n++){const o=this.curves[n];t.curves.push(o.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.autoClose=t.autoClose,this.curves=[];for(let n=0,i=t.curves.length;n<i;n++){const o=t.curves[n];this.curves.push(new j_[o.type]().fromJSON(o))}return this}}class _m extends HR{constructor(t){super(),this.type="Path",this.currentPoint=new yn,t&&this.setFromPoints(t)}setFromPoints(t){this.moveTo(t[0].x,t[0].y);for(let n=1,i=t.length;n<i;n++)this.lineTo(t[n].x,t[n].y);return this}moveTo(t,n){return this.currentPoint.set(t,n),this}lineTo(t,n){const i=new wy(this.currentPoint.clone(),new yn(t,n));return this.curves.push(i),this.currentPoint.set(t,n),this}quadraticCurveTo(t,n,i,o){const s=new G_(this.currentPoint.clone(),new yn(t,n),new yn(i,o));return this.curves.push(s),this.currentPoint.set(i,o),this}bezierCurveTo(t,n,i,o,s,c){const u=new H_(this.currentPoint.clone(),new yn(t,n),new yn(i,o),new yn(s,c));return this.curves.push(u),this.currentPoint.set(s,c),this}splineThru(t){const n=[this.currentPoint.clone()].concat(t),i=new W_(n);return this.curves.push(i),this.currentPoint.copy(t[t.length-1]),this}arc(t,n,i,o,s,c){const u=this.currentPoint.x,h=this.currentPoint.y;return this.absarc(t+u,n+h,i,o,s,c),this}absarc(t,n,i,o,s,c){return this.absellipse(t,n,i,i,o,s,c),this}ellipse(t,n,i,o,s,c,u,h){const f=this.currentPoint.x,p=this.currentPoint.y;return this.absellipse(t+f,n+p,i,o,s,c,u,h),this}absellipse(t,n,i,o,s,c,u,h){const f=new _y(t,n,i,o,s,c,u,h);if(this.curves.length>0){const m=f.getPoint(0);m.equals(this.currentPoint)||this.lineTo(m.x,m.y)}this.curves.push(f);const p=f.getPoint(1);return this.currentPoint.copy(p),this}copy(t){return super.copy(t),this.currentPoint.copy(t.currentPoint),this}toJSON(){const t=super.toJSON();return t.currentPoint=this.currentPoint.toArray(),t}fromJSON(t){return super.fromJSON(t),this.currentPoint.fromArray(t.currentPoint),this}}class gh extends Ii{constructor(t=[new yn(0,.5),new yn(.5,0),new yn(0,-.5)],n=12,i=0,o=Math.PI*2){super(),this.type="LatheGeometry",this.parameters={points:t,segments:n,phiStart:i,phiLength:o},n=Math.floor(n),o=Wr(o,0,Math.PI*2);const s=[],c=[],u=[],h=[],f=[],p=1/n,m=new Ze,y=new yn,g=new Ze,_=new Ze,x=new Ze;let b=0,E=0;for(let T=0;T<=t.length-1;T++)switch(T){case 0:b=t[T+1].x-t[T].x,E=t[T+1].y-t[T].y,g.x=E*1,g.y=-b,g.z=E*0,x.copy(g),g.normalize(),h.push(g.x,g.y,g.z);break;case t.length-1:h.push(x.x,x.y,x.z);break;default:b=t[T+1].x-t[T].x,E=t[T+1].y-t[T].y,g.x=E*1,g.y=-b,g.z=E*0,_.copy(g),g.x+=x.x,g.y+=x.y,g.z+=x.z,g.normalize(),h.push(g.x,g.y,g.z),x.copy(_)}for(let T=0;T<=n;T++){const P=i+T*p*o,D=Math.sin(P),F=Math.cos(P);for(let k=0;k<=t.length-1;k++){m.x=t[k].x*D,m.y=t[k].y,m.z=t[k].x*F,c.push(m.x,m.y,m.z),y.x=T/n,y.y=k/(t.length-1),u.push(y.x,y.y);const W=h[3*k+0]*D,j=h[3*k+1],J=h[3*k+0]*F;f.push(W,j,J)}}for(let T=0;T<n;T++)for(let P=0;P<t.length-1;P++){const D=P+T*t.length,F=D,k=D+t.length,W=D+t.length+1,j=D+1;s.push(F,k,j),s.push(W,j,k)}this.setIndex(s),this.setAttribute("position",new ni(c,3)),this.setAttribute("uv",new ni(u,2)),this.setAttribute("normal",new ni(f,3))}static fromJSON(t){return new gh(t.points,t.segments,t.phiStart,t.phiLength)}}class cd extends gh{constructor(t=1,n=1,i=4,o=8){const s=new _m;s.absarc(0,-n/2,t,Math.PI*1.5,0),s.absarc(0,n/2,t,0,Math.PI*.5),super(s.getPoints(i),o),this.type="CapsuleGeometry",this.parameters={radius:t,height:n,capSegments:i,radialSegments:o}}static fromJSON(t){return new cd(t.radius,t.length,t.capSegments,t.radialSegments)}}class ud extends Ii{constructor(t=1,n=8,i=0,o=Math.PI*2){super(),this.type="CircleGeometry",this.parameters={radius:t,segments:n,thetaStart:i,thetaLength:o},n=Math.max(3,n);const s=[],c=[],u=[],h=[],f=new Ze,p=new yn;c.push(0,0,0),u.push(0,0,1),h.push(.5,.5);for(let m=0,y=3;m<=n;m++,y+=3){const g=i+m/n*o;f.x=t*Math.cos(g),f.y=t*Math.sin(g),c.push(f.x,f.y,f.z),u.push(0,0,1),p.x=(c[y]/t+1)/2,p.y=(c[y+1]/t+1)/2,h.push(p.x,p.y)}for(let m=1;m<=n;m++)s.push(m,m+1,0);this.setIndex(s),this.setAttribute("position",new ni(c,3)),this.setAttribute("normal",new ni(u,3)),this.setAttribute("uv",new ni(h,2))}static fromJSON(t){return new ud(t.radius,t.segments,t.thetaStart,t.thetaLength)}}class Wc extends Ii{constructor(t=1,n=1,i=1,o=8,s=1,c=!1,u=0,h=Math.PI*2){super(),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:n,height:i,radialSegments:o,heightSegments:s,openEnded:c,thetaStart:u,thetaLength:h};const f=this;o=Math.floor(o),s=Math.floor(s);const p=[],m=[],y=[],g=[];let _=0;const x=[],b=i/2;let E=0;T(),c===!1&&(t>0&&P(!0),n>0&&P(!1)),this.setIndex(p),this.setAttribute("position",new ni(m,3)),this.setAttribute("normal",new ni(y,3)),this.setAttribute("uv",new ni(g,2));function T(){const D=new Ze,F=new Ze;let k=0;const W=(n-t)/i;for(let j=0;j<=s;j++){const J=[],de=j/s,te=de*(n-t)+t;for(let N=0;N<=o;N++){const L=N/o,M=L*h+u,I=Math.sin(M),U=Math.cos(M);F.x=te*I,F.y=-de*i+b,F.z=te*U,m.push(F.x,F.y,F.z),D.set(I,W,U).normalize(),y.push(D.x,D.y,D.z),g.push(L,1-de),J.push(_++)}x.push(J)}for(let j=0;j<o;j++)for(let J=0;J<s;J++){const de=x[J][j],te=x[J+1][j],N=x[J+1][j+1],L=x[J][j+1];p.push(de,te,L),p.push(te,N,L),k+=6}f.addGroup(E,k,0),E+=k}function P(D){const F=_,k=new yn,W=new Ze;let j=0;const J=D===!0?t:n,de=D===!0?1:-1;for(let N=1;N<=o;N++)m.push(0,b*de,0),y.push(0,de,0),g.push(.5,.5),_++;const te=_;for(let N=0;N<=o;N++){const M=N/o*h+u,I=Math.cos(M),U=Math.sin(M);W.x=J*U,W.y=b*de,W.z=J*I,m.push(W.x,W.y,W.z),y.push(0,de,0),k.x=I*.5+.5,k.y=U*.5*de+.5,g.push(k.x,k.y),_++}for(let N=0;N<o;N++){const L=F+N,M=te+N;D===!0?p.push(M,M+1,L):p.push(M+1,M,L),j+=3}f.addGroup(E,j,D===!0?1:2),E+=j}}static fromJSON(t){return new Wc(t.radiusTop,t.radiusBottom,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class hd extends Wc{constructor(t=1,n=1,i=8,o=1,s=!1,c=0,u=Math.PI*2){super(0,t,n,i,o,s,c,u),this.type="ConeGeometry",this.parameters={radius:t,height:n,radialSegments:i,heightSegments:o,openEnded:s,thetaStart:c,thetaLength:u}}static fromJSON(t){return new hd(t.radius,t.height,t.radialSegments,t.heightSegments,t.openEnded,t.thetaStart,t.thetaLength)}}class Qa extends Ii{constructor(t=[],n=[],i=1,o=0){super(),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:n,radius:i,detail:o};const s=[],c=[];u(o),f(i),p(),this.setAttribute("position",new ni(s,3)),this.setAttribute("normal",new ni(s.slice(),3)),this.setAttribute("uv",new ni(c,2)),o===0?this.computeVertexNormals():this.normalizeNormals();function u(T){const P=new Ze,D=new Ze,F=new Ze;for(let k=0;k<n.length;k+=3)g(n[k+0],P),g(n[k+1],D),g(n[k+2],F),h(P,D,F,T)}function h(T,P,D,F){const k=F+1,W=[];for(let j=0;j<=k;j++){W[j]=[];const J=T.clone().lerp(D,j/k),de=P.clone().lerp(D,j/k),te=k-j;for(let N=0;N<=te;N++)N===0&&j===k?W[j][N]=J:W[j][N]=J.clone().lerp(de,N/te)}for(let j=0;j<k;j++)for(let J=0;J<2*(k-j)-1;J++){const de=Math.floor(J/2);J%2===0?(y(W[j][de+1]),y(W[j+1][de]),y(W[j][de])):(y(W[j][de+1]),y(W[j+1][de+1]),y(W[j+1][de]))}}function f(T){const P=new Ze;for(let D=0;D<s.length;D+=3)P.x=s[D+0],P.y=s[D+1],P.z=s[D+2],P.normalize().multiplyScalar(T),s[D+0]=P.x,s[D+1]=P.y,s[D+2]=P.z}function p(){const T=new Ze;for(let P=0;P<s.length;P+=3){T.x=s[P+0],T.y=s[P+1],T.z=s[P+2];const D=b(T)/2/Math.PI+.5,F=E(T)/Math.PI+.5;c.push(D,1-F)}_(),m()}function m(){for(let T=0;T<c.length;T+=6){const P=c[T+0],D=c[T+2],F=c[T+4],k=Math.max(P,D,F),W=Math.min(P,D,F);k>.9&&W<.1&&(P<.2&&(c[T+0]+=1),D<.2&&(c[T+2]+=1),F<.2&&(c[T+4]+=1))}}function y(T){s.push(T.x,T.y,T.z)}function g(T,P){const D=T*3;P.x=t[D+0],P.y=t[D+1],P.z=t[D+2]}function _(){const T=new Ze,P=new Ze,D=new Ze,F=new Ze,k=new yn,W=new yn,j=new yn;for(let J=0,de=0;J<s.length;J+=9,de+=6){T.set(s[J+0],s[J+1],s[J+2]),P.set(s[J+3],s[J+4],s[J+5]),D.set(s[J+6],s[J+7],s[J+8]),k.set(c[de+0],c[de+1]),W.set(c[de+2],c[de+3]),j.set(c[de+4],c[de+5]),F.copy(T).add(P).add(D).divideScalar(3);const te=b(F);x(k,de+0,T,te),x(W,de+2,P,te),x(j,de+4,D,te)}}function x(T,P,D,F){F<0&&T.x===1&&(c[P]=T.x-1),D.x===0&&D.z===0&&(c[P]=F/2/Math.PI+.5)}function b(T){return Math.atan2(T.z,-T.x)}function E(T){return Math.atan2(-T.y,Math.sqrt(T.x*T.x+T.z*T.z))}}static fromJSON(t){return new Qa(t.vertices,t.indices,t.radius,t.details)}}class fd extends Qa{constructor(t=1,n=0){const i=(1+Math.sqrt(5))/2,o=1/i,s=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-o,-i,0,-o,i,0,o,-i,0,o,i,-o,-i,0,-o,i,0,o,-i,0,o,i,0,-i,0,-o,i,0,-o,-i,0,o,i,0,o],c=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];super(s,c,t,n),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:n}}static fromJSON(t){return new fd(t.radius,t.detail)}}const qg=new Ze,Yg=new Ze,gA=new Ze,Qg=new zo;class GR extends Ii{constructor(t=null,n=1){if(super(),this.type="EdgesGeometry",this.parameters={geometry:t,thresholdAngle:n},t!==null){const o=Math.pow(10,4),s=Math.cos(oh*n),c=t.getIndex(),u=t.getAttribute("position"),h=c?c.count:u.count,f=[0,0,0],p=["a","b","c"],m=new Array(3),y={},g=[];for(let _=0;_<h;_+=3){c?(f[0]=c.getX(_),f[1]=c.getX(_+1),f[2]=c.getX(_+2)):(f[0]=_,f[1]=_+1,f[2]=_+2);const{a:x,b,c:E}=Qg;if(x.fromBufferAttribute(u,f[0]),b.fromBufferAttribute(u,f[1]),E.fromBufferAttribute(u,f[2]),Qg.getNormal(gA),m[0]=`${Math.round(x.x*o)},${Math.round(x.y*o)},${Math.round(x.z*o)}`,m[1]=`${Math.round(b.x*o)},${Math.round(b.y*o)},${Math.round(b.z*o)}`,m[2]=`${Math.round(E.x*o)},${Math.round(E.y*o)},${Math.round(E.z*o)}`,!(m[0]===m[1]||m[1]===m[2]||m[2]===m[0]))for(let T=0;T<3;T++){const P=(T+1)%3,D=m[T],F=m[P],k=Qg[p[T]],W=Qg[p[P]],j=`${D}_${F}`,J=`${F}_${D}`;J in y&&y[J]?(gA.dot(y[J].normal)<=s&&(g.push(k.x,k.y,k.z),g.push(W.x,W.y,W.z)),y[J]=null):j in y||(y[j]={index0:f[T],index1:f[P],normal:gA.clone()})}}for(const _ in y)if(y[_]){const{index0:x,index1:b}=y[_];qg.fromBufferAttribute(u,x),Yg.fromBufferAttribute(u,b),g.push(qg.x,qg.y,qg.z),g.push(Yg.x,Yg.y,Yg.z)}this.setAttribute("position",new ni(g,3))}}}class lh extends _m{constructor(t){super(t),this.uuid=Co(),this.type="Shape",this.holes=[]}getPointsHoles(t){const n=[];for(let i=0,o=this.holes.length;i<o;i++)n[i]=this.holes[i].getPoints(t);return n}extractPoints(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}}copy(t){super.copy(t),this.holes=[];for(let n=0,i=t.holes.length;n<i;n++){const o=t.holes[n];this.holes.push(o.clone())}return this}toJSON(){const t=super.toJSON();t.uuid=this.uuid,t.holes=[];for(let n=0,i=this.holes.length;n<i;n++){const o=this.holes[n];t.holes.push(o.toJSON())}return t}fromJSON(t){super.fromJSON(t),this.uuid=t.uuid,this.holes=[];for(let n=0,i=t.holes.length;n<i;n++){const o=t.holes[n];this.holes.push(new _m().fromJSON(o))}return this}}const qH={triangulate:function(a,t,n=2){const i=t&&t.length,o=i?t[0]*n:a.length;let s=VR(a,0,o,n,!0);const c=[];if(!s||s.next===s.prev)return c;let u,h,f,p,m,y,g;if(i&&(s=JH(a,t,s,n)),a.length>80*n){u=f=a[0],h=p=a[1];for(let _=n;_<o;_+=n)m=a[_],y=a[_+1],m<u&&(u=m),y<h&&(h=y),m>f&&(f=m),y>p&&(p=y);g=Math.max(f-u,p-h),g=g!==0?1/g:0}return wm(s,c,n,u,h,g),c}};function VR(a,t,n,i,o){let s,c;if(o===uG(a,t,n,i)>0)for(s=t;s<n;s+=i)c=JS(s,a[s],a[s+1],c);else for(s=n-i;s>=t;s-=i)c=JS(s,a[s],a[s+1],c);return c&&Ey(c,c.next)&&(Mm(c),c=c.next),c}function jc(a,t){if(!a)return a;t||(t=a);let n=a,i;do if(i=!1,!n.steiner&&(Ey(n,n.next)||Cr(n.prev,n,n.next)===0)){if(Mm(n),n=t=n.prev,n===n.next)break;i=!0}else n=n.next;while(i||n!==t);return t}function wm(a,t,n,i,o,s,c){if(!a)return;!c&&s&&rG(a,i,o,s);let u=a,h,f;for(;a.prev!==a.next;){if(h=a.prev,f=a.next,s?QH(a,i,o,s):YH(a)){t.push(h.i/n),t.push(a.i/n),t.push(f.i/n),Mm(a),a=f.next,u=f.next;continue}if(a=f,a===u){c?c===1?(a=KH(jc(a),t,n),wm(a,t,n,i,o,s,2)):c===2&&ZH(a,t,n,i,o,s):wm(jc(a),t,n,i,o,s,1);break}}}function YH(a){const t=a.prev,n=a,i=a.next;if(Cr(t,n,i)>=0)return!1;let o=a.next.next;for(;o!==a.prev;){if(Kf(t.x,t.y,n.x,n.y,i.x,i.y,o.x,o.y)&&Cr(o.prev,o,o.next)>=0)return!1;o=o.next}return!0}function QH(a,t,n,i){const o=a.prev,s=a,c=a.next;if(Cr(o,s,c)>=0)return!1;const u=o.x<s.x?o.x<c.x?o.x:c.x:s.x<c.x?s.x:c.x,h=o.y<s.y?o.y<c.y?o.y:c.y:s.y<c.y?s.y:c.y,f=o.x>s.x?o.x>c.x?o.x:c.x:s.x>c.x?s.x:c.x,p=o.y>s.y?o.y>c.y?o.y:c.y:s.y>c.y?s.y:c.y,m=Fb(u,h,t,n,i),y=Fb(f,p,t,n,i);let g=a.prevZ,_=a.nextZ;for(;g&&g.z>=m&&_&&_.z<=y;){if(g!==a.prev&&g!==a.next&&Kf(o.x,o.y,s.x,s.y,c.x,c.y,g.x,g.y)&&Cr(g.prev,g,g.next)>=0||(g=g.prevZ,_!==a.prev&&_!==a.next&&Kf(o.x,o.y,s.x,s.y,c.x,c.y,_.x,_.y)&&Cr(_.prev,_,_.next)>=0))return!1;_=_.nextZ}for(;g&&g.z>=m;){if(g!==a.prev&&g!==a.next&&Kf(o.x,o.y,s.x,s.y,c.x,c.y,g.x,g.y)&&Cr(g.prev,g,g.next)>=0)return!1;g=g.prevZ}for(;_&&_.z<=y;){if(_!==a.prev&&_!==a.next&&Kf(o.x,o.y,s.x,s.y,c.x,c.y,_.x,_.y)&&Cr(_.prev,_,_.next)>=0)return!1;_=_.nextZ}return!0}function KH(a,t,n){let i=a;do{const o=i.prev,s=i.next.next;!Ey(o,s)&&WR(o,i,i.next,s)&&Em(o,s)&&Em(s,o)&&(t.push(o.i/n),t.push(i.i/n),t.push(s.i/n),Mm(i),Mm(i.next),i=a=s),i=i.next}while(i!==a);return jc(i)}function ZH(a,t,n,i,o,s){let c=a;do{let u=c.next.next;for(;u!==c.prev;){if(c.i!==u.i&&aG(c,u)){let h=jR(c,u);c=jc(c,c.next),h=jc(h,h.next),wm(c,t,n,i,o,s),wm(h,t,n,i,o,s);return}u=u.next}c=c.next}while(c!==a)}function JH(a,t,n,i){const o=[];let s,c,u,h,f;for(s=0,c=t.length;s<c;s++)u=t[s]*i,h=s<c-1?t[s+1]*i:a.length,f=VR(a,u,h,i,!1),f===f.next&&(f.steiner=!0),o.push(oG(f));for(o.sort(eG),s=0;s<o.length;s++)tG(o[s],n),n=jc(n,n.next);return n}function eG(a,t){return a.x-t.x}function tG(a,t){if(t=nG(a,t),t){const n=jR(t,a);jc(t,t.next),jc(n,n.next)}}function nG(a,t){let n=t;const i=a.x,o=a.y;let s=-1/0,c;do{if(o<=n.y&&o>=n.next.y&&n.next.y!==n.y){const y=n.x+(o-n.y)*(n.next.x-n.x)/(n.next.y-n.y);if(y<=i&&y>s){if(s=y,y===i){if(o===n.y)return n;if(o===n.next.y)return n.next}c=n.x<n.next.x?n:n.next}}n=n.next}while(n!==t);if(!c)return null;if(i===s)return c;const u=c,h=c.x,f=c.y;let p=1/0,m;n=c;do i>=n.x&&n.x>=h&&i!==n.x&&Kf(o<f?i:s,o,h,f,o<f?s:i,o,n.x,n.y)&&(m=Math.abs(o-n.y)/(i-n.x),Em(n,a)&&(m<p||m===p&&(n.x>c.x||n.x===c.x&&iG(c,n)))&&(c=n,p=m)),n=n.next;while(n!==u);return c}function iG(a,t){return Cr(a.prev,a,t.prev)<0&&Cr(t.next,a,a.next)<0}function rG(a,t,n,i){let o=a;do o.z===null&&(o.z=Fb(o.x,o.y,t,n,i)),o.prevZ=o.prev,o.nextZ=o.next,o=o.next;while(o!==a);o.prevZ.nextZ=null,o.prevZ=null,sG(o)}function sG(a){let t,n,i,o,s,c,u,h,f=1;do{for(n=a,a=null,s=null,c=0;n;){for(c++,i=n,u=0,t=0;t<f&&(u++,i=i.nextZ,!!i);t++);for(h=f;u>0||h>0&&i;)u!==0&&(h===0||!i||n.z<=i.z)?(o=n,n=n.nextZ,u--):(o=i,i=i.nextZ,h--),s?s.nextZ=o:a=o,o.prevZ=s,s=o;n=i}s.nextZ=null,f*=2}while(c>1);return a}function Fb(a,t,n,i,o){return a=32767*(a-n)*o,t=32767*(t-i)*o,a=(a|a<<8)&16711935,a=(a|a<<4)&252645135,a=(a|a<<2)&858993459,a=(a|a<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,a|t<<1}function oG(a){let t=a,n=a;do(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next;while(t!==a);return n}function Kf(a,t,n,i,o,s,c,u){return(o-c)*(t-u)-(a-c)*(s-u)>=0&&(a-c)*(i-u)-(n-c)*(t-u)>=0&&(n-c)*(s-u)-(o-c)*(i-u)>=0}function aG(a,t){return a.next.i!==t.i&&a.prev.i!==t.i&&!lG(a,t)&&(Em(a,t)&&Em(t,a)&&cG(a,t)&&(Cr(a.prev,a,t.prev)||Cr(a,t.prev,t))||Ey(a,t)&&Cr(a.prev,a,a.next)>0&&Cr(t.prev,t,t.next)>0)}function Cr(a,t,n){return(t.y-a.y)*(n.x-t.x)-(t.x-a.x)*(n.y-t.y)}function Ey(a,t){return a.x===t.x&&a.y===t.y}function WR(a,t,n,i){const o=Zg(Cr(a,t,n)),s=Zg(Cr(a,t,i)),c=Zg(Cr(n,i,a)),u=Zg(Cr(n,i,t));return!!(o!==s&&c!==u||o===0&&Kg(a,n,t)||s===0&&Kg(a,i,t)||c===0&&Kg(n,a,i)||u===0&&Kg(n,t,i))}function Kg(a,t,n){return t.x<=Math.max(a.x,n.x)&&t.x>=Math.min(a.x,n.x)&&t.y<=Math.max(a.y,n.y)&&t.y>=Math.min(a.y,n.y)}function Zg(a){return a>0?1:a<0?-1:0}function lG(a,t){let n=a;do{if(n.i!==a.i&&n.next.i!==a.i&&n.i!==t.i&&n.next.i!==t.i&&WR(n,n.next,a,t))return!0;n=n.next}while(n!==a);return!1}function Em(a,t){return Cr(a.prev,a,a.next)<0?Cr(a,t,a.next)>=0&&Cr(a,a.prev,t)>=0:Cr(a,t,a.prev)<0||Cr(a,a.next,t)<0}function cG(a,t){let n=a,i=!1;const o=(a.x+t.x)/2,s=(a.y+t.y)/2;do n.y>s!=n.next.y>s&&n.next.y!==n.y&&o<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next;while(n!==a);return i}function jR(a,t){const n=new Nb(a.i,a.x,a.y),i=new Nb(t.i,t.x,t.y),o=a.next,s=t.prev;return a.next=t,t.prev=a,n.next=o,o.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function JS(a,t,n,i){const o=new Nb(a,t,n);return i?(o.next=i.next,o.prev=i,i.next.prev=o,i.next=o):(o.prev=o,o.next=o),o}function Mm(a){a.next.prev=a.prev,a.prev.next=a.next,a.prevZ&&(a.prevZ.nextZ=a.nextZ),a.nextZ&&(a.nextZ.prevZ=a.prevZ)}function Nb(a,t,n){this.i=a,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function uG(a,t,n,i){let o=0;for(let s=t,c=n-i;s<n;s+=i)o+=(a[c]-a[s])*(a[s+1]+a[c+1]),c=s;return o}class Ha{static area(t){const n=t.length;let i=0;for(let o=n-1,s=0;s<n;o=s++)i+=t[o].x*t[s].y-t[s].x*t[o].y;return i*.5}static isClockWise(t){return Ha.area(t)<0}static triangulateShape(t,n){const i=[],o=[],s=[];e3(t),t3(i,t);let c=t.length;n.forEach(e3);for(let h=0;h<n.length;h++)o.push(c),c+=n[h].length,t3(i,n[h]);const u=qH.triangulate(i,o);for(let h=0;h<u.length;h+=3)s.push(u.slice(h,h+3));return s}}function e3(a){const t=a.length;t>2&&a[t-1].equals(a[0])&&a.pop()}function t3(a,t){for(let n=0;n<t.length;n++)a.push(t[n].x),a.push(t[n].y)}class dd extends Ii{constructor(t=new lh([new yn(.5,.5),new yn(-.5,.5),new yn(-.5,-.5),new yn(.5,-.5)]),n={}){super(),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:n},t=Array.isArray(t)?t:[t];const i=this,o=[],s=[];for(let u=0,h=t.length;u<h;u++){const f=t[u];c(f)}this.setAttribute("position",new ni(o,3)),this.setAttribute("uv",new ni(s,2)),this.computeVertexNormals();function c(u){const h=[],f=n.curveSegments!==void 0?n.curveSegments:12,p=n.steps!==void 0?n.steps:1;let m=n.depth!==void 0?n.depth:1,y=n.bevelEnabled!==void 0?n.bevelEnabled:!0,g=n.bevelThickness!==void 0?n.bevelThickness:.2,_=n.bevelSize!==void 0?n.bevelSize:g-.1,x=n.bevelOffset!==void 0?n.bevelOffset:0,b=n.bevelSegments!==void 0?n.bevelSegments:3;const E=n.extrudePath,T=n.UVGenerator!==void 0?n.UVGenerator:hG;n.amount!==void 0&&(console.warn("THREE.ExtrudeBufferGeometry: amount has been renamed to depth."),m=n.amount);let P,D=!1,F,k,W,j;E&&(P=E.getSpacedPoints(p),D=!0,y=!1,F=E.computeFrenetFrames(p,!1),k=new Ze,W=new Ze,j=new Ze),y||(b=0,g=0,_=0,x=0);const J=u.extractPoints(f);let de=J.shape;const te=J.holes;if(!Ha.isClockWise(de)){de=de.reverse();for(let Ye=0,Pe=te.length;Ye<Pe;Ye++){const Be=te[Ye];Ha.isClockWise(Be)&&(te[Ye]=Be.reverse())}}const L=Ha.triangulateShape(de,te),M=de;for(let Ye=0,Pe=te.length;Ye<Pe;Ye++){const Be=te[Ye];de=de.concat(Be)}function I(Ye,Pe,Be){return Pe||console.error("THREE.ExtrudeGeometry: vec does not exist"),Pe.clone().multiplyScalar(Be).add(Ye)}const U=de.length,$=L.length;function ee(Ye,Pe,Be){let $e,Je,We;const _e=Ye.x-Pe.x,Ee=Ye.y-Pe.y,Oe=Be.x-Ye.x,Le=Be.y-Ye.y,ce=_e*_e+Ee*Ee,he=_e*Le-Ee*Oe;if(Math.abs(he)>Number.EPSILON){const ie=Math.sqrt(ce),V=Math.sqrt(Oe*Oe+Le*Le),Z=Pe.x-Ee/ie,B=Pe.y+_e/ie,S=Be.x-Le/V,R=Be.y+Oe/V,X=((S-Z)*Le-(R-B)*Oe)/(_e*Le-Ee*Oe);$e=Z+_e*X-Ye.x,Je=B+Ee*X-Ye.y;const xe=$e*$e+Je*Je;if(xe<=2)return new yn($e,Je);We=Math.sqrt(xe/2)}else{let ie=!1;_e>Number.EPSILON?Oe>Number.EPSILON&&(ie=!0):_e<-Number.EPSILON?Oe<-Number.EPSILON&&(ie=!0):Math.sign(Ee)===Math.sign(Le)&&(ie=!0),ie?($e=-Ee,Je=_e,We=Math.sqrt(ce)):($e=_e,Je=Ee,We=Math.sqrt(ce/2))}return new yn($e/We,Je/We)}const Q=[];for(let Ye=0,Pe=M.length,Be=Pe-1,$e=Ye+1;Ye<Pe;Ye++,Be++,$e++)Be===Pe&&(Be=0),$e===Pe&&($e=0),Q[Ye]=ee(M[Ye],M[Be],M[$e]);const G=[];let K,Y=Q.concat();for(let Ye=0,Pe=te.length;Ye<Pe;Ye++){const Be=te[Ye];K=[];for(let $e=0,Je=Be.length,We=Je-1,_e=$e+1;$e<Je;$e++,We++,_e++)We===Je&&(We=0),_e===Je&&(_e=0),K[$e]=ee(Be[$e],Be[We],Be[_e]);G.push(K),Y=Y.concat(K)}for(let Ye=0;Ye<b;Ye++){const Pe=Ye/b,Be=g*Math.cos(Pe*Math.PI/2),$e=_*Math.sin(Pe*Math.PI/2)+x;for(let Je=0,We=M.length;Je<We;Je++){const _e=I(M[Je],Q[Je],$e);De(_e.x,_e.y,-Be)}for(let Je=0,We=te.length;Je<We;Je++){const _e=te[Je];K=G[Je];for(let Ee=0,Oe=_e.length;Ee<Oe;Ee++){const Le=I(_e[Ee],K[Ee],$e);De(Le.x,Le.y,-Be)}}}const we=_+x;for(let Ye=0;Ye<U;Ye++){const Pe=y?I(de[Ye],Y[Ye],we):de[Ye];D?(W.copy(F.normals[0]).multiplyScalar(Pe.x),k.copy(F.binormals[0]).multiplyScalar(Pe.y),j.copy(P[0]).add(W).add(k),De(j.x,j.y,j.z)):De(Pe.x,Pe.y,0)}for(let Ye=1;Ye<=p;Ye++)for(let Pe=0;Pe<U;Pe++){const Be=y?I(de[Pe],Y[Pe],we):de[Pe];D?(W.copy(F.normals[Ye]).multiplyScalar(Be.x),k.copy(F.binormals[Ye]).multiplyScalar(Be.y),j.copy(P[Ye]).add(W).add(k),De(j.x,j.y,j.z)):De(Be.x,Be.y,m/p*Ye)}for(let Ye=b-1;Ye>=0;Ye--){const Pe=Ye/b,Be=g*Math.cos(Pe*Math.PI/2),$e=_*Math.sin(Pe*Math.PI/2)+x;for(let Je=0,We=M.length;Je<We;Je++){const _e=I(M[Je],Q[Je],$e);De(_e.x,_e.y,m+Be)}for(let Je=0,We=te.length;Je<We;Je++){const _e=te[Je];K=G[Je];for(let Ee=0,Oe=_e.length;Ee<Oe;Ee++){const Le=I(_e[Ee],K[Ee],$e);D?De(Le.x,Le.y+P[p-1].y,P[p-1].x+Be):De(Le.x,Le.y,m+Be)}}}Ke(),ge();function Ke(){const Ye=o.length/3;if(y){let Pe=0,Be=U*Pe;for(let $e=0;$e<$;$e++){const Je=L[$e];ze(Je[2]+Be,Je[1]+Be,Je[0]+Be)}Pe=p+b*2,Be=U*Pe;for(let $e=0;$e<$;$e++){const Je=L[$e];ze(Je[0]+Be,Je[1]+Be,Je[2]+Be)}}else{for(let Pe=0;Pe<$;Pe++){const Be=L[Pe];ze(Be[2],Be[1],Be[0])}for(let Pe=0;Pe<$;Pe++){const Be=L[Pe];ze(Be[0]+U*p,Be[1]+U*p,Be[2]+U*p)}}i.addGroup(Ye,o.length/3-Ye,0)}function ge(){const Ye=o.length/3;let Pe=0;me(M,Pe),Pe+=M.length;for(let Be=0,$e=te.length;Be<$e;Be++){const Je=te[Be];me(Je,Pe),Pe+=Je.length}i.addGroup(Ye,o.length/3-Ye,1)}function me(Ye,Pe){let Be=Ye.length;for(;--Be>=0;){const $e=Be;let Je=Be-1;Je<0&&(Je=Ye.length-1);for(let We=0,_e=p+b*2;We<_e;We++){const Ee=U*We,Oe=U*(We+1),Le=Pe+$e+Ee,ce=Pe+Je+Ee,he=Pe+Je+Oe,ie=Pe+$e+Oe;tt(Le,ce,he,ie)}}}function De(Ye,Pe,Be){h.push(Ye),h.push(Pe),h.push(Be)}function ze(Ye,Pe,Be){rt(Ye),rt(Pe),rt(Be);const $e=o.length/3,Je=T.generateTopUV(i,o,$e-3,$e-2,$e-1);vt(Je[0]),vt(Je[1]),vt(Je[2])}function tt(Ye,Pe,Be,$e){rt(Ye),rt(Pe),rt($e),rt(Pe),rt(Be),rt($e);const Je=o.length/3,We=T.generateSideWallUV(i,o,Je-6,Je-3,Je-2,Je-1);vt(We[0]),vt(We[1]),vt(We[3]),vt(We[1]),vt(We[2]),vt(We[3])}function rt(Ye){o.push(h[Ye*3+0]),o.push(h[Ye*3+1]),o.push(h[Ye*3+2])}function vt(Ye){s.push(Ye.x),s.push(Ye.y)}}}toJSON(){const t=super.toJSON(),n=this.parameters.shapes,i=this.parameters.options;return fG(n,i,t)}static fromJSON(t,n){const i=[];for(let s=0,c=t.shapes.length;s<c;s++){const u=n[t.shapes[s]];i.push(u)}const o=t.options.extrudePath;return o!==void 0&&(t.options.extrudePath=new j_[o.type]().fromJSON(o)),new dd(i,t.options)}}const hG={generateTopUV:function(a,t,n,i,o){const s=t[n*3],c=t[n*3+1],u=t[i*3],h=t[i*3+1],f=t[o*3],p=t[o*3+1];return[new yn(s,c),new yn(u,h),new yn(f,p)]},generateSideWallUV:function(a,t,n,i,o,s){const c=t[n*3],u=t[n*3+1],h=t[n*3+2],f=t[i*3],p=t[i*3+1],m=t[i*3+2],y=t[o*3],g=t[o*3+1],_=t[o*3+2],x=t[s*3],b=t[s*3+1],E=t[s*3+2];return Math.abs(u-p)<Math.abs(c-f)?[new yn(c,1-h),new yn(f,1-m),new yn(y,1-_),new yn(x,1-E)]:[new yn(u,1-h),new yn(p,1-m),new yn(g,1-_),new yn(b,1-E)]}};function fG(a,t,n){if(n.shapes=[],Array.isArray(a))for(let i=0,o=a.length;i<o;i++){const s=a[i];n.shapes.push(s.uuid)}else n.shapes.push(a.uuid);return n.options=Object.assign({},t),t.extrudePath!==void 0&&(n.options.extrudePath=t.extrudePath.toJSON()),n}class pd extends Qa{constructor(t=1,n=0){const i=(1+Math.sqrt(5))/2,o=[-1,i,0,1,i,0,-1,-i,0,1,-i,0,0,-1,i,0,1,i,0,-1,-i,0,1,-i,i,0,-1,i,0,1,-i,0,-1,-i,0,1],s=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];super(o,s,t,n),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:n}}static fromJSON(t){return new pd(t.radius,t.detail)}}class vh extends Qa{constructor(t=1,n=0){const i=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],o=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];super(i,o,t,n),this.type="OctahedronGeometry",this.parameters={radius:t,detail:n}}static fromJSON(t){return new vh(t.radius,t.detail)}}class md extends Ii{constructor(t=.5,n=1,i=8,o=1,s=0,c=Math.PI*2){super(),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:n,thetaSegments:i,phiSegments:o,thetaStart:s,thetaLength:c},i=Math.max(3,i),o=Math.max(1,o);const u=[],h=[],f=[],p=[];let m=t;const y=(n-t)/o,g=new Ze,_=new yn;for(let x=0;x<=o;x++){for(let b=0;b<=i;b++){const E=s+b/i*c;g.x=m*Math.cos(E),g.y=m*Math.sin(E),h.push(g.x,g.y,g.z),f.push(0,0,1),_.x=(g.x/n+1)/2,_.y=(g.y/n+1)/2,p.push(_.x,_.y)}m+=y}for(let x=0;x<o;x++){const b=x*(i+1);for(let E=0;E<i;E++){const T=E+b,P=T,D=T+i+1,F=T+i+2,k=T+1;u.push(P,D,k),u.push(D,F,k)}}this.setIndex(u),this.setAttribute("position",new ni(h,3)),this.setAttribute("normal",new ni(f,3)),this.setAttribute("uv",new ni(p,2))}static fromJSON(t){return new md(t.innerRadius,t.outerRadius,t.thetaSegments,t.phiSegments,t.thetaStart,t.thetaLength)}}class gd extends Ii{constructor(t=new lh([new yn(0,.5),new yn(-.5,-.5),new yn(.5,-.5)]),n=12){super(),this.type="ShapeGeometry",this.parameters={shapes:t,curveSegments:n};const i=[],o=[],s=[],c=[];let u=0,h=0;if(Array.isArray(t)===!1)f(t);else for(let p=0;p<t.length;p++)f(t[p]),this.addGroup(u,h,p),u+=h,h=0;this.setIndex(i),this.setAttribute("position",new ni(o,3)),this.setAttribute("normal",new ni(s,3)),this.setAttribute("uv",new ni(c,2));function f(p){const m=o.length/3,y=p.extractPoints(n);let g=y.shape;const _=y.holes;Ha.isClockWise(g)===!1&&(g=g.reverse());for(let b=0,E=_.length;b<E;b++){const T=_[b];Ha.isClockWise(T)===!0&&(_[b]=T.reverse())}const x=Ha.triangulateShape(g,_);for(let b=0,E=_.length;b<E;b++){const T=_[b];g=g.concat(T)}for(let b=0,E=g.length;b<E;b++){const T=g[b];o.push(T.x,T.y,0),s.push(0,0,1),c.push(T.x,T.y)}for(let b=0,E=x.length;b<E;b++){const T=x[b],P=T[0]+m,D=T[1]+m,F=T[2]+m;i.push(P,D,F),h+=3}}}toJSON(){const t=super.toJSON(),n=this.parameters.shapes;return dG(n,t)}static fromJSON(t,n){const i=[];for(let o=0,s=t.shapes.length;o<s;o++){const c=n[t.shapes[o]];i.push(c)}return new gd(i,t.curveSegments)}}function dG(a,t){if(t.shapes=[],Array.isArray(a))for(let n=0,i=a.length;n<i;n++){const o=a[n];t.shapes.push(o.uuid)}else t.shapes.push(a.uuid);return t}class yh extends Ii{constructor(t=1,n=32,i=16,o=0,s=Math.PI*2,c=0,u=Math.PI){super(),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:n,heightSegments:i,phiStart:o,phiLength:s,thetaStart:c,thetaLength:u},n=Math.max(3,Math.floor(n)),i=Math.max(2,Math.floor(i));const h=Math.min(c+u,Math.PI);let f=0;const p=[],m=new Ze,y=new Ze,g=[],_=[],x=[],b=[];for(let E=0;E<=i;E++){const T=[],P=E/i;let D=0;E==0&&c==0?D=.5/n:E==i&&h==Math.PI&&(D=-.5/n);for(let F=0;F<=n;F++){const k=F/n;m.x=-t*Math.cos(o+k*s)*Math.sin(c+P*u),m.y=t*Math.cos(c+P*u),m.z=t*Math.sin(o+k*s)*Math.sin(c+P*u),_.push(m.x,m.y,m.z),y.copy(m).normalize(),x.push(y.x,y.y,y.z),b.push(k+D,1-P),T.push(f++)}p.push(T)}for(let E=0;E<i;E++)for(let T=0;T<n;T++){const P=p[E][T+1],D=p[E][T],F=p[E+1][T],k=p[E+1][T+1];(E!==0||c>0)&&g.push(P,D,k),(E!==i-1||h<Math.PI)&&g.push(D,F,k)}this.setIndex(g),this.setAttribute("position",new ni(_,3)),this.setAttribute("normal",new ni(x,3)),this.setAttribute("uv",new ni(b,2))}static fromJSON(t){return new yh(t.radius,t.widthSegments,t.heightSegments,t.phiStart,t.phiLength,t.thetaStart,t.thetaLength)}}class vd extends Qa{constructor(t=1,n=0){const i=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],o=[2,1,0,0,3,2,1,3,0,2,3,1];super(i,o,t,n),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:n}}static fromJSON(t){return new vd(t.radius,t.detail)}}class yd extends Ii{constructor(t=1,n=.4,i=8,o=6,s=Math.PI*2){super(),this.type="TorusGeometry",this.parameters={radius:t,tube:n,radialSegments:i,tubularSegments:o,arc:s},i=Math.floor(i),o=Math.floor(o);const c=[],u=[],h=[],f=[],p=new Ze,m=new Ze,y=new Ze;for(let g=0;g<=i;g++)for(let _=0;_<=o;_++){const x=_/o*s,b=g/i*Math.PI*2;m.x=(t+n*Math.cos(b))*Math.cos(x),m.y=(t+n*Math.cos(b))*Math.sin(x),m.z=n*Math.sin(b),u.push(m.x,m.y,m.z),p.x=t*Math.cos(x),p.y=t*Math.sin(x),y.subVectors(m,p).normalize(),h.push(y.x,y.y,y.z),f.push(_/o),f.push(g/i)}for(let g=1;g<=i;g++)for(let _=1;_<=o;_++){const x=(o+1)*g+_-1,b=(o+1)*(g-1)+_-1,E=(o+1)*(g-1)+_,T=(o+1)*g+_;c.push(x,b,T),c.push(b,E,T)}this.setIndex(c),this.setAttribute("position",new ni(u,3)),this.setAttribute("normal",new ni(h,3)),this.setAttribute("uv",new ni(f,2))}static fromJSON(t){return new yd(t.radius,t.tube,t.radialSegments,t.tubularSegments,t.arc)}}class xd extends Ii{constructor(t=1,n=.4,i=64,o=8,s=2,c=3){super(),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:n,tubularSegments:i,radialSegments:o,p:s,q:c},i=Math.floor(i),o=Math.floor(o);const u=[],h=[],f=[],p=[],m=new Ze,y=new Ze,g=new Ze,_=new Ze,x=new Ze,b=new Ze,E=new Ze;for(let P=0;P<=i;++P){const D=P/i*s*Math.PI*2;T(D,s,c,t,g),T(D+.01,s,c,t,_),b.subVectors(_,g),E.addVectors(_,g),x.crossVectors(b,E),E.crossVectors(x,b),x.normalize(),E.normalize();for(let F=0;F<=o;++F){const k=F/o*Math.PI*2,W=-n*Math.cos(k),j=n*Math.sin(k);m.x=g.x+(W*E.x+j*x.x),m.y=g.y+(W*E.y+j*x.y),m.z=g.z+(W*E.z+j*x.z),h.push(m.x,m.y,m.z),y.subVectors(m,g).normalize(),f.push(y.x,y.y,y.z),p.push(P/i),p.push(F/o)}}for(let P=1;P<=i;P++)for(let D=1;D<=o;D++){const F=(o+1)*(P-1)+(D-1),k=(o+1)*P+(D-1),W=(o+1)*P+D,j=(o+1)*(P-1)+D;u.push(F,k,j),u.push(k,W,j)}this.setIndex(u),this.setAttribute("position",new ni(h,3)),this.setAttribute("normal",new ni(f,3)),this.setAttribute("uv",new ni(p,2));function T(P,D,F,k,W){const j=Math.cos(P),J=Math.sin(P),de=F/D*P,te=Math.cos(de);W.x=k*(2+te)*.5*j,W.y=k*(2+te)*J*.5,W.z=k*Math.sin(de)*.5}}static fromJSON(t){return new xd(t.radius,t.tube,t.tubularSegments,t.radialSegments,t.p,t.q)}}class Ad extends Ii{constructor(t=new V_(new Ze(-1,-1,0),new Ze(-1,1,0),new Ze(1,1,0)),n=64,i=1,o=8,s=!1){super(),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:n,radius:i,radialSegments:o,closed:s};const c=t.computeFrenetFrames(n,s);this.tangents=c.tangents,this.normals=c.normals,this.binormals=c.binormals;const u=new Ze,h=new Ze,f=new yn;let p=new Ze;const m=[],y=[],g=[],_=[];x(),this.setIndex(_),this.setAttribute("position",new ni(m,3)),this.setAttribute("normal",new ni(y,3)),this.setAttribute("uv",new ni(g,2));function x(){for(let P=0;P<n;P++)b(P);b(s===!1?n:0),T(),E()}function b(P){p=t.getPointAt(P/n,p);const D=c.normals[P],F=c.binormals[P];for(let k=0;k<=o;k++){const W=k/o*Math.PI*2,j=Math.sin(W),J=-Math.cos(W);h.x=J*D.x+j*F.x,h.y=J*D.y+j*F.y,h.z=J*D.z+j*F.z,h.normalize(),y.push(h.x,h.y,h.z),u.x=p.x+i*h.x,u.y=p.y+i*h.y,u.z=p.z+i*h.z,m.push(u.x,u.y,u.z)}}function E(){for(let P=1;P<=n;P++)for(let D=1;D<=o;D++){const F=(o+1)*(P-1)+(D-1),k=(o+1)*P+(D-1),W=(o+1)*P+D,j=(o+1)*(P-1)+D;_.push(F,k,j),_.push(k,W,j)}}function T(){for(let P=0;P<=n;P++)for(let D=0;D<=o;D++)f.x=P/n,f.y=D/o,g.push(f.x,f.y)}}toJSON(){const t=super.toJSON();return t.path=this.parameters.path.toJSON(),t}static fromJSON(t){return new Ad(new j_[t.path.type]().fromJSON(t.path),t.tubularSegments,t.radius,t.radialSegments,t.closed)}}class XR extends Ii{constructor(t=null){if(super(),this.type="WireframeGeometry",this.parameters={geometry:t},t!==null){const n=[],i=new Set,o=new Ze,s=new Ze;if(t.index!==null){const c=t.attributes.position,u=t.index;let h=t.groups;h.length===0&&(h=[{start:0,count:u.count,materialIndex:0}]);for(let f=0,p=h.length;f<p;++f){const m=h[f],y=m.start,g=m.count;for(let _=y,x=y+g;_<x;_+=3)for(let b=0;b<3;b++){const E=u.getX(_+b),T=u.getX(_+(b+1)%3);o.fromBufferAttribute(c,E),s.fromBufferAttribute(c,T),n3(o,s,i)===!0&&(n.push(o.x,o.y,o.z),n.push(s.x,s.y,s.z))}}}else{const c=t.attributes.position;for(let u=0,h=c.count/3;u<h;u++)for(let f=0;f<3;f++){const p=3*u+f,m=3*u+(f+1)%3;o.fromBufferAttribute(c,p),s.fromBufferAttribute(c,m),n3(o,s,i)===!0&&(n.push(o.x,o.y,o.z),n.push(s.x,s.y,s.z))}}this.setAttribute("position",new ni(n,3))}}}function n3(a,t,n){const i=`${a.x},${a.y},${a.z}-${t.x},${t.y},${t.z}`,o=`${t.x},${t.y},${t.z}-${a.x},${a.y},${a.z}`;return n.has(i)===!0||n.has(o)===!0?!1:(n.add(i),n.add(o),!0)}var i3=Object.freeze({__proto__:null,BoxGeometry:zl,BoxBufferGeometry:zl,CapsuleGeometry:cd,CapsuleBufferGeometry:cd,CircleGeometry:ud,CircleBufferGeometry:ud,ConeGeometry:hd,ConeBufferGeometry:hd,CylinderGeometry:Wc,CylinderBufferGeometry:Wc,DodecahedronGeometry:fd,DodecahedronBufferGeometry:fd,EdgesGeometry:GR,ExtrudeGeometry:dd,ExtrudeBufferGeometry:dd,IcosahedronGeometry:pd,IcosahedronBufferGeometry:pd,LatheGeometry:gh,LatheBufferGeometry:gh,OctahedronGeometry:vh,OctahedronBufferGeometry:vh,PlaneGeometry:ph,PlaneBufferGeometry:ph,PolyhedronGeometry:Qa,PolyhedronBufferGeometry:Qa,RingGeometry:md,RingBufferGeometry:md,ShapeGeometry:gd,ShapeBufferGeometry:gd,SphereGeometry:yh,SphereBufferGeometry:yh,TetrahedronGeometry:vd,TetrahedronBufferGeometry:vd,TorusGeometry:yd,TorusBufferGeometry:yd,TorusKnotGeometry:xd,TorusKnotBufferGeometry:xd,TubeGeometry:Ad,TubeBufferGeometry:Ad,WireframeGeometry:XR});class $R extends rs{constructor(t){super(),this.isShadowMaterial=!0,this.type="ShadowMaterial",this.color=new qn(0),this.transparent=!0,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.fog=t.fog,this}}class qR extends Ya{constructor(t){super(t),this.isRawShaderMaterial=!0,this.type="RawShaderMaterial"}}class X_ extends rs{constructor(t){super(),this.isMeshStandardMaterial=!0,this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new qn(16777215),this.roughness=1,this.metalness=0,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new qn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=wh,this.normalScale=new yn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}class YR extends X_{constructor(t){super(),this.isMeshPhysicalMaterial=!0,this.defines={STANDARD:"",PHYSICAL:""},this.type="MeshPhysicalMaterial",this.clearcoatMap=null,this.clearcoatRoughness=0,this.clearcoatRoughnessMap=null,this.clearcoatNormalScale=new yn(1,1),this.clearcoatNormalMap=null,this.ior=1.5,Object.defineProperty(this,"reflectivity",{get:function(){return Wr(2.5*(this.ior-1)/(this.ior+1),0,1)},set:function(n){this.ior=(1+.4*n)/(1-.4*n)}}),this.iridescenceMap=null,this.iridescenceIOR=1.3,this.iridescenceThicknessRange=[100,400],this.iridescenceThicknessMap=null,this.sheenColor=new qn(0),this.sheenColorMap=null,this.sheenRoughness=1,this.sheenRoughnessMap=null,this.transmissionMap=null,this.thickness=0,this.thicknessMap=null,this.attenuationDistance=0,this.attenuationColor=new qn(1,1,1),this.specularIntensity=1,this.specularIntensityMap=null,this.specularColor=new qn(1,1,1),this.specularColorMap=null,this._sheen=0,this._clearcoat=0,this._iridescence=0,this._transmission=0,this.setValues(t)}get sheen(){return this._sheen}set sheen(t){this._sheen>0!=t>0&&this.version++,this._sheen=t}get clearcoat(){return this._clearcoat}set clearcoat(t){this._clearcoat>0!=t>0&&this.version++,this._clearcoat=t}get iridescence(){return this._iridescence}set iridescence(t){this._iridescence>0!=t>0&&this.version++,this._iridescence=t}get transmission(){return this._transmission}set transmission(t){this._transmission>0!=t>0&&this.version++,this._transmission=t}copy(t){return super.copy(t),this.defines={STANDARD:"",PHYSICAL:""},this.clearcoat=t.clearcoat,this.clearcoatMap=t.clearcoatMap,this.clearcoatRoughness=t.clearcoatRoughness,this.clearcoatRoughnessMap=t.clearcoatRoughnessMap,this.clearcoatNormalMap=t.clearcoatNormalMap,this.clearcoatNormalScale.copy(t.clearcoatNormalScale),this.ior=t.ior,this.iridescence=t.iridescence,this.iridescenceMap=t.iridescenceMap,this.iridescenceIOR=t.iridescenceIOR,this.iridescenceThicknessRange=[...t.iridescenceThicknessRange],this.iridescenceThicknessMap=t.iridescenceThicknessMap,this.sheen=t.sheen,this.sheenColor.copy(t.sheenColor),this.sheenColorMap=t.sheenColorMap,this.sheenRoughness=t.sheenRoughness,this.sheenRoughnessMap=t.sheenRoughnessMap,this.transmission=t.transmission,this.transmissionMap=t.transmissionMap,this.thickness=t.thickness,this.thicknessMap=t.thicknessMap,this.attenuationDistance=t.attenuationDistance,this.attenuationColor.copy(t.attenuationColor),this.specularIntensity=t.specularIntensity,this.specularIntensityMap=t.specularIntensityMap,this.specularColor.copy(t.specularColor),this.specularColorMap=t.specularColorMap,this}}class QR extends rs{constructor(t){super(),this.isMeshPhongMaterial=!0,this.type="MeshPhongMaterial",this.color=new qn(16777215),this.specular=new qn(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new qn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=wh,this.normalScale=new yn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Dm,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.flatShading=t.flatShading,this.fog=t.fog,this}}class KR extends rs{constructor(t){super(),this.isMeshToonMaterial=!0,this.defines={TOON:""},this.type="MeshToonMaterial",this.color=new qn(16777215),this.map=null,this.gradientMap=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new qn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=wh,this.normalScale=new yn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.gradientMap=t.gradientMap,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}class ZR extends rs{constructor(t){super(),this.isMeshNormalMaterial=!0,this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=wh,this.normalScale=new yn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.flatShading=!1,this.setValues(t)}copy(t){return super.copy(t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.flatShading=t.flatShading,this}}class JR extends rs{constructor(t){super(),this.isMeshLambertMaterial=!0,this.type="MeshLambertMaterial",this.color=new qn(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new qn(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=Dm,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}class eL extends rs{constructor(t){super(),this.isMeshMatcapMaterial=!0,this.defines={MATCAP:""},this.type="MeshMatcapMaterial",this.color=new qn(16777215),this.matcap=null,this.map=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalMapType=wh,this.normalScale=new yn(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.alphaMap=null,this.flatShading=!1,this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.defines={MATCAP:""},this.color.copy(t.color),this.matcap=t.matcap,this.map=t.map,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalMapType=t.normalMapType,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.alphaMap=t.alphaMap,this.flatShading=t.flatShading,this.fog=t.fog,this}}class tL extends io{constructor(t){super(),this.isLineDashedMaterial=!0,this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}copy(t){return super.copy(t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this}}const pG={ShadowMaterial:$R,SpriteMaterial:N_,RawShaderMaterial:qR,ShaderMaterial:Ya,PointsMaterial:k_,MeshPhysicalMaterial:YR,MeshStandardMaterial:X_,MeshPhongMaterial:QR,MeshToonMaterial:KR,MeshNormalMaterial:ZR,MeshLambertMaterial:JR,MeshDepthMaterial:B_,MeshDistanceMaterial:F_,MeshBasicMaterial:qc,MeshMatcapMaterial:eL,LineDashedMaterial:tL,LineBasicMaterial:io,Material:rs};rs.fromType=function(a){return new pG[a]};const br={arraySlice:function(a,t,n){return br.isTypedArray(a)?new a.constructor(a.subarray(t,n!==void 0?n:a.length)):a.slice(t,n)},convertArray:function(a,t,n){return!a||!n&&a.constructor===t?a:typeof t.BYTES_PER_ELEMENT=="number"?new t(a):Array.prototype.slice.call(a)},isTypedArray:function(a){return ArrayBuffer.isView(a)&&!(a instanceof DataView)},getKeyframeOrder:function(a){function t(o,s){return a[o]-a[s]}const n=a.length,i=new Array(n);for(let o=0;o!==n;++o)i[o]=o;return i.sort(t),i},sortedArray:function(a,t,n){const i=a.length,o=new a.constructor(i);for(let s=0,c=0;c!==i;++s){const u=n[s]*t;for(let h=0;h!==t;++h)o[c++]=a[u+h]}return o},flattenJSON:function(a,t,n,i){let o=1,s=a[0];for(;s!==void 0&&s[i]===void 0;)s=a[o++];if(s===void 0)return;let c=s[i];if(c!==void 0)if(Array.isArray(c))do c=s[i],c!==void 0&&(t.push(s.time),n.push.apply(n,c)),s=a[o++];while(s!==void 0);else if(c.toArray!==void 0)do c=s[i],c!==void 0&&(t.push(s.time),c.toArray(n,n.length)),s=a[o++];while(s!==void 0);else do c=s[i],c!==void 0&&(t.push(s.time),n.push(c)),s=a[o++];while(s!==void 0)},subclip:function(a,t,n,i,o=30){const s=a.clone();s.name=t;const c=[];for(let h=0;h<s.tracks.length;++h){const f=s.tracks[h],p=f.getValueSize(),m=[],y=[];for(let g=0;g<f.times.length;++g){const _=f.times[g]*o;if(!(_<n||_>=i)){m.push(f.times[g]);for(let x=0;x<p;++x)y.push(f.values[g*p+x])}}m.length!==0&&(f.times=br.convertArray(m,f.times.constructor),f.values=br.convertArray(y,f.values.constructor),c.push(f))}s.tracks=c;let u=1/0;for(let h=0;h<s.tracks.length;++h)u>s.tracks[h].times[0]&&(u=s.tracks[h].times[0]);for(let h=0;h<s.tracks.length;++h)s.tracks[h].shift(-1*u);return s.resetDuration(),s},makeClipAdditive:function(a,t=0,n=a,i=30){i<=0&&(i=30);const o=n.tracks.length,s=t/i;for(let c=0;c<o;++c){const u=n.tracks[c],h=u.ValueTypeName;if(h==="bool"||h==="string")continue;const f=a.tracks.find(function(E){return E.name===u.name&&E.ValueTypeName===h});if(f===void 0)continue;let p=0;const m=u.getValueSize();u.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(p=m/3);let y=0;const g=f.getValueSize();f.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline&&(y=g/3);const _=u.times.length-1;let x;if(s<=u.times[0]){const E=p,T=m-p;x=br.arraySlice(u.values,E,T)}else if(s>=u.times[_]){const E=_*m+p,T=E+m-p;x=br.arraySlice(u.values,E,T)}else{const E=u.createInterpolant(),T=p,P=m-p;E.evaluate(s),x=br.arraySlice(E.resultBuffer,T,P)}h==="quaternion"&&new ao().fromArray(x).normalize().conjugate().toArray(x);const b=f.times.length;for(let E=0;E<b;++E){const T=E*g+y;if(h==="quaternion")ao.multiplyQuaternionsFlat(f.values,T,x,0,f.values,T);else{const P=g-y*2;for(let D=0;D<P;++D)f.values[T+D]-=x[D]}}}return a.blendMode=R_,a}};class Um{constructor(t,n,i,o){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=o!==void 0?o:new n.constructor(i),this.sampleValues=n,this.valueSize=i,this.settings=null,this.DefaultSettings_={}}evaluate(t){const n=this.parameterPositions;let i=this._cachedIndex,o=n[i],s=n[i-1];e:{t:{let c;n:{i:if(!(t<o)){for(let u=i+2;;){if(o===void 0){if(t<s)break i;return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}if(i===u)break;if(s=o,o=n[++i],t<o)break t}c=n.length;break n}if(!(t>=s)){const u=n[1];t<u&&(i=2,s=u);for(let h=i-2;;){if(s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(i===h)break;if(o=s,s=n[--i-1],t>=s)break t}c=i,i=0;break n}break e}for(;i<c;){const u=i+c>>>1;t<n[u]?c=u:i=u+1}if(o=n[i],s=n[i-1],s===void 0)return this._cachedIndex=0,this.copySampleValue_(0);if(o===void 0)return i=n.length,this._cachedIndex=i,this.copySampleValue_(i-1)}this._cachedIndex=i,this.intervalChanged_(i,s,o)}return this.interpolate_(i,s,t,o)}getSettings_(){return this.settings||this.DefaultSettings_}copySampleValue_(t){const n=this.resultBuffer,i=this.sampleValues,o=this.valueSize,s=t*o;for(let c=0;c!==o;++c)n[c]=i[s+c];return n}interpolate_(){throw new Error("call to abstract method")}intervalChanged_(){}}class nL extends Um{constructor(t,n,i,o){super(t,n,i,o),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0,this.DefaultSettings_={endingStart:Ku,endingEnd:Ku}}intervalChanged_(t,n,i){const o=this.parameterPositions;let s=t-2,c=t+1,u=o[s],h=o[c];if(u===void 0)switch(this.getSettings_().endingStart){case Zu:s=t,u=2*n-i;break;case xm:s=o.length-2,u=n+o[s]-o[s+1];break;default:s=t,u=i}if(h===void 0)switch(this.getSettings_().endingEnd){case Zu:c=t,h=2*i-n;break;case xm:c=1,h=i+o[1]-o[0];break;default:c=t-1,h=n}const f=(i-n)*.5,p=this.valueSize;this._weightPrev=f/(n-u),this._weightNext=f/(h-i),this._offsetPrev=s*p,this._offsetNext=c*p}interpolate_(t,n,i,o){const s=this.resultBuffer,c=this.sampleValues,u=this.valueSize,h=t*u,f=h-u,p=this._offsetPrev,m=this._offsetNext,y=this._weightPrev,g=this._weightNext,_=(i-n)/(o-n),x=_*_,b=x*_,E=-y*b+2*y*x-y*_,T=(1+y)*b+(-1.5-2*y)*x+(-.5+y)*_+1,P=(-1-g)*b+(1.5+g)*x+.5*_,D=g*b-g*x;for(let F=0;F!==u;++F)s[F]=E*c[p+F]+T*c[f+F]+P*c[h+F]+D*c[m+F];return s}}class $_ extends Um{constructor(t,n,i,o){super(t,n,i,o)}interpolate_(t,n,i,o){const s=this.resultBuffer,c=this.sampleValues,u=this.valueSize,h=t*u,f=h-u,p=(i-n)/(o-n),m=1-p;for(let y=0;y!==u;++y)s[y]=c[f+y]*m+c[h+y]*p;return s}}class iL extends Um{constructor(t,n,i,o){super(t,n,i,o)}interpolate_(t){return this.copySampleValue_(t-1)}}class Aa{constructor(t,n,i,o){if(t===void 0)throw new Error("THREE.KeyframeTrack: track name is undefined");if(n===void 0||n.length===0)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=br.convertArray(n,this.TimeBufferType),this.values=br.convertArray(i,this.ValueBufferType),this.setInterpolation(o||this.DefaultInterpolation)}static toJSON(t){const n=t.constructor;let i;if(n.toJSON!==this.toJSON)i=n.toJSON(t);else{i={name:t.name,times:br.convertArray(t.times,Array),values:br.convertArray(t.values,Array)};const o=t.getInterpolation();o!==t.DefaultInterpolation&&(i.interpolation=o)}return i.type=t.ValueTypeName,i}InterpolantFactoryMethodDiscrete(t){return new iL(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodLinear(t){return new $_(this.times,this.values,this.getValueSize(),t)}InterpolantFactoryMethodSmooth(t){return new nL(this.times,this.values,this.getValueSize(),t)}setInterpolation(t){let n;switch(t){case vm:n=this.InterpolantFactoryMethodDiscrete;break;case ym:n=this.InterpolantFactoryMethodLinear;break;case vv:n=this.InterpolantFactoryMethodSmooth;break}if(n===void 0){const i="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(this.createInterpolant===void 0)if(t!==this.DefaultInterpolation)this.setInterpolation(this.DefaultInterpolation);else throw new Error(i);return console.warn("THREE.KeyframeTrack:",i),this}return this.createInterpolant=n,this}getInterpolation(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return vm;case this.InterpolantFactoryMethodLinear:return ym;case this.InterpolantFactoryMethodSmooth:return vv}}getValueSize(){return this.values.length/this.times.length}shift(t){if(t!==0){const n=this.times;for(let i=0,o=n.length;i!==o;++i)n[i]+=t}return this}scale(t){if(t!==1){const n=this.times;for(let i=0,o=n.length;i!==o;++i)n[i]*=t}return this}trim(t,n){const i=this.times,o=i.length;let s=0,c=o-1;for(;s!==o&&i[s]<t;)++s;for(;c!==-1&&i[c]>n;)--c;if(++c,s!==0||c!==o){s>=c&&(c=Math.max(c,1),s=c-1);const u=this.getValueSize();this.times=br.arraySlice(i,s,c),this.values=br.arraySlice(this.values,s*u,c*u)}return this}validate(){let t=!0;const n=this.getValueSize();n-Math.floor(n)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);const i=this.times,o=this.values,s=i.length;s===0&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);let c=null;for(let u=0;u!==s;u++){const h=i[u];if(typeof h=="number"&&isNaN(h)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,u,h),t=!1;break}if(c!==null&&c>h){console.error("THREE.KeyframeTrack: Out of order keys.",this,u,h,c),t=!1;break}c=h}if(o!==void 0&&br.isTypedArray(o))for(let u=0,h=o.length;u!==h;++u){const f=o[u];if(isNaN(f)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,u,f),t=!1;break}}return t}optimize(){const t=br.arraySlice(this.times),n=br.arraySlice(this.values),i=this.getValueSize(),o=this.getInterpolation()===vv,s=t.length-1;let c=1;for(let u=1;u<s;++u){let h=!1;const f=t[u],p=t[u+1];if(f!==p&&(u!==1||f!==t[0]))if(o)h=!0;else{const m=u*i,y=m-i,g=m+i;for(let _=0;_!==i;++_){const x=n[m+_];if(x!==n[y+_]||x!==n[g+_]){h=!0;break}}}if(h){if(u!==c){t[c]=t[u];const m=u*i,y=c*i;for(let g=0;g!==i;++g)n[y+g]=n[m+g]}++c}}if(s>0){t[c]=t[s];for(let u=s*i,h=c*i,f=0;f!==i;++f)n[h+f]=n[u+f];++c}return c!==t.length?(this.times=br.arraySlice(t,0,c),this.values=br.arraySlice(n,0,c*i)):(this.times=t,this.values=n),this}clone(){const t=br.arraySlice(this.times,0),n=br.arraySlice(this.values,0),i=this.constructor,o=new i(this.name,t,n);return o.createInterpolant=this.createInterpolant,o}}Aa.prototype.TimeBufferType=Float32Array;Aa.prototype.ValueBufferType=Float32Array;Aa.prototype.DefaultInterpolation=ym;class Sh extends Aa{}Sh.prototype.ValueTypeName="bool";Sh.prototype.ValueBufferType=Array;Sh.prototype.DefaultInterpolation=vm;Sh.prototype.InterpolantFactoryMethodLinear=void 0;Sh.prototype.InterpolantFactoryMethodSmooth=void 0;class q_ extends Aa{}q_.prototype.ValueTypeName="color";class Sm extends Aa{}Sm.prototype.ValueTypeName="number";class rL extends Um{constructor(t,n,i,o){super(t,n,i,o)}interpolate_(t,n,i,o){const s=this.resultBuffer,c=this.sampleValues,u=this.valueSize,h=(i-n)/(o-n);let f=t*u;for(let p=f+u;f!==p;f+=4)ao.slerpFlat(s,0,c,f-u,c,f,h);return s}}class kd extends Aa{InterpolantFactoryMethodLinear(t){return new rL(this.times,this.values,this.getValueSize(),t)}}kd.prototype.ValueTypeName="quaternion";kd.prototype.DefaultInterpolation=ym;kd.prototype.InterpolantFactoryMethodSmooth=void 0;class Th extends Aa{}Th.prototype.ValueTypeName="string";Th.prototype.ValueBufferType=Array;Th.prototype.DefaultInterpolation=vm;Th.prototype.InterpolantFactoryMethodLinear=void 0;Th.prototype.InterpolantFactoryMethodSmooth=void 0;class Tm extends Aa{}Tm.prototype.ValueTypeName="vector";class Cm{constructor(t,n=-1,i,o=hy){this.name=t,this.tracks=i,this.duration=n,this.blendMode=o,this.uuid=Co(),this.duration<0&&this.resetDuration()}static parse(t){const n=[],i=t.tracks,o=1/(t.fps||1);for(let c=0,u=i.length;c!==u;++c)n.push(gG(i[c]).scale(o));const s=new this(t.name,t.duration,n,t.blendMode);return s.uuid=t.uuid,s}static toJSON(t){const n=[],i=t.tracks,o={name:t.name,duration:t.duration,tracks:n,uuid:t.uuid,blendMode:t.blendMode};for(let s=0,c=i.length;s!==c;++s)n.push(Aa.toJSON(i[s]));return o}static CreateFromMorphTargetSequence(t,n,i,o){const s=n.length,c=[];for(let u=0;u<s;u++){let h=[],f=[];h.push((u+s-1)%s,u,(u+1)%s),f.push(0,1,0);const p=br.getKeyframeOrder(h);h=br.sortedArray(h,1,p),f=br.sortedArray(f,1,p),!o&&h[0]===0&&(h.push(s),f.push(f[0])),c.push(new Sm(".morphTargetInfluences["+n[u].name+"]",h,f).scale(1/i))}return new this(t,-1,c)}static findByName(t,n){let i=t;if(!Array.isArray(t)){const o=t;i=o.geometry&&o.geometry.animations||o.animations}for(let o=0;o<i.length;o++)if(i[o].name===n)return i[o];return null}static CreateClipsFromMorphTargetSequences(t,n,i){const o={},s=/^([\w-]*?)([\d]+)$/;for(let u=0,h=t.length;u<h;u++){const f=t[u],p=f.name.match(s);if(p&&p.length>1){const m=p[1];let y=o[m];y||(o[m]=y=[]),y.push(f)}}const c=[];for(const u in o)c.push(this.CreateFromMorphTargetSequence(u,o[u],n,i));return c}static parseAnimation(t,n){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;const i=function(m,y,g,_,x){if(g.length!==0){const b=[],E=[];br.flattenJSON(g,b,E,_),b.length!==0&&x.push(new m(y,b,E))}},o=[],s=t.name||"default",c=t.fps||30,u=t.blendMode;let h=t.length||-1;const f=t.hierarchy||[];for(let m=0;m<f.length;m++){const y=f[m].keys;if(!(!y||y.length===0))if(y[0].morphTargets){const g={};let _;for(_=0;_<y.length;_++)if(y[_].morphTargets)for(let x=0;x<y[_].morphTargets.length;x++)g[y[_].morphTargets[x]]=-1;for(const x in g){const b=[],E=[];for(let T=0;T!==y[_].morphTargets.length;++T){const P=y[_];b.push(P.time),E.push(P.morphTarget===x?1:0)}o.push(new Sm(".morphTargetInfluence["+x+"]",b,E))}h=g.length*c}else{const g=".bones["+n[m].name+"]";i(Tm,g+".position",y,"pos",o),i(kd,g+".quaternion",y,"rot",o),i(Tm,g+".scale",y,"scl",o)}}return o.length===0?null:new this(s,h,o,u)}resetDuration(){const t=this.tracks;let n=0;for(let i=0,o=t.length;i!==o;++i){const s=this.tracks[i];n=Math.max(n,s.times[s.times.length-1])}return this.duration=n,this}trim(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this}validate(){let t=!0;for(let n=0;n<this.tracks.length;n++)t=t&&this.tracks[n].validate();return t}optimize(){for(let t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}clone(){const t=[];for(let n=0;n<this.tracks.length;n++)t.push(this.tracks[n].clone());return new this.constructor(this.name,this.duration,t,this.blendMode)}toJSON(){return this.constructor.toJSON(this)}}function mG(a){switch(a.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return Sm;case"vector":case"vector2":case"vector3":case"vector4":return Tm;case"color":return q_;case"quaternion":return kd;case"bool":case"boolean":return Sh;case"string":return Th}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+a)}function gG(a){if(a.type===void 0)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");const t=mG(a.type);if(a.times===void 0){const n=[],i=[];br.flattenJSON(a.keys,n,i,"value"),a.times=n,a.values=i}return t.parse!==void 0?t.parse(a):new t(a.name,a.times,a.values,a.interpolation)}const xh={enabled:!1,files:{},add:function(a,t){this.enabled!==!1&&(this.files[a]=t)},get:function(a){if(this.enabled!==!1)return this.files[a]},remove:function(a){delete this.files[a]},clear:function(){this.files={}}};class Y_{constructor(t,n,i){const o=this;let s=!1,c=0,u=0,h;const f=[];this.onStart=void 0,this.onLoad=t,this.onProgress=n,this.onError=i,this.itemStart=function(p){u++,s===!1&&o.onStart!==void 0&&o.onStart(p,c,u),s=!0},this.itemEnd=function(p){c++,o.onProgress!==void 0&&o.onProgress(p,c,u),c===u&&(s=!1,o.onLoad!==void 0&&o.onLoad())},this.itemError=function(p){o.onError!==void 0&&o.onError(p)},this.resolveURL=function(p){return h?h(p):p},this.setURLModifier=function(p){return h=p,this},this.addHandler=function(p,m){return f.push(p,m),this},this.removeHandler=function(p){const m=f.indexOf(p);return m!==-1&&f.splice(m,2),this},this.getHandler=function(p){for(let m=0,y=f.length;m<y;m+=2){const g=f[m],_=f[m+1];if(g.global&&(g.lastIndex=0),g.test(p))return _}return null}}}const sL=new Y_;class Po{constructor(t){this.manager=t!==void 0?t:sL,this.crossOrigin="anonymous",this.withCredentials=!1,this.path="",this.resourcePath="",this.requestHeader={}}load(){}loadAsync(t,n){const i=this;return new Promise(function(o,s){i.load(t,o,n,s)})}parse(){}setCrossOrigin(t){return this.crossOrigin=t,this}setWithCredentials(t){return this.withCredentials=t,this}setPath(t){return this.path=t,this}setResourcePath(t){return this.resourcePath=t,this}setRequestHeader(t){return this.requestHeader=t,this}}const Ll={};class Hl extends Po{constructor(t){super(t)}load(t,n,i,o){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const s=xh.get(t);if(s!==void 0)return this.manager.itemStart(t),setTimeout(()=>{n&&n(s),this.manager.itemEnd(t)},0),s;if(Ll[t]!==void 0){Ll[t].push({onLoad:n,onProgress:i,onError:o});return}Ll[t]=[],Ll[t].push({onLoad:n,onProgress:i,onError:o});const c=new Request(t,{headers:new Headers(this.requestHeader),credentials:this.withCredentials?"include":"same-origin"}),u=this.mimeType,h=this.responseType;fetch(c).then(f=>{if(f.status===200||f.status===0){if(f.status===0&&console.warn("THREE.FileLoader: HTTP Status 0 received."),typeof ReadableStream=="undefined"||f.body===void 0||f.body.getReader===void 0)return f;const p=Ll[t],m=f.body.getReader(),y=f.headers.get("Content-Length"),g=y?parseInt(y):0,_=g!==0;let x=0;const b=new ReadableStream({start(E){T();function T(){m.read().then(({done:P,value:D})=>{if(P)E.close();else{x+=D.byteLength;const F=new ProgressEvent("progress",{lengthComputable:_,loaded:x,total:g});for(let k=0,W=p.length;k<W;k++){const j=p[k];j.onProgress&&j.onProgress(F)}E.enqueue(D),T()}})}}});return new Response(b)}else throw Error(`fetch for "${f.url}" responded with ${f.status}: ${f.statusText}`)}).then(f=>{switch(h){case"arraybuffer":return f.arrayBuffer();case"blob":return f.blob();case"document":return f.text().then(p=>new DOMParser().parseFromString(p,u));case"json":return f.json();default:if(u===void 0)return f.text();{const m=/charset="?([^;"\s]*)"?/i.exec(u),y=m&&m[1]?m[1].toLowerCase():void 0,g=new TextDecoder(y);return f.arrayBuffer().then(_=>g.decode(_))}}}).then(f=>{xh.add(t,f);const p=Ll[t];delete Ll[t];for(let m=0,y=p.length;m<y;m++){const g=p[m];g.onLoad&&g.onLoad(f)}}).catch(f=>{const p=Ll[t];if(p===void 0)throw this.manager.itemError(t),f;delete Ll[t];for(let m=0,y=p.length;m<y;m++){const g=p[m];g.onError&&g.onError(f)}this.manager.itemError(t)}).finally(()=>{this.manager.itemEnd(t)}),this.manager.itemStart(t)}setResponseType(t){return this.responseType=t,this}setMimeType(t){return this.mimeType=t,this}}class vG extends Po{constructor(t){super(t)}load(t,n,i,o){const s=this,c=new Hl(this.manager);c.setPath(this.path),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(t,function(u){try{n(s.parse(JSON.parse(u)))}catch(h){o?o(h):console.error(h),s.manager.itemError(t)}},i,o)}parse(t){const n=[];for(let i=0;i<t.length;i++){const o=Cm.parse(t[i]);n.push(o)}return n}}class yG extends Po{constructor(t){super(t)}load(t,n,i,o){const s=this,c=[],u=new FR,h=new Hl(this.manager);h.setPath(this.path),h.setResponseType("arraybuffer"),h.setRequestHeader(this.requestHeader),h.setWithCredentials(s.withCredentials);let f=0;function p(m){h.load(t[m],function(y){const g=s.parse(y,!0);c[m]={width:g.width,height:g.height,format:g.format,mipmaps:g.mipmaps},f+=1,f===6&&(g.mipmapCount===1&&(u.minFilter=Vr),u.image=c,u.format=g.format,u.needsUpdate=!0,n&&n(u))},i,o)}if(Array.isArray(t))for(let m=0,y=t.length;m<y;++m)p(m);else h.load(t,function(m){const y=s.parse(m,!0);if(y.isCubemap){const g=y.mipmaps.length/y.mipmapCount;for(let _=0;_<g;_++){c[_]={mipmaps:[]};for(let x=0;x<y.mipmapCount;x++)c[_].mipmaps.push(y.mipmaps[_*y.mipmapCount+x]),c[_].format=y.format,c[_].width=y.width,c[_].height=y.height}u.image=c}else u.image.width=y.width,u.image.height=y.height,u.mipmaps=y.mipmaps;y.mipmapCount===1&&(u.minFilter=Vr),u.format=y.format,u.needsUpdate=!0,n&&n(u)},i,o);return u}}class Rm extends Po{constructor(t){super(t)}load(t,n,i,o){this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const s=this,c=xh.get(t);if(c!==void 0)return s.manager.itemStart(t),setTimeout(function(){n&&n(c),s.manager.itemEnd(t)},0),c;const u=bm("img");function h(){p(),xh.add(t,this),n&&n(this),s.manager.itemEnd(t)}function f(m){p(),o&&o(m),s.manager.itemError(t),s.manager.itemEnd(t)}function p(){u.removeEventListener("load",h,!1),u.removeEventListener("error",f,!1)}return u.addEventListener("load",h,!1),u.addEventListener("error",f,!1),t.slice(0,5)!=="data:"&&this.crossOrigin!==void 0&&(u.crossOrigin=this.crossOrigin),s.manager.itemStart(t),u.src=t,u}}class xG extends Po{constructor(t){super(t)}load(t,n,i,o){const s=new Nm,c=new Rm(this.manager);c.setCrossOrigin(this.crossOrigin),c.setPath(this.path);let u=0;function h(f){c.load(t[f],function(p){s.images[f]=p,u++,u===6&&(s.needsUpdate=!0,n&&n(s))},void 0,o)}for(let f=0;f<t.length;++f)h(f);return s}}class AG extends Po{constructor(t){super(t)}load(t,n,i,o){const s=this,c=new id,u=new Hl(this.manager);return u.setResponseType("arraybuffer"),u.setRequestHeader(this.requestHeader),u.setPath(this.path),u.setWithCredentials(s.withCredentials),u.load(t,function(h){const f=s.parse(h);!f||(f.image!==void 0?c.image=f.image:f.data!==void 0&&(c.image.width=f.width,c.image.height=f.height,c.image.data=f.data),c.wrapS=f.wrapS!==void 0?f.wrapS:Qs,c.wrapT=f.wrapT!==void 0?f.wrapT:Qs,c.magFilter=f.magFilter!==void 0?f.magFilter:Vr,c.minFilter=f.minFilter!==void 0?f.minFilter:Vr,c.anisotropy=f.anisotropy!==void 0?f.anisotropy:1,f.encoding!==void 0&&(c.encoding=f.encoding),f.flipY!==void 0&&(c.flipY=f.flipY),f.format!==void 0&&(c.format=f.format),f.type!==void 0&&(c.type=f.type),f.mipmaps!==void 0&&(c.mipmaps=f.mipmaps,c.minFilter=_h),f.mipmapCount===1&&(c.minFilter=Vr),f.generateMipmaps!==void 0&&(c.generateMipmaps=f.generateMipmaps),c.needsUpdate=!0,n&&n(c,f))},i,o),c}}class bG extends Po{constructor(t){super(t)}load(t,n,i,o){const s=new is,c=new Rm(this.manager);return c.setCrossOrigin(this.crossOrigin),c.setPath(this.path),c.load(t,function(u){s.image=u,s.needsUpdate=!0,n!==void 0&&n(s)},i,o),s}}class Yc extends or{constructor(t,n=1){super(),this.isLight=!0,this.type="Light",this.color=new qn(t),this.intensity=n}dispose(){}copy(t,n){return super.copy(t,n),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const n=super.toJSON(t);return n.object.color=this.color.getHex(),n.object.intensity=this.intensity,this.groundColor!==void 0&&(n.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(n.object.distance=this.distance),this.angle!==void 0&&(n.object.angle=this.angle),this.decay!==void 0&&(n.object.decay=this.decay),this.penumbra!==void 0&&(n.object.penumbra=this.penumbra),this.shadow!==void 0&&(n.object.shadow=this.shadow.toJSON()),n}}class oL extends Yc{constructor(t,n,i){super(t,i),this.isHemisphereLight=!0,this.type="HemisphereLight",this.position.copy(or.DefaultUp),this.updateMatrix(),this.groundColor=new qn(n)}copy(t,n){return super.copy(t,n),this.groundColor.copy(t.groundColor),this}}const r3=new Oi,s3=new Ze,o3=new Ze;class Q_{constructor(t){this.camera=t,this.bias=0,this.normalBias=0,this.radius=1,this.blurSamples=8,this.mapSize=new yn(512,512),this.map=null,this.mapPass=null,this.matrix=new Oi,this.autoUpdate=!0,this.needsUpdate=!1,this._frustum=new my,this._frameExtents=new yn(1,1),this._viewportCount=1,this._viewports=[new ur(0,0,1,1)]}getViewportCount(){return this._viewportCount}getFrustum(){return this._frustum}updateMatrices(t){const n=this.camera,i=this.matrix;s3.setFromMatrixPosition(t.matrixWorld),n.position.copy(s3),o3.setFromMatrixPosition(t.target.matrixWorld),n.lookAt(o3),n.updateMatrixWorld(),r3.multiplyMatrices(n.projectionMatrix,n.matrixWorldInverse),this._frustum.setFromProjectionMatrix(r3),i.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),i.multiply(n.projectionMatrix),i.multiply(n.matrixWorldInverse)}getViewport(t){return this._viewports[t]}getFrameExtents(){return this._frameExtents}dispose(){this.map&&this.map.dispose(),this.mapPass&&this.mapPass.dispose()}copy(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this}clone(){return new this.constructor().copy(this)}toJSON(){const t={};return this.bias!==0&&(t.bias=this.bias),this.normalBias!==0&&(t.normalBias=this.normalBias),this.radius!==1&&(t.radius=this.radius),(this.mapSize.x!==512||this.mapSize.y!==512)&&(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}class _G extends Q_{constructor(){super(new Es(50,1,.5,500)),this.isSpotLightShadow=!0,this.focus=1}updateMatrices(t){const n=this.camera,i=Am*2*t.angle*this.focus,o=this.mapSize.width/this.mapSize.height,s=t.distance||n.far;(i!==n.fov||o!==n.aspect||s!==n.far)&&(n.fov=i,n.aspect=o,n.far=s,n.updateProjectionMatrix()),super.updateMatrices(t)}copy(t){return super.copy(t),this.focus=t.focus,this}}class aL extends Yc{constructor(t,n,i=0,o=Math.PI/3,s=0,c=1){super(t,n),this.isSpotLight=!0,this.type="SpotLight",this.position.copy(or.DefaultUp),this.updateMatrix(),this.target=new or,this.distance=i,this.angle=o,this.penumbra=s,this.decay=c,this.shadow=new _G}get power(){return this.intensity*Math.PI}set power(t){this.intensity=t/Math.PI}dispose(){this.shadow.dispose()}copy(t,n){return super.copy(t,n),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}const a3=new Oi,kp=new Ze,vA=new Ze;class wG extends Q_{constructor(){super(new Es(90,1,.5,500)),this.isPointLightShadow=!0,this._frameExtents=new yn(4,2),this._viewportCount=6,this._viewports=[new ur(2,1,1,1),new ur(0,1,1,1),new ur(3,1,1,1),new ur(1,1,1,1),new ur(3,0,1,1),new ur(1,0,1,1)],this._cubeDirections=[new Ze(1,0,0),new Ze(-1,0,0),new Ze(0,0,1),new Ze(0,0,-1),new Ze(0,1,0),new Ze(0,-1,0)],this._cubeUps=[new Ze(0,1,0),new Ze(0,1,0),new Ze(0,1,0),new Ze(0,1,0),new Ze(0,0,1),new Ze(0,0,-1)]}updateMatrices(t,n=0){const i=this.camera,o=this.matrix,s=t.distance||i.far;s!==i.far&&(i.far=s,i.updateProjectionMatrix()),kp.setFromMatrixPosition(t.matrixWorld),i.position.copy(kp),vA.copy(i.position),vA.add(this._cubeDirections[n]),i.up.copy(this._cubeUps[n]),i.lookAt(vA),i.updateMatrixWorld(),o.makeTranslation(-kp.x,-kp.y,-kp.z),a3.multiplyMatrices(i.projectionMatrix,i.matrixWorldInverse),this._frustum.setFromProjectionMatrix(a3)}}class lL extends Yc{constructor(t,n,i=0,o=1){super(t,n),this.isPointLight=!0,this.type="PointLight",this.distance=i,this.decay=o,this.shadow=new wG}get power(){return this.intensity*4*Math.PI}set power(t){this.intensity=t/(4*Math.PI)}dispose(){this.shadow.dispose()}copy(t,n){return super.copy(t,n),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}class EG extends Q_{constructor(){super(new gy(-5,5,5,-5,.5,500)),this.isDirectionalLightShadow=!0}}class cL extends Yc{constructor(t,n){super(t,n),this.isDirectionalLight=!0,this.type="DirectionalLight",this.position.copy(or.DefaultUp),this.updateMatrix(),this.target=new or,this.shadow=new EG}dispose(){this.shadow.dispose()}copy(t){return super.copy(t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}class uL extends Yc{constructor(t,n){super(t,n),this.isAmbientLight=!0,this.type="AmbientLight"}}class hL extends Yc{constructor(t,n,i=10,o=10){super(t,n),this.isRectAreaLight=!0,this.type="RectAreaLight",this.width=i,this.height=o}get power(){return this.intensity*this.width*this.height*Math.PI}set power(t){this.intensity=t/(this.width*this.height*Math.PI)}copy(t){return super.copy(t),this.width=t.width,this.height=t.height,this}toJSON(t){const n=super.toJSON(t);return n.object.width=this.width,n.object.height=this.height,n}}class fL{constructor(){this.isSphericalHarmonics3=!0,this.coefficients=[];for(let t=0;t<9;t++)this.coefficients.push(new Ze)}set(t){for(let n=0;n<9;n++)this.coefficients[n].copy(t[n]);return this}zero(){for(let t=0;t<9;t++)this.coefficients[t].set(0,0,0);return this}getAt(t,n){const i=t.x,o=t.y,s=t.z,c=this.coefficients;return n.copy(c[0]).multiplyScalar(.282095),n.addScaledVector(c[1],.488603*o),n.addScaledVector(c[2],.488603*s),n.addScaledVector(c[3],.488603*i),n.addScaledVector(c[4],1.092548*(i*o)),n.addScaledVector(c[5],1.092548*(o*s)),n.addScaledVector(c[6],.315392*(3*s*s-1)),n.addScaledVector(c[7],1.092548*(i*s)),n.addScaledVector(c[8],.546274*(i*i-o*o)),n}getIrradianceAt(t,n){const i=t.x,o=t.y,s=t.z,c=this.coefficients;return n.copy(c[0]).multiplyScalar(.886227),n.addScaledVector(c[1],2*.511664*o),n.addScaledVector(c[2],2*.511664*s),n.addScaledVector(c[3],2*.511664*i),n.addScaledVector(c[4],2*.429043*i*o),n.addScaledVector(c[5],2*.429043*o*s),n.addScaledVector(c[6],.743125*s*s-.247708),n.addScaledVector(c[7],2*.429043*i*s),n.addScaledVector(c[8],.429043*(i*i-o*o)),n}add(t){for(let n=0;n<9;n++)this.coefficients[n].add(t.coefficients[n]);return this}addScaledSH(t,n){for(let i=0;i<9;i++)this.coefficients[i].addScaledVector(t.coefficients[i],n);return this}scale(t){for(let n=0;n<9;n++)this.coefficients[n].multiplyScalar(t);return this}lerp(t,n){for(let i=0;i<9;i++)this.coefficients[i].lerp(t.coefficients[i],n);return this}equals(t){for(let n=0;n<9;n++)if(!this.coefficients[n].equals(t.coefficients[n]))return!1;return!0}copy(t){return this.set(t.coefficients)}clone(){return new this.constructor().copy(this)}fromArray(t,n=0){const i=this.coefficients;for(let o=0;o<9;o++)i[o].fromArray(t,n+o*3);return this}toArray(t=[],n=0){const i=this.coefficients;for(let o=0;o<9;o++)i[o].toArray(t,n+o*3);return t}static getBasisAt(t,n){const i=t.x,o=t.y,s=t.z;n[0]=.282095,n[1]=.488603*o,n[2]=.488603*s,n[3]=.488603*i,n[4]=1.092548*i*o,n[5]=1.092548*o*s,n[6]=.315392*(3*s*s-1),n[7]=1.092548*i*s,n[8]=.546274*(i*i-o*o)}}class My extends Yc{constructor(t=new fL,n=1){super(void 0,n),this.isLightProbe=!0,this.sh=t}copy(t){return super.copy(t),this.sh.copy(t.sh),this}fromJSON(t){return this.intensity=t.intensity,this.sh.fromArray(t.sh),this}toJSON(t){const n=super.toJSON(t);return n.object.sh=this.sh.toArray(),n}}class dL extends Po{constructor(t){super(t),this.textures={}}load(t,n,i,o){const s=this,c=new Hl(s.manager);c.setPath(s.path),c.setRequestHeader(s.requestHeader),c.setWithCredentials(s.withCredentials),c.load(t,function(u){try{n(s.parse(JSON.parse(u)))}catch(h){o?o(h):console.error(h),s.manager.itemError(t)}},i,o)}parse(t){const n=this.textures;function i(s){return n[s]===void 0&&console.warn("THREE.MaterialLoader: Undefined texture",s),n[s]}const o=rs.fromType(t.type);if(t.uuid!==void 0&&(o.uuid=t.uuid),t.name!==void 0&&(o.name=t.name),t.color!==void 0&&o.color!==void 0&&o.color.setHex(t.color),t.roughness!==void 0&&(o.roughness=t.roughness),t.metalness!==void 0&&(o.metalness=t.metalness),t.sheen!==void 0&&(o.sheen=t.sheen),t.sheenColor!==void 0&&(o.sheenColor=new qn().setHex(t.sheenColor)),t.sheenRoughness!==void 0&&(o.sheenRoughness=t.sheenRoughness),t.emissive!==void 0&&o.emissive!==void 0&&o.emissive.setHex(t.emissive),t.specular!==void 0&&o.specular!==void 0&&o.specular.setHex(t.specular),t.specularIntensity!==void 0&&(o.specularIntensity=t.specularIntensity),t.specularColor!==void 0&&o.specularColor!==void 0&&o.specularColor.setHex(t.specularColor),t.shininess!==void 0&&(o.shininess=t.shininess),t.clearcoat!==void 0&&(o.clearcoat=t.clearcoat),t.clearcoatRoughness!==void 0&&(o.clearcoatRoughness=t.clearcoatRoughness),t.iridescence!==void 0&&(o.iridescence=t.iridescence),t.iridescenceIOR!==void 0&&(o.iridescenceIOR=t.iridescenceIOR),t.iridescenceThicknessRange!==void 0&&(o.iridescenceThicknessRange=t.iridescenceThicknessRange),t.transmission!==void 0&&(o.transmission=t.transmission),t.thickness!==void 0&&(o.thickness=t.thickness),t.attenuationDistance!==void 0&&(o.attenuationDistance=t.attenuationDistance),t.attenuationColor!==void 0&&o.attenuationColor!==void 0&&o.attenuationColor.setHex(t.attenuationColor),t.fog!==void 0&&(o.fog=t.fog),t.flatShading!==void 0&&(o.flatShading=t.flatShading),t.blending!==void 0&&(o.blending=t.blending),t.combine!==void 0&&(o.combine=t.combine),t.side!==void 0&&(o.side=t.side),t.shadowSide!==void 0&&(o.shadowSide=t.shadowSide),t.opacity!==void 0&&(o.opacity=t.opacity),t.transparent!==void 0&&(o.transparent=t.transparent),t.alphaTest!==void 0&&(o.alphaTest=t.alphaTest),t.depthTest!==void 0&&(o.depthTest=t.depthTest),t.depthWrite!==void 0&&(o.depthWrite=t.depthWrite),t.colorWrite!==void 0&&(o.colorWrite=t.colorWrite),t.stencilWrite!==void 0&&(o.stencilWrite=t.stencilWrite),t.stencilWriteMask!==void 0&&(o.stencilWriteMask=t.stencilWriteMask),t.stencilFunc!==void 0&&(o.stencilFunc=t.stencilFunc),t.stencilRef!==void 0&&(o.stencilRef=t.stencilRef),t.stencilFuncMask!==void 0&&(o.stencilFuncMask=t.stencilFuncMask),t.stencilFail!==void 0&&(o.stencilFail=t.stencilFail),t.stencilZFail!==void 0&&(o.stencilZFail=t.stencilZFail),t.stencilZPass!==void 0&&(o.stencilZPass=t.stencilZPass),t.wireframe!==void 0&&(o.wireframe=t.wireframe),t.wireframeLinewidth!==void 0&&(o.wireframeLinewidth=t.wireframeLinewidth),t.wireframeLinecap!==void 0&&(o.wireframeLinecap=t.wireframeLinecap),t.wireframeLinejoin!==void 0&&(o.wireframeLinejoin=t.wireframeLinejoin),t.rotation!==void 0&&(o.rotation=t.rotation),t.linewidth!==1&&(o.linewidth=t.linewidth),t.dashSize!==void 0&&(o.dashSize=t.dashSize),t.gapSize!==void 0&&(o.gapSize=t.gapSize),t.scale!==void 0&&(o.scale=t.scale),t.polygonOffset!==void 0&&(o.polygonOffset=t.polygonOffset),t.polygonOffsetFactor!==void 0&&(o.polygonOffsetFactor=t.polygonOffsetFactor),t.polygonOffsetUnits!==void 0&&(o.polygonOffsetUnits=t.polygonOffsetUnits),t.dithering!==void 0&&(o.dithering=t.dithering),t.alphaToCoverage!==void 0&&(o.alphaToCoverage=t.alphaToCoverage),t.premultipliedAlpha!==void 0&&(o.premultipliedAlpha=t.premultipliedAlpha),t.visible!==void 0&&(o.visible=t.visible),t.toneMapped!==void 0&&(o.toneMapped=t.toneMapped),t.userData!==void 0&&(o.userData=t.userData),t.vertexColors!==void 0&&(typeof t.vertexColors=="number"?o.vertexColors=t.vertexColors>0:o.vertexColors=t.vertexColors),t.uniforms!==void 0)for(const s in t.uniforms){const c=t.uniforms[s];switch(o.uniforms[s]={},c.type){case"t":o.uniforms[s].value=i(c.value);break;case"c":o.uniforms[s].value=new qn().setHex(c.value);break;case"v2":o.uniforms[s].value=new yn().fromArray(c.value);break;case"v3":o.uniforms[s].value=new Ze().fromArray(c.value);break;case"v4":o.uniforms[s].value=new ur().fromArray(c.value);break;case"m3":o.uniforms[s].value=new Ho().fromArray(c.value);break;case"m4":o.uniforms[s].value=new Oi().fromArray(c.value);break;default:o.uniforms[s].value=c.value}}if(t.defines!==void 0&&(o.defines=t.defines),t.vertexShader!==void 0&&(o.vertexShader=t.vertexShader),t.fragmentShader!==void 0&&(o.fragmentShader=t.fragmentShader),t.extensions!==void 0)for(const s in t.extensions)o.extensions[s]=t.extensions[s];if(t.shading!==void 0&&(o.flatShading=t.shading===1),t.size!==void 0&&(o.size=t.size),t.sizeAttenuation!==void 0&&(o.sizeAttenuation=t.sizeAttenuation),t.map!==void 0&&(o.map=i(t.map)),t.matcap!==void 0&&(o.matcap=i(t.matcap)),t.alphaMap!==void 0&&(o.alphaMap=i(t.alphaMap)),t.bumpMap!==void 0&&(o.bumpMap=i(t.bumpMap)),t.bumpScale!==void 0&&(o.bumpScale=t.bumpScale),t.normalMap!==void 0&&(o.normalMap=i(t.normalMap)),t.normalMapType!==void 0&&(o.normalMapType=t.normalMapType),t.normalScale!==void 0){let s=t.normalScale;Array.isArray(s)===!1&&(s=[s,s]),o.normalScale=new yn().fromArray(s)}return t.displacementMap!==void 0&&(o.displacementMap=i(t.displacementMap)),t.displacementScale!==void 0&&(o.displacementScale=t.displacementScale),t.displacementBias!==void 0&&(o.displacementBias=t.displacementBias),t.roughnessMap!==void 0&&(o.roughnessMap=i(t.roughnessMap)),t.metalnessMap!==void 0&&(o.metalnessMap=i(t.metalnessMap)),t.emissiveMap!==void 0&&(o.emissiveMap=i(t.emissiveMap)),t.emissiveIntensity!==void 0&&(o.emissiveIntensity=t.emissiveIntensity),t.specularMap!==void 0&&(o.specularMap=i(t.specularMap)),t.specularIntensityMap!==void 0&&(o.specularIntensityMap=i(t.specularIntensityMap)),t.specularColorMap!==void 0&&(o.specularColorMap=i(t.specularColorMap)),t.envMap!==void 0&&(o.envMap=i(t.envMap)),t.envMapIntensity!==void 0&&(o.envMapIntensity=t.envMapIntensity),t.reflectivity!==void 0&&(o.reflectivity=t.reflectivity),t.refractionRatio!==void 0&&(o.refractionRatio=t.refractionRatio),t.lightMap!==void 0&&(o.lightMap=i(t.lightMap)),t.lightMapIntensity!==void 0&&(o.lightMapIntensity=t.lightMapIntensity),t.aoMap!==void 0&&(o.aoMap=i(t.aoMap)),t.aoMapIntensity!==void 0&&(o.aoMapIntensity=t.aoMapIntensity),t.gradientMap!==void 0&&(o.gradientMap=i(t.gradientMap)),t.clearcoatMap!==void 0&&(o.clearcoatMap=i(t.clearcoatMap)),t.clearcoatRoughnessMap!==void 0&&(o.clearcoatRoughnessMap=i(t.clearcoatRoughnessMap)),t.clearcoatNormalMap!==void 0&&(o.clearcoatNormalMap=i(t.clearcoatNormalMap)),t.clearcoatNormalScale!==void 0&&(o.clearcoatNormalScale=new yn().fromArray(t.clearcoatNormalScale)),t.iridescenceMap!==void 0&&(o.iridescenceMap=i(t.iridescenceMap)),t.iridescenceThicknessMap!==void 0&&(o.iridescenceThicknessMap=i(t.iridescenceThicknessMap)),t.transmissionMap!==void 0&&(o.transmissionMap=i(t.transmissionMap)),t.thicknessMap!==void 0&&(o.thicknessMap=i(t.thicknessMap)),t.sheenColorMap!==void 0&&(o.sheenColorMap=i(t.sheenColorMap)),t.sheenRoughnessMap!==void 0&&(o.sheenRoughnessMap=i(t.sheenRoughnessMap)),o}setTextures(t){return this.textures=t,this}}class Ub{static decodeText(t){if(typeof TextDecoder!="undefined")return new TextDecoder().decode(t);let n="";for(let i=0,o=t.length;i<o;i++)n+=String.fromCharCode(t[i]);try{return decodeURIComponent(escape(n))}catch{return n}}static extractUrlBase(t){const n=t.lastIndexOf("/");return n===-1?"./":t.slice(0,n+1)}static resolveURL(t,n){return typeof t!="string"||t===""?"":(/^https?:\/\//i.test(n)&&/^\//.test(t)&&(n=n.replace(/(^https?:\/\/[^\/]+).*/i,"$1")),/^(https?:)?\/\//i.test(t)||/^data:.*,.*$/i.test(t)||/^blob:.*$/i.test(t)?t:n+t)}}class pL extends Ii{constructor(){super(),this.isInstancedBufferGeometry=!0,this.type="InstancedBufferGeometry",this.instanceCount=1/0}copy(t){return super.copy(t),this.instanceCount=t.instanceCount,this}clone(){return new this.constructor().copy(this)}toJSON(){const t=super.toJSON(this);return t.instanceCount=this.instanceCount,t.isInstancedBufferGeometry=!0,t}}class mL extends Po{constructor(t){super(t)}load(t,n,i,o){const s=this,c=new Hl(s.manager);c.setPath(s.path),c.setRequestHeader(s.requestHeader),c.setWithCredentials(s.withCredentials),c.load(t,function(u){try{n(s.parse(JSON.parse(u)))}catch(h){o?o(h):console.error(h),s.manager.itemError(t)}},i,o)}parse(t){const n={},i={};function o(g,_){if(n[_]!==void 0)return n[_];const b=g.interleavedBuffers[_],E=s(g,b.buffer),T=qf(b.type,E),P=new Ay(T,b.stride);return P.uuid=b.uuid,n[_]=P,P}function s(g,_){if(i[_]!==void 0)return i[_];const b=g.arrayBuffers[_],E=new Uint32Array(b).buffer;return i[_]=E,E}const c=t.isInstancedBufferGeometry?new pL:new Ii,u=t.data.index;if(u!==void 0){const g=qf(u.type,u.array);c.setIndex(new mr(g,1))}const h=t.data.attributes;for(const g in h){const _=h[g];let x;if(_.isInterleavedBufferAttribute){const b=o(t.data,_.data);x=new mh(b,_.itemSize,_.offset,_.normalized)}else{const b=qf(_.type,_.array),E=_.isInstancedBufferAttribute?ld:mr;x=new E(b,_.itemSize,_.normalized)}_.name!==void 0&&(x.name=_.name),_.usage!==void 0&&x.setUsage(_.usage),_.updateRange!==void 0&&(x.updateRange.offset=_.updateRange.offset,x.updateRange.count=_.updateRange.count),c.setAttribute(g,x)}const f=t.data.morphAttributes;if(f)for(const g in f){const _=f[g],x=[];for(let b=0,E=_.length;b<E;b++){const T=_[b];let P;if(T.isInterleavedBufferAttribute){const D=o(t.data,T.data);P=new mh(D,T.itemSize,T.offset,T.normalized)}else{const D=qf(T.type,T.array);P=new mr(D,T.itemSize,T.normalized)}T.name!==void 0&&(P.name=T.name),x.push(P)}c.morphAttributes[g]=x}t.data.morphTargetsRelative&&(c.morphTargetsRelative=!0);const m=t.data.groups||t.data.drawcalls||t.data.offsets;if(m!==void 0)for(let g=0,_=m.length;g!==_;++g){const x=m[g];c.addGroup(x.start,x.count,x.materialIndex)}const y=t.data.boundingSphere;if(y!==void 0){const g=new Ze;y.center!==void 0&&g.fromArray(y.center),c.boundingSphere=new Mh(g,y.radius)}return t.name&&(c.name=t.name),t.userData&&(c.userData=t.userData),c}}class MG extends Po{constructor(t){super(t)}load(t,n,i,o){const s=this,c=this.path===""?Ub.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||c;const u=new Hl(this.manager);u.setPath(this.path),u.setRequestHeader(this.requestHeader),u.setWithCredentials(this.withCredentials),u.load(t,function(h){let f=null;try{f=JSON.parse(h)}catch(m){o!==void 0&&o(m),console.error("THREE:ObjectLoader: Can't parse "+t+".",m.message);return}const p=f.metadata;if(p===void 0||p.type===void 0||p.type.toLowerCase()==="geometry"){console.error("THREE.ObjectLoader: Can't load "+t);return}s.parse(f,n)},i,o)}async loadAsync(t,n){const i=this,o=this.path===""?Ub.extractUrlBase(t):this.path;this.resourcePath=this.resourcePath||o;const s=new Hl(this.manager);s.setPath(this.path),s.setRequestHeader(this.requestHeader),s.setWithCredentials(this.withCredentials);const c=await s.loadAsync(t,n),u=JSON.parse(c),h=u.metadata;if(h===void 0||h.type===void 0||h.type.toLowerCase()==="geometry")throw new Error("THREE.ObjectLoader: Can't load "+t);return await i.parseAsync(u)}parse(t,n){const i=this.parseAnimations(t.animations),o=this.parseShapes(t.shapes),s=this.parseGeometries(t.geometries,o),c=this.parseImages(t.images,function(){n!==void 0&&n(f)}),u=this.parseTextures(t.textures,c),h=this.parseMaterials(t.materials,u),f=this.parseObject(t.object,s,h,u,i),p=this.parseSkeletons(t.skeletons,f);if(this.bindSkeletons(f,p),n!==void 0){let m=!1;for(const y in c)if(c[y].data instanceof HTMLImageElement){m=!0;break}m===!1&&n(f)}return f}async parseAsync(t){const n=this.parseAnimations(t.animations),i=this.parseShapes(t.shapes),o=this.parseGeometries(t.geometries,i),s=await this.parseImagesAsync(t.images),c=this.parseTextures(t.textures,s),u=this.parseMaterials(t.materials,c),h=this.parseObject(t.object,o,u,c,n),f=this.parseSkeletons(t.skeletons,h);return this.bindSkeletons(h,f),h}parseShapes(t){const n={};if(t!==void 0)for(let i=0,o=t.length;i<o;i++){const s=new lh().fromJSON(t[i]);n[s.uuid]=s}return n}parseSkeletons(t,n){const i={},o={};if(n.traverse(function(s){s.isBone&&(o[s.uuid]=s)}),t!==void 0)for(let s=0,c=t.length;s<c;s++){const u=new by().fromJSON(t[s],o);i[u.uuid]=u}return i}parseGeometries(t,n){const i={};if(t!==void 0){const o=new mL;for(let s=0,c=t.length;s<c;s++){let u;const h=t[s];switch(h.type){case"BufferGeometry":case"InstancedBufferGeometry":u=o.parse(h);break;case"Geometry":console.error("THREE.ObjectLoader: The legacy Geometry type is no longer supported.");break;default:h.type in i3?u=i3[h.type].fromJSON(h,n):console.warn(`THREE.ObjectLoader: Unsupported geometry type "${h.type}"`)}u.uuid=h.uuid,h.name!==void 0&&(u.name=h.name),u.isBufferGeometry===!0&&h.userData!==void 0&&(u.userData=h.userData),i[h.uuid]=u}}return i}parseMaterials(t,n){const i={},o={};if(t!==void 0){const s=new dL;s.setTextures(n);for(let c=0,u=t.length;c<u;c++){const h=t[c];if(h.type==="MultiMaterial"){const f=[];for(let p=0;p<h.materials.length;p++){const m=h.materials[p];i[m.uuid]===void 0&&(i[m.uuid]=s.parse(m)),f.push(i[m.uuid])}o[h.uuid]=f}else i[h.uuid]===void 0&&(i[h.uuid]=s.parse(h)),o[h.uuid]=i[h.uuid]}}return o}parseAnimations(t){const n={};if(t!==void 0)for(let i=0;i<t.length;i++){const o=t[i],s=Cm.parse(o);n[s.uuid]=s}return n}parseImages(t,n){const i=this,o={};let s;function c(h){return i.manager.itemStart(h),s.load(h,function(){i.manager.itemEnd(h)},void 0,function(){i.manager.itemError(h),i.manager.itemEnd(h)})}function u(h){if(typeof h=="string"){const f=h,p=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(f)?f:i.resourcePath+f;return c(p)}else return h.data?{data:qf(h.type,h.data),width:h.width,height:h.height}:null}if(t!==void 0&&t.length>0){const h=new Y_(n);s=new Rm(h),s.setCrossOrigin(this.crossOrigin);for(let f=0,p=t.length;f<p;f++){const m=t[f],y=m.url;if(Array.isArray(y)){const g=[];for(let _=0,x=y.length;_<x;_++){const b=y[_],E=u(b);E!==null&&(E instanceof HTMLImageElement?g.push(E):g.push(new id(E.data,E.width,E.height)))}o[m.uuid]=new Ju(g)}else{const g=u(m.url);o[m.uuid]=new Ju(g)}}}return o}async parseImagesAsync(t){const n=this,i={};let o;async function s(c){if(typeof c=="string"){const u=c,h=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u)?u:n.resourcePath+u;return await o.loadAsync(h)}else return c.data?{data:qf(c.type,c.data),width:c.width,height:c.height}:null}if(t!==void 0&&t.length>0){o=new Rm(this.manager),o.setCrossOrigin(this.crossOrigin);for(let c=0,u=t.length;c<u;c++){const h=t[c],f=h.url;if(Array.isArray(f)){const p=[];for(let m=0,y=f.length;m<y;m++){const g=f[m],_=await s(g);_!==null&&(_ instanceof HTMLImageElement?p.push(_):p.push(new id(_.data,_.width,_.height)))}i[h.uuid]=new Ju(p)}else{const p=await s(h.url);i[h.uuid]=new Ju(p)}}}return i}parseTextures(t,n){function i(s,c){return typeof s=="number"?s:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",s),c[s])}const o={};if(t!==void 0)for(let s=0,c=t.length;s<c;s++){const u=t[s];u.image===void 0&&console.warn('THREE.ObjectLoader: No "image" specified for',u.uuid),n[u.image]===void 0&&console.warn("THREE.ObjectLoader: Undefined image",u.image);const h=n[u.image],f=h.data;let p;Array.isArray(f)?(p=new Nm,f.length===6&&(p.needsUpdate=!0)):(f&&f.data?p=new id:p=new is,f&&(p.needsUpdate=!0)),p.source=h,p.uuid=u.uuid,u.name!==void 0&&(p.name=u.name),u.mapping!==void 0&&(p.mapping=i(u.mapping,SG)),u.offset!==void 0&&p.offset.fromArray(u.offset),u.repeat!==void 0&&p.repeat.fromArray(u.repeat),u.center!==void 0&&p.center.fromArray(u.center),u.rotation!==void 0&&(p.rotation=u.rotation),u.wrap!==void 0&&(p.wrapS=i(u.wrap[0],l3),p.wrapT=i(u.wrap[1],l3)),u.format!==void 0&&(p.format=u.format),u.type!==void 0&&(p.type=u.type),u.encoding!==void 0&&(p.encoding=u.encoding),u.minFilter!==void 0&&(p.minFilter=i(u.minFilter,c3)),u.magFilter!==void 0&&(p.magFilter=i(u.magFilter,c3)),u.anisotropy!==void 0&&(p.anisotropy=u.anisotropy),u.flipY!==void 0&&(p.flipY=u.flipY),u.premultiplyAlpha!==void 0&&(p.premultiplyAlpha=u.premultiplyAlpha),u.unpackAlignment!==void 0&&(p.unpackAlignment=u.unpackAlignment),u.userData!==void 0&&(p.userData=u.userData),o[u.uuid]=p}return o}parseObject(t,n,i,o,s){let c;function u(y){return n[y]===void 0&&console.warn("THREE.ObjectLoader: Undefined geometry",y),n[y]}function h(y){if(y!==void 0){if(Array.isArray(y)){const g=[];for(let _=0,x=y.length;_<x;_++){const b=y[_];i[b]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",b),g.push(i[b])}return g}return i[y]===void 0&&console.warn("THREE.ObjectLoader: Undefined material",y),i[y]}}function f(y){return o[y]===void 0&&console.warn("THREE.ObjectLoader: Undefined texture",y),o[y]}let p,m;switch(t.type){case"Scene":c=new CR,t.background!==void 0&&(Number.isInteger(t.background)?c.background=new qn(t.background):c.background=f(t.background)),t.environment!==void 0&&(c.environment=f(t.environment)),t.fog!==void 0&&(t.fog.type==="Fog"?c.fog=new xy(t.fog.color,t.fog.near,t.fog.far):t.fog.type==="FogExp2"&&(c.fog=new yy(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":c=new Es(t.fov,t.aspect,t.near,t.far),t.focus!==void 0&&(c.focus=t.focus),t.zoom!==void 0&&(c.zoom=t.zoom),t.filmGauge!==void 0&&(c.filmGauge=t.filmGauge),t.filmOffset!==void 0&&(c.filmOffset=t.filmOffset),t.view!==void 0&&(c.view=Object.assign({},t.view));break;case"OrthographicCamera":c=new gy(t.left,t.right,t.top,t.bottom,t.near,t.far),t.zoom!==void 0&&(c.zoom=t.zoom),t.view!==void 0&&(c.view=Object.assign({},t.view));break;case"AmbientLight":c=new uL(t.color,t.intensity);break;case"DirectionalLight":c=new cL(t.color,t.intensity);break;case"PointLight":c=new lL(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":c=new hL(t.color,t.intensity,t.width,t.height);break;case"SpotLight":c=new aL(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":c=new oL(t.color,t.groundColor,t.intensity);break;case"LightProbe":c=new My().fromJSON(t);break;case"SkinnedMesh":p=u(t.geometry),m=h(t.material),c=new IR(p,m),t.bindMode!==void 0&&(c.bindMode=t.bindMode),t.bindMatrix!==void 0&&c.bindMatrix.fromArray(t.bindMatrix),t.skeleton!==void 0&&(c.skeleton=t.skeleton);break;case"Mesh":p=u(t.geometry),m=h(t.material),c=new Ss(p,m);break;case"InstancedMesh":p=u(t.geometry),m=h(t.material);const y=t.count,g=t.instanceMatrix,_=t.instanceColor;c=new OR(p,m,y),c.instanceMatrix=new ld(new Float32Array(g.array),16),_!==void 0&&(c.instanceColor=new ld(new Float32Array(_.array),_.itemSize));break;case"LOD":c=new PR;break;case"Line":c=new Vc(u(t.geometry),h(t.material));break;case"LineLoop":c=new DR(u(t.geometry),h(t.material));break;case"LineSegments":c=new il(u(t.geometry),h(t.material));break;case"PointCloud":case"Points":c=new BR(u(t.geometry),h(t.material));break;case"Sprite":c=new LR(h(t.material));break;case"Group":c=new Qf;break;case"Bone":c=new U_;break;default:c=new or}if(c.uuid=t.uuid,t.name!==void 0&&(c.name=t.name),t.matrix!==void 0?(c.matrix.fromArray(t.matrix),t.matrixAutoUpdate!==void 0&&(c.matrixAutoUpdate=t.matrixAutoUpdate),c.matrixAutoUpdate&&c.matrix.decompose(c.position,c.quaternion,c.scale)):(t.position!==void 0&&c.position.fromArray(t.position),t.rotation!==void 0&&c.rotation.fromArray(t.rotation),t.quaternion!==void 0&&c.quaternion.fromArray(t.quaternion),t.scale!==void 0&&c.scale.fromArray(t.scale)),t.castShadow!==void 0&&(c.castShadow=t.castShadow),t.receiveShadow!==void 0&&(c.receiveShadow=t.receiveShadow),t.shadow&&(t.shadow.bias!==void 0&&(c.shadow.bias=t.shadow.bias),t.shadow.normalBias!==void 0&&(c.shadow.normalBias=t.shadow.normalBias),t.shadow.radius!==void 0&&(c.shadow.radius=t.shadow.radius),t.shadow.mapSize!==void 0&&c.shadow.mapSize.fromArray(t.shadow.mapSize),t.shadow.camera!==void 0&&(c.shadow.camera=this.parseObject(t.shadow.camera))),t.visible!==void 0&&(c.visible=t.visible),t.frustumCulled!==void 0&&(c.frustumCulled=t.frustumCulled),t.renderOrder!==void 0&&(c.renderOrder=t.renderOrder),t.userData!==void 0&&(c.userData=t.userData),t.layers!==void 0&&(c.layers.mask=t.layers),t.children!==void 0){const y=t.children;for(let g=0;g<y.length;g++)c.add(this.parseObject(y[g],n,i,o,s))}if(t.animations!==void 0){const y=t.animations;for(let g=0;g<y.length;g++){const _=y[g];c.animations.push(s[_])}}if(t.type==="LOD"){t.autoUpdate!==void 0&&(c.autoUpdate=t.autoUpdate);const y=t.levels;for(let g=0;g<y.length;g++){const _=y[g],x=c.getObjectByProperty("uuid",_.object);x!==void 0&&c.addLevel(x,_.distance)}}return c}bindSkeletons(t,n){Object.keys(n).length!==0&&t.traverse(function(i){if(i.isSkinnedMesh===!0&&i.skeleton!==void 0){const o=n[i.skeleton];o===void 0?console.warn("THREE.ObjectLoader: No skeleton found with UUID:",i.skeleton):i.bind(o,i.bindMatrix)}})}setTexturePath(t){return console.warn("THREE.ObjectLoader: .setTexturePath() has been renamed to .setResourcePath()."),this.setResourcePath(t)}}const SG={UVMapping:uy,CubeReflectionMapping:kc,CubeRefractionMapping:zc,EquirectangularReflectionMapping:dm,EquirectangularRefractionMapping:pm,CubeUVReflectionMapping:Fd},l3={RepeatWrapping:mm,ClampToEdgeWrapping:Qs,MirroredRepeatWrapping:gm},c3={NearestFilter:Qr,NearestMipmapNearestFilter:Bv,NearestMipmapLinearFilter:Fv,LinearFilter:Vr,LinearMipmapNearestFilter:T_,LinearMipmapLinearFilter:_h};class TG extends Po{constructor(t){super(t),this.isImageBitmapLoader=!0,typeof createImageBitmap=="undefined"&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),typeof fetch=="undefined"&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.options={premultiplyAlpha:"none"}}setOptions(t){return this.options=t,this}load(t,n,i,o){t===void 0&&(t=""),this.path!==void 0&&(t=this.path+t),t=this.manager.resolveURL(t);const s=this,c=xh.get(t);if(c!==void 0)return s.manager.itemStart(t),setTimeout(function(){n&&n(c),s.manager.itemEnd(t)},0),c;const u={};u.credentials=this.crossOrigin==="anonymous"?"same-origin":"include",u.headers=this.requestHeader,fetch(t,u).then(function(h){return h.blob()}).then(function(h){return createImageBitmap(h,Object.assign(s.options,{colorSpaceConversion:"none"}))}).then(function(h){xh.add(t,h),n&&n(h),s.manager.itemEnd(t)}).catch(function(h){o&&o(h),s.manager.itemError(t),s.manager.itemEnd(t)}),s.manager.itemStart(t)}}let Jg;const K_={getContext:function(){return Jg===void 0&&(Jg=new(window.AudioContext||window.webkitAudioContext)),Jg},setContext:function(a){Jg=a}};class CG extends Po{constructor(t){super(t)}load(t,n,i,o){const s=this,c=new Hl(this.manager);c.setResponseType("arraybuffer"),c.setPath(this.path),c.setRequestHeader(this.requestHeader),c.setWithCredentials(this.withCredentials),c.load(t,function(u){try{const h=u.slice(0);K_.getContext().decodeAudioData(h,function(p){n(p)})}catch(h){o?o(h):console.error(h),s.manager.itemError(t)}},i,o)}}class RG extends My{constructor(t,n,i=1){super(void 0,i),this.isHemisphereLightProbe=!0;const o=new qn().set(t),s=new qn().set(n),c=new Ze(o.r,o.g,o.b),u=new Ze(s.r,s.g,s.b),h=Math.sqrt(Math.PI),f=h*Math.sqrt(.75);this.sh.coefficients[0].copy(c).add(u).multiplyScalar(h),this.sh.coefficients[1].copy(c).sub(u).multiplyScalar(f)}}class LG extends My{constructor(t,n=1){super(void 0,n),this.isAmbientLightProbe=!0;const i=new qn().set(t);this.sh.coefficients[0].set(i.r,i.g,i.b).multiplyScalar(2*Math.sqrt(Math.PI))}}const u3=new Oi,h3=new Oi,Fu=new Oi;class PG{constructor(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Es,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Es,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1,this._cache={focus:null,fov:null,aspect:null,near:null,far:null,zoom:null,eyeSep:null}}update(t){const n=this._cache;if(n.focus!==t.focus||n.fov!==t.fov||n.aspect!==t.aspect*this.aspect||n.near!==t.near||n.far!==t.far||n.zoom!==t.zoom||n.eyeSep!==this.eyeSep){n.focus=t.focus,n.fov=t.fov,n.aspect=t.aspect*this.aspect,n.near=t.near,n.far=t.far,n.zoom=t.zoom,n.eyeSep=this.eyeSep,Fu.copy(t.projectionMatrix);const o=n.eyeSep/2,s=o*n.near/n.focus,c=n.near*Math.tan(oh*n.fov*.5)/n.zoom;let u,h;h3.elements[12]=-o,u3.elements[12]=o,u=-c*n.aspect+s,h=c*n.aspect+s,Fu.elements[0]=2*n.near/(h-u),Fu.elements[8]=(h+u)/(h-u),this.cameraL.projectionMatrix.copy(Fu),u=-c*n.aspect-s,h=c*n.aspect-s,Fu.elements[0]=2*n.near/(h-u),Fu.elements[8]=(h+u)/(h-u),this.cameraR.projectionMatrix.copy(Fu)}this.cameraL.matrixWorld.copy(t.matrixWorld).multiply(h3),this.cameraR.matrixWorld.copy(t.matrixWorld).multiply(u3)}}class gL{constructor(t=!0){this.autoStart=t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}start(){this.startTime=f3(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0}stop(){this.getElapsedTime(),this.running=!1,this.autoStart=!1}getElapsedTime(){return this.getDelta(),this.elapsedTime}getDelta(){let t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){const n=f3();t=(n-this.oldTime)/1e3,this.oldTime=n,this.elapsedTime+=t}return t}}function f3(){return(typeof performance=="undefined"?Date:performance).now()}const Nu=new Ze,d3=new ao,IG=new Ze,Uu=new Ze;class OG extends or{constructor(){super(),this.type="AudioListener",this.context=K_.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null,this.timeDelta=0,this._clock=new gL}getInput(){return this.gain}removeFilter(){return this.filter!==null&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null),this}getFilter(){return this.filter}setFilter(t){return this.filter!==null?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination),this}getMasterVolume(){return this.gain.gain.value}setMasterVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}updateMatrixWorld(t){super.updateMatrixWorld(t);const n=this.context.listener,i=this.up;if(this.timeDelta=this._clock.getDelta(),this.matrixWorld.decompose(Nu,d3,IG),Uu.set(0,0,-1).applyQuaternion(d3),n.positionX){const o=this.context.currentTime+this.timeDelta;n.positionX.linearRampToValueAtTime(Nu.x,o),n.positionY.linearRampToValueAtTime(Nu.y,o),n.positionZ.linearRampToValueAtTime(Nu.z,o),n.forwardX.linearRampToValueAtTime(Uu.x,o),n.forwardY.linearRampToValueAtTime(Uu.y,o),n.forwardZ.linearRampToValueAtTime(Uu.z,o),n.upX.linearRampToValueAtTime(i.x,o),n.upY.linearRampToValueAtTime(i.y,o),n.upZ.linearRampToValueAtTime(i.z,o)}else n.setPosition(Nu.x,Nu.y,Nu.z),n.setOrientation(Uu.x,Uu.y,Uu.z,i.x,i.y,i.z)}}class vL extends or{constructor(t){super(),this.type="Audio",this.listener=t,this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.detune=0,this.loop=!1,this.loopStart=0,this.loopEnd=0,this.offset=0,this.duration=void 0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.source=null,this.sourceType="empty",this._startedAt=0,this._progress=0,this._connected=!1,this.filters=[]}getOutput(){return this.gain}setNodeSource(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this}setMediaElementSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaNode",this.source=this.context.createMediaElementSource(t),this.connect(),this}setMediaStreamSource(t){return this.hasPlaybackControl=!1,this.sourceType="mediaStreamNode",this.source=this.context.createMediaStreamSource(t),this.connect(),this}setBuffer(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this}play(t=0){if(this.isPlaying===!0){console.warn("THREE.Audio: Audio is already playing.");return}if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}this._startedAt=this.context.currentTime+t;const n=this.context.createBufferSource();return n.buffer=this.buffer,n.loop=this.loop,n.loopStart=this.loopStart,n.loopEnd=this.loopEnd,n.onended=this.onEnded.bind(this),n.start(this._startedAt,this._progress+this.offset,this.duration),this.isPlaying=!0,this.source=n,this.setDetune(this.detune),this.setPlaybackRate(this.playbackRate),this.connect()}pause(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.isPlaying===!0&&(this._progress+=Math.max(this.context.currentTime-this._startedAt,0)*this.playbackRate,this.loop===!0&&(this._progress=this._progress%(this.duration||this.buffer.duration)),this.source.stop(),this.source.onended=null,this.isPlaying=!1),this}stop(){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this._progress=0,this.source.stop(),this.source.onended=null,this.isPlaying=!1,this}connect(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(let t=1,n=this.filters.length;t<n;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this._connected=!0,this}disconnect(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(let t=1,n=this.filters.length;t<n;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this._connected=!1,this}getFilters(){return this.filters}setFilters(t){return t||(t=[]),this._connected===!0?(this.disconnect(),this.filters=t.slice(),this.connect()):this.filters=t.slice(),this}setDetune(t){if(this.detune=t,this.source.detune!==void 0)return this.isPlaying===!0&&this.source.detune.setTargetAtTime(this.detune,this.context.currentTime,.01),this}getDetune(){return this.detune}getFilter(){return this.getFilters()[0]}setFilter(t){return this.setFilters(t?[t]:[])}setPlaybackRate(t){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.playbackRate=t,this.isPlaying===!0&&this.source.playbackRate.setTargetAtTime(this.playbackRate,this.context.currentTime,.01),this}getPlaybackRate(){return this.playbackRate}onEnded(){this.isPlaying=!1}getLoop(){return this.hasPlaybackControl===!1?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop}setLoop(t){if(this.hasPlaybackControl===!1){console.warn("THREE.Audio: this Audio has no playback control.");return}return this.loop=t,this.isPlaying===!0&&(this.source.loop=this.loop),this}setLoopStart(t){return this.loopStart=t,this}setLoopEnd(t){return this.loopEnd=t,this}getVolume(){return this.gain.gain.value}setVolume(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}}const ku=new Ze,p3=new ao,DG=new Ze,zu=new Ze;class BG extends vL{constructor(t){super(t),this.panner=this.context.createPanner(),this.panner.panningModel="HRTF",this.panner.connect(this.gain)}disconnect(){super.disconnect(),this.panner.disconnect(this.gain)}getOutput(){return this.panner}getRefDistance(){return this.panner.refDistance}setRefDistance(t){return this.panner.refDistance=t,this}getRolloffFactor(){return this.panner.rolloffFactor}setRolloffFactor(t){return this.panner.rolloffFactor=t,this}getDistanceModel(){return this.panner.distanceModel}setDistanceModel(t){return this.panner.distanceModel=t,this}getMaxDistance(){return this.panner.maxDistance}setMaxDistance(t){return this.panner.maxDistance=t,this}setDirectionalCone(t,n,i){return this.panner.coneInnerAngle=t,this.panner.coneOuterAngle=n,this.panner.coneOuterGain=i,this}updateMatrixWorld(t){if(super.updateMatrixWorld(t),this.hasPlaybackControl===!0&&this.isPlaying===!1)return;this.matrixWorld.decompose(ku,p3,DG),zu.set(0,0,1).applyQuaternion(p3);const n=this.panner;if(n.positionX){const i=this.context.currentTime+this.listener.timeDelta;n.positionX.linearRampToValueAtTime(ku.x,i),n.positionY.linearRampToValueAtTime(ku.y,i),n.positionZ.linearRampToValueAtTime(ku.z,i),n.orientationX.linearRampToValueAtTime(zu.x,i),n.orientationY.linearRampToValueAtTime(zu.y,i),n.orientationZ.linearRampToValueAtTime(zu.z,i)}else n.setPosition(ku.x,ku.y,ku.z),n.setOrientation(zu.x,zu.y,zu.z)}}class FG{constructor(t,n=2048){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=n,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}getFrequencyData(){return this.analyser.getByteFrequencyData(this.data),this.data}getAverageFrequency(){let t=0;const n=this.getFrequencyData();for(let i=0;i<n.length;i++)t+=n[i];return t/n.length}}class yL{constructor(t,n,i){this.binding=t,this.valueSize=i;let o,s,c;switch(n){case"quaternion":o=this._slerp,s=this._slerpAdditive,c=this._setAdditiveIdentityQuaternion,this.buffer=new Float64Array(i*6),this._workIndex=5;break;case"string":case"bool":o=this._select,s=this._select,c=this._setAdditiveIdentityOther,this.buffer=new Array(i*5);break;default:o=this._lerp,s=this._lerpAdditive,c=this._setAdditiveIdentityNumeric,this.buffer=new Float64Array(i*5)}this._mixBufferRegion=o,this._mixBufferRegionAdditive=s,this._setIdentity=c,this._origIndex=3,this._addIndex=4,this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,this.useCount=0,this.referenceCount=0}accumulate(t,n){const i=this.buffer,o=this.valueSize,s=t*o+o;let c=this.cumulativeWeight;if(c===0){for(let u=0;u!==o;++u)i[s+u]=i[u];c=n}else{c+=n;const u=n/c;this._mixBufferRegion(i,s,0,u,o)}this.cumulativeWeight=c}accumulateAdditive(t){const n=this.buffer,i=this.valueSize,o=i*this._addIndex;this.cumulativeWeightAdditive===0&&this._setIdentity(),this._mixBufferRegionAdditive(n,o,0,t,i),this.cumulativeWeightAdditive+=t}apply(t){const n=this.valueSize,i=this.buffer,o=t*n+n,s=this.cumulativeWeight,c=this.cumulativeWeightAdditive,u=this.binding;if(this.cumulativeWeight=0,this.cumulativeWeightAdditive=0,s<1){const h=n*this._origIndex;this._mixBufferRegion(i,o,h,1-s,n)}c>0&&this._mixBufferRegionAdditive(i,o,this._addIndex*n,1,n);for(let h=n,f=n+n;h!==f;++h)if(i[h]!==i[h+n]){u.setValue(i,o);break}}saveOriginalState(){const t=this.binding,n=this.buffer,i=this.valueSize,o=i*this._origIndex;t.getValue(n,o);for(let s=i,c=o;s!==c;++s)n[s]=n[o+s%i];this._setIdentity(),this.cumulativeWeight=0,this.cumulativeWeightAdditive=0}restoreOriginalState(){const t=this.valueSize*3;this.binding.setValue(this.buffer,t)}_setAdditiveIdentityNumeric(){const t=this._addIndex*this.valueSize,n=t+this.valueSize;for(let i=t;i<n;i++)this.buffer[i]=0}_setAdditiveIdentityQuaternion(){this._setAdditiveIdentityNumeric(),this.buffer[this._addIndex*this.valueSize+3]=1}_setAdditiveIdentityOther(){const t=this._origIndex*this.valueSize,n=this._addIndex*this.valueSize;for(let i=0;i<this.valueSize;i++)this.buffer[n+i]=this.buffer[t+i]}_select(t,n,i,o,s){if(o>=.5)for(let c=0;c!==s;++c)t[n+c]=t[i+c]}_slerp(t,n,i,o){ao.slerpFlat(t,n,t,n,t,i,o)}_slerpAdditive(t,n,i,o,s){const c=this._workIndex*s;ao.multiplyQuaternionsFlat(t,c,t,n,t,i),ao.slerpFlat(t,n,t,n,t,c,o)}_lerp(t,n,i,o,s){const c=1-o;for(let u=0;u!==s;++u){const h=n+u;t[h]=t[h]*c+t[i+u]*o}}_lerpAdditive(t,n,i,o,s){for(let c=0;c!==s;++c){const u=n+c;t[u]=t[u]+t[i+c]*o}}}const Z_="\\[\\]\\.:\\/",NG=new RegExp("["+Z_+"]","g"),J_="[^"+Z_+"]",UG="[^"+Z_.replace("\\.","")+"]",kG=/((?:WC+[\/:])*)/.source.replace("WC",J_),zG=/(WCOD+)?/.source.replace("WCOD",UG),HG=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",J_),GG=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",J_),VG=new RegExp("^"+kG+zG+HG+GG+"$"),WG=["material","materials","bones"];class jG{constructor(t,n,i){const o=i||qi.parseTrackName(n);this._targetGroup=t,this._bindings=t.subscribe_(n,o)}getValue(t,n){this.bind();const i=this._targetGroup.nCachedObjects_,o=this._bindings[i];o!==void 0&&o.getValue(t,n)}setValue(t,n){const i=this._bindings;for(let o=this._targetGroup.nCachedObjects_,s=i.length;o!==s;++o)i[o].setValue(t,n)}bind(){const t=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=t.length;n!==i;++n)t[n].bind()}unbind(){const t=this._bindings;for(let n=this._targetGroup.nCachedObjects_,i=t.length;n!==i;++n)t[n].unbind()}}class qi{constructor(t,n,i){this.path=n,this.parsedPath=i||qi.parseTrackName(n),this.node=qi.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}static create(t,n,i){return t&&t.isAnimationObjectGroup?new qi.Composite(t,n,i):new qi(t,n,i)}static sanitizeNodeName(t){return t.replace(/\s/g,"_").replace(NG,"")}static parseTrackName(t){const n=VG.exec(t);if(n===null)throw new Error("PropertyBinding: Cannot parse trackName: "+t);const i={nodeName:n[2],objectName:n[3],objectIndex:n[4],propertyName:n[5],propertyIndex:n[6]},o=i.nodeName&&i.nodeName.lastIndexOf(".");if(o!==void 0&&o!==-1){const s=i.nodeName.substring(o+1);WG.indexOf(s)!==-1&&(i.nodeName=i.nodeName.substring(0,o),i.objectName=s)}if(i.propertyName===null||i.propertyName.length===0)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return i}static findNode(t,n){if(n===void 0||n===""||n==="."||n===-1||n===t.name||n===t.uuid)return t;if(t.skeleton){const i=t.skeleton.getBoneByName(n);if(i!==void 0)return i}if(t.children){const i=function(s){for(let c=0;c<s.length;c++){const u=s[c];if(u.name===n||u.uuid===n)return u;const h=i(u.children);if(h)return h}return null},o=i(t.children);if(o)return o}return null}_getValue_unavailable(){}_setValue_unavailable(){}_getValue_direct(t,n){t[n]=this.targetObject[this.propertyName]}_getValue_array(t,n){const i=this.resolvedProperty;for(let o=0,s=i.length;o!==s;++o)t[n++]=i[o]}_getValue_arrayElement(t,n){t[n]=this.resolvedProperty[this.propertyIndex]}_getValue_toArray(t,n){this.resolvedProperty.toArray(t,n)}_setValue_direct(t,n){this.targetObject[this.propertyName]=t[n]}_setValue_direct_setNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.needsUpdate=!0}_setValue_direct_setMatrixWorldNeedsUpdate(t,n){this.targetObject[this.propertyName]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_array(t,n){const i=this.resolvedProperty;for(let o=0,s=i.length;o!==s;++o)i[o]=t[n++]}_setValue_array_setNeedsUpdate(t,n){const i=this.resolvedProperty;for(let o=0,s=i.length;o!==s;++o)i[o]=t[n++];this.targetObject.needsUpdate=!0}_setValue_array_setMatrixWorldNeedsUpdate(t,n){const i=this.resolvedProperty;for(let o=0,s=i.length;o!==s;++o)i[o]=t[n++];this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_arrayElement(t,n){this.resolvedProperty[this.propertyIndex]=t[n]}_setValue_arrayElement_setNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.needsUpdate=!0}_setValue_arrayElement_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty[this.propertyIndex]=t[n],this.targetObject.matrixWorldNeedsUpdate=!0}_setValue_fromArray(t,n){this.resolvedProperty.fromArray(t,n)}_setValue_fromArray_setNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.needsUpdate=!0}_setValue_fromArray_setMatrixWorldNeedsUpdate(t,n){this.resolvedProperty.fromArray(t,n),this.targetObject.matrixWorldNeedsUpdate=!0}_getValue_unbound(t,n){this.bind(),this.getValue(t,n)}_setValue_unbound(t,n){this.bind(),this.setValue(t,n)}bind(){let t=this.node;const n=this.parsedPath,i=n.objectName,o=n.propertyName;let s=n.propertyIndex;if(t||(t=qi.findNode(this.rootNode,n.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t){console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");return}if(i){let f=n.objectIndex;switch(i){case"materials":if(!t.material){console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);return}if(!t.material.materials){console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);return}t=t.material.materials;break;case"bones":if(!t.skeleton){console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);return}t=t.skeleton.bones;for(let p=0;p<t.length;p++)if(t[p].name===f){f=p;break}break;default:if(t[i]===void 0){console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);return}t=t[i]}if(f!==void 0){if(t[f]===void 0){console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);return}t=t[f]}}const c=t[o];if(c===void 0){const f=n.nodeName;console.error("THREE.PropertyBinding: Trying to update property for track: "+f+"."+o+" but it wasn't found.",t);return}let u=this.Versioning.None;this.targetObject=t,t.needsUpdate!==void 0?u=this.Versioning.NeedsUpdate:t.matrixWorldNeedsUpdate!==void 0&&(u=this.Versioning.MatrixWorldNeedsUpdate);let h=this.BindingType.Direct;if(s!==void 0){if(o==="morphTargetInfluences"){if(!t.geometry){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);return}if(!t.geometry.morphAttributes){console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);return}t.morphTargetDictionary[s]!==void 0&&(s=t.morphTargetDictionary[s])}h=this.BindingType.ArrayElement,this.resolvedProperty=c,this.propertyIndex=s}else c.fromArray!==void 0&&c.toArray!==void 0?(h=this.BindingType.HasFromToArray,this.resolvedProperty=c):Array.isArray(c)?(h=this.BindingType.EntireArray,this.resolvedProperty=c):this.propertyName=o;this.getValue=this.GetterByBindingType[h],this.setValue=this.SetterByBindingTypeAndVersioning[h][u]}unbind(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}qi.Composite=jG;qi.prototype.BindingType={Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3};qi.prototype.Versioning={None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2};qi.prototype.GetterByBindingType=[qi.prototype._getValue_direct,qi.prototype._getValue_array,qi.prototype._getValue_arrayElement,qi.prototype._getValue_toArray];qi.prototype.SetterByBindingTypeAndVersioning=[[qi.prototype._setValue_direct,qi.prototype._setValue_direct_setNeedsUpdate,qi.prototype._setValue_direct_setMatrixWorldNeedsUpdate],[qi.prototype._setValue_array,qi.prototype._setValue_array_setNeedsUpdate,qi.prototype._setValue_array_setMatrixWorldNeedsUpdate],[qi.prototype._setValue_arrayElement,qi.prototype._setValue_arrayElement_setNeedsUpdate,qi.prototype._setValue_arrayElement_setMatrixWorldNeedsUpdate],[qi.prototype._setValue_fromArray,qi.prototype._setValue_fromArray_setNeedsUpdate,qi.prototype._setValue_fromArray_setMatrixWorldNeedsUpdate]];class XG{constructor(){this.isAnimationObjectGroup=!0,this.uuid=Co(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;const t={};this._indicesByUUID=t;for(let i=0,o=arguments.length;i!==o;++i)t[arguments[i].uuid]=i;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};const n=this;this.stats={objects:{get total(){return n._objects.length},get inUse(){return this.total-n.nCachedObjects_}},get bindingsPerObject(){return n._bindings.length}}}add(){const t=this._objects,n=this._indicesByUUID,i=this._paths,o=this._parsedPaths,s=this._bindings,c=s.length;let u,h=t.length,f=this.nCachedObjects_;for(let p=0,m=arguments.length;p!==m;++p){const y=arguments[p],g=y.uuid;let _=n[g];if(_===void 0){_=h++,n[g]=_,t.push(y);for(let x=0,b=c;x!==b;++x)s[x].push(new qi(y,i[x],o[x]))}else if(_<f){u=t[_];const x=--f,b=t[x];n[b.uuid]=_,t[_]=b,n[g]=x,t[x]=y;for(let E=0,T=c;E!==T;++E){const P=s[E],D=P[x];let F=P[_];P[_]=D,F===void 0&&(F=new qi(y,i[E],o[E])),P[x]=F}}else t[_]!==u&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=f}remove(){const t=this._objects,n=this._indicesByUUID,i=this._bindings,o=i.length;let s=this.nCachedObjects_;for(let c=0,u=arguments.length;c!==u;++c){const h=arguments[c],f=h.uuid,p=n[f];if(p!==void 0&&p>=s){const m=s++,y=t[m];n[y.uuid]=p,t[p]=y,n[f]=m,t[m]=h;for(let g=0,_=o;g!==_;++g){const x=i[g],b=x[m],E=x[p];x[p]=b,x[m]=E}}}this.nCachedObjects_=s}uncache(){const t=this._objects,n=this._indicesByUUID,i=this._bindings,o=i.length;let s=this.nCachedObjects_,c=t.length;for(let u=0,h=arguments.length;u!==h;++u){const f=arguments[u],p=f.uuid,m=n[p];if(m!==void 0)if(delete n[p],m<s){const y=--s,g=t[y],_=--c,x=t[_];n[g.uuid]=m,t[m]=g,n[x.uuid]=y,t[y]=x,t.pop();for(let b=0,E=o;b!==E;++b){const T=i[b],P=T[y],D=T[_];T[m]=P,T[y]=D,T.pop()}}else{const y=--c,g=t[y];y>0&&(n[g.uuid]=m),t[m]=g,t.pop();for(let _=0,x=o;_!==x;++_){const b=i[_];b[m]=b[y],b.pop()}}}this.nCachedObjects_=s}subscribe_(t,n){const i=this._bindingsIndicesByPath;let o=i[t];const s=this._bindings;if(o!==void 0)return s[o];const c=this._paths,u=this._parsedPaths,h=this._objects,f=h.length,p=this.nCachedObjects_,m=new Array(f);o=s.length,i[t]=o,c.push(t),u.push(n),s.push(m);for(let y=p,g=h.length;y!==g;++y){const _=h[y];m[y]=new qi(_,t,n)}return m}unsubscribe_(t){const n=this._bindingsIndicesByPath,i=n[t];if(i!==void 0){const o=this._paths,s=this._parsedPaths,c=this._bindings,u=c.length-1,h=c[u],f=t[u];n[f]=i,c[i]=h,c.pop(),s[i]=s[u],s.pop(),o[i]=o[u],o.pop()}}}class $G{constructor(t,n,i=null,o=n.blendMode){this._mixer=t,this._clip=n,this._localRoot=i,this.blendMode=o;const s=n.tracks,c=s.length,u=new Array(c),h={endingStart:Ku,endingEnd:Ku};for(let f=0;f!==c;++f){const p=s[f].createInterpolant(null);u[f]=p,p.settings=h}this._interpolantSettings=h,this._interpolants=u,this._propertyBindings=new Array(c),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=sR,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}play(){return this._mixer._activateAction(this),this}stop(){return this._mixer._deactivateAction(this),this.reset()}reset(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()}isRunning(){return this.enabled&&!this.paused&&this.timeScale!==0&&this._startTime===null&&this._mixer._isActiveAction(this)}isScheduled(){return this._mixer._isActiveAction(this)}startAt(t){return this._startTime=t,this}setLoop(t,n){return this.loop=t,this.repetitions=n,this}setEffectiveWeight(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()}getEffectiveWeight(){return this._effectiveWeight}fadeIn(t){return this._scheduleFading(t,0,1)}fadeOut(t){return this._scheduleFading(t,1,0)}crossFadeFrom(t,n,i){if(t.fadeOut(n),this.fadeIn(n),i){const o=this._clip.duration,s=t._clip.duration,c=s/o,u=o/s;t.warp(1,c,n),this.warp(u,1,n)}return this}crossFadeTo(t,n,i){return t.crossFadeFrom(this,n,i)}stopFading(){const t=this._weightInterpolant;return t!==null&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}setEffectiveTimeScale(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()}getEffectiveTimeScale(){return this._effectiveTimeScale}setDuration(t){return this.timeScale=this._clip.duration/t,this.stopWarping()}syncWith(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()}halt(t){return this.warp(this._effectiveTimeScale,0,t)}warp(t,n,i){const o=this._mixer,s=o.time,c=this.timeScale;let u=this._timeScaleInterpolant;u===null&&(u=o._lendControlInterpolant(),this._timeScaleInterpolant=u);const h=u.parameterPositions,f=u.sampleValues;return h[0]=s,h[1]=s+i,f[0]=t/c,f[1]=n/c,this}stopWarping(){const t=this._timeScaleInterpolant;return t!==null&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this}getMixer(){return this._mixer}getClip(){return this._clip}getRoot(){return this._localRoot||this._mixer._root}_update(t,n,i,o){if(!this.enabled){this._updateWeight(t);return}const s=this._startTime;if(s!==null){const h=(t-s)*i;if(h<0||i===0)return;this._startTime=null,n=i*h}n*=this._updateTimeScale(t);const c=this._updateTime(n),u=this._updateWeight(t);if(u>0){const h=this._interpolants,f=this._propertyBindings;switch(this.blendMode){case R_:for(let p=0,m=h.length;p!==m;++p)h[p].evaluate(c),f[p].accumulateAdditive(u);break;case hy:default:for(let p=0,m=h.length;p!==m;++p)h[p].evaluate(c),f[p].accumulate(o,u)}}}_updateWeight(t){let n=0;if(this.enabled){n=this.weight;const i=this._weightInterpolant;if(i!==null){const o=i.evaluate(t)[0];n*=o,t>i.parameterPositions[1]&&(this.stopFading(),o===0&&(this.enabled=!1))}}return this._effectiveWeight=n,n}_updateTimeScale(t){let n=0;if(!this.paused){n=this.timeScale;const i=this._timeScaleInterpolant;i!==null&&(n*=i.evaluate(t)[0],t>i.parameterPositions[1]&&(this.stopWarping(),n===0?this.paused=!0:this.timeScale=n))}return this._effectiveTimeScale=n,n}_updateTime(t){const n=this._clip.duration,i=this.loop;let o=this.time+t,s=this._loopCount;const c=i===oR;if(t===0)return s===-1?o:c&&(s&1)===1?n-o:o;if(i===rR){s===-1&&(this._loopCount=0,this._setEndings(!0,!0,!1));e:{if(o>=n)o=n;else if(o<0)o=0;else{this.time=o;break e}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this.time=o,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{if(s===-1&&(t>=0?(s=0,this._setEndings(!0,this.repetitions===0,c)):this._setEndings(this.repetitions===0,!0,c)),o>=n||o<0){const u=Math.floor(o/n);o-=n*u,s+=Math.abs(u);const h=this.repetitions-s;if(h<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,o=t>0?n:0,this.time=o,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(h===1){const f=t<0;this._setEndings(f,!f,c)}else this._setEndings(!1,!1,c);this._loopCount=s,this.time=o,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:u})}}else this.time=o;if(c&&(s&1)===1)return n-o}return o}_setEndings(t,n,i){const o=this._interpolantSettings;i?(o.endingStart=Zu,o.endingEnd=Zu):(t?o.endingStart=this.zeroSlopeAtStart?Zu:Ku:o.endingStart=xm,n?o.endingEnd=this.zeroSlopeAtEnd?Zu:Ku:o.endingEnd=xm)}_scheduleFading(t,n,i){const o=this._mixer,s=o.time;let c=this._weightInterpolant;c===null&&(c=o._lendControlInterpolant(),this._weightInterpolant=c);const u=c.parameterPositions,h=c.sampleValues;return u[0]=s,h[0]=n,u[1]=s+t,h[1]=i,this}}const qG=new Float32Array(1);class YG extends $c{constructor(t){super(),this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}_bindAction(t,n){const i=t._localRoot||this._root,o=t._clip.tracks,s=o.length,c=t._propertyBindings,u=t._interpolants,h=i.uuid,f=this._bindingsByRootAndName;let p=f[h];p===void 0&&(p={},f[h]=p);for(let m=0;m!==s;++m){const y=o[m],g=y.name;let _=p[g];if(_!==void 0)++_.referenceCount,c[m]=_;else{if(_=c[m],_!==void 0){_._cacheIndex===null&&(++_.referenceCount,this._addInactiveBinding(_,h,g));continue}const x=n&&n._propertyBindings[m].binding.parsedPath;_=new yL(qi.create(i,g,x),y.ValueTypeName,y.getValueSize()),++_.referenceCount,this._addInactiveBinding(_,h,g),c[m]=_}u[m].resultBuffer=_.buffer}}_activateAction(t){if(!this._isActiveAction(t)){if(t._cacheIndex===null){const i=(t._localRoot||this._root).uuid,o=t._clip.uuid,s=this._actionsByClip[o];this._bindAction(t,s&&s.knownActions[0]),this._addInactiveAction(t,o,i)}const n=t._propertyBindings;for(let i=0,o=n.length;i!==o;++i){const s=n[i];s.useCount++===0&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(t)}}_deactivateAction(t){if(this._isActiveAction(t)){const n=t._propertyBindings;for(let i=0,o=n.length;i!==o;++i){const s=n[i];--s.useCount===0&&(s.restoreOriginalState(),this._takeBackBinding(s))}this._takeBackAction(t)}}_initMemoryManager(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;const t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}}_isActiveAction(t){const n=t._cacheIndex;return n!==null&&n<this._nActiveActions}_addInactiveAction(t,n,i){const o=this._actions,s=this._actionsByClip;let c=s[n];if(c===void 0)c={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,s[n]=c;else{const u=c.knownActions;t._byClipCacheIndex=u.length,u.push(t)}t._cacheIndex=o.length,o.push(t),c.actionByRoot[i]=t}_removeInactiveAction(t){const n=this._actions,i=n[n.length-1],o=t._cacheIndex;i._cacheIndex=o,n[o]=i,n.pop(),t._cacheIndex=null;const s=t._clip.uuid,c=this._actionsByClip,u=c[s],h=u.knownActions,f=h[h.length-1],p=t._byClipCacheIndex;f._byClipCacheIndex=p,h[p]=f,h.pop(),t._byClipCacheIndex=null;const m=u.actionByRoot,y=(t._localRoot||this._root).uuid;delete m[y],h.length===0&&delete c[s],this._removeInactiveBindingsForAction(t)}_removeInactiveBindingsForAction(t){const n=t._propertyBindings;for(let i=0,o=n.length;i!==o;++i){const s=n[i];--s.referenceCount===0&&this._removeInactiveBinding(s)}}_lendAction(t){const n=this._actions,i=t._cacheIndex,o=this._nActiveActions++,s=n[o];t._cacheIndex=o,n[o]=t,s._cacheIndex=i,n[i]=s}_takeBackAction(t){const n=this._actions,i=t._cacheIndex,o=--this._nActiveActions,s=n[o];t._cacheIndex=o,n[o]=t,s._cacheIndex=i,n[i]=s}_addInactiveBinding(t,n,i){const o=this._bindingsByRootAndName,s=this._bindings;let c=o[n];c===void 0&&(c={},o[n]=c),c[i]=t,t._cacheIndex=s.length,s.push(t)}_removeInactiveBinding(t){const n=this._bindings,i=t.binding,o=i.rootNode.uuid,s=i.path,c=this._bindingsByRootAndName,u=c[o],h=n[n.length-1],f=t._cacheIndex;h._cacheIndex=f,n[f]=h,n.pop(),delete u[s],Object.keys(u).length===0&&delete c[o]}_lendBinding(t){const n=this._bindings,i=t._cacheIndex,o=this._nActiveBindings++,s=n[o];t._cacheIndex=o,n[o]=t,s._cacheIndex=i,n[i]=s}_takeBackBinding(t){const n=this._bindings,i=t._cacheIndex,o=--this._nActiveBindings,s=n[o];t._cacheIndex=o,n[o]=t,s._cacheIndex=i,n[i]=s}_lendControlInterpolant(){const t=this._controlInterpolants,n=this._nActiveControlInterpolants++;let i=t[n];return i===void 0&&(i=new $_(new Float32Array(2),new Float32Array(2),1,qG),i.__cacheIndex=n,t[n]=i),i}_takeBackControlInterpolant(t){const n=this._controlInterpolants,i=t.__cacheIndex,o=--this._nActiveControlInterpolants,s=n[o];t.__cacheIndex=o,n[o]=t,s.__cacheIndex=i,n[i]=s}clipAction(t,n,i){const o=n||this._root,s=o.uuid;let c=typeof t=="string"?Cm.findByName(o,t):t;const u=c!==null?c.uuid:t,h=this._actionsByClip[u];let f=null;if(i===void 0&&(c!==null?i=c.blendMode:i=hy),h!==void 0){const m=h.actionByRoot[s];if(m!==void 0&&m.blendMode===i)return m;f=h.knownActions[0],c===null&&(c=f._clip)}if(c===null)return null;const p=new $G(this,c,n,i);return this._bindAction(p,f),this._addInactiveAction(p,u,s),p}existingAction(t,n){const i=n||this._root,o=i.uuid,s=typeof t=="string"?Cm.findByName(i,t):t,c=s?s.uuid:t,u=this._actionsByClip[c];return u!==void 0&&u.actionByRoot[o]||null}stopAllAction(){const t=this._actions,n=this._nActiveActions;for(let i=n-1;i>=0;--i)t[i].stop();return this}update(t){t*=this.timeScale;const n=this._actions,i=this._nActiveActions,o=this.time+=t,s=Math.sign(t),c=this._accuIndex^=1;for(let f=0;f!==i;++f)n[f]._update(o,t,s,c);const u=this._bindings,h=this._nActiveBindings;for(let f=0;f!==h;++f)u[f].apply(c);return this}setTime(t){this.time=0;for(let n=0;n<this._actions.length;n++)this._actions[n].time=0;return this.update(t)}getRoot(){return this._root}uncacheClip(t){const n=this._actions,i=t.uuid,o=this._actionsByClip,s=o[i];if(s!==void 0){const c=s.knownActions;for(let u=0,h=c.length;u!==h;++u){const f=c[u];this._deactivateAction(f);const p=f._cacheIndex,m=n[n.length-1];f._cacheIndex=null,f._byClipCacheIndex=null,m._cacheIndex=p,n[p]=m,n.pop(),this._removeInactiveBindingsForAction(f)}delete o[i]}}uncacheRoot(t){const n=t.uuid,i=this._actionsByClip;for(const c in i){const u=i[c].actionByRoot,h=u[n];h!==void 0&&(this._deactivateAction(h),this._removeInactiveAction(h))}const o=this._bindingsByRootAndName,s=o[n];if(s!==void 0)for(const c in s){const u=s[c];u.restoreOriginalState(),this._removeInactiveBinding(u)}}uncacheAction(t,n){const i=this.existingAction(t,n);i!==null&&(this._deactivateAction(i),this._removeInactiveAction(i))}}class ew{constructor(t){typeof t=="string"&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}clone(){return new ew(this.value.clone===void 0?this.value:this.value.clone())}}class QG extends Ay{constructor(t,n,i=1){super(t,n),this.isInstancedInterleavedBuffer=!0,this.meshPerAttribute=i}copy(t){return super.copy(t),this.meshPerAttribute=t.meshPerAttribute,this}clone(t){const n=super.clone(t);return n.meshPerAttribute=this.meshPerAttribute,n}toJSON(t){const n=super.toJSON(t);return n.isInstancedInterleavedBuffer=!0,n.meshPerAttribute=this.meshPerAttribute,n}}class KG{constructor(t,n,i,o,s){this.isGLBufferAttribute=!0,this.buffer=t,this.type=n,this.itemSize=i,this.elementSize=o,this.count=s,this.version=0}set needsUpdate(t){t===!0&&this.version++}setBuffer(t){return this.buffer=t,this}setType(t,n){return this.type=t,this.elementSize=n,this}setItemSize(t){return this.itemSize=t,this}setCount(t){return this.count=t,this}}class ZG{constructor(t,n,i=0,o=1/0){this.ray=new Fm(t,n),this.near=i,this.far=o,this.camera=null,this.layers=new dy,this.params={Mesh:{},Line:{threshold:1},LOD:{},Points:{threshold:1},Sprite:{}}}set(t,n){this.ray.set(t,n)}setFromCamera(t,n){n.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(n.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(n).sub(this.ray.origin).normalize(),this.camera=n):n.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(n.near+n.far)/(n.near-n.far)).unproject(n),this.ray.direction.set(0,0,-1).transformDirection(n.matrixWorld),this.camera=n):console.error("THREE.Raycaster: Unsupported camera type: "+n.type)}intersectObject(t,n=!0,i=[]){return kb(t,this,i,n),i.sort(m3),i}intersectObjects(t,n=!0,i=[]){for(let o=0,s=t.length;o<s;o++)kb(t[o],this,i,n);return i.sort(m3),i}}function m3(a,t){return a.distance-t.distance}function kb(a,t,n,i){if(a.layers.test(t.layers)&&a.raycast(t,n),i===!0){const o=a.children;for(let s=0,c=o.length;s<c;s++)kb(o[s],t,n,!0)}}class JG{constructor(t=1,n=0,i=0){return this.radius=t,this.phi=n,this.theta=i,this}set(t,n,i){return this.radius=t,this.phi=n,this.theta=i,this}copy(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this}makeSafe(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,n,i){return this.radius=Math.sqrt(t*t+n*n+i*i),this.radius===0?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t,i),this.phi=Math.acos(Wr(n/this.radius,-1,1))),this}clone(){return new this.constructor().copy(this)}}class eV{constructor(t=1,n=0,i=0){return this.radius=t,this.theta=n,this.y=i,this}set(t,n,i){return this.radius=t,this.theta=n,this.y=i,this}copy(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this}setFromVector3(t){return this.setFromCartesianCoords(t.x,t.y,t.z)}setFromCartesianCoords(t,n,i){return this.radius=Math.sqrt(t*t+i*i),this.theta=Math.atan2(t,i),this.y=n,this}clone(){return new this.constructor().copy(this)}}const g3=new yn;class tV{constructor(t=new yn(1/0,1/0),n=new yn(-1/0,-1/0)){this.isBox2=!0,this.min=t,this.max=n}set(t,n){return this.min.copy(t),this.max.copy(n),this}setFromPoints(t){this.makeEmpty();for(let n=0,i=t.length;n<i;n++)this.expandByPoint(t[n]);return this}setFromCenterAndSize(t,n){const i=g3.copy(n).multiplyScalar(.5);return this.min.copy(t).sub(i),this.max.copy(t).add(i),this}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y}getCenter(t){return this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}containsPoint(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y}getParameter(t,n){return n.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))}intersectsBox(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)}clampPoint(t,n){return n.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return g3.copy(t).clamp(this.min,this.max).sub(t).length()}intersect(t){return this.min.max(t.min),this.max.min(t.max),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const v3=new Ze,ev=new Ze;class nV{constructor(t=new Ze,n=new Ze){this.start=t,this.end=n}set(t,n){return this.start.copy(t),this.end.copy(n),this}copy(t){return this.start.copy(t.start),this.end.copy(t.end),this}getCenter(t){return t.addVectors(this.start,this.end).multiplyScalar(.5)}delta(t){return t.subVectors(this.end,this.start)}distanceSq(){return this.start.distanceToSquared(this.end)}distance(){return this.start.distanceTo(this.end)}at(t,n){return this.delta(n).multiplyScalar(t).add(this.start)}closestPointToPointParameter(t,n){v3.subVectors(t,this.start),ev.subVectors(this.end,this.start);const i=ev.dot(ev);let s=ev.dot(v3)/i;return n&&(s=Wr(s,0,1)),s}closestPointToPoint(t,n,i){const o=this.closestPointToPointParameter(t,n);return this.delta(i).multiplyScalar(o).add(this.start)}applyMatrix4(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this}equals(t){return t.start.equals(this.start)&&t.end.equals(this.end)}clone(){return new this.constructor().copy(this)}}const y3=new Ze;class iV extends or{constructor(t,n){super(),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;const i=new Ii,o=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1];for(let c=0,u=1,h=32;c<h;c++,u++){const f=c/h*Math.PI*2,p=u/h*Math.PI*2;o.push(Math.cos(f),Math.sin(f),1,Math.cos(p),Math.sin(p),1)}i.setAttribute("position",new ni(o,3));const s=new io({fog:!1,toneMapped:!1});this.cone=new il(i,s),this.add(this.cone),this.update()}dispose(){this.cone.geometry.dispose(),this.cone.material.dispose()}update(){this.light.updateMatrixWorld();const t=this.light.distance?this.light.distance:1e3,n=t*Math.tan(this.light.angle);this.cone.scale.set(n,n,t),y3.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(y3),this.color!==void 0?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}const xc=new Ze,tv=new Oi,yA=new Oi;class rV extends il{constructor(t){const n=xL(t),i=new Ii,o=[],s=[],c=new qn(0,0,1),u=new qn(0,1,0);for(let f=0;f<n.length;f++){const p=n[f];p.parent&&p.parent.isBone&&(o.push(0,0,0),o.push(0,0,0),s.push(c.r,c.g,c.b),s.push(u.r,u.g,u.b))}i.setAttribute("position",new ni(o,3)),i.setAttribute("color",new ni(s,3));const h=new io({vertexColors:!0,depthTest:!1,depthWrite:!1,toneMapped:!1,transparent:!0});super(i,h),this.isSkeletonHelper=!0,this.type="SkeletonHelper",this.root=t,this.bones=n,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}updateMatrixWorld(t){const n=this.bones,i=this.geometry,o=i.getAttribute("position");yA.copy(this.root.matrixWorld).invert();for(let s=0,c=0;s<n.length;s++){const u=n[s];u.parent&&u.parent.isBone&&(tv.multiplyMatrices(yA,u.matrixWorld),xc.setFromMatrixPosition(tv),o.setXYZ(c,xc.x,xc.y,xc.z),tv.multiplyMatrices(yA,u.parent.matrixWorld),xc.setFromMatrixPosition(tv),o.setXYZ(c+1,xc.x,xc.y,xc.z),c+=2)}i.getAttribute("position").needsUpdate=!0,super.updateMatrixWorld(t)}}function xL(a){const t=[];a.isBone===!0&&t.push(a);for(let n=0;n<a.children.length;n++)t.push.apply(t,xL(a.children[n]));return t}class sV extends Ss{constructor(t,n,i){const o=new yh(n,4,2),s=new qc({wireframe:!0,fog:!1,toneMapped:!1});super(o,s),this.light=t,this.light.updateMatrixWorld(),this.color=i,this.type="PointLightHelper",this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}dispose(){this.geometry.dispose(),this.material.dispose()}update(){this.color!==void 0?this.material.color.set(this.color):this.material.color.copy(this.light.color)}}const oV=new Ze,x3=new qn,A3=new qn;class aV extends or{constructor(t,n,i){super(),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=i;const o=new vh(n);o.rotateY(Math.PI*.5),this.material=new qc({wireframe:!0,fog:!1,toneMapped:!1}),this.color===void 0&&(this.material.vertexColors=!0);const s=o.getAttribute("position"),c=new Float32Array(s.count*3);o.setAttribute("color",new mr(c,3)),this.add(new Ss(o,this.material)),this.update()}dispose(){this.children[0].geometry.dispose(),this.children[0].material.dispose()}update(){const t=this.children[0];if(this.color!==void 0)this.material.color.set(this.color);else{const n=t.geometry.getAttribute("color");x3.copy(this.light.color),A3.copy(this.light.groundColor);for(let i=0,o=n.count;i<o;i++){const s=i<o/2?x3:A3;n.setXYZ(i,s.r,s.g,s.b)}n.needsUpdate=!0}t.lookAt(oV.setFromMatrixPosition(this.light.matrixWorld).negate())}}class lV extends il{constructor(t=10,n=10,i=4473924,o=8947848){i=new qn(i),o=new qn(o);const s=n/2,c=t/n,u=t/2,h=[],f=[];for(let y=0,g=0,_=-u;y<=n;y++,_+=c){h.push(-u,0,_,u,0,_),h.push(_,0,-u,_,0,u);const x=y===s?i:o;x.toArray(f,g),g+=3,x.toArray(f,g),g+=3,x.toArray(f,g),g+=3,x.toArray(f,g),g+=3}const p=new Ii;p.setAttribute("position",new ni(h,3)),p.setAttribute("color",new ni(f,3));const m=new io({vertexColors:!0,toneMapped:!1});super(p,m),this.type="GridHelper"}}class cV extends il{constructor(t=10,n=16,i=8,o=64,s=4473924,c=8947848){s=new qn(s),c=new qn(c);const u=[],h=[];for(let m=0;m<=n;m++){const y=m/n*(Math.PI*2),g=Math.sin(y)*t,_=Math.cos(y)*t;u.push(0,0,0),u.push(g,0,_);const x=m&1?s:c;h.push(x.r,x.g,x.b),h.push(x.r,x.g,x.b)}for(let m=0;m<=i;m++){const y=m&1?s:c,g=t-t/i*m;for(let _=0;_<o;_++){let x=_/o*(Math.PI*2),b=Math.sin(x)*g,E=Math.cos(x)*g;u.push(b,0,E),h.push(y.r,y.g,y.b),x=(_+1)/o*(Math.PI*2),b=Math.sin(x)*g,E=Math.cos(x)*g,u.push(b,0,E),h.push(y.r,y.g,y.b)}}const f=new Ii;f.setAttribute("position",new ni(u,3)),f.setAttribute("color",new ni(h,3));const p=new io({vertexColors:!0,toneMapped:!1});super(f,p),this.type="PolarGridHelper"}}const b3=new Ze,nv=new Ze,_3=new Ze;class uV extends or{constructor(t,n,i){super(),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=i,n===void 0&&(n=1);let o=new Ii;o.setAttribute("position",new ni([-n,n,0,n,n,0,n,-n,0,-n,-n,0,-n,n,0],3));const s=new io({fog:!1,toneMapped:!1});this.lightPlane=new Vc(o,s),this.add(this.lightPlane),o=new Ii,o.setAttribute("position",new ni([0,0,0,0,0,1],3)),this.targetLine=new Vc(o,s),this.add(this.targetLine),this.update()}dispose(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()}update(){b3.setFromMatrixPosition(this.light.matrixWorld),nv.setFromMatrixPosition(this.light.target.matrixWorld),_3.subVectors(nv,b3),this.lightPlane.lookAt(nv),this.color!==void 0?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(nv),this.targetLine.scale.z=_3.length()}}const iv=new Ze,Or=new py;class hV extends il{constructor(t){const n=new Ii,i=new io({color:16777215,vertexColors:!0,toneMapped:!1}),o=[],s=[],c={},u=new qn(16755200),h=new qn(16711680),f=new qn(43775),p=new qn(16777215),m=new qn(3355443);y("n1","n2",u),y("n2","n4",u),y("n4","n3",u),y("n3","n1",u),y("f1","f2",u),y("f2","f4",u),y("f4","f3",u),y("f3","f1",u),y("n1","f1",u),y("n2","f2",u),y("n3","f3",u),y("n4","f4",u),y("p","n1",h),y("p","n2",h),y("p","n3",h),y("p","n4",h),y("u1","u2",f),y("u2","u3",f),y("u3","u1",f),y("c","t",p),y("p","c",m),y("cn1","cn2",m),y("cn3","cn4",m),y("cf1","cf2",m),y("cf3","cf4",m);function y(_,x,b){g(_,b),g(x,b)}function g(_,x){o.push(0,0,0),s.push(x.r,x.g,x.b),c[_]===void 0&&(c[_]=[]),c[_].push(o.length/3-1)}n.setAttribute("position",new ni(o,3)),n.setAttribute("color",new ni(s,3)),super(n,i),this.type="CameraHelper",this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=c,this.update()}update(){const t=this.geometry,n=this.pointMap,i=1,o=1;Or.projectionMatrixInverse.copy(this.camera.projectionMatrixInverse),Hr("c",n,t,Or,0,0,-1),Hr("t",n,t,Or,0,0,1),Hr("n1",n,t,Or,-i,-o,-1),Hr("n2",n,t,Or,i,-o,-1),Hr("n3",n,t,Or,-i,o,-1),Hr("n4",n,t,Or,i,o,-1),Hr("f1",n,t,Or,-i,-o,1),Hr("f2",n,t,Or,i,-o,1),Hr("f3",n,t,Or,-i,o,1),Hr("f4",n,t,Or,i,o,1),Hr("u1",n,t,Or,i*.7,o*1.1,-1),Hr("u2",n,t,Or,-i*.7,o*1.1,-1),Hr("u3",n,t,Or,0,o*2,-1),Hr("cf1",n,t,Or,-i,0,1),Hr("cf2",n,t,Or,i,0,1),Hr("cf3",n,t,Or,0,-o,1),Hr("cf4",n,t,Or,0,o,1),Hr("cn1",n,t,Or,-i,0,-1),Hr("cn2",n,t,Or,i,0,-1),Hr("cn3",n,t,Or,0,-o,-1),Hr("cn4",n,t,Or,0,o,-1),t.getAttribute("position").needsUpdate=!0}dispose(){this.geometry.dispose(),this.material.dispose()}}function Hr(a,t,n,i,o,s,c){iv.set(o,s,c).unproject(i);const u=t[a];if(u!==void 0){const h=n.getAttribute("position");for(let f=0,p=u.length;f<p;f++)h.setXYZ(u[f],iv.x,iv.y,iv.z)}}const rv=new Eh;class fV extends il{constructor(t,n=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),o=new Float32Array(8*3),s=new Ii;s.setIndex(new mr(i,1)),s.setAttribute("position",new mr(o,3)),super(s,new io({color:n,toneMapped:!1})),this.object=t,this.type="BoxHelper",this.matrixAutoUpdate=!1,this.update()}update(t){if(t!==void 0&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),this.object!==void 0&&rv.setFromObject(this.object),rv.isEmpty())return;const n=rv.min,i=rv.max,o=this.geometry.attributes.position,s=o.array;s[0]=i.x,s[1]=i.y,s[2]=i.z,s[3]=n.x,s[4]=i.y,s[5]=i.z,s[6]=n.x,s[7]=n.y,s[8]=i.z,s[9]=i.x,s[10]=n.y,s[11]=i.z,s[12]=i.x,s[13]=i.y,s[14]=n.z,s[15]=n.x,s[16]=i.y,s[17]=n.z,s[18]=n.x,s[19]=n.y,s[20]=n.z,s[21]=i.x,s[22]=n.y,s[23]=n.z,o.needsUpdate=!0,this.geometry.computeBoundingSphere()}setFromObject(t){return this.object=t,this.update(),this}copy(t,n){return super.copy(t,n),this.object=t.object,this}}class dV extends il{constructor(t,n=16776960){const i=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),o=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],s=new Ii;s.setIndex(new mr(i,1)),s.setAttribute("position",new ni(o,3)),super(s,new io({color:n,toneMapped:!1})),this.box=t,this.type="Box3Helper",this.geometry.computeBoundingSphere()}updateMatrixWorld(t){const n=this.box;n.isEmpty()||(n.getCenter(this.position),n.getSize(this.scale),this.scale.multiplyScalar(.5),super.updateMatrixWorld(t))}}class pV extends Vc{constructor(t,n=1,i=16776960){const o=i,s=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],c=new Ii;c.setAttribute("position",new ni(s,3)),c.computeBoundingSphere(),super(c,new io({color:o,toneMapped:!1})),this.type="PlaneHelper",this.plane=t,this.size=n;const u=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],h=new Ii;h.setAttribute("position",new ni(u,3)),h.computeBoundingSphere(),this.add(new Ss(h,new qc({color:o,opacity:.2,transparent:!0,depthWrite:!1,toneMapped:!1})))}updateMatrixWorld(t){let n=-this.plane.constant;Math.abs(n)<1e-8&&(n=1e-8),this.scale.set(.5*this.size,.5*this.size,n),this.children[0].material.side=n<0?To:hh,this.lookAt(this.plane.normal),super.updateMatrixWorld(t)}}const w3=new Ze;let sv,xA;class mV extends or{constructor(t=new Ze(0,0,1),n=new Ze(0,0,0),i=1,o=16776960,s=i*.2,c=s*.2){super(),this.type="ArrowHelper",sv===void 0&&(sv=new Ii,sv.setAttribute("position",new ni([0,0,0,0,1,0],3)),xA=new Wc(0,.5,1,5,1),xA.translate(0,-.5,0)),this.position.copy(n),this.line=new Vc(sv,new io({color:o,toneMapped:!1})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new Ss(xA,new qc({color:o,toneMapped:!1})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(i,s,c)}setDirection(t){if(t.y>.99999)this.quaternion.set(0,0,0,1);else if(t.y<-.99999)this.quaternion.set(1,0,0,0);else{w3.set(t.z,0,-t.x).normalize();const n=Math.acos(t.y);this.quaternion.setFromAxisAngle(w3,n)}}setLength(t,n=t*.2,i=n*.2){this.line.scale.set(1,Math.max(1e-4,t-n),1),this.line.updateMatrix(),this.cone.scale.set(i,n,i),this.cone.position.y=t,this.cone.updateMatrix()}setColor(t){this.line.material.color.set(t),this.cone.material.color.set(t)}copy(t){return super.copy(t,!1),this.line.copy(t.line),this.cone.copy(t.cone),this}}class gV extends il{constructor(t=1){const n=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],i=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],o=new Ii;o.setAttribute("position",new ni(n,3)),o.setAttribute("color",new ni(i,3));const s=new io({vertexColors:!0,toneMapped:!1});super(o,s),this.type="AxesHelper"}setColors(t,n,i){const o=new qn,s=this.geometry.attributes.color.array;return o.set(t),o.toArray(s,0),o.toArray(s,3),o.set(n),o.toArray(s,6),o.toArray(s,9),o.set(i),o.toArray(s,12),o.toArray(s,15),this.geometry.attributes.color.needsUpdate=!0,this}dispose(){this.geometry.dispose(),this.material.dispose()}}class vV{constructor(){this.type="ShapePath",this.color=new qn,this.subPaths=[],this.currentPath=null}moveTo(t,n){return this.currentPath=new _m,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,n),this}lineTo(t,n){return this.currentPath.lineTo(t,n),this}quadraticCurveTo(t,n,i,o){return this.currentPath.quadraticCurveTo(t,n,i,o),this}bezierCurveTo(t,n,i,o,s,c){return this.currentPath.bezierCurveTo(t,n,i,o,s,c),this}splineThru(t){return this.currentPath.splineThru(t),this}toShapes(t,n){function i(T){const P=[];for(let D=0,F=T.length;D<F;D++){const k=T[D],W=new lh;W.curves=k.curves,P.push(W)}return P}function o(T,P){const D=P.length;let F=!1;for(let k=D-1,W=0;W<D;k=W++){let j=P[k],J=P[W],de=J.x-j.x,te=J.y-j.y;if(Math.abs(te)>Number.EPSILON){if(te<0&&(j=P[W],de=-de,J=P[k],te=-te),T.y<j.y||T.y>J.y)continue;if(T.y===j.y){if(T.x===j.x)return!0}else{const N=te*(T.x-j.x)-de*(T.y-j.y);if(N===0)return!0;if(N<0)continue;F=!F}}else{if(T.y!==j.y)continue;if(J.x<=T.x&&T.x<=j.x||j.x<=T.x&&T.x<=J.x)return!0}}return F}const s=Ha.isClockWise,c=this.subPaths;if(c.length===0)return[];if(n===!0)return i(c);let u,h,f;const p=[];if(c.length===1)return h=c[0],f=new lh,f.curves=h.curves,p.push(f),p;let m=!s(c[0].getPoints());m=t?!m:m;const y=[],g=[];let _=[],x=0,b;g[x]=void 0,_[x]=[];for(let T=0,P=c.length;T<P;T++)h=c[T],b=h.getPoints(),u=s(b),u=t?!u:u,u?(!m&&g[x]&&x++,g[x]={s:new lh,p:b},g[x].s.curves=h.curves,m&&x++,_[x]=[]):_[x].push({h,p:b[0]});if(!g[0])return i(c);if(g.length>1){let T=!1,P=0;for(let D=0,F=g.length;D<F;D++)y[D]=[];for(let D=0,F=g.length;D<F;D++){const k=_[D];for(let W=0;W<k.length;W++){const j=k[W];let J=!0;for(let de=0;de<g.length;de++)o(j.p,g[de].p)&&(D!==de&&P++,J?(J=!1,y[de].push(j)):T=!0);J&&y[D].push(j)}}P>0&&T===!1&&(_=y)}let E;for(let T=0,P=g.length;T<P;T++){f=g[T].s,p.push(f),E=_[T];for(let D=0,F=E.length;D<F;D++)f.holes.push(E[D].h)}return p}}class yV{static toHalfFloat(t){Math.abs(t)>65504&&console.warn("THREE.DataUtils.toHalfFloat(): Value out of range."),t=Wr(t,-65504,65504),E3[0]=t;const n=M3[0],i=n>>23&511;return sa[i]+((n&8388607)>>oa[i])}static fromHalfFloat(t){const n=t>>10;return M3[0]=tw[bL[n]+(t&1023)]+zd[n],E3[0]}}const AL=new ArrayBuffer(4),E3=new Float32Array(AL),M3=new Uint32Array(AL),sa=new Uint32Array(512),oa=new Uint32Array(512);for(let a=0;a<256;++a){const t=a-127;t<-27?(sa[a]=0,sa[a|256]=32768,oa[a]=24,oa[a|256]=24):t<-14?(sa[a]=1024>>-t-14,sa[a|256]=1024>>-t-14|32768,oa[a]=-t-1,oa[a|256]=-t-1):t<=15?(sa[a]=t+15<<10,sa[a|256]=t+15<<10|32768,oa[a]=13,oa[a|256]=13):t<128?(sa[a]=31744,sa[a|256]=64512,oa[a]=24,oa[a|256]=24):(sa[a]=31744,sa[a|256]=64512,oa[a]=13,oa[a|256]=13)}const tw=new Uint32Array(2048),zd=new Uint32Array(64),bL=new Uint32Array(64);for(let a=1;a<1024;++a){let t=a<<13,n=0;for(;(t&8388608)===0;)t<<=1,n-=8388608;t&=-8388609,n+=947912704,tw[a]=t|n}for(let a=1024;a<2048;++a)tw[a]=939524096+(a-1024<<13);for(let a=1;a<31;++a)zd[a]=a<<23;zd[31]=1199570944;zd[32]=2147483648;for(let a=33;a<63;++a)zd[a]=2147483648+(a-32<<23);zd[63]=3347054592;for(let a=1;a<64;++a)a!==32&&(bL[a]=1024);class xV extends Ii{constructor(){console.error("THREE.ParametricGeometry has been moved to /examples/jsm/geometries/ParametricGeometry.js"),super()}}class AV extends Ii{constructor(){console.error("THREE.TextGeometry has been moved to /examples/jsm/geometries/TextGeometry.js"),super()}}function bV(){console.error("THREE.FontLoader has been moved to /examples/jsm/loaders/FontLoader.js")}function _V(){console.error("THREE.Font has been moved to /examples/jsm/loaders/FontLoader.js")}function wV(){console.error("THREE.ImmediateRenderObject has been removed.")}class EV extends Ro{constructor(t,n,i){console.error('THREE.WebGLMultisampleRenderTarget has been removed. Use a normal render target and set the "samples" property to greater 0 to enable multisampling.'),super(t,n,i),this.samples=4}}class MV extends Bm{constructor(t,n,i,o){console.warn("THREE.DataTexture2DArray has been renamed to DataArrayTexture."),super(t,n,i,o)}}class SV extends fy{constructor(t,n,i,o){console.warn("THREE.DataTexture3D has been renamed to Data3DTexture."),super(t,n,i,o)}}typeof __THREE_DEVTOOLS__!="undefined"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:cy}}));typeof window!="undefined"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=cy);var TV=Object.freeze(Object.defineProperty({__proto__:null,ACESFilmicToneMapping:HC,AddEquation:Xu,AddOperation:NC,AdditiveAnimationBlendMode:R_,AdditiveBlending:sb,AlphaFormat:qC,AlwaysDepth:LC,AlwaysStencilFunc:uR,AmbientLight:uL,AmbientLightProbe:LG,AnimationClip:Cm,AnimationLoader:vG,AnimationMixer:YG,AnimationObjectGroup:XG,AnimationUtils:br,ArcCurve:NR,ArrayCamera:ER,ArrowHelper:mV,Audio:vL,AudioAnalyser:FG,AudioContext:K_,AudioListener:OG,AudioLoader:CG,AxesHelper:gV,BackSide:To,BasicDepthPacking:aR,BasicShadowMap:jN,Bone:U_,BooleanKeyframeTrack:Sh,Box2:tV,Box3:Eh,Box3Helper:dV,BoxBufferGeometry:zl,BoxGeometry:zl,BoxHelper:fV,BufferAttribute:mr,BufferGeometry:Ii,BufferGeometryLoader:mL,ByteType:VC,Cache:xh,Camera:py,CameraHelper:hV,CanvasTexture:zH,CapsuleBufferGeometry:cd,CapsuleGeometry:cd,CatmullRomCurve3:UR,CineonToneMapping:zC,CircleBufferGeometry:ud,CircleGeometry:ud,ClampToEdgeWrapping:Qs,Clock:gL,Color:qn,ColorKeyframeTrack:q_,ColorManagement:Fo,CompressedTexture:FR,CompressedTextureLoader:yG,ConeBufferGeometry:hd,ConeGeometry:hd,CubeCamera:mR,CubeReflectionMapping:kc,CubeRefractionMapping:zc,CubeTexture:Nm,CubeTextureLoader:xG,CubeUVReflectionMapping:Fd,CubicBezierCurve:H_,CubicBezierCurve3:kR,CubicInterpolant:nL,CullFaceBack:rb,CullFaceFront:pC,CullFaceFrontBack:WN,CullFaceNone:dC,Curve:xa,CurvePath:HR,CustomBlending:vC,CustomToneMapping:GC,CylinderBufferGeometry:Wc,CylinderGeometry:Wc,Cylindrical:eV,Data3DTexture:fy,DataArrayTexture:Bm,DataTexture:id,DataTexture2DArray:MV,DataTexture3D:SV,DataTextureLoader:AG,DataUtils:yV,DecrementStencilOp:rU,DecrementWrapStencilOp:oU,DefaultLoadingManager:sL,DepthFormat:Bc,DepthStencilFormat:dh,DepthTexture:MR,DirectionalLight:cL,DirectionalLightHelper:uV,DiscreteInterpolant:iL,DodecahedronBufferGeometry:fd,DodecahedronGeometry:fd,DoubleSide:fh,DstAlphaFactor:EC,DstColorFactor:SC,DynamicCopyUsage:bU,DynamicDrawUsage:mU,DynamicReadUsage:yU,EdgesGeometry:GR,EllipseCurve:_y,EqualDepth:IC,EqualStencilFunc:uU,EquirectangularReflectionMapping:dm,EquirectangularRefractionMapping:pm,Euler:Nd,EventDispatcher:$c,ExtrudeBufferGeometry:dd,ExtrudeGeometry:dd,FileLoader:Hl,FlatShading:gC,Float16BufferAttribute:rk,Float32BufferAttribute:ni,Float64BufferAttribute:sk,FloatType:Bl,Fog:xy,FogExp2:yy,Font:_V,FontLoader:bV,FramebufferTexture:kH,FrontSide:hh,Frustum:my,GLBufferAttribute:KG,GLSL1:wU,GLSL3:Pb,GreaterDepth:DC,GreaterEqualDepth:OC,GreaterEqualStencilFunc:pU,GreaterStencilFunc:fU,GridHelper:lV,Group:Qf,HalfFloatType:od,HemisphereLight:oL,HemisphereLightHelper:aV,HemisphereLightProbe:RG,IcosahedronBufferGeometry:pd,IcosahedronGeometry:pd,ImageBitmapLoader:TG,ImageLoader:Rm,ImageUtils:P_,ImmediateRenderObject:wV,IncrementStencilOp:iU,IncrementWrapStencilOp:sU,InstancedBufferAttribute:ld,InstancedBufferGeometry:pL,InstancedInterleavedBuffer:QG,InstancedMesh:OR,Int16BufferAttribute:nk,Int32BufferAttribute:ik,Int8BufferAttribute:JU,IntType:jC,InterleavedBuffer:Ay,InterleavedBufferAttribute:mh,Interpolant:Um,InterpolateDiscrete:vm,InterpolateLinear:ym,InterpolateSmooth:vv,InvertStencilOp:aU,KeepStencilOp:yv,KeyframeTrack:Aa,LOD:PR,LatheBufferGeometry:gh,LatheGeometry:gh,Layers:dy,LessDepth:PC,LessEqualDepth:Dv,LessEqualStencilFunc:hU,LessStencilFunc:cU,Light:Yc,LightProbe:My,Line:Vc,Line3:nV,LineBasicMaterial:io,LineCurve:wy,LineCurve3:zR,LineDashedMaterial:tL,LineLoop:DR,LineSegments:il,LinearEncoding:Gc,LinearFilter:Vr,LinearInterpolant:$_,LinearMipMapLinearFilter:QN,LinearMipMapNearestFilter:YN,LinearMipmapLinearFilter:_h,LinearMipmapNearestFilter:T_,LinearSRGBColorSpace:Cc,LinearToneMapping:UC,Loader:Po,LoaderUtils:Ub,LoadingManager:Y_,LoopOnce:rR,LoopPingPong:oR,LoopRepeat:sR,LuminanceAlphaFormat:KC,LuminanceFormat:QC,MOUSE:GN,Material:rs,MaterialLoader:dL,MathUtils:kU,Matrix3:Ho,Matrix4:Oi,MaxEquation:cb,Mesh:Ss,MeshBasicMaterial:qc,MeshDepthMaterial:B_,MeshDistanceMaterial:F_,MeshLambertMaterial:JR,MeshMatcapMaterial:eL,MeshNormalMaterial:ZR,MeshPhongMaterial:QR,MeshPhysicalMaterial:YR,MeshStandardMaterial:X_,MeshToonMaterial:KR,MinEquation:lb,MirroredRepeatWrapping:gm,MixOperation:FC,MultiplyBlending:ab,MultiplyOperation:Dm,NearestFilter:Qr,NearestMipMapLinearFilter:qN,NearestMipMapNearestFilter:$N,NearestMipmapLinearFilter:Fv,NearestMipmapNearestFilter:Bv,NeverDepth:RC,NeverStencilFunc:lU,NoBlending:Ul,NoColorSpace:eU,NoToneMapping:za,NormalAnimationBlendMode:hy,NormalBlending:rh,NotEqualDepth:BC,NotEqualStencilFunc:dU,NumberKeyframeTrack:Sm,Object3D:or,ObjectLoader:MG,ObjectSpaceNormalMap:cR,OctahedronBufferGeometry:vh,OctahedronGeometry:vh,OneFactor:bC,OneMinusDstAlphaFactor:MC,OneMinusDstColorFactor:TC,OneMinusSrcAlphaFactor:S_,OneMinusSrcColorFactor:wC,OrthographicCamera:gy,PCFShadowMap:E_,PCFSoftShadowMap:mC,PMREMGenerator:Ob,ParametricGeometry:xV,Path:_m,PerspectiveCamera:Es,Plane:Mc,PlaneBufferGeometry:ph,PlaneGeometry:ph,PlaneHelper:pV,PointLight:lL,PointLightHelper:sV,Points:BR,PointsMaterial:k_,PolarGridHelper:cV,PolyhedronBufferGeometry:Qa,PolyhedronGeometry:Qa,PositionalAudio:BG,PropertyBinding:qi,PropertyMixer:yL,QuadraticBezierCurve:G_,QuadraticBezierCurve3:V_,Quaternion:ao,QuaternionKeyframeTrack:kd,QuaternionLinearInterpolant:rL,REVISION:cy,RGBADepthPacking:lR,RGBAFormat:Mo,RGBAIntegerFormat:nR,RGBA_ASTC_10x10_Format:Tb,RGBA_ASTC_10x5_Format:Eb,RGBA_ASTC_10x6_Format:Mb,RGBA_ASTC_10x8_Format:Sb,RGBA_ASTC_12x10_Format:Cb,RGBA_ASTC_12x12_Format:Rb,RGBA_ASTC_4x4_Format:gb,RGBA_ASTC_5x4_Format:vb,RGBA_ASTC_5x5_Format:yb,RGBA_ASTC_6x5_Format:xb,RGBA_ASTC_6x6_Format:Ab,RGBA_ASTC_8x5_Format:bb,RGBA_ASTC_8x6_Format:_b,RGBA_ASTC_8x8_Format:wb,RGBA_BPTC_Format:Lb,RGBA_ETC2_EAC_Format:mb,RGBA_PVRTC_2BPPV1_Format:db,RGBA_PVRTC_4BPPV1_Format:fb,RGBA_S3TC_DXT1_Format:pv,RGBA_S3TC_DXT3_Format:mv,RGBA_S3TC_DXT5_Format:gv,RGBFormat:YC,RGB_ETC1_Format:iR,RGB_ETC2_Format:pb,RGB_PVRTC_2BPPV1_Format:hb,RGB_PVRTC_4BPPV1_Format:ub,RGB_S3TC_DXT1_Format:dv,RGFormat:eR,RGIntegerFormat:tR,RawShaderMaterial:qR,Ray:Fm,Raycaster:ZG,RectAreaLight:hL,RedFormat:ZC,RedIntegerFormat:JC,ReinhardToneMapping:kC,RepeatWrapping:mm,ReplaceStencilOp:nU,ReverseSubtractEquation:xC,RingBufferGeometry:md,RingGeometry:md,SRGBColorSpace:Na,Scene:CR,ShaderChunk:Ui,ShaderLib:ua,ShaderMaterial:Ya,ShadowMaterial:$R,Shape:lh,ShapeBufferGeometry:gd,ShapeGeometry:gd,ShapePath:vV,ShapeUtils:Ha,ShortType:WC,Skeleton:by,SkeletonHelper:rV,SkinnedMesh:IR,SmoothShading:XN,Source:Ju,Sphere:Mh,SphereBufferGeometry:yh,SphereGeometry:yh,Spherical:JG,SphericalHarmonics3:fL,SplineCurve:W_,SpotLight:aL,SpotLightHelper:iV,Sprite:LR,SpriteMaterial:N_,SrcAlphaFactor:M_,SrcAlphaSaturateFactor:CC,SrcColorFactor:_C,StaticCopyUsage:AU,StaticDrawUsage:Nv,StaticReadUsage:vU,StereoCamera:PG,StreamCopyUsage:_U,StreamDrawUsage:gU,StreamReadUsage:xU,StringKeyframeTrack:Th,SubtractEquation:yC,SubtractiveBlending:ob,TOUCH:VN,TangentSpaceNormalMap:wh,TetrahedronBufferGeometry:vd,TetrahedronGeometry:vd,TextGeometry:AV,Texture:is,TextureLoader:bG,TorusBufferGeometry:yd,TorusGeometry:yd,TorusKnotBufferGeometry:xd,TorusKnotGeometry:xd,Triangle:zo,TriangleFanDrawMode:JN,TriangleStripDrawMode:ZN,TrianglesDrawMode:KN,TubeBufferGeometry:Ad,TubeGeometry:Ad,UVMapping:uy,Uint16BufferAttribute:I_,Uint32BufferAttribute:O_,Uint8BufferAttribute:ek,Uint8ClampedBufferAttribute:tk,Uniform:ew,UniformsLib:Fn,UniformsUtils:pR,UnsignedByteType:Hc,UnsignedInt248Type:sh,UnsignedIntType:Tc,UnsignedShort4444Type:XC,UnsignedShort5551Type:$C,UnsignedShortType:C_,VSMShadowMap:$f,Vector2:yn,Vector3:Ze,Vector4:ur,VectorKeyframeTrack:Tm,VideoTexture:UH,WebGL1Renderer:TR,WebGL3DRenderTarget:VU,WebGLArrayRenderTarget:GU,WebGLCubeRenderTarget:gR,WebGLMultipleRenderTargets:WU,WebGLMultisampleRenderTarget:EV,WebGLRenderTarget:Ro,WebGLRenderer:SR,WebGLUtils:wR,WireframeGeometry:XR,WrapAroundEnding:xm,ZeroCurvatureEnding:Ku,ZeroFactor:AC,ZeroSlopeEnding:Zu,ZeroStencilOp:tU,_SRGBAFormat:Uv,sRGBEncoding:_r},Symbol.toStringTag,{value:"Module"})),CV=ly(TV),Gr=CV,RV=function(){var a={POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123,FLOAT:5126,UNSIGNED_INT:5125,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987},t={1003:a.NEAREST,1004:a.NEAREST_MIPMAP_NEAREST,1005:a.NEAREST_MIPMAP_LINEAR,1006:a.LINEAR,1007:a.LINEAR_MIPMAP_NEAREST,1008:a.LINEAR_MIPMAP_LINEAR},n={scale:"scale",position:"translation",quaternion:"rotation",morphTargetInfluences:"weights"};function i(){}return i.prototype={constructor:i,parse:function(o,s,c){var u={binary:!1,trs:!1,onlyVisible:!0,truncateDrawRange:!0,embedImages:!0,animations:[],forceIndices:!1,forcePowerOfTwoTextures:!1};c=Object.assign({},u,c),c.animations.length>0&&(c.trs=!0);var h={asset:{version:"2.0",generator:"THREE.GLTFExporter"}},f=0,p=[],m=[],y=new Map,g=[],_={},x={attributes:new Map,materials:new Map,textures:new Map,images:new Map},b;function E(me,De){return me.length===De.length&&me.every(function(ze,tt){return ze===De[tt]})}function T(me){if(window.TextEncoder!==void 0)return new TextEncoder().encode(me).buffer;for(var De=new Uint8Array(new ArrayBuffer(me.length)),ze=0,tt=me.length;ze<tt;ze++){var rt=me.charCodeAt(ze);De[ze]=rt>255?32:rt}return De.buffer}function P(me,De,ze){for(var tt={min:new Array(me.itemSize).fill(Number.POSITIVE_INFINITY),max:new Array(me.itemSize).fill(Number.NEGATIVE_INFINITY)},rt=De;rt<De+ze;rt++)for(var vt=0;vt<me.itemSize;vt++){var Ye=me.array[rt*me.itemSize+vt];tt.min[vt]=Math.min(tt.min[vt],Ye),tt.max[vt]=Math.max(tt.max[vt],Ye)}return tt}function D(me){return Gr.Math.isPowerOfTwo(me.width)&&Gr.Math.isPowerOfTwo(me.height)}function F(me){if(x.attributes.has(me))return!1;for(var De=new Gr.Vector3,ze=0,tt=me.count;ze<tt;ze++)if(Math.abs(De.fromArray(me.array,ze*3).length()-1)>5e-4)return!1;return!0}function k(me){if(x.attributes.has(me))return x.attributes.get(me);for(var De=me.clone(),ze=new Gr.Vector3,tt=0,rt=De.count;tt<rt;tt++)ze.fromArray(De.array,tt*3),ze.x===0&&ze.y===0&&ze.z===0?ze.setX(1):ze.normalize(),ze.toArray(De.array,tt*3);return x.attributes.set(me,De),De}function W(me){return Math.ceil(me/4)*4}function j(me,De){De=De||0;var ze=W(me.byteLength);if(ze!==me.byteLength){var tt=new Uint8Array(ze);if(tt.set(new Uint8Array(me)),De!==0)for(var rt=me.byteLength;rt<ze;rt++)tt[rt]=De;return tt.buffer}return me}function J(me){try{return JSON.parse(JSON.stringify(me.userData))}catch(De){return console.warn("THREE.GLTFExporter: userData of '"+me.name+"' won't be serialized because of JSON.stringify error - "+De.message),{}}}function de(me){return h.buffers||(h.buffers=[{byteLength:0}]),p.push(me),0}function te(me,De,ze,tt,rt){h.bufferViews||(h.bufferViews=[]);var vt;De===a.UNSIGNED_BYTE?vt=1:De===a.UNSIGNED_SHORT?vt=2:vt=4;for(var Ye=W(tt*me.itemSize*vt),Pe=new DataView(new ArrayBuffer(Ye)),Be=0,$e=ze;$e<ze+tt;$e++)for(var Je=0;Je<me.itemSize;Je++){var We=me.array[$e*me.itemSize+Je];De===a.FLOAT?Pe.setFloat32(Be,We,!0):De===a.UNSIGNED_INT?Pe.setUint32(Be,We,!0):De===a.UNSIGNED_SHORT?Pe.setUint16(Be,We,!0):De===a.UNSIGNED_BYTE&&Pe.setUint8(Be,We),Be+=vt}var _e={buffer:de(Pe.buffer),byteOffset:f,byteLength:Ye};rt!==void 0&&(_e.target=rt),rt===a.ARRAY_BUFFER&&(_e.byteStride=me.itemSize*vt),f+=Ye,h.bufferViews.push(_e);var Ee={id:h.bufferViews.length-1,byteLength:0};return Ee}function N(me){return h.bufferViews||(h.bufferViews=[]),new Promise(function(De){var ze=new window.FileReader;ze.readAsArrayBuffer(me),ze.onloadend=function(){var tt=j(ze.result),rt={buffer:de(tt),byteOffset:f,byteLength:tt.byteLength};f+=tt.byteLength,h.bufferViews.push(rt),De(h.bufferViews.length-1)}})}function L(me,De,ze,tt){var rt={1:"SCALAR",2:"VEC2",3:"VEC3",4:"VEC4",16:"MAT4"},vt;if(me.array.constructor===Float32Array)vt=a.FLOAT;else if(me.array.constructor===Uint32Array)vt=a.UNSIGNED_INT;else if(me.array.constructor===Uint16Array)vt=a.UNSIGNED_SHORT;else if(me.array.constructor===Uint8Array)vt=a.UNSIGNED_BYTE;else throw new Error("THREE.GLTFExporter: Unsupported bufferAttribute component type.");if(ze===void 0&&(ze=0),tt===void 0&&(tt=me.count),c.truncateDrawRange&&De!==void 0&&De.index===null){var Ye=ze+tt,Pe=De.drawRange.count===1/0?me.count:De.drawRange.start+De.drawRange.count;ze=Math.max(ze,De.drawRange.start),tt=Math.min(Ye,Pe)-ze,tt<0&&(tt=0)}if(tt===0)return null;var Be=P(me,ze,tt),$e;De!==void 0&&($e=me===De.index?a.ELEMENT_ARRAY_BUFFER:a.ARRAY_BUFFER);var Je=te(me,vt,ze,tt,$e),We={bufferView:Je.id,byteOffset:Je.byteOffset,componentType:vt,count:tt,max:Be.max,min:Be.min,type:rt[me.itemSize]};return h.accessors||(h.accessors=[]),h.accessors.push(We),h.accessors.length-1}function M(me,De,ze){x.images.has(me)||x.images.set(me,{});var tt=x.images.get(me),rt=De===Gr.RGBAFormat?"image/png":"image/jpeg",vt=rt+":flipY/"+ze.toString();if(tt[vt]!==void 0)return tt[vt];h.images||(h.images=[]);var Ye={mimeType:rt};if(c.embedImages){var Pe=b=b||document.createElement("canvas");Pe.width=me.width,Pe.height=me.height,c.forcePowerOfTwoTextures&&!D(me)&&(console.warn("GLTFExporter: Resized non-power-of-two image.",me),Pe.width=Gr.Math.floorPowerOfTwo(Pe.width),Pe.height=Gr.Math.floorPowerOfTwo(Pe.height));var Be=Pe.getContext("2d");ze===!0&&(Be.translate(0,Pe.height),Be.scale(1,-1)),Be.drawImage(me,0,0,Pe.width,Pe.height),c.binary===!0?m.push(new Promise(function(Je){Pe.toBlob(function(We){N(We).then(function(_e){Ye.bufferView=_e,Je()})},rt)})):Ye.uri=Pe.toDataURL(rt)}else Ye.uri=me.src;h.images.push(Ye);var $e=h.images.length-1;return tt[vt]=$e,$e}function I(me){h.samplers||(h.samplers=[]);var De={magFilter:t[me.magFilter],minFilter:t[me.minFilter],wrapS:t[me.wrapS],wrapT:t[me.wrapT]};return h.samplers.push(De),h.samplers.length-1}function U(me){if(x.textures.has(me))return x.textures.get(me);h.textures||(h.textures=[]);var De={sampler:I(me),source:M(me.image,me.format,me.flipY)};h.textures.push(De);var ze=h.textures.length-1;return x.textures.set(me,ze),ze}function $(me){if(x.materials.has(me))return x.materials.get(me);if(h.materials||(h.materials=[]),me.isShaderMaterial)return console.warn("GLTFExporter: THREE.ShaderMaterial not supported."),null;var De={pbrMetallicRoughness:{}};me.isMeshBasicMaterial?(De.extensions={KHR_materials_unlit:{}},_.KHR_materials_unlit=!0):me.isMeshStandardMaterial||console.warn("GLTFExporter: Use MeshStandardMaterial or MeshBasicMaterial for best results.");var ze=me.color.toArray().concat([me.opacity]);if(E(ze,[1,1,1,1])||(De.pbrMetallicRoughness.baseColorFactor=ze),me.isMeshStandardMaterial?(De.pbrMetallicRoughness.metallicFactor=me.metalness,De.pbrMetallicRoughness.roughnessFactor=me.roughness):me.isMeshBasicMaterial?(De.pbrMetallicRoughness.metallicFactor=0,De.pbrMetallicRoughness.roughnessFactor=.9):(De.pbrMetallicRoughness.metallicFactor=.5,De.pbrMetallicRoughness.roughnessFactor=.5),(me.metalnessMap||me.roughnessMap)&&(me.metalnessMap===me.roughnessMap?De.pbrMetallicRoughness.metallicRoughnessTexture={index:U(me.metalnessMap)}:console.warn("THREE.GLTFExporter: Ignoring metalnessMap and roughnessMap because they are not the same Texture.")),me.map&&(De.pbrMetallicRoughness.baseColorTexture={index:U(me.map)}),!(me.isMeshBasicMaterial||me.isLineBasicMaterial||me.isPointsMaterial)){var tt=me.emissive.clone().multiplyScalar(me.emissiveIntensity).toArray();E(tt,[0,0,0])||(De.emissiveFactor=tt),me.emissiveMap&&(De.emissiveTexture={index:U(me.emissiveMap)})}me.normalMap&&(De.normalTexture={index:U(me.normalMap)},me.normalScale.x!==-1&&(me.normalScale.x!==me.normalScale.y&&console.warn("THREE.GLTFExporter: Normal scale components are different, ignoring Y and exporting X."),De.normalTexture.scale=me.normalScale.x)),me.aoMap&&(De.occlusionTexture={index:U(me.aoMap)},me.aoMapIntensity!==1&&(De.occlusionTexture.strength=me.aoMapIntensity)),(me.transparent||me.alphaTest>0)&&(De.alphaMode=me.opacity<1?"BLEND":"MASK",me.alphaTest>0&&me.alphaTest!==.5&&(De.alphaCutoff=me.alphaTest)),me.side===Gr.DoubleSide&&(De.doubleSided=!0),me.name!==""&&(De.name=me.name),Object.keys(me.userData).length>0&&(De.extras=J(me)),h.materials.push(De);var rt=h.materials.length-1;return x.materials.set(me,rt),rt}function ee(me){var De=me.geometry,ze;if(me.isLineSegments)ze=a.LINES;else if(me.isLineLoop)ze=a.LINE_LOOP;else if(me.isLine)ze=a.LINE_STRIP;else if(me.isPoints)ze=a.POINTS;else{if(!De.isBufferGeometry){var tt=new Gr.BufferGeometry;tt.fromGeometry(De),De=tt}me.drawMode===Gr.TriangleFanDrawMode?(console.warn("GLTFExporter: TriangleFanDrawMode and wireframe incompatible."),ze=a.TRIANGLE_FAN):me.drawMode===Gr.TriangleStripDrawMode?ze=me.material.wireframe?a.LINE_STRIP:a.TRIANGLE_STRIP:ze=me.material.wireframe?a.LINES:a.TRIANGLES}var rt={},vt={},Ye=[],Pe=[],Be={uv:"TEXCOORD_0",uv2:"TEXCOORD_1",color:"COLOR_0",skinWeight:"WEIGHTS_0",skinIndex:"JOINTS_0"},$e=De.getAttribute("normal");$e!==void 0&&!F($e)&&(console.warn("THREE.GLTFExporter: Creating normalized normal attribute from the non-normalized one."),De.addAttribute("normal",k($e)));for(var Je in De.attributes){var We=De.attributes[Je];Je=Be[Je]||Je.toUpperCase();var _e=We.array;if(Je==="JOINTS_0"&&!(_e instanceof Uint16Array)&&!(_e instanceof Uint8Array)&&(console.warn('GLTFExporter: Attribute "skinIndex" converted to type UNSIGNED_SHORT.'),We=new Gr.BufferAttribute(new Uint16Array(_e),We.itemSize,We.normalized)),Je.substr(0,5)!=="MORPH"){var Ee=L(We,De);Ee!==null&&(vt[Je]=Ee)}}if($e!==void 0&&De.addAttribute("normal",$e),Object.keys(vt).length===0)return null;if(me.morphTargetInfluences!==void 0&&me.morphTargetInfluences.length>0){var Oe=[],Le=[],ce={};if(me.morphTargetDictionary!==void 0)for(var he in me.morphTargetDictionary)ce[me.morphTargetDictionary[he]]=he;for(var ie=0;ie<me.morphTargetInfluences.length;++ie){var V={},Z=!1;for(var Je in De.morphAttributes){if(Je!=="position"&&Je!=="normal"){Z||(console.warn("GLTFExporter: Only POSITION and NORMAL morph are supported."),Z=!0);continue}for(var We=De.morphAttributes[Je][ie],B=De.attributes[Je],S=We.clone(),R=0,X=We.count;R<X;R++)S.setXYZ(R,We.getX(R)-B.getX(R),We.getY(R)-B.getY(R),We.getZ(R)-B.getZ(R));V[Je.toUpperCase()]=L(S,De)}Pe.push(V),Oe.push(me.morphTargetInfluences[ie]),me.morphTargetDictionary!==void 0&&Le.push(ce[ie])}rt.weights=Oe,Le.length>0&&(rt.extras={},rt.extras.targetNames=Le)}var xe=Object.keys(De.userData).length>0?J(De):void 0,Ie=c.forceIndices,ye=Array.isArray(me.material);if(ye&&De.groups.length===0)return null;!Ie&&De.index===null&&ye&&(console.warn("THREE.GLTFExporter: Creating index for non-indexed multi-material mesh."),Ie=!0);var nt=!1;if(De.index===null&&Ie){for(var at=[],ie=0,mt=De.attributes.position.count;ie<mt;ie++)at[ie]=ie;De.setIndex(at),nt=!0}for(var wt=ye?me.material:[me.material],Lt=ye?De.groups:[{materialIndex:0,start:void 0,count:void 0}],ie=0,mt=Lt.length;ie<mt;ie++){var Ct={mode:ze,attributes:vt};xe&&(Ct.extras=xe),Pe.length>0&&(Ct.targets=Pe),De.index!==null&&(Ct.indices=L(De.index,De,Lt[ie].start,Lt[ie].count));var ut=$(wt[Lt[ie].materialIndex]);ut!==null&&(Ct.material=ut),Ye.push(Ct)}return nt&&De.setIndex(null),rt.primitives=Ye,h.meshes||(h.meshes=[]),h.meshes.push(rt),h.meshes.length-1}function Q(me){h.cameras||(h.cameras=[]);var De=me.isOrthographicCamera,ze={type:De?"orthographic":"perspective"};return De?ze.orthographic={xmag:me.right*2,ymag:me.top*2,zfar:me.far<=0?.001:me.far,znear:me.near<0?0:me.near}:ze.perspective={aspectRatio:me.aspect,yfov:Gr.Math.degToRad(me.fov)/me.aspect,zfar:me.far<=0?.001:me.far,znear:me.near<0?0:me.near},me.name!==""&&(ze.name=me.type),h.cameras.push(ze),h.cameras.length-1}function G(me,De){h.animations||(h.animations=[]);for(var ze=[],tt=[],rt=0;rt<me.tracks.length;++rt){var vt=me.tracks[rt],Ye=Gr.PropertyBinding.parseTrackName(vt.name),Pe=Gr.PropertyBinding.findNode(De,Ye.nodeName),Be=n[Ye.propertyName];if(Ye.objectName==="bones"&&(Pe.isSkinnedMesh===!0?Pe=Pe.skeleton.getBoneByName(Ye.objectIndex):Pe=void 0),!Pe||!Be)return console.warn('THREE.GLTFExporter: Could not export animation track "%s".',vt.name),null;var $e=1,Je=vt.values.length/vt.times.length;if(Be===n.morphTargetInfluences){if(Pe.morphTargetInfluences.length!==1&&Ye.propertyIndex!==void 0){console.warn('THREE.GLTFExporter: Skipping animation track "%s". Morph target keyframe tracks must target all available morph targets for the given mesh.',vt.name);continue}Je/=Pe.morphTargetInfluences.length}var We;vt.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline===!0?(We="CUBICSPLINE",Je/=3):vt.getInterpolation()===Gr.InterpolateDiscrete?We="STEP":We="LINEAR",tt.push({input:L(new Gr.BufferAttribute(vt.times,$e)),output:L(new Gr.BufferAttribute(vt.values,Je)),interpolation:We}),ze.push({sampler:tt.length-1,target:{node:y.get(Pe),path:Be}})}return h.animations.push({name:me.name||"clip_"+h.animations.length,samplers:tt,channels:ze}),h.animations.length-1}function K(me){var De=h.nodes[y.get(me)],ze=me.skeleton,tt=me.skeleton.bones[0];if(tt===void 0)return null;for(var rt=[],vt=new Float32Array(ze.bones.length*16),Ye=0;Ye<ze.bones.length;++Ye)rt.push(y.get(ze.bones[Ye])),ze.boneInverses[Ye].toArray(vt,Ye*16);h.skins===void 0&&(h.skins=[]),h.skins.push({inverseBindMatrices:L(new Gr.BufferAttribute(vt,16)),joints:rt,skeleton:y.get(tt)});var Pe=De.skin=h.skins.length-1;return Pe}function Y(me){if(me.isLight)return console.warn("GLTFExporter: Unsupported node type:",me.constructor.name),null;h.nodes||(h.nodes=[]);var De={};if(c.trs){var ze=me.quaternion.toArray(),tt=me.position.toArray(),rt=me.scale.toArray();E(ze,[0,0,0,1])||(De.rotation=ze),E(tt,[0,0,0])||(De.translation=tt),E(rt,[1,1,1])||(De.scale=rt)}else me.updateMatrix(),E(me.matrix.elements,[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])||(De.matrix=me.matrix.elements);if(me.name!==""&&(De.name=String(me.name)),me.userData&&Object.keys(me.userData).length>0&&(De.extras=J(me)),me.isMesh||me.isLine||me.isPoints){var vt=ee(me);vt!==null&&(De.mesh=vt)}else me.isCamera&&(De.camera=Q(me));if(me.isSkinnedMesh&&g.push(me),me.children.length>0){for(var Ye=[],Pe=0,Be=me.children.length;Pe<Be;Pe++){var $e=me.children[Pe];if($e.visible||c.onlyVisible===!1){var Je=Y($e);Je!==null&&Ye.push(Je)}}Ye.length>0&&(De.children=Ye)}h.nodes.push(De);var We=h.nodes.length-1;return y.set(me,We),We}function we(me){h.scenes||(h.scenes=[],h.scene=0);var De={nodes:[]};me.name!==""&&(De.name=me.name),h.scenes.push(De);for(var ze=[],tt=0,rt=me.children.length;tt<rt;tt++){var vt=me.children[tt];if(vt.visible||c.onlyVisible===!1){var Ye=Y(vt);Ye!==null&&ze.push(Ye)}}ze.length>0&&(De.nodes=ze)}function Ke(me){var De=new Gr.Scene;De.name="AuxScene";for(var ze=0;ze<me.length;ze++)De.children.push(me[ze]);we(De)}function ge(me){me=me instanceof Array?me:[me];for(var De=[],ze=0;ze<me.length;ze++)me[ze]instanceof Gr.Scene?we(me[ze]):De.push(me[ze]);De.length>0&&Ke(De);for(var ze=0;ze<g.length;++ze)K(g[ze]);for(var ze=0;ze<c.animations.length;++ze)G(c.animations[ze],me[0])}ge(o),Promise.all(m).then(function(){var me=new Blob(p,{type:"application/octet-stream"}),De=Object.keys(_);if(De.length>0&&(h.extensionsUsed=De),h.buffers&&h.buffers.length>0){h.buffers[0].byteLength=me.size;var ze=new window.FileReader;if(c.binary===!0){var tt=12,rt=1179937895,vt=2,Ye=8,Pe=1313821514,Be=5130562;ze.readAsArrayBuffer(me),ze.onloadend=function(){var $e=j(ze.result),Je=new DataView(new ArrayBuffer(Ye));Je.setUint32(0,$e.byteLength,!0),Je.setUint32(4,Be,!0);var We=j(T(JSON.stringify(h)),32),_e=new DataView(new ArrayBuffer(Ye));_e.setUint32(0,We.byteLength,!0),_e.setUint32(4,Pe,!0);var Ee=new ArrayBuffer(tt),Oe=new DataView(Ee);Oe.setUint32(0,rt,!0),Oe.setUint32(4,vt,!0);var Le=tt+_e.byteLength+We.byteLength+Je.byteLength+$e.byteLength;Oe.setUint32(8,Le,!0);var ce=new Blob([Ee,_e,We,Je,$e],{type:"application/octet-stream"}),he=new window.FileReader;he.readAsArrayBuffer(ce),he.onloadend=function(){s(he.result)}}}else ze.readAsDataURL(me),ze.onloadend=function(){var $e=ze.result;h.buffers[0].uri=$e,s(h)}}else s(h)})}},i}(),LV=RV,Sy={exports:{}};(function(a){var t=Object.prototype.hasOwnProperty,n="~";function i(){}Object.create&&(i.prototype=Object.create(null),new i().__proto__||(n=!1));function o(h,f,p){this.fn=h,this.context=f,this.once=p||!1}function s(h,f,p,m,y){if(typeof p!="function")throw new TypeError("The listener must be a function");var g=new o(p,m||h,y),_=n?n+f:f;return h._events[_]?h._events[_].fn?h._events[_]=[h._events[_],g]:h._events[_].push(g):(h._events[_]=g,h._eventsCount++),h}function c(h,f){--h._eventsCount===0?h._events=new i:delete h._events[f]}function u(){this._events=new i,this._eventsCount=0}u.prototype.eventNames=function(){var f=[],p,m;if(this._eventsCount===0)return f;for(m in p=this._events)t.call(p,m)&&f.push(n?m.slice(1):m);return Object.getOwnPropertySymbols?f.concat(Object.getOwnPropertySymbols(p)):f},u.prototype.listeners=function(f){var p=n?n+f:f,m=this._events[p];if(!m)return[];if(m.fn)return[m.fn];for(var y=0,g=m.length,_=new Array(g);y<g;y++)_[y]=m[y].fn;return _},u.prototype.listenerCount=function(f){var p=n?n+f:f,m=this._events[p];return m?m.fn?1:m.length:0},u.prototype.emit=function(f,p,m,y,g,_){var x=n?n+f:f;if(!this._events[x])return!1;var b=this._events[x],E=arguments.length,T,P;if(b.fn){switch(b.once&&this.removeListener(f,b.fn,void 0,!0),E){case 1:return b.fn.call(b.context),!0;case 2:return b.fn.call(b.context,p),!0;case 3:return b.fn.call(b.context,p,m),!0;case 4:return b.fn.call(b.context,p,m,y),!0;case 5:return b.fn.call(b.context,p,m,y,g),!0;case 6:return b.fn.call(b.context,p,m,y,g,_),!0}for(P=1,T=new Array(E-1);P<E;P++)T[P-1]=arguments[P];b.fn.apply(b.context,T)}else{var D=b.length,F;for(P=0;P<D;P++)switch(b[P].once&&this.removeListener(f,b[P].fn,void 0,!0),E){case 1:b[P].fn.call(b[P].context);break;case 2:b[P].fn.call(b[P].context,p);break;case 3:b[P].fn.call(b[P].context,p,m);break;case 4:b[P].fn.call(b[P].context,p,m,y);break;default:if(!T)for(F=1,T=new Array(E-1);F<E;F++)T[F-1]=arguments[F];b[P].fn.apply(b[P].context,T)}}return!0},u.prototype.on=function(f,p,m){return s(this,f,p,m,!1)},u.prototype.once=function(f,p,m){return s(this,f,p,m,!0)},u.prototype.removeListener=function(f,p,m,y){var g=n?n+f:f;if(!this._events[g])return this;if(!p)return c(this,g),this;var _=this._events[g];if(_.fn)_.fn===p&&(!y||_.once)&&(!m||_.context===m)&&c(this,g);else{for(var x=0,b=[],E=_.length;x<E;x++)(_[x].fn!==p||y&&!_[x].once||m&&_[x].context!==m)&&b.push(_[x]);b.length?this._events[g]=b.length===1?b[0]:b:c(this,g)}return this},u.prototype.removeAllListeners=function(f){var p;return f?(p=n?n+f:f,this._events[p]&&c(this,p)):(this._events=new i,this._eventsCount=0),this},u.prototype.off=u.prototype.removeListener,u.prototype.addListener=u.prototype.on,u.prefixed=n,u.EventEmitter=u,a.exports=u})(Sy);var PV=Sy.exports;class no extends Error{constructor(t,n){super(t),this.error=n}}class _L extends no{constructor(){super(...arguments),this.name="WalletNotReadyError"}}class IV extends no{constructor(){super(...arguments),this.name="WalletConnectionError"}}class OV extends no{constructor(){super(...arguments),this.name="WalletDisconnectedError"}}class DV extends no{constructor(){super(...arguments),this.name="WalletDisconnectionError"}}class BV extends no{constructor(){super(...arguments),this.name="WalletAccountError"}}class FV extends no{constructor(){super(...arguments),this.name="WalletPublicKeyError"}}class Fl extends no{constructor(){super(...arguments),this.name="WalletNotConnectedError"}}class wL extends no{constructor(){super(...arguments),this.name="WalletSendTransactionError"}}class NV extends no{constructor(){super(...arguments),this.name="WalletSignMessageError"}}class zb extends no{constructor(){super(...arguments),this.name="WalletSignTransactionError"}}class UV extends no{constructor(){super(...arguments),this.name="WalletWindowClosedError"}}var fa;(function(a){a.Installed="Installed",a.NotDetected="NotDetected",a.Loadable="Loadable",a.Unsupported="Unsupported"})(fa||(fa={}));class kV extends PV{get connected(){return!!this.publicKey}async prepareTransaction(t,n){const i=this.publicKey;if(!i)throw new Fl;return t.feePayer=t.feePayer||i,t.recentBlockhash=t.recentBlockhash||(await n.getRecentBlockhash("finalized")).blockhash,t}}function zV(a){if(typeof window=="undefined"||typeof document=="undefined")return;const t=[];function n(){if(a())for(const s of t)s()}const i=setInterval(n,1e3);t.push(()=>clearInterval(i)),document.readyState==="loading"&&(document.addEventListener("DOMContentLoaded",n,{once:!0}),t.push(()=>document.removeEventListener("DOMContentLoaded",n))),document.readyState!=="complete"&&(window.addEventListener("load",n,{once:!0}),t.push(()=>window.removeEventListener("load",n))),n()}class HV extends kV{async sendTransaction(t,n,i={}){let o=!0;try{try{t=await this.prepareTransaction(t,n);const s=i,{signers:c}=s,u=hg(s,["signers"]);c!=null&&c.length&&t.partialSign(...c),t=await this.signTransaction(t);const h=t.serialize();return await n.sendRawTransaction(h,u)}catch(c){throw c instanceof zb?(o=!1,c):new wL(c==null?void 0:c.message,c)}}catch(c){throw o&&this.emit("error",c),c}}}class GV extends HV{}var VV=Object.defineProperty,S3=Object.getOwnPropertySymbols,WV=Object.prototype.hasOwnProperty,jV=Object.prototype.propertyIsEnumerable,Hb=(a,t,n)=>t in a?VV(a,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[t]=n,zs=(a,t)=>{for(var n in t||(t={}))WV.call(t,n)&&Hb(a,n,t[n]);if(S3)for(var n of S3(t))jV.call(t,n)&&Hb(a,n,t[n]);return a},EL=(a,t,n)=>(Hb(a,typeof t!="symbol"?t+"":t,n),n);class T3 extends no{constructor(){super(...arguments),EL(this,"name","WalletNotSelectedError")}}class XV extends no{constructor(){super(...arguments),EL(this,"name","WalletNotSelectedError")}}function ML(a){return oF()?(aF(a),!0):!1}const Ty=typeof window!="undefined",$V=a=>typeof a=="string",AA=()=>{};function qV(a,t){function n(...i){a(()=>t.apply(this,i),{fn:t,thisArg:this,args:i})}return n}const YV=a=>a();var C3=Object.getOwnPropertySymbols,QV=Object.prototype.hasOwnProperty,KV=Object.prototype.propertyIsEnumerable,ZV=(a,t)=>{var n={};for(var i in a)QV.call(a,i)&&t.indexOf(i)<0&&(n[i]=a[i]);if(a!=null&&C3)for(var i of C3(a))t.indexOf(i)<0&&KV.call(a,i)&&(n[i]=a[i]);return n};function JV(a,t,n={}){const i=n,{eventFilter:o=YV}=i,s=ZV(i,["eventFilter"]);return Dc(a,qV(o,t),s)}function eW(a,t,n={}){const{immediate:i=!0}=n,o=ws(!1);let s=null;function c(){s&&(clearTimeout(s),s=null)}function u(){o.value=!1,c()}function h(...f){c(),o.value=!0,s=setTimeout(()=>{o.value=!1,s=null,a(...f)},So(t))}return i&&(o.value=!0,Ty&&h()),ML(u),{isPending:o,start:h,stop:u}}function R3(a){var t;const n=So(a);return(t=n==null?void 0:n.$el)!=null?t:n}const bd=Ty?window:void 0,tW=Ty?window.navigator:void 0;function _d(...a){let t,n,i,o;if($V(a[0])?([n,i,o]=a,t=bd):[t,n,i,o]=a,!t)return AA;let s=AA;const c=Dc(()=>So(t),h=>{s(),h&&(h.addEventListener(n,i,o),s=()=>{h.removeEventListener(n,i,o),s=AA})},{immediate:!0,flush:"post"}),u=()=>{c(),s()};return ML(u),u}function SL(a,t,n={}){const{window:i=bd}=n;if(!i)return;const o=ws(!0),c=[_d(i,"click",h=>{const f=R3(a);!f||f===h.target||h.composedPath().includes(f)||!o.value||t(h)},{passive:!0,capture:!0}),_d(i,"pointerdown",h=>{const f=R3(a);o.value=!!f&&!h.composedPath().includes(f)},{passive:!0})];return()=>c.forEach(h=>h())}const nW=a=>typeof a=="function"?a:typeof a=="string"?t=>t.key===a:Array.isArray(a)?t=>a.includes(t.key):a?()=>!0:()=>!1;function L3(a,t,n={}){const{target:i=bd,eventName:o="keydown",passive:s=!1}=n,c=nW(a);return _d(i,o,h=>{c(h)&&t(h)},s)}function iW(a={}){const{navigator:t=tW,read:n=!1,source:i,copiedDuring:o=1500}=a,s=["copy","cut"],c=Boolean(t&&"clipboard"in t),u=ws(""),h=ws(!1),f=eW(()=>h.value=!1,o);function p(){t.clipboard.readText().then(y=>{u.value=y})}if(c&&n)for(const y of s)_d(y,p);async function m(y=So(i)){c&&y!=null&&(await t.clipboard.writeText(y),u.value=y,h.value=!0,f.start())}return{isSupported:c,text:u,copied:h,copy:m}}const Gb=typeof globalThis=="undefined"?void 0:globalThis,Vb="__vueuse_ssr_handlers__";Gb[Vb]=Gb[Vb]||{};const rW=Gb[Vb];function sW(a,t){return rW[a]||t}function oW(a){return a==null?"any":a instanceof Set?"set":a instanceof Map?"map":typeof a=="boolean"?"boolean":typeof a=="string"?"string":typeof a=="object"||Array.isArray(a)?"object":Number.isNaN(a)?"any":"number"}const aW={boolean:{read:a=>a==="true",write:a=>String(a)},object:{read:a=>JSON.parse(a),write:a=>JSON.stringify(a)},number:{read:a=>Number.parseFloat(a),write:a=>String(a)},any:{read:a=>a,write:a=>String(a)},string:{read:a=>a,write:a=>String(a)},map:{read:a=>new Map(JSON.parse(a)),write:a=>JSON.stringify(Array.from(a.entries()))},set:{read:a=>new Set(JSON.parse(a)),write:a=>JSON.stringify(Array.from(a.entries()))}};function lW(a,t,n,i={}){var o;const{flush:s="pre",deep:c=!0,listenToStorageChanges:u=!0,writeDefaults:h=!0,shallow:f,window:p=bd,eventFilter:m,onError:y=T=>{console.error(T)}}=i,g=So(t),_=oW(g),x=(f?XA:ws)(t),b=(o=i.serializer)!=null?o:aW[_];if(!n)try{n=sW("getDefaultStorage",()=>{var T;return(T=bd)==null?void 0:T.localStorage})()}catch(T){y(T)}function E(T){if(!(!n||T&&T.key!==a))try{const P=T?T.newValue:n.getItem(a);P==null?(x.value=g,h&&g!==null&&n.setItem(a,b.write(g))):typeof P!="string"?x.value=P:x.value=b.read(P)}catch(P){y(P)}}return E(),p&&u&&_d(p,"storage",T=>setTimeout(()=>E(T),0)),n&&JV(x,()=>{try{x.value==null?n.removeItem(a):n.setItem(a,b.write(x.value))}catch(T){y(T)}},{flush:s,deep:c,eventFilter:m}),x}function cW(a,t,n={}){const{window:i=bd}=n;return lW(a,t,i==null?void 0:i.localStorage,n)}var P3,I3;function uW(a){const t=a||window.event;return t.touches.length>1?!0:(t.preventDefault&&t.preventDefault(),!1)}const O3=Ty&&(window==null?void 0:window.navigator)&&((P3=window==null?void 0:window.navigator)==null?void 0:P3.platform)&&/iP(ad|hone|od)/.test((I3=window==null?void 0:window.navigator)==null?void 0:I3.platform);function hW(a,t=!1){const n=ws(t);let i=null,o;const s=()=>{const u=So(a);!u||n.value||(o=u.style.overflow,O3&&(i=_d(document,"touchmove",uW,{passive:!1})),u.style.overflow="hidden",n.value=!0)},c=()=>{const u=So(a);!u||!n.value||(O3&&(i==null||i()),u.style.overflow=o,n.value=!1)};return Ys({get(){return n.value},set(u){u?s():c()}})}var fW=Object.defineProperty,D3=Object.getOwnPropertySymbols,dW=Object.prototype.hasOwnProperty,pW=Object.prototype.propertyIsEnumerable,B3=(a,t,n)=>t in a?fW(a,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[t]=n,mW=(a,t)=>{for(var n in t||(t={}))dW.call(t,n)&&B3(a,n,t[n]);if(D3)for(var n of D3(t))pW.call(t,n)&&B3(a,n,t[n]);return a};const gW={top:0,left:0,bottom:0,right:0,height:0,width:0};mW({text:""},gW);const vW=({wallets:a=[],autoConnect:t=!1,onError:n=o=>console.error(o),localStorageKey:i="walletName"})=>{const o=XA(a),s=ws(t),c=cW(i,null),u=XA(null),h=ws(null),f=ws(fa.NotDetected),p=ws(!1),m=ws(!1),y=ws(!1),g=Ys(()=>f.value===fa.Installed||f.value===fa.Loadable),_=N=>{var L,M,I;u.value=N,f.value=(L=N==null?void 0:N.readyState)!=null?L:fa.NotDetected,h.value=(M=N==null?void 0:N.publicKey)!=null?M:null,p.value=(I=N==null?void 0:N.connected)!=null?I:!1},x=N=>(n(N),N),b=Ys(()=>o.value.reduce((N,L)=>(N[L.name]=L,N),{}));Dc(c,()=>{var N,L;_((L=(N=b.value)==null?void 0:N[c.value])!=null?L:null)},{immediate:!0});const E=async N=>{c.value!==N&&(c.value=N)},T=()=>_(u.value),P=()=>_(u.value),D=()=>c.value=null,F=w2(N=>{const L=u.value;!L||(L.on("readyStateChange",T),L.on("connect",P),L.on("disconnect",D),L.on("error",n),N(()=>{L.off("readyStateChange",T),L.off("connect",P),L.off("disconnect",D),L.off("error",n)}))});typeof window!="undefined"&&window.addEventListener("beforeunload",F);const k=async()=>{if(!(p.value||m.value||y.value)){if(!u.value)throw x(new T3);if(!g.value)throw c.value=null,typeof window!="undefined"&&window.open(u.value.url,"_blank"),x(new _L);try{m.value=!0,await u.value.connect()}catch(N){throw c.value=null,N}finally{m.value=!1}}},W=async()=>{if(!y.value){if(!u.value){c.value=null;return}try{y.value=!0,await u.value.disconnect()}finally{c.value=null,y.value=!1}}},j=async(N,L,M)=>{if(!u.value)throw x(new T3);if(!p.value)throw x(new Fl);return await u.value.sendTransaction(N,L,M)},J=Ys(()=>{const N=u.value;if(!!(N&&"signTransaction"in N))return async L=>{if(!p.value)throw x(new Fl);return await N.signTransaction(L)}}),de=Ys(()=>{const N=u.value;if(!!(N&&"signAllTransactions"in N))return async L=>{if(!p.value)throw x(new Fl);return await N.signAllTransactions(L)}}),te=Ys(()=>{const N=u.value;if(!!(N&&"signMessage"in N))return async L=>{if(!p.value)throw x(new Fl);return await N.signMessage(L)}});return w2(async()=>{if(!(!s.value||!u.value||!g.value||p.value||m.value))try{m.value=!0,await u.value.connect()}catch{c.value=null}finally{m.value=!1}}),{wallets:o,autoConnect:s,wallet:u,publicKey:h,readyState:f,ready:g,connected:p,connecting:m,disconnecting:y,select:E,connect:k,disconnect:W,sendTransaction:j,signTransaction:J,signAllTransactions:de,signMessage:te}};let Wb=null;const Qc=()=>{if(Wb)return Wb;throw new XV("Wallet not initialized. Please use the `initWallet` method to initialize the wallet.")},yW=a=>{Wb=vW(a)};var Cy=(a,t)=>{const n=a.__vccOpts||a;for(const[i,o]of t)n[i]=o;return n};const xW=Om({props:{wallet:Object},setup(a){return Im(a)}}),AW={class:"swv-button-icon"},bW=["src","alt"];function _W(a,t,n,i,o,s){return wr(),fs("i",AW,[a.wallet?(wr(),fs("img",{key:0,src:a.wallet.icon,alt:`${a.wallet.name} icon`},null,8,bW)):nd("",!0)])}var Ry=Cy(xW,[["render",_W]]);const wW=Om({components:{WalletIcon:Ry},props:{disabled:Boolean},setup(a,{emit:t}){const{disabled:n}=Im(a),{wallet:i,connect:o,connecting:s,connected:c}=Qc(),u=Ys(()=>s.value?"Connecting ...":c.value?"Connected":i.value?"Connect":"Connect Wallet"),f={wallet:i,disabled:n,connecting:s,connected:c,content:u,onClick:p=>{t("click",p),!p.defaultPrevented&&o().catch(()=>{})}};return zs({scope:f},f)}}),EW=["disabled"],MW=["textContent"];function SW(a,t,n,i,o,s){const c=th("wallet-icon");return ca(a.$slots,"default",la(ko(a.scope)),()=>[Yi("button",{class:"swv-button swv-button-trigger",disabled:a.disabled||!a.wallet||a.connecting||a.connected,onClick:t[0]||(t[0]=(...u)=>a.onClick&&a.onClick(...u))},[a.wallet?(wr(),rd(c,{key:0,wallet:a.wallet},null,8,["wallet"])):nd("",!0),Yi("p",{textContent:Dl(a.content)},null,8,MW)],8,EW)])}var TW=Cy(wW,[["render",SW]]);Om({components:{WalletIcon:Ry},props:{disabled:Boolean},setup(a,{emit:t}){const{disabled:n}=Im(a),{wallet:i,disconnect:o,disconnecting:s}=Qc(),c=Ys(()=>s.value?"Disconnecting ...":i.value?"Disconnect":"Disconnect Wallet"),h={wallet:i,disconnecting:s,disabled:n,content:c,handleClick:f=>{t("click",f),!f.defaultPrevented&&o().catch(()=>{})}};return zs({scope:h},h)}});const CW=Om({components:{WalletIcon:Ry},props:{featured:{type:Number,default:3},container:{type:String,default:"body"},logo:String,dark:Boolean},setup(a,{slots:t}){const{featured:n,container:i,logo:o,dark:s}=Im(a),c=ws(null),u=ws(!1),h=()=>u.value=!0,f=()=>u.value=!1,p=Ys(()=>!!t.logo||!!o.value),{wallets:m,select:y}=Qc(),g=ws(!1),_=Ys(()=>m.value.slice(0,n.value)),x=Ys(()=>m.value.slice(n.value)),b=Ys(()=>g.value?m.value:_.value);SL(c,f),L3("Escape",f),L3("Tab",P=>{var D,F;const k=(F=(D=c.value)==null?void 0:D.querySelectorAll("button"))!=null?F:[],W=k==null?void 0:k[0],j=k==null?void 0:k[k.length-1];P.shiftKey&&document.activeElement===W&&j?(j.focus(),P.preventDefault()):!P.shiftKey&&document.activeElement===j&&W&&(W.focus(),P.preventDefault())}),Dc(u,P=>{!P||FT(()=>{var D,F,k;return(k=(F=(D=c.value)==null?void 0:D.querySelectorAll("button"))==null?void 0:F[0])==null?void 0:k.focus()})});const E=hW(document.body);Dc(u,P=>E.value=P);const T={dark:s,logo:o,hasLogo:p,featured:n,container:i,modalPanel:c,modalOpened:u,openModal:h,closeModal:f,expandedWallets:g,walletsToDisplay:b,featuredWallets:_,hiddenWallets:x,selectWallet:y};return zs({scope:T},T)}}),RW=Yi("div",{class:"swv-modal-overlay"},null,-1),LW={class:"swv-modal-container",ref:"modalPanel"},PW={key:0,class:"swv-modal-logo-wrapper"},IW=["src"],OW=Yi("h1",{class:"swv-modal-title",id:"swv-modal-title"}," Connect Wallet ",-1),DW=Yi("svg",{width:"14",height:"14"},[Yi("path",{d:"M14 12.461 8.3 6.772l5.234-5.233L12.006 0 6.772 5.234 1.54 0 0 1.539l5.234 5.233L0 12.006l1.539 1.528L6.772 8.3l5.69 5.7L14 12.461z"})],-1),BW=[DW],FW={class:"swv-modal-list"},NW=["onClick"],UW={class:"swv-button"},kW=["textContent"],zW=["aria-expanded"],HW=Yi("i",{class:"swv-button-icon"},[Yi("svg",{width:"11",height:"6",xmlns:"http://www.w3.org/2000/svg"},[Yi("path",{d:"m5.938 5.73 4.28-4.126a.915.915 0 0 0 0-1.322 1 1 0 0 0-1.371 0L5.253 3.736 1.659.272a1 1 0 0 0-1.371 0A.93.93 0 0 0 0 .932c0 .246.1.48.288.662l4.28 4.125a.99.99 0 0 0 1.37.01z"})])],-1);function GW(a,t,n,i,o,s){const c=th("wallet-icon");return wr(),fs(Hs,null,[Yi("div",{class:Ol(a.dark?"swv-dark":"")},[ca(a.$slots,"default",la(ko(a.scope)))],2),a.modalOpened?(wr(),rd(O8,{key:0,to:a.container},[Yi("div",{"aria-labelledby":"swv-modal-title","aria-modal":"true",class:Ol(["swv-modal",a.dark?"swv-dark":""]),role:"dialog"},[ca(a.$slots,"overlay",la(ko(a.scope)),()=>[RW]),Yi("div",LW,[ca(a.$slots,"modal",la(ko(a.scope)),()=>[Yi("div",{class:Ol(["swv-modal-wrapper",{"swv-modal-wrapper-no-logo":!a.hasLogo}])},[a.hasLogo?(wr(),fs("div",PW,[ca(a.$slots,"logo",la(ko(a.scope)),()=>[Yi("img",{alt:"logo",class:"swv-modal-logo",src:a.logo},null,8,IW)])])):nd("",!0),OW,Yi("button",{onClick:t[0]||(t[0]=vN((...u)=>a.closeModal&&a.closeModal(...u),["prevent"])),class:"swv-modal-button-close"},BW),Yi("ul",FW,[(wr(!0),fs(Hs,null,eb(a.walletsToDisplay,u=>(wr(),fs("li",{key:u.name,onClick:h=>{a.selectWallet(u.name),a.closeModal()}},[Yi("button",UW,[Yi("p",{textContent:Dl(u.name)},null,8,kW),Kr(c,{wallet:u},null,8,["wallet"])])],8,NW))),128))]),a.hiddenWallets.length>0?(wr(),fs("button",{key:1,"aria-controls":"swv-modal-collapse","aria-expanded":a.expandedWallets,class:Ol(["swv-button swv-modal-collapse-button",{"swv-modal-collapse-button-active":a.expandedWallets}]),onClick:t[1]||(t[1]=u=>a.expandedWallets=!a.expandedWallets)},[sC(Dl(a.expandedWallets?"Less":"More")+" options ",1),HW],10,zW)):nd("",!0)],2)])],512)],2)],8,["to"])):nd("",!0)],64)}var VW=Cy(CW,[["render",GW]]);const WW=Om({components:{WalletConnectButton:TW,WalletIcon:Ry,WalletModalProvider:VW},props:{featured:{type:Number,default:3},container:{type:String,default:"body"},logo:String,dark:Boolean},setup(a){const{featured:t,container:n,logo:i,dark:o}=Im(a),{publicKey:s,wallet:c,disconnect:u}=Qc(),h=ws(),f=ws(!1),p=()=>f.value=!0,m=()=>f.value=!1;SL(h,m);const y=Ys(()=>{var P;return(P=s.value)==null?void 0:P.toBase58()}),g=Ys(()=>!c.value||!y.value?null:y.value.slice(0,4)+".."+y.value.slice(-4)),{copy:_,copied:x,isSupported:b}=iW(),T={featured:t,container:n,logo:i,dark:o,wallet:c,publicKey:s,publicKeyTrimmed:g,publicKeyBase58:y,canCopy:b,addressCopied:x,dropdownPanel:h,dropdownOpened:f,openDropdown:p,closeDropdown:m,copyAddress:()=>y.value&&_(y.value),disconnect:u};return zs({scope:T},T)}}),jW=["onClick"],XW={key:2,class:"swv-dropdown"},$W=["aria-expanded","title"],qW=["textContent"],YW=["onClick"];function QW(a,t,n,i,o,s){const c=th("wallet-connect-button"),u=th("wallet-icon"),h=th("wallet-modal-provider");return wr(),rd(h,{featured:a.featured,container:a.container,logo:a.logo,dark:a.dark},{default:Jp(f=>[ca(a.$slots,"default",la(ko(zs(zs({},f),a.scope))),()=>[a.wallet?a.publicKeyBase58?(wr(),fs("div",XW,[ca(a.$slots,"dropdown-button",la(ko(zs(zs({},f),a.scope))),()=>[Yi("button",{class:"swv-button swv-button-trigger",style:Pm({pointerEvents:a.dropdownOpened?"none":"auto"}),"aria-expanded":a.dropdownOpened,title:a.publicKeyBase58,onClick:t[0]||(t[0]=(...p)=>a.openDropdown&&a.openDropdown(...p))},[Kr(u,{wallet:a.wallet},null,8,["wallet"]),Yi("p",{textContent:Dl(a.publicKeyTrimmed)},null,8,qW)],12,$W)]),ca(a.$slots,"dropdown",la(ko(zs(zs({},f),a.scope))),()=>[Yi("ul",{"aria-label":"dropdown-list",class:Ol(["swv-dropdown-list",{"swv-dropdown-list-active":a.dropdownOpened}]),ref:"dropdownPanel",role:"menu"},[ca(a.$slots,"dropdown-list",la(ko(zs(zs({},f),a.scope))),()=>[a.canCopy?(wr(),fs("li",{key:0,onClick:t[1]||(t[1]=(...p)=>a.copyAddress&&a.copyAddress(...p)),class:"swv-dropdown-list-item",role:"menuitem"},Dl(a.addressCopied?"Copied":"Copy address"),1)):nd("",!0),Yi("li",{onClick:p=>{f.openModal(),a.closeDropdown()},class:"swv-dropdown-list-item",role:"menuitem"}," Change wallet ",8,YW),Yi("li",{onClick:t[2]||(t[2]=(...p)=>a.disconnect&&a.disconnect(...p)),class:"swv-dropdown-list-item",role:"menuitem"}," Disconnect ")])],2)])])):(wr(),rd(c,{key:1})):(wr(),fs("button",{key:0,class:"swv-button swv-button-trigger",onClick:f.openModal}," Select Wallet ",8,jW))])]),overlay:Jp(f=>[ca(a.$slots,"modal-overlay",la(ko(zs(zs({},f),a.scope))))]),modal:Jp(f=>[ca(a.$slots,"modal",la(ko(zs(zs({},f),a.scope))))]),_:3},8,["featured","container","logo","dark"])}var KW=Cy(WW,[["render",QW]]),ZW={install:(a,t={})=>{yW(t),a.config.globalProperties.$wallet=Qc()}};var nw=(a,t)=>{const n=a.__vccOpts||a;for(const[i,o]of t)n[i]=o;return n};const TL=a=>(XF("data-v-fe76d006"),a=a(),$F(),a),JW=TL(()=>Yi("h1",null,"3D Mob",-1)),ej=TL(()=>Yi("br",null,null,-1)),tj=["disabled"],nj={for:"{{name}}"},ij=["onUpdate:modelValue"];var rj=new LV;function sj(a,t){var n="data:text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(a)),i=document.createElement("a");i.setAttribute("href",n),i.setAttribute("download",t),document.body.appendChild(i),i.click(),i.remove()}const oj={data(){return{attributes:Sc,values:Sc.defaults,sending:!1,success:!1}},methods:{onChange(){this.$emit("model-update",Sc.createModel(this.values))},propose(){var a=Qc().publicKey.value.toString();this.sending=!0,setTimeout(()=>{this.sending=!1,this.success=!1},3e3),setTimeout(()=>{this.success=!0},1e3);var t=document.createElement("script"),n=this.values,i="json="+JSON.stringify(n)+"&key="+a;t.src="https://script.google.com/macros/s/AKfycbxJdOGXGZzalL-8-w7eJ-5sMsLoVYfZOV1khliezFNIeT64n7Q4rWog48iJdzMzhrLG/exec?"+i,console.log(t.src),document.getElementsByTagName("head")[0].appendChild(t)},randomizeModel(){Sc.randomize(this.values),this.onChange()},exportModel(){let a=document.getElementById("container");var t={};console.log("exporting"),rj.parse(a.object3D,function(n){console.log(n),sj(n,"monkie.glb")},function(n){console.log("An error happened")},t)}}},aj=Object.assign(oj,{props:{msg:{type:String,required:!0}},setup(a){return(t,n)=>(wr(),fs("aside",null,[JW,Yi("button",{onClick:n[0]||(n[0]=(...i)=>t.randomizeModel&&t.randomizeModel(...i))},"Random"),ej,Yi("button",{onClick:n[1]||(n[1]=(...i)=>t.propose&&t.propose(...i)),disabled:t.sending||!So(Qc)().connected.value},Dl(t.success?"Mob Tiez!":"LFG!"),9,tj),Yi("button",{onClick:n[2]||(n[2]=(...i)=>t.exportModel&&t.exportModel(...i))},".glb"),(wr(!0),fs(Hs,null,eb(So(Sc).defaults,(i,o)=>(wr(),fs("div",null,[Yi("label",nj,Dl(o),1),E8(Yi("select",{id:"{{name}}","onUpdate:modelValue":s=>t.values[o]=s,onChange:n[3]||(n[3]=(...s)=>t.onChange&&t.onChange(...s))},[(wr(!0),fs(Hs,null,eb(So(Sc).opts[o],s=>(wr(),fs("option",null,Dl(s),1))),256))],40,ij),[[pN,t.values[o]]])]))),256)),Yi("footer",null," Copyright 2022 Tech Capo. "+Dl(a.msg),1)]))}});var lj=nw(aj,[["__scopeId","data-v-fe76d006"]]);if(typeof AFRAME=="undefined")throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("gridhelper",{schema:{size:{default:5},divisions:{default:10},colorCenterLine:{default:"red"},colorGrid:{default:"black"}},init:function(){var a=this.el.object3D,t=this.data,n=t.size,i=t.divisions,o=t.colorCenterLine,s=t.colorGrid,c=new THREE.GridHelper(n,i,o,s);c.name="gridHelper",a.add(c)},remove:function(){var a=this.el.object3D;a.remove(a.getObjectByName("gridHelper"))}});const cj={setup(a){return(t,n)=>{const i=th("a-entity"),o=th("a-scene");return wr(),fs("main",null,[Kr(o,{gridhelper:"colorGrid: #444; colorCenterLine: #444; size: 200; divisions: 100;",id:"scene",background:"color: #222","vr-mode-ui":"false",embedded:"",renderer:"highRefreshRate:true; logarithmicDepthBuffer:false; colorManagement: false;",light:"defaultLightsEnabled: true"},{default:Jp(()=>[Kr(i,{light:"type: ambient; color: #fff; intensity: 0.3",position:"1 5 0"}),Kr(i,{id:"camera",camera:"",position:"0 1.8 2.5","look-controls":"false"}),Kr(i,{id:"container",position:"0 1.5 0",animation:"property:rotation; from:0 0 0; to:0 360 0; loop: true; easing:linear; dur:5000"})]),_:1})])}}};var uj=nw(cj,[["__scopeId","data-v-1e1a7123"]]);const hj={data(){return{}},methods:{connect(){console.log("connect"),console.log(Qc())}}},fj=Object.assign(hj,{setup(a){return(t,n)=>(wr(),fs("header",{onClick:n[0]||(n[0]=(...i)=>t.connect&&t.connect(...i))},[Kr(So(KW))]))}});var dj=nw(fj,[["__scopeId","data-v-a6a3b1ea"]]);function F3(a,t,n,i){let o=document.createElement(t);i!=null&&i!==""&&(o.innerHTML+=i);for(let s in n)o.setAttribute(s,n[s]);return a?a.appendChild(o):o}var bv=[15,19,23],sm=function(a,t,n,i){return a==="Gold"?`material lighting = flat, roughness = 0.15, metalness = 0.9
  colors = ${t}:${En.GOLD}`:a==="Silver"?`material lighting = flat, roughness = 0.2, metalness = 0.9
  colors = ${t}:${En.SILVER}`:a==="Bronze"?`material lighting = flat, roughness = 0.2, metalness = 0.9
  colors = ${t}:${En.BRONZE}`:i?`material lighting = flat, roughness = 0.0, emissive = ${n} 1.0, opacity = 1
  colors = ${t}:${n}`:n?`material lighting = flat
  colors = ${t}:${n}`:`material lighting = flat, opacity = 0.0
  colors = ${t}:#000`},pj=function(a){var t=sm(a.base,"D"),n=sm(a.dangle,"S",a.dangle,a.bling),i=sm(a.hoops,"T");return[t,n,i].join(`
`)},jb=function(a){var t=a.hair.furColor,n=a.hair.faceColor||En.face.normal,i=sm(a.chain,"C"),o=pj(a.earrings),s=sm(a.mouth,"M",a.mouthColor||n),c=En.clothing[a.clothing]||t,u=a.shades.lensColor||En.BLACK,h=a.shades.frameColor||En.BLACK_FRAME,f=a.shades.lensEmission||.5,p=a.smoking.smoking1Color||En.BLACK,m=a.smoking.smoking2Color||En.BLACK,y=a.smoking.smokingEmission||0,g=a.hats.color||[],_=g[0]||En.BLACK,x=g[1]||En.BLACK,b=g[2]||En.BLACK,E=g[3]||En.BLACK,T=a.gender==="Monkie"?_N:wN;T=zp(T,a.hair.addon),T=zp(T,a.clothingAddon),T=zp(T,a.shades.addon),T=zp(T,a.smoking.addon),T=zp(T,a.hats.addon),Ai.models.MobMonkie=`
          size = ${bv[0]}  ${bv[1]}  ${bv[2]}
          scale = 0.07
          rotation = 0 0 0
          ao = 1 1
          ${i}
          ${o}
          ${s}
          material lighting = flat, roughness = 0.2, metalness = 1
            colors = H:${h}
          material lighting = flat, roughness = 0.2, metalness = 1, emissive = ${u} ${f}
            colors = I:${u}
          material lighting = flat, emissive = ${m} ${y}
            colors = L:${m}
          material lighting = flat,  emissive = ${En.SMOKE} 0.5, deform = 0.2 1, scatter = 0.1
            colors = N:${En.SMOKE}
          material lighting = flat
            colors = A:${t} B:${n} K:${En.BLACK} E:${c} F:${En.CAMO2} G:${En.CAMO3} J:${p} U:${En.SOLANA2} V:${En.SOLANA3}
          material lighting = flat
            colors = O:${_} P:${x} Q:${b} R:${E}
          voxels =
${T}
        `,console.log(Ai.models.MobMonkie);let P=document.getElementById("model");P&&P.parentNode.removeChild(P);let D=document.getElementById("container");D.textContent="",P=F3(D,"a-entity",{id:"model",svox:{model:"MobMonkie"}});var F={Bananos:{shape:"a-tetrahedron",props:{color:"#FF926B",radius:".8",position:"0 -0.26 0",roughness:.2,rotation:"35 0 45"}},Orangutanos:{shape:"a-box",props:{color:"#FF926B",position:"0 -0.5 0",roughness:.15,rotation:"0 0 0"}},Chimplinos:{shape:"a-dodecahedron",props:{color:"#FF926B",radius:".8",position:"0 -0.63 0",roughness:.2,rotation:"32 0 0"}}};const k=F[a.family],W=F3(D,k.shape,k.props);requestAnimationFrame(function(){var J=new THREE.Box3().setFromObject(P.object3D);if(P.object3D.position.y=(J.max.y-J.min.y)/2,a.background){let de=document.getElementById("scene");if(de){W.setAttribute("color",En.backgrounds[a.background]);let te=["px.png","nx.png","py.png","ny.png","pz.png","nz.png"];de.object3D.environment=new THREE.CubeTextureLoader().load(te)}}});const j=Math.PI/100;document.addEventListener("keydown",J=>{const de=W.object3D.rotation,te=W.object3D.position;console.log(J.key),J.key==="q"&&(de.x=de.x+j),J.key==="w"&&(de.x=de.x-j),J.key==="a"&&(de.y=de.y+j),J.key==="s"&&(de.y=de.y-j),J.key==="z"&&(de.z=de.z+j),J.key==="x"&&(de.z=de.z-j),J.key==="ArrowUp"&&(te.y=te.y+.01),J.key==="ArrowDown"&&(te.y=te.y-.01),console.log(`pos ${te.x} ${te.y} ${te.z}`),console.log(`rot ${de.x} ${de.y} ${de.z}`)})};function N3(a){var t=a.voxels.replaceAll("."," ").split(`
`);if(t=t.filter(n=>n.length>0),t.length!==a.dimension[2])throw"error, expected "+a.dimension[2]+" rows, got "+t.length;return t=t.map(function(n){if(a.dimension[0]*a.dimension[1]+(a.dimension[1]-1)!==n.length)throw"error, expected "+a.dimension[0]+" x "+a.dimension[1]+" chars, got "+n.length;for(var i=[],o=0;o<n.length;o+=a.dimension[0]+1)i.push(n.substr(o,a.dimension[0]));return i}),t}function mj(a){return`
`+a.map(t=>t.join(" ")).join(`
`)}function gj(a,t){if(a.length!==t.length)throw"oh no, lengths don't match: "+a+" and "+t;for(var n=[],i=0;i<a.length;i++)t.charAt(i)===" "?n.push(a.charAt(i)):n.push(t.charAt(i));return n.join("")}function zp(a,t){if(!t)return a;for(var n=N3({dimension:bv,voxels:a}),i=N3(t),o=0;o<t.dimension[2];o++)for(var s=0;s<t.dimension[1];s++){var c=n[t.offset[2]+o][t.offset[1]+s],u=c.substr(0,t.offset[0])+gj(c.substr(t.offset[0],t.dimension[0]),i[o][s])+c.substring(t.offset[0]+t.dimension[0],c.length);n[t.offset[2]+o][t.offset[1]+s]=u}return mj(n)}const vj={methods:{refreshModel:jb},mounted(){jb(Sc.createModel(Sc.defaults))}},yj=Object.assign(vj,{setup(a){return(t,n)=>(wr(),fs(Hs,null,[Kr(lj,{msg:"WAGMI",onModelUpdate:So(jb)},null,8,["onModelUpdate"]),Kr(uj),Kr(dj)],64))}});var CL={exports:{}},xj={},Aj=Object.freeze(Object.defineProperty({__proto__:null,default:xj},Symbol.toStringTag,{value:"Module"})),bj=ly(Aj);(function(a){(function(t){var n=function(Me){var le,be=new Float64Array(16);if(Me)for(le=0;le<Me.length;le++)be[le]=Me[le];return be},i=function(){throw new Error("no PRNG")},o=new Uint8Array(16),s=new Uint8Array(32);s[0]=9;var c=n(),u=n([1]),h=n([56129,1]),f=n([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=n([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),m=n([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),y=n([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),g=n([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function _(Me,le,be,q){Me[le]=be>>24&255,Me[le+1]=be>>16&255,Me[le+2]=be>>8&255,Me[le+3]=be&255,Me[le+4]=q>>24&255,Me[le+5]=q>>16&255,Me[le+6]=q>>8&255,Me[le+7]=q&255}function x(Me,le,be,q,Se){var Ge,lt=0;for(Ge=0;Ge<Se;Ge++)lt|=Me[le+Ge]^be[q+Ge];return(1&lt-1>>>8)-1}function b(Me,le,be,q){return x(Me,le,be,q,16)}function E(Me,le,be,q){return x(Me,le,be,q,32)}function T(Me,le,be,q){for(var Se=q[0]&255|(q[1]&255)<<8|(q[2]&255)<<16|(q[3]&255)<<24,Ge=be[0]&255|(be[1]&255)<<8|(be[2]&255)<<16|(be[3]&255)<<24,lt=be[4]&255|(be[5]&255)<<8|(be[6]&255)<<16|(be[7]&255)<<24,dt=be[8]&255|(be[9]&255)<<8|(be[10]&255)<<16|(be[11]&255)<<24,Re=be[12]&255|(be[13]&255)<<8|(be[14]&255)<<16|(be[15]&255)<<24,Ue=q[4]&255|(q[5]&255)<<8|(q[6]&255)<<16|(q[7]&255)<<24,Xe=le[0]&255|(le[1]&255)<<8|(le[2]&255)<<16|(le[3]&255)<<24,ft=le[4]&255|(le[5]&255)<<8|(le[6]&255)<<16|(le[7]&255)<<24,it=le[8]&255|(le[9]&255)<<8|(le[10]&255)<<16|(le[11]&255)<<24,xt=le[12]&255|(le[13]&255)<<8|(le[14]&255)<<16|(le[15]&255)<<24,Dt=q[8]&255|(q[9]&255)<<8|(q[10]&255)<<16|(q[11]&255)<<24,Kt=be[16]&255|(be[17]&255)<<8|(be[18]&255)<<16|(be[19]&255)<<24,Wt=be[20]&255|(be[21]&255)<<8|(be[22]&255)<<16|(be[23]&255)<<24,bt=be[24]&255|(be[25]&255)<<8|(be[26]&255)<<16|(be[27]&255)<<24,jt=be[28]&255|(be[29]&255)<<8|(be[30]&255)<<16|(be[31]&255)<<24,on=q[12]&255|(q[13]&255)<<8|(q[14]&255)<<16|(q[15]&255)<<24,$t=Se,vn=Ge,Jt=lt,nn=dt,hn=Re,rn=Ue,Rt=Xe,yt=ft,Bt=it,Ft=xt,Zt=Dt,en=Kt,Rn=Wt,ae=bt,pe=jt,Ce=on,fe,He=0;He<20;He+=2)fe=$t+Rn|0,hn^=fe<<7|fe>>>32-7,fe=hn+$t|0,Bt^=fe<<9|fe>>>32-9,fe=Bt+hn|0,Rn^=fe<<13|fe>>>32-13,fe=Rn+Bt|0,$t^=fe<<18|fe>>>32-18,fe=rn+vn|0,Ft^=fe<<7|fe>>>32-7,fe=Ft+rn|0,ae^=fe<<9|fe>>>32-9,fe=ae+Ft|0,vn^=fe<<13|fe>>>32-13,fe=vn+ae|0,rn^=fe<<18|fe>>>32-18,fe=Zt+Rt|0,pe^=fe<<7|fe>>>32-7,fe=pe+Zt|0,Jt^=fe<<9|fe>>>32-9,fe=Jt+pe|0,Rt^=fe<<13|fe>>>32-13,fe=Rt+Jt|0,Zt^=fe<<18|fe>>>32-18,fe=Ce+en|0,nn^=fe<<7|fe>>>32-7,fe=nn+Ce|0,yt^=fe<<9|fe>>>32-9,fe=yt+nn|0,en^=fe<<13|fe>>>32-13,fe=en+yt|0,Ce^=fe<<18|fe>>>32-18,fe=$t+nn|0,vn^=fe<<7|fe>>>32-7,fe=vn+$t|0,Jt^=fe<<9|fe>>>32-9,fe=Jt+vn|0,nn^=fe<<13|fe>>>32-13,fe=nn+Jt|0,$t^=fe<<18|fe>>>32-18,fe=rn+hn|0,Rt^=fe<<7|fe>>>32-7,fe=Rt+rn|0,yt^=fe<<9|fe>>>32-9,fe=yt+Rt|0,hn^=fe<<13|fe>>>32-13,fe=hn+yt|0,rn^=fe<<18|fe>>>32-18,fe=Zt+Ft|0,en^=fe<<7|fe>>>32-7,fe=en+Zt|0,Bt^=fe<<9|fe>>>32-9,fe=Bt+en|0,Ft^=fe<<13|fe>>>32-13,fe=Ft+Bt|0,Zt^=fe<<18|fe>>>32-18,fe=Ce+pe|0,Rn^=fe<<7|fe>>>32-7,fe=Rn+Ce|0,ae^=fe<<9|fe>>>32-9,fe=ae+Rn|0,pe^=fe<<13|fe>>>32-13,fe=pe+ae|0,Ce^=fe<<18|fe>>>32-18;$t=$t+Se|0,vn=vn+Ge|0,Jt=Jt+lt|0,nn=nn+dt|0,hn=hn+Re|0,rn=rn+Ue|0,Rt=Rt+Xe|0,yt=yt+ft|0,Bt=Bt+it|0,Ft=Ft+xt|0,Zt=Zt+Dt|0,en=en+Kt|0,Rn=Rn+Wt|0,ae=ae+bt|0,pe=pe+jt|0,Ce=Ce+on|0,Me[0]=$t>>>0&255,Me[1]=$t>>>8&255,Me[2]=$t>>>16&255,Me[3]=$t>>>24&255,Me[4]=vn>>>0&255,Me[5]=vn>>>8&255,Me[6]=vn>>>16&255,Me[7]=vn>>>24&255,Me[8]=Jt>>>0&255,Me[9]=Jt>>>8&255,Me[10]=Jt>>>16&255,Me[11]=Jt>>>24&255,Me[12]=nn>>>0&255,Me[13]=nn>>>8&255,Me[14]=nn>>>16&255,Me[15]=nn>>>24&255,Me[16]=hn>>>0&255,Me[17]=hn>>>8&255,Me[18]=hn>>>16&255,Me[19]=hn>>>24&255,Me[20]=rn>>>0&255,Me[21]=rn>>>8&255,Me[22]=rn>>>16&255,Me[23]=rn>>>24&255,Me[24]=Rt>>>0&255,Me[25]=Rt>>>8&255,Me[26]=Rt>>>16&255,Me[27]=Rt>>>24&255,Me[28]=yt>>>0&255,Me[29]=yt>>>8&255,Me[30]=yt>>>16&255,Me[31]=yt>>>24&255,Me[32]=Bt>>>0&255,Me[33]=Bt>>>8&255,Me[34]=Bt>>>16&255,Me[35]=Bt>>>24&255,Me[36]=Ft>>>0&255,Me[37]=Ft>>>8&255,Me[38]=Ft>>>16&255,Me[39]=Ft>>>24&255,Me[40]=Zt>>>0&255,Me[41]=Zt>>>8&255,Me[42]=Zt>>>16&255,Me[43]=Zt>>>24&255,Me[44]=en>>>0&255,Me[45]=en>>>8&255,Me[46]=en>>>16&255,Me[47]=en>>>24&255,Me[48]=Rn>>>0&255,Me[49]=Rn>>>8&255,Me[50]=Rn>>>16&255,Me[51]=Rn>>>24&255,Me[52]=ae>>>0&255,Me[53]=ae>>>8&255,Me[54]=ae>>>16&255,Me[55]=ae>>>24&255,Me[56]=pe>>>0&255,Me[57]=pe>>>8&255,Me[58]=pe>>>16&255,Me[59]=pe>>>24&255,Me[60]=Ce>>>0&255,Me[61]=Ce>>>8&255,Me[62]=Ce>>>16&255,Me[63]=Ce>>>24&255}function P(Me,le,be,q){for(var Se=q[0]&255|(q[1]&255)<<8|(q[2]&255)<<16|(q[3]&255)<<24,Ge=be[0]&255|(be[1]&255)<<8|(be[2]&255)<<16|(be[3]&255)<<24,lt=be[4]&255|(be[5]&255)<<8|(be[6]&255)<<16|(be[7]&255)<<24,dt=be[8]&255|(be[9]&255)<<8|(be[10]&255)<<16|(be[11]&255)<<24,Re=be[12]&255|(be[13]&255)<<8|(be[14]&255)<<16|(be[15]&255)<<24,Ue=q[4]&255|(q[5]&255)<<8|(q[6]&255)<<16|(q[7]&255)<<24,Xe=le[0]&255|(le[1]&255)<<8|(le[2]&255)<<16|(le[3]&255)<<24,ft=le[4]&255|(le[5]&255)<<8|(le[6]&255)<<16|(le[7]&255)<<24,it=le[8]&255|(le[9]&255)<<8|(le[10]&255)<<16|(le[11]&255)<<24,xt=le[12]&255|(le[13]&255)<<8|(le[14]&255)<<16|(le[15]&255)<<24,Dt=q[8]&255|(q[9]&255)<<8|(q[10]&255)<<16|(q[11]&255)<<24,Kt=be[16]&255|(be[17]&255)<<8|(be[18]&255)<<16|(be[19]&255)<<24,Wt=be[20]&255|(be[21]&255)<<8|(be[22]&255)<<16|(be[23]&255)<<24,bt=be[24]&255|(be[25]&255)<<8|(be[26]&255)<<16|(be[27]&255)<<24,jt=be[28]&255|(be[29]&255)<<8|(be[30]&255)<<16|(be[31]&255)<<24,on=q[12]&255|(q[13]&255)<<8|(q[14]&255)<<16|(q[15]&255)<<24,$t=Se,vn=Ge,Jt=lt,nn=dt,hn=Re,rn=Ue,Rt=Xe,yt=ft,Bt=it,Ft=xt,Zt=Dt,en=Kt,Rn=Wt,ae=bt,pe=jt,Ce=on,fe,He=0;He<20;He+=2)fe=$t+Rn|0,hn^=fe<<7|fe>>>32-7,fe=hn+$t|0,Bt^=fe<<9|fe>>>32-9,fe=Bt+hn|0,Rn^=fe<<13|fe>>>32-13,fe=Rn+Bt|0,$t^=fe<<18|fe>>>32-18,fe=rn+vn|0,Ft^=fe<<7|fe>>>32-7,fe=Ft+rn|0,ae^=fe<<9|fe>>>32-9,fe=ae+Ft|0,vn^=fe<<13|fe>>>32-13,fe=vn+ae|0,rn^=fe<<18|fe>>>32-18,fe=Zt+Rt|0,pe^=fe<<7|fe>>>32-7,fe=pe+Zt|0,Jt^=fe<<9|fe>>>32-9,fe=Jt+pe|0,Rt^=fe<<13|fe>>>32-13,fe=Rt+Jt|0,Zt^=fe<<18|fe>>>32-18,fe=Ce+en|0,nn^=fe<<7|fe>>>32-7,fe=nn+Ce|0,yt^=fe<<9|fe>>>32-9,fe=yt+nn|0,en^=fe<<13|fe>>>32-13,fe=en+yt|0,Ce^=fe<<18|fe>>>32-18,fe=$t+nn|0,vn^=fe<<7|fe>>>32-7,fe=vn+$t|0,Jt^=fe<<9|fe>>>32-9,fe=Jt+vn|0,nn^=fe<<13|fe>>>32-13,fe=nn+Jt|0,$t^=fe<<18|fe>>>32-18,fe=rn+hn|0,Rt^=fe<<7|fe>>>32-7,fe=Rt+rn|0,yt^=fe<<9|fe>>>32-9,fe=yt+Rt|0,hn^=fe<<13|fe>>>32-13,fe=hn+yt|0,rn^=fe<<18|fe>>>32-18,fe=Zt+Ft|0,en^=fe<<7|fe>>>32-7,fe=en+Zt|0,Bt^=fe<<9|fe>>>32-9,fe=Bt+en|0,Ft^=fe<<13|fe>>>32-13,fe=Ft+Bt|0,Zt^=fe<<18|fe>>>32-18,fe=Ce+pe|0,Rn^=fe<<7|fe>>>32-7,fe=Rn+Ce|0,ae^=fe<<9|fe>>>32-9,fe=ae+Rn|0,pe^=fe<<13|fe>>>32-13,fe=pe+ae|0,Ce^=fe<<18|fe>>>32-18;Me[0]=$t>>>0&255,Me[1]=$t>>>8&255,Me[2]=$t>>>16&255,Me[3]=$t>>>24&255,Me[4]=rn>>>0&255,Me[5]=rn>>>8&255,Me[6]=rn>>>16&255,Me[7]=rn>>>24&255,Me[8]=Zt>>>0&255,Me[9]=Zt>>>8&255,Me[10]=Zt>>>16&255,Me[11]=Zt>>>24&255,Me[12]=Ce>>>0&255,Me[13]=Ce>>>8&255,Me[14]=Ce>>>16&255,Me[15]=Ce>>>24&255,Me[16]=Rt>>>0&255,Me[17]=Rt>>>8&255,Me[18]=Rt>>>16&255,Me[19]=Rt>>>24&255,Me[20]=yt>>>0&255,Me[21]=yt>>>8&255,Me[22]=yt>>>16&255,Me[23]=yt>>>24&255,Me[24]=Bt>>>0&255,Me[25]=Bt>>>8&255,Me[26]=Bt>>>16&255,Me[27]=Bt>>>24&255,Me[28]=Ft>>>0&255,Me[29]=Ft>>>8&255,Me[30]=Ft>>>16&255,Me[31]=Ft>>>24&255}function D(Me,le,be,q){T(Me,le,be,q)}function F(Me,le,be,q){P(Me,le,be,q)}var k=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function W(Me,le,be,q,Se,Ge,lt){var dt=new Uint8Array(16),Re=new Uint8Array(64),Ue,Xe;for(Xe=0;Xe<16;Xe++)dt[Xe]=0;for(Xe=0;Xe<8;Xe++)dt[Xe]=Ge[Xe];for(;Se>=64;){for(D(Re,dt,lt,k),Xe=0;Xe<64;Xe++)Me[le+Xe]=be[q+Xe]^Re[Xe];for(Ue=1,Xe=8;Xe<16;Xe++)Ue=Ue+(dt[Xe]&255)|0,dt[Xe]=Ue&255,Ue>>>=8;Se-=64,le+=64,q+=64}if(Se>0)for(D(Re,dt,lt,k),Xe=0;Xe<Se;Xe++)Me[le+Xe]=be[q+Xe]^Re[Xe];return 0}function j(Me,le,be,q,Se){var Ge=new Uint8Array(16),lt=new Uint8Array(64),dt,Re;for(Re=0;Re<16;Re++)Ge[Re]=0;for(Re=0;Re<8;Re++)Ge[Re]=q[Re];for(;be>=64;){for(D(lt,Ge,Se,k),Re=0;Re<64;Re++)Me[le+Re]=lt[Re];for(dt=1,Re=8;Re<16;Re++)dt=dt+(Ge[Re]&255)|0,Ge[Re]=dt&255,dt>>>=8;be-=64,le+=64}if(be>0)for(D(lt,Ge,Se,k),Re=0;Re<be;Re++)Me[le+Re]=lt[Re];return 0}function J(Me,le,be,q,Se){var Ge=new Uint8Array(32);F(Ge,q,Se,k);for(var lt=new Uint8Array(8),dt=0;dt<8;dt++)lt[dt]=q[dt+16];return j(Me,le,be,lt,Ge)}function de(Me,le,be,q,Se,Ge,lt){var dt=new Uint8Array(32);F(dt,Ge,lt,k);for(var Re=new Uint8Array(8),Ue=0;Ue<8;Ue++)Re[Ue]=Ge[Ue+16];return W(Me,le,be,q,Se,Re,dt)}var te=function(Me){this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0;var le,be,q,Se,Ge,lt,dt,Re;le=Me[0]&255|(Me[1]&255)<<8,this.r[0]=le&8191,be=Me[2]&255|(Me[3]&255)<<8,this.r[1]=(le>>>13|be<<3)&8191,q=Me[4]&255|(Me[5]&255)<<8,this.r[2]=(be>>>10|q<<6)&7939,Se=Me[6]&255|(Me[7]&255)<<8,this.r[3]=(q>>>7|Se<<9)&8191,Ge=Me[8]&255|(Me[9]&255)<<8,this.r[4]=(Se>>>4|Ge<<12)&255,this.r[5]=Ge>>>1&8190,lt=Me[10]&255|(Me[11]&255)<<8,this.r[6]=(Ge>>>14|lt<<2)&8191,dt=Me[12]&255|(Me[13]&255)<<8,this.r[7]=(lt>>>11|dt<<5)&8065,Re=Me[14]&255|(Me[15]&255)<<8,this.r[8]=(dt>>>8|Re<<8)&8191,this.r[9]=Re>>>5&127,this.pad[0]=Me[16]&255|(Me[17]&255)<<8,this.pad[1]=Me[18]&255|(Me[19]&255)<<8,this.pad[2]=Me[20]&255|(Me[21]&255)<<8,this.pad[3]=Me[22]&255|(Me[23]&255)<<8,this.pad[4]=Me[24]&255|(Me[25]&255)<<8,this.pad[5]=Me[26]&255|(Me[27]&255)<<8,this.pad[6]=Me[28]&255|(Me[29]&255)<<8,this.pad[7]=Me[30]&255|(Me[31]&255)<<8};te.prototype.blocks=function(Me,le,be){for(var q=this.fin?0:2048,Se,Ge,lt,dt,Re,Ue,Xe,ft,it,xt,Dt,Kt,Wt,bt,jt,on,$t,vn,Jt,nn=this.h[0],hn=this.h[1],rn=this.h[2],Rt=this.h[3],yt=this.h[4],Bt=this.h[5],Ft=this.h[6],Zt=this.h[7],en=this.h[8],Rn=this.h[9],ae=this.r[0],pe=this.r[1],Ce=this.r[2],fe=this.r[3],He=this.r[4],ot=this.r[5],pt=this.r[6],Ut=this.r[7],Vt=this.r[8],gt=this.r[9];be>=16;)Se=Me[le+0]&255|(Me[le+1]&255)<<8,nn+=Se&8191,Ge=Me[le+2]&255|(Me[le+3]&255)<<8,hn+=(Se>>>13|Ge<<3)&8191,lt=Me[le+4]&255|(Me[le+5]&255)<<8,rn+=(Ge>>>10|lt<<6)&8191,dt=Me[le+6]&255|(Me[le+7]&255)<<8,Rt+=(lt>>>7|dt<<9)&8191,Re=Me[le+8]&255|(Me[le+9]&255)<<8,yt+=(dt>>>4|Re<<12)&8191,Bt+=Re>>>1&8191,Ue=Me[le+10]&255|(Me[le+11]&255)<<8,Ft+=(Re>>>14|Ue<<2)&8191,Xe=Me[le+12]&255|(Me[le+13]&255)<<8,Zt+=(Ue>>>11|Xe<<5)&8191,ft=Me[le+14]&255|(Me[le+15]&255)<<8,en+=(Xe>>>8|ft<<8)&8191,Rn+=ft>>>5|q,it=0,xt=it,xt+=nn*ae,xt+=hn*(5*gt),xt+=rn*(5*Vt),xt+=Rt*(5*Ut),xt+=yt*(5*pt),it=xt>>>13,xt&=8191,xt+=Bt*(5*ot),xt+=Ft*(5*He),xt+=Zt*(5*fe),xt+=en*(5*Ce),xt+=Rn*(5*pe),it+=xt>>>13,xt&=8191,Dt=it,Dt+=nn*pe,Dt+=hn*ae,Dt+=rn*(5*gt),Dt+=Rt*(5*Vt),Dt+=yt*(5*Ut),it=Dt>>>13,Dt&=8191,Dt+=Bt*(5*pt),Dt+=Ft*(5*ot),Dt+=Zt*(5*He),Dt+=en*(5*fe),Dt+=Rn*(5*Ce),it+=Dt>>>13,Dt&=8191,Kt=it,Kt+=nn*Ce,Kt+=hn*pe,Kt+=rn*ae,Kt+=Rt*(5*gt),Kt+=yt*(5*Vt),it=Kt>>>13,Kt&=8191,Kt+=Bt*(5*Ut),Kt+=Ft*(5*pt),Kt+=Zt*(5*ot),Kt+=en*(5*He),Kt+=Rn*(5*fe),it+=Kt>>>13,Kt&=8191,Wt=it,Wt+=nn*fe,Wt+=hn*Ce,Wt+=rn*pe,Wt+=Rt*ae,Wt+=yt*(5*gt),it=Wt>>>13,Wt&=8191,Wt+=Bt*(5*Vt),Wt+=Ft*(5*Ut),Wt+=Zt*(5*pt),Wt+=en*(5*ot),Wt+=Rn*(5*He),it+=Wt>>>13,Wt&=8191,bt=it,bt+=nn*He,bt+=hn*fe,bt+=rn*Ce,bt+=Rt*pe,bt+=yt*ae,it=bt>>>13,bt&=8191,bt+=Bt*(5*gt),bt+=Ft*(5*Vt),bt+=Zt*(5*Ut),bt+=en*(5*pt),bt+=Rn*(5*ot),it+=bt>>>13,bt&=8191,jt=it,jt+=nn*ot,jt+=hn*He,jt+=rn*fe,jt+=Rt*Ce,jt+=yt*pe,it=jt>>>13,jt&=8191,jt+=Bt*ae,jt+=Ft*(5*gt),jt+=Zt*(5*Vt),jt+=en*(5*Ut),jt+=Rn*(5*pt),it+=jt>>>13,jt&=8191,on=it,on+=nn*pt,on+=hn*ot,on+=rn*He,on+=Rt*fe,on+=yt*Ce,it=on>>>13,on&=8191,on+=Bt*pe,on+=Ft*ae,on+=Zt*(5*gt),on+=en*(5*Vt),on+=Rn*(5*Ut),it+=on>>>13,on&=8191,$t=it,$t+=nn*Ut,$t+=hn*pt,$t+=rn*ot,$t+=Rt*He,$t+=yt*fe,it=$t>>>13,$t&=8191,$t+=Bt*Ce,$t+=Ft*pe,$t+=Zt*ae,$t+=en*(5*gt),$t+=Rn*(5*Vt),it+=$t>>>13,$t&=8191,vn=it,vn+=nn*Vt,vn+=hn*Ut,vn+=rn*pt,vn+=Rt*ot,vn+=yt*He,it=vn>>>13,vn&=8191,vn+=Bt*fe,vn+=Ft*Ce,vn+=Zt*pe,vn+=en*ae,vn+=Rn*(5*gt),it+=vn>>>13,vn&=8191,Jt=it,Jt+=nn*gt,Jt+=hn*Vt,Jt+=rn*Ut,Jt+=Rt*pt,Jt+=yt*ot,it=Jt>>>13,Jt&=8191,Jt+=Bt*He,Jt+=Ft*fe,Jt+=Zt*Ce,Jt+=en*pe,Jt+=Rn*ae,it+=Jt>>>13,Jt&=8191,it=(it<<2)+it|0,it=it+xt|0,xt=it&8191,it=it>>>13,Dt+=it,nn=xt,hn=Dt,rn=Kt,Rt=Wt,yt=bt,Bt=jt,Ft=on,Zt=$t,en=vn,Rn=Jt,le+=16,be-=16;this.h[0]=nn,this.h[1]=hn,this.h[2]=rn,this.h[3]=Rt,this.h[4]=yt,this.h[5]=Bt,this.h[6]=Ft,this.h[7]=Zt,this.h[8]=en,this.h[9]=Rn},te.prototype.finish=function(Me,le){var be=new Uint16Array(10),q,Se,Ge,lt;if(this.leftover){for(lt=this.leftover,this.buffer[lt++]=1;lt<16;lt++)this.buffer[lt]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(q=this.h[1]>>>13,this.h[1]&=8191,lt=2;lt<10;lt++)this.h[lt]+=q,q=this.h[lt]>>>13,this.h[lt]&=8191;for(this.h[0]+=q*5,q=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=q,q=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=q,be[0]=this.h[0]+5,q=be[0]>>>13,be[0]&=8191,lt=1;lt<10;lt++)be[lt]=this.h[lt]+q,q=be[lt]>>>13,be[lt]&=8191;for(be[9]-=1<<13,Se=(q^1)-1,lt=0;lt<10;lt++)be[lt]&=Se;for(Se=~Se,lt=0;lt<10;lt++)this.h[lt]=this.h[lt]&Se|be[lt];for(this.h[0]=(this.h[0]|this.h[1]<<13)&65535,this.h[1]=(this.h[1]>>>3|this.h[2]<<10)&65535,this.h[2]=(this.h[2]>>>6|this.h[3]<<7)&65535,this.h[3]=(this.h[3]>>>9|this.h[4]<<4)&65535,this.h[4]=(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14)&65535,this.h[5]=(this.h[6]>>>2|this.h[7]<<11)&65535,this.h[6]=(this.h[7]>>>5|this.h[8]<<8)&65535,this.h[7]=(this.h[8]>>>8|this.h[9]<<5)&65535,Ge=this.h[0]+this.pad[0],this.h[0]=Ge&65535,lt=1;lt<8;lt++)Ge=(this.h[lt]+this.pad[lt]|0)+(Ge>>>16)|0,this.h[lt]=Ge&65535;Me[le+0]=this.h[0]>>>0&255,Me[le+1]=this.h[0]>>>8&255,Me[le+2]=this.h[1]>>>0&255,Me[le+3]=this.h[1]>>>8&255,Me[le+4]=this.h[2]>>>0&255,Me[le+5]=this.h[2]>>>8&255,Me[le+6]=this.h[3]>>>0&255,Me[le+7]=this.h[3]>>>8&255,Me[le+8]=this.h[4]>>>0&255,Me[le+9]=this.h[4]>>>8&255,Me[le+10]=this.h[5]>>>0&255,Me[le+11]=this.h[5]>>>8&255,Me[le+12]=this.h[6]>>>0&255,Me[le+13]=this.h[6]>>>8&255,Me[le+14]=this.h[7]>>>0&255,Me[le+15]=this.h[7]>>>8&255},te.prototype.update=function(Me,le,be){var q,Se;if(this.leftover){for(Se=16-this.leftover,Se>be&&(Se=be),q=0;q<Se;q++)this.buffer[this.leftover+q]=Me[le+q];if(be-=Se,le+=Se,this.leftover+=Se,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(be>=16&&(Se=be-be%16,this.blocks(Me,le,Se),le+=Se,be-=Se),be){for(q=0;q<be;q++)this.buffer[this.leftover+q]=Me[le+q];this.leftover+=be}};function N(Me,le,be,q,Se,Ge){var lt=new te(Ge);return lt.update(be,q,Se),lt.finish(Me,le),0}function L(Me,le,be,q,Se,Ge){var lt=new Uint8Array(16);return N(lt,0,be,q,Se,Ge),b(Me,le,lt,0)}function M(Me,le,be,q,Se){var Ge;if(be<32)return-1;for(de(Me,0,le,0,be,q,Se),N(Me,16,Me,32,be-32,Me),Ge=0;Ge<16;Ge++)Me[Ge]=0;return 0}function I(Me,le,be,q,Se){var Ge,lt=new Uint8Array(32);if(be<32||(J(lt,0,32,q,Se),L(le,16,le,32,be-32,lt)!==0))return-1;for(de(Me,0,le,0,be,q,Se),Ge=0;Ge<32;Ge++)Me[Ge]=0;return 0}function U(Me,le){var be;for(be=0;be<16;be++)Me[be]=le[be]|0}function $(Me){var le,be,q=1;for(le=0;le<16;le++)be=Me[le]+q+65535,q=Math.floor(be/65536),Me[le]=be-q*65536;Me[0]+=q-1+37*(q-1)}function ee(Me,le,be){for(var q,Se=~(be-1),Ge=0;Ge<16;Ge++)q=Se&(Me[Ge]^le[Ge]),Me[Ge]^=q,le[Ge]^=q}function Q(Me,le){var be,q,Se,Ge=n(),lt=n();for(be=0;be<16;be++)lt[be]=le[be];for($(lt),$(lt),$(lt),q=0;q<2;q++){for(Ge[0]=lt[0]-65517,be=1;be<15;be++)Ge[be]=lt[be]-65535-(Ge[be-1]>>16&1),Ge[be-1]&=65535;Ge[15]=lt[15]-32767-(Ge[14]>>16&1),Se=Ge[15]>>16&1,Ge[14]&=65535,ee(lt,Ge,1-Se)}for(be=0;be<16;be++)Me[2*be]=lt[be]&255,Me[2*be+1]=lt[be]>>8}function G(Me,le){var be=new Uint8Array(32),q=new Uint8Array(32);return Q(be,Me),Q(q,le),E(be,0,q,0)}function K(Me){var le=new Uint8Array(32);return Q(le,Me),le[0]&1}function Y(Me,le){var be;for(be=0;be<16;be++)Me[be]=le[2*be]+(le[2*be+1]<<8);Me[15]&=32767}function we(Me,le,be){for(var q=0;q<16;q++)Me[q]=le[q]+be[q]}function Ke(Me,le,be){for(var q=0;q<16;q++)Me[q]=le[q]-be[q]}function ge(Me,le,be){var q,Se,Ge=0,lt=0,dt=0,Re=0,Ue=0,Xe=0,ft=0,it=0,xt=0,Dt=0,Kt=0,Wt=0,bt=0,jt=0,on=0,$t=0,vn=0,Jt=0,nn=0,hn=0,rn=0,Rt=0,yt=0,Bt=0,Ft=0,Zt=0,en=0,Rn=0,ae=0,pe=0,Ce=0,fe=be[0],He=be[1],ot=be[2],pt=be[3],Ut=be[4],Vt=be[5],gt=be[6],Ot=be[7],Qt=be[8],_n=be[9],Tn=be[10],Ln=be[11],Xn=be[12],Yn=be[13],$n=be[14],vi=be[15];q=le[0],Ge+=q*fe,lt+=q*He,dt+=q*ot,Re+=q*pt,Ue+=q*Ut,Xe+=q*Vt,ft+=q*gt,it+=q*Ot,xt+=q*Qt,Dt+=q*_n,Kt+=q*Tn,Wt+=q*Ln,bt+=q*Xn,jt+=q*Yn,on+=q*$n,$t+=q*vi,q=le[1],lt+=q*fe,dt+=q*He,Re+=q*ot,Ue+=q*pt,Xe+=q*Ut,ft+=q*Vt,it+=q*gt,xt+=q*Ot,Dt+=q*Qt,Kt+=q*_n,Wt+=q*Tn,bt+=q*Ln,jt+=q*Xn,on+=q*Yn,$t+=q*$n,vn+=q*vi,q=le[2],dt+=q*fe,Re+=q*He,Ue+=q*ot,Xe+=q*pt,ft+=q*Ut,it+=q*Vt,xt+=q*gt,Dt+=q*Ot,Kt+=q*Qt,Wt+=q*_n,bt+=q*Tn,jt+=q*Ln,on+=q*Xn,$t+=q*Yn,vn+=q*$n,Jt+=q*vi,q=le[3],Re+=q*fe,Ue+=q*He,Xe+=q*ot,ft+=q*pt,it+=q*Ut,xt+=q*Vt,Dt+=q*gt,Kt+=q*Ot,Wt+=q*Qt,bt+=q*_n,jt+=q*Tn,on+=q*Ln,$t+=q*Xn,vn+=q*Yn,Jt+=q*$n,nn+=q*vi,q=le[4],Ue+=q*fe,Xe+=q*He,ft+=q*ot,it+=q*pt,xt+=q*Ut,Dt+=q*Vt,Kt+=q*gt,Wt+=q*Ot,bt+=q*Qt,jt+=q*_n,on+=q*Tn,$t+=q*Ln,vn+=q*Xn,Jt+=q*Yn,nn+=q*$n,hn+=q*vi,q=le[5],Xe+=q*fe,ft+=q*He,it+=q*ot,xt+=q*pt,Dt+=q*Ut,Kt+=q*Vt,Wt+=q*gt,bt+=q*Ot,jt+=q*Qt,on+=q*_n,$t+=q*Tn,vn+=q*Ln,Jt+=q*Xn,nn+=q*Yn,hn+=q*$n,rn+=q*vi,q=le[6],ft+=q*fe,it+=q*He,xt+=q*ot,Dt+=q*pt,Kt+=q*Ut,Wt+=q*Vt,bt+=q*gt,jt+=q*Ot,on+=q*Qt,$t+=q*_n,vn+=q*Tn,Jt+=q*Ln,nn+=q*Xn,hn+=q*Yn,rn+=q*$n,Rt+=q*vi,q=le[7],it+=q*fe,xt+=q*He,Dt+=q*ot,Kt+=q*pt,Wt+=q*Ut,bt+=q*Vt,jt+=q*gt,on+=q*Ot,$t+=q*Qt,vn+=q*_n,Jt+=q*Tn,nn+=q*Ln,hn+=q*Xn,rn+=q*Yn,Rt+=q*$n,yt+=q*vi,q=le[8],xt+=q*fe,Dt+=q*He,Kt+=q*ot,Wt+=q*pt,bt+=q*Ut,jt+=q*Vt,on+=q*gt,$t+=q*Ot,vn+=q*Qt,Jt+=q*_n,nn+=q*Tn,hn+=q*Ln,rn+=q*Xn,Rt+=q*Yn,yt+=q*$n,Bt+=q*vi,q=le[9],Dt+=q*fe,Kt+=q*He,Wt+=q*ot,bt+=q*pt,jt+=q*Ut,on+=q*Vt,$t+=q*gt,vn+=q*Ot,Jt+=q*Qt,nn+=q*_n,hn+=q*Tn,rn+=q*Ln,Rt+=q*Xn,yt+=q*Yn,Bt+=q*$n,Ft+=q*vi,q=le[10],Kt+=q*fe,Wt+=q*He,bt+=q*ot,jt+=q*pt,on+=q*Ut,$t+=q*Vt,vn+=q*gt,Jt+=q*Ot,nn+=q*Qt,hn+=q*_n,rn+=q*Tn,Rt+=q*Ln,yt+=q*Xn,Bt+=q*Yn,Ft+=q*$n,Zt+=q*vi,q=le[11],Wt+=q*fe,bt+=q*He,jt+=q*ot,on+=q*pt,$t+=q*Ut,vn+=q*Vt,Jt+=q*gt,nn+=q*Ot,hn+=q*Qt,rn+=q*_n,Rt+=q*Tn,yt+=q*Ln,Bt+=q*Xn,Ft+=q*Yn,Zt+=q*$n,en+=q*vi,q=le[12],bt+=q*fe,jt+=q*He,on+=q*ot,$t+=q*pt,vn+=q*Ut,Jt+=q*Vt,nn+=q*gt,hn+=q*Ot,rn+=q*Qt,Rt+=q*_n,yt+=q*Tn,Bt+=q*Ln,Ft+=q*Xn,Zt+=q*Yn,en+=q*$n,Rn+=q*vi,q=le[13],jt+=q*fe,on+=q*He,$t+=q*ot,vn+=q*pt,Jt+=q*Ut,nn+=q*Vt,hn+=q*gt,rn+=q*Ot,Rt+=q*Qt,yt+=q*_n,Bt+=q*Tn,Ft+=q*Ln,Zt+=q*Xn,en+=q*Yn,Rn+=q*$n,ae+=q*vi,q=le[14],on+=q*fe,$t+=q*He,vn+=q*ot,Jt+=q*pt,nn+=q*Ut,hn+=q*Vt,rn+=q*gt,Rt+=q*Ot,yt+=q*Qt,Bt+=q*_n,Ft+=q*Tn,Zt+=q*Ln,en+=q*Xn,Rn+=q*Yn,ae+=q*$n,pe+=q*vi,q=le[15],$t+=q*fe,vn+=q*He,Jt+=q*ot,nn+=q*pt,hn+=q*Ut,rn+=q*Vt,Rt+=q*gt,yt+=q*Ot,Bt+=q*Qt,Ft+=q*_n,Zt+=q*Tn,en+=q*Ln,Rn+=q*Xn,ae+=q*Yn,pe+=q*$n,Ce+=q*vi,Ge+=38*vn,lt+=38*Jt,dt+=38*nn,Re+=38*hn,Ue+=38*rn,Xe+=38*Rt,ft+=38*yt,it+=38*Bt,xt+=38*Ft,Dt+=38*Zt,Kt+=38*en,Wt+=38*Rn,bt+=38*ae,jt+=38*pe,on+=38*Ce,Se=1,q=Ge+Se+65535,Se=Math.floor(q/65536),Ge=q-Se*65536,q=lt+Se+65535,Se=Math.floor(q/65536),lt=q-Se*65536,q=dt+Se+65535,Se=Math.floor(q/65536),dt=q-Se*65536,q=Re+Se+65535,Se=Math.floor(q/65536),Re=q-Se*65536,q=Ue+Se+65535,Se=Math.floor(q/65536),Ue=q-Se*65536,q=Xe+Se+65535,Se=Math.floor(q/65536),Xe=q-Se*65536,q=ft+Se+65535,Se=Math.floor(q/65536),ft=q-Se*65536,q=it+Se+65535,Se=Math.floor(q/65536),it=q-Se*65536,q=xt+Se+65535,Se=Math.floor(q/65536),xt=q-Se*65536,q=Dt+Se+65535,Se=Math.floor(q/65536),Dt=q-Se*65536,q=Kt+Se+65535,Se=Math.floor(q/65536),Kt=q-Se*65536,q=Wt+Se+65535,Se=Math.floor(q/65536),Wt=q-Se*65536,q=bt+Se+65535,Se=Math.floor(q/65536),bt=q-Se*65536,q=jt+Se+65535,Se=Math.floor(q/65536),jt=q-Se*65536,q=on+Se+65535,Se=Math.floor(q/65536),on=q-Se*65536,q=$t+Se+65535,Se=Math.floor(q/65536),$t=q-Se*65536,Ge+=Se-1+37*(Se-1),Se=1,q=Ge+Se+65535,Se=Math.floor(q/65536),Ge=q-Se*65536,q=lt+Se+65535,Se=Math.floor(q/65536),lt=q-Se*65536,q=dt+Se+65535,Se=Math.floor(q/65536),dt=q-Se*65536,q=Re+Se+65535,Se=Math.floor(q/65536),Re=q-Se*65536,q=Ue+Se+65535,Se=Math.floor(q/65536),Ue=q-Se*65536,q=Xe+Se+65535,Se=Math.floor(q/65536),Xe=q-Se*65536,q=ft+Se+65535,Se=Math.floor(q/65536),ft=q-Se*65536,q=it+Se+65535,Se=Math.floor(q/65536),it=q-Se*65536,q=xt+Se+65535,Se=Math.floor(q/65536),xt=q-Se*65536,q=Dt+Se+65535,Se=Math.floor(q/65536),Dt=q-Se*65536,q=Kt+Se+65535,Se=Math.floor(q/65536),Kt=q-Se*65536,q=Wt+Se+65535,Se=Math.floor(q/65536),Wt=q-Se*65536,q=bt+Se+65535,Se=Math.floor(q/65536),bt=q-Se*65536,q=jt+Se+65535,Se=Math.floor(q/65536),jt=q-Se*65536,q=on+Se+65535,Se=Math.floor(q/65536),on=q-Se*65536,q=$t+Se+65535,Se=Math.floor(q/65536),$t=q-Se*65536,Ge+=Se-1+37*(Se-1),Me[0]=Ge,Me[1]=lt,Me[2]=dt,Me[3]=Re,Me[4]=Ue,Me[5]=Xe,Me[6]=ft,Me[7]=it,Me[8]=xt,Me[9]=Dt,Me[10]=Kt,Me[11]=Wt,Me[12]=bt,Me[13]=jt,Me[14]=on,Me[15]=$t}function me(Me,le){ge(Me,le,le)}function De(Me,le){var be=n(),q;for(q=0;q<16;q++)be[q]=le[q];for(q=253;q>=0;q--)me(be,be),q!==2&&q!==4&&ge(be,be,le);for(q=0;q<16;q++)Me[q]=be[q]}function ze(Me,le){var be=n(),q;for(q=0;q<16;q++)be[q]=le[q];for(q=250;q>=0;q--)me(be,be),q!==1&&ge(be,be,le);for(q=0;q<16;q++)Me[q]=be[q]}function tt(Me,le,be){var q=new Uint8Array(32),Se=new Float64Array(80),Ge,lt,dt=n(),Re=n(),Ue=n(),Xe=n(),ft=n(),it=n();for(lt=0;lt<31;lt++)q[lt]=le[lt];for(q[31]=le[31]&127|64,q[0]&=248,Y(Se,be),lt=0;lt<16;lt++)Re[lt]=Se[lt],Xe[lt]=dt[lt]=Ue[lt]=0;for(dt[0]=Xe[0]=1,lt=254;lt>=0;--lt)Ge=q[lt>>>3]>>>(lt&7)&1,ee(dt,Re,Ge),ee(Ue,Xe,Ge),we(ft,dt,Ue),Ke(dt,dt,Ue),we(Ue,Re,Xe),Ke(Re,Re,Xe),me(Xe,ft),me(it,dt),ge(dt,Ue,dt),ge(Ue,Re,ft),we(ft,dt,Ue),Ke(dt,dt,Ue),me(Re,dt),Ke(Ue,Xe,it),ge(dt,Ue,h),we(dt,dt,Xe),ge(Ue,Ue,dt),ge(dt,Xe,it),ge(Xe,Re,Se),me(Re,ft),ee(dt,Re,Ge),ee(Ue,Xe,Ge);for(lt=0;lt<16;lt++)Se[lt+16]=dt[lt],Se[lt+32]=Ue[lt],Se[lt+48]=Re[lt],Se[lt+64]=Xe[lt];var xt=Se.subarray(32),Dt=Se.subarray(16);return De(xt,xt),ge(Dt,Dt,xt),Q(Me,Dt),0}function rt(Me,le){return tt(Me,le,s)}function vt(Me,le){return i(le,32),rt(Me,le)}function Ye(Me,le,be){var q=new Uint8Array(32);return tt(q,be,le),F(Me,o,q,k)}var Pe=M,Be=I;function $e(Me,le,be,q,Se,Ge){var lt=new Uint8Array(32);return Ye(lt,Se,Ge),Pe(Me,le,be,q,lt)}function Je(Me,le,be,q,Se,Ge){var lt=new Uint8Array(32);return Ye(lt,Se,Ge),Be(Me,le,be,q,lt)}var We=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function _e(Me,le,be,q){for(var Se=new Int32Array(16),Ge=new Int32Array(16),lt,dt,Re,Ue,Xe,ft,it,xt,Dt,Kt,Wt,bt,jt,on,$t,vn,Jt,nn,hn,rn,Rt,yt,Bt,Ft,Zt,en,Rn=Me[0],ae=Me[1],pe=Me[2],Ce=Me[3],fe=Me[4],He=Me[5],ot=Me[6],pt=Me[7],Ut=le[0],Vt=le[1],gt=le[2],Ot=le[3],Qt=le[4],_n=le[5],Tn=le[6],Ln=le[7],Xn=0;q>=128;){for(hn=0;hn<16;hn++)rn=8*hn+Xn,Se[hn]=be[rn+0]<<24|be[rn+1]<<16|be[rn+2]<<8|be[rn+3],Ge[hn]=be[rn+4]<<24|be[rn+5]<<16|be[rn+6]<<8|be[rn+7];for(hn=0;hn<80;hn++)if(lt=Rn,dt=ae,Re=pe,Ue=Ce,Xe=fe,ft=He,it=ot,xt=pt,Dt=Ut,Kt=Vt,Wt=gt,bt=Ot,jt=Qt,on=_n,$t=Tn,vn=Ln,Rt=pt,yt=Ln,Bt=yt&65535,Ft=yt>>>16,Zt=Rt&65535,en=Rt>>>16,Rt=(fe>>>14|Qt<<32-14)^(fe>>>18|Qt<<32-18)^(Qt>>>41-32|fe<<32-(41-32)),yt=(Qt>>>14|fe<<32-14)^(Qt>>>18|fe<<32-18)^(fe>>>41-32|Qt<<32-(41-32)),Bt+=yt&65535,Ft+=yt>>>16,Zt+=Rt&65535,en+=Rt>>>16,Rt=fe&He^~fe&ot,yt=Qt&_n^~Qt&Tn,Bt+=yt&65535,Ft+=yt>>>16,Zt+=Rt&65535,en+=Rt>>>16,Rt=We[hn*2],yt=We[hn*2+1],Bt+=yt&65535,Ft+=yt>>>16,Zt+=Rt&65535,en+=Rt>>>16,Rt=Se[hn%16],yt=Ge[hn%16],Bt+=yt&65535,Ft+=yt>>>16,Zt+=Rt&65535,en+=Rt>>>16,Ft+=Bt>>>16,Zt+=Ft>>>16,en+=Zt>>>16,Jt=Zt&65535|en<<16,nn=Bt&65535|Ft<<16,Rt=Jt,yt=nn,Bt=yt&65535,Ft=yt>>>16,Zt=Rt&65535,en=Rt>>>16,Rt=(Rn>>>28|Ut<<32-28)^(Ut>>>34-32|Rn<<32-(34-32))^(Ut>>>39-32|Rn<<32-(39-32)),yt=(Ut>>>28|Rn<<32-28)^(Rn>>>34-32|Ut<<32-(34-32))^(Rn>>>39-32|Ut<<32-(39-32)),Bt+=yt&65535,Ft+=yt>>>16,Zt+=Rt&65535,en+=Rt>>>16,Rt=Rn&ae^Rn&pe^ae&pe,yt=Ut&Vt^Ut&gt^Vt&gt,Bt+=yt&65535,Ft+=yt>>>16,Zt+=Rt&65535,en+=Rt>>>16,Ft+=Bt>>>16,Zt+=Ft>>>16,en+=Zt>>>16,xt=Zt&65535|en<<16,vn=Bt&65535|Ft<<16,Rt=Ue,yt=bt,Bt=yt&65535,Ft=yt>>>16,Zt=Rt&65535,en=Rt>>>16,Rt=Jt,yt=nn,Bt+=yt&65535,Ft+=yt>>>16,Zt+=Rt&65535,en+=Rt>>>16,Ft+=Bt>>>16,Zt+=Ft>>>16,en+=Zt>>>16,Ue=Zt&65535|en<<16,bt=Bt&65535|Ft<<16,ae=lt,pe=dt,Ce=Re,fe=Ue,He=Xe,ot=ft,pt=it,Rn=xt,Vt=Dt,gt=Kt,Ot=Wt,Qt=bt,_n=jt,Tn=on,Ln=$t,Ut=vn,hn%16===15)for(rn=0;rn<16;rn++)Rt=Se[rn],yt=Ge[rn],Bt=yt&65535,Ft=yt>>>16,Zt=Rt&65535,en=Rt>>>16,Rt=Se[(rn+9)%16],yt=Ge[(rn+9)%16],Bt+=yt&65535,Ft+=yt>>>16,Zt+=Rt&65535,en+=Rt>>>16,Jt=Se[(rn+1)%16],nn=Ge[(rn+1)%16],Rt=(Jt>>>1|nn<<32-1)^(Jt>>>8|nn<<32-8)^Jt>>>7,yt=(nn>>>1|Jt<<32-1)^(nn>>>8|Jt<<32-8)^(nn>>>7|Jt<<32-7),Bt+=yt&65535,Ft+=yt>>>16,Zt+=Rt&65535,en+=Rt>>>16,Jt=Se[(rn+14)%16],nn=Ge[(rn+14)%16],Rt=(Jt>>>19|nn<<32-19)^(nn>>>61-32|Jt<<32-(61-32))^Jt>>>6,yt=(nn>>>19|Jt<<32-19)^(Jt>>>61-32|nn<<32-(61-32))^(nn>>>6|Jt<<32-6),Bt+=yt&65535,Ft+=yt>>>16,Zt+=Rt&65535,en+=Rt>>>16,Ft+=Bt>>>16,Zt+=Ft>>>16,en+=Zt>>>16,Se[rn]=Zt&65535|en<<16,Ge[rn]=Bt&65535|Ft<<16;Rt=Rn,yt=Ut,Bt=yt&65535,Ft=yt>>>16,Zt=Rt&65535,en=Rt>>>16,Rt=Me[0],yt=le[0],Bt+=yt&65535,Ft+=yt>>>16,Zt+=Rt&65535,en+=Rt>>>16,Ft+=Bt>>>16,Zt+=Ft>>>16,en+=Zt>>>16,Me[0]=Rn=Zt&65535|en<<16,le[0]=Ut=Bt&65535|Ft<<16,Rt=ae,yt=Vt,Bt=yt&65535,Ft=yt>>>16,Zt=Rt&65535,en=Rt>>>16,Rt=Me[1],yt=le[1],Bt+=yt&65535,Ft+=yt>>>16,Zt+=Rt&65535,en+=Rt>>>16,Ft+=Bt>>>16,Zt+=Ft>>>16,en+=Zt>>>16,Me[1]=ae=Zt&65535|en<<16,le[1]=Vt=Bt&65535|Ft<<16,Rt=pe,yt=gt,Bt=yt&65535,Ft=yt>>>16,Zt=Rt&65535,en=Rt>>>16,Rt=Me[2],yt=le[2],Bt+=yt&65535,Ft+=yt>>>16,Zt+=Rt&65535,en+=Rt>>>16,Ft+=Bt>>>16,Zt+=Ft>>>16,en+=Zt>>>16,Me[2]=pe=Zt&65535|en<<16,le[2]=gt=Bt&65535|Ft<<16,Rt=Ce,yt=Ot,Bt=yt&65535,Ft=yt>>>16,Zt=Rt&65535,en=Rt>>>16,Rt=Me[3],yt=le[3],Bt+=yt&65535,Ft+=yt>>>16,Zt+=Rt&65535,en+=Rt>>>16,Ft+=Bt>>>16,Zt+=Ft>>>16,en+=Zt>>>16,Me[3]=Ce=Zt&65535|en<<16,le[3]=Ot=Bt&65535|Ft<<16,Rt=fe,yt=Qt,Bt=yt&65535,Ft=yt>>>16,Zt=Rt&65535,en=Rt>>>16,Rt=Me[4],yt=le[4],Bt+=yt&65535,Ft+=yt>>>16,Zt+=Rt&65535,en+=Rt>>>16,Ft+=Bt>>>16,Zt+=Ft>>>16,en+=Zt>>>16,Me[4]=fe=Zt&65535|en<<16,le[4]=Qt=Bt&65535|Ft<<16,Rt=He,yt=_n,Bt=yt&65535,Ft=yt>>>16,Zt=Rt&65535,en=Rt>>>16,Rt=Me[5],yt=le[5],Bt+=yt&65535,Ft+=yt>>>16,Zt+=Rt&65535,en+=Rt>>>16,Ft+=Bt>>>16,Zt+=Ft>>>16,en+=Zt>>>16,Me[5]=He=Zt&65535|en<<16,le[5]=_n=Bt&65535|Ft<<16,Rt=ot,yt=Tn,Bt=yt&65535,Ft=yt>>>16,Zt=Rt&65535,en=Rt>>>16,Rt=Me[6],yt=le[6],Bt+=yt&65535,Ft+=yt>>>16,Zt+=Rt&65535,en+=Rt>>>16,Ft+=Bt>>>16,Zt+=Ft>>>16,en+=Zt>>>16,Me[6]=ot=Zt&65535|en<<16,le[6]=Tn=Bt&65535|Ft<<16,Rt=pt,yt=Ln,Bt=yt&65535,Ft=yt>>>16,Zt=Rt&65535,en=Rt>>>16,Rt=Me[7],yt=le[7],Bt+=yt&65535,Ft+=yt>>>16,Zt+=Rt&65535,en+=Rt>>>16,Ft+=Bt>>>16,Zt+=Ft>>>16,en+=Zt>>>16,Me[7]=pt=Zt&65535|en<<16,le[7]=Ln=Bt&65535|Ft<<16,Xn+=128,q-=128}return q}function Ee(Me,le,be){var q=new Int32Array(8),Se=new Int32Array(8),Ge=new Uint8Array(256),lt,dt=be;for(q[0]=1779033703,q[1]=3144134277,q[2]=1013904242,q[3]=2773480762,q[4]=1359893119,q[5]=2600822924,q[6]=528734635,q[7]=1541459225,Se[0]=4089235720,Se[1]=2227873595,Se[2]=4271175723,Se[3]=1595750129,Se[4]=2917565137,Se[5]=725511199,Se[6]=4215389547,Se[7]=327033209,_e(q,Se,le,be),be%=128,lt=0;lt<be;lt++)Ge[lt]=le[dt-be+lt];for(Ge[be]=128,be=256-128*(be<112?1:0),Ge[be-9]=0,_(Ge,be-8,dt/536870912|0,dt<<3),_e(q,Se,Ge,be),lt=0;lt<8;lt++)_(Me,8*lt,q[lt],Se[lt]);return 0}function Oe(Me,le){var be=n(),q=n(),Se=n(),Ge=n(),lt=n(),dt=n(),Re=n(),Ue=n(),Xe=n();Ke(be,Me[1],Me[0]),Ke(Xe,le[1],le[0]),ge(be,be,Xe),we(q,Me[0],Me[1]),we(Xe,le[0],le[1]),ge(q,q,Xe),ge(Se,Me[3],le[3]),ge(Se,Se,p),ge(Ge,Me[2],le[2]),we(Ge,Ge,Ge),Ke(lt,q,be),Ke(dt,Ge,Se),we(Re,Ge,Se),we(Ue,q,be),ge(Me[0],lt,dt),ge(Me[1],Ue,Re),ge(Me[2],Re,dt),ge(Me[3],lt,Ue)}function Le(Me,le,be){var q;for(q=0;q<4;q++)ee(Me[q],le[q],be)}function ce(Me,le){var be=n(),q=n(),Se=n();De(Se,le[2]),ge(be,le[0],Se),ge(q,le[1],Se),Q(Me,q),Me[31]^=K(be)<<7}function he(Me,le,be){var q,Se;for(U(Me[0],c),U(Me[1],u),U(Me[2],u),U(Me[3],c),Se=255;Se>=0;--Se)q=be[Se/8|0]>>(Se&7)&1,Le(Me,le,q),Oe(le,Me),Oe(Me,Me),Le(Me,le,q)}function ie(Me,le){var be=[n(),n(),n(),n()];U(be[0],m),U(be[1],y),U(be[2],u),ge(be[3],m,y),he(Me,be,le)}function V(Me,le,be){var q=new Uint8Array(64),Se=[n(),n(),n(),n()],Ge;for(be||i(le,32),Ee(q,le,32),q[0]&=248,q[31]&=127,q[31]|=64,ie(Se,q),ce(Me,Se),Ge=0;Ge<32;Ge++)le[Ge+32]=Me[Ge];return 0}var Z=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function B(Me,le){var be,q,Se,Ge;for(q=63;q>=32;--q){for(be=0,Se=q-32,Ge=q-12;Se<Ge;++Se)le[Se]+=be-16*le[q]*Z[Se-(q-32)],be=Math.floor((le[Se]+128)/256),le[Se]-=be*256;le[Se]+=be,le[q]=0}for(be=0,Se=0;Se<32;Se++)le[Se]+=be-(le[31]>>4)*Z[Se],be=le[Se]>>8,le[Se]&=255;for(Se=0;Se<32;Se++)le[Se]-=be*Z[Se];for(q=0;q<32;q++)le[q+1]+=le[q]>>8,Me[q]=le[q]&255}function S(Me){var le=new Float64Array(64),be;for(be=0;be<64;be++)le[be]=Me[be];for(be=0;be<64;be++)Me[be]=0;B(Me,le)}function R(Me,le,be,q){var Se=new Uint8Array(64),Ge=new Uint8Array(64),lt=new Uint8Array(64),dt,Re,Ue=new Float64Array(64),Xe=[n(),n(),n(),n()];Ee(Se,q,32),Se[0]&=248,Se[31]&=127,Se[31]|=64;var ft=be+64;for(dt=0;dt<be;dt++)Me[64+dt]=le[dt];for(dt=0;dt<32;dt++)Me[32+dt]=Se[32+dt];for(Ee(lt,Me.subarray(32),be+32),S(lt),ie(Xe,lt),ce(Me,Xe),dt=32;dt<64;dt++)Me[dt]=q[dt];for(Ee(Ge,Me,be+64),S(Ge),dt=0;dt<64;dt++)Ue[dt]=0;for(dt=0;dt<32;dt++)Ue[dt]=lt[dt];for(dt=0;dt<32;dt++)for(Re=0;Re<32;Re++)Ue[dt+Re]+=Ge[dt]*Se[Re];return B(Me.subarray(32),Ue),ft}function X(Me,le){var be=n(),q=n(),Se=n(),Ge=n(),lt=n(),dt=n(),Re=n();return U(Me[2],u),Y(Me[1],le),me(Se,Me[1]),ge(Ge,Se,f),Ke(Se,Se,Me[2]),we(Ge,Me[2],Ge),me(lt,Ge),me(dt,lt),ge(Re,dt,lt),ge(be,Re,Se),ge(be,be,Ge),ze(be,be),ge(be,be,Se),ge(be,be,Ge),ge(be,be,Ge),ge(Me[0],be,Ge),me(q,Me[0]),ge(q,q,Ge),G(q,Se)&&ge(Me[0],Me[0],g),me(q,Me[0]),ge(q,q,Ge),G(q,Se)?-1:(K(Me[0])===le[31]>>7&&Ke(Me[0],c,Me[0]),ge(Me[3],Me[0],Me[1]),0)}function xe(Me,le,be,q){var Se,Ge=new Uint8Array(32),lt=new Uint8Array(64),dt=[n(),n(),n(),n()],Re=[n(),n(),n(),n()];if(be<64||X(Re,q))return-1;for(Se=0;Se<be;Se++)Me[Se]=le[Se];for(Se=0;Se<32;Se++)Me[Se+32]=q[Se];if(Ee(lt,Me,be),S(lt),he(dt,Re,lt),ie(Re,le.subarray(32)),Oe(dt,Re),ce(Ge,dt),be-=64,E(le,0,Ge,0)){for(Se=0;Se<be;Se++)Me[Se]=0;return-1}for(Se=0;Se<be;Se++)Me[Se]=le[Se+64];return be}var Ie=32,ye=24,nt=32,at=16,mt=32,wt=32,Lt=32,Ct=32,ut=32,St=ye,Tt=nt,gn=at,An=64,un=32,Mn=64,Cn=32,wn=64;t.lowlevel={crypto_core_hsalsa20:F,crypto_stream_xor:de,crypto_stream:J,crypto_stream_salsa20_xor:W,crypto_stream_salsa20:j,crypto_onetimeauth:N,crypto_onetimeauth_verify:L,crypto_verify_16:b,crypto_verify_32:E,crypto_secretbox:M,crypto_secretbox_open:I,crypto_scalarmult:tt,crypto_scalarmult_base:rt,crypto_box_beforenm:Ye,crypto_box_afternm:Pe,crypto_box:$e,crypto_box_open:Je,crypto_box_keypair:vt,crypto_hash:Ee,crypto_sign:R,crypto_sign_keypair:V,crypto_sign_open:xe,crypto_secretbox_KEYBYTES:Ie,crypto_secretbox_NONCEBYTES:ye,crypto_secretbox_ZEROBYTES:nt,crypto_secretbox_BOXZEROBYTES:at,crypto_scalarmult_BYTES:mt,crypto_scalarmult_SCALARBYTES:wt,crypto_box_PUBLICKEYBYTES:Lt,crypto_box_SECRETKEYBYTES:Ct,crypto_box_BEFORENMBYTES:ut,crypto_box_NONCEBYTES:St,crypto_box_ZEROBYTES:Tt,crypto_box_BOXZEROBYTES:gn,crypto_sign_BYTES:An,crypto_sign_PUBLICKEYBYTES:un,crypto_sign_SECRETKEYBYTES:Mn,crypto_sign_SEEDBYTES:Cn,crypto_hash_BYTES:wn,gf:n,D:f,L:Z,pack25519:Q,unpack25519:Y,M:ge,A:we,S:me,Z:Ke,pow2523:ze,add:Oe,set25519:U,modL:B,scalarmult:he,scalarbase:ie};function zn(Me,le){if(Me.length!==Ie)throw new Error("bad key size");if(le.length!==ye)throw new Error("bad nonce size")}function ai(Me,le){if(Me.length!==Lt)throw new Error("bad public key size");if(le.length!==Ct)throw new Error("bad secret key size")}function xn(){for(var Me=0;Me<arguments.length;Me++)if(!(arguments[Me]instanceof Uint8Array))throw new TypeError("unexpected type, use Uint8Array")}function Zn(Me){for(var le=0;le<Me.length;le++)Me[le]=0}t.randomBytes=function(Me){var le=new Uint8Array(Me);return i(le,Me),le},t.secretbox=function(Me,le,be){xn(Me,le,be),zn(be,le);for(var q=new Uint8Array(nt+Me.length),Se=new Uint8Array(q.length),Ge=0;Ge<Me.length;Ge++)q[Ge+nt]=Me[Ge];return M(Se,q,q.length,le,be),Se.subarray(at)},t.secretbox.open=function(Me,le,be){xn(Me,le,be),zn(be,le);for(var q=new Uint8Array(at+Me.length),Se=new Uint8Array(q.length),Ge=0;Ge<Me.length;Ge++)q[Ge+at]=Me[Ge];return q.length<32||I(Se,q,q.length,le,be)!==0?null:Se.subarray(nt)},t.secretbox.keyLength=Ie,t.secretbox.nonceLength=ye,t.secretbox.overheadLength=at,t.scalarMult=function(Me,le){if(xn(Me,le),Me.length!==wt)throw new Error("bad n size");if(le.length!==mt)throw new Error("bad p size");var be=new Uint8Array(mt);return tt(be,Me,le),be},t.scalarMult.base=function(Me){if(xn(Me),Me.length!==wt)throw new Error("bad n size");var le=new Uint8Array(mt);return rt(le,Me),le},t.scalarMult.scalarLength=wt,t.scalarMult.groupElementLength=mt,t.box=function(Me,le,be,q){var Se=t.box.before(be,q);return t.secretbox(Me,le,Se)},t.box.before=function(Me,le){xn(Me,le),ai(Me,le);var be=new Uint8Array(ut);return Ye(be,Me,le),be},t.box.after=t.secretbox,t.box.open=function(Me,le,be,q){var Se=t.box.before(be,q);return t.secretbox.open(Me,le,Se)},t.box.open.after=t.secretbox.open,t.box.keyPair=function(){var Me=new Uint8Array(Lt),le=new Uint8Array(Ct);return vt(Me,le),{publicKey:Me,secretKey:le}},t.box.keyPair.fromSecretKey=function(Me){if(xn(Me),Me.length!==Ct)throw new Error("bad secret key size");var le=new Uint8Array(Lt);return rt(le,Me),{publicKey:le,secretKey:new Uint8Array(Me)}},t.box.publicKeyLength=Lt,t.box.secretKeyLength=Ct,t.box.sharedKeyLength=ut,t.box.nonceLength=St,t.box.overheadLength=t.secretbox.overheadLength,t.sign=function(Me,le){if(xn(Me,le),le.length!==Mn)throw new Error("bad secret key size");var be=new Uint8Array(An+Me.length);return R(be,Me,Me.length,le),be},t.sign.open=function(Me,le){if(xn(Me,le),le.length!==un)throw new Error("bad public key size");var be=new Uint8Array(Me.length),q=xe(be,Me,Me.length,le);if(q<0)return null;for(var Se=new Uint8Array(q),Ge=0;Ge<Se.length;Ge++)Se[Ge]=be[Ge];return Se},t.sign.detached=function(Me,le){for(var be=t.sign(Me,le),q=new Uint8Array(An),Se=0;Se<q.length;Se++)q[Se]=be[Se];return q},t.sign.detached.verify=function(Me,le,be){if(xn(Me,le,be),le.length!==An)throw new Error("bad signature size");if(be.length!==un)throw new Error("bad public key size");var q=new Uint8Array(An+Me.length),Se=new Uint8Array(An+Me.length),Ge;for(Ge=0;Ge<An;Ge++)q[Ge]=le[Ge];for(Ge=0;Ge<Me.length;Ge++)q[Ge+An]=Me[Ge];return xe(Se,q,q.length,be)>=0},t.sign.keyPair=function(){var Me=new Uint8Array(un),le=new Uint8Array(Mn);return V(Me,le),{publicKey:Me,secretKey:le}},t.sign.keyPair.fromSecretKey=function(Me){if(xn(Me),Me.length!==Mn)throw new Error("bad secret key size");for(var le=new Uint8Array(un),be=0;be<le.length;be++)le[be]=Me[32+be];return{publicKey:le,secretKey:new Uint8Array(Me)}},t.sign.keyPair.fromSeed=function(Me){if(xn(Me),Me.length!==Cn)throw new Error("bad seed size");for(var le=new Uint8Array(un),be=new Uint8Array(Mn),q=0;q<32;q++)be[q]=Me[q];return V(le,be,!0),{publicKey:le,secretKey:be}},t.sign.publicKeyLength=un,t.sign.secretKeyLength=Mn,t.sign.seedLength=Cn,t.sign.signatureLength=An,t.hash=function(Me){xn(Me);var le=new Uint8Array(wn);return Ee(le,Me,Me.length),le},t.hash.hashLength=wn,t.verify=function(Me,le){return xn(Me,le),Me.length===0||le.length===0||Me.length!==le.length?!1:x(Me,0,le,0,Me.length)===0},t.setPRNG=function(Me){i=Me},function(){var Me=typeof self!="undefined"?self.crypto||self.msCrypto:null;if(Me&&Me.getRandomValues){var le=65536;t.setPRNG(function(be,q){var Se,Ge=new Uint8Array(q);for(Se=0;Se<q;Se+=le)Me.getRandomValues(Ge.subarray(Se,Se+Math.min(q-Se,le)));for(Se=0;Se<q;Se++)be[Se]=Ge[Se];Zn(Ge)})}else typeof $p!="undefined"&&(Me=bj,Me&&Me.randomBytes&&t.setPRNG(function(be,q){var Se,Ge=Me.randomBytes(q);for(Se=0;Se<q;Se++)be[Se]=Ge[Se];Zn(Ge)}))}()})(a.exports?a.exports:self.nacl=self.nacl||{})})(CL);var _j=CL.exports,Dr={},km={};km.byteLength=Mj;km.toByteArray=Tj;km.fromByteArray=Lj;var ka=[],No=[],wj=typeof Uint8Array!="undefined"?Uint8Array:Array,bA="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Vf=0,Ej=bA.length;Vf<Ej;++Vf)ka[Vf]=bA[Vf],No[bA.charCodeAt(Vf)]=Vf;No["-".charCodeAt(0)]=62;No["_".charCodeAt(0)]=63;function RL(a){var t=a.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=a.indexOf("=");n===-1&&(n=t);var i=n===t?0:4-n%4;return[n,i]}function Mj(a){var t=RL(a),n=t[0],i=t[1];return(n+i)*3/4-i}function Sj(a,t,n){return(t+n)*3/4-n}function Tj(a){var t,n=RL(a),i=n[0],o=n[1],s=new wj(Sj(a,i,o)),c=0,u=o>0?i-4:i,h;for(h=0;h<u;h+=4)t=No[a.charCodeAt(h)]<<18|No[a.charCodeAt(h+1)]<<12|No[a.charCodeAt(h+2)]<<6|No[a.charCodeAt(h+3)],s[c++]=t>>16&255,s[c++]=t>>8&255,s[c++]=t&255;return o===2&&(t=No[a.charCodeAt(h)]<<2|No[a.charCodeAt(h+1)]>>4,s[c++]=t&255),o===1&&(t=No[a.charCodeAt(h)]<<10|No[a.charCodeAt(h+1)]<<4|No[a.charCodeAt(h+2)]>>2,s[c++]=t>>8&255,s[c++]=t&255),s}function Cj(a){return ka[a>>18&63]+ka[a>>12&63]+ka[a>>6&63]+ka[a&63]}function Rj(a,t,n){for(var i,o=[],s=t;s<n;s+=3)i=(a[s]<<16&16711680)+(a[s+1]<<8&65280)+(a[s+2]&255),o.push(Cj(i));return o.join("")}function Lj(a){for(var t,n=a.length,i=n%3,o=[],s=16383,c=0,u=n-i;c<u;c+=s)o.push(Rj(a,c,c+s>u?u:c+s));return i===1?(t=a[n-1],o.push(ka[t>>2]+ka[t<<4&63]+"==")):i===2&&(t=(a[n-2]<<8)+a[n-1],o.push(ka[t>>10]+ka[t>>4&63]+ka[t<<2&63]+"=")),o.join("")}var Ly={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */Ly.read=function(a,t,n,i,o){var s,c,u=o*8-i-1,h=(1<<u)-1,f=h>>1,p=-7,m=n?o-1:0,y=n?-1:1,g=a[t+m];for(m+=y,s=g&(1<<-p)-1,g>>=-p,p+=u;p>0;s=s*256+a[t+m],m+=y,p-=8);for(c=s&(1<<-p)-1,s>>=-p,p+=i;p>0;c=c*256+a[t+m],m+=y,p-=8);if(s===0)s=1-f;else{if(s===h)return c?NaN:(g?-1:1)*(1/0);c=c+Math.pow(2,i),s=s-f}return(g?-1:1)*c*Math.pow(2,s-i)};Ly.write=function(a,t,n,i,o,s){var c,u,h,f=s*8-o-1,p=(1<<f)-1,m=p>>1,y=o===23?Math.pow(2,-24)-Math.pow(2,-77):0,g=i?0:s-1,_=i?1:-1,x=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(u=isNaN(t)?1:0,c=p):(c=Math.floor(Math.log(t)/Math.LN2),t*(h=Math.pow(2,-c))<1&&(c--,h*=2),c+m>=1?t+=y/h:t+=y*Math.pow(2,1-m),t*h>=2&&(c++,h/=2),c+m>=p?(u=0,c=p):c+m>=1?(u=(t*h-1)*Math.pow(2,o),c=c+m):(u=t*Math.pow(2,m-1)*Math.pow(2,o),c=0));o>=8;a[n+g]=u&255,g+=_,u/=256,o-=8);for(c=c<<o|u,f+=o;f>0;a[n+g]=c&255,g+=_,c/=256,f-=8);a[n+g-_]|=x*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(a){const t=km,n=Ly,i=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;a.Buffer=u,a.SlowBuffer=T,a.INSPECT_MAX_BYTES=50;const o=2147483647;a.kMaxLength=o,u.TYPED_ARRAY_SUPPORT=s(),!u.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function s(){try{const B=new Uint8Array(1),S={foo:function(){return 42}};return Object.setPrototypeOf(S,Uint8Array.prototype),Object.setPrototypeOf(B,S),B.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(!!u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(!!u.isBuffer(this))return this.byteOffset}});function c(B){if(B>o)throw new RangeError('The value "'+B+'" is invalid for option "size"');const S=new Uint8Array(B);return Object.setPrototypeOf(S,u.prototype),S}function u(B,S,R){if(typeof B=="number"){if(typeof S=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return m(B)}return h(B,S,R)}u.poolSize=8192;function h(B,S,R){if(typeof B=="string")return y(B,S);if(ArrayBuffer.isView(B))return _(B);if(B==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof B);if(ce(B,ArrayBuffer)||B&&ce(B.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(ce(B,SharedArrayBuffer)||B&&ce(B.buffer,SharedArrayBuffer)))return x(B,S,R);if(typeof B=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const X=B.valueOf&&B.valueOf();if(X!=null&&X!==B)return u.from(X,S,R);const xe=b(B);if(xe)return xe;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof B[Symbol.toPrimitive]=="function")return u.from(B[Symbol.toPrimitive]("string"),S,R);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof B)}u.from=function(B,S,R){return h(B,S,R)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array);function f(B){if(typeof B!="number")throw new TypeError('"size" argument must be of type number');if(B<0)throw new RangeError('The value "'+B+'" is invalid for option "size"')}function p(B,S,R){return f(B),B<=0?c(B):S!==void 0?typeof R=="string"?c(B).fill(S,R):c(B).fill(S):c(B)}u.alloc=function(B,S,R){return p(B,S,R)};function m(B){return f(B),c(B<0?0:E(B)|0)}u.allocUnsafe=function(B){return m(B)},u.allocUnsafeSlow=function(B){return m(B)};function y(B,S){if((typeof S!="string"||S==="")&&(S="utf8"),!u.isEncoding(S))throw new TypeError("Unknown encoding: "+S);const R=P(B,S)|0;let X=c(R);const xe=X.write(B,S);return xe!==R&&(X=X.slice(0,xe)),X}function g(B){const S=B.length<0?0:E(B.length)|0,R=c(S);for(let X=0;X<S;X+=1)R[X]=B[X]&255;return R}function _(B){if(ce(B,Uint8Array)){const S=new Uint8Array(B);return x(S.buffer,S.byteOffset,S.byteLength)}return g(B)}function x(B,S,R){if(S<0||B.byteLength<S)throw new RangeError('"offset" is outside of buffer bounds');if(B.byteLength<S+(R||0))throw new RangeError('"length" is outside of buffer bounds');let X;return S===void 0&&R===void 0?X=new Uint8Array(B):R===void 0?X=new Uint8Array(B,S):X=new Uint8Array(B,S,R),Object.setPrototypeOf(X,u.prototype),X}function b(B){if(u.isBuffer(B)){const S=E(B.length)|0,R=c(S);return R.length===0||B.copy(R,0,0,S),R}if(B.length!==void 0)return typeof B.length!="number"||he(B.length)?c(0):g(B);if(B.type==="Buffer"&&Array.isArray(B.data))return g(B.data)}function E(B){if(B>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return B|0}function T(B){return+B!=B&&(B=0),u.alloc(+B)}u.isBuffer=function(S){return S!=null&&S._isBuffer===!0&&S!==u.prototype},u.compare=function(S,R){if(ce(S,Uint8Array)&&(S=u.from(S,S.offset,S.byteLength)),ce(R,Uint8Array)&&(R=u.from(R,R.offset,R.byteLength)),!u.isBuffer(S)||!u.isBuffer(R))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(S===R)return 0;let X=S.length,xe=R.length;for(let Ie=0,ye=Math.min(X,xe);Ie<ye;++Ie)if(S[Ie]!==R[Ie]){X=S[Ie],xe=R[Ie];break}return X<xe?-1:xe<X?1:0},u.isEncoding=function(S){switch(String(S).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(S,R){if(!Array.isArray(S))throw new TypeError('"list" argument must be an Array of Buffers');if(S.length===0)return u.alloc(0);let X;if(R===void 0)for(R=0,X=0;X<S.length;++X)R+=S[X].length;const xe=u.allocUnsafe(R);let Ie=0;for(X=0;X<S.length;++X){let ye=S[X];if(ce(ye,Uint8Array))Ie+ye.length>xe.length?(u.isBuffer(ye)||(ye=u.from(ye)),ye.copy(xe,Ie)):Uint8Array.prototype.set.call(xe,ye,Ie);else if(u.isBuffer(ye))ye.copy(xe,Ie);else throw new TypeError('"list" argument must be an Array of Buffers');Ie+=ye.length}return xe};function P(B,S){if(u.isBuffer(B))return B.length;if(ArrayBuffer.isView(B)||ce(B,ArrayBuffer))return B.byteLength;if(typeof B!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof B);const R=B.length,X=arguments.length>2&&arguments[2]===!0;if(!X&&R===0)return 0;let xe=!1;for(;;)switch(S){case"ascii":case"latin1":case"binary":return R;case"utf8":case"utf-8":return We(B).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R*2;case"hex":return R>>>1;case"base64":return Oe(B).length;default:if(xe)return X?-1:We(B).length;S=(""+S).toLowerCase(),xe=!0}}u.byteLength=P;function D(B,S,R){let X=!1;if((S===void 0||S<0)&&(S=0),S>this.length||((R===void 0||R>this.length)&&(R=this.length),R<=0)||(R>>>=0,S>>>=0,R<=S))return"";for(B||(B="utf8");;)switch(B){case"hex":return Q(this,S,R);case"utf8":case"utf-8":return M(this,S,R);case"ascii":return $(this,S,R);case"latin1":case"binary":return ee(this,S,R);case"base64":return L(this,S,R);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return G(this,S,R);default:if(X)throw new TypeError("Unknown encoding: "+B);B=(B+"").toLowerCase(),X=!0}}u.prototype._isBuffer=!0;function F(B,S,R){const X=B[S];B[S]=B[R],B[R]=X}u.prototype.swap16=function(){const S=this.length;if(S%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let R=0;R<S;R+=2)F(this,R,R+1);return this},u.prototype.swap32=function(){const S=this.length;if(S%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let R=0;R<S;R+=4)F(this,R,R+3),F(this,R+1,R+2);return this},u.prototype.swap64=function(){const S=this.length;if(S%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let R=0;R<S;R+=8)F(this,R,R+7),F(this,R+1,R+6),F(this,R+2,R+5),F(this,R+3,R+4);return this},u.prototype.toString=function(){const S=this.length;return S===0?"":arguments.length===0?M(this,0,S):D.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(S){if(!u.isBuffer(S))throw new TypeError("Argument must be a Buffer");return this===S?!0:u.compare(this,S)===0},u.prototype.inspect=function(){let S="";const R=a.INSPECT_MAX_BYTES;return S=this.toString("hex",0,R).replace(/(.{2})/g,"$1 ").trim(),this.length>R&&(S+=" ... "),"<Buffer "+S+">"},i&&(u.prototype[i]=u.prototype.inspect),u.prototype.compare=function(S,R,X,xe,Ie){if(ce(S,Uint8Array)&&(S=u.from(S,S.offset,S.byteLength)),!u.isBuffer(S))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof S);if(R===void 0&&(R=0),X===void 0&&(X=S?S.length:0),xe===void 0&&(xe=0),Ie===void 0&&(Ie=this.length),R<0||X>S.length||xe<0||Ie>this.length)throw new RangeError("out of range index");if(xe>=Ie&&R>=X)return 0;if(xe>=Ie)return-1;if(R>=X)return 1;if(R>>>=0,X>>>=0,xe>>>=0,Ie>>>=0,this===S)return 0;let ye=Ie-xe,nt=X-R;const at=Math.min(ye,nt),mt=this.slice(xe,Ie),wt=S.slice(R,X);for(let Lt=0;Lt<at;++Lt)if(mt[Lt]!==wt[Lt]){ye=mt[Lt],nt=wt[Lt];break}return ye<nt?-1:nt<ye?1:0};function k(B,S,R,X,xe){if(B.length===0)return-1;if(typeof R=="string"?(X=R,R=0):R>2147483647?R=2147483647:R<-2147483648&&(R=-2147483648),R=+R,he(R)&&(R=xe?0:B.length-1),R<0&&(R=B.length+R),R>=B.length){if(xe)return-1;R=B.length-1}else if(R<0)if(xe)R=0;else return-1;if(typeof S=="string"&&(S=u.from(S,X)),u.isBuffer(S))return S.length===0?-1:W(B,S,R,X,xe);if(typeof S=="number")return S=S&255,typeof Uint8Array.prototype.indexOf=="function"?xe?Uint8Array.prototype.indexOf.call(B,S,R):Uint8Array.prototype.lastIndexOf.call(B,S,R):W(B,[S],R,X,xe);throw new TypeError("val must be string, number or Buffer")}function W(B,S,R,X,xe){let Ie=1,ye=B.length,nt=S.length;if(X!==void 0&&(X=String(X).toLowerCase(),X==="ucs2"||X==="ucs-2"||X==="utf16le"||X==="utf-16le")){if(B.length<2||S.length<2)return-1;Ie=2,ye/=2,nt/=2,R/=2}function at(wt,Lt){return Ie===1?wt[Lt]:wt.readUInt16BE(Lt*Ie)}let mt;if(xe){let wt=-1;for(mt=R;mt<ye;mt++)if(at(B,mt)===at(S,wt===-1?0:mt-wt)){if(wt===-1&&(wt=mt),mt-wt+1===nt)return wt*Ie}else wt!==-1&&(mt-=mt-wt),wt=-1}else for(R+nt>ye&&(R=ye-nt),mt=R;mt>=0;mt--){let wt=!0;for(let Lt=0;Lt<nt;Lt++)if(at(B,mt+Lt)!==at(S,Lt)){wt=!1;break}if(wt)return mt}return-1}u.prototype.includes=function(S,R,X){return this.indexOf(S,R,X)!==-1},u.prototype.indexOf=function(S,R,X){return k(this,S,R,X,!0)},u.prototype.lastIndexOf=function(S,R,X){return k(this,S,R,X,!1)};function j(B,S,R,X){R=Number(R)||0;const xe=B.length-R;X?(X=Number(X),X>xe&&(X=xe)):X=xe;const Ie=S.length;X>Ie/2&&(X=Ie/2);let ye;for(ye=0;ye<X;++ye){const nt=parseInt(S.substr(ye*2,2),16);if(he(nt))return ye;B[R+ye]=nt}return ye}function J(B,S,R,X){return Le(We(S,B.length-R),B,R,X)}function de(B,S,R,X){return Le(_e(S),B,R,X)}function te(B,S,R,X){return Le(Oe(S),B,R,X)}function N(B,S,R,X){return Le(Ee(S,B.length-R),B,R,X)}u.prototype.write=function(S,R,X,xe){if(R===void 0)xe="utf8",X=this.length,R=0;else if(X===void 0&&typeof R=="string")xe=R,X=this.length,R=0;else if(isFinite(R))R=R>>>0,isFinite(X)?(X=X>>>0,xe===void 0&&(xe="utf8")):(xe=X,X=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Ie=this.length-R;if((X===void 0||X>Ie)&&(X=Ie),S.length>0&&(X<0||R<0)||R>this.length)throw new RangeError("Attempt to write outside buffer bounds");xe||(xe="utf8");let ye=!1;for(;;)switch(xe){case"hex":return j(this,S,R,X);case"utf8":case"utf-8":return J(this,S,R,X);case"ascii":case"latin1":case"binary":return de(this,S,R,X);case"base64":return te(this,S,R,X);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,S,R,X);default:if(ye)throw new TypeError("Unknown encoding: "+xe);xe=(""+xe).toLowerCase(),ye=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function L(B,S,R){return S===0&&R===B.length?t.fromByteArray(B):t.fromByteArray(B.slice(S,R))}function M(B,S,R){R=Math.min(B.length,R);const X=[];let xe=S;for(;xe<R;){const Ie=B[xe];let ye=null,nt=Ie>239?4:Ie>223?3:Ie>191?2:1;if(xe+nt<=R){let at,mt,wt,Lt;switch(nt){case 1:Ie<128&&(ye=Ie);break;case 2:at=B[xe+1],(at&192)===128&&(Lt=(Ie&31)<<6|at&63,Lt>127&&(ye=Lt));break;case 3:at=B[xe+1],mt=B[xe+2],(at&192)===128&&(mt&192)===128&&(Lt=(Ie&15)<<12|(at&63)<<6|mt&63,Lt>2047&&(Lt<55296||Lt>57343)&&(ye=Lt));break;case 4:at=B[xe+1],mt=B[xe+2],wt=B[xe+3],(at&192)===128&&(mt&192)===128&&(wt&192)===128&&(Lt=(Ie&15)<<18|(at&63)<<12|(mt&63)<<6|wt&63,Lt>65535&&Lt<1114112&&(ye=Lt))}}ye===null?(ye=65533,nt=1):ye>65535&&(ye-=65536,X.push(ye>>>10&1023|55296),ye=56320|ye&1023),X.push(ye),xe+=nt}return U(X)}const I=4096;function U(B){const S=B.length;if(S<=I)return String.fromCharCode.apply(String,B);let R="",X=0;for(;X<S;)R+=String.fromCharCode.apply(String,B.slice(X,X+=I));return R}function $(B,S,R){let X="";R=Math.min(B.length,R);for(let xe=S;xe<R;++xe)X+=String.fromCharCode(B[xe]&127);return X}function ee(B,S,R){let X="";R=Math.min(B.length,R);for(let xe=S;xe<R;++xe)X+=String.fromCharCode(B[xe]);return X}function Q(B,S,R){const X=B.length;(!S||S<0)&&(S=0),(!R||R<0||R>X)&&(R=X);let xe="";for(let Ie=S;Ie<R;++Ie)xe+=ie[B[Ie]];return xe}function G(B,S,R){const X=B.slice(S,R);let xe="";for(let Ie=0;Ie<X.length-1;Ie+=2)xe+=String.fromCharCode(X[Ie]+X[Ie+1]*256);return xe}u.prototype.slice=function(S,R){const X=this.length;S=~~S,R=R===void 0?X:~~R,S<0?(S+=X,S<0&&(S=0)):S>X&&(S=X),R<0?(R+=X,R<0&&(R=0)):R>X&&(R=X),R<S&&(R=S);const xe=this.subarray(S,R);return Object.setPrototypeOf(xe,u.prototype),xe};function K(B,S,R){if(B%1!==0||B<0)throw new RangeError("offset is not uint");if(B+S>R)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(S,R,X){S=S>>>0,R=R>>>0,X||K(S,R,this.length);let xe=this[S],Ie=1,ye=0;for(;++ye<R&&(Ie*=256);)xe+=this[S+ye]*Ie;return xe},u.prototype.readUintBE=u.prototype.readUIntBE=function(S,R,X){S=S>>>0,R=R>>>0,X||K(S,R,this.length);let xe=this[S+--R],Ie=1;for(;R>0&&(Ie*=256);)xe+=this[S+--R]*Ie;return xe},u.prototype.readUint8=u.prototype.readUInt8=function(S,R){return S=S>>>0,R||K(S,1,this.length),this[S]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(S,R){return S=S>>>0,R||K(S,2,this.length),this[S]|this[S+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(S,R){return S=S>>>0,R||K(S,2,this.length),this[S]<<8|this[S+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(S,R){return S=S>>>0,R||K(S,4,this.length),(this[S]|this[S+1]<<8|this[S+2]<<16)+this[S+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(S,R){return S=S>>>0,R||K(S,4,this.length),this[S]*16777216+(this[S+1]<<16|this[S+2]<<8|this[S+3])},u.prototype.readBigUInt64LE=V(function(S){S=S>>>0,Pe(S,"offset");const R=this[S],X=this[S+7];(R===void 0||X===void 0)&&Be(S,this.length-8);const xe=R+this[++S]*2**8+this[++S]*2**16+this[++S]*2**24,Ie=this[++S]+this[++S]*2**8+this[++S]*2**16+X*2**24;return BigInt(xe)+(BigInt(Ie)<<BigInt(32))}),u.prototype.readBigUInt64BE=V(function(S){S=S>>>0,Pe(S,"offset");const R=this[S],X=this[S+7];(R===void 0||X===void 0)&&Be(S,this.length-8);const xe=R*2**24+this[++S]*2**16+this[++S]*2**8+this[++S],Ie=this[++S]*2**24+this[++S]*2**16+this[++S]*2**8+X;return(BigInt(xe)<<BigInt(32))+BigInt(Ie)}),u.prototype.readIntLE=function(S,R,X){S=S>>>0,R=R>>>0,X||K(S,R,this.length);let xe=this[S],Ie=1,ye=0;for(;++ye<R&&(Ie*=256);)xe+=this[S+ye]*Ie;return Ie*=128,xe>=Ie&&(xe-=Math.pow(2,8*R)),xe},u.prototype.readIntBE=function(S,R,X){S=S>>>0,R=R>>>0,X||K(S,R,this.length);let xe=R,Ie=1,ye=this[S+--xe];for(;xe>0&&(Ie*=256);)ye+=this[S+--xe]*Ie;return Ie*=128,ye>=Ie&&(ye-=Math.pow(2,8*R)),ye},u.prototype.readInt8=function(S,R){return S=S>>>0,R||K(S,1,this.length),this[S]&128?(255-this[S]+1)*-1:this[S]},u.prototype.readInt16LE=function(S,R){S=S>>>0,R||K(S,2,this.length);const X=this[S]|this[S+1]<<8;return X&32768?X|4294901760:X},u.prototype.readInt16BE=function(S,R){S=S>>>0,R||K(S,2,this.length);const X=this[S+1]|this[S]<<8;return X&32768?X|4294901760:X},u.prototype.readInt32LE=function(S,R){return S=S>>>0,R||K(S,4,this.length),this[S]|this[S+1]<<8|this[S+2]<<16|this[S+3]<<24},u.prototype.readInt32BE=function(S,R){return S=S>>>0,R||K(S,4,this.length),this[S]<<24|this[S+1]<<16|this[S+2]<<8|this[S+3]},u.prototype.readBigInt64LE=V(function(S){S=S>>>0,Pe(S,"offset");const R=this[S],X=this[S+7];(R===void 0||X===void 0)&&Be(S,this.length-8);const xe=this[S+4]+this[S+5]*2**8+this[S+6]*2**16+(X<<24);return(BigInt(xe)<<BigInt(32))+BigInt(R+this[++S]*2**8+this[++S]*2**16+this[++S]*2**24)}),u.prototype.readBigInt64BE=V(function(S){S=S>>>0,Pe(S,"offset");const R=this[S],X=this[S+7];(R===void 0||X===void 0)&&Be(S,this.length-8);const xe=(R<<24)+this[++S]*2**16+this[++S]*2**8+this[++S];return(BigInt(xe)<<BigInt(32))+BigInt(this[++S]*2**24+this[++S]*2**16+this[++S]*2**8+X)}),u.prototype.readFloatLE=function(S,R){return S=S>>>0,R||K(S,4,this.length),n.read(this,S,!0,23,4)},u.prototype.readFloatBE=function(S,R){return S=S>>>0,R||K(S,4,this.length),n.read(this,S,!1,23,4)},u.prototype.readDoubleLE=function(S,R){return S=S>>>0,R||K(S,8,this.length),n.read(this,S,!0,52,8)},u.prototype.readDoubleBE=function(S,R){return S=S>>>0,R||K(S,8,this.length),n.read(this,S,!1,52,8)};function Y(B,S,R,X,xe,Ie){if(!u.isBuffer(B))throw new TypeError('"buffer" argument must be a Buffer instance');if(S>xe||S<Ie)throw new RangeError('"value" argument is out of bounds');if(R+X>B.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(S,R,X,xe){if(S=+S,R=R>>>0,X=X>>>0,!xe){const nt=Math.pow(2,8*X)-1;Y(this,S,R,X,nt,0)}let Ie=1,ye=0;for(this[R]=S&255;++ye<X&&(Ie*=256);)this[R+ye]=S/Ie&255;return R+X},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(S,R,X,xe){if(S=+S,R=R>>>0,X=X>>>0,!xe){const nt=Math.pow(2,8*X)-1;Y(this,S,R,X,nt,0)}let Ie=X-1,ye=1;for(this[R+Ie]=S&255;--Ie>=0&&(ye*=256);)this[R+Ie]=S/ye&255;return R+X},u.prototype.writeUint8=u.prototype.writeUInt8=function(S,R,X){return S=+S,R=R>>>0,X||Y(this,S,R,1,255,0),this[R]=S&255,R+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(S,R,X){return S=+S,R=R>>>0,X||Y(this,S,R,2,65535,0),this[R]=S&255,this[R+1]=S>>>8,R+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(S,R,X){return S=+S,R=R>>>0,X||Y(this,S,R,2,65535,0),this[R]=S>>>8,this[R+1]=S&255,R+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(S,R,X){return S=+S,R=R>>>0,X||Y(this,S,R,4,4294967295,0),this[R+3]=S>>>24,this[R+2]=S>>>16,this[R+1]=S>>>8,this[R]=S&255,R+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(S,R,X){return S=+S,R=R>>>0,X||Y(this,S,R,4,4294967295,0),this[R]=S>>>24,this[R+1]=S>>>16,this[R+2]=S>>>8,this[R+3]=S&255,R+4};function we(B,S,R,X,xe){Ye(S,X,xe,B,R,7);let Ie=Number(S&BigInt(4294967295));B[R++]=Ie,Ie=Ie>>8,B[R++]=Ie,Ie=Ie>>8,B[R++]=Ie,Ie=Ie>>8,B[R++]=Ie;let ye=Number(S>>BigInt(32)&BigInt(4294967295));return B[R++]=ye,ye=ye>>8,B[R++]=ye,ye=ye>>8,B[R++]=ye,ye=ye>>8,B[R++]=ye,R}function Ke(B,S,R,X,xe){Ye(S,X,xe,B,R,7);let Ie=Number(S&BigInt(4294967295));B[R+7]=Ie,Ie=Ie>>8,B[R+6]=Ie,Ie=Ie>>8,B[R+5]=Ie,Ie=Ie>>8,B[R+4]=Ie;let ye=Number(S>>BigInt(32)&BigInt(4294967295));return B[R+3]=ye,ye=ye>>8,B[R+2]=ye,ye=ye>>8,B[R+1]=ye,ye=ye>>8,B[R]=ye,R+8}u.prototype.writeBigUInt64LE=V(function(S,R=0){return we(this,S,R,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeBigUInt64BE=V(function(S,R=0){return Ke(this,S,R,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeIntLE=function(S,R,X,xe){if(S=+S,R=R>>>0,!xe){const at=Math.pow(2,8*X-1);Y(this,S,R,X,at-1,-at)}let Ie=0,ye=1,nt=0;for(this[R]=S&255;++Ie<X&&(ye*=256);)S<0&&nt===0&&this[R+Ie-1]!==0&&(nt=1),this[R+Ie]=(S/ye>>0)-nt&255;return R+X},u.prototype.writeIntBE=function(S,R,X,xe){if(S=+S,R=R>>>0,!xe){const at=Math.pow(2,8*X-1);Y(this,S,R,X,at-1,-at)}let Ie=X-1,ye=1,nt=0;for(this[R+Ie]=S&255;--Ie>=0&&(ye*=256);)S<0&&nt===0&&this[R+Ie+1]!==0&&(nt=1),this[R+Ie]=(S/ye>>0)-nt&255;return R+X},u.prototype.writeInt8=function(S,R,X){return S=+S,R=R>>>0,X||Y(this,S,R,1,127,-128),S<0&&(S=255+S+1),this[R]=S&255,R+1},u.prototype.writeInt16LE=function(S,R,X){return S=+S,R=R>>>0,X||Y(this,S,R,2,32767,-32768),this[R]=S&255,this[R+1]=S>>>8,R+2},u.prototype.writeInt16BE=function(S,R,X){return S=+S,R=R>>>0,X||Y(this,S,R,2,32767,-32768),this[R]=S>>>8,this[R+1]=S&255,R+2},u.prototype.writeInt32LE=function(S,R,X){return S=+S,R=R>>>0,X||Y(this,S,R,4,2147483647,-2147483648),this[R]=S&255,this[R+1]=S>>>8,this[R+2]=S>>>16,this[R+3]=S>>>24,R+4},u.prototype.writeInt32BE=function(S,R,X){return S=+S,R=R>>>0,X||Y(this,S,R,4,2147483647,-2147483648),S<0&&(S=4294967295+S+1),this[R]=S>>>24,this[R+1]=S>>>16,this[R+2]=S>>>8,this[R+3]=S&255,R+4},u.prototype.writeBigInt64LE=V(function(S,R=0){return we(this,S,R,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),u.prototype.writeBigInt64BE=V(function(S,R=0){return Ke(this,S,R,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function ge(B,S,R,X,xe,Ie){if(R+X>B.length)throw new RangeError("Index out of range");if(R<0)throw new RangeError("Index out of range")}function me(B,S,R,X,xe){return S=+S,R=R>>>0,xe||ge(B,S,R,4),n.write(B,S,R,X,23,4),R+4}u.prototype.writeFloatLE=function(S,R,X){return me(this,S,R,!0,X)},u.prototype.writeFloatBE=function(S,R,X){return me(this,S,R,!1,X)};function De(B,S,R,X,xe){return S=+S,R=R>>>0,xe||ge(B,S,R,8),n.write(B,S,R,X,52,8),R+8}u.prototype.writeDoubleLE=function(S,R,X){return De(this,S,R,!0,X)},u.prototype.writeDoubleBE=function(S,R,X){return De(this,S,R,!1,X)},u.prototype.copy=function(S,R,X,xe){if(!u.isBuffer(S))throw new TypeError("argument should be a Buffer");if(X||(X=0),!xe&&xe!==0&&(xe=this.length),R>=S.length&&(R=S.length),R||(R=0),xe>0&&xe<X&&(xe=X),xe===X||S.length===0||this.length===0)return 0;if(R<0)throw new RangeError("targetStart out of bounds");if(X<0||X>=this.length)throw new RangeError("Index out of range");if(xe<0)throw new RangeError("sourceEnd out of bounds");xe>this.length&&(xe=this.length),S.length-R<xe-X&&(xe=S.length-R+X);const Ie=xe-X;return this===S&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(R,X,xe):Uint8Array.prototype.set.call(S,this.subarray(X,xe),R),Ie},u.prototype.fill=function(S,R,X,xe){if(typeof S=="string"){if(typeof R=="string"?(xe=R,R=0,X=this.length):typeof X=="string"&&(xe=X,X=this.length),xe!==void 0&&typeof xe!="string")throw new TypeError("encoding must be a string");if(typeof xe=="string"&&!u.isEncoding(xe))throw new TypeError("Unknown encoding: "+xe);if(S.length===1){const ye=S.charCodeAt(0);(xe==="utf8"&&ye<128||xe==="latin1")&&(S=ye)}}else typeof S=="number"?S=S&255:typeof S=="boolean"&&(S=Number(S));if(R<0||this.length<R||this.length<X)throw new RangeError("Out of range index");if(X<=R)return this;R=R>>>0,X=X===void 0?this.length:X>>>0,S||(S=0);let Ie;if(typeof S=="number")for(Ie=R;Ie<X;++Ie)this[Ie]=S;else{const ye=u.isBuffer(S)?S:u.from(S,xe),nt=ye.length;if(nt===0)throw new TypeError('The value "'+S+'" is invalid for argument "value"');for(Ie=0;Ie<X-R;++Ie)this[Ie+R]=ye[Ie%nt]}return this};const ze={};function tt(B,S,R){ze[B]=class extends R{constructor(){super(),Object.defineProperty(this,"message",{value:S.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${B}]`,this.stack,delete this.name}get code(){return B}set code(xe){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:xe,writable:!0})}toString(){return`${this.name} [${B}]: ${this.message}`}}}tt("ERR_BUFFER_OUT_OF_BOUNDS",function(B){return B?`${B} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),tt("ERR_INVALID_ARG_TYPE",function(B,S){return`The "${B}" argument must be of type number. Received type ${typeof S}`},TypeError),tt("ERR_OUT_OF_RANGE",function(B,S,R){let X=`The value of "${B}" is out of range.`,xe=R;return Number.isInteger(R)&&Math.abs(R)>2**32?xe=rt(String(R)):typeof R=="bigint"&&(xe=String(R),(R>BigInt(2)**BigInt(32)||R<-(BigInt(2)**BigInt(32)))&&(xe=rt(xe)),xe+="n"),X+=` It must be ${S}. Received ${xe}`,X},RangeError);function rt(B){let S="",R=B.length;const X=B[0]==="-"?1:0;for(;R>=X+4;R-=3)S=`_${B.slice(R-3,R)}${S}`;return`${B.slice(0,R)}${S}`}function vt(B,S,R){Pe(S,"offset"),(B[S]===void 0||B[S+R]===void 0)&&Be(S,B.length-(R+1))}function Ye(B,S,R,X,xe,Ie){if(B>R||B<S){const ye=typeof S=="bigint"?"n":"";let nt;throw Ie>3?S===0||S===BigInt(0)?nt=`>= 0${ye} and < 2${ye} ** ${(Ie+1)*8}${ye}`:nt=`>= -(2${ye} ** ${(Ie+1)*8-1}${ye}) and < 2 ** ${(Ie+1)*8-1}${ye}`:nt=`>= ${S}${ye} and <= ${R}${ye}`,new ze.ERR_OUT_OF_RANGE("value",nt,B)}vt(X,xe,Ie)}function Pe(B,S){if(typeof B!="number")throw new ze.ERR_INVALID_ARG_TYPE(S,"number",B)}function Be(B,S,R){throw Math.floor(B)!==B?(Pe(B,R),new ze.ERR_OUT_OF_RANGE(R||"offset","an integer",B)):S<0?new ze.ERR_BUFFER_OUT_OF_BOUNDS:new ze.ERR_OUT_OF_RANGE(R||"offset",`>= ${R?1:0} and <= ${S}`,B)}const $e=/[^+/0-9A-Za-z-_]/g;function Je(B){if(B=B.split("=")[0],B=B.trim().replace($e,""),B.length<2)return"";for(;B.length%4!==0;)B=B+"=";return B}function We(B,S){S=S||1/0;let R;const X=B.length;let xe=null;const Ie=[];for(let ye=0;ye<X;++ye){if(R=B.charCodeAt(ye),R>55295&&R<57344){if(!xe){if(R>56319){(S-=3)>-1&&Ie.push(239,191,189);continue}else if(ye+1===X){(S-=3)>-1&&Ie.push(239,191,189);continue}xe=R;continue}if(R<56320){(S-=3)>-1&&Ie.push(239,191,189),xe=R;continue}R=(xe-55296<<10|R-56320)+65536}else xe&&(S-=3)>-1&&Ie.push(239,191,189);if(xe=null,R<128){if((S-=1)<0)break;Ie.push(R)}else if(R<2048){if((S-=2)<0)break;Ie.push(R>>6|192,R&63|128)}else if(R<65536){if((S-=3)<0)break;Ie.push(R>>12|224,R>>6&63|128,R&63|128)}else if(R<1114112){if((S-=4)<0)break;Ie.push(R>>18|240,R>>12&63|128,R>>6&63|128,R&63|128)}else throw new Error("Invalid code point")}return Ie}function _e(B){const S=[];for(let R=0;R<B.length;++R)S.push(B.charCodeAt(R)&255);return S}function Ee(B,S){let R,X,xe;const Ie=[];for(let ye=0;ye<B.length&&!((S-=2)<0);++ye)R=B.charCodeAt(ye),X=R>>8,xe=R%256,Ie.push(xe),Ie.push(X);return Ie}function Oe(B){return t.toByteArray(Je(B))}function Le(B,S,R,X){let xe;for(xe=0;xe<X&&!(xe+R>=S.length||xe>=B.length);++xe)S[xe+R]=B[xe];return xe}function ce(B,S){return B instanceof S||B!=null&&B.constructor!=null&&B.constructor.name!=null&&B.constructor.name===S.name}function he(B){return B!==B}const ie=function(){const B="0123456789abcdef",S=new Array(256);for(let R=0;R<16;++R){const X=R*16;for(let xe=0;xe<16;++xe)S[X+xe]=B[R]+B[xe]}return S}();function V(B){return typeof BigInt=="undefined"?Z:B}function Z(){throw new Error("BigInt not supported")}})(Dr);var iw={exports:{}};(function(a){(function(t,n){function i(L,M){if(!L)throw new Error(M||"Assertion failed")}function o(L,M){L.super_=M;var I=function(){};I.prototype=M.prototype,L.prototype=new I,L.prototype.constructor=L}function s(L,M,I){if(s.isBN(L))return L;this.negative=0,this.words=null,this.length=0,this.red=null,L!==null&&((M==="le"||M==="be")&&(I=M,M=10),this._init(L||0,M||10,I||"be"))}typeof t=="object"?t.exports=s:n.BN=s,s.BN=s,s.wordSize=26;var c;try{typeof window!="undefined"&&typeof window.Buffer!="undefined"?c=window.Buffer:c=require("buffer").Buffer}catch{}s.isBN=function(M){return M instanceof s?!0:M!==null&&typeof M=="object"&&M.constructor.wordSize===s.wordSize&&Array.isArray(M.words)},s.max=function(M,I){return M.cmp(I)>0?M:I},s.min=function(M,I){return M.cmp(I)<0?M:I},s.prototype._init=function(M,I,U){if(typeof M=="number")return this._initNumber(M,I,U);if(typeof M=="object")return this._initArray(M,I,U);I==="hex"&&(I=16),i(I===(I|0)&&I>=2&&I<=36),M=M.toString().replace(/\s+/g,"");var $=0;M[0]==="-"&&($++,this.negative=1),$<M.length&&(I===16?this._parseHex(M,$,U):(this._parseBase(M,I,$),U==="le"&&this._initArray(this.toArray(),I,U)))},s.prototype._initNumber=function(M,I,U){M<0&&(this.negative=1,M=-M),M<67108864?(this.words=[M&67108863],this.length=1):M<4503599627370496?(this.words=[M&67108863,M/67108864&67108863],this.length=2):(i(M<9007199254740992),this.words=[M&67108863,M/67108864&67108863,1],this.length=3),U==="le"&&this._initArray(this.toArray(),I,U)},s.prototype._initArray=function(M,I,U){if(i(typeof M.length=="number"),M.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(M.length/3),this.words=new Array(this.length);for(var $=0;$<this.length;$++)this.words[$]=0;var ee,Q,G=0;if(U==="be")for($=M.length-1,ee=0;$>=0;$-=3)Q=M[$]|M[$-1]<<8|M[$-2]<<16,this.words[ee]|=Q<<G&67108863,this.words[ee+1]=Q>>>26-G&67108863,G+=24,G>=26&&(G-=26,ee++);else if(U==="le")for($=0,ee=0;$<M.length;$+=3)Q=M[$]|M[$+1]<<8|M[$+2]<<16,this.words[ee]|=Q<<G&67108863,this.words[ee+1]=Q>>>26-G&67108863,G+=24,G>=26&&(G-=26,ee++);return this._strip()};function u(L,M){var I=L.charCodeAt(M);if(I>=48&&I<=57)return I-48;if(I>=65&&I<=70)return I-55;if(I>=97&&I<=102)return I-87;i(!1,"Invalid character in "+L)}function h(L,M,I){var U=u(L,I);return I-1>=M&&(U|=u(L,I-1)<<4),U}s.prototype._parseHex=function(M,I,U){this.length=Math.ceil((M.length-I)/6),this.words=new Array(this.length);for(var $=0;$<this.length;$++)this.words[$]=0;var ee=0,Q=0,G;if(U==="be")for($=M.length-1;$>=I;$-=2)G=h(M,I,$)<<ee,this.words[Q]|=G&67108863,ee>=18?(ee-=18,Q+=1,this.words[Q]|=G>>>26):ee+=8;else{var K=M.length-I;for($=K%2===0?I+1:I;$<M.length;$+=2)G=h(M,I,$)<<ee,this.words[Q]|=G&67108863,ee>=18?(ee-=18,Q+=1,this.words[Q]|=G>>>26):ee+=8}this._strip()};function f(L,M,I,U){for(var $=0,ee=0,Q=Math.min(L.length,I),G=M;G<Q;G++){var K=L.charCodeAt(G)-48;$*=U,K>=49?ee=K-49+10:K>=17?ee=K-17+10:ee=K,i(K>=0&&ee<U,"Invalid character"),$+=ee}return $}s.prototype._parseBase=function(M,I,U){this.words=[0],this.length=1;for(var $=0,ee=1;ee<=67108863;ee*=I)$++;$--,ee=ee/I|0;for(var Q=M.length-U,G=Q%$,K=Math.min(Q,Q-G)+U,Y=0,we=U;we<K;we+=$)Y=f(M,we,we+$,I),this.imuln(ee),this.words[0]+Y<67108864?this.words[0]+=Y:this._iaddn(Y);if(G!==0){var Ke=1;for(Y=f(M,we,M.length,I),we=0;we<G;we++)Ke*=I;this.imuln(Ke),this.words[0]+Y<67108864?this.words[0]+=Y:this._iaddn(Y)}this._strip()},s.prototype.copy=function(M){M.words=new Array(this.length);for(var I=0;I<this.length;I++)M.words[I]=this.words[I];M.length=this.length,M.negative=this.negative,M.red=this.red};function p(L,M){L.words=M.words,L.length=M.length,L.negative=M.negative,L.red=M.red}if(s.prototype._move=function(M){p(M,this)},s.prototype.clone=function(){var M=new s(null);return this.copy(M),M},s.prototype._expand=function(M){for(;this.length<M;)this.words[this.length++]=0;return this},s.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},s.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol!="undefined"&&typeof Symbol.for=="function")try{s.prototype[Symbol.for("nodejs.util.inspect.custom")]=m}catch{s.prototype.inspect=m}else s.prototype.inspect=m;function m(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var y=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],g=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],_=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];s.prototype.toString=function(M,I){M=M||10,I=I|0||1;var U;if(M===16||M==="hex"){U="";for(var $=0,ee=0,Q=0;Q<this.length;Q++){var G=this.words[Q],K=((G<<$|ee)&16777215).toString(16);ee=G>>>24-$&16777215,$+=2,$>=26&&($-=26,Q--),ee!==0||Q!==this.length-1?U=y[6-K.length]+K+U:U=K+U}for(ee!==0&&(U=ee.toString(16)+U);U.length%I!==0;)U="0"+U;return this.negative!==0&&(U="-"+U),U}if(M===(M|0)&&M>=2&&M<=36){var Y=g[M],we=_[M];U="";var Ke=this.clone();for(Ke.negative=0;!Ke.isZero();){var ge=Ke.modrn(we).toString(M);Ke=Ke.idivn(we),Ke.isZero()?U=ge+U:U=y[Y-ge.length]+ge+U}for(this.isZero()&&(U="0"+U);U.length%I!==0;)U="0"+U;return this.negative!==0&&(U="-"+U),U}i(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var M=this.words[0];return this.length===2?M+=this.words[1]*67108864:this.length===3&&this.words[2]===1?M+=4503599627370496+this.words[1]*67108864:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-M:M},s.prototype.toJSON=function(){return this.toString(16,2)},c&&(s.prototype.toBuffer=function(M,I){return this.toArrayLike(c,M,I)}),s.prototype.toArray=function(M,I){return this.toArrayLike(Array,M,I)};var x=function(M,I){return M.allocUnsafe?M.allocUnsafe(I):new M(I)};s.prototype.toArrayLike=function(M,I,U){this._strip();var $=this.byteLength(),ee=U||Math.max(1,$);i($<=ee,"byte array longer than desired length"),i(ee>0,"Requested array length <= 0");var Q=x(M,ee),G=I==="le"?"LE":"BE";return this["_toArrayLike"+G](Q,$),Q},s.prototype._toArrayLikeLE=function(M,I){for(var U=0,$=0,ee=0,Q=0;ee<this.length;ee++){var G=this.words[ee]<<Q|$;M[U++]=G&255,U<M.length&&(M[U++]=G>>8&255),U<M.length&&(M[U++]=G>>16&255),Q===6?(U<M.length&&(M[U++]=G>>24&255),$=0,Q=0):($=G>>>24,Q+=2)}if(U<M.length)for(M[U++]=$;U<M.length;)M[U++]=0},s.prototype._toArrayLikeBE=function(M,I){for(var U=M.length-1,$=0,ee=0,Q=0;ee<this.length;ee++){var G=this.words[ee]<<Q|$;M[U--]=G&255,U>=0&&(M[U--]=G>>8&255),U>=0&&(M[U--]=G>>16&255),Q===6?(U>=0&&(M[U--]=G>>24&255),$=0,Q=0):($=G>>>24,Q+=2)}if(U>=0)for(M[U--]=$;U>=0;)M[U--]=0},Math.clz32?s.prototype._countBits=function(M){return 32-Math.clz32(M)}:s.prototype._countBits=function(M){var I=M,U=0;return I>=4096&&(U+=13,I>>>=13),I>=64&&(U+=7,I>>>=7),I>=8&&(U+=4,I>>>=4),I>=2&&(U+=2,I>>>=2),U+I},s.prototype._zeroBits=function(M){if(M===0)return 26;var I=M,U=0;return(I&8191)===0&&(U+=13,I>>>=13),(I&127)===0&&(U+=7,I>>>=7),(I&15)===0&&(U+=4,I>>>=4),(I&3)===0&&(U+=2,I>>>=2),(I&1)===0&&U++,U},s.prototype.bitLength=function(){var M=this.words[this.length-1],I=this._countBits(M);return(this.length-1)*26+I};function b(L){for(var M=new Array(L.bitLength()),I=0;I<M.length;I++){var U=I/26|0,$=I%26;M[I]=L.words[U]>>>$&1}return M}s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var M=0,I=0;I<this.length;I++){var U=this._zeroBits(this.words[I]);if(M+=U,U!==26)break}return M},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(M){return this.negative!==0?this.abs().inotn(M).iaddn(1):this.clone()},s.prototype.fromTwos=function(M){return this.testn(M-1)?this.notn(M).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return this.negative!==0},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(M){for(;this.length<M.length;)this.words[this.length++]=0;for(var I=0;I<M.length;I++)this.words[I]=this.words[I]|M.words[I];return this._strip()},s.prototype.ior=function(M){return i((this.negative|M.negative)===0),this.iuor(M)},s.prototype.or=function(M){return this.length>M.length?this.clone().ior(M):M.clone().ior(this)},s.prototype.uor=function(M){return this.length>M.length?this.clone().iuor(M):M.clone().iuor(this)},s.prototype.iuand=function(M){var I;this.length>M.length?I=M:I=this;for(var U=0;U<I.length;U++)this.words[U]=this.words[U]&M.words[U];return this.length=I.length,this._strip()},s.prototype.iand=function(M){return i((this.negative|M.negative)===0),this.iuand(M)},s.prototype.and=function(M){return this.length>M.length?this.clone().iand(M):M.clone().iand(this)},s.prototype.uand=function(M){return this.length>M.length?this.clone().iuand(M):M.clone().iuand(this)},s.prototype.iuxor=function(M){var I,U;this.length>M.length?(I=this,U=M):(I=M,U=this);for(var $=0;$<U.length;$++)this.words[$]=I.words[$]^U.words[$];if(this!==I)for(;$<I.length;$++)this.words[$]=I.words[$];return this.length=I.length,this._strip()},s.prototype.ixor=function(M){return i((this.negative|M.negative)===0),this.iuxor(M)},s.prototype.xor=function(M){return this.length>M.length?this.clone().ixor(M):M.clone().ixor(this)},s.prototype.uxor=function(M){return this.length>M.length?this.clone().iuxor(M):M.clone().iuxor(this)},s.prototype.inotn=function(M){i(typeof M=="number"&&M>=0);var I=Math.ceil(M/26)|0,U=M%26;this._expand(I),U>0&&I--;for(var $=0;$<I;$++)this.words[$]=~this.words[$]&67108863;return U>0&&(this.words[$]=~this.words[$]&67108863>>26-U),this._strip()},s.prototype.notn=function(M){return this.clone().inotn(M)},s.prototype.setn=function(M,I){i(typeof M=="number"&&M>=0);var U=M/26|0,$=M%26;return this._expand(U+1),I?this.words[U]=this.words[U]|1<<$:this.words[U]=this.words[U]&~(1<<$),this._strip()},s.prototype.iadd=function(M){var I;if(this.negative!==0&&M.negative===0)return this.negative=0,I=this.isub(M),this.negative^=1,this._normSign();if(this.negative===0&&M.negative!==0)return M.negative=0,I=this.isub(M),M.negative=1,I._normSign();var U,$;this.length>M.length?(U=this,$=M):(U=M,$=this);for(var ee=0,Q=0;Q<$.length;Q++)I=(U.words[Q]|0)+($.words[Q]|0)+ee,this.words[Q]=I&67108863,ee=I>>>26;for(;ee!==0&&Q<U.length;Q++)I=(U.words[Q]|0)+ee,this.words[Q]=I&67108863,ee=I>>>26;if(this.length=U.length,ee!==0)this.words[this.length]=ee,this.length++;else if(U!==this)for(;Q<U.length;Q++)this.words[Q]=U.words[Q];return this},s.prototype.add=function(M){var I;return M.negative!==0&&this.negative===0?(M.negative=0,I=this.sub(M),M.negative^=1,I):M.negative===0&&this.negative!==0?(this.negative=0,I=M.sub(this),this.negative=1,I):this.length>M.length?this.clone().iadd(M):M.clone().iadd(this)},s.prototype.isub=function(M){if(M.negative!==0){M.negative=0;var I=this.iadd(M);return M.negative=1,I._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(M),this.negative=1,this._normSign();var U=this.cmp(M);if(U===0)return this.negative=0,this.length=1,this.words[0]=0,this;var $,ee;U>0?($=this,ee=M):($=M,ee=this);for(var Q=0,G=0;G<ee.length;G++)I=($.words[G]|0)-(ee.words[G]|0)+Q,Q=I>>26,this.words[G]=I&67108863;for(;Q!==0&&G<$.length;G++)I=($.words[G]|0)+Q,Q=I>>26,this.words[G]=I&67108863;if(Q===0&&G<$.length&&$!==this)for(;G<$.length;G++)this.words[G]=$.words[G];return this.length=Math.max(this.length,G),$!==this&&(this.negative=1),this._strip()},s.prototype.sub=function(M){return this.clone().isub(M)};function E(L,M,I){I.negative=M.negative^L.negative;var U=L.length+M.length|0;I.length=U,U=U-1|0;var $=L.words[0]|0,ee=M.words[0]|0,Q=$*ee,G=Q&67108863,K=Q/67108864|0;I.words[0]=G;for(var Y=1;Y<U;Y++){for(var we=K>>>26,Ke=K&67108863,ge=Math.min(Y,M.length-1),me=Math.max(0,Y-L.length+1);me<=ge;me++){var De=Y-me|0;$=L.words[De]|0,ee=M.words[me]|0,Q=$*ee+Ke,we+=Q/67108864|0,Ke=Q&67108863}I.words[Y]=Ke|0,K=we|0}return K!==0?I.words[Y]=K|0:I.length--,I._strip()}var T=function(M,I,U){var $=M.words,ee=I.words,Q=U.words,G=0,K,Y,we,Ke=$[0]|0,ge=Ke&8191,me=Ke>>>13,De=$[1]|0,ze=De&8191,tt=De>>>13,rt=$[2]|0,vt=rt&8191,Ye=rt>>>13,Pe=$[3]|0,Be=Pe&8191,$e=Pe>>>13,Je=$[4]|0,We=Je&8191,_e=Je>>>13,Ee=$[5]|0,Oe=Ee&8191,Le=Ee>>>13,ce=$[6]|0,he=ce&8191,ie=ce>>>13,V=$[7]|0,Z=V&8191,B=V>>>13,S=$[8]|0,R=S&8191,X=S>>>13,xe=$[9]|0,Ie=xe&8191,ye=xe>>>13,nt=ee[0]|0,at=nt&8191,mt=nt>>>13,wt=ee[1]|0,Lt=wt&8191,Ct=wt>>>13,ut=ee[2]|0,St=ut&8191,Tt=ut>>>13,gn=ee[3]|0,An=gn&8191,un=gn>>>13,Mn=ee[4]|0,Cn=Mn&8191,wn=Mn>>>13,zn=ee[5]|0,ai=zn&8191,xn=zn>>>13,Zn=ee[6]|0,Me=Zn&8191,le=Zn>>>13,be=ee[7]|0,q=be&8191,Se=be>>>13,Ge=ee[8]|0,lt=Ge&8191,dt=Ge>>>13,Re=ee[9]|0,Ue=Re&8191,Xe=Re>>>13;U.negative=M.negative^I.negative,U.length=19,K=Math.imul(ge,at),Y=Math.imul(ge,mt),Y=Y+Math.imul(me,at)|0,we=Math.imul(me,mt);var ft=(G+K|0)+((Y&8191)<<13)|0;G=(we+(Y>>>13)|0)+(ft>>>26)|0,ft&=67108863,K=Math.imul(ze,at),Y=Math.imul(ze,mt),Y=Y+Math.imul(tt,at)|0,we=Math.imul(tt,mt),K=K+Math.imul(ge,Lt)|0,Y=Y+Math.imul(ge,Ct)|0,Y=Y+Math.imul(me,Lt)|0,we=we+Math.imul(me,Ct)|0;var it=(G+K|0)+((Y&8191)<<13)|0;G=(we+(Y>>>13)|0)+(it>>>26)|0,it&=67108863,K=Math.imul(vt,at),Y=Math.imul(vt,mt),Y=Y+Math.imul(Ye,at)|0,we=Math.imul(Ye,mt),K=K+Math.imul(ze,Lt)|0,Y=Y+Math.imul(ze,Ct)|0,Y=Y+Math.imul(tt,Lt)|0,we=we+Math.imul(tt,Ct)|0,K=K+Math.imul(ge,St)|0,Y=Y+Math.imul(ge,Tt)|0,Y=Y+Math.imul(me,St)|0,we=we+Math.imul(me,Tt)|0;var xt=(G+K|0)+((Y&8191)<<13)|0;G=(we+(Y>>>13)|0)+(xt>>>26)|0,xt&=67108863,K=Math.imul(Be,at),Y=Math.imul(Be,mt),Y=Y+Math.imul($e,at)|0,we=Math.imul($e,mt),K=K+Math.imul(vt,Lt)|0,Y=Y+Math.imul(vt,Ct)|0,Y=Y+Math.imul(Ye,Lt)|0,we=we+Math.imul(Ye,Ct)|0,K=K+Math.imul(ze,St)|0,Y=Y+Math.imul(ze,Tt)|0,Y=Y+Math.imul(tt,St)|0,we=we+Math.imul(tt,Tt)|0,K=K+Math.imul(ge,An)|0,Y=Y+Math.imul(ge,un)|0,Y=Y+Math.imul(me,An)|0,we=we+Math.imul(me,un)|0;var Dt=(G+K|0)+((Y&8191)<<13)|0;G=(we+(Y>>>13)|0)+(Dt>>>26)|0,Dt&=67108863,K=Math.imul(We,at),Y=Math.imul(We,mt),Y=Y+Math.imul(_e,at)|0,we=Math.imul(_e,mt),K=K+Math.imul(Be,Lt)|0,Y=Y+Math.imul(Be,Ct)|0,Y=Y+Math.imul($e,Lt)|0,we=we+Math.imul($e,Ct)|0,K=K+Math.imul(vt,St)|0,Y=Y+Math.imul(vt,Tt)|0,Y=Y+Math.imul(Ye,St)|0,we=we+Math.imul(Ye,Tt)|0,K=K+Math.imul(ze,An)|0,Y=Y+Math.imul(ze,un)|0,Y=Y+Math.imul(tt,An)|0,we=we+Math.imul(tt,un)|0,K=K+Math.imul(ge,Cn)|0,Y=Y+Math.imul(ge,wn)|0,Y=Y+Math.imul(me,Cn)|0,we=we+Math.imul(me,wn)|0;var Kt=(G+K|0)+((Y&8191)<<13)|0;G=(we+(Y>>>13)|0)+(Kt>>>26)|0,Kt&=67108863,K=Math.imul(Oe,at),Y=Math.imul(Oe,mt),Y=Y+Math.imul(Le,at)|0,we=Math.imul(Le,mt),K=K+Math.imul(We,Lt)|0,Y=Y+Math.imul(We,Ct)|0,Y=Y+Math.imul(_e,Lt)|0,we=we+Math.imul(_e,Ct)|0,K=K+Math.imul(Be,St)|0,Y=Y+Math.imul(Be,Tt)|0,Y=Y+Math.imul($e,St)|0,we=we+Math.imul($e,Tt)|0,K=K+Math.imul(vt,An)|0,Y=Y+Math.imul(vt,un)|0,Y=Y+Math.imul(Ye,An)|0,we=we+Math.imul(Ye,un)|0,K=K+Math.imul(ze,Cn)|0,Y=Y+Math.imul(ze,wn)|0,Y=Y+Math.imul(tt,Cn)|0,we=we+Math.imul(tt,wn)|0,K=K+Math.imul(ge,ai)|0,Y=Y+Math.imul(ge,xn)|0,Y=Y+Math.imul(me,ai)|0,we=we+Math.imul(me,xn)|0;var Wt=(G+K|0)+((Y&8191)<<13)|0;G=(we+(Y>>>13)|0)+(Wt>>>26)|0,Wt&=67108863,K=Math.imul(he,at),Y=Math.imul(he,mt),Y=Y+Math.imul(ie,at)|0,we=Math.imul(ie,mt),K=K+Math.imul(Oe,Lt)|0,Y=Y+Math.imul(Oe,Ct)|0,Y=Y+Math.imul(Le,Lt)|0,we=we+Math.imul(Le,Ct)|0,K=K+Math.imul(We,St)|0,Y=Y+Math.imul(We,Tt)|0,Y=Y+Math.imul(_e,St)|0,we=we+Math.imul(_e,Tt)|0,K=K+Math.imul(Be,An)|0,Y=Y+Math.imul(Be,un)|0,Y=Y+Math.imul($e,An)|0,we=we+Math.imul($e,un)|0,K=K+Math.imul(vt,Cn)|0,Y=Y+Math.imul(vt,wn)|0,Y=Y+Math.imul(Ye,Cn)|0,we=we+Math.imul(Ye,wn)|0,K=K+Math.imul(ze,ai)|0,Y=Y+Math.imul(ze,xn)|0,Y=Y+Math.imul(tt,ai)|0,we=we+Math.imul(tt,xn)|0,K=K+Math.imul(ge,Me)|0,Y=Y+Math.imul(ge,le)|0,Y=Y+Math.imul(me,Me)|0,we=we+Math.imul(me,le)|0;var bt=(G+K|0)+((Y&8191)<<13)|0;G=(we+(Y>>>13)|0)+(bt>>>26)|0,bt&=67108863,K=Math.imul(Z,at),Y=Math.imul(Z,mt),Y=Y+Math.imul(B,at)|0,we=Math.imul(B,mt),K=K+Math.imul(he,Lt)|0,Y=Y+Math.imul(he,Ct)|0,Y=Y+Math.imul(ie,Lt)|0,we=we+Math.imul(ie,Ct)|0,K=K+Math.imul(Oe,St)|0,Y=Y+Math.imul(Oe,Tt)|0,Y=Y+Math.imul(Le,St)|0,we=we+Math.imul(Le,Tt)|0,K=K+Math.imul(We,An)|0,Y=Y+Math.imul(We,un)|0,Y=Y+Math.imul(_e,An)|0,we=we+Math.imul(_e,un)|0,K=K+Math.imul(Be,Cn)|0,Y=Y+Math.imul(Be,wn)|0,Y=Y+Math.imul($e,Cn)|0,we=we+Math.imul($e,wn)|0,K=K+Math.imul(vt,ai)|0,Y=Y+Math.imul(vt,xn)|0,Y=Y+Math.imul(Ye,ai)|0,we=we+Math.imul(Ye,xn)|0,K=K+Math.imul(ze,Me)|0,Y=Y+Math.imul(ze,le)|0,Y=Y+Math.imul(tt,Me)|0,we=we+Math.imul(tt,le)|0,K=K+Math.imul(ge,q)|0,Y=Y+Math.imul(ge,Se)|0,Y=Y+Math.imul(me,q)|0,we=we+Math.imul(me,Se)|0;var jt=(G+K|0)+((Y&8191)<<13)|0;G=(we+(Y>>>13)|0)+(jt>>>26)|0,jt&=67108863,K=Math.imul(R,at),Y=Math.imul(R,mt),Y=Y+Math.imul(X,at)|0,we=Math.imul(X,mt),K=K+Math.imul(Z,Lt)|0,Y=Y+Math.imul(Z,Ct)|0,Y=Y+Math.imul(B,Lt)|0,we=we+Math.imul(B,Ct)|0,K=K+Math.imul(he,St)|0,Y=Y+Math.imul(he,Tt)|0,Y=Y+Math.imul(ie,St)|0,we=we+Math.imul(ie,Tt)|0,K=K+Math.imul(Oe,An)|0,Y=Y+Math.imul(Oe,un)|0,Y=Y+Math.imul(Le,An)|0,we=we+Math.imul(Le,un)|0,K=K+Math.imul(We,Cn)|0,Y=Y+Math.imul(We,wn)|0,Y=Y+Math.imul(_e,Cn)|0,we=we+Math.imul(_e,wn)|0,K=K+Math.imul(Be,ai)|0,Y=Y+Math.imul(Be,xn)|0,Y=Y+Math.imul($e,ai)|0,we=we+Math.imul($e,xn)|0,K=K+Math.imul(vt,Me)|0,Y=Y+Math.imul(vt,le)|0,Y=Y+Math.imul(Ye,Me)|0,we=we+Math.imul(Ye,le)|0,K=K+Math.imul(ze,q)|0,Y=Y+Math.imul(ze,Se)|0,Y=Y+Math.imul(tt,q)|0,we=we+Math.imul(tt,Se)|0,K=K+Math.imul(ge,lt)|0,Y=Y+Math.imul(ge,dt)|0,Y=Y+Math.imul(me,lt)|0,we=we+Math.imul(me,dt)|0;var on=(G+K|0)+((Y&8191)<<13)|0;G=(we+(Y>>>13)|0)+(on>>>26)|0,on&=67108863,K=Math.imul(Ie,at),Y=Math.imul(Ie,mt),Y=Y+Math.imul(ye,at)|0,we=Math.imul(ye,mt),K=K+Math.imul(R,Lt)|0,Y=Y+Math.imul(R,Ct)|0,Y=Y+Math.imul(X,Lt)|0,we=we+Math.imul(X,Ct)|0,K=K+Math.imul(Z,St)|0,Y=Y+Math.imul(Z,Tt)|0,Y=Y+Math.imul(B,St)|0,we=we+Math.imul(B,Tt)|0,K=K+Math.imul(he,An)|0,Y=Y+Math.imul(he,un)|0,Y=Y+Math.imul(ie,An)|0,we=we+Math.imul(ie,un)|0,K=K+Math.imul(Oe,Cn)|0,Y=Y+Math.imul(Oe,wn)|0,Y=Y+Math.imul(Le,Cn)|0,we=we+Math.imul(Le,wn)|0,K=K+Math.imul(We,ai)|0,Y=Y+Math.imul(We,xn)|0,Y=Y+Math.imul(_e,ai)|0,we=we+Math.imul(_e,xn)|0,K=K+Math.imul(Be,Me)|0,Y=Y+Math.imul(Be,le)|0,Y=Y+Math.imul($e,Me)|0,we=we+Math.imul($e,le)|0,K=K+Math.imul(vt,q)|0,Y=Y+Math.imul(vt,Se)|0,Y=Y+Math.imul(Ye,q)|0,we=we+Math.imul(Ye,Se)|0,K=K+Math.imul(ze,lt)|0,Y=Y+Math.imul(ze,dt)|0,Y=Y+Math.imul(tt,lt)|0,we=we+Math.imul(tt,dt)|0,K=K+Math.imul(ge,Ue)|0,Y=Y+Math.imul(ge,Xe)|0,Y=Y+Math.imul(me,Ue)|0,we=we+Math.imul(me,Xe)|0;var $t=(G+K|0)+((Y&8191)<<13)|0;G=(we+(Y>>>13)|0)+($t>>>26)|0,$t&=67108863,K=Math.imul(Ie,Lt),Y=Math.imul(Ie,Ct),Y=Y+Math.imul(ye,Lt)|0,we=Math.imul(ye,Ct),K=K+Math.imul(R,St)|0,Y=Y+Math.imul(R,Tt)|0,Y=Y+Math.imul(X,St)|0,we=we+Math.imul(X,Tt)|0,K=K+Math.imul(Z,An)|0,Y=Y+Math.imul(Z,un)|0,Y=Y+Math.imul(B,An)|0,we=we+Math.imul(B,un)|0,K=K+Math.imul(he,Cn)|0,Y=Y+Math.imul(he,wn)|0,Y=Y+Math.imul(ie,Cn)|0,we=we+Math.imul(ie,wn)|0,K=K+Math.imul(Oe,ai)|0,Y=Y+Math.imul(Oe,xn)|0,Y=Y+Math.imul(Le,ai)|0,we=we+Math.imul(Le,xn)|0,K=K+Math.imul(We,Me)|0,Y=Y+Math.imul(We,le)|0,Y=Y+Math.imul(_e,Me)|0,we=we+Math.imul(_e,le)|0,K=K+Math.imul(Be,q)|0,Y=Y+Math.imul(Be,Se)|0,Y=Y+Math.imul($e,q)|0,we=we+Math.imul($e,Se)|0,K=K+Math.imul(vt,lt)|0,Y=Y+Math.imul(vt,dt)|0,Y=Y+Math.imul(Ye,lt)|0,we=we+Math.imul(Ye,dt)|0,K=K+Math.imul(ze,Ue)|0,Y=Y+Math.imul(ze,Xe)|0,Y=Y+Math.imul(tt,Ue)|0,we=we+Math.imul(tt,Xe)|0;var vn=(G+K|0)+((Y&8191)<<13)|0;G=(we+(Y>>>13)|0)+(vn>>>26)|0,vn&=67108863,K=Math.imul(Ie,St),Y=Math.imul(Ie,Tt),Y=Y+Math.imul(ye,St)|0,we=Math.imul(ye,Tt),K=K+Math.imul(R,An)|0,Y=Y+Math.imul(R,un)|0,Y=Y+Math.imul(X,An)|0,we=we+Math.imul(X,un)|0,K=K+Math.imul(Z,Cn)|0,Y=Y+Math.imul(Z,wn)|0,Y=Y+Math.imul(B,Cn)|0,we=we+Math.imul(B,wn)|0,K=K+Math.imul(he,ai)|0,Y=Y+Math.imul(he,xn)|0,Y=Y+Math.imul(ie,ai)|0,we=we+Math.imul(ie,xn)|0,K=K+Math.imul(Oe,Me)|0,Y=Y+Math.imul(Oe,le)|0,Y=Y+Math.imul(Le,Me)|0,we=we+Math.imul(Le,le)|0,K=K+Math.imul(We,q)|0,Y=Y+Math.imul(We,Se)|0,Y=Y+Math.imul(_e,q)|0,we=we+Math.imul(_e,Se)|0,K=K+Math.imul(Be,lt)|0,Y=Y+Math.imul(Be,dt)|0,Y=Y+Math.imul($e,lt)|0,we=we+Math.imul($e,dt)|0,K=K+Math.imul(vt,Ue)|0,Y=Y+Math.imul(vt,Xe)|0,Y=Y+Math.imul(Ye,Ue)|0,we=we+Math.imul(Ye,Xe)|0;var Jt=(G+K|0)+((Y&8191)<<13)|0;G=(we+(Y>>>13)|0)+(Jt>>>26)|0,Jt&=67108863,K=Math.imul(Ie,An),Y=Math.imul(Ie,un),Y=Y+Math.imul(ye,An)|0,we=Math.imul(ye,un),K=K+Math.imul(R,Cn)|0,Y=Y+Math.imul(R,wn)|0,Y=Y+Math.imul(X,Cn)|0,we=we+Math.imul(X,wn)|0,K=K+Math.imul(Z,ai)|0,Y=Y+Math.imul(Z,xn)|0,Y=Y+Math.imul(B,ai)|0,we=we+Math.imul(B,xn)|0,K=K+Math.imul(he,Me)|0,Y=Y+Math.imul(he,le)|0,Y=Y+Math.imul(ie,Me)|0,we=we+Math.imul(ie,le)|0,K=K+Math.imul(Oe,q)|0,Y=Y+Math.imul(Oe,Se)|0,Y=Y+Math.imul(Le,q)|0,we=we+Math.imul(Le,Se)|0,K=K+Math.imul(We,lt)|0,Y=Y+Math.imul(We,dt)|0,Y=Y+Math.imul(_e,lt)|0,we=we+Math.imul(_e,dt)|0,K=K+Math.imul(Be,Ue)|0,Y=Y+Math.imul(Be,Xe)|0,Y=Y+Math.imul($e,Ue)|0,we=we+Math.imul($e,Xe)|0;var nn=(G+K|0)+((Y&8191)<<13)|0;G=(we+(Y>>>13)|0)+(nn>>>26)|0,nn&=67108863,K=Math.imul(Ie,Cn),Y=Math.imul(Ie,wn),Y=Y+Math.imul(ye,Cn)|0,we=Math.imul(ye,wn),K=K+Math.imul(R,ai)|0,Y=Y+Math.imul(R,xn)|0,Y=Y+Math.imul(X,ai)|0,we=we+Math.imul(X,xn)|0,K=K+Math.imul(Z,Me)|0,Y=Y+Math.imul(Z,le)|0,Y=Y+Math.imul(B,Me)|0,we=we+Math.imul(B,le)|0,K=K+Math.imul(he,q)|0,Y=Y+Math.imul(he,Se)|0,Y=Y+Math.imul(ie,q)|0,we=we+Math.imul(ie,Se)|0,K=K+Math.imul(Oe,lt)|0,Y=Y+Math.imul(Oe,dt)|0,Y=Y+Math.imul(Le,lt)|0,we=we+Math.imul(Le,dt)|0,K=K+Math.imul(We,Ue)|0,Y=Y+Math.imul(We,Xe)|0,Y=Y+Math.imul(_e,Ue)|0,we=we+Math.imul(_e,Xe)|0;var hn=(G+K|0)+((Y&8191)<<13)|0;G=(we+(Y>>>13)|0)+(hn>>>26)|0,hn&=67108863,K=Math.imul(Ie,ai),Y=Math.imul(Ie,xn),Y=Y+Math.imul(ye,ai)|0,we=Math.imul(ye,xn),K=K+Math.imul(R,Me)|0,Y=Y+Math.imul(R,le)|0,Y=Y+Math.imul(X,Me)|0,we=we+Math.imul(X,le)|0,K=K+Math.imul(Z,q)|0,Y=Y+Math.imul(Z,Se)|0,Y=Y+Math.imul(B,q)|0,we=we+Math.imul(B,Se)|0,K=K+Math.imul(he,lt)|0,Y=Y+Math.imul(he,dt)|0,Y=Y+Math.imul(ie,lt)|0,we=we+Math.imul(ie,dt)|0,K=K+Math.imul(Oe,Ue)|0,Y=Y+Math.imul(Oe,Xe)|0,Y=Y+Math.imul(Le,Ue)|0,we=we+Math.imul(Le,Xe)|0;var rn=(G+K|0)+((Y&8191)<<13)|0;G=(we+(Y>>>13)|0)+(rn>>>26)|0,rn&=67108863,K=Math.imul(Ie,Me),Y=Math.imul(Ie,le),Y=Y+Math.imul(ye,Me)|0,we=Math.imul(ye,le),K=K+Math.imul(R,q)|0,Y=Y+Math.imul(R,Se)|0,Y=Y+Math.imul(X,q)|0,we=we+Math.imul(X,Se)|0,K=K+Math.imul(Z,lt)|0,Y=Y+Math.imul(Z,dt)|0,Y=Y+Math.imul(B,lt)|0,we=we+Math.imul(B,dt)|0,K=K+Math.imul(he,Ue)|0,Y=Y+Math.imul(he,Xe)|0,Y=Y+Math.imul(ie,Ue)|0,we=we+Math.imul(ie,Xe)|0;var Rt=(G+K|0)+((Y&8191)<<13)|0;G=(we+(Y>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,K=Math.imul(Ie,q),Y=Math.imul(Ie,Se),Y=Y+Math.imul(ye,q)|0,we=Math.imul(ye,Se),K=K+Math.imul(R,lt)|0,Y=Y+Math.imul(R,dt)|0,Y=Y+Math.imul(X,lt)|0,we=we+Math.imul(X,dt)|0,K=K+Math.imul(Z,Ue)|0,Y=Y+Math.imul(Z,Xe)|0,Y=Y+Math.imul(B,Ue)|0,we=we+Math.imul(B,Xe)|0;var yt=(G+K|0)+((Y&8191)<<13)|0;G=(we+(Y>>>13)|0)+(yt>>>26)|0,yt&=67108863,K=Math.imul(Ie,lt),Y=Math.imul(Ie,dt),Y=Y+Math.imul(ye,lt)|0,we=Math.imul(ye,dt),K=K+Math.imul(R,Ue)|0,Y=Y+Math.imul(R,Xe)|0,Y=Y+Math.imul(X,Ue)|0,we=we+Math.imul(X,Xe)|0;var Bt=(G+K|0)+((Y&8191)<<13)|0;G=(we+(Y>>>13)|0)+(Bt>>>26)|0,Bt&=67108863,K=Math.imul(Ie,Ue),Y=Math.imul(Ie,Xe),Y=Y+Math.imul(ye,Ue)|0,we=Math.imul(ye,Xe);var Ft=(G+K|0)+((Y&8191)<<13)|0;return G=(we+(Y>>>13)|0)+(Ft>>>26)|0,Ft&=67108863,Q[0]=ft,Q[1]=it,Q[2]=xt,Q[3]=Dt,Q[4]=Kt,Q[5]=Wt,Q[6]=bt,Q[7]=jt,Q[8]=on,Q[9]=$t,Q[10]=vn,Q[11]=Jt,Q[12]=nn,Q[13]=hn,Q[14]=rn,Q[15]=Rt,Q[16]=yt,Q[17]=Bt,Q[18]=Ft,G!==0&&(Q[19]=G,U.length++),U};Math.imul||(T=E);function P(L,M,I){I.negative=M.negative^L.negative,I.length=L.length+M.length;for(var U=0,$=0,ee=0;ee<I.length-1;ee++){var Q=$;$=0;for(var G=U&67108863,K=Math.min(ee,M.length-1),Y=Math.max(0,ee-L.length+1);Y<=K;Y++){var we=ee-Y,Ke=L.words[we]|0,ge=M.words[Y]|0,me=Ke*ge,De=me&67108863;Q=Q+(me/67108864|0)|0,De=De+G|0,G=De&67108863,Q=Q+(De>>>26)|0,$+=Q>>>26,Q&=67108863}I.words[ee]=G,U=Q,Q=$}return U!==0?I.words[ee]=U:I.length--,I._strip()}function D(L,M,I){return P(L,M,I)}s.prototype.mulTo=function(M,I){var U,$=this.length+M.length;return this.length===10&&M.length===10?U=T(this,M,I):$<63?U=E(this,M,I):$<1024?U=P(this,M,I):U=D(this,M,I),U},s.prototype.mul=function(M){var I=new s(null);return I.words=new Array(this.length+M.length),this.mulTo(M,I)},s.prototype.mulf=function(M){var I=new s(null);return I.words=new Array(this.length+M.length),D(this,M,I)},s.prototype.imul=function(M){return this.clone().mulTo(M,this)},s.prototype.imuln=function(M){var I=M<0;I&&(M=-M),i(typeof M=="number"),i(M<67108864);for(var U=0,$=0;$<this.length;$++){var ee=(this.words[$]|0)*M,Q=(ee&67108863)+(U&67108863);U>>=26,U+=ee/67108864|0,U+=Q>>>26,this.words[$]=Q&67108863}return U!==0&&(this.words[$]=U,this.length++),I?this.ineg():this},s.prototype.muln=function(M){return this.clone().imuln(M)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(M){var I=b(M);if(I.length===0)return new s(1);for(var U=this,$=0;$<I.length&&I[$]===0;$++,U=U.sqr());if(++$<I.length)for(var ee=U.sqr();$<I.length;$++,ee=ee.sqr())I[$]!==0&&(U=U.mul(ee));return U},s.prototype.iushln=function(M){i(typeof M=="number"&&M>=0);var I=M%26,U=(M-I)/26,$=67108863>>>26-I<<26-I,ee;if(I!==0){var Q=0;for(ee=0;ee<this.length;ee++){var G=this.words[ee]&$,K=(this.words[ee]|0)-G<<I;this.words[ee]=K|Q,Q=G>>>26-I}Q&&(this.words[ee]=Q,this.length++)}if(U!==0){for(ee=this.length-1;ee>=0;ee--)this.words[ee+U]=this.words[ee];for(ee=0;ee<U;ee++)this.words[ee]=0;this.length+=U}return this._strip()},s.prototype.ishln=function(M){return i(this.negative===0),this.iushln(M)},s.prototype.iushrn=function(M,I,U){i(typeof M=="number"&&M>=0);var $;I?$=(I-I%26)/26:$=0;var ee=M%26,Q=Math.min((M-ee)/26,this.length),G=67108863^67108863>>>ee<<ee,K=U;if($-=Q,$=Math.max(0,$),K){for(var Y=0;Y<Q;Y++)K.words[Y]=this.words[Y];K.length=Q}if(Q!==0)if(this.length>Q)for(this.length-=Q,Y=0;Y<this.length;Y++)this.words[Y]=this.words[Y+Q];else this.words[0]=0,this.length=1;var we=0;for(Y=this.length-1;Y>=0&&(we!==0||Y>=$);Y--){var Ke=this.words[Y]|0;this.words[Y]=we<<26-ee|Ke>>>ee,we=Ke&G}return K&&we!==0&&(K.words[K.length++]=we),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},s.prototype.ishrn=function(M,I,U){return i(this.negative===0),this.iushrn(M,I,U)},s.prototype.shln=function(M){return this.clone().ishln(M)},s.prototype.ushln=function(M){return this.clone().iushln(M)},s.prototype.shrn=function(M){return this.clone().ishrn(M)},s.prototype.ushrn=function(M){return this.clone().iushrn(M)},s.prototype.testn=function(M){i(typeof M=="number"&&M>=0);var I=M%26,U=(M-I)/26,$=1<<I;if(this.length<=U)return!1;var ee=this.words[U];return!!(ee&$)},s.prototype.imaskn=function(M){i(typeof M=="number"&&M>=0);var I=M%26,U=(M-I)/26;if(i(this.negative===0,"imaskn works only with positive numbers"),this.length<=U)return this;if(I!==0&&U++,this.length=Math.min(U,this.length),I!==0){var $=67108863^67108863>>>I<<I;this.words[this.length-1]&=$}return this._strip()},s.prototype.maskn=function(M){return this.clone().imaskn(M)},s.prototype.iaddn=function(M){return i(typeof M=="number"),i(M<67108864),M<0?this.isubn(-M):this.negative!==0?this.length===1&&(this.words[0]|0)<=M?(this.words[0]=M-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(M),this.negative=1,this):this._iaddn(M)},s.prototype._iaddn=function(M){this.words[0]+=M;for(var I=0;I<this.length&&this.words[I]>=67108864;I++)this.words[I]-=67108864,I===this.length-1?this.words[I+1]=1:this.words[I+1]++;return this.length=Math.max(this.length,I+1),this},s.prototype.isubn=function(M){if(i(typeof M=="number"),i(M<67108864),M<0)return this.iaddn(-M);if(this.negative!==0)return this.negative=0,this.iaddn(M),this.negative=1,this;if(this.words[0]-=M,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var I=0;I<this.length&&this.words[I]<0;I++)this.words[I]+=67108864,this.words[I+1]-=1;return this._strip()},s.prototype.addn=function(M){return this.clone().iaddn(M)},s.prototype.subn=function(M){return this.clone().isubn(M)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(M,I,U){var $=M.length+U,ee;this._expand($);var Q,G=0;for(ee=0;ee<M.length;ee++){Q=(this.words[ee+U]|0)+G;var K=(M.words[ee]|0)*I;Q-=K&67108863,G=(Q>>26)-(K/67108864|0),this.words[ee+U]=Q&67108863}for(;ee<this.length-U;ee++)Q=(this.words[ee+U]|0)+G,G=Q>>26,this.words[ee+U]=Q&67108863;if(G===0)return this._strip();for(i(G===-1),G=0,ee=0;ee<this.length;ee++)Q=-(this.words[ee]|0)+G,G=Q>>26,this.words[ee]=Q&67108863;return this.negative=1,this._strip()},s.prototype._wordDiv=function(M,I){var U=this.length-M.length,$=this.clone(),ee=M,Q=ee.words[ee.length-1]|0,G=this._countBits(Q);U=26-G,U!==0&&(ee=ee.ushln(U),$.iushln(U),Q=ee.words[ee.length-1]|0);var K=$.length-ee.length,Y;if(I!=="mod"){Y=new s(null),Y.length=K+1,Y.words=new Array(Y.length);for(var we=0;we<Y.length;we++)Y.words[we]=0}var Ke=$.clone()._ishlnsubmul(ee,1,K);Ke.negative===0&&($=Ke,Y&&(Y.words[K]=1));for(var ge=K-1;ge>=0;ge--){var me=($.words[ee.length+ge]|0)*67108864+($.words[ee.length+ge-1]|0);for(me=Math.min(me/Q|0,67108863),$._ishlnsubmul(ee,me,ge);$.negative!==0;)me--,$.negative=0,$._ishlnsubmul(ee,1,ge),$.isZero()||($.negative^=1);Y&&(Y.words[ge]=me)}return Y&&Y._strip(),$._strip(),I!=="div"&&U!==0&&$.iushrn(U),{div:Y||null,mod:$}},s.prototype.divmod=function(M,I,U){if(i(!M.isZero()),this.isZero())return{div:new s(0),mod:new s(0)};var $,ee,Q;return this.negative!==0&&M.negative===0?(Q=this.neg().divmod(M,I),I!=="mod"&&($=Q.div.neg()),I!=="div"&&(ee=Q.mod.neg(),U&&ee.negative!==0&&ee.iadd(M)),{div:$,mod:ee}):this.negative===0&&M.negative!==0?(Q=this.divmod(M.neg(),I),I!=="mod"&&($=Q.div.neg()),{div:$,mod:Q.mod}):(this.negative&M.negative)!==0?(Q=this.neg().divmod(M.neg(),I),I!=="div"&&(ee=Q.mod.neg(),U&&ee.negative!==0&&ee.isub(M)),{div:Q.div,mod:ee}):M.length>this.length||this.cmp(M)<0?{div:new s(0),mod:this}:M.length===1?I==="div"?{div:this.divn(M.words[0]),mod:null}:I==="mod"?{div:null,mod:new s(this.modrn(M.words[0]))}:{div:this.divn(M.words[0]),mod:new s(this.modrn(M.words[0]))}:this._wordDiv(M,I)},s.prototype.div=function(M){return this.divmod(M,"div",!1).div},s.prototype.mod=function(M){return this.divmod(M,"mod",!1).mod},s.prototype.umod=function(M){return this.divmod(M,"mod",!0).mod},s.prototype.divRound=function(M){var I=this.divmod(M);if(I.mod.isZero())return I.div;var U=I.div.negative!==0?I.mod.isub(M):I.mod,$=M.ushrn(1),ee=M.andln(1),Q=U.cmp($);return Q<0||ee===1&&Q===0?I.div:I.div.negative!==0?I.div.isubn(1):I.div.iaddn(1)},s.prototype.modrn=function(M){var I=M<0;I&&(M=-M),i(M<=67108863);for(var U=(1<<26)%M,$=0,ee=this.length-1;ee>=0;ee--)$=(U*$+(this.words[ee]|0))%M;return I?-$:$},s.prototype.modn=function(M){return this.modrn(M)},s.prototype.idivn=function(M){var I=M<0;I&&(M=-M),i(M<=67108863);for(var U=0,$=this.length-1;$>=0;$--){var ee=(this.words[$]|0)+U*67108864;this.words[$]=ee/M|0,U=ee%M}return this._strip(),I?this.ineg():this},s.prototype.divn=function(M){return this.clone().idivn(M)},s.prototype.egcd=function(M){i(M.negative===0),i(!M.isZero());var I=this,U=M.clone();I.negative!==0?I=I.umod(M):I=I.clone();for(var $=new s(1),ee=new s(0),Q=new s(0),G=new s(1),K=0;I.isEven()&&U.isEven();)I.iushrn(1),U.iushrn(1),++K;for(var Y=U.clone(),we=I.clone();!I.isZero();){for(var Ke=0,ge=1;(I.words[0]&ge)===0&&Ke<26;++Ke,ge<<=1);if(Ke>0)for(I.iushrn(Ke);Ke-- >0;)($.isOdd()||ee.isOdd())&&($.iadd(Y),ee.isub(we)),$.iushrn(1),ee.iushrn(1);for(var me=0,De=1;(U.words[0]&De)===0&&me<26;++me,De<<=1);if(me>0)for(U.iushrn(me);me-- >0;)(Q.isOdd()||G.isOdd())&&(Q.iadd(Y),G.isub(we)),Q.iushrn(1),G.iushrn(1);I.cmp(U)>=0?(I.isub(U),$.isub(Q),ee.isub(G)):(U.isub(I),Q.isub($),G.isub(ee))}return{a:Q,b:G,gcd:U.iushln(K)}},s.prototype._invmp=function(M){i(M.negative===0),i(!M.isZero());var I=this,U=M.clone();I.negative!==0?I=I.umod(M):I=I.clone();for(var $=new s(1),ee=new s(0),Q=U.clone();I.cmpn(1)>0&&U.cmpn(1)>0;){for(var G=0,K=1;(I.words[0]&K)===0&&G<26;++G,K<<=1);if(G>0)for(I.iushrn(G);G-- >0;)$.isOdd()&&$.iadd(Q),$.iushrn(1);for(var Y=0,we=1;(U.words[0]&we)===0&&Y<26;++Y,we<<=1);if(Y>0)for(U.iushrn(Y);Y-- >0;)ee.isOdd()&&ee.iadd(Q),ee.iushrn(1);I.cmp(U)>=0?(I.isub(U),$.isub(ee)):(U.isub(I),ee.isub($))}var Ke;return I.cmpn(1)===0?Ke=$:Ke=ee,Ke.cmpn(0)<0&&Ke.iadd(M),Ke},s.prototype.gcd=function(M){if(this.isZero())return M.abs();if(M.isZero())return this.abs();var I=this.clone(),U=M.clone();I.negative=0,U.negative=0;for(var $=0;I.isEven()&&U.isEven();$++)I.iushrn(1),U.iushrn(1);do{for(;I.isEven();)I.iushrn(1);for(;U.isEven();)U.iushrn(1);var ee=I.cmp(U);if(ee<0){var Q=I;I=U,U=Q}else if(ee===0||U.cmpn(1)===0)break;I.isub(U)}while(!0);return U.iushln($)},s.prototype.invm=function(M){return this.egcd(M).a.umod(M)},s.prototype.isEven=function(){return(this.words[0]&1)===0},s.prototype.isOdd=function(){return(this.words[0]&1)===1},s.prototype.andln=function(M){return this.words[0]&M},s.prototype.bincn=function(M){i(typeof M=="number");var I=M%26,U=(M-I)/26,$=1<<I;if(this.length<=U)return this._expand(U+1),this.words[U]|=$,this;for(var ee=$,Q=U;ee!==0&&Q<this.length;Q++){var G=this.words[Q]|0;G+=ee,ee=G>>>26,G&=67108863,this.words[Q]=G}return ee!==0&&(this.words[Q]=ee,this.length++),this},s.prototype.isZero=function(){return this.length===1&&this.words[0]===0},s.prototype.cmpn=function(M){var I=M<0;if(this.negative!==0&&!I)return-1;if(this.negative===0&&I)return 1;this._strip();var U;if(this.length>1)U=1;else{I&&(M=-M),i(M<=67108863,"Number is too big");var $=this.words[0]|0;U=$===M?0:$<M?-1:1}return this.negative!==0?-U|0:U},s.prototype.cmp=function(M){if(this.negative!==0&&M.negative===0)return-1;if(this.negative===0&&M.negative!==0)return 1;var I=this.ucmp(M);return this.negative!==0?-I|0:I},s.prototype.ucmp=function(M){if(this.length>M.length)return 1;if(this.length<M.length)return-1;for(var I=0,U=this.length-1;U>=0;U--){var $=this.words[U]|0,ee=M.words[U]|0;if($!==ee){$<ee?I=-1:$>ee&&(I=1);break}}return I},s.prototype.gtn=function(M){return this.cmpn(M)===1},s.prototype.gt=function(M){return this.cmp(M)===1},s.prototype.gten=function(M){return this.cmpn(M)>=0},s.prototype.gte=function(M){return this.cmp(M)>=0},s.prototype.ltn=function(M){return this.cmpn(M)===-1},s.prototype.lt=function(M){return this.cmp(M)===-1},s.prototype.lten=function(M){return this.cmpn(M)<=0},s.prototype.lte=function(M){return this.cmp(M)<=0},s.prototype.eqn=function(M){return this.cmpn(M)===0},s.prototype.eq=function(M){return this.cmp(M)===0},s.red=function(M){return new te(M)},s.prototype.toRed=function(M){return i(!this.red,"Already a number in reduction context"),i(this.negative===0,"red works only with positives"),M.convertTo(this)._forceRed(M)},s.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(M){return this.red=M,this},s.prototype.forceRed=function(M){return i(!this.red,"Already a number in reduction context"),this._forceRed(M)},s.prototype.redAdd=function(M){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,M)},s.prototype.redIAdd=function(M){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,M)},s.prototype.redSub=function(M){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,M)},s.prototype.redISub=function(M){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,M)},s.prototype.redShl=function(M){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,M)},s.prototype.redMul=function(M){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,M),this.red.mul(this,M)},s.prototype.redIMul=function(M){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,M),this.red.imul(this,M)},s.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(M){return i(this.red&&!M.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,M)};var F={k256:null,p224:null,p192:null,p25519:null};function k(L,M){this.name=L,this.p=new s(M,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}k.prototype._tmp=function(){var M=new s(null);return M.words=new Array(Math.ceil(this.n/13)),M},k.prototype.ireduce=function(M){var I=M,U;do this.split(I,this.tmp),I=this.imulK(I),I=I.iadd(this.tmp),U=I.bitLength();while(U>this.n);var $=U<this.n?-1:I.ucmp(this.p);return $===0?(I.words[0]=0,I.length=1):$>0?I.isub(this.p):I.strip!==void 0?I.strip():I._strip(),I},k.prototype.split=function(M,I){M.iushrn(this.n,0,I)},k.prototype.imulK=function(M){return M.imul(this.k)};function W(){k.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}o(W,k),W.prototype.split=function(M,I){for(var U=4194303,$=Math.min(M.length,9),ee=0;ee<$;ee++)I.words[ee]=M.words[ee];if(I.length=$,M.length<=9){M.words[0]=0,M.length=1;return}var Q=M.words[9];for(I.words[I.length++]=Q&U,ee=10;ee<M.length;ee++){var G=M.words[ee]|0;M.words[ee-10]=(G&U)<<4|Q>>>22,Q=G}Q>>>=22,M.words[ee-10]=Q,Q===0&&M.length>10?M.length-=10:M.length-=9},W.prototype.imulK=function(M){M.words[M.length]=0,M.words[M.length+1]=0,M.length+=2;for(var I=0,U=0;U<M.length;U++){var $=M.words[U]|0;I+=$*977,M.words[U]=I&67108863,I=$*64+(I/67108864|0)}return M.words[M.length-1]===0&&(M.length--,M.words[M.length-1]===0&&M.length--),M};function j(){k.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}o(j,k);function J(){k.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}o(J,k);function de(){k.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}o(de,k),de.prototype.imulK=function(M){for(var I=0,U=0;U<M.length;U++){var $=(M.words[U]|0)*19+I,ee=$&67108863;$>>>=26,M.words[U]=ee,I=$}return I!==0&&(M.words[M.length++]=I),M},s._prime=function(M){if(F[M])return F[M];var I;if(M==="k256")I=new W;else if(M==="p224")I=new j;else if(M==="p192")I=new J;else if(M==="p25519")I=new de;else throw new Error("Unknown prime "+M);return F[M]=I,I};function te(L){if(typeof L=="string"){var M=s._prime(L);this.m=M.p,this.prime=M}else i(L.gtn(1),"modulus must be greater than 1"),this.m=L,this.prime=null}te.prototype._verify1=function(M){i(M.negative===0,"red works only with positives"),i(M.red,"red works only with red numbers")},te.prototype._verify2=function(M,I){i((M.negative|I.negative)===0,"red works only with positives"),i(M.red&&M.red===I.red,"red works only with red numbers")},te.prototype.imod=function(M){return this.prime?this.prime.ireduce(M)._forceRed(this):(p(M,M.umod(this.m)._forceRed(this)),M)},te.prototype.neg=function(M){return M.isZero()?M.clone():this.m.sub(M)._forceRed(this)},te.prototype.add=function(M,I){this._verify2(M,I);var U=M.add(I);return U.cmp(this.m)>=0&&U.isub(this.m),U._forceRed(this)},te.prototype.iadd=function(M,I){this._verify2(M,I);var U=M.iadd(I);return U.cmp(this.m)>=0&&U.isub(this.m),U},te.prototype.sub=function(M,I){this._verify2(M,I);var U=M.sub(I);return U.cmpn(0)<0&&U.iadd(this.m),U._forceRed(this)},te.prototype.isub=function(M,I){this._verify2(M,I);var U=M.isub(I);return U.cmpn(0)<0&&U.iadd(this.m),U},te.prototype.shl=function(M,I){return this._verify1(M),this.imod(M.ushln(I))},te.prototype.imul=function(M,I){return this._verify2(M,I),this.imod(M.imul(I))},te.prototype.mul=function(M,I){return this._verify2(M,I),this.imod(M.mul(I))},te.prototype.isqr=function(M){return this.imul(M,M.clone())},te.prototype.sqr=function(M){return this.mul(M,M)},te.prototype.sqrt=function(M){if(M.isZero())return M.clone();var I=this.m.andln(3);if(i(I%2===1),I===3){var U=this.m.add(new s(1)).iushrn(2);return this.pow(M,U)}for(var $=this.m.subn(1),ee=0;!$.isZero()&&$.andln(1)===0;)ee++,$.iushrn(1);i(!$.isZero());var Q=new s(1).toRed(this),G=Q.redNeg(),K=this.m.subn(1).iushrn(1),Y=this.m.bitLength();for(Y=new s(2*Y*Y).toRed(this);this.pow(Y,K).cmp(G)!==0;)Y.redIAdd(G);for(var we=this.pow(Y,$),Ke=this.pow(M,$.addn(1).iushrn(1)),ge=this.pow(M,$),me=ee;ge.cmp(Q)!==0;){for(var De=ge,ze=0;De.cmp(Q)!==0;ze++)De=De.redSqr();i(ze<me);var tt=this.pow(we,new s(1).iushln(me-ze-1));Ke=Ke.redMul(tt),we=tt.redSqr(),ge=ge.redMul(we),me=ze}return Ke},te.prototype.invm=function(M){var I=M._invmp(this.m);return I.negative!==0?(I.negative=0,this.imod(I).redNeg()):this.imod(I)},te.prototype.pow=function(M,I){if(I.isZero())return new s(1).toRed(this);if(I.cmpn(1)===0)return M.clone();var U=4,$=new Array(1<<U);$[0]=new s(1).toRed(this),$[1]=M;for(var ee=2;ee<$.length;ee++)$[ee]=this.mul($[ee-1],M);var Q=$[0],G=0,K=0,Y=I.bitLength()%26;for(Y===0&&(Y=26),ee=I.length-1;ee>=0;ee--){for(var we=I.words[ee],Ke=Y-1;Ke>=0;Ke--){var ge=we>>Ke&1;if(Q!==$[0]&&(Q=this.sqr(Q)),ge===0&&G===0){K=0;continue}G<<=1,G|=ge,K++,!(K!==U&&(ee!==0||Ke!==0))&&(Q=this.mul(Q,$[G]),K=0,G=0)}Y=26}return Q},te.prototype.convertTo=function(M){var I=M.umod(this.m);return I===M?I.clone():I},te.prototype.convertFrom=function(M){var I=M.clone();return I.red=null,I},s.mont=function(M){return new N(M)};function N(L){te.call(this,L),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}o(N,te),N.prototype.convertTo=function(M){return this.imod(M.ushln(this.shift))},N.prototype.convertFrom=function(M){var I=this.imod(M.mul(this.rinv));return I.red=null,I},N.prototype.imul=function(M,I){if(M.isZero()||I.isZero())return M.words[0]=0,M.length=1,M;var U=M.imul(I),$=U.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),ee=U.isub($).iushrn(this.shift),Q=ee;return ee.cmp(this.m)>=0?Q=ee.isub(this.m):ee.cmpn(0)<0&&(Q=ee.iadd(this.m)),Q._forceRed(this)},N.prototype.mul=function(M,I){if(M.isZero()||I.isZero())return new s(0)._forceRed(this);var U=M.mul(I),$=U.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),ee=U.isub($).iushrn(this.shift),Q=ee;return ee.cmp(this.m)>=0?Q=ee.isub(this.m):ee.cmpn(0)<0&&(Q=ee.iadd(this.m)),Q._forceRed(this)},N.prototype.invm=function(M){var I=this.imod(M._invmp(this.m).mul(this.r2));return I._forceRed(this)}})(a,Tr)})(iw);var _A=iw.exports,Xb={exports:{}},rw={};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(a){const t=km,n=Ly,i=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;a.Buffer=u,a.SlowBuffer=T,a.INSPECT_MAX_BYTES=50;const o=2147483647;a.kMaxLength=o,u.TYPED_ARRAY_SUPPORT=s(),!u.TYPED_ARRAY_SUPPORT&&typeof console!="undefined"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function s(){try{const B=new Uint8Array(1),S={foo:function(){return 42}};return Object.setPrototypeOf(S,Uint8Array.prototype),Object.setPrototypeOf(B,S),B.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(!!u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(!!u.isBuffer(this))return this.byteOffset}});function c(B){if(B>o)throw new RangeError('The value "'+B+'" is invalid for option "size"');const S=new Uint8Array(B);return Object.setPrototypeOf(S,u.prototype),S}function u(B,S,R){if(typeof B=="number"){if(typeof S=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return m(B)}return h(B,S,R)}u.poolSize=8192;function h(B,S,R){if(typeof B=="string")return y(B,S);if(ArrayBuffer.isView(B))return _(B);if(B==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof B);if(ce(B,ArrayBuffer)||B&&ce(B.buffer,ArrayBuffer)||typeof SharedArrayBuffer!="undefined"&&(ce(B,SharedArrayBuffer)||B&&ce(B.buffer,SharedArrayBuffer)))return x(B,S,R);if(typeof B=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const X=B.valueOf&&B.valueOf();if(X!=null&&X!==B)return u.from(X,S,R);const xe=b(B);if(xe)return xe;if(typeof Symbol!="undefined"&&Symbol.toPrimitive!=null&&typeof B[Symbol.toPrimitive]=="function")return u.from(B[Symbol.toPrimitive]("string"),S,R);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof B)}u.from=function(B,S,R){return h(B,S,R)},Object.setPrototypeOf(u.prototype,Uint8Array.prototype),Object.setPrototypeOf(u,Uint8Array);function f(B){if(typeof B!="number")throw new TypeError('"size" argument must be of type number');if(B<0)throw new RangeError('The value "'+B+'" is invalid for option "size"')}function p(B,S,R){return f(B),B<=0?c(B):S!==void 0?typeof R=="string"?c(B).fill(S,R):c(B).fill(S):c(B)}u.alloc=function(B,S,R){return p(B,S,R)};function m(B){return f(B),c(B<0?0:E(B)|0)}u.allocUnsafe=function(B){return m(B)},u.allocUnsafeSlow=function(B){return m(B)};function y(B,S){if((typeof S!="string"||S==="")&&(S="utf8"),!u.isEncoding(S))throw new TypeError("Unknown encoding: "+S);const R=P(B,S)|0;let X=c(R);const xe=X.write(B,S);return xe!==R&&(X=X.slice(0,xe)),X}function g(B){const S=B.length<0?0:E(B.length)|0,R=c(S);for(let X=0;X<S;X+=1)R[X]=B[X]&255;return R}function _(B){if(ce(B,Uint8Array)){const S=new Uint8Array(B);return x(S.buffer,S.byteOffset,S.byteLength)}return g(B)}function x(B,S,R){if(S<0||B.byteLength<S)throw new RangeError('"offset" is outside of buffer bounds');if(B.byteLength<S+(R||0))throw new RangeError('"length" is outside of buffer bounds');let X;return S===void 0&&R===void 0?X=new Uint8Array(B):R===void 0?X=new Uint8Array(B,S):X=new Uint8Array(B,S,R),Object.setPrototypeOf(X,u.prototype),X}function b(B){if(u.isBuffer(B)){const S=E(B.length)|0,R=c(S);return R.length===0||B.copy(R,0,0,S),R}if(B.length!==void 0)return typeof B.length!="number"||he(B.length)?c(0):g(B);if(B.type==="Buffer"&&Array.isArray(B.data))return g(B.data)}function E(B){if(B>=o)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+o.toString(16)+" bytes");return B|0}function T(B){return+B!=B&&(B=0),u.alloc(+B)}u.isBuffer=function(S){return S!=null&&S._isBuffer===!0&&S!==u.prototype},u.compare=function(S,R){if(ce(S,Uint8Array)&&(S=u.from(S,S.offset,S.byteLength)),ce(R,Uint8Array)&&(R=u.from(R,R.offset,R.byteLength)),!u.isBuffer(S)||!u.isBuffer(R))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(S===R)return 0;let X=S.length,xe=R.length;for(let Ie=0,ye=Math.min(X,xe);Ie<ye;++Ie)if(S[Ie]!==R[Ie]){X=S[Ie],xe=R[Ie];break}return X<xe?-1:xe<X?1:0},u.isEncoding=function(S){switch(String(S).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(S,R){if(!Array.isArray(S))throw new TypeError('"list" argument must be an Array of Buffers');if(S.length===0)return u.alloc(0);let X;if(R===void 0)for(R=0,X=0;X<S.length;++X)R+=S[X].length;const xe=u.allocUnsafe(R);let Ie=0;for(X=0;X<S.length;++X){let ye=S[X];if(ce(ye,Uint8Array))Ie+ye.length>xe.length?(u.isBuffer(ye)||(ye=u.from(ye)),ye.copy(xe,Ie)):Uint8Array.prototype.set.call(xe,ye,Ie);else if(u.isBuffer(ye))ye.copy(xe,Ie);else throw new TypeError('"list" argument must be an Array of Buffers');Ie+=ye.length}return xe};function P(B,S){if(u.isBuffer(B))return B.length;if(ArrayBuffer.isView(B)||ce(B,ArrayBuffer))return B.byteLength;if(typeof B!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof B);const R=B.length,X=arguments.length>2&&arguments[2]===!0;if(!X&&R===0)return 0;let xe=!1;for(;;)switch(S){case"ascii":case"latin1":case"binary":return R;case"utf8":case"utf-8":return We(B).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return R*2;case"hex":return R>>>1;case"base64":return Oe(B).length;default:if(xe)return X?-1:We(B).length;S=(""+S).toLowerCase(),xe=!0}}u.byteLength=P;function D(B,S,R){let X=!1;if((S===void 0||S<0)&&(S=0),S>this.length||((R===void 0||R>this.length)&&(R=this.length),R<=0)||(R>>>=0,S>>>=0,R<=S))return"";for(B||(B="utf8");;)switch(B){case"hex":return Q(this,S,R);case"utf8":case"utf-8":return M(this,S,R);case"ascii":return $(this,S,R);case"latin1":case"binary":return ee(this,S,R);case"base64":return L(this,S,R);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return G(this,S,R);default:if(X)throw new TypeError("Unknown encoding: "+B);B=(B+"").toLowerCase(),X=!0}}u.prototype._isBuffer=!0;function F(B,S,R){const X=B[S];B[S]=B[R],B[R]=X}u.prototype.swap16=function(){const S=this.length;if(S%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let R=0;R<S;R+=2)F(this,R,R+1);return this},u.prototype.swap32=function(){const S=this.length;if(S%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let R=0;R<S;R+=4)F(this,R,R+3),F(this,R+1,R+2);return this},u.prototype.swap64=function(){const S=this.length;if(S%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let R=0;R<S;R+=8)F(this,R,R+7),F(this,R+1,R+6),F(this,R+2,R+5),F(this,R+3,R+4);return this},u.prototype.toString=function(){const S=this.length;return S===0?"":arguments.length===0?M(this,0,S):D.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(S){if(!u.isBuffer(S))throw new TypeError("Argument must be a Buffer");return this===S?!0:u.compare(this,S)===0},u.prototype.inspect=function(){let S="";const R=a.INSPECT_MAX_BYTES;return S=this.toString("hex",0,R).replace(/(.{2})/g,"$1 ").trim(),this.length>R&&(S+=" ... "),"<Buffer "+S+">"},i&&(u.prototype[i]=u.prototype.inspect),u.prototype.compare=function(S,R,X,xe,Ie){if(ce(S,Uint8Array)&&(S=u.from(S,S.offset,S.byteLength)),!u.isBuffer(S))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof S);if(R===void 0&&(R=0),X===void 0&&(X=S?S.length:0),xe===void 0&&(xe=0),Ie===void 0&&(Ie=this.length),R<0||X>S.length||xe<0||Ie>this.length)throw new RangeError("out of range index");if(xe>=Ie&&R>=X)return 0;if(xe>=Ie)return-1;if(R>=X)return 1;if(R>>>=0,X>>>=0,xe>>>=0,Ie>>>=0,this===S)return 0;let ye=Ie-xe,nt=X-R;const at=Math.min(ye,nt),mt=this.slice(xe,Ie),wt=S.slice(R,X);for(let Lt=0;Lt<at;++Lt)if(mt[Lt]!==wt[Lt]){ye=mt[Lt],nt=wt[Lt];break}return ye<nt?-1:nt<ye?1:0};function k(B,S,R,X,xe){if(B.length===0)return-1;if(typeof R=="string"?(X=R,R=0):R>2147483647?R=2147483647:R<-2147483648&&(R=-2147483648),R=+R,he(R)&&(R=xe?0:B.length-1),R<0&&(R=B.length+R),R>=B.length){if(xe)return-1;R=B.length-1}else if(R<0)if(xe)R=0;else return-1;if(typeof S=="string"&&(S=u.from(S,X)),u.isBuffer(S))return S.length===0?-1:W(B,S,R,X,xe);if(typeof S=="number")return S=S&255,typeof Uint8Array.prototype.indexOf=="function"?xe?Uint8Array.prototype.indexOf.call(B,S,R):Uint8Array.prototype.lastIndexOf.call(B,S,R):W(B,[S],R,X,xe);throw new TypeError("val must be string, number or Buffer")}function W(B,S,R,X,xe){let Ie=1,ye=B.length,nt=S.length;if(X!==void 0&&(X=String(X).toLowerCase(),X==="ucs2"||X==="ucs-2"||X==="utf16le"||X==="utf-16le")){if(B.length<2||S.length<2)return-1;Ie=2,ye/=2,nt/=2,R/=2}function at(wt,Lt){return Ie===1?wt[Lt]:wt.readUInt16BE(Lt*Ie)}let mt;if(xe){let wt=-1;for(mt=R;mt<ye;mt++)if(at(B,mt)===at(S,wt===-1?0:mt-wt)){if(wt===-1&&(wt=mt),mt-wt+1===nt)return wt*Ie}else wt!==-1&&(mt-=mt-wt),wt=-1}else for(R+nt>ye&&(R=ye-nt),mt=R;mt>=0;mt--){let wt=!0;for(let Lt=0;Lt<nt;Lt++)if(at(B,mt+Lt)!==at(S,Lt)){wt=!1;break}if(wt)return mt}return-1}u.prototype.includes=function(S,R,X){return this.indexOf(S,R,X)!==-1},u.prototype.indexOf=function(S,R,X){return k(this,S,R,X,!0)},u.prototype.lastIndexOf=function(S,R,X){return k(this,S,R,X,!1)};function j(B,S,R,X){R=Number(R)||0;const xe=B.length-R;X?(X=Number(X),X>xe&&(X=xe)):X=xe;const Ie=S.length;X>Ie/2&&(X=Ie/2);let ye;for(ye=0;ye<X;++ye){const nt=parseInt(S.substr(ye*2,2),16);if(he(nt))return ye;B[R+ye]=nt}return ye}function J(B,S,R,X){return Le(We(S,B.length-R),B,R,X)}function de(B,S,R,X){return Le(_e(S),B,R,X)}function te(B,S,R,X){return Le(Oe(S),B,R,X)}function N(B,S,R,X){return Le(Ee(S,B.length-R),B,R,X)}u.prototype.write=function(S,R,X,xe){if(R===void 0)xe="utf8",X=this.length,R=0;else if(X===void 0&&typeof R=="string")xe=R,X=this.length,R=0;else if(isFinite(R))R=R>>>0,isFinite(X)?(X=X>>>0,xe===void 0&&(xe="utf8")):(xe=X,X=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const Ie=this.length-R;if((X===void 0||X>Ie)&&(X=Ie),S.length>0&&(X<0||R<0)||R>this.length)throw new RangeError("Attempt to write outside buffer bounds");xe||(xe="utf8");let ye=!1;for(;;)switch(xe){case"hex":return j(this,S,R,X);case"utf8":case"utf-8":return J(this,S,R,X);case"ascii":case"latin1":case"binary":return de(this,S,R,X);case"base64":return te(this,S,R,X);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return N(this,S,R,X);default:if(ye)throw new TypeError("Unknown encoding: "+xe);xe=(""+xe).toLowerCase(),ye=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function L(B,S,R){return S===0&&R===B.length?t.fromByteArray(B):t.fromByteArray(B.slice(S,R))}function M(B,S,R){R=Math.min(B.length,R);const X=[];let xe=S;for(;xe<R;){const Ie=B[xe];let ye=null,nt=Ie>239?4:Ie>223?3:Ie>191?2:1;if(xe+nt<=R){let at,mt,wt,Lt;switch(nt){case 1:Ie<128&&(ye=Ie);break;case 2:at=B[xe+1],(at&192)===128&&(Lt=(Ie&31)<<6|at&63,Lt>127&&(ye=Lt));break;case 3:at=B[xe+1],mt=B[xe+2],(at&192)===128&&(mt&192)===128&&(Lt=(Ie&15)<<12|(at&63)<<6|mt&63,Lt>2047&&(Lt<55296||Lt>57343)&&(ye=Lt));break;case 4:at=B[xe+1],mt=B[xe+2],wt=B[xe+3],(at&192)===128&&(mt&192)===128&&(wt&192)===128&&(Lt=(Ie&15)<<18|(at&63)<<12|(mt&63)<<6|wt&63,Lt>65535&&Lt<1114112&&(ye=Lt))}}ye===null?(ye=65533,nt=1):ye>65535&&(ye-=65536,X.push(ye>>>10&1023|55296),ye=56320|ye&1023),X.push(ye),xe+=nt}return U(X)}const I=4096;function U(B){const S=B.length;if(S<=I)return String.fromCharCode.apply(String,B);let R="",X=0;for(;X<S;)R+=String.fromCharCode.apply(String,B.slice(X,X+=I));return R}function $(B,S,R){let X="";R=Math.min(B.length,R);for(let xe=S;xe<R;++xe)X+=String.fromCharCode(B[xe]&127);return X}function ee(B,S,R){let X="";R=Math.min(B.length,R);for(let xe=S;xe<R;++xe)X+=String.fromCharCode(B[xe]);return X}function Q(B,S,R){const X=B.length;(!S||S<0)&&(S=0),(!R||R<0||R>X)&&(R=X);let xe="";for(let Ie=S;Ie<R;++Ie)xe+=ie[B[Ie]];return xe}function G(B,S,R){const X=B.slice(S,R);let xe="";for(let Ie=0;Ie<X.length-1;Ie+=2)xe+=String.fromCharCode(X[Ie]+X[Ie+1]*256);return xe}u.prototype.slice=function(S,R){const X=this.length;S=~~S,R=R===void 0?X:~~R,S<0?(S+=X,S<0&&(S=0)):S>X&&(S=X),R<0?(R+=X,R<0&&(R=0)):R>X&&(R=X),R<S&&(R=S);const xe=this.subarray(S,R);return Object.setPrototypeOf(xe,u.prototype),xe};function K(B,S,R){if(B%1!==0||B<0)throw new RangeError("offset is not uint");if(B+S>R)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(S,R,X){S=S>>>0,R=R>>>0,X||K(S,R,this.length);let xe=this[S],Ie=1,ye=0;for(;++ye<R&&(Ie*=256);)xe+=this[S+ye]*Ie;return xe},u.prototype.readUintBE=u.prototype.readUIntBE=function(S,R,X){S=S>>>0,R=R>>>0,X||K(S,R,this.length);let xe=this[S+--R],Ie=1;for(;R>0&&(Ie*=256);)xe+=this[S+--R]*Ie;return xe},u.prototype.readUint8=u.prototype.readUInt8=function(S,R){return S=S>>>0,R||K(S,1,this.length),this[S]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(S,R){return S=S>>>0,R||K(S,2,this.length),this[S]|this[S+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(S,R){return S=S>>>0,R||K(S,2,this.length),this[S]<<8|this[S+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(S,R){return S=S>>>0,R||K(S,4,this.length),(this[S]|this[S+1]<<8|this[S+2]<<16)+this[S+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(S,R){return S=S>>>0,R||K(S,4,this.length),this[S]*16777216+(this[S+1]<<16|this[S+2]<<8|this[S+3])},u.prototype.readBigUInt64LE=V(function(S){S=S>>>0,Pe(S,"offset");const R=this[S],X=this[S+7];(R===void 0||X===void 0)&&Be(S,this.length-8);const xe=R+this[++S]*2**8+this[++S]*2**16+this[++S]*2**24,Ie=this[++S]+this[++S]*2**8+this[++S]*2**16+X*2**24;return BigInt(xe)+(BigInt(Ie)<<BigInt(32))}),u.prototype.readBigUInt64BE=V(function(S){S=S>>>0,Pe(S,"offset");const R=this[S],X=this[S+7];(R===void 0||X===void 0)&&Be(S,this.length-8);const xe=R*2**24+this[++S]*2**16+this[++S]*2**8+this[++S],Ie=this[++S]*2**24+this[++S]*2**16+this[++S]*2**8+X;return(BigInt(xe)<<BigInt(32))+BigInt(Ie)}),u.prototype.readIntLE=function(S,R,X){S=S>>>0,R=R>>>0,X||K(S,R,this.length);let xe=this[S],Ie=1,ye=0;for(;++ye<R&&(Ie*=256);)xe+=this[S+ye]*Ie;return Ie*=128,xe>=Ie&&(xe-=Math.pow(2,8*R)),xe},u.prototype.readIntBE=function(S,R,X){S=S>>>0,R=R>>>0,X||K(S,R,this.length);let xe=R,Ie=1,ye=this[S+--xe];for(;xe>0&&(Ie*=256);)ye+=this[S+--xe]*Ie;return Ie*=128,ye>=Ie&&(ye-=Math.pow(2,8*R)),ye},u.prototype.readInt8=function(S,R){return S=S>>>0,R||K(S,1,this.length),this[S]&128?(255-this[S]+1)*-1:this[S]},u.prototype.readInt16LE=function(S,R){S=S>>>0,R||K(S,2,this.length);const X=this[S]|this[S+1]<<8;return X&32768?X|4294901760:X},u.prototype.readInt16BE=function(S,R){S=S>>>0,R||K(S,2,this.length);const X=this[S+1]|this[S]<<8;return X&32768?X|4294901760:X},u.prototype.readInt32LE=function(S,R){return S=S>>>0,R||K(S,4,this.length),this[S]|this[S+1]<<8|this[S+2]<<16|this[S+3]<<24},u.prototype.readInt32BE=function(S,R){return S=S>>>0,R||K(S,4,this.length),this[S]<<24|this[S+1]<<16|this[S+2]<<8|this[S+3]},u.prototype.readBigInt64LE=V(function(S){S=S>>>0,Pe(S,"offset");const R=this[S],X=this[S+7];(R===void 0||X===void 0)&&Be(S,this.length-8);const xe=this[S+4]+this[S+5]*2**8+this[S+6]*2**16+(X<<24);return(BigInt(xe)<<BigInt(32))+BigInt(R+this[++S]*2**8+this[++S]*2**16+this[++S]*2**24)}),u.prototype.readBigInt64BE=V(function(S){S=S>>>0,Pe(S,"offset");const R=this[S],X=this[S+7];(R===void 0||X===void 0)&&Be(S,this.length-8);const xe=(R<<24)+this[++S]*2**16+this[++S]*2**8+this[++S];return(BigInt(xe)<<BigInt(32))+BigInt(this[++S]*2**24+this[++S]*2**16+this[++S]*2**8+X)}),u.prototype.readFloatLE=function(S,R){return S=S>>>0,R||K(S,4,this.length),n.read(this,S,!0,23,4)},u.prototype.readFloatBE=function(S,R){return S=S>>>0,R||K(S,4,this.length),n.read(this,S,!1,23,4)},u.prototype.readDoubleLE=function(S,R){return S=S>>>0,R||K(S,8,this.length),n.read(this,S,!0,52,8)},u.prototype.readDoubleBE=function(S,R){return S=S>>>0,R||K(S,8,this.length),n.read(this,S,!1,52,8)};function Y(B,S,R,X,xe,Ie){if(!u.isBuffer(B))throw new TypeError('"buffer" argument must be a Buffer instance');if(S>xe||S<Ie)throw new RangeError('"value" argument is out of bounds');if(R+X>B.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(S,R,X,xe){if(S=+S,R=R>>>0,X=X>>>0,!xe){const nt=Math.pow(2,8*X)-1;Y(this,S,R,X,nt,0)}let Ie=1,ye=0;for(this[R]=S&255;++ye<X&&(Ie*=256);)this[R+ye]=S/Ie&255;return R+X},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(S,R,X,xe){if(S=+S,R=R>>>0,X=X>>>0,!xe){const nt=Math.pow(2,8*X)-1;Y(this,S,R,X,nt,0)}let Ie=X-1,ye=1;for(this[R+Ie]=S&255;--Ie>=0&&(ye*=256);)this[R+Ie]=S/ye&255;return R+X},u.prototype.writeUint8=u.prototype.writeUInt8=function(S,R,X){return S=+S,R=R>>>0,X||Y(this,S,R,1,255,0),this[R]=S&255,R+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(S,R,X){return S=+S,R=R>>>0,X||Y(this,S,R,2,65535,0),this[R]=S&255,this[R+1]=S>>>8,R+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(S,R,X){return S=+S,R=R>>>0,X||Y(this,S,R,2,65535,0),this[R]=S>>>8,this[R+1]=S&255,R+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(S,R,X){return S=+S,R=R>>>0,X||Y(this,S,R,4,4294967295,0),this[R+3]=S>>>24,this[R+2]=S>>>16,this[R+1]=S>>>8,this[R]=S&255,R+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(S,R,X){return S=+S,R=R>>>0,X||Y(this,S,R,4,4294967295,0),this[R]=S>>>24,this[R+1]=S>>>16,this[R+2]=S>>>8,this[R+3]=S&255,R+4};function we(B,S,R,X,xe){Ye(S,X,xe,B,R,7);let Ie=Number(S&BigInt(4294967295));B[R++]=Ie,Ie=Ie>>8,B[R++]=Ie,Ie=Ie>>8,B[R++]=Ie,Ie=Ie>>8,B[R++]=Ie;let ye=Number(S>>BigInt(32)&BigInt(4294967295));return B[R++]=ye,ye=ye>>8,B[R++]=ye,ye=ye>>8,B[R++]=ye,ye=ye>>8,B[R++]=ye,R}function Ke(B,S,R,X,xe){Ye(S,X,xe,B,R,7);let Ie=Number(S&BigInt(4294967295));B[R+7]=Ie,Ie=Ie>>8,B[R+6]=Ie,Ie=Ie>>8,B[R+5]=Ie,Ie=Ie>>8,B[R+4]=Ie;let ye=Number(S>>BigInt(32)&BigInt(4294967295));return B[R+3]=ye,ye=ye>>8,B[R+2]=ye,ye=ye>>8,B[R+1]=ye,ye=ye>>8,B[R]=ye,R+8}u.prototype.writeBigUInt64LE=V(function(S,R=0){return we(this,S,R,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeBigUInt64BE=V(function(S,R=0){return Ke(this,S,R,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeIntLE=function(S,R,X,xe){if(S=+S,R=R>>>0,!xe){const at=Math.pow(2,8*X-1);Y(this,S,R,X,at-1,-at)}let Ie=0,ye=1,nt=0;for(this[R]=S&255;++Ie<X&&(ye*=256);)S<0&&nt===0&&this[R+Ie-1]!==0&&(nt=1),this[R+Ie]=(S/ye>>0)-nt&255;return R+X},u.prototype.writeIntBE=function(S,R,X,xe){if(S=+S,R=R>>>0,!xe){const at=Math.pow(2,8*X-1);Y(this,S,R,X,at-1,-at)}let Ie=X-1,ye=1,nt=0;for(this[R+Ie]=S&255;--Ie>=0&&(ye*=256);)S<0&&nt===0&&this[R+Ie+1]!==0&&(nt=1),this[R+Ie]=(S/ye>>0)-nt&255;return R+X},u.prototype.writeInt8=function(S,R,X){return S=+S,R=R>>>0,X||Y(this,S,R,1,127,-128),S<0&&(S=255+S+1),this[R]=S&255,R+1},u.prototype.writeInt16LE=function(S,R,X){return S=+S,R=R>>>0,X||Y(this,S,R,2,32767,-32768),this[R]=S&255,this[R+1]=S>>>8,R+2},u.prototype.writeInt16BE=function(S,R,X){return S=+S,R=R>>>0,X||Y(this,S,R,2,32767,-32768),this[R]=S>>>8,this[R+1]=S&255,R+2},u.prototype.writeInt32LE=function(S,R,X){return S=+S,R=R>>>0,X||Y(this,S,R,4,2147483647,-2147483648),this[R]=S&255,this[R+1]=S>>>8,this[R+2]=S>>>16,this[R+3]=S>>>24,R+4},u.prototype.writeInt32BE=function(S,R,X){return S=+S,R=R>>>0,X||Y(this,S,R,4,2147483647,-2147483648),S<0&&(S=4294967295+S+1),this[R]=S>>>24,this[R+1]=S>>>16,this[R+2]=S>>>8,this[R+3]=S&255,R+4},u.prototype.writeBigInt64LE=V(function(S,R=0){return we(this,S,R,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),u.prototype.writeBigInt64BE=V(function(S,R=0){return Ke(this,S,R,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function ge(B,S,R,X,xe,Ie){if(R+X>B.length)throw new RangeError("Index out of range");if(R<0)throw new RangeError("Index out of range")}function me(B,S,R,X,xe){return S=+S,R=R>>>0,xe||ge(B,S,R,4),n.write(B,S,R,X,23,4),R+4}u.prototype.writeFloatLE=function(S,R,X){return me(this,S,R,!0,X)},u.prototype.writeFloatBE=function(S,R,X){return me(this,S,R,!1,X)};function De(B,S,R,X,xe){return S=+S,R=R>>>0,xe||ge(B,S,R,8),n.write(B,S,R,X,52,8),R+8}u.prototype.writeDoubleLE=function(S,R,X){return De(this,S,R,!0,X)},u.prototype.writeDoubleBE=function(S,R,X){return De(this,S,R,!1,X)},u.prototype.copy=function(S,R,X,xe){if(!u.isBuffer(S))throw new TypeError("argument should be a Buffer");if(X||(X=0),!xe&&xe!==0&&(xe=this.length),R>=S.length&&(R=S.length),R||(R=0),xe>0&&xe<X&&(xe=X),xe===X||S.length===0||this.length===0)return 0;if(R<0)throw new RangeError("targetStart out of bounds");if(X<0||X>=this.length)throw new RangeError("Index out of range");if(xe<0)throw new RangeError("sourceEnd out of bounds");xe>this.length&&(xe=this.length),S.length-R<xe-X&&(xe=S.length-R+X);const Ie=xe-X;return this===S&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(R,X,xe):Uint8Array.prototype.set.call(S,this.subarray(X,xe),R),Ie},u.prototype.fill=function(S,R,X,xe){if(typeof S=="string"){if(typeof R=="string"?(xe=R,R=0,X=this.length):typeof X=="string"&&(xe=X,X=this.length),xe!==void 0&&typeof xe!="string")throw new TypeError("encoding must be a string");if(typeof xe=="string"&&!u.isEncoding(xe))throw new TypeError("Unknown encoding: "+xe);if(S.length===1){const ye=S.charCodeAt(0);(xe==="utf8"&&ye<128||xe==="latin1")&&(S=ye)}}else typeof S=="number"?S=S&255:typeof S=="boolean"&&(S=Number(S));if(R<0||this.length<R||this.length<X)throw new RangeError("Out of range index");if(X<=R)return this;R=R>>>0,X=X===void 0?this.length:X>>>0,S||(S=0);let Ie;if(typeof S=="number")for(Ie=R;Ie<X;++Ie)this[Ie]=S;else{const ye=u.isBuffer(S)?S:u.from(S,xe),nt=ye.length;if(nt===0)throw new TypeError('The value "'+S+'" is invalid for argument "value"');for(Ie=0;Ie<X-R;++Ie)this[Ie+R]=ye[Ie%nt]}return this};const ze={};function tt(B,S,R){ze[B]=class extends R{constructor(){super(),Object.defineProperty(this,"message",{value:S.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${B}]`,this.stack,delete this.name}get code(){return B}set code(xe){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:xe,writable:!0})}toString(){return`${this.name} [${B}]: ${this.message}`}}}tt("ERR_BUFFER_OUT_OF_BOUNDS",function(B){return B?`${B} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),tt("ERR_INVALID_ARG_TYPE",function(B,S){return`The "${B}" argument must be of type number. Received type ${typeof S}`},TypeError),tt("ERR_OUT_OF_RANGE",function(B,S,R){let X=`The value of "${B}" is out of range.`,xe=R;return Number.isInteger(R)&&Math.abs(R)>2**32?xe=rt(String(R)):typeof R=="bigint"&&(xe=String(R),(R>BigInt(2)**BigInt(32)||R<-(BigInt(2)**BigInt(32)))&&(xe=rt(xe)),xe+="n"),X+=` It must be ${S}. Received ${xe}`,X},RangeError);function rt(B){let S="",R=B.length;const X=B[0]==="-"?1:0;for(;R>=X+4;R-=3)S=`_${B.slice(R-3,R)}${S}`;return`${B.slice(0,R)}${S}`}function vt(B,S,R){Pe(S,"offset"),(B[S]===void 0||B[S+R]===void 0)&&Be(S,B.length-(R+1))}function Ye(B,S,R,X,xe,Ie){if(B>R||B<S){const ye=typeof S=="bigint"?"n":"";let nt;throw Ie>3?S===0||S===BigInt(0)?nt=`>= 0${ye} and < 2${ye} ** ${(Ie+1)*8}${ye}`:nt=`>= -(2${ye} ** ${(Ie+1)*8-1}${ye}) and < 2 ** ${(Ie+1)*8-1}${ye}`:nt=`>= ${S}${ye} and <= ${R}${ye}`,new ze.ERR_OUT_OF_RANGE("value",nt,B)}vt(X,xe,Ie)}function Pe(B,S){if(typeof B!="number")throw new ze.ERR_INVALID_ARG_TYPE(S,"number",B)}function Be(B,S,R){throw Math.floor(B)!==B?(Pe(B,R),new ze.ERR_OUT_OF_RANGE(R||"offset","an integer",B)):S<0?new ze.ERR_BUFFER_OUT_OF_BOUNDS:new ze.ERR_OUT_OF_RANGE(R||"offset",`>= ${R?1:0} and <= ${S}`,B)}const $e=/[^+/0-9A-Za-z-_]/g;function Je(B){if(B=B.split("=")[0],B=B.trim().replace($e,""),B.length<2)return"";for(;B.length%4!==0;)B=B+"=";return B}function We(B,S){S=S||1/0;let R;const X=B.length;let xe=null;const Ie=[];for(let ye=0;ye<X;++ye){if(R=B.charCodeAt(ye),R>55295&&R<57344){if(!xe){if(R>56319){(S-=3)>-1&&Ie.push(239,191,189);continue}else if(ye+1===X){(S-=3)>-1&&Ie.push(239,191,189);continue}xe=R;continue}if(R<56320){(S-=3)>-1&&Ie.push(239,191,189),xe=R;continue}R=(xe-55296<<10|R-56320)+65536}else xe&&(S-=3)>-1&&Ie.push(239,191,189);if(xe=null,R<128){if((S-=1)<0)break;Ie.push(R)}else if(R<2048){if((S-=2)<0)break;Ie.push(R>>6|192,R&63|128)}else if(R<65536){if((S-=3)<0)break;Ie.push(R>>12|224,R>>6&63|128,R&63|128)}else if(R<1114112){if((S-=4)<0)break;Ie.push(R>>18|240,R>>12&63|128,R>>6&63|128,R&63|128)}else throw new Error("Invalid code point")}return Ie}function _e(B){const S=[];for(let R=0;R<B.length;++R)S.push(B.charCodeAt(R)&255);return S}function Ee(B,S){let R,X,xe;const Ie=[];for(let ye=0;ye<B.length&&!((S-=2)<0);++ye)R=B.charCodeAt(ye),X=R>>8,xe=R%256,Ie.push(xe),Ie.push(X);return Ie}function Oe(B){return t.toByteArray(Je(B))}function Le(B,S,R,X){let xe;for(xe=0;xe<X&&!(xe+R>=S.length||xe>=B.length);++xe)S[xe+R]=B[xe];return xe}function ce(B,S){return B instanceof S||B!=null&&B.constructor!=null&&B.constructor.name!=null&&B.constructor.name===S.name}function he(B){return B!==B}const ie=function(){const B="0123456789abcdef",S=new Array(256);for(let R=0;R<16;++R){const X=R*16;for(let xe=0;xe<16;++xe)S[X+xe]=B[R]+B[xe]}return S}();function V(B){return typeof BigInt=="undefined"?Z:B}function Z(){throw new Error("BigInt not supported")}})(rw);/*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> */(function(a,t){var n=rw,i=n.Buffer;function o(c,u){for(var h in c)u[h]=c[h]}i.from&&i.alloc&&i.allocUnsafe&&i.allocUnsafeSlow?a.exports=n:(o(n,t),t.Buffer=s);function s(c,u,h){return i(c,u,h)}s.prototype=Object.create(i.prototype),o(i,s),s.from=function(c,u,h){if(typeof c=="number")throw new TypeError("Argument must not be a number");return i(c,u,h)},s.alloc=function(c,u,h){if(typeof c!="number")throw new TypeError("Argument must be a number");var f=i(c);return u!==void 0?typeof h=="string"?f.fill(u,h):f.fill(u):f.fill(0),f},s.allocUnsafe=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return i(c)},s.allocUnsafeSlow=function(c){if(typeof c!="number")throw new TypeError("Argument must be a number");return n.SlowBuffer(c)}})(Xb,Xb.exports);var ov=Xb.exports.Buffer;function Pj(a){if(a.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var i=0;i<a.length;i++){var o=a.charAt(i),s=o.charCodeAt(0);if(t[s]!==255)throw new TypeError(o+" is ambiguous");t[s]=i}var c=a.length,u=a.charAt(0),h=Math.log(c)/Math.log(256),f=Math.log(256)/Math.log(c);function p(g){if((Array.isArray(g)||g instanceof Uint8Array)&&(g=ov.from(g)),!ov.isBuffer(g))throw new TypeError("Expected Buffer");if(g.length===0)return"";for(var _=0,x=0,b=0,E=g.length;b!==E&&g[b]===0;)b++,_++;for(var T=(E-b)*f+1>>>0,P=new Uint8Array(T);b!==E;){for(var D=g[b],F=0,k=T-1;(D!==0||F<x)&&k!==-1;k--,F++)D+=256*P[k]>>>0,P[k]=D%c>>>0,D=D/c>>>0;if(D!==0)throw new Error("Non-zero carry");x=F,b++}for(var W=T-x;W!==T&&P[W]===0;)W++;for(var j=u.repeat(_);W<T;++W)j+=a.charAt(P[W]);return j}function m(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return ov.alloc(0);for(var _=0,x=0,b=0;g[_]===u;)x++,_++;for(var E=(g.length-_)*h+1>>>0,T=new Uint8Array(E);g[_];){var P=t[g.charCodeAt(_)];if(P===255)return;for(var D=0,F=E-1;(P!==0||D<b)&&F!==-1;F--,D++)P+=c*T[F]>>>0,T[F]=P%256>>>0,P=P/256>>>0;if(P!==0)throw new Error("Non-zero carry");b=D,_++}for(var k=E-b;k!==E&&T[k]===0;)k++;var W=ov.allocUnsafe(x+(E-k));W.fill(0,0,x);for(var j=x;k!==E;)W[j++]=T[k++];return W}function y(g){var _=m(g);if(_)return _;throw new Error("Non-base"+c+" character")}return{encode:p,decodeUnsafe:m,decode:y}}var Ij=Pj,Oj=Ij,Dj="123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz",$b=Oj(Dj),bs={};function Il(a,t,n){return t<=a&&a<=n}function Py(a){if(a===void 0)return{};if(a===Object(a))return a;throw TypeError("Could not convert argument to dictionary")}function Bj(a){for(var t=String(a),n=t.length,i=0,o=[];i<n;){var s=t.charCodeAt(i);if(s<55296||s>57343)o.push(s);else if(56320<=s&&s<=57343)o.push(65533);else if(55296<=s&&s<=56319)if(i===n-1)o.push(65533);else{var c=a.charCodeAt(i+1);if(56320<=c&&c<=57343){var u=s&1023,h=c&1023;o.push(65536+(u<<10)+h),i+=1}else o.push(65533)}i+=1}return o}function Fj(a){for(var t="",n=0;n<a.length;++n){var i=a[n];i<=65535?t+=String.fromCharCode(i):(i-=65536,t+=String.fromCharCode((i>>10)+55296,(i&1023)+56320))}return t}var zv=-1;function sw(a){this.tokens=[].slice.call(a)}sw.prototype={endOfStream:function(){return!this.tokens.length},read:function(){return this.tokens.length?this.tokens.shift():zv},prepend:function(a){if(Array.isArray(a))for(var t=a;t.length;)this.tokens.unshift(t.pop());else this.tokens.unshift(a)},push:function(a){if(Array.isArray(a))for(var t=a;t.length;)this.tokens.push(t.shift());else this.tokens.push(a)}};var wd=-1;function wA(a,t){if(a)throw TypeError("Decoder error");return t||65533}var Hv="utf-8";function Gv(a,t){if(!(this instanceof Gv))return new Gv(a,t);if(a=a!==void 0?String(a).toLowerCase():Hv,a!==Hv)throw new Error("Encoding not supported. Only utf-8 is supported");t=Py(t),this._streaming=!1,this._BOMseen=!1,this._decoder=null,this._fatal=Boolean(t.fatal),this._ignoreBOM=Boolean(t.ignoreBOM),Object.defineProperty(this,"encoding",{value:"utf-8"}),Object.defineProperty(this,"fatal",{value:this._fatal}),Object.defineProperty(this,"ignoreBOM",{value:this._ignoreBOM})}Gv.prototype={decode:function(t,n){var i;typeof t=="object"&&t instanceof ArrayBuffer?i=new Uint8Array(t):typeof t=="object"&&"buffer"in t&&t.buffer instanceof ArrayBuffer?i=new Uint8Array(t.buffer,t.byteOffset,t.byteLength):i=new Uint8Array(0),n=Py(n),this._streaming||(this._decoder=new Nj({fatal:this._fatal}),this._BOMseen=!1),this._streaming=Boolean(n.stream);for(var o=new sw(i),s=[],c;!o.endOfStream()&&(c=this._decoder.handler(o,o.read()),c!==wd);)c!==null&&(Array.isArray(c)?s.push.apply(s,c):s.push(c));if(!this._streaming){do{if(c=this._decoder.handler(o,o.read()),c===wd)break;c!==null&&(Array.isArray(c)?s.push.apply(s,c):s.push(c))}while(!o.endOfStream());this._decoder=null}return s.length&&["utf-8"].indexOf(this.encoding)!==-1&&!this._ignoreBOM&&!this._BOMseen&&(s[0]===65279?(this._BOMseen=!0,s.shift()):this._BOMseen=!0),Fj(s)}};function Vv(a,t){if(!(this instanceof Vv))return new Vv(a,t);if(a=a!==void 0?String(a).toLowerCase():Hv,a!==Hv)throw new Error("Encoding not supported. Only utf-8 is supported");t=Py(t),this._streaming=!1,this._encoder=null,this._options={fatal:Boolean(t.fatal)},Object.defineProperty(this,"encoding",{value:"utf-8"})}Vv.prototype={encode:function(t,n){t=t?String(t):"",n=Py(n),this._streaming||(this._encoder=new Uj(this._options)),this._streaming=Boolean(n.stream);for(var i=[],o=new sw(Bj(t)),s;!o.endOfStream()&&(s=this._encoder.handler(o,o.read()),s!==wd);)Array.isArray(s)?i.push.apply(i,s):i.push(s);if(!this._streaming){for(;s=this._encoder.handler(o,o.read()),s!==wd;)Array.isArray(s)?i.push.apply(i,s):i.push(s);this._encoder=null}return new Uint8Array(i)}};function Nj(a){var t=a.fatal,n=0,i=0,o=0,s=128,c=191;this.handler=function(u,h){if(h===zv&&o!==0)return o=0,wA(t);if(h===zv)return wd;if(o===0){if(Il(h,0,127))return h;if(Il(h,194,223))o=1,n=h-192;else if(Il(h,224,239))h===224&&(s=160),h===237&&(c=159),o=2,n=h-224;else if(Il(h,240,244))h===240&&(s=144),h===244&&(c=143),o=3,n=h-240;else return wA(t);return n=n<<6*o,null}if(!Il(h,s,c))return n=o=i=0,s=128,c=191,u.prepend(h),wA(t);if(s=128,c=191,i+=1,n+=h-128<<6*(o-i),i!==o)return null;var f=n;return n=o=i=0,f}}function Uj(a){a.fatal,this.handler=function(t,n){if(n===zv)return wd;if(Il(n,0,127))return n;var i,o;Il(n,128,2047)?(i=1,o=192):Il(n,2048,65535)?(i=2,o=224):Il(n,65536,1114111)&&(i=3,o=240);for(var s=[(n>>6*i)+o];i>0;){var c=n>>6*(i-1);s.push(128|c&63),i-=1}return s}}var kj=Object.freeze(Object.defineProperty({__proto__:null,TextEncoder:Vv,TextDecoder:Gv},Symbol.toStringTag,{value:"Module"})),zj=ly(kj),Hj=Tr&&Tr.__createBinding||(Object.create?function(a,t,n,i){i===void 0&&(i=n),Object.defineProperty(a,i,{enumerable:!0,get:function(){return t[n]}})}:function(a,t,n,i){i===void 0&&(i=n),a[i]=t[n]}),Gj=Tr&&Tr.__setModuleDefault||(Object.create?function(a,t){Object.defineProperty(a,"default",{enumerable:!0,value:t})}:function(a,t){a.default=t}),rl=Tr&&Tr.__decorate||function(a,t,n,i){var o=arguments.length,s=o<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,n):i,c;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")s=Reflect.decorate(a,t,n,i);else for(var u=a.length-1;u>=0;u--)(c=a[u])&&(s=(o<3?c(s):o>3?c(t,n,s):c(t,n))||s);return o>3&&s&&Object.defineProperty(t,n,s),s},Vj=Tr&&Tr.__importStar||function(a){if(a&&a.__esModule)return a;var t={};if(a!=null)for(var n in a)n!=="default"&&Object.hasOwnProperty.call(a,n)&&Hj(t,a,n);return Gj(t,a),t},LL=Tr&&Tr.__importDefault||function(a){return a&&a.__esModule?a:{default:a}};Object.defineProperty(bs,"__esModule",{value:!0});var PL=bs.deserializeUnchecked=NL=bs.deserialize=FL=bs.serialize=bs.BinaryReader=bs.BinaryWriter=bs.BorshError=bs.baseDecode=bs.baseEncode=void 0;const Rc=LL(iw.exports),IL=LL($b),Wj=Vj(zj),jj=typeof TextDecoder!="function"?Wj.TextDecoder:TextDecoder,Xj=new jj("utf-8",{fatal:!0});function $j(a){return typeof a=="string"&&(a=Buffer.from(a,"utf8")),IL.default.encode(Buffer.from(a))}bs.baseEncode=$j;function qj(a){return Buffer.from(IL.default.decode(a))}bs.baseDecode=qj;const EA=1024;class Zs extends Error{constructor(t){super(t),this.fieldPath=[],this.originalMessage=t}addToFieldPath(t){this.fieldPath.splice(0,0,t),this.message=this.originalMessage+": "+this.fieldPath.join(".")}}bs.BorshError=Zs;class OL{constructor(){this.buf=Buffer.alloc(EA),this.length=0}maybeResize(){this.buf.length<16+this.length&&(this.buf=Buffer.concat([this.buf,Buffer.alloc(EA)]))}writeU8(t){this.maybeResize(),this.buf.writeUInt8(t,this.length),this.length+=1}writeU16(t){this.maybeResize(),this.buf.writeUInt16LE(t,this.length),this.length+=2}writeU32(t){this.maybeResize(),this.buf.writeUInt32LE(t,this.length),this.length+=4}writeU64(t){this.maybeResize(),this.writeBuffer(Buffer.from(new Rc.default(t).toArray("le",8)))}writeU128(t){this.maybeResize(),this.writeBuffer(Buffer.from(new Rc.default(t).toArray("le",16)))}writeU256(t){this.maybeResize(),this.writeBuffer(Buffer.from(new Rc.default(t).toArray("le",32)))}writeU512(t){this.maybeResize(),this.writeBuffer(Buffer.from(new Rc.default(t).toArray("le",64)))}writeBuffer(t){this.buf=Buffer.concat([Buffer.from(this.buf.subarray(0,this.length)),t,Buffer.alloc(EA)]),this.length+=t.length}writeString(t){this.maybeResize();const n=Buffer.from(t,"utf8");this.writeU32(n.length),this.writeBuffer(n)}writeFixedArray(t){this.writeBuffer(Buffer.from(t))}writeArray(t,n){this.maybeResize(),this.writeU32(t.length);for(const i of t)this.maybeResize(),n(i)}toArray(){return this.buf.subarray(0,this.length)}}bs.BinaryWriter=OL;function sl(a,t,n){const i=n.value;n.value=function(...o){try{return i.apply(this,o)}catch(s){if(s instanceof RangeError){const c=s.code;if(["ERR_BUFFER_OUT_OF_BOUNDS","ERR_OUT_OF_RANGE"].indexOf(c)>=0)throw new Zs("Reached the end of buffer when deserializing")}throw s}}}class Io{constructor(t){this.buf=t,this.offset=0}readU8(){const t=this.buf.readUInt8(this.offset);return this.offset+=1,t}readU16(){const t=this.buf.readUInt16LE(this.offset);return this.offset+=2,t}readU32(){const t=this.buf.readUInt32LE(this.offset);return this.offset+=4,t}readU64(){const t=this.readBuffer(8);return new Rc.default(t,"le")}readU128(){const t=this.readBuffer(16);return new Rc.default(t,"le")}readU256(){const t=this.readBuffer(32);return new Rc.default(t,"le")}readU512(){const t=this.readBuffer(64);return new Rc.default(t,"le")}readBuffer(t){if(this.offset+t>this.buf.length)throw new Zs(`Expected buffer length ${t} isn't within bounds`);const n=this.buf.slice(this.offset,this.offset+t);return this.offset+=t,n}readString(){const t=this.readU32(),n=this.readBuffer(t);try{return Xj.decode(n)}catch(i){throw new Zs(`Error decoding UTF-8 string: ${i}`)}}readFixedArray(t){return new Uint8Array(this.readBuffer(t))}readArray(t){const n=this.readU32(),i=Array();for(let o=0;o<n;++o)i.push(t());return i}}rl([sl],Io.prototype,"readU8",null);rl([sl],Io.prototype,"readU16",null);rl([sl],Io.prototype,"readU32",null);rl([sl],Io.prototype,"readU64",null);rl([sl],Io.prototype,"readU128",null);rl([sl],Io.prototype,"readU256",null);rl([sl],Io.prototype,"readU512",null);rl([sl],Io.prototype,"readString",null);rl([sl],Io.prototype,"readFixedArray",null);rl([sl],Io.prototype,"readArray",null);bs.BinaryReader=Io;function DL(a){return a.charAt(0).toUpperCase()+a.slice(1)}function qu(a,t,n,i,o){try{if(typeof i=="string")o[`write${DL(i)}`](n);else if(i instanceof Array)if(typeof i[0]=="number"){if(n.length!==i[0])throw new Zs(`Expecting byte array of length ${i[0]}, but got ${n.length} bytes`);o.writeFixedArray(n)}else if(i.length===2&&typeof i[1]=="number"){if(n.length!==i[1])throw new Zs(`Expecting byte array of length ${i[1]}, but got ${n.length} bytes`);for(let s=0;s<i[1];s++)qu(a,null,n[s],i[0],o)}else o.writeArray(n,s=>{qu(a,t,s,i[0],o)});else if(i.kind!==void 0)switch(i.kind){case"option":{n==null?o.writeU8(0):(o.writeU8(1),qu(a,t,n,i.type,o));break}case"map":{o.writeU32(n.size),n.forEach((s,c)=>{qu(a,t,c,i.key,o),qu(a,t,s,i.value,o)});break}default:throw new Zs(`FieldType ${i} unrecognized`)}else BL(a,n,o)}catch(s){throw s instanceof Zs&&s.addToFieldPath(t),s}}function BL(a,t,n){if(typeof t.borshSerialize=="function"){t.borshSerialize(n);return}const i=a.get(t.constructor);if(!i)throw new Zs(`Class ${t.constructor.name} is missing in schema`);if(i.kind==="struct")i.fields.map(([o,s])=>{qu(a,o,t[o],s,n)});else if(i.kind==="enum"){const o=t[i.field];for(let s=0;s<i.values.length;++s){const[c,u]=i.values[s];if(c===o){n.writeU8(s),qu(a,c,t[c],u,n);break}}}else throw new Zs(`Unexpected schema kind: ${i.kind} for ${t.constructor.name}`)}function Yj(a,t,n=OL){const i=new n;return BL(a,t,i),i.toArray()}var FL=bs.serialize=Yj;function Yu(a,t,n,i){try{if(typeof n=="string")return i[`read${DL(n)}`]();if(n instanceof Array){if(typeof n[0]=="number")return i.readFixedArray(n[0]);if(typeof n[1]=="number"){const o=[];for(let s=0;s<n[1];s++)o.push(Yu(a,null,n[0],i));return o}else return i.readArray(()=>Yu(a,t,n[0],i))}if(n.kind==="option")return i.readU8()?Yu(a,t,n.type,i):void 0;if(n.kind==="map"){let o=new Map;const s=i.readU32();for(let c=0;c<s;c++){const u=Yu(a,t,n.key,i),h=Yu(a,t,n.value,i);o.set(u,h)}return o}return ow(a,n,i)}catch(o){throw o instanceof Zs&&o.addToFieldPath(t),o}}function ow(a,t,n){if(typeof t.borshDeserialize=="function")return t.borshDeserialize(n);const i=a.get(t);if(!i)throw new Zs(`Class ${t.name} is missing in schema`);if(i.kind==="struct"){const o={};for(const[s,c]of a.get(t).fields)o[s]=Yu(a,s,c,n);return new t(o)}if(i.kind==="enum"){const o=n.readU8();if(o>=i.values.length)throw new Zs(`Enum index: ${o} is out of range`);const[s,c]=i.values[o],u=Yu(a,s,c,n);return new t({[s]:u})}throw new Zs(`Unexpected schema kind: ${i.kind} for ${t.constructor.name}`)}function Qj(a,t,n,i=Io){const o=new i(n),s=ow(a,t,o);if(o.offset<n.length)throw new Zs(`Unexpected ${n.length-o.offset} bytes after deserialized data`);return s}var NL=bs.deserialize=Qj;function Kj(a,t,n,i=Io){const o=new i(n);return ow(a,t,o)}PL=bs.deserializeUnchecked=Kj;var zt={};Object.defineProperty(zt,"__esModule",{value:!0});zt.s16=zt.s8=zt.nu64be=zt.u48be=zt.u40be=zt.u32be=zt.u24be=zt.u16be=ks=zt.nu64=zt.u48=zt.u40=Ri=zt.u32=zt.u24=Uo=zt.u16=Gs=zt.u8=om=zt.offset=zt.greedy=zt.Constant=zt.UTF8=zt.CString=zt.Blob=zt.Boolean=zt.BitField=zt.BitStructure=zt.VariantLayout=zt.Union=zt.UnionLayoutDiscriminator=zt.UnionDiscriminator=zt.Structure=zt.Sequence=zt.DoubleBE=zt.Double=zt.FloatBE=zt.Float=zt.NearInt64BE=zt.NearInt64=zt.NearUInt64BE=zt.NearUInt64=zt.IntBE=zt.Int=zt.UIntBE=zt.UInt=zt.OffsetLayout=zt.GreedyCount=zt.ExternalLayout=zt.bindConstructorLayout=zt.nameWithProperty=zt.Layout=zt.uint8ArrayToBuffer=zt.checkUint8Array=void 0;zt.constant=zt.utf8=zt.cstr=Ed=zt.blob=zt.unionLayoutDiscriminator=zt.union=Yp=zt.seq=zt.bits=Mi=zt.struct=zt.f64be=zt.f64=zt.f32be=zt.f32=zt.ns64be=zt.s48be=zt.s40be=zt.s32be=zt.s24be=zt.s16be=wo=zt.ns64=zt.s48=zt.s40=zt.s32=zt.s24=void 0;const aw=rw;function Hd(a){if(!(a instanceof Uint8Array))throw new TypeError("b must be a Uint8Array")}zt.checkUint8Array=Hd;function tr(a){return Hd(a),aw.Buffer.from(a.buffer,a.byteOffset,a.length)}zt.uint8ArrayToBuffer=tr;class lr{constructor(t,n){if(!Number.isInteger(t))throw new TypeError("span must be an integer");this.span=t,this.property=n}makeDestinationObject(){return{}}getSpan(t,n){if(0>this.span)throw new RangeError("indeterminate span");return this.span}replicate(t){const n=Object.create(this.constructor.prototype);return Object.assign(n,this),n.property=t,n}fromArray(t){}}zt.Layout=lr;function lw(a,t){return t.property?a+"["+t.property+"]":a}zt.nameWithProperty=lw;function Zj(a,t){if(typeof a!="function")throw new TypeError("Class must be constructor");if(Object.prototype.hasOwnProperty.call(a,"layout_"))throw new Error("Class is already bound to a layout");if(!(t&&t instanceof lr))throw new TypeError("layout must be a Layout");if(Object.prototype.hasOwnProperty.call(t,"boundConstructor_"))throw new Error("layout is already bound to a constructor");a.layout_=t,t.boundConstructor_=a,t.makeDestinationObject=()=>new a,Object.defineProperty(a.prototype,"encode",{value(n,i){return t.encode(this,n,i)},writable:!0}),Object.defineProperty(a,"decode",{value(n,i){return t.decode(n,i)},writable:!0})}zt.bindConstructorLayout=Zj;class oo extends lr{isCount(){throw new Error("ExternalLayout is abstract")}}zt.ExternalLayout=oo;class UL extends oo{constructor(t=1,n){if(!Number.isInteger(t)||0>=t)throw new TypeError("elementSpan must be a (positive) integer");super(-1,n),this.elementSpan=t}isCount(){return!0}decode(t,n=0){Hd(t);const i=t.length-n;return Math.floor(i/this.elementSpan)}encode(t,n,i){return 0}}zt.GreedyCount=UL;class cw extends oo{constructor(t,n=0,i){if(!(t instanceof lr))throw new TypeError("layout must be a Layout");if(!Number.isInteger(n))throw new TypeError("offset must be integer or undefined");super(t.span,i||t.property),this.layout=t,this.offset=n}isCount(){return this.layout instanceof Go||this.layout instanceof ma}decode(t,n=0){return this.layout.decode(t,n+this.offset)}encode(t,n,i=0){return this.layout.encode(t,n,i+this.offset)}}zt.OffsetLayout=cw;class Go extends lr{constructor(t,n){if(super(t,n),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,n=0){return tr(t).readUIntLE(n,this.span)}encode(t,n,i=0){return tr(n).writeUIntLE(t,i,this.span),this.span}}zt.UInt=Go;class ma extends lr{constructor(t,n){if(super(t,n),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,n=0){return tr(t).readUIntBE(n,this.span)}encode(t,n,i=0){return tr(n).writeUIntBE(t,i,this.span),this.span}}zt.UIntBE=ma;class Ch extends lr{constructor(t,n){if(super(t,n),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,n=0){return tr(t).readIntLE(n,this.span)}encode(t,n,i=0){return tr(n).writeIntLE(t,i,this.span),this.span}}zt.Int=Ch;class Gd extends lr{constructor(t,n){if(super(t,n),6<this.span)throw new RangeError("span must not exceed 6 bytes")}decode(t,n=0){return tr(t).readIntBE(n,this.span)}encode(t,n,i=0){return tr(n).writeIntBE(t,i,this.span),this.span}}zt.IntBE=Gd;const qb=Math.pow(2,32);function Iy(a){const t=Math.floor(a/qb),n=a-t*qb;return{hi32:t,lo32:n}}function Oy(a,t){return a*qb+t}class kL extends lr{constructor(t){super(8,t)}decode(t,n=0){const i=tr(t),o=i.readUInt32LE(n),s=i.readUInt32LE(n+4);return Oy(s,o)}encode(t,n,i=0){const o=Iy(t),s=tr(n);return s.writeUInt32LE(o.lo32,i),s.writeUInt32LE(o.hi32,i+4),8}}zt.NearUInt64=kL;class zL extends lr{constructor(t){super(8,t)}decode(t,n=0){const i=tr(t),o=i.readUInt32BE(n),s=i.readUInt32BE(n+4);return Oy(o,s)}encode(t,n,i=0){const o=Iy(t),s=tr(n);return s.writeUInt32BE(o.hi32,i),s.writeUInt32BE(o.lo32,i+4),8}}zt.NearUInt64BE=zL;class HL extends lr{constructor(t){super(8,t)}decode(t,n=0){const i=tr(t),o=i.readUInt32LE(n),s=i.readInt32LE(n+4);return Oy(s,o)}encode(t,n,i=0){const o=Iy(t),s=tr(n);return s.writeUInt32LE(o.lo32,i),s.writeInt32LE(o.hi32,i+4),8}}zt.NearInt64=HL;class GL extends lr{constructor(t){super(8,t)}decode(t,n=0){const i=tr(t),o=i.readInt32BE(n),s=i.readUInt32BE(n+4);return Oy(o,s)}encode(t,n,i=0){const o=Iy(t),s=tr(n);return s.writeInt32BE(o.hi32,i),s.writeUInt32BE(o.lo32,i+4),8}}zt.NearInt64BE=GL;class VL extends lr{constructor(t){super(4,t)}decode(t,n=0){return tr(t).readFloatLE(n)}encode(t,n,i=0){return tr(n).writeFloatLE(t,i),4}}zt.Float=VL;class WL extends lr{constructor(t){super(4,t)}decode(t,n=0){return tr(t).readFloatBE(n)}encode(t,n,i=0){return tr(n).writeFloatBE(t,i),4}}zt.FloatBE=WL;class jL extends lr{constructor(t){super(8,t)}decode(t,n=0){return tr(t).readDoubleLE(n)}encode(t,n,i=0){return tr(n).writeDoubleLE(t,i),8}}zt.Double=jL;class XL extends lr{constructor(t){super(8,t)}decode(t,n=0){return tr(t).readDoubleBE(n)}encode(t,n,i=0){return tr(n).writeDoubleBE(t,i),8}}zt.DoubleBE=XL;class $L extends lr{constructor(t,n,i){if(!(t instanceof lr))throw new TypeError("elementLayout must be a Layout");if(!(n instanceof oo&&n.isCount()||Number.isInteger(n)&&0<=n))throw new TypeError("count must be non-negative integer or an unsigned integer ExternalLayout");let o=-1;!(n instanceof oo)&&0<t.span&&(o=n*t.span),super(o,i),this.elementLayout=t,this.count=n}getSpan(t,n=0){if(0<=this.span)return this.span;let i=0,o=this.count;if(o instanceof oo&&(o=o.decode(t,n)),0<this.elementLayout.span)i=o*this.elementLayout.span;else{let s=0;for(;s<o;)i+=this.elementLayout.getSpan(t,n+i),++s}return i}decode(t,n=0){const i=[];let o=0,s=this.count;for(s instanceof oo&&(s=s.decode(t,n));o<s;)i.push(this.elementLayout.decode(t,n)),n+=this.elementLayout.getSpan(t,n),o+=1;return i}encode(t,n,i=0){const o=this.elementLayout,s=t.reduce((c,u)=>c+o.encode(u,n,i+c),0);return this.count instanceof oo&&this.count.encode(t.length,n,i),s}}zt.Sequence=$L;class qL extends lr{constructor(t,n,i){if(!(Array.isArray(t)&&t.reduce((s,c)=>s&&c instanceof lr,!0)))throw new TypeError("fields must be array of Layout instances");typeof n=="boolean"&&i===void 0&&(i=n,n=void 0);for(const s of t)if(0>s.span&&s.property===void 0)throw new Error("fields cannot contain unnamed variable-length layout");let o=-1;try{o=t.reduce((s,c)=>s+c.getSpan(),0)}catch{}super(o,n),this.fields=t,this.decodePrefixes=!!i}getSpan(t,n=0){if(0<=this.span)return this.span;let i=0;try{i=this.fields.reduce((o,s)=>{const c=s.getSpan(t,n);return n+=c,o+c},0)}catch{throw new RangeError("indeterminate span")}return i}decode(t,n=0){Hd(t);const i=this.makeDestinationObject();for(const o of this.fields)if(o.property!==void 0&&(i[o.property]=o.decode(t,n)),n+=o.getSpan(t,n),this.decodePrefixes&&t.length===n)break;return i}encode(t,n,i=0){const o=i;let s=0,c=0;for(const u of this.fields){let h=u.span;if(c=0<h?h:0,u.property!==void 0){const f=t[u.property];f!==void 0&&(c=u.encode(f,n,i),0>h&&(h=u.getSpan(n,i)))}s=i,i+=h}return s+c-o}fromArray(t){const n=this.makeDestinationObject();for(const i of this.fields)i.property!==void 0&&0<t.length&&(n[i.property]=t.shift());return n}layoutFor(t){if(typeof t!="string")throw new TypeError("property must be string");for(const n of this.fields)if(n.property===t)return n}offsetOf(t){if(typeof t!="string")throw new TypeError("property must be string");let n=0;for(const i of this.fields){if(i.property===t)return n;0>i.span?n=-1:0<=n&&(n+=i.span)}}}zt.Structure=qL;class uw{constructor(t){this.property=t}decode(t,n){throw new Error("UnionDiscriminator is abstract")}encode(t,n,i){throw new Error("UnionDiscriminator is abstract")}}zt.UnionDiscriminator=uw;class Wv extends uw{constructor(t,n){if(!(t instanceof oo&&t.isCount()))throw new TypeError("layout must be an unsigned integer ExternalLayout");super(n||t.property||"variant"),this.layout=t}decode(t,n){return this.layout.decode(t,n)}encode(t,n,i){return this.layout.encode(t,n,i)}}zt.UnionLayoutDiscriminator=Wv;class hw extends lr{constructor(t,n,i){let o;if(t instanceof Go||t instanceof ma)o=new Wv(new cw(t));else if(t instanceof oo&&t.isCount())o=new Wv(t);else if(t instanceof uw)o=t;else throw new TypeError("discr must be a UnionDiscriminator or an unsigned integer layout");if(n===void 0&&(n=null),!(n===null||n instanceof lr))throw new TypeError("defaultLayout must be null or a Layout");if(n!==null){if(0>n.span)throw new Error("defaultLayout must have constant span");n.property===void 0&&(n=n.replicate("content"))}let s=-1;n&&(s=n.span,0<=s&&(t instanceof Go||t instanceof ma)&&(s+=o.layout.span)),super(s,i),this.discriminator=o,this.usesPrefixDiscriminator=t instanceof Go||t instanceof ma,this.defaultLayout=n,this.registry={};let c=this.defaultGetSourceVariant.bind(this);this.getSourceVariant=function(u){return c(u)},this.configGetSourceVariant=function(u){c=u.bind(this)}}getSpan(t,n=0){if(0<=this.span)return this.span;const i=this.getVariant(t,n);if(!i)throw new Error("unable to determine span for unrecognized variant");return i.getSpan(t,n)}defaultGetSourceVariant(t){if(Object.prototype.hasOwnProperty.call(t,this.discriminator.property)){if(this.defaultLayout&&this.defaultLayout.property&&Object.prototype.hasOwnProperty.call(t,this.defaultLayout.property))return;const n=this.registry[t[this.discriminator.property]];if(n&&(!n.layout||n.property&&Object.prototype.hasOwnProperty.call(t,n.property)))return n}else for(const n in this.registry){const i=this.registry[n];if(i.property&&Object.prototype.hasOwnProperty.call(t,i.property))return i}throw new Error("unable to infer src variant")}decode(t,n=0){let i;const o=this.discriminator,s=o.decode(t,n),c=this.registry[s];if(c===void 0){const u=this.defaultLayout;let h=0;this.usesPrefixDiscriminator&&(h=o.layout.span),i=this.makeDestinationObject(),i[o.property]=s,i[u.property]=u.decode(t,n+h)}else i=c.decode(t,n);return i}encode(t,n,i=0){const o=this.getSourceVariant(t);if(o===void 0){const s=this.discriminator,c=this.defaultLayout;let u=0;return this.usesPrefixDiscriminator&&(u=s.layout.span),s.encode(t[s.property],n,i),u+c.encode(t[c.property],n,i+u)}return o.encode(t,n,i)}addVariant(t,n,i){const o=new YL(this,t,n,i);return this.registry[t]=o,o}getVariant(t,n=0){let i;return t instanceof Uint8Array?i=this.discriminator.decode(t,n):i=t,this.registry[i]}}zt.Union=hw;class YL extends lr{constructor(t,n,i,o){if(!(t instanceof hw))throw new TypeError("union must be a Union");if(!Number.isInteger(n)||0>n)throw new TypeError("variant must be a (non-negative) integer");if(typeof i=="string"&&o===void 0&&(o=i,i=null),i){if(!(i instanceof lr))throw new TypeError("layout must be a Layout");if(t.defaultLayout!==null&&0<=i.span&&i.span>t.defaultLayout.span)throw new Error("variant span exceeds span of containing union");if(typeof o!="string")throw new TypeError("variant must have a String property")}let s=t.span;0>t.span&&(s=i?i.span:0,0<=s&&t.usesPrefixDiscriminator&&(s+=t.discriminator.layout.span)),super(s,o),this.union=t,this.variant=n,this.layout=i||null}getSpan(t,n=0){if(0<=this.span)return this.span;let i=0;this.union.usesPrefixDiscriminator&&(i=this.union.discriminator.layout.span);let o=0;return this.layout&&(o=this.layout.getSpan(t,n+i)),i+o}decode(t,n=0){const i=this.makeDestinationObject();if(this!==this.union.getVariant(t,n))throw new Error("variant mismatch");let o=0;return this.union.usesPrefixDiscriminator&&(o=this.union.discriminator.layout.span),this.layout?i[this.property]=this.layout.decode(t,n+o):this.property?i[this.property]=!0:this.union.usesPrefixDiscriminator&&(i[this.union.discriminator.property]=this.variant),i}encode(t,n,i=0){let o=0;if(this.union.usesPrefixDiscriminator&&(o=this.union.discriminator.layout.span),this.layout&&!Object.prototype.hasOwnProperty.call(t,this.property))throw new TypeError("variant lacks property "+this.property);this.union.discriminator.encode(this.variant,n,i);let s=o;if(this.layout&&(this.layout.encode(t[this.property],n,i+o),s+=this.layout.getSpan(n,i+o),0<=this.union.span&&s>this.union.span))throw new Error("encoded variant overruns containing union");return s}fromArray(t){if(this.layout)return this.layout.fromArray(t)}}zt.VariantLayout=YL;function Xf(a){return 0>a&&(a+=4294967296),a}class fw extends lr{constructor(t,n,i){if(!(t instanceof Go||t instanceof ma))throw new TypeError("word must be a UInt or UIntBE layout");if(typeof n=="string"&&i===void 0&&(i=n,n=!1),4<t.span)throw new RangeError("word cannot exceed 32 bits");super(t.span,i),this.word=t,this.msb=!!n,this.fields=[];let o=0;this._packedSetValue=function(s){return o=Xf(s),this},this._packedGetValue=function(){return o}}decode(t,n=0){const i=this.makeDestinationObject(),o=this.word.decode(t,n);this._packedSetValue(o);for(const s of this.fields)s.property!==void 0&&(i[s.property]=s.decode(t));return i}encode(t,n,i=0){const o=this.word.decode(n,i);this._packedSetValue(o);for(const s of this.fields)if(s.property!==void 0){const c=t[s.property];c!==void 0&&s.encode(c)}return this.word.encode(this._packedGetValue(),n,i)}addField(t,n){const i=new dw(this,t,n);return this.fields.push(i),i}addBoolean(t){const n=new QL(this,t);return this.fields.push(n),n}fieldFor(t){if(typeof t!="string")throw new TypeError("property must be string");for(const n of this.fields)if(n.property===t)return n}}zt.BitStructure=fw;class dw{constructor(t,n,i){if(!(t instanceof fw))throw new TypeError("container must be a BitStructure");if(!Number.isInteger(n)||0>=n)throw new TypeError("bits must be positive integer");const o=8*t.span,s=t.fields.reduce((c,u)=>c+u.bits,0);if(n+s>o)throw new Error("bits too long for span remainder ("+(o-s)+" of "+o+" remain)");this.container=t,this.bits=n,this.valueMask=(1<<n)-1,n===32&&(this.valueMask=4294967295),this.start=s,this.container.msb&&(this.start=o-s-n),this.wordMask=Xf(this.valueMask<<this.start),this.property=i}decode(t,n){const i=this.container._packedGetValue();return Xf(i&this.wordMask)>>>this.start}encode(t){if(typeof t!="number"||!Number.isInteger(t)||t!==Xf(t&this.valueMask))throw new TypeError(lw("BitField.encode",this)+" value must be integer not exceeding "+this.valueMask);const n=this.container._packedGetValue(),i=Xf(t<<this.start);this.container._packedSetValue(Xf(n&~this.wordMask)|i)}}zt.BitField=dw;class QL extends dw{constructor(t,n){super(t,1,n)}decode(t,n){return!!super.decode(t,n)}encode(t){typeof t=="boolean"&&(t=+t),super.encode(t)}}zt.Boolean=QL;class KL extends lr{constructor(t,n){if(!(t instanceof oo&&t.isCount()||Number.isInteger(t)&&0<=t))throw new TypeError("length must be positive integer or an unsigned integer ExternalLayout");let i=-1;t instanceof oo||(i=t),super(i,n),this.length=t}getSpan(t,n){let i=this.span;return 0>i&&(i=this.length.decode(t,n)),i}decode(t,n=0){let i=this.span;return 0>i&&(i=this.length.decode(t,n)),tr(t).slice(n,n+i)}encode(t,n,i){let o=this.length;if(this.length instanceof oo&&(o=t.length),!(t instanceof Uint8Array&&o===t.length))throw new TypeError(lw("Blob.encode",this)+" requires (length "+o+") Uint8Array as src");if(i+o>n.length)throw new RangeError("encoding overruns Uint8Array");const s=tr(t);return tr(n).write(s.toString("hex"),i,o,"hex"),this.length instanceof oo&&this.length.encode(o,n,i),o}}zt.Blob=KL;class ZL extends lr{constructor(t){super(-1,t)}getSpan(t,n=0){Hd(t);let i=n;for(;i<t.length&&t[i]!==0;)i+=1;return 1+i-n}decode(t,n=0){const i=this.getSpan(t,n);return tr(t).slice(n,n+i-1).toString("utf-8")}encode(t,n,i=0){typeof t!="string"&&(t=String(t));const o=aw.Buffer.from(t,"utf8"),s=o.length;if(i+s>n.length)throw new RangeError("encoding overruns Buffer");const c=tr(n);return o.copy(c,i),c[i+s]=0,s+1}}zt.CString=ZL;class JL extends lr{constructor(t,n){if(typeof t=="string"&&n===void 0&&(n=t,t=void 0),t===void 0)t=-1;else if(!Number.isInteger(t))throw new TypeError("maxSpan must be an integer");super(-1,n),this.maxSpan=t}getSpan(t,n=0){return Hd(t),t.length-n}decode(t,n=0){const i=this.getSpan(t,n);if(0<=this.maxSpan&&this.maxSpan<i)throw new RangeError("text length exceeds maxSpan");return tr(t).slice(n,n+i).toString("utf-8")}encode(t,n,i=0){typeof t!="string"&&(t=String(t));const o=aw.Buffer.from(t,"utf8"),s=o.length;if(0<=this.maxSpan&&this.maxSpan<s)throw new RangeError("text length exceeds maxSpan");if(i+s>n.length)throw new RangeError("encoding overruns Buffer");return o.copy(tr(n),i),s}}zt.UTF8=JL;class eP extends lr{constructor(t,n){super(0,n),this.value=t}decode(t,n){return this.value}encode(t,n,i){return 0}}zt.Constant=eP;zt.greedy=(a,t)=>new UL(a,t);var om=zt.offset=(a,t,n)=>new cw(a,t,n),Gs=zt.u8=a=>new Go(1,a),Uo=zt.u16=a=>new Go(2,a);zt.u24=a=>new Go(3,a);var Ri=zt.u32=a=>new Go(4,a);zt.u40=a=>new Go(5,a);zt.u48=a=>new Go(6,a);var ks=zt.nu64=a=>new kL(a);zt.u16be=a=>new ma(2,a);zt.u24be=a=>new ma(3,a);zt.u32be=a=>new ma(4,a);zt.u40be=a=>new ma(5,a);zt.u48be=a=>new ma(6,a);zt.nu64be=a=>new zL(a);zt.s8=a=>new Ch(1,a);zt.s16=a=>new Ch(2,a);zt.s24=a=>new Ch(3,a);zt.s32=a=>new Ch(4,a);zt.s40=a=>new Ch(5,a);zt.s48=a=>new Ch(6,a);var wo=zt.ns64=a=>new HL(a);zt.s16be=a=>new Gd(2,a);zt.s24be=a=>new Gd(3,a);zt.s32be=a=>new Gd(4,a);zt.s40be=a=>new Gd(5,a);zt.s48be=a=>new Gd(6,a);zt.ns64be=a=>new GL(a);zt.f32=a=>new VL(a);zt.f32be=a=>new WL(a);zt.f64=a=>new jL(a);zt.f64be=a=>new XL(a);var Mi=zt.struct=(a,t,n)=>new qL(a,t,n);zt.bits=(a,t,n)=>new fw(a,t,n);var Yp=zt.seq=(a,t,n)=>new $L(a,t,n);zt.union=(a,t,n)=>new hw(a,t,n);zt.unionLayoutDiscriminator=(a,t)=>new Wv(a,t);var Ed=zt.blob=(a,t)=>new KL(a,t);zt.cstr=a=>new ZL(a);zt.utf8=(a,t)=>new JL(a,t);zt.constant=(a,t)=>new eP(a,t);var zm={};Object.defineProperty(zm,"__esModule",{value:!0});function Jj(a){{const t=Buffer.from(a);t.reverse();const n=t.toString("hex");return n.length===0?BigInt(0):BigInt(`0x${n}`)}}var eX=zm.toBigIntLE=Jj;function tX(a){{const t=a.toString("hex");return t.length===0?BigInt(0):BigInt(`0x${t}`)}}zm.toBigIntBE=tX;function nX(a,t){{const n=a.toString(16),i=Buffer.from(n.padStart(t*2,"0").slice(0,t*2),"hex");return i.reverse(),i}}var iX=zm.toBufferLE=nX;function rX(a,t){{const n=a.toString(16);return Buffer.from(n.padStart(t*2,"0").slice(0,t*2),"hex")}}zm.toBufferBE=rX;class sX extends TypeError{constructor(t,n){let i;const h=t,{message:o}=h,s=hg(h,["message"]),{path:c}=t,u=c.length===0?o:"At path: "+c.join(".")+" -- "+o;super(u),Object.assign(this,s),this.name=this.constructor.name,this.failures=()=>{var f;return(f=i)!=null?f:i=[t,...n()]}}}function oX(a){return Fc(a)&&typeof a[Symbol.iterator]=="function"}function Fc(a){return typeof a=="object"&&a!=null}function ga(a){return typeof a=="string"?JSON.stringify(a):""+a}function aX(a){const{done:t,value:n}=a.next();return t?void 0:n}function lX(a,t,n,i){if(a===!0)return;a===!1?a={}:typeof a=="string"&&(a={message:a});const{path:o,branch:s}=t,{type:c}=n,{refinement:u,message:h="Expected a value of type `"+c+"`"+(u?" with refinement `"+u+"`":"")+", but received: `"+ga(i)+"`"}=a;return Ef(wf({value:i,type:c,refinement:u,key:o[o.length-1],path:o,branch:s},a),{message:h})}function*U3(a,t,n,i){oX(a)||(a=[a]);for(const o of a){const s=lX(o,t,n,i);s&&(yield s)}}function*pw(a,t,n={}){const{path:i=[],branch:o=[a],coerce:s=!1,mask:c=!1}=n,u={path:i,branch:o};if(s&&(a=t.coercer(a,u),c&&t.type!=="type"&&Fc(t.schema)&&Fc(a)&&!Array.isArray(a)))for(const f in a)t.schema[f]===void 0&&delete a[f];let h=!0;for(const f of t.validator(a,u))h=!1,yield[f,void 0];for(let[f,p,m]of t.entries(a,u)){const y=pw(p,m,{path:f===void 0?i:[...i,f],branch:f===void 0?o:[...o,p],coerce:s,mask:c});for(const g of y)g[0]?(h=!1,yield[g[0],void 0]):s&&(p=g[1],f===void 0?a=p:a instanceof Map?a.set(f,p):a instanceof Set?a.add(p):Fc(a)&&(a[f]=p))}if(h)for(const f of t.refiner(a,u))h=!1,yield[f,void 0];h&&(yield[void 0,a])}class ol{constructor(t){const{type:n,schema:i,validator:o,refiner:s,coercer:c=h=>h,entries:u=function*(){}}=t;this.type=n,this.schema=i,this.entries=u,this.coercer=c,o?this.validator=(h,f)=>{const p=o(h,f);return U3(p,f,this,h)}:this.validator=()=>[],s?this.refiner=(h,f)=>{const p=s(h,f);return U3(p,f,this,h)}:this.refiner=()=>[]}assert(t){return cX(t,this)}create(t){return Lm(t,this)}is(t){return tP(t,this)}mask(t){return uX(t,this)}validate(t,n={}){return Hm(t,this,n)}}function cX(a,t){const n=Hm(a,t);if(n[0])throw n[0]}function Lm(a,t){const n=Hm(a,t,{coerce:!0});if(n[0])throw n[0];return n[1]}function uX(a,t){const n=Hm(a,t,{coerce:!0,mask:!0});if(n[0])throw n[0];return n[1]}function tP(a,t){return!Hm(a,t)[0]}function Hm(a,t,n={}){const i=pw(a,t,n),o=aX(i);if(o[0])return[new sX(o[0],function*(){for(const c of i)c[0]&&(yield c[0])}),void 0];{const s=o[1];return[void 0,s]}}function Rh(a,t){return new ol({type:a,schema:null,validator:t})}function hX(){return Rh("any",()=>!0)}function gi(a){return new ol({type:"array",schema:a,*entries(t){if(a&&Array.isArray(t))for(const[n,i]of t.entries())yield[n,i,a]},coercer(t){return Array.isArray(t)?t.slice():t},validator(t){return Array.isArray(t)||"Expected an array value, but received: "+ga(t)}})}function Gl(){return Rh("boolean",a=>typeof a=="boolean")}function mw(a){return Rh("instance",t=>t instanceof a||"Expected a `"+a.name+"` instance, but received: "+ga(t))}function hs(a){const t=ga(a),n=typeof a;return new ol({type:"literal",schema:n==="string"||n==="number"||n==="boolean"?a:null,validator(i){return i===a||"Expected the literal `"+t+"`, but received: "+ga(i)}})}function fX(){return Rh("never",()=>!1)}function wi(a){return new ol(Ef(wf({},a),{validator:(t,n)=>t===null||a.validator(t,n),refiner:(t,n)=>t===null||a.refiner(t,n)}))}function tn(){return Rh("number",a=>typeof a=="number"&&!isNaN(a)||"Expected a number, but received: "+ga(a))}function hr(a){return new ol(Ef(wf({},a),{validator:(t,n)=>t===void 0||a.validator(t,n),refiner:(t,n)=>t===void 0||a.refiner(t,n)}))}function nP(a,t){return new ol({type:"record",schema:null,*entries(n){if(Fc(n))for(const i in n){const o=n[i];yield[i,i,a],yield[i,o,t]}},validator(n){return Fc(n)||"Expected an object, but received: "+ga(n)}})}function jn(){return Rh("string",a=>typeof a=="string"||"Expected a string, but received: "+ga(a))}function iP(a){const t=fX();return new ol({type:"tuple",schema:null,*entries(n){if(Array.isArray(n)){const i=Math.max(a.length,n.length);for(let o=0;o<i;o++)yield[o,n[o],a[o]||t]}},validator(n){return Array.isArray(n)||"Expected an array, but received: "+ga(n)}})}function Sn(a){const t=Object.keys(a);return new ol({type:"type",schema:a,*entries(n){if(Fc(n))for(const i of t)yield[i,n[i],a[i]]},validator(n){return Fc(n)||"Expected an object, but received: "+ga(n)}})}function Vo(a){const t=a.map(n=>n.type).join(" | ");return new ol({type:"union",schema:null,validator(n,i){const o=[];for(const s of a){const[...c]=pw(n,s,i),[u]=c;if(u[0])for(const[h]of c)h&&o.push(h);else return[]}return["Expected the value to satisfy a union of `"+t+"`, but received: "+ga(n),...o]}})}function Gm(){return Rh("unknown",()=>!0)}function Vm(a,t,n){return new ol(Ef(wf({},a),{coercer:(i,o)=>tP(i,t)?a.coercer(n(i,o),o):a.coercer(i,o)}))}var gw={},Dy={exports:{}};(function(a){function t(n){return n&&n.__esModule?n:{default:n}}a.exports=t,a.exports.__esModule=!0,a.exports.default=a.exports})(Dy);var By={exports:{}};(function(a){function t(i,o){for(var s=0;s<o.length;s++){var c=o[s];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(i,c.key,c)}}function n(i,o,s){return o&&t(i.prototype,o),s&&t(i,s),Object.defineProperty(i,"prototype",{writable:!1}),i}a.exports=n,a.exports.__esModule=!0,a.exports.default=a.exports})(By);var Fy={exports:{}};(function(a){function t(n,i){if(!(n instanceof i))throw new TypeError("Cannot call a class as a function")}a.exports=t,a.exports.__esModule=!0,a.exports.default=a.exports})(Fy);var Ny={exports:{}},rP={exports:{}};(function(a){function t(n,i){return a.exports=t=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(s,c){return s.__proto__=c,s},a.exports.__esModule=!0,a.exports.default=a.exports,t(n,i)}a.exports=t,a.exports.__esModule=!0,a.exports.default=a.exports})(rP);(function(a){var t=rP.exports;function n(i,o){if(typeof o!="function"&&o!==null)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(o&&o.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),o&&t(i,o)}a.exports=n,a.exports.__esModule=!0,a.exports.default=a.exports})(Ny);var Uy={exports:{}},ky={exports:{}};(function(a){function t(n){return a.exports=t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(i){return typeof i}:function(i){return i&&typeof Symbol=="function"&&i.constructor===Symbol&&i!==Symbol.prototype?"symbol":typeof i},a.exports.__esModule=!0,a.exports.default=a.exports,t(n)}a.exports=t,a.exports.__esModule=!0,a.exports.default=a.exports})(ky);var sP={exports:{}};(function(a){function t(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}a.exports=t,a.exports.__esModule=!0,a.exports.default=a.exports})(sP);(function(a){var t=ky.exports.default,n=sP.exports;function i(o,s){if(s&&(t(s)==="object"||typeof s=="function"))return s;if(s!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return n(o)}a.exports=i,a.exports.__esModule=!0,a.exports.default=a.exports})(Uy);var zy={exports:{}};(function(a){function t(n){return a.exports=t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(o){return o.__proto__||Object.getPrototypeOf(o)},a.exports.__esModule=!0,a.exports.default=a.exports,t(n)}a.exports=t,a.exports.__esModule=!0,a.exports.default=a.exports})(zy);var oP={};(function(a){var t=Dy.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=m;var n=t(Fy.exports),i=t(By.exports),o=t(Ny.exports),s=t(Uy.exports),c=t(zy.exports),u=Sy.exports;function h(y){var g=f();return function(){var x=(0,c.default)(y),b;if(g){var E=(0,c.default)(this).constructor;b=Reflect.construct(x,arguments,E)}else b=x.apply(this,arguments);return(0,s.default)(this,b)}}function f(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var p=function(y){(0,o.default)(_,y);var g=h(_);function _(x,b,E){var T;return(0,n.default)(this,_),T=g.call(this),T.socket=new window.WebSocket(x,E),T.socket.onopen=function(){return T.emit("open")},T.socket.onmessage=function(P){return T.emit("message",P.data)},T.socket.onerror=function(P){return T.emit("error",P)},T.socket.onclose=function(P){T.emit("close",P.code,P.reason)},T}return(0,i.default)(_,[{key:"send",value:function(b,E,T){var P=T||E;try{this.socket.send(b),P()}catch(D){P(D)}}},{key:"close",value:function(b,E){this.socket.close(b,E)}},{key:"addEventListener",value:function(b,E,T){this.socket.addEventListener(b,E,T)}}]),_}(u.EventEmitter);function m(y,g){return new p(y,g)}})(oP);var aP={},lP={exports:{}};(function(a){var t=ky.exports.default;function n(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */a.exports=n=function(){return i},a.exports.__esModule=!0,a.exports.default=a.exports;var i={},o=Object.prototype,s=o.hasOwnProperty,c=typeof Symbol=="function"?Symbol:{},u=c.iterator||"@@iterator",h=c.asyncIterator||"@@asyncIterator",f=c.toStringTag||"@@toStringTag";function p(L,M,I){return Object.defineProperty(L,M,{value:I,enumerable:!0,configurable:!0,writable:!0}),L[M]}try{p({},"")}catch{p=function(I,U,$){return I[U]=$}}function m(L,M,I,U){var $=M&&M.prototype instanceof _?M:_,ee=Object.create($.prototype),Q=new de(U||[]);return ee._invoke=function(G,K,Y){var we="suspendedStart";return function(Ke,ge){if(we==="executing")throw new Error("Generator is already running");if(we==="completed"){if(Ke==="throw")throw ge;return N()}for(Y.method=Ke,Y.arg=ge;;){var me=Y.delegate;if(me){var De=W(me,Y);if(De){if(De===g)continue;return De}}if(Y.method==="next")Y.sent=Y._sent=Y.arg;else if(Y.method==="throw"){if(we==="suspendedStart")throw we="completed",Y.arg;Y.dispatchException(Y.arg)}else Y.method==="return"&&Y.abrupt("return",Y.arg);we="executing";var ze=y(G,K,Y);if(ze.type==="normal"){if(we=Y.done?"completed":"suspendedYield",ze.arg===g)continue;return{value:ze.arg,done:Y.done}}ze.type==="throw"&&(we="completed",Y.method="throw",Y.arg=ze.arg)}}}(L,I,Q),ee}function y(L,M,I){try{return{type:"normal",arg:L.call(M,I)}}catch(U){return{type:"throw",arg:U}}}i.wrap=m;var g={};function _(){}function x(){}function b(){}var E={};p(E,u,function(){return this});var T=Object.getPrototypeOf,P=T&&T(T(te([])));P&&P!==o&&s.call(P,u)&&(E=P);var D=b.prototype=_.prototype=Object.create(E);function F(L){["next","throw","return"].forEach(function(M){p(L,M,function(I){return this._invoke(M,I)})})}function k(L,M){function I($,ee,Q,G){var K=y(L[$],L,ee);if(K.type!=="throw"){var Y=K.arg,we=Y.value;return we&&t(we)=="object"&&s.call(we,"__await")?M.resolve(we.__await).then(function(Ke){I("next",Ke,Q,G)},function(Ke){I("throw",Ke,Q,G)}):M.resolve(we).then(function(Ke){Y.value=Ke,Q(Y)},function(Ke){return I("throw",Ke,Q,G)})}G(K.arg)}var U;this._invoke=function($,ee){function Q(){return new M(function(G,K){I($,ee,G,K)})}return U=U?U.then(Q,Q):Q()}}function W(L,M){var I=L.iterator[M.method];if(I===void 0){if(M.delegate=null,M.method==="throw"){if(L.iterator.return&&(M.method="return",M.arg=void 0,W(L,M),M.method==="throw"))return g;M.method="throw",M.arg=new TypeError("The iterator does not provide a 'throw' method")}return g}var U=y(I,L.iterator,M.arg);if(U.type==="throw")return M.method="throw",M.arg=U.arg,M.delegate=null,g;var $=U.arg;return $?$.done?(M[L.resultName]=$.value,M.next=L.nextLoc,M.method!=="return"&&(M.method="next",M.arg=void 0),M.delegate=null,g):$:(M.method="throw",M.arg=new TypeError("iterator result is not an object"),M.delegate=null,g)}function j(L){var M={tryLoc:L[0]};1 in L&&(M.catchLoc=L[1]),2 in L&&(M.finallyLoc=L[2],M.afterLoc=L[3]),this.tryEntries.push(M)}function J(L){var M=L.completion||{};M.type="normal",delete M.arg,L.completion=M}function de(L){this.tryEntries=[{tryLoc:"root"}],L.forEach(j,this),this.reset(!0)}function te(L){if(L){var M=L[u];if(M)return M.call(L);if(typeof L.next=="function")return L;if(!isNaN(L.length)){var I=-1,U=function $(){for(;++I<L.length;)if(s.call(L,I))return $.value=L[I],$.done=!1,$;return $.value=void 0,$.done=!0,$};return U.next=U}}return{next:N}}function N(){return{value:void 0,done:!0}}return x.prototype=b,p(D,"constructor",b),p(b,"constructor",x),x.displayName=p(b,f,"GeneratorFunction"),i.isGeneratorFunction=function(L){var M=typeof L=="function"&&L.constructor;return!!M&&(M===x||(M.displayName||M.name)==="GeneratorFunction")},i.mark=function(L){return Object.setPrototypeOf?Object.setPrototypeOf(L,b):(L.__proto__=b,p(L,f,"GeneratorFunction")),L.prototype=Object.create(D),L},i.awrap=function(L){return{__await:L}},F(k.prototype),p(k.prototype,h,function(){return this}),i.AsyncIterator=k,i.async=function(L,M,I,U,$){$===void 0&&($=Promise);var ee=new k(m(L,M,I,U),$);return i.isGeneratorFunction(M)?ee:ee.next().then(function(Q){return Q.done?Q.value:ee.next()})},F(D),p(D,f,"Generator"),p(D,u,function(){return this}),p(D,"toString",function(){return"[object Generator]"}),i.keys=function(L){var M=[];for(var I in L)M.push(I);return M.reverse(),function U(){for(;M.length;){var $=M.pop();if($ in L)return U.value=$,U.done=!1,U}return U.done=!0,U}},i.values=te,de.prototype={constructor:de,reset:function(M){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(J),!M)for(var I in this)I.charAt(0)==="t"&&s.call(this,I)&&!isNaN(+I.slice(1))&&(this[I]=void 0)},stop:function(){this.done=!0;var M=this.tryEntries[0].completion;if(M.type==="throw")throw M.arg;return this.rval},dispatchException:function(M){if(this.done)throw M;var I=this;function U(Y,we){return Q.type="throw",Q.arg=M,I.next=Y,we&&(I.method="next",I.arg=void 0),!!we}for(var $=this.tryEntries.length-1;$>=0;--$){var ee=this.tryEntries[$],Q=ee.completion;if(ee.tryLoc==="root")return U("end");if(ee.tryLoc<=this.prev){var G=s.call(ee,"catchLoc"),K=s.call(ee,"finallyLoc");if(G&&K){if(this.prev<ee.catchLoc)return U(ee.catchLoc,!0);if(this.prev<ee.finallyLoc)return U(ee.finallyLoc)}else if(G){if(this.prev<ee.catchLoc)return U(ee.catchLoc,!0)}else{if(!K)throw new Error("try statement without catch or finally");if(this.prev<ee.finallyLoc)return U(ee.finallyLoc)}}}},abrupt:function(M,I){for(var U=this.tryEntries.length-1;U>=0;--U){var $=this.tryEntries[U];if($.tryLoc<=this.prev&&s.call($,"finallyLoc")&&this.prev<$.finallyLoc){var ee=$;break}}ee&&(M==="break"||M==="continue")&&ee.tryLoc<=I&&I<=ee.finallyLoc&&(ee=null);var Q=ee?ee.completion:{};return Q.type=M,Q.arg=I,ee?(this.method="next",this.next=ee.finallyLoc,g):this.complete(Q)},complete:function(M,I){if(M.type==="throw")throw M.arg;return M.type==="break"||M.type==="continue"?this.next=M.arg:M.type==="return"?(this.rval=this.arg=M.arg,this.method="return",this.next="end"):M.type==="normal"&&I&&(this.next=I),g},finish:function(M){for(var I=this.tryEntries.length-1;I>=0;--I){var U=this.tryEntries[I];if(U.finallyLoc===M)return this.complete(U.completion,U.afterLoc),J(U),g}},catch:function(M){for(var I=this.tryEntries.length-1;I>=0;--I){var U=this.tryEntries[I];if(U.tryLoc===M){var $=U.completion;if($.type==="throw"){var ee=$.arg;J(U)}return ee}}throw new Error("illegal catch attempt")},delegateYield:function(M,I,U){return this.delegate={iterator:te(M),resultName:I,nextLoc:U},this.method==="next"&&(this.arg=void 0),g}},i}a.exports=n,a.exports.__esModule=!0,a.exports.default=a.exports})(lP);var _v=lP.exports(),dX=_v;try{regeneratorRuntime=_v}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=_v:Function("r","regeneratorRuntime = r")(_v)}var cP={exports:{}};(function(a){function t(i,o,s,c,u,h,f){try{var p=i[h](f),m=p.value}catch(y){s(y);return}p.done?o(m):Promise.resolve(m).then(c,u)}function n(i){return function(){var o=this,s=arguments;return new Promise(function(c,u){var h=i.apply(o,s);function f(m){t(h,c,u,f,p,"next",m)}function p(m){t(h,c,u,f,p,"throw",m)}f(void 0)})}}a.exports=n,a.exports.__esModule=!0,a.exports.default=a.exports})(cP);(function(a){var t=Dy.exports;Object.defineProperty(a,"__esModule",{value:!0}),a.default=void 0;var n=t(dX),i=t(cP.exports),o=t(ky.exports),s=t(Fy.exports),c=t(By.exports),u=t(Ny.exports),h=t(Uy.exports),f=t(zy.exports),p=Sy.exports;function m(x){var b=y();return function(){var T=(0,f.default)(x),P;if(b){var D=(0,f.default)(this).constructor;P=Reflect.construct(T,arguments,D)}else P=T.apply(this,arguments);return(0,h.default)(this,P)}}function y(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var g=function(x,b){var E={};for(var T in x)Object.prototype.hasOwnProperty.call(x,T)&&b.indexOf(T)<0&&(E[T]=x[T]);if(x!=null&&typeof Object.getOwnPropertySymbols=="function")for(var P=0,T=Object.getOwnPropertySymbols(x);P<T.length;P++)b.indexOf(T[P])<0&&Object.prototype.propertyIsEnumerable.call(x,T[P])&&(E[T[P]]=x[T[P]]);return E},_=function(x){(0,u.default)(E,x);var b=m(E);function E(T){var P,D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"ws://localhost:8080",F=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},k=arguments.length>3?arguments[3]:void 0;(0,s.default)(this,E);var W=F.autoconnect,j=W===void 0?!0:W,J=F.reconnect,de=J===void 0?!0:J,te=F.reconnect_interval,N=te===void 0?1e3:te,L=F.max_reconnects,M=L===void 0?5:L,I=g(F,["autoconnect","reconnect","reconnect_interval","max_reconnects"]);return P=b.call(this),P.webSocketFactory=T,P.queue={},P.rpc_id=0,P.address=D,P.autoconnect=j,P.ready=!1,P.reconnect=de,P.reconnect_interval=N,P.max_reconnects=M,P.rest_options=I,P.current_reconnects=0,P.generate_request_id=k||function(){return++P.rpc_id},P.autoconnect&&P._connect(P.address,Object.assign({autoconnect:P.autoconnect,reconnect:P.reconnect,reconnect_interval:P.reconnect_interval,max_reconnects:P.max_reconnects},P.rest_options)),P}return(0,c.default)(E,[{key:"connect",value:function(){this.socket||this._connect(this.address,Object.assign({autoconnect:this.autoconnect,reconnect:this.reconnect,reconnect_interval:this.reconnect_interval,max_reconnects:this.max_reconnects},this.rest_options))}},{key:"call",value:function(P,D,F,k){var W=this;return!k&&(0,o.default)(F)==="object"&&(k=F,F=null),new Promise(function(j,J){if(!W.ready)return J(new Error("socket not ready"));var de=W.generate_request_id(P,D),te={jsonrpc:"2.0",method:P,params:D||null,id:de};W.socket.send(JSON.stringify(te),k,function(N){if(N)return J(N);W.queue[de]={promise:[j,J]},F&&(W.queue[de].timeout=setTimeout(function(){delete W.queue[de],J(new Error("reply timeout"))},F))})})}},{key:"login",value:function(){var T=(0,i.default)(n.default.mark(function D(F){var k;return n.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return j.next=2,this.call("rpc.login",F);case 2:if(k=j.sent,k){j.next=5;break}throw new Error("authentication failed");case 5:return j.abrupt("return",k);case 6:case"end":return j.stop()}},D,this)}));function P(D){return T.apply(this,arguments)}return P}()},{key:"listMethods",value:function(){var T=(0,i.default)(n.default.mark(function D(){return n.default.wrap(function(k){for(;;)switch(k.prev=k.next){case 0:return k.next=2,this.call("__listMethods");case 2:return k.abrupt("return",k.sent);case 3:case"end":return k.stop()}},D,this)}));function P(){return T.apply(this,arguments)}return P}()},{key:"notify",value:function(P,D){var F=this;return new Promise(function(k,W){if(!F.ready)return W(new Error("socket not ready"));var j={jsonrpc:"2.0",method:P,params:D||null};F.socket.send(JSON.stringify(j),function(J){if(J)return W(J);k()})})}},{key:"subscribe",value:function(){var T=(0,i.default)(n.default.mark(function D(F){var k;return n.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return typeof F=="string"&&(F=[F]),j.next=3,this.call("rpc.on",F);case 3:if(k=j.sent,!(typeof F=="string"&&k[F]!=="ok")){j.next=6;break}throw new Error("Failed subscribing to an event '"+F+"' with: "+k[F]);case 6:return j.abrupt("return",k);case 7:case"end":return j.stop()}},D,this)}));function P(D){return T.apply(this,arguments)}return P}()},{key:"unsubscribe",value:function(){var T=(0,i.default)(n.default.mark(function D(F){var k;return n.default.wrap(function(j){for(;;)switch(j.prev=j.next){case 0:return typeof F=="string"&&(F=[F]),j.next=3,this.call("rpc.off",F);case 3:if(k=j.sent,!(typeof F=="string"&&k[F]!=="ok")){j.next=6;break}throw new Error("Failed unsubscribing from an event with: "+k);case 6:return j.abrupt("return",k);case 7:case"end":return j.stop()}},D,this)}));function P(D){return T.apply(this,arguments)}return P}()},{key:"close",value:function(P,D){this.socket.close(P||1e3,D)}},{key:"_connect",value:function(P,D){var F=this;this.socket=this.webSocketFactory(P,D),this.socket.addEventListener("open",function(){F.ready=!0,F.emit("open"),F.current_reconnects=0}),this.socket.addEventListener("message",function(k){var W=k.data;W instanceof ArrayBuffer&&(W=Buffer.from(W).toString());try{W=JSON.parse(W)}catch{return}if(W.notification&&F.listeners(W.notification).length){if(!Object.keys(W.params).length)return F.emit(W.notification);var j=[W.notification];if(W.params.constructor===Object)j.push(W.params);else for(var J=0;J<W.params.length;J++)j.push(W.params[J]);return Promise.resolve().then(function(){F.emit.apply(F,j)})}if(!F.queue[W.id])return W.method&&W.params?Promise.resolve().then(function(){F.emit(W.method,W.params)}):void 0;"error"in W=="result"in W&&F.queue[W.id].promise[1](new Error('Server response malformed. Response must include either "result" or "error", but not both.')),F.queue[W.id].timeout&&clearTimeout(F.queue[W.id].timeout),W.error?F.queue[W.id].promise[1](W.error):F.queue[W.id].promise[0](W.result),delete F.queue[W.id]}),this.socket.addEventListener("error",function(k){return F.emit("error",k)}),this.socket.addEventListener("close",function(k){var W=k.code,j=k.reason;F.ready&&setTimeout(function(){return F.emit("close",W,j)},0),F.ready=!1,F.socket=void 0,W!==1e3&&(F.current_reconnects++,F.reconnect&&(F.max_reconnects>F.current_reconnects||F.max_reconnects===0)&&setTimeout(function(){return F._connect(P,D)},F.reconnect_interval))})}}]),E}(p.EventEmitter);a.default=_})(aP);var Lh=Dy.exports;Object.defineProperty(gw,"__esModule",{value:!0});gw.Client=void 0;var pX=Lh(By.exports),mX=Lh(Fy.exports),gX=Lh(Ny.exports),vX=Lh(Uy.exports),k3=Lh(zy.exports),yX=Lh(oP),xX=Lh(aP);function AX(a){var t=bX();return function(){var i=(0,k3.default)(a),o;if(t){var s=(0,k3.default)(this).constructor;o=Reflect.construct(i,arguments,s)}else o=i.apply(this,arguments);return(0,vX.default)(this,o)}}function bX(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}var _X=function(a){(0,gX.default)(n,a);var t=AX(n);function n(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"ws://localhost:8080",o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s=o.autoconnect,c=s===void 0?!0:s,u=o.reconnect,h=u===void 0?!0:u,f=o.reconnect_interval,p=f===void 0?1e3:f,m=o.max_reconnects,y=m===void 0?5:m,g=arguments.length>2?arguments[2]:void 0;return(0,mX.default)(this,n),t.call(this,yX.default,i,{autoconnect:c,reconnect:h,reconnect_interval:p,max_reconnects:y},g)}return(0,pX.default)(n)}(xX.default);gw.Client=_X;var av,wX=new Uint8Array(16);function uP(){if(!av&&(av=typeof crypto!="undefined"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||typeof msCrypto!="undefined"&&typeof msCrypto.getRandomValues=="function"&&msCrypto.getRandomValues.bind(msCrypto),!av))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return av(wX)}var EX=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;function Hy(a){return typeof a=="string"&&EX.test(a)}var As=[];for(var MA=0;MA<256;++MA)As.push((MA+256).toString(16).substr(1));function Gy(a){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=(As[a[t+0]]+As[a[t+1]]+As[a[t+2]]+As[a[t+3]]+"-"+As[a[t+4]]+As[a[t+5]]+"-"+As[a[t+6]]+As[a[t+7]]+"-"+As[a[t+8]]+As[a[t+9]]+"-"+As[a[t+10]]+As[a[t+11]]+As[a[t+12]]+As[a[t+13]]+As[a[t+14]]+As[a[t+15]]).toLowerCase();if(!Hy(n))throw TypeError("Stringified UUID is invalid");return n}var z3,SA,TA=0,CA=0;function MX(a,t,n){var i=t&&n||0,o=t||new Array(16);a=a||{};var s=a.node||z3,c=a.clockseq!==void 0?a.clockseq:SA;if(s==null||c==null){var u=a.random||(a.rng||uP)();s==null&&(s=z3=[u[0]|1,u[1],u[2],u[3],u[4],u[5]]),c==null&&(c=SA=(u[6]<<8|u[7])&16383)}var h=a.msecs!==void 0?a.msecs:Date.now(),f=a.nsecs!==void 0?a.nsecs:CA+1,p=h-TA+(f-CA)/1e4;if(p<0&&a.clockseq===void 0&&(c=c+1&16383),(p<0||h>TA)&&a.nsecs===void 0&&(f=0),f>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");TA=h,CA=f,SA=c,h+=122192928e5;var m=((h&268435455)*1e4+f)%4294967296;o[i++]=m>>>24&255,o[i++]=m>>>16&255,o[i++]=m>>>8&255,o[i++]=m&255;var y=h/4294967296*1e4&268435455;o[i++]=y>>>8&255,o[i++]=y&255,o[i++]=y>>>24&15|16,o[i++]=y>>>16&255,o[i++]=c>>>8|128,o[i++]=c&255;for(var g=0;g<6;++g)o[i+g]=s[g];return t||Gy(o)}function hP(a){if(!Hy(a))throw TypeError("Invalid UUID");var t,n=new Uint8Array(16);return n[0]=(t=parseInt(a.slice(0,8),16))>>>24,n[1]=t>>>16&255,n[2]=t>>>8&255,n[3]=t&255,n[4]=(t=parseInt(a.slice(9,13),16))>>>8,n[5]=t&255,n[6]=(t=parseInt(a.slice(14,18),16))>>>8,n[7]=t&255,n[8]=(t=parseInt(a.slice(19,23),16))>>>8,n[9]=t&255,n[10]=(t=parseInt(a.slice(24,36),16))/1099511627776&255,n[11]=t/4294967296&255,n[12]=t>>>24&255,n[13]=t>>>16&255,n[14]=t>>>8&255,n[15]=t&255,n}function SX(a){a=unescape(encodeURIComponent(a));for(var t=[],n=0;n<a.length;++n)t.push(a.charCodeAt(n));return t}var TX="6ba7b810-9dad-11d1-80b4-00c04fd430c8",CX="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function fP(a,t,n){function i(o,s,c,u){if(typeof o=="string"&&(o=SX(o)),typeof s=="string"&&(s=hP(s)),s.length!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var h=new Uint8Array(16+o.length);if(h.set(s),h.set(o,s.length),h=n(h),h[6]=h[6]&15|t,h[8]=h[8]&63|128,c){u=u||0;for(var f=0;f<16;++f)c[u+f]=h[f];return c}return Gy(h)}try{i.name=a}catch{}return i.DNS=TX,i.URL=CX,i}function RX(a){if(typeof a=="string"){var t=unescape(encodeURIComponent(a));a=new Uint8Array(t.length);for(var n=0;n<t.length;++n)a[n]=t.charCodeAt(n)}return LX(PX(IX(a),a.length*8))}function LX(a){for(var t=[],n=a.length*32,i="0123456789abcdef",o=0;o<n;o+=8){var s=a[o>>5]>>>o%32&255,c=parseInt(i.charAt(s>>>4&15)+i.charAt(s&15),16);t.push(c)}return t}function dP(a){return(a+64>>>9<<4)+14+1}function PX(a,t){a[t>>5]|=128<<t%32,a[dP(t)-1]=t;for(var n=1732584193,i=-271733879,o=-1732584194,s=271733878,c=0;c<a.length;c+=16){var u=n,h=i,f=o,p=s;n=Ds(n,i,o,s,a[c],7,-680876936),s=Ds(s,n,i,o,a[c+1],12,-389564586),o=Ds(o,s,n,i,a[c+2],17,606105819),i=Ds(i,o,s,n,a[c+3],22,-1044525330),n=Ds(n,i,o,s,a[c+4],7,-176418897),s=Ds(s,n,i,o,a[c+5],12,1200080426),o=Ds(o,s,n,i,a[c+6],17,-1473231341),i=Ds(i,o,s,n,a[c+7],22,-45705983),n=Ds(n,i,o,s,a[c+8],7,1770035416),s=Ds(s,n,i,o,a[c+9],12,-1958414417),o=Ds(o,s,n,i,a[c+10],17,-42063),i=Ds(i,o,s,n,a[c+11],22,-1990404162),n=Ds(n,i,o,s,a[c+12],7,1804603682),s=Ds(s,n,i,o,a[c+13],12,-40341101),o=Ds(o,s,n,i,a[c+14],17,-1502002290),i=Ds(i,o,s,n,a[c+15],22,1236535329),n=Bs(n,i,o,s,a[c+1],5,-165796510),s=Bs(s,n,i,o,a[c+6],9,-1069501632),o=Bs(o,s,n,i,a[c+11],14,643717713),i=Bs(i,o,s,n,a[c],20,-373897302),n=Bs(n,i,o,s,a[c+5],5,-701558691),s=Bs(s,n,i,o,a[c+10],9,38016083),o=Bs(o,s,n,i,a[c+15],14,-660478335),i=Bs(i,o,s,n,a[c+4],20,-405537848),n=Bs(n,i,o,s,a[c+9],5,568446438),s=Bs(s,n,i,o,a[c+14],9,-1019803690),o=Bs(o,s,n,i,a[c+3],14,-187363961),i=Bs(i,o,s,n,a[c+8],20,1163531501),n=Bs(n,i,o,s,a[c+13],5,-1444681467),s=Bs(s,n,i,o,a[c+2],9,-51403784),o=Bs(o,s,n,i,a[c+7],14,1735328473),i=Bs(i,o,s,n,a[c+12],20,-1926607734),n=Fs(n,i,o,s,a[c+5],4,-378558),s=Fs(s,n,i,o,a[c+8],11,-2022574463),o=Fs(o,s,n,i,a[c+11],16,1839030562),i=Fs(i,o,s,n,a[c+14],23,-35309556),n=Fs(n,i,o,s,a[c+1],4,-1530992060),s=Fs(s,n,i,o,a[c+4],11,1272893353),o=Fs(o,s,n,i,a[c+7],16,-155497632),i=Fs(i,o,s,n,a[c+10],23,-1094730640),n=Fs(n,i,o,s,a[c+13],4,681279174),s=Fs(s,n,i,o,a[c],11,-358537222),o=Fs(o,s,n,i,a[c+3],16,-722521979),i=Fs(i,o,s,n,a[c+6],23,76029189),n=Fs(n,i,o,s,a[c+9],4,-640364487),s=Fs(s,n,i,o,a[c+12],11,-421815835),o=Fs(o,s,n,i,a[c+15],16,530742520),i=Fs(i,o,s,n,a[c+2],23,-995338651),n=Ns(n,i,o,s,a[c],6,-198630844),s=Ns(s,n,i,o,a[c+7],10,1126891415),o=Ns(o,s,n,i,a[c+14],15,-1416354905),i=Ns(i,o,s,n,a[c+5],21,-57434055),n=Ns(n,i,o,s,a[c+12],6,1700485571),s=Ns(s,n,i,o,a[c+3],10,-1894986606),o=Ns(o,s,n,i,a[c+10],15,-1051523),i=Ns(i,o,s,n,a[c+1],21,-2054922799),n=Ns(n,i,o,s,a[c+8],6,1873313359),s=Ns(s,n,i,o,a[c+15],10,-30611744),o=Ns(o,s,n,i,a[c+6],15,-1560198380),i=Ns(i,o,s,n,a[c+13],21,1309151649),n=Ns(n,i,o,s,a[c+4],6,-145523070),s=Ns(s,n,i,o,a[c+11],10,-1120210379),o=Ns(o,s,n,i,a[c+2],15,718787259),i=Ns(i,o,s,n,a[c+9],21,-343485551),n=Lc(n,u),i=Lc(i,h),o=Lc(o,f),s=Lc(s,p)}return[n,i,o,s]}function IX(a){if(a.length===0)return[];for(var t=a.length*8,n=new Uint32Array(dP(t)),i=0;i<t;i+=8)n[i>>5]|=(a[i/8]&255)<<i%32;return n}function Lc(a,t){var n=(a&65535)+(t&65535),i=(a>>16)+(t>>16)+(n>>16);return i<<16|n&65535}function OX(a,t){return a<<t|a>>>32-t}function Vy(a,t,n,i,o,s){return Lc(OX(Lc(Lc(t,a),Lc(i,s)),o),n)}function Ds(a,t,n,i,o,s,c){return Vy(t&n|~t&i,a,t,o,s,c)}function Bs(a,t,n,i,o,s,c){return Vy(t&i|n&~i,a,t,o,s,c)}function Fs(a,t,n,i,o,s,c){return Vy(t^n^i,a,t,o,s,c)}function Ns(a,t,n,i,o,s,c){return Vy(n^(t|~i),a,t,o,s,c)}var DX=fP("v3",48,RX),BX=DX;function FX(a,t,n){a=a||{};var i=a.random||(a.rng||uP)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,t){n=n||0;for(var o=0;o<16;++o)t[n+o]=i[o];return t}return Gy(i)}function NX(a,t,n,i){switch(a){case 0:return t&n^~t&i;case 1:return t^n^i;case 2:return t&n^t&i^n&i;case 3:return t^n^i}}function RA(a,t){return a<<t|a>>>32-t}function UX(a){var t=[1518500249,1859775393,2400959708,3395469782],n=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof a=="string"){var i=unescape(encodeURIComponent(a));a=[];for(var o=0;o<i.length;++o)a.push(i.charCodeAt(o))}else Array.isArray(a)||(a=Array.prototype.slice.call(a));a.push(128);for(var s=a.length/4+2,c=Math.ceil(s/16),u=new Array(c),h=0;h<c;++h){for(var f=new Uint32Array(16),p=0;p<16;++p)f[p]=a[h*64+p*4]<<24|a[h*64+p*4+1]<<16|a[h*64+p*4+2]<<8|a[h*64+p*4+3];u[h]=f}u[c-1][14]=(a.length-1)*8/Math.pow(2,32),u[c-1][14]=Math.floor(u[c-1][14]),u[c-1][15]=(a.length-1)*8&4294967295;for(var m=0;m<c;++m){for(var y=new Uint32Array(80),g=0;g<16;++g)y[g]=u[m][g];for(var _=16;_<80;++_)y[_]=RA(y[_-3]^y[_-8]^y[_-14]^y[_-16],1);for(var x=n[0],b=n[1],E=n[2],T=n[3],P=n[4],D=0;D<80;++D){var F=Math.floor(D/20),k=RA(x,5)+NX(F,b,E,T)+P+t[F]+y[D]>>>0;P=T,T=E,E=RA(b,30)>>>0,b=x,x=k}n[0]=n[0]+x>>>0,n[1]=n[1]+b>>>0,n[2]=n[2]+E>>>0,n[3]=n[3]+T>>>0,n[4]=n[4]+P>>>0}return[n[0]>>24&255,n[0]>>16&255,n[0]>>8&255,n[0]&255,n[1]>>24&255,n[1]>>16&255,n[1]>>8&255,n[1]&255,n[2]>>24&255,n[2]>>16&255,n[2]>>8&255,n[2]&255,n[3]>>24&255,n[3]>>16&255,n[3]>>8&255,n[3]&255,n[4]>>24&255,n[4]>>16&255,n[4]>>8&255,n[4]&255]}var kX=fP("v5",80,UX),zX=kX,HX="00000000-0000-0000-0000-000000000000";function GX(a){if(!Hy(a))throw TypeError("Invalid UUID");return parseInt(a.substr(14,1),16)}var VX=Object.freeze(Object.defineProperty({__proto__:null,v1:MX,v3:BX,v4:FX,v5:zX,NIL:HX,version:GX,validate:Hy,stringify:Gy,parse:hP},Symbol.toStringTag,{value:"Module"})),pP=ly(VX);pP.v4;pP.v4;var mP={};const WX="elliptic",jX="6.5.4",XX="EC cryptography",$X="lib/elliptic.js",qX=["lib"],YX={lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},QX={type:"git",url:"git@github.com:indutny/elliptic"},KX=["EC","Elliptic","curve","Cryptography"],ZX="Fedor Indutny <fedor@indutny.com>",JX="MIT",e$={url:"https://github.com/indutny/elliptic/issues"},t$="https://github.com/indutny/elliptic",n$={brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},i$={"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"};var r$={name:WX,version:jX,description:XX,main:$X,files:qX,scripts:YX,repository:QX,keywords:KX,author:ZX,license:JX,bugs:e$,homepage:t$,devDependencies:n$,dependencies:i$},Oo={},al={exports:{}};(function(a){(function(t,n){function i(te,N){if(!te)throw new Error(N||"Assertion failed")}function o(te,N){te.super_=N;var L=function(){};L.prototype=N.prototype,te.prototype=new L,te.prototype.constructor=te}function s(te,N,L){if(s.isBN(te))return te;this.negative=0,this.words=null,this.length=0,this.red=null,te!==null&&((N==="le"||N==="be")&&(L=N,N=10),this._init(te||0,N||10,L||"be"))}typeof t=="object"?t.exports=s:n.BN=s,s.BN=s,s.wordSize=26;var c;try{typeof window!="undefined"&&typeof window.Buffer!="undefined"?c=window.Buffer:c=require("buffer").Buffer}catch{}s.isBN=function(N){return N instanceof s?!0:N!==null&&typeof N=="object"&&N.constructor.wordSize===s.wordSize&&Array.isArray(N.words)},s.max=function(N,L){return N.cmp(L)>0?N:L},s.min=function(N,L){return N.cmp(L)<0?N:L},s.prototype._init=function(N,L,M){if(typeof N=="number")return this._initNumber(N,L,M);if(typeof N=="object")return this._initArray(N,L,M);L==="hex"&&(L=16),i(L===(L|0)&&L>=2&&L<=36),N=N.toString().replace(/\s+/g,"");var I=0;N[0]==="-"&&(I++,this.negative=1),I<N.length&&(L===16?this._parseHex(N,I,M):(this._parseBase(N,L,I),M==="le"&&this._initArray(this.toArray(),L,M)))},s.prototype._initNumber=function(N,L,M){N<0&&(this.negative=1,N=-N),N<67108864?(this.words=[N&67108863],this.length=1):N<4503599627370496?(this.words=[N&67108863,N/67108864&67108863],this.length=2):(i(N<9007199254740992),this.words=[N&67108863,N/67108864&67108863,1],this.length=3),M==="le"&&this._initArray(this.toArray(),L,M)},s.prototype._initArray=function(N,L,M){if(i(typeof N.length=="number"),N.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(N.length/3),this.words=new Array(this.length);for(var I=0;I<this.length;I++)this.words[I]=0;var U,$,ee=0;if(M==="be")for(I=N.length-1,U=0;I>=0;I-=3)$=N[I]|N[I-1]<<8|N[I-2]<<16,this.words[U]|=$<<ee&67108863,this.words[U+1]=$>>>26-ee&67108863,ee+=24,ee>=26&&(ee-=26,U++);else if(M==="le")for(I=0,U=0;I<N.length;I+=3)$=N[I]|N[I+1]<<8|N[I+2]<<16,this.words[U]|=$<<ee&67108863,this.words[U+1]=$>>>26-ee&67108863,ee+=24,ee>=26&&(ee-=26,U++);return this.strip()};function u(te,N){var L=te.charCodeAt(N);return L>=65&&L<=70?L-55:L>=97&&L<=102?L-87:L-48&15}function h(te,N,L){var M=u(te,L);return L-1>=N&&(M|=u(te,L-1)<<4),M}s.prototype._parseHex=function(N,L,M){this.length=Math.ceil((N.length-L)/6),this.words=new Array(this.length);for(var I=0;I<this.length;I++)this.words[I]=0;var U=0,$=0,ee;if(M==="be")for(I=N.length-1;I>=L;I-=2)ee=h(N,L,I)<<U,this.words[$]|=ee&67108863,U>=18?(U-=18,$+=1,this.words[$]|=ee>>>26):U+=8;else{var Q=N.length-L;for(I=Q%2===0?L+1:L;I<N.length;I+=2)ee=h(N,L,I)<<U,this.words[$]|=ee&67108863,U>=18?(U-=18,$+=1,this.words[$]|=ee>>>26):U+=8}this.strip()};function f(te,N,L,M){for(var I=0,U=Math.min(te.length,L),$=N;$<U;$++){var ee=te.charCodeAt($)-48;I*=M,ee>=49?I+=ee-49+10:ee>=17?I+=ee-17+10:I+=ee}return I}s.prototype._parseBase=function(N,L,M){this.words=[0],this.length=1;for(var I=0,U=1;U<=67108863;U*=L)I++;I--,U=U/L|0;for(var $=N.length-M,ee=$%I,Q=Math.min($,$-ee)+M,G=0,K=M;K<Q;K+=I)G=f(N,K,K+I,L),this.imuln(U),this.words[0]+G<67108864?this.words[0]+=G:this._iaddn(G);if(ee!==0){var Y=1;for(G=f(N,K,N.length,L),K=0;K<ee;K++)Y*=L;this.imuln(Y),this.words[0]+G<67108864?this.words[0]+=G:this._iaddn(G)}this.strip()},s.prototype.copy=function(N){N.words=new Array(this.length);for(var L=0;L<this.length;L++)N.words[L]=this.words[L];N.length=this.length,N.negative=this.negative,N.red=this.red},s.prototype.clone=function(){var N=new s(null);return this.copy(N),N},s.prototype._expand=function(N){for(;this.length<N;)this.words[this.length++]=0;return this},s.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},s.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},s.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var p=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],m=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],y=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];s.prototype.toString=function(N,L){N=N||10,L=L|0||1;var M;if(N===16||N==="hex"){M="";for(var I=0,U=0,$=0;$<this.length;$++){var ee=this.words[$],Q=((ee<<I|U)&16777215).toString(16);U=ee>>>24-I&16777215,U!==0||$!==this.length-1?M=p[6-Q.length]+Q+M:M=Q+M,I+=2,I>=26&&(I-=26,$--)}for(U!==0&&(M=U.toString(16)+M);M.length%L!==0;)M="0"+M;return this.negative!==0&&(M="-"+M),M}if(N===(N|0)&&N>=2&&N<=36){var G=m[N],K=y[N];M="";var Y=this.clone();for(Y.negative=0;!Y.isZero();){var we=Y.modn(K).toString(N);Y=Y.idivn(K),Y.isZero()?M=we+M:M=p[G-we.length]+we+M}for(this.isZero()&&(M="0"+M);M.length%L!==0;)M="0"+M;return this.negative!==0&&(M="-"+M),M}i(!1,"Base should be between 2 and 36")},s.prototype.toNumber=function(){var N=this.words[0];return this.length===2?N+=this.words[1]*67108864:this.length===3&&this.words[2]===1?N+=4503599627370496+this.words[1]*67108864:this.length>2&&i(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-N:N},s.prototype.toJSON=function(){return this.toString(16)},s.prototype.toBuffer=function(N,L){return i(typeof c!="undefined"),this.toArrayLike(c,N,L)},s.prototype.toArray=function(N,L){return this.toArrayLike(Array,N,L)},s.prototype.toArrayLike=function(N,L,M){var I=this.byteLength(),U=M||Math.max(1,I);i(I<=U,"byte array longer than desired length"),i(U>0,"Requested array length <= 0"),this.strip();var $=L==="le",ee=new N(U),Q,G,K=this.clone();if($){for(G=0;!K.isZero();G++)Q=K.andln(255),K.iushrn(8),ee[G]=Q;for(;G<U;G++)ee[G]=0}else{for(G=0;G<U-I;G++)ee[G]=0;for(G=0;!K.isZero();G++)Q=K.andln(255),K.iushrn(8),ee[U-G-1]=Q}return ee},Math.clz32?s.prototype._countBits=function(N){return 32-Math.clz32(N)}:s.prototype._countBits=function(N){var L=N,M=0;return L>=4096&&(M+=13,L>>>=13),L>=64&&(M+=7,L>>>=7),L>=8&&(M+=4,L>>>=4),L>=2&&(M+=2,L>>>=2),M+L},s.prototype._zeroBits=function(N){if(N===0)return 26;var L=N,M=0;return(L&8191)===0&&(M+=13,L>>>=13),(L&127)===0&&(M+=7,L>>>=7),(L&15)===0&&(M+=4,L>>>=4),(L&3)===0&&(M+=2,L>>>=2),(L&1)===0&&M++,M},s.prototype.bitLength=function(){var N=this.words[this.length-1],L=this._countBits(N);return(this.length-1)*26+L};function g(te){for(var N=new Array(te.bitLength()),L=0;L<N.length;L++){var M=L/26|0,I=L%26;N[L]=(te.words[M]&1<<I)>>>I}return N}s.prototype.zeroBits=function(){if(this.isZero())return 0;for(var N=0,L=0;L<this.length;L++){var M=this._zeroBits(this.words[L]);if(N+=M,M!==26)break}return N},s.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},s.prototype.toTwos=function(N){return this.negative!==0?this.abs().inotn(N).iaddn(1):this.clone()},s.prototype.fromTwos=function(N){return this.testn(N-1)?this.notn(N).iaddn(1).ineg():this.clone()},s.prototype.isNeg=function(){return this.negative!==0},s.prototype.neg=function(){return this.clone().ineg()},s.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},s.prototype.iuor=function(N){for(;this.length<N.length;)this.words[this.length++]=0;for(var L=0;L<N.length;L++)this.words[L]=this.words[L]|N.words[L];return this.strip()},s.prototype.ior=function(N){return i((this.negative|N.negative)===0),this.iuor(N)},s.prototype.or=function(N){return this.length>N.length?this.clone().ior(N):N.clone().ior(this)},s.prototype.uor=function(N){return this.length>N.length?this.clone().iuor(N):N.clone().iuor(this)},s.prototype.iuand=function(N){var L;this.length>N.length?L=N:L=this;for(var M=0;M<L.length;M++)this.words[M]=this.words[M]&N.words[M];return this.length=L.length,this.strip()},s.prototype.iand=function(N){return i((this.negative|N.negative)===0),this.iuand(N)},s.prototype.and=function(N){return this.length>N.length?this.clone().iand(N):N.clone().iand(this)},s.prototype.uand=function(N){return this.length>N.length?this.clone().iuand(N):N.clone().iuand(this)},s.prototype.iuxor=function(N){var L,M;this.length>N.length?(L=this,M=N):(L=N,M=this);for(var I=0;I<M.length;I++)this.words[I]=L.words[I]^M.words[I];if(this!==L)for(;I<L.length;I++)this.words[I]=L.words[I];return this.length=L.length,this.strip()},s.prototype.ixor=function(N){return i((this.negative|N.negative)===0),this.iuxor(N)},s.prototype.xor=function(N){return this.length>N.length?this.clone().ixor(N):N.clone().ixor(this)},s.prototype.uxor=function(N){return this.length>N.length?this.clone().iuxor(N):N.clone().iuxor(this)},s.prototype.inotn=function(N){i(typeof N=="number"&&N>=0);var L=Math.ceil(N/26)|0,M=N%26;this._expand(L),M>0&&L--;for(var I=0;I<L;I++)this.words[I]=~this.words[I]&67108863;return M>0&&(this.words[I]=~this.words[I]&67108863>>26-M),this.strip()},s.prototype.notn=function(N){return this.clone().inotn(N)},s.prototype.setn=function(N,L){i(typeof N=="number"&&N>=0);var M=N/26|0,I=N%26;return this._expand(M+1),L?this.words[M]=this.words[M]|1<<I:this.words[M]=this.words[M]&~(1<<I),this.strip()},s.prototype.iadd=function(N){var L;if(this.negative!==0&&N.negative===0)return this.negative=0,L=this.isub(N),this.negative^=1,this._normSign();if(this.negative===0&&N.negative!==0)return N.negative=0,L=this.isub(N),N.negative=1,L._normSign();var M,I;this.length>N.length?(M=this,I=N):(M=N,I=this);for(var U=0,$=0;$<I.length;$++)L=(M.words[$]|0)+(I.words[$]|0)+U,this.words[$]=L&67108863,U=L>>>26;for(;U!==0&&$<M.length;$++)L=(M.words[$]|0)+U,this.words[$]=L&67108863,U=L>>>26;if(this.length=M.length,U!==0)this.words[this.length]=U,this.length++;else if(M!==this)for(;$<M.length;$++)this.words[$]=M.words[$];return this},s.prototype.add=function(N){var L;return N.negative!==0&&this.negative===0?(N.negative=0,L=this.sub(N),N.negative^=1,L):N.negative===0&&this.negative!==0?(this.negative=0,L=N.sub(this),this.negative=1,L):this.length>N.length?this.clone().iadd(N):N.clone().iadd(this)},s.prototype.isub=function(N){if(N.negative!==0){N.negative=0;var L=this.iadd(N);return N.negative=1,L._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(N),this.negative=1,this._normSign();var M=this.cmp(N);if(M===0)return this.negative=0,this.length=1,this.words[0]=0,this;var I,U;M>0?(I=this,U=N):(I=N,U=this);for(var $=0,ee=0;ee<U.length;ee++)L=(I.words[ee]|0)-(U.words[ee]|0)+$,$=L>>26,this.words[ee]=L&67108863;for(;$!==0&&ee<I.length;ee++)L=(I.words[ee]|0)+$,$=L>>26,this.words[ee]=L&67108863;if($===0&&ee<I.length&&I!==this)for(;ee<I.length;ee++)this.words[ee]=I.words[ee];return this.length=Math.max(this.length,ee),I!==this&&(this.negative=1),this.strip()},s.prototype.sub=function(N){return this.clone().isub(N)};function _(te,N,L){L.negative=N.negative^te.negative;var M=te.length+N.length|0;L.length=M,M=M-1|0;var I=te.words[0]|0,U=N.words[0]|0,$=I*U,ee=$&67108863,Q=$/67108864|0;L.words[0]=ee;for(var G=1;G<M;G++){for(var K=Q>>>26,Y=Q&67108863,we=Math.min(G,N.length-1),Ke=Math.max(0,G-te.length+1);Ke<=we;Ke++){var ge=G-Ke|0;I=te.words[ge]|0,U=N.words[Ke]|0,$=I*U+Y,K+=$/67108864|0,Y=$&67108863}L.words[G]=Y|0,Q=K|0}return Q!==0?L.words[G]=Q|0:L.length--,L.strip()}var x=function(N,L,M){var I=N.words,U=L.words,$=M.words,ee=0,Q,G,K,Y=I[0]|0,we=Y&8191,Ke=Y>>>13,ge=I[1]|0,me=ge&8191,De=ge>>>13,ze=I[2]|0,tt=ze&8191,rt=ze>>>13,vt=I[3]|0,Ye=vt&8191,Pe=vt>>>13,Be=I[4]|0,$e=Be&8191,Je=Be>>>13,We=I[5]|0,_e=We&8191,Ee=We>>>13,Oe=I[6]|0,Le=Oe&8191,ce=Oe>>>13,he=I[7]|0,ie=he&8191,V=he>>>13,Z=I[8]|0,B=Z&8191,S=Z>>>13,R=I[9]|0,X=R&8191,xe=R>>>13,Ie=U[0]|0,ye=Ie&8191,nt=Ie>>>13,at=U[1]|0,mt=at&8191,wt=at>>>13,Lt=U[2]|0,Ct=Lt&8191,ut=Lt>>>13,St=U[3]|0,Tt=St&8191,gn=St>>>13,An=U[4]|0,un=An&8191,Mn=An>>>13,Cn=U[5]|0,wn=Cn&8191,zn=Cn>>>13,ai=U[6]|0,xn=ai&8191,Zn=ai>>>13,Me=U[7]|0,le=Me&8191,be=Me>>>13,q=U[8]|0,Se=q&8191,Ge=q>>>13,lt=U[9]|0,dt=lt&8191,Re=lt>>>13;M.negative=N.negative^L.negative,M.length=19,Q=Math.imul(we,ye),G=Math.imul(we,nt),G=G+Math.imul(Ke,ye)|0,K=Math.imul(Ke,nt);var Ue=(ee+Q|0)+((G&8191)<<13)|0;ee=(K+(G>>>13)|0)+(Ue>>>26)|0,Ue&=67108863,Q=Math.imul(me,ye),G=Math.imul(me,nt),G=G+Math.imul(De,ye)|0,K=Math.imul(De,nt),Q=Q+Math.imul(we,mt)|0,G=G+Math.imul(we,wt)|0,G=G+Math.imul(Ke,mt)|0,K=K+Math.imul(Ke,wt)|0;var Xe=(ee+Q|0)+((G&8191)<<13)|0;ee=(K+(G>>>13)|0)+(Xe>>>26)|0,Xe&=67108863,Q=Math.imul(tt,ye),G=Math.imul(tt,nt),G=G+Math.imul(rt,ye)|0,K=Math.imul(rt,nt),Q=Q+Math.imul(me,mt)|0,G=G+Math.imul(me,wt)|0,G=G+Math.imul(De,mt)|0,K=K+Math.imul(De,wt)|0,Q=Q+Math.imul(we,Ct)|0,G=G+Math.imul(we,ut)|0,G=G+Math.imul(Ke,Ct)|0,K=K+Math.imul(Ke,ut)|0;var ft=(ee+Q|0)+((G&8191)<<13)|0;ee=(K+(G>>>13)|0)+(ft>>>26)|0,ft&=67108863,Q=Math.imul(Ye,ye),G=Math.imul(Ye,nt),G=G+Math.imul(Pe,ye)|0,K=Math.imul(Pe,nt),Q=Q+Math.imul(tt,mt)|0,G=G+Math.imul(tt,wt)|0,G=G+Math.imul(rt,mt)|0,K=K+Math.imul(rt,wt)|0,Q=Q+Math.imul(me,Ct)|0,G=G+Math.imul(me,ut)|0,G=G+Math.imul(De,Ct)|0,K=K+Math.imul(De,ut)|0,Q=Q+Math.imul(we,Tt)|0,G=G+Math.imul(we,gn)|0,G=G+Math.imul(Ke,Tt)|0,K=K+Math.imul(Ke,gn)|0;var it=(ee+Q|0)+((G&8191)<<13)|0;ee=(K+(G>>>13)|0)+(it>>>26)|0,it&=67108863,Q=Math.imul($e,ye),G=Math.imul($e,nt),G=G+Math.imul(Je,ye)|0,K=Math.imul(Je,nt),Q=Q+Math.imul(Ye,mt)|0,G=G+Math.imul(Ye,wt)|0,G=G+Math.imul(Pe,mt)|0,K=K+Math.imul(Pe,wt)|0,Q=Q+Math.imul(tt,Ct)|0,G=G+Math.imul(tt,ut)|0,G=G+Math.imul(rt,Ct)|0,K=K+Math.imul(rt,ut)|0,Q=Q+Math.imul(me,Tt)|0,G=G+Math.imul(me,gn)|0,G=G+Math.imul(De,Tt)|0,K=K+Math.imul(De,gn)|0,Q=Q+Math.imul(we,un)|0,G=G+Math.imul(we,Mn)|0,G=G+Math.imul(Ke,un)|0,K=K+Math.imul(Ke,Mn)|0;var xt=(ee+Q|0)+((G&8191)<<13)|0;ee=(K+(G>>>13)|0)+(xt>>>26)|0,xt&=67108863,Q=Math.imul(_e,ye),G=Math.imul(_e,nt),G=G+Math.imul(Ee,ye)|0,K=Math.imul(Ee,nt),Q=Q+Math.imul($e,mt)|0,G=G+Math.imul($e,wt)|0,G=G+Math.imul(Je,mt)|0,K=K+Math.imul(Je,wt)|0,Q=Q+Math.imul(Ye,Ct)|0,G=G+Math.imul(Ye,ut)|0,G=G+Math.imul(Pe,Ct)|0,K=K+Math.imul(Pe,ut)|0,Q=Q+Math.imul(tt,Tt)|0,G=G+Math.imul(tt,gn)|0,G=G+Math.imul(rt,Tt)|0,K=K+Math.imul(rt,gn)|0,Q=Q+Math.imul(me,un)|0,G=G+Math.imul(me,Mn)|0,G=G+Math.imul(De,un)|0,K=K+Math.imul(De,Mn)|0,Q=Q+Math.imul(we,wn)|0,G=G+Math.imul(we,zn)|0,G=G+Math.imul(Ke,wn)|0,K=K+Math.imul(Ke,zn)|0;var Dt=(ee+Q|0)+((G&8191)<<13)|0;ee=(K+(G>>>13)|0)+(Dt>>>26)|0,Dt&=67108863,Q=Math.imul(Le,ye),G=Math.imul(Le,nt),G=G+Math.imul(ce,ye)|0,K=Math.imul(ce,nt),Q=Q+Math.imul(_e,mt)|0,G=G+Math.imul(_e,wt)|0,G=G+Math.imul(Ee,mt)|0,K=K+Math.imul(Ee,wt)|0,Q=Q+Math.imul($e,Ct)|0,G=G+Math.imul($e,ut)|0,G=G+Math.imul(Je,Ct)|0,K=K+Math.imul(Je,ut)|0,Q=Q+Math.imul(Ye,Tt)|0,G=G+Math.imul(Ye,gn)|0,G=G+Math.imul(Pe,Tt)|0,K=K+Math.imul(Pe,gn)|0,Q=Q+Math.imul(tt,un)|0,G=G+Math.imul(tt,Mn)|0,G=G+Math.imul(rt,un)|0,K=K+Math.imul(rt,Mn)|0,Q=Q+Math.imul(me,wn)|0,G=G+Math.imul(me,zn)|0,G=G+Math.imul(De,wn)|0,K=K+Math.imul(De,zn)|0,Q=Q+Math.imul(we,xn)|0,G=G+Math.imul(we,Zn)|0,G=G+Math.imul(Ke,xn)|0,K=K+Math.imul(Ke,Zn)|0;var Kt=(ee+Q|0)+((G&8191)<<13)|0;ee=(K+(G>>>13)|0)+(Kt>>>26)|0,Kt&=67108863,Q=Math.imul(ie,ye),G=Math.imul(ie,nt),G=G+Math.imul(V,ye)|0,K=Math.imul(V,nt),Q=Q+Math.imul(Le,mt)|0,G=G+Math.imul(Le,wt)|0,G=G+Math.imul(ce,mt)|0,K=K+Math.imul(ce,wt)|0,Q=Q+Math.imul(_e,Ct)|0,G=G+Math.imul(_e,ut)|0,G=G+Math.imul(Ee,Ct)|0,K=K+Math.imul(Ee,ut)|0,Q=Q+Math.imul($e,Tt)|0,G=G+Math.imul($e,gn)|0,G=G+Math.imul(Je,Tt)|0,K=K+Math.imul(Je,gn)|0,Q=Q+Math.imul(Ye,un)|0,G=G+Math.imul(Ye,Mn)|0,G=G+Math.imul(Pe,un)|0,K=K+Math.imul(Pe,Mn)|0,Q=Q+Math.imul(tt,wn)|0,G=G+Math.imul(tt,zn)|0,G=G+Math.imul(rt,wn)|0,K=K+Math.imul(rt,zn)|0,Q=Q+Math.imul(me,xn)|0,G=G+Math.imul(me,Zn)|0,G=G+Math.imul(De,xn)|0,K=K+Math.imul(De,Zn)|0,Q=Q+Math.imul(we,le)|0,G=G+Math.imul(we,be)|0,G=G+Math.imul(Ke,le)|0,K=K+Math.imul(Ke,be)|0;var Wt=(ee+Q|0)+((G&8191)<<13)|0;ee=(K+(G>>>13)|0)+(Wt>>>26)|0,Wt&=67108863,Q=Math.imul(B,ye),G=Math.imul(B,nt),G=G+Math.imul(S,ye)|0,K=Math.imul(S,nt),Q=Q+Math.imul(ie,mt)|0,G=G+Math.imul(ie,wt)|0,G=G+Math.imul(V,mt)|0,K=K+Math.imul(V,wt)|0,Q=Q+Math.imul(Le,Ct)|0,G=G+Math.imul(Le,ut)|0,G=G+Math.imul(ce,Ct)|0,K=K+Math.imul(ce,ut)|0,Q=Q+Math.imul(_e,Tt)|0,G=G+Math.imul(_e,gn)|0,G=G+Math.imul(Ee,Tt)|0,K=K+Math.imul(Ee,gn)|0,Q=Q+Math.imul($e,un)|0,G=G+Math.imul($e,Mn)|0,G=G+Math.imul(Je,un)|0,K=K+Math.imul(Je,Mn)|0,Q=Q+Math.imul(Ye,wn)|0,G=G+Math.imul(Ye,zn)|0,G=G+Math.imul(Pe,wn)|0,K=K+Math.imul(Pe,zn)|0,Q=Q+Math.imul(tt,xn)|0,G=G+Math.imul(tt,Zn)|0,G=G+Math.imul(rt,xn)|0,K=K+Math.imul(rt,Zn)|0,Q=Q+Math.imul(me,le)|0,G=G+Math.imul(me,be)|0,G=G+Math.imul(De,le)|0,K=K+Math.imul(De,be)|0,Q=Q+Math.imul(we,Se)|0,G=G+Math.imul(we,Ge)|0,G=G+Math.imul(Ke,Se)|0,K=K+Math.imul(Ke,Ge)|0;var bt=(ee+Q|0)+((G&8191)<<13)|0;ee=(K+(G>>>13)|0)+(bt>>>26)|0,bt&=67108863,Q=Math.imul(X,ye),G=Math.imul(X,nt),G=G+Math.imul(xe,ye)|0,K=Math.imul(xe,nt),Q=Q+Math.imul(B,mt)|0,G=G+Math.imul(B,wt)|0,G=G+Math.imul(S,mt)|0,K=K+Math.imul(S,wt)|0,Q=Q+Math.imul(ie,Ct)|0,G=G+Math.imul(ie,ut)|0,G=G+Math.imul(V,Ct)|0,K=K+Math.imul(V,ut)|0,Q=Q+Math.imul(Le,Tt)|0,G=G+Math.imul(Le,gn)|0,G=G+Math.imul(ce,Tt)|0,K=K+Math.imul(ce,gn)|0,Q=Q+Math.imul(_e,un)|0,G=G+Math.imul(_e,Mn)|0,G=G+Math.imul(Ee,un)|0,K=K+Math.imul(Ee,Mn)|0,Q=Q+Math.imul($e,wn)|0,G=G+Math.imul($e,zn)|0,G=G+Math.imul(Je,wn)|0,K=K+Math.imul(Je,zn)|0,Q=Q+Math.imul(Ye,xn)|0,G=G+Math.imul(Ye,Zn)|0,G=G+Math.imul(Pe,xn)|0,K=K+Math.imul(Pe,Zn)|0,Q=Q+Math.imul(tt,le)|0,G=G+Math.imul(tt,be)|0,G=G+Math.imul(rt,le)|0,K=K+Math.imul(rt,be)|0,Q=Q+Math.imul(me,Se)|0,G=G+Math.imul(me,Ge)|0,G=G+Math.imul(De,Se)|0,K=K+Math.imul(De,Ge)|0,Q=Q+Math.imul(we,dt)|0,G=G+Math.imul(we,Re)|0,G=G+Math.imul(Ke,dt)|0,K=K+Math.imul(Ke,Re)|0;var jt=(ee+Q|0)+((G&8191)<<13)|0;ee=(K+(G>>>13)|0)+(jt>>>26)|0,jt&=67108863,Q=Math.imul(X,mt),G=Math.imul(X,wt),G=G+Math.imul(xe,mt)|0,K=Math.imul(xe,wt),Q=Q+Math.imul(B,Ct)|0,G=G+Math.imul(B,ut)|0,G=G+Math.imul(S,Ct)|0,K=K+Math.imul(S,ut)|0,Q=Q+Math.imul(ie,Tt)|0,G=G+Math.imul(ie,gn)|0,G=G+Math.imul(V,Tt)|0,K=K+Math.imul(V,gn)|0,Q=Q+Math.imul(Le,un)|0,G=G+Math.imul(Le,Mn)|0,G=G+Math.imul(ce,un)|0,K=K+Math.imul(ce,Mn)|0,Q=Q+Math.imul(_e,wn)|0,G=G+Math.imul(_e,zn)|0,G=G+Math.imul(Ee,wn)|0,K=K+Math.imul(Ee,zn)|0,Q=Q+Math.imul($e,xn)|0,G=G+Math.imul($e,Zn)|0,G=G+Math.imul(Je,xn)|0,K=K+Math.imul(Je,Zn)|0,Q=Q+Math.imul(Ye,le)|0,G=G+Math.imul(Ye,be)|0,G=G+Math.imul(Pe,le)|0,K=K+Math.imul(Pe,be)|0,Q=Q+Math.imul(tt,Se)|0,G=G+Math.imul(tt,Ge)|0,G=G+Math.imul(rt,Se)|0,K=K+Math.imul(rt,Ge)|0,Q=Q+Math.imul(me,dt)|0,G=G+Math.imul(me,Re)|0,G=G+Math.imul(De,dt)|0,K=K+Math.imul(De,Re)|0;var on=(ee+Q|0)+((G&8191)<<13)|0;ee=(K+(G>>>13)|0)+(on>>>26)|0,on&=67108863,Q=Math.imul(X,Ct),G=Math.imul(X,ut),G=G+Math.imul(xe,Ct)|0,K=Math.imul(xe,ut),Q=Q+Math.imul(B,Tt)|0,G=G+Math.imul(B,gn)|0,G=G+Math.imul(S,Tt)|0,K=K+Math.imul(S,gn)|0,Q=Q+Math.imul(ie,un)|0,G=G+Math.imul(ie,Mn)|0,G=G+Math.imul(V,un)|0,K=K+Math.imul(V,Mn)|0,Q=Q+Math.imul(Le,wn)|0,G=G+Math.imul(Le,zn)|0,G=G+Math.imul(ce,wn)|0,K=K+Math.imul(ce,zn)|0,Q=Q+Math.imul(_e,xn)|0,G=G+Math.imul(_e,Zn)|0,G=G+Math.imul(Ee,xn)|0,K=K+Math.imul(Ee,Zn)|0,Q=Q+Math.imul($e,le)|0,G=G+Math.imul($e,be)|0,G=G+Math.imul(Je,le)|0,K=K+Math.imul(Je,be)|0,Q=Q+Math.imul(Ye,Se)|0,G=G+Math.imul(Ye,Ge)|0,G=G+Math.imul(Pe,Se)|0,K=K+Math.imul(Pe,Ge)|0,Q=Q+Math.imul(tt,dt)|0,G=G+Math.imul(tt,Re)|0,G=G+Math.imul(rt,dt)|0,K=K+Math.imul(rt,Re)|0;var $t=(ee+Q|0)+((G&8191)<<13)|0;ee=(K+(G>>>13)|0)+($t>>>26)|0,$t&=67108863,Q=Math.imul(X,Tt),G=Math.imul(X,gn),G=G+Math.imul(xe,Tt)|0,K=Math.imul(xe,gn),Q=Q+Math.imul(B,un)|0,G=G+Math.imul(B,Mn)|0,G=G+Math.imul(S,un)|0,K=K+Math.imul(S,Mn)|0,Q=Q+Math.imul(ie,wn)|0,G=G+Math.imul(ie,zn)|0,G=G+Math.imul(V,wn)|0,K=K+Math.imul(V,zn)|0,Q=Q+Math.imul(Le,xn)|0,G=G+Math.imul(Le,Zn)|0,G=G+Math.imul(ce,xn)|0,K=K+Math.imul(ce,Zn)|0,Q=Q+Math.imul(_e,le)|0,G=G+Math.imul(_e,be)|0,G=G+Math.imul(Ee,le)|0,K=K+Math.imul(Ee,be)|0,Q=Q+Math.imul($e,Se)|0,G=G+Math.imul($e,Ge)|0,G=G+Math.imul(Je,Se)|0,K=K+Math.imul(Je,Ge)|0,Q=Q+Math.imul(Ye,dt)|0,G=G+Math.imul(Ye,Re)|0,G=G+Math.imul(Pe,dt)|0,K=K+Math.imul(Pe,Re)|0;var vn=(ee+Q|0)+((G&8191)<<13)|0;ee=(K+(G>>>13)|0)+(vn>>>26)|0,vn&=67108863,Q=Math.imul(X,un),G=Math.imul(X,Mn),G=G+Math.imul(xe,un)|0,K=Math.imul(xe,Mn),Q=Q+Math.imul(B,wn)|0,G=G+Math.imul(B,zn)|0,G=G+Math.imul(S,wn)|0,K=K+Math.imul(S,zn)|0,Q=Q+Math.imul(ie,xn)|0,G=G+Math.imul(ie,Zn)|0,G=G+Math.imul(V,xn)|0,K=K+Math.imul(V,Zn)|0,Q=Q+Math.imul(Le,le)|0,G=G+Math.imul(Le,be)|0,G=G+Math.imul(ce,le)|0,K=K+Math.imul(ce,be)|0,Q=Q+Math.imul(_e,Se)|0,G=G+Math.imul(_e,Ge)|0,G=G+Math.imul(Ee,Se)|0,K=K+Math.imul(Ee,Ge)|0,Q=Q+Math.imul($e,dt)|0,G=G+Math.imul($e,Re)|0,G=G+Math.imul(Je,dt)|0,K=K+Math.imul(Je,Re)|0;var Jt=(ee+Q|0)+((G&8191)<<13)|0;ee=(K+(G>>>13)|0)+(Jt>>>26)|0,Jt&=67108863,Q=Math.imul(X,wn),G=Math.imul(X,zn),G=G+Math.imul(xe,wn)|0,K=Math.imul(xe,zn),Q=Q+Math.imul(B,xn)|0,G=G+Math.imul(B,Zn)|0,G=G+Math.imul(S,xn)|0,K=K+Math.imul(S,Zn)|0,Q=Q+Math.imul(ie,le)|0,G=G+Math.imul(ie,be)|0,G=G+Math.imul(V,le)|0,K=K+Math.imul(V,be)|0,Q=Q+Math.imul(Le,Se)|0,G=G+Math.imul(Le,Ge)|0,G=G+Math.imul(ce,Se)|0,K=K+Math.imul(ce,Ge)|0,Q=Q+Math.imul(_e,dt)|0,G=G+Math.imul(_e,Re)|0,G=G+Math.imul(Ee,dt)|0,K=K+Math.imul(Ee,Re)|0;var nn=(ee+Q|0)+((G&8191)<<13)|0;ee=(K+(G>>>13)|0)+(nn>>>26)|0,nn&=67108863,Q=Math.imul(X,xn),G=Math.imul(X,Zn),G=G+Math.imul(xe,xn)|0,K=Math.imul(xe,Zn),Q=Q+Math.imul(B,le)|0,G=G+Math.imul(B,be)|0,G=G+Math.imul(S,le)|0,K=K+Math.imul(S,be)|0,Q=Q+Math.imul(ie,Se)|0,G=G+Math.imul(ie,Ge)|0,G=G+Math.imul(V,Se)|0,K=K+Math.imul(V,Ge)|0,Q=Q+Math.imul(Le,dt)|0,G=G+Math.imul(Le,Re)|0,G=G+Math.imul(ce,dt)|0,K=K+Math.imul(ce,Re)|0;var hn=(ee+Q|0)+((G&8191)<<13)|0;ee=(K+(G>>>13)|0)+(hn>>>26)|0,hn&=67108863,Q=Math.imul(X,le),G=Math.imul(X,be),G=G+Math.imul(xe,le)|0,K=Math.imul(xe,be),Q=Q+Math.imul(B,Se)|0,G=G+Math.imul(B,Ge)|0,G=G+Math.imul(S,Se)|0,K=K+Math.imul(S,Ge)|0,Q=Q+Math.imul(ie,dt)|0,G=G+Math.imul(ie,Re)|0,G=G+Math.imul(V,dt)|0,K=K+Math.imul(V,Re)|0;var rn=(ee+Q|0)+((G&8191)<<13)|0;ee=(K+(G>>>13)|0)+(rn>>>26)|0,rn&=67108863,Q=Math.imul(X,Se),G=Math.imul(X,Ge),G=G+Math.imul(xe,Se)|0,K=Math.imul(xe,Ge),Q=Q+Math.imul(B,dt)|0,G=G+Math.imul(B,Re)|0,G=G+Math.imul(S,dt)|0,K=K+Math.imul(S,Re)|0;var Rt=(ee+Q|0)+((G&8191)<<13)|0;ee=(K+(G>>>13)|0)+(Rt>>>26)|0,Rt&=67108863,Q=Math.imul(X,dt),G=Math.imul(X,Re),G=G+Math.imul(xe,dt)|0,K=Math.imul(xe,Re);var yt=(ee+Q|0)+((G&8191)<<13)|0;return ee=(K+(G>>>13)|0)+(yt>>>26)|0,yt&=67108863,$[0]=Ue,$[1]=Xe,$[2]=ft,$[3]=it,$[4]=xt,$[5]=Dt,$[6]=Kt,$[7]=Wt,$[8]=bt,$[9]=jt,$[10]=on,$[11]=$t,$[12]=vn,$[13]=Jt,$[14]=nn,$[15]=hn,$[16]=rn,$[17]=Rt,$[18]=yt,ee!==0&&($[19]=ee,M.length++),M};Math.imul||(x=_);function b(te,N,L){L.negative=N.negative^te.negative,L.length=te.length+N.length;for(var M=0,I=0,U=0;U<L.length-1;U++){var $=I;I=0;for(var ee=M&67108863,Q=Math.min(U,N.length-1),G=Math.max(0,U-te.length+1);G<=Q;G++){var K=U-G,Y=te.words[K]|0,we=N.words[G]|0,Ke=Y*we,ge=Ke&67108863;$=$+(Ke/67108864|0)|0,ge=ge+ee|0,ee=ge&67108863,$=$+(ge>>>26)|0,I+=$>>>26,$&=67108863}L.words[U]=ee,M=$,$=I}return M!==0?L.words[U]=M:L.length--,L.strip()}function E(te,N,L){var M=new T;return M.mulp(te,N,L)}s.prototype.mulTo=function(N,L){var M,I=this.length+N.length;return this.length===10&&N.length===10?M=x(this,N,L):I<63?M=_(this,N,L):I<1024?M=b(this,N,L):M=E(this,N,L),M};function T(te,N){this.x=te,this.y=N}T.prototype.makeRBT=function(N){for(var L=new Array(N),M=s.prototype._countBits(N)-1,I=0;I<N;I++)L[I]=this.revBin(I,M,N);return L},T.prototype.revBin=function(N,L,M){if(N===0||N===M-1)return N;for(var I=0,U=0;U<L;U++)I|=(N&1)<<L-U-1,N>>=1;return I},T.prototype.permute=function(N,L,M,I,U,$){for(var ee=0;ee<$;ee++)I[ee]=L[N[ee]],U[ee]=M[N[ee]]},T.prototype.transform=function(N,L,M,I,U,$){this.permute($,N,L,M,I,U);for(var ee=1;ee<U;ee<<=1)for(var Q=ee<<1,G=Math.cos(2*Math.PI/Q),K=Math.sin(2*Math.PI/Q),Y=0;Y<U;Y+=Q)for(var we=G,Ke=K,ge=0;ge<ee;ge++){var me=M[Y+ge],De=I[Y+ge],ze=M[Y+ge+ee],tt=I[Y+ge+ee],rt=we*ze-Ke*tt;tt=we*tt+Ke*ze,ze=rt,M[Y+ge]=me+ze,I[Y+ge]=De+tt,M[Y+ge+ee]=me-ze,I[Y+ge+ee]=De-tt,ge!==Q&&(rt=G*we-K*Ke,Ke=G*Ke+K*we,we=rt)}},T.prototype.guessLen13b=function(N,L){var M=Math.max(L,N)|1,I=M&1,U=0;for(M=M/2|0;M;M=M>>>1)U++;return 1<<U+1+I},T.prototype.conjugate=function(N,L,M){if(!(M<=1))for(var I=0;I<M/2;I++){var U=N[I];N[I]=N[M-I-1],N[M-I-1]=U,U=L[I],L[I]=-L[M-I-1],L[M-I-1]=-U}},T.prototype.normalize13b=function(N,L){for(var M=0,I=0;I<L/2;I++){var U=Math.round(N[2*I+1]/L)*8192+Math.round(N[2*I]/L)+M;N[I]=U&67108863,U<67108864?M=0:M=U/67108864|0}return N},T.prototype.convert13b=function(N,L,M,I){for(var U=0,$=0;$<L;$++)U=U+(N[$]|0),M[2*$]=U&8191,U=U>>>13,M[2*$+1]=U&8191,U=U>>>13;for($=2*L;$<I;++$)M[$]=0;i(U===0),i((U&-8192)===0)},T.prototype.stub=function(N){for(var L=new Array(N),M=0;M<N;M++)L[M]=0;return L},T.prototype.mulp=function(N,L,M){var I=2*this.guessLen13b(N.length,L.length),U=this.makeRBT(I),$=this.stub(I),ee=new Array(I),Q=new Array(I),G=new Array(I),K=new Array(I),Y=new Array(I),we=new Array(I),Ke=M.words;Ke.length=I,this.convert13b(N.words,N.length,ee,I),this.convert13b(L.words,L.length,K,I),this.transform(ee,$,Q,G,I,U),this.transform(K,$,Y,we,I,U);for(var ge=0;ge<I;ge++){var me=Q[ge]*Y[ge]-G[ge]*we[ge];G[ge]=Q[ge]*we[ge]+G[ge]*Y[ge],Q[ge]=me}return this.conjugate(Q,G,I),this.transform(Q,G,Ke,$,I,U),this.conjugate(Ke,$,I),this.normalize13b(Ke,I),M.negative=N.negative^L.negative,M.length=N.length+L.length,M.strip()},s.prototype.mul=function(N){var L=new s(null);return L.words=new Array(this.length+N.length),this.mulTo(N,L)},s.prototype.mulf=function(N){var L=new s(null);return L.words=new Array(this.length+N.length),E(this,N,L)},s.prototype.imul=function(N){return this.clone().mulTo(N,this)},s.prototype.imuln=function(N){i(typeof N=="number"),i(N<67108864);for(var L=0,M=0;M<this.length;M++){var I=(this.words[M]|0)*N,U=(I&67108863)+(L&67108863);L>>=26,L+=I/67108864|0,L+=U>>>26,this.words[M]=U&67108863}return L!==0&&(this.words[M]=L,this.length++),this},s.prototype.muln=function(N){return this.clone().imuln(N)},s.prototype.sqr=function(){return this.mul(this)},s.prototype.isqr=function(){return this.imul(this.clone())},s.prototype.pow=function(N){var L=g(N);if(L.length===0)return new s(1);for(var M=this,I=0;I<L.length&&L[I]===0;I++,M=M.sqr());if(++I<L.length)for(var U=M.sqr();I<L.length;I++,U=U.sqr())L[I]!==0&&(M=M.mul(U));return M},s.prototype.iushln=function(N){i(typeof N=="number"&&N>=0);var L=N%26,M=(N-L)/26,I=67108863>>>26-L<<26-L,U;if(L!==0){var $=0;for(U=0;U<this.length;U++){var ee=this.words[U]&I,Q=(this.words[U]|0)-ee<<L;this.words[U]=Q|$,$=ee>>>26-L}$&&(this.words[U]=$,this.length++)}if(M!==0){for(U=this.length-1;U>=0;U--)this.words[U+M]=this.words[U];for(U=0;U<M;U++)this.words[U]=0;this.length+=M}return this.strip()},s.prototype.ishln=function(N){return i(this.negative===0),this.iushln(N)},s.prototype.iushrn=function(N,L,M){i(typeof N=="number"&&N>=0);var I;L?I=(L-L%26)/26:I=0;var U=N%26,$=Math.min((N-U)/26,this.length),ee=67108863^67108863>>>U<<U,Q=M;if(I-=$,I=Math.max(0,I),Q){for(var G=0;G<$;G++)Q.words[G]=this.words[G];Q.length=$}if($!==0)if(this.length>$)for(this.length-=$,G=0;G<this.length;G++)this.words[G]=this.words[G+$];else this.words[0]=0,this.length=1;var K=0;for(G=this.length-1;G>=0&&(K!==0||G>=I);G--){var Y=this.words[G]|0;this.words[G]=K<<26-U|Y>>>U,K=Y&ee}return Q&&K!==0&&(Q.words[Q.length++]=K),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},s.prototype.ishrn=function(N,L,M){return i(this.negative===0),this.iushrn(N,L,M)},s.prototype.shln=function(N){return this.clone().ishln(N)},s.prototype.ushln=function(N){return this.clone().iushln(N)},s.prototype.shrn=function(N){return this.clone().ishrn(N)},s.prototype.ushrn=function(N){return this.clone().iushrn(N)},s.prototype.testn=function(N){i(typeof N=="number"&&N>=0);var L=N%26,M=(N-L)/26,I=1<<L;if(this.length<=M)return!1;var U=this.words[M];return!!(U&I)},s.prototype.imaskn=function(N){i(typeof N=="number"&&N>=0);var L=N%26,M=(N-L)/26;if(i(this.negative===0,"imaskn works only with positive numbers"),this.length<=M)return this;if(L!==0&&M++,this.length=Math.min(M,this.length),L!==0){var I=67108863^67108863>>>L<<L;this.words[this.length-1]&=I}return this.strip()},s.prototype.maskn=function(N){return this.clone().imaskn(N)},s.prototype.iaddn=function(N){return i(typeof N=="number"),i(N<67108864),N<0?this.isubn(-N):this.negative!==0?this.length===1&&(this.words[0]|0)<N?(this.words[0]=N-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(N),this.negative=1,this):this._iaddn(N)},s.prototype._iaddn=function(N){this.words[0]+=N;for(var L=0;L<this.length&&this.words[L]>=67108864;L++)this.words[L]-=67108864,L===this.length-1?this.words[L+1]=1:this.words[L+1]++;return this.length=Math.max(this.length,L+1),this},s.prototype.isubn=function(N){if(i(typeof N=="number"),i(N<67108864),N<0)return this.iaddn(-N);if(this.negative!==0)return this.negative=0,this.iaddn(N),this.negative=1,this;if(this.words[0]-=N,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var L=0;L<this.length&&this.words[L]<0;L++)this.words[L]+=67108864,this.words[L+1]-=1;return this.strip()},s.prototype.addn=function(N){return this.clone().iaddn(N)},s.prototype.subn=function(N){return this.clone().isubn(N)},s.prototype.iabs=function(){return this.negative=0,this},s.prototype.abs=function(){return this.clone().iabs()},s.prototype._ishlnsubmul=function(N,L,M){var I=N.length+M,U;this._expand(I);var $,ee=0;for(U=0;U<N.length;U++){$=(this.words[U+M]|0)+ee;var Q=(N.words[U]|0)*L;$-=Q&67108863,ee=($>>26)-(Q/67108864|0),this.words[U+M]=$&67108863}for(;U<this.length-M;U++)$=(this.words[U+M]|0)+ee,ee=$>>26,this.words[U+M]=$&67108863;if(ee===0)return this.strip();for(i(ee===-1),ee=0,U=0;U<this.length;U++)$=-(this.words[U]|0)+ee,ee=$>>26,this.words[U]=$&67108863;return this.negative=1,this.strip()},s.prototype._wordDiv=function(N,L){var M=this.length-N.length,I=this.clone(),U=N,$=U.words[U.length-1]|0,ee=this._countBits($);M=26-ee,M!==0&&(U=U.ushln(M),I.iushln(M),$=U.words[U.length-1]|0);var Q=I.length-U.length,G;if(L!=="mod"){G=new s(null),G.length=Q+1,G.words=new Array(G.length);for(var K=0;K<G.length;K++)G.words[K]=0}var Y=I.clone()._ishlnsubmul(U,1,Q);Y.negative===0&&(I=Y,G&&(G.words[Q]=1));for(var we=Q-1;we>=0;we--){var Ke=(I.words[U.length+we]|0)*67108864+(I.words[U.length+we-1]|0);for(Ke=Math.min(Ke/$|0,67108863),I._ishlnsubmul(U,Ke,we);I.negative!==0;)Ke--,I.negative=0,I._ishlnsubmul(U,1,we),I.isZero()||(I.negative^=1);G&&(G.words[we]=Ke)}return G&&G.strip(),I.strip(),L!=="div"&&M!==0&&I.iushrn(M),{div:G||null,mod:I}},s.prototype.divmod=function(N,L,M){if(i(!N.isZero()),this.isZero())return{div:new s(0),mod:new s(0)};var I,U,$;return this.negative!==0&&N.negative===0?($=this.neg().divmod(N,L),L!=="mod"&&(I=$.div.neg()),L!=="div"&&(U=$.mod.neg(),M&&U.negative!==0&&U.iadd(N)),{div:I,mod:U}):this.negative===0&&N.negative!==0?($=this.divmod(N.neg(),L),L!=="mod"&&(I=$.div.neg()),{div:I,mod:$.mod}):(this.negative&N.negative)!==0?($=this.neg().divmod(N.neg(),L),L!=="div"&&(U=$.mod.neg(),M&&U.negative!==0&&U.isub(N)),{div:$.div,mod:U}):N.length>this.length||this.cmp(N)<0?{div:new s(0),mod:this}:N.length===1?L==="div"?{div:this.divn(N.words[0]),mod:null}:L==="mod"?{div:null,mod:new s(this.modn(N.words[0]))}:{div:this.divn(N.words[0]),mod:new s(this.modn(N.words[0]))}:this._wordDiv(N,L)},s.prototype.div=function(N){return this.divmod(N,"div",!1).div},s.prototype.mod=function(N){return this.divmod(N,"mod",!1).mod},s.prototype.umod=function(N){return this.divmod(N,"mod",!0).mod},s.prototype.divRound=function(N){var L=this.divmod(N);if(L.mod.isZero())return L.div;var M=L.div.negative!==0?L.mod.isub(N):L.mod,I=N.ushrn(1),U=N.andln(1),$=M.cmp(I);return $<0||U===1&&$===0?L.div:L.div.negative!==0?L.div.isubn(1):L.div.iaddn(1)},s.prototype.modn=function(N){i(N<=67108863);for(var L=(1<<26)%N,M=0,I=this.length-1;I>=0;I--)M=(L*M+(this.words[I]|0))%N;return M},s.prototype.idivn=function(N){i(N<=67108863);for(var L=0,M=this.length-1;M>=0;M--){var I=(this.words[M]|0)+L*67108864;this.words[M]=I/N|0,L=I%N}return this.strip()},s.prototype.divn=function(N){return this.clone().idivn(N)},s.prototype.egcd=function(N){i(N.negative===0),i(!N.isZero());var L=this,M=N.clone();L.negative!==0?L=L.umod(N):L=L.clone();for(var I=new s(1),U=new s(0),$=new s(0),ee=new s(1),Q=0;L.isEven()&&M.isEven();)L.iushrn(1),M.iushrn(1),++Q;for(var G=M.clone(),K=L.clone();!L.isZero();){for(var Y=0,we=1;(L.words[0]&we)===0&&Y<26;++Y,we<<=1);if(Y>0)for(L.iushrn(Y);Y-- >0;)(I.isOdd()||U.isOdd())&&(I.iadd(G),U.isub(K)),I.iushrn(1),U.iushrn(1);for(var Ke=0,ge=1;(M.words[0]&ge)===0&&Ke<26;++Ke,ge<<=1);if(Ke>0)for(M.iushrn(Ke);Ke-- >0;)($.isOdd()||ee.isOdd())&&($.iadd(G),ee.isub(K)),$.iushrn(1),ee.iushrn(1);L.cmp(M)>=0?(L.isub(M),I.isub($),U.isub(ee)):(M.isub(L),$.isub(I),ee.isub(U))}return{a:$,b:ee,gcd:M.iushln(Q)}},s.prototype._invmp=function(N){i(N.negative===0),i(!N.isZero());var L=this,M=N.clone();L.negative!==0?L=L.umod(N):L=L.clone();for(var I=new s(1),U=new s(0),$=M.clone();L.cmpn(1)>0&&M.cmpn(1)>0;){for(var ee=0,Q=1;(L.words[0]&Q)===0&&ee<26;++ee,Q<<=1);if(ee>0)for(L.iushrn(ee);ee-- >0;)I.isOdd()&&I.iadd($),I.iushrn(1);for(var G=0,K=1;(M.words[0]&K)===0&&G<26;++G,K<<=1);if(G>0)for(M.iushrn(G);G-- >0;)U.isOdd()&&U.iadd($),U.iushrn(1);L.cmp(M)>=0?(L.isub(M),I.isub(U)):(M.isub(L),U.isub(I))}var Y;return L.cmpn(1)===0?Y=I:Y=U,Y.cmpn(0)<0&&Y.iadd(N),Y},s.prototype.gcd=function(N){if(this.isZero())return N.abs();if(N.isZero())return this.abs();var L=this.clone(),M=N.clone();L.negative=0,M.negative=0;for(var I=0;L.isEven()&&M.isEven();I++)L.iushrn(1),M.iushrn(1);do{for(;L.isEven();)L.iushrn(1);for(;M.isEven();)M.iushrn(1);var U=L.cmp(M);if(U<0){var $=L;L=M,M=$}else if(U===0||M.cmpn(1)===0)break;L.isub(M)}while(!0);return M.iushln(I)},s.prototype.invm=function(N){return this.egcd(N).a.umod(N)},s.prototype.isEven=function(){return(this.words[0]&1)===0},s.prototype.isOdd=function(){return(this.words[0]&1)===1},s.prototype.andln=function(N){return this.words[0]&N},s.prototype.bincn=function(N){i(typeof N=="number");var L=N%26,M=(N-L)/26,I=1<<L;if(this.length<=M)return this._expand(M+1),this.words[M]|=I,this;for(var U=I,$=M;U!==0&&$<this.length;$++){var ee=this.words[$]|0;ee+=U,U=ee>>>26,ee&=67108863,this.words[$]=ee}return U!==0&&(this.words[$]=U,this.length++),this},s.prototype.isZero=function(){return this.length===1&&this.words[0]===0},s.prototype.cmpn=function(N){var L=N<0;if(this.negative!==0&&!L)return-1;if(this.negative===0&&L)return 1;this.strip();var M;if(this.length>1)M=1;else{L&&(N=-N),i(N<=67108863,"Number is too big");var I=this.words[0]|0;M=I===N?0:I<N?-1:1}return this.negative!==0?-M|0:M},s.prototype.cmp=function(N){if(this.negative!==0&&N.negative===0)return-1;if(this.negative===0&&N.negative!==0)return 1;var L=this.ucmp(N);return this.negative!==0?-L|0:L},s.prototype.ucmp=function(N){if(this.length>N.length)return 1;if(this.length<N.length)return-1;for(var L=0,M=this.length-1;M>=0;M--){var I=this.words[M]|0,U=N.words[M]|0;if(I!==U){I<U?L=-1:I>U&&(L=1);break}}return L},s.prototype.gtn=function(N){return this.cmpn(N)===1},s.prototype.gt=function(N){return this.cmp(N)===1},s.prototype.gten=function(N){return this.cmpn(N)>=0},s.prototype.gte=function(N){return this.cmp(N)>=0},s.prototype.ltn=function(N){return this.cmpn(N)===-1},s.prototype.lt=function(N){return this.cmp(N)===-1},s.prototype.lten=function(N){return this.cmpn(N)<=0},s.prototype.lte=function(N){return this.cmp(N)<=0},s.prototype.eqn=function(N){return this.cmpn(N)===0},s.prototype.eq=function(N){return this.cmp(N)===0},s.red=function(N){return new J(N)},s.prototype.toRed=function(N){return i(!this.red,"Already a number in reduction context"),i(this.negative===0,"red works only with positives"),N.convertTo(this)._forceRed(N)},s.prototype.fromRed=function(){return i(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},s.prototype._forceRed=function(N){return this.red=N,this},s.prototype.forceRed=function(N){return i(!this.red,"Already a number in reduction context"),this._forceRed(N)},s.prototype.redAdd=function(N){return i(this.red,"redAdd works only with red numbers"),this.red.add(this,N)},s.prototype.redIAdd=function(N){return i(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,N)},s.prototype.redSub=function(N){return i(this.red,"redSub works only with red numbers"),this.red.sub(this,N)},s.prototype.redISub=function(N){return i(this.red,"redISub works only with red numbers"),this.red.isub(this,N)},s.prototype.redShl=function(N){return i(this.red,"redShl works only with red numbers"),this.red.shl(this,N)},s.prototype.redMul=function(N){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,N),this.red.mul(this,N)},s.prototype.redIMul=function(N){return i(this.red,"redMul works only with red numbers"),this.red._verify2(this,N),this.red.imul(this,N)},s.prototype.redSqr=function(){return i(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},s.prototype.redISqr=function(){return i(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},s.prototype.redSqrt=function(){return i(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},s.prototype.redInvm=function(){return i(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},s.prototype.redNeg=function(){return i(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},s.prototype.redPow=function(N){return i(this.red&&!N.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,N)};var P={k256:null,p224:null,p192:null,p25519:null};function D(te,N){this.name=te,this.p=new s(N,16),this.n=this.p.bitLength(),this.k=new s(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}D.prototype._tmp=function(){var N=new s(null);return N.words=new Array(Math.ceil(this.n/13)),N},D.prototype.ireduce=function(N){var L=N,M;do this.split(L,this.tmp),L=this.imulK(L),L=L.iadd(this.tmp),M=L.bitLength();while(M>this.n);var I=M<this.n?-1:L.ucmp(this.p);return I===0?(L.words[0]=0,L.length=1):I>0?L.isub(this.p):L.strip!==void 0?L.strip():L._strip(),L},D.prototype.split=function(N,L){N.iushrn(this.n,0,L)},D.prototype.imulK=function(N){return N.imul(this.k)};function F(){D.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}o(F,D),F.prototype.split=function(N,L){for(var M=4194303,I=Math.min(N.length,9),U=0;U<I;U++)L.words[U]=N.words[U];if(L.length=I,N.length<=9){N.words[0]=0,N.length=1;return}var $=N.words[9];for(L.words[L.length++]=$&M,U=10;U<N.length;U++){var ee=N.words[U]|0;N.words[U-10]=(ee&M)<<4|$>>>22,$=ee}$>>>=22,N.words[U-10]=$,$===0&&N.length>10?N.length-=10:N.length-=9},F.prototype.imulK=function(N){N.words[N.length]=0,N.words[N.length+1]=0,N.length+=2;for(var L=0,M=0;M<N.length;M++){var I=N.words[M]|0;L+=I*977,N.words[M]=L&67108863,L=I*64+(L/67108864|0)}return N.words[N.length-1]===0&&(N.length--,N.words[N.length-1]===0&&N.length--),N};function k(){D.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}o(k,D);function W(){D.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}o(W,D);function j(){D.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}o(j,D),j.prototype.imulK=function(N){for(var L=0,M=0;M<N.length;M++){var I=(N.words[M]|0)*19+L,U=I&67108863;I>>>=26,N.words[M]=U,L=I}return L!==0&&(N.words[N.length++]=L),N},s._prime=function(N){if(P[N])return P[N];var L;if(N==="k256")L=new F;else if(N==="p224")L=new k;else if(N==="p192")L=new W;else if(N==="p25519")L=new j;else throw new Error("Unknown prime "+N);return P[N]=L,L};function J(te){if(typeof te=="string"){var N=s._prime(te);this.m=N.p,this.prime=N}else i(te.gtn(1),"modulus must be greater than 1"),this.m=te,this.prime=null}J.prototype._verify1=function(N){i(N.negative===0,"red works only with positives"),i(N.red,"red works only with red numbers")},J.prototype._verify2=function(N,L){i((N.negative|L.negative)===0,"red works only with positives"),i(N.red&&N.red===L.red,"red works only with red numbers")},J.prototype.imod=function(N){return this.prime?this.prime.ireduce(N)._forceRed(this):N.umod(this.m)._forceRed(this)},J.prototype.neg=function(N){return N.isZero()?N.clone():this.m.sub(N)._forceRed(this)},J.prototype.add=function(N,L){this._verify2(N,L);var M=N.add(L);return M.cmp(this.m)>=0&&M.isub(this.m),M._forceRed(this)},J.prototype.iadd=function(N,L){this._verify2(N,L);var M=N.iadd(L);return M.cmp(this.m)>=0&&M.isub(this.m),M},J.prototype.sub=function(N,L){this._verify2(N,L);var M=N.sub(L);return M.cmpn(0)<0&&M.iadd(this.m),M._forceRed(this)},J.prototype.isub=function(N,L){this._verify2(N,L);var M=N.isub(L);return M.cmpn(0)<0&&M.iadd(this.m),M},J.prototype.shl=function(N,L){return this._verify1(N),this.imod(N.ushln(L))},J.prototype.imul=function(N,L){return this._verify2(N,L),this.imod(N.imul(L))},J.prototype.mul=function(N,L){return this._verify2(N,L),this.imod(N.mul(L))},J.prototype.isqr=function(N){return this.imul(N,N.clone())},J.prototype.sqr=function(N){return this.mul(N,N)},J.prototype.sqrt=function(N){if(N.isZero())return N.clone();var L=this.m.andln(3);if(i(L%2===1),L===3){var M=this.m.add(new s(1)).iushrn(2);return this.pow(N,M)}for(var I=this.m.subn(1),U=0;!I.isZero()&&I.andln(1)===0;)U++,I.iushrn(1);i(!I.isZero());var $=new s(1).toRed(this),ee=$.redNeg(),Q=this.m.subn(1).iushrn(1),G=this.m.bitLength();for(G=new s(2*G*G).toRed(this);this.pow(G,Q).cmp(ee)!==0;)G.redIAdd(ee);for(var K=this.pow(G,I),Y=this.pow(N,I.addn(1).iushrn(1)),we=this.pow(N,I),Ke=U;we.cmp($)!==0;){for(var ge=we,me=0;ge.cmp($)!==0;me++)ge=ge.redSqr();i(me<Ke);var De=this.pow(K,new s(1).iushln(Ke-me-1));Y=Y.redMul(De),K=De.redSqr(),we=we.redMul(K),Ke=me}return Y},J.prototype.invm=function(N){var L=N._invmp(this.m);return L.negative!==0?(L.negative=0,this.imod(L).redNeg()):this.imod(L)},J.prototype.pow=function(N,L){if(L.isZero())return new s(1).toRed(this);if(L.cmpn(1)===0)return N.clone();var M=4,I=new Array(1<<M);I[0]=new s(1).toRed(this),I[1]=N;for(var U=2;U<I.length;U++)I[U]=this.mul(I[U-1],N);var $=I[0],ee=0,Q=0,G=L.bitLength()%26;for(G===0&&(G=26),U=L.length-1;U>=0;U--){for(var K=L.words[U],Y=G-1;Y>=0;Y--){var we=K>>Y&1;if($!==I[0]&&($=this.sqr($)),we===0&&ee===0){Q=0;continue}ee<<=1,ee|=we,Q++,!(Q!==M&&(U!==0||Y!==0))&&($=this.mul($,I[ee]),Q=0,ee=0)}G=26}return $},J.prototype.convertTo=function(N){var L=N.umod(this.m);return L===N?L.clone():L},J.prototype.convertFrom=function(N){var L=N.clone();return L.red=null,L},s.mont=function(N){return new de(N)};function de(te){J.call(this,te),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new s(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}o(de,J),de.prototype.convertTo=function(N){return this.imod(N.ushln(this.shift))},de.prototype.convertFrom=function(N){var L=this.imod(N.mul(this.rinv));return L.red=null,L},de.prototype.imul=function(N,L){if(N.isZero()||L.isZero())return N.words[0]=0,N.length=1,N;var M=N.imul(L),I=M.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),U=M.isub(I).iushrn(this.shift),$=U;return U.cmp(this.m)>=0?$=U.isub(this.m):U.cmpn(0)<0&&($=U.iadd(this.m)),$._forceRed(this)},de.prototype.mul=function(N,L){if(N.isZero()||L.isZero())return new s(0)._forceRed(this);var M=N.mul(L),I=M.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),U=M.isub(I).iushrn(this.shift),$=U;return U.cmp(this.m)>=0?$=U.isub(this.m):U.cmpn(0)<0&&($=U.iadd(this.m)),$._forceRed(this)},de.prototype.invm=function(N){var L=this.imod(N._invmp(this.m).mul(this.r2));return L._forceRed(this)}})(a,Tr)})(al);var Ph=gP;function gP(a,t){if(!a)throw new Error(t||"Assertion failed")}gP.equal=function(t,n,i){if(t!=n)throw new Error(i||"Assertion failed: "+t+" != "+n)};var vw={};(function(a){var t=a;function n(s,c){if(Array.isArray(s))return s.slice();if(!s)return[];var u=[];if(typeof s!="string"){for(var h=0;h<s.length;h++)u[h]=s[h]|0;return u}if(c==="hex"){s=s.replace(/[^a-z0-9]+/ig,""),s.length%2!==0&&(s="0"+s);for(var h=0;h<s.length;h+=2)u.push(parseInt(s[h]+s[h+1],16))}else for(var h=0;h<s.length;h++){var f=s.charCodeAt(h),p=f>>8,m=f&255;p?u.push(p,m):u.push(m)}return u}t.toArray=n;function i(s){return s.length===1?"0"+s:s}t.zero2=i;function o(s){for(var c="",u=0;u<s.length;u++)c+=i(s[u].toString(16));return c}t.toHex=o,t.encode=function(c,u){return u==="hex"?o(c):c}})(vw);(function(a){var t=a,n=al.exports,i=Ph,o=vw;t.assert=i,t.toArray=o.toArray,t.zero2=o.zero2,t.toHex=o.toHex,t.encode=o.encode;function s(p,m,y){var g=new Array(Math.max(p.bitLength(),y)+1);g.fill(0);for(var _=1<<m+1,x=p.clone(),b=0;b<g.length;b++){var E,T=x.andln(_-1);x.isOdd()?(T>(_>>1)-1?E=(_>>1)-T:E=T,x.isubn(E)):E=0,g[b]=E,x.iushrn(1)}return g}t.getNAF=s;function c(p,m){var y=[[],[]];p=p.clone(),m=m.clone();for(var g=0,_=0,x;p.cmpn(-g)>0||m.cmpn(-_)>0;){var b=p.andln(3)+g&3,E=m.andln(3)+_&3;b===3&&(b=-1),E===3&&(E=-1);var T;(b&1)===0?T=0:(x=p.andln(7)+g&7,(x===3||x===5)&&E===2?T=-b:T=b),y[0].push(T);var P;(E&1)===0?P=0:(x=m.andln(7)+_&7,(x===3||x===5)&&b===2?P=-E:P=E),y[1].push(P),2*g===T+1&&(g=1-g),2*_===P+1&&(_=1-_),p.iushrn(1),m.iushrn(1)}return y}t.getJSF=c;function u(p,m,y){var g="_"+m;p.prototype[m]=function(){return this[g]!==void 0?this[g]:this[g]=y.call(this)}}t.cachedProperty=u;function h(p){return typeof p=="string"?t.toArray(p,"hex"):p}t.parseBytes=h;function f(p){return new n(p,"hex","le")}t.intFromLE=f})(Oo);var Wy={exports:{}},LA;Wy.exports=function(t){return LA||(LA=new Pc(null)),LA.generate(t)};function Pc(a){this.rand=a}Wy.exports.Rand=Pc;Pc.prototype.generate=function(t){return this._rand(t)};Pc.prototype._rand=function(t){if(this.rand.getBytes)return this.rand.getBytes(t);for(var n=new Uint8Array(t),i=0;i<n.length;i++)n[i]=this.rand.getByte();return n};if(typeof self=="object")self.crypto&&self.crypto.getRandomValues?Pc.prototype._rand=function(t){var n=new Uint8Array(t);return self.crypto.getRandomValues(n),n}:self.msCrypto&&self.msCrypto.getRandomValues?Pc.prototype._rand=function(t){var n=new Uint8Array(t);return self.msCrypto.getRandomValues(n),n}:typeof window=="object"&&(Pc.prototype._rand=function(){throw new Error("Not implemented yet")});else try{var H3=require("crypto");if(typeof H3.randomBytes!="function")throw new Error("Not supported");Pc.prototype._rand=function(t){return H3.randomBytes(t)}}catch{}var yw={},Hu=al.exports,Wm=Oo,jv=Wm.getNAF,s$=Wm.getJSF,Xv=Wm.assert;function Kc(a,t){this.type=a,this.p=new Hu(t.p,16),this.red=t.prime?Hu.red(t.prime):Hu.mont(this.p),this.zero=new Hu(0).toRed(this.red),this.one=new Hu(1).toRed(this.red),this.two=new Hu(2).toRed(this.red),this.n=t.n&&new Hu(t.n,16),this.g=t.g&&this.pointFromJSON(t.g,t.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var n=this.n&&this.p.div(this.n);!n||n.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}var jy=Kc;Kc.prototype.point=function(){throw new Error("Not implemented")};Kc.prototype.validate=function(){throw new Error("Not implemented")};Kc.prototype._fixedNafMul=function(t,n){Xv(t.precomputed);var i=t._getDoubles(),o=jv(n,1,this._bitLength),s=(1<<i.step+1)-(i.step%2===0?2:1);s/=3;var c=[],u,h;for(u=0;u<o.length;u+=i.step){h=0;for(var f=u+i.step-1;f>=u;f--)h=(h<<1)+o[f];c.push(h)}for(var p=this.jpoint(null,null,null),m=this.jpoint(null,null,null),y=s;y>0;y--){for(u=0;u<c.length;u++)h=c[u],h===y?m=m.mixedAdd(i.points[u]):h===-y&&(m=m.mixedAdd(i.points[u].neg()));p=p.add(m)}return p.toP()};Kc.prototype._wnafMul=function(t,n){var i=4,o=t._getNAFPoints(i);i=o.wnd;for(var s=o.points,c=jv(n,i,this._bitLength),u=this.jpoint(null,null,null),h=c.length-1;h>=0;h--){for(var f=0;h>=0&&c[h]===0;h--)f++;if(h>=0&&f++,u=u.dblp(f),h<0)break;var p=c[h];Xv(p!==0),t.type==="affine"?p>0?u=u.mixedAdd(s[p-1>>1]):u=u.mixedAdd(s[-p-1>>1].neg()):p>0?u=u.add(s[p-1>>1]):u=u.add(s[-p-1>>1].neg())}return t.type==="affine"?u.toP():u};Kc.prototype._wnafMulAdd=function(t,n,i,o,s){var c=this._wnafT1,u=this._wnafT2,h=this._wnafT3,f=0,p,m,y;for(p=0;p<o;p++){y=n[p];var g=y._getNAFPoints(t);c[p]=g.wnd,u[p]=g.points}for(p=o-1;p>=1;p-=2){var _=p-1,x=p;if(c[_]!==1||c[x]!==1){h[_]=jv(i[_],c[_],this._bitLength),h[x]=jv(i[x],c[x],this._bitLength),f=Math.max(h[_].length,f),f=Math.max(h[x].length,f);continue}var b=[n[_],null,null,n[x]];n[_].y.cmp(n[x].y)===0?(b[1]=n[_].add(n[x]),b[2]=n[_].toJ().mixedAdd(n[x].neg())):n[_].y.cmp(n[x].y.redNeg())===0?(b[1]=n[_].toJ().mixedAdd(n[x]),b[2]=n[_].add(n[x].neg())):(b[1]=n[_].toJ().mixedAdd(n[x]),b[2]=n[_].toJ().mixedAdd(n[x].neg()));var E=[-3,-1,-5,-7,0,7,5,1,3],T=s$(i[_],i[x]);for(f=Math.max(T[0].length,f),h[_]=new Array(f),h[x]=new Array(f),m=0;m<f;m++){var P=T[0][m]|0,D=T[1][m]|0;h[_][m]=E[(P+1)*3+(D+1)],h[x][m]=0,u[_]=b}}var F=this.jpoint(null,null,null),k=this._wnafT4;for(p=f;p>=0;p--){for(var W=0;p>=0;){var j=!0;for(m=0;m<o;m++)k[m]=h[m][p]|0,k[m]!==0&&(j=!1);if(!j)break;W++,p--}if(p>=0&&W++,F=F.dblp(W),p<0)break;for(m=0;m<o;m++){var J=k[m];J!==0&&(J>0?y=u[m][J-1>>1]:J<0&&(y=u[m][-J-1>>1].neg()),y.type==="affine"?F=F.mixedAdd(y):F=F.add(y))}}for(p=0;p<o;p++)u[p]=null;return s?F:F.toP()};function jo(a,t){this.curve=a,this.type=t,this.precomputed=null}Kc.BasePoint=jo;jo.prototype.eq=function(){throw new Error("Not implemented")};jo.prototype.validate=function(){return this.curve.validate(this)};Kc.prototype.decodePoint=function(t,n){t=Wm.toArray(t,n);var i=this.p.byteLength();if((t[0]===4||t[0]===6||t[0]===7)&&t.length-1===2*i){t[0]===6?Xv(t[t.length-1]%2===0):t[0]===7&&Xv(t[t.length-1]%2===1);var o=this.point(t.slice(1,1+i),t.slice(1+i,1+2*i));return o}else if((t[0]===2||t[0]===3)&&t.length-1===i)return this.pointFromX(t.slice(1,1+i),t[0]===3);throw new Error("Unknown point format")};jo.prototype.encodeCompressed=function(t){return this.encode(t,!0)};jo.prototype._encode=function(t){var n=this.curve.p.byteLength(),i=this.getX().toArray("be",n);return t?[this.getY().isEven()?2:3].concat(i):[4].concat(i,this.getY().toArray("be",n))};jo.prototype.encode=function(t,n){return Wm.encode(this._encode(n),t)};jo.prototype.precompute=function(t){if(this.precomputed)return this;var n={doubles:null,naf:null,beta:null};return n.naf=this._getNAFPoints(8),n.doubles=this._getDoubles(4,t),n.beta=this._getBeta(),this.precomputed=n,this};jo.prototype._hasDoubles=function(t){if(!this.precomputed)return!1;var n=this.precomputed.doubles;return n?n.points.length>=Math.ceil((t.bitLength()+1)/n.step):!1};jo.prototype._getDoubles=function(t,n){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var i=[this],o=this,s=0;s<n;s+=t){for(var c=0;c<t;c++)o=o.dbl();i.push(o)}return{step:t,points:i}};jo.prototype._getNAFPoints=function(t){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var n=[this],i=(1<<t)-1,o=i===1?null:this.dbl(),s=1;s<i;s++)n[s]=n[s-1].add(o);return{wnd:t,points:n}};jo.prototype._getBeta=function(){return null};jo.prototype.dblp=function(t){for(var n=this,i=0;i<t;i++)n=n.dbl();return n};var Md={exports:{}};typeof Object.create=="function"?Md.exports=function(t,n){n&&(t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:Md.exports=function(t,n){if(n){t.super_=n;var i=function(){};i.prototype=n.prototype,t.prototype=new i,t.prototype.constructor=t}};var o$=Oo,Br=al.exports,xw=Md.exports,Vd=jy,a$=o$.assert;function Xo(a){Vd.call(this,"short",a),this.a=new Br(a.a,16).toRed(this.red),this.b=new Br(a.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(a),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}xw(Xo,Vd);var l$=Xo;Xo.prototype._getEndomorphism=function(t){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var n,i;if(t.beta)n=new Br(t.beta,16).toRed(this.red);else{var o=this._getEndoRoots(this.p);n=o[0].cmp(o[1])<0?o[0]:o[1],n=n.toRed(this.red)}if(t.lambda)i=new Br(t.lambda,16);else{var s=this._getEndoRoots(this.n);this.g.mul(s[0]).x.cmp(this.g.x.redMul(n))===0?i=s[0]:(i=s[1],a$(this.g.mul(i).x.cmp(this.g.x.redMul(n))===0))}var c;return t.basis?c=t.basis.map(function(u){return{a:new Br(u.a,16),b:new Br(u.b,16)}}):c=this._getEndoBasis(i),{beta:n,lambda:i,basis:c}}};Xo.prototype._getEndoRoots=function(t){var n=t===this.p?this.red:Br.mont(t),i=new Br(2).toRed(n).redInvm(),o=i.redNeg(),s=new Br(3).toRed(n).redNeg().redSqrt().redMul(i),c=o.redAdd(s).fromRed(),u=o.redSub(s).fromRed();return[c,u]};Xo.prototype._getEndoBasis=function(t){for(var n=this.n.ushrn(Math.floor(this.n.bitLength()/2)),i=t,o=this.n.clone(),s=new Br(1),c=new Br(0),u=new Br(0),h=new Br(1),f,p,m,y,g,_,x,b=0,E,T;i.cmpn(0)!==0;){var P=o.div(i);E=o.sub(P.mul(i)),T=u.sub(P.mul(s));var D=h.sub(P.mul(c));if(!m&&E.cmp(n)<0)f=x.neg(),p=s,m=E.neg(),y=T;else if(m&&++b===2)break;x=E,o=i,i=E,u=s,s=T,h=c,c=D}g=E.neg(),_=T;var F=m.sqr().add(y.sqr()),k=g.sqr().add(_.sqr());return k.cmp(F)>=0&&(g=f,_=p),m.negative&&(m=m.neg(),y=y.neg()),g.negative&&(g=g.neg(),_=_.neg()),[{a:m,b:y},{a:g,b:_}]};Xo.prototype._endoSplit=function(t){var n=this.endo.basis,i=n[0],o=n[1],s=o.b.mul(t).divRound(this.n),c=i.b.neg().mul(t).divRound(this.n),u=s.mul(i.a),h=c.mul(o.a),f=s.mul(i.b),p=c.mul(o.b),m=t.sub(u).sub(h),y=f.add(p).neg();return{k1:m,k2:y}};Xo.prototype.pointFromX=function(t,n){t=new Br(t,16),t.red||(t=t.toRed(this.red));var i=t.redSqr().redMul(t).redIAdd(t.redMul(this.a)).redIAdd(this.b),o=i.redSqrt();if(o.redSqr().redSub(i).cmp(this.zero)!==0)throw new Error("invalid point");var s=o.fromRed().isOdd();return(n&&!s||!n&&s)&&(o=o.redNeg()),this.point(t,o)};Xo.prototype.validate=function(t){if(t.inf)return!0;var n=t.x,i=t.y,o=this.a.redMul(n),s=n.redSqr().redMul(n).redIAdd(o).redIAdd(this.b);return i.redSqr().redISub(s).cmpn(0)===0};Xo.prototype._endoWnafMulAdd=function(t,n,i){for(var o=this._endoWnafT1,s=this._endoWnafT2,c=0;c<t.length;c++){var u=this._endoSplit(n[c]),h=t[c],f=h._getBeta();u.k1.negative&&(u.k1.ineg(),h=h.neg(!0)),u.k2.negative&&(u.k2.ineg(),f=f.neg(!0)),o[c*2]=h,o[c*2+1]=f,s[c*2]=u.k1,s[c*2+1]=u.k2}for(var p=this._wnafMulAdd(1,o,s,c*2,i),m=0;m<c*2;m++)o[m]=null,s[m]=null;return p};function gs(a,t,n,i){Vd.BasePoint.call(this,a,"affine"),t===null&&n===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new Br(t,16),this.y=new Br(n,16),i&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}xw(gs,Vd.BasePoint);Xo.prototype.point=function(t,n,i){return new gs(this,t,n,i)};Xo.prototype.pointFromJSON=function(t,n){return gs.fromJSON(this,t,n)};gs.prototype._getBeta=function(){if(!!this.curve.endo){var t=this.precomputed;if(t&&t.beta)return t.beta;var n=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(t){var i=this.curve,o=function(s){return i.point(s.x.redMul(i.endo.beta),s.y)};t.beta=n,n.precomputed={beta:null,naf:t.naf&&{wnd:t.naf.wnd,points:t.naf.points.map(o)},doubles:t.doubles&&{step:t.doubles.step,points:t.doubles.points.map(o)}}}return n}};gs.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};gs.fromJSON=function(t,n,i){typeof n=="string"&&(n=JSON.parse(n));var o=t.point(n[0],n[1],i);if(!n[2])return o;function s(u){return t.point(u[0],u[1],i)}var c=n[2];return o.precomputed={beta:null,doubles:c.doubles&&{step:c.doubles.step,points:[o].concat(c.doubles.points.map(s))},naf:c.naf&&{wnd:c.naf.wnd,points:[o].concat(c.naf.points.map(s))}},o};gs.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};gs.prototype.isInfinity=function(){return this.inf};gs.prototype.add=function(t){if(this.inf)return t;if(t.inf)return this;if(this.eq(t))return this.dbl();if(this.neg().eq(t))return this.curve.point(null,null);if(this.x.cmp(t.x)===0)return this.curve.point(null,null);var n=this.y.redSub(t.y);n.cmpn(0)!==0&&(n=n.redMul(this.x.redSub(t.x).redInvm()));var i=n.redSqr().redISub(this.x).redISub(t.x),o=n.redMul(this.x.redSub(i)).redISub(this.y);return this.curve.point(i,o)};gs.prototype.dbl=function(){if(this.inf)return this;var t=this.y.redAdd(this.y);if(t.cmpn(0)===0)return this.curve.point(null,null);var n=this.curve.a,i=this.x.redSqr(),o=t.redInvm(),s=i.redAdd(i).redIAdd(i).redIAdd(n).redMul(o),c=s.redSqr().redISub(this.x.redAdd(this.x)),u=s.redMul(this.x.redSub(c)).redISub(this.y);return this.curve.point(c,u)};gs.prototype.getX=function(){return this.x.fromRed()};gs.prototype.getY=function(){return this.y.fromRed()};gs.prototype.mul=function(t){return t=new Br(t,16),this.isInfinity()?this:this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve.endo?this.curve._endoWnafMulAdd([this],[t]):this.curve._wnafMul(this,t)};gs.prototype.mulAdd=function(t,n,i){var o=[this,n],s=[t,i];return this.curve.endo?this.curve._endoWnafMulAdd(o,s):this.curve._wnafMulAdd(1,o,s,2)};gs.prototype.jmulAdd=function(t,n,i){var o=[this,n],s=[t,i];return this.curve.endo?this.curve._endoWnafMulAdd(o,s,!0):this.curve._wnafMulAdd(1,o,s,2,!0)};gs.prototype.eq=function(t){return this===t||this.inf===t.inf&&(this.inf||this.x.cmp(t.x)===0&&this.y.cmp(t.y)===0)};gs.prototype.neg=function(t){if(this.inf)return this;var n=this.curve.point(this.x,this.y.redNeg());if(t&&this.precomputed){var i=this.precomputed,o=function(s){return s.neg()};n.precomputed={naf:i.naf&&{wnd:i.naf.wnd,points:i.naf.points.map(o)},doubles:i.doubles&&{step:i.doubles.step,points:i.doubles.points.map(o)}}}return n};gs.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var t=this.curve.jpoint(this.x,this.y,this.curve.one);return t};function Ts(a,t,n,i){Vd.BasePoint.call(this,a,"jacobian"),t===null&&n===null&&i===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new Br(0)):(this.x=new Br(t,16),this.y=new Br(n,16),this.z=new Br(i,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}xw(Ts,Vd.BasePoint);Xo.prototype.jpoint=function(t,n,i){return new Ts(this,t,n,i)};Ts.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var t=this.z.redInvm(),n=t.redSqr(),i=this.x.redMul(n),o=this.y.redMul(n).redMul(t);return this.curve.point(i,o)};Ts.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};Ts.prototype.add=function(t){if(this.isInfinity())return t;if(t.isInfinity())return this;var n=t.z.redSqr(),i=this.z.redSqr(),o=this.x.redMul(n),s=t.x.redMul(i),c=this.y.redMul(n.redMul(t.z)),u=t.y.redMul(i.redMul(this.z)),h=o.redSub(s),f=c.redSub(u);if(h.cmpn(0)===0)return f.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var p=h.redSqr(),m=p.redMul(h),y=o.redMul(p),g=f.redSqr().redIAdd(m).redISub(y).redISub(y),_=f.redMul(y.redISub(g)).redISub(c.redMul(m)),x=this.z.redMul(t.z).redMul(h);return this.curve.jpoint(g,_,x)};Ts.prototype.mixedAdd=function(t){if(this.isInfinity())return t.toJ();if(t.isInfinity())return this;var n=this.z.redSqr(),i=this.x,o=t.x.redMul(n),s=this.y,c=t.y.redMul(n).redMul(this.z),u=i.redSub(o),h=s.redSub(c);if(u.cmpn(0)===0)return h.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var f=u.redSqr(),p=f.redMul(u),m=i.redMul(f),y=h.redSqr().redIAdd(p).redISub(m).redISub(m),g=h.redMul(m.redISub(y)).redISub(s.redMul(p)),_=this.z.redMul(u);return this.curve.jpoint(y,g,_)};Ts.prototype.dblp=function(t){if(t===0)return this;if(this.isInfinity())return this;if(!t)return this.dbl();var n;if(this.curve.zeroA||this.curve.threeA){var i=this;for(n=0;n<t;n++)i=i.dbl();return i}var o=this.curve.a,s=this.curve.tinv,c=this.x,u=this.y,h=this.z,f=h.redSqr().redSqr(),p=u.redAdd(u);for(n=0;n<t;n++){var m=c.redSqr(),y=p.redSqr(),g=y.redSqr(),_=m.redAdd(m).redIAdd(m).redIAdd(o.redMul(f)),x=c.redMul(y),b=_.redSqr().redISub(x.redAdd(x)),E=x.redISub(b),T=_.redMul(E);T=T.redIAdd(T).redISub(g);var P=p.redMul(h);n+1<t&&(f=f.redMul(g)),c=b,h=P,p=T}return this.curve.jpoint(c,p.redMul(s),h)};Ts.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};Ts.prototype._zeroDbl=function(){var t,n,i;if(this.zOne){var o=this.x.redSqr(),s=this.y.redSqr(),c=s.redSqr(),u=this.x.redAdd(s).redSqr().redISub(o).redISub(c);u=u.redIAdd(u);var h=o.redAdd(o).redIAdd(o),f=h.redSqr().redISub(u).redISub(u),p=c.redIAdd(c);p=p.redIAdd(p),p=p.redIAdd(p),t=f,n=h.redMul(u.redISub(f)).redISub(p),i=this.y.redAdd(this.y)}else{var m=this.x.redSqr(),y=this.y.redSqr(),g=y.redSqr(),_=this.x.redAdd(y).redSqr().redISub(m).redISub(g);_=_.redIAdd(_);var x=m.redAdd(m).redIAdd(m),b=x.redSqr(),E=g.redIAdd(g);E=E.redIAdd(E),E=E.redIAdd(E),t=b.redISub(_).redISub(_),n=x.redMul(_.redISub(t)).redISub(E),i=this.y.redMul(this.z),i=i.redIAdd(i)}return this.curve.jpoint(t,n,i)};Ts.prototype._threeDbl=function(){var t,n,i;if(this.zOne){var o=this.x.redSqr(),s=this.y.redSqr(),c=s.redSqr(),u=this.x.redAdd(s).redSqr().redISub(o).redISub(c);u=u.redIAdd(u);var h=o.redAdd(o).redIAdd(o).redIAdd(this.curve.a),f=h.redSqr().redISub(u).redISub(u);t=f;var p=c.redIAdd(c);p=p.redIAdd(p),p=p.redIAdd(p),n=h.redMul(u.redISub(f)).redISub(p),i=this.y.redAdd(this.y)}else{var m=this.z.redSqr(),y=this.y.redSqr(),g=this.x.redMul(y),_=this.x.redSub(m).redMul(this.x.redAdd(m));_=_.redAdd(_).redIAdd(_);var x=g.redIAdd(g);x=x.redIAdd(x);var b=x.redAdd(x);t=_.redSqr().redISub(b),i=this.y.redAdd(this.z).redSqr().redISub(y).redISub(m);var E=y.redSqr();E=E.redIAdd(E),E=E.redIAdd(E),E=E.redIAdd(E),n=_.redMul(x.redISub(t)).redISub(E)}return this.curve.jpoint(t,n,i)};Ts.prototype._dbl=function(){var t=this.curve.a,n=this.x,i=this.y,o=this.z,s=o.redSqr().redSqr(),c=n.redSqr(),u=i.redSqr(),h=c.redAdd(c).redIAdd(c).redIAdd(t.redMul(s)),f=n.redAdd(n);f=f.redIAdd(f);var p=f.redMul(u),m=h.redSqr().redISub(p.redAdd(p)),y=p.redISub(m),g=u.redSqr();g=g.redIAdd(g),g=g.redIAdd(g),g=g.redIAdd(g);var _=h.redMul(y).redISub(g),x=i.redAdd(i).redMul(o);return this.curve.jpoint(m,_,x)};Ts.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var t=this.x.redSqr(),n=this.y.redSqr(),i=this.z.redSqr(),o=n.redSqr(),s=t.redAdd(t).redIAdd(t),c=s.redSqr(),u=this.x.redAdd(n).redSqr().redISub(t).redISub(o);u=u.redIAdd(u),u=u.redAdd(u).redIAdd(u),u=u.redISub(c);var h=u.redSqr(),f=o.redIAdd(o);f=f.redIAdd(f),f=f.redIAdd(f),f=f.redIAdd(f);var p=s.redIAdd(u).redSqr().redISub(c).redISub(h).redISub(f),m=n.redMul(p);m=m.redIAdd(m),m=m.redIAdd(m);var y=this.x.redMul(h).redISub(m);y=y.redIAdd(y),y=y.redIAdd(y);var g=this.y.redMul(p.redMul(f.redISub(p)).redISub(u.redMul(h)));g=g.redIAdd(g),g=g.redIAdd(g),g=g.redIAdd(g);var _=this.z.redAdd(u).redSqr().redISub(i).redISub(h);return this.curve.jpoint(y,g,_)};Ts.prototype.mul=function(t,n){return t=new Br(t,n),this.curve._wnafMul(this,t)};Ts.prototype.eq=function(t){if(t.type==="affine")return this.eq(t.toJ());if(this===t)return!0;var n=this.z.redSqr(),i=t.z.redSqr();if(this.x.redMul(i).redISub(t.x.redMul(n)).cmpn(0)!==0)return!1;var o=n.redMul(this.z),s=i.redMul(t.z);return this.y.redMul(s).redISub(t.y.redMul(o)).cmpn(0)===0};Ts.prototype.eqXToP=function(t){var n=this.z.redSqr(),i=t.toRed(this.curve.red).redMul(n);if(this.x.cmp(i)===0)return!0;for(var o=t.clone(),s=this.curve.redN.redMul(n);;){if(o.iadd(this.curve.n),o.cmp(this.curve.p)>=0)return!1;if(i.redIAdd(s),this.x.cmp(i)===0)return!0}};Ts.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};Ts.prototype.isInfinity=function(){return this.z.cmpn(0)===0};var Zf=al.exports,vP=Md.exports,Xy=jy,c$=Oo;function Wd(a){Xy.call(this,"mont",a),this.a=new Zf(a.a,16).toRed(this.red),this.b=new Zf(a.b,16).toRed(this.red),this.i4=new Zf(4).toRed(this.red).redInvm(),this.two=new Zf(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}vP(Wd,Xy);var u$=Wd;Wd.prototype.validate=function(t){var n=t.normalize().x,i=n.redSqr(),o=i.redMul(n).redAdd(i.redMul(this.a)).redAdd(n),s=o.redSqrt();return s.redSqr().cmp(o)===0};function ms(a,t,n){Xy.BasePoint.call(this,a,"projective"),t===null&&n===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new Zf(t,16),this.z=new Zf(n,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}vP(ms,Xy.BasePoint);Wd.prototype.decodePoint=function(t,n){return this.point(c$.toArray(t,n),1)};Wd.prototype.point=function(t,n){return new ms(this,t,n)};Wd.prototype.pointFromJSON=function(t){return ms.fromJSON(this,t)};ms.prototype.precompute=function(){};ms.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())};ms.fromJSON=function(t,n){return new ms(t,n[0],n[1]||t.one)};ms.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};ms.prototype.isInfinity=function(){return this.z.cmpn(0)===0};ms.prototype.dbl=function(){var t=this.x.redAdd(this.z),n=t.redSqr(),i=this.x.redSub(this.z),o=i.redSqr(),s=n.redSub(o),c=n.redMul(o),u=s.redMul(o.redAdd(this.curve.a24.redMul(s)));return this.curve.point(c,u)};ms.prototype.add=function(){throw new Error("Not supported on Montgomery curve")};ms.prototype.diffAdd=function(t,n){var i=this.x.redAdd(this.z),o=this.x.redSub(this.z),s=t.x.redAdd(t.z),c=t.x.redSub(t.z),u=c.redMul(i),h=s.redMul(o),f=n.z.redMul(u.redAdd(h).redSqr()),p=n.x.redMul(u.redISub(h).redSqr());return this.curve.point(f,p)};ms.prototype.mul=function(t){for(var n=t.clone(),i=this,o=this.curve.point(null,null),s=this,c=[];n.cmpn(0)!==0;n.iushrn(1))c.push(n.andln(1));for(var u=c.length-1;u>=0;u--)c[u]===0?(i=i.diffAdd(o,s),o=o.dbl()):(o=i.diffAdd(o,s),i=i.dbl());return o};ms.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")};ms.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")};ms.prototype.eq=function(t){return this.getX().cmp(t.getX())===0};ms.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this};ms.prototype.getX=function(){return this.normalize(),this.x.fromRed()};var h$=Oo,Nl=al.exports,yP=Md.exports,$y=jy,f$=h$.assert;function ll(a){this.twisted=(a.a|0)!==1,this.mOneA=this.twisted&&(a.a|0)===-1,this.extended=this.mOneA,$y.call(this,"edwards",a),this.a=new Nl(a.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new Nl(a.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new Nl(a.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),f$(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(a.c|0)===1}yP(ll,$y);var d$=ll;ll.prototype._mulA=function(t){return this.mOneA?t.redNeg():this.a.redMul(t)};ll.prototype._mulC=function(t){return this.oneC?t:this.c.redMul(t)};ll.prototype.jpoint=function(t,n,i,o){return this.point(t,n,i,o)};ll.prototype.pointFromX=function(t,n){t=new Nl(t,16),t.red||(t=t.toRed(this.red));var i=t.redSqr(),o=this.c2.redSub(this.a.redMul(i)),s=this.one.redSub(this.c2.redMul(this.d).redMul(i)),c=o.redMul(s.redInvm()),u=c.redSqrt();if(u.redSqr().redSub(c).cmp(this.zero)!==0)throw new Error("invalid point");var h=u.fromRed().isOdd();return(n&&!h||!n&&h)&&(u=u.redNeg()),this.point(t,u)};ll.prototype.pointFromY=function(t,n){t=new Nl(t,16),t.red||(t=t.toRed(this.red));var i=t.redSqr(),o=i.redSub(this.c2),s=i.redMul(this.d).redMul(this.c2).redSub(this.a),c=o.redMul(s.redInvm());if(c.cmp(this.zero)===0){if(n)throw new Error("invalid point");return this.point(this.zero,t)}var u=c.redSqrt();if(u.redSqr().redSub(c).cmp(this.zero)!==0)throw new Error("invalid point");return u.fromRed().isOdd()!==n&&(u=u.redNeg()),this.point(u,t)};ll.prototype.validate=function(t){if(t.isInfinity())return!0;t.normalize();var n=t.x.redSqr(),i=t.y.redSqr(),o=n.redMul(this.a).redAdd(i),s=this.c2.redMul(this.one.redAdd(this.d.redMul(n).redMul(i)));return o.cmp(s)===0};function xr(a,t,n,i,o){$y.BasePoint.call(this,a,"projective"),t===null&&n===null&&i===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new Nl(t,16),this.y=new Nl(n,16),this.z=i?new Nl(i,16):this.curve.one,this.t=o&&new Nl(o,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}yP(xr,$y.BasePoint);ll.prototype.pointFromJSON=function(t){return xr.fromJSON(this,t)};ll.prototype.point=function(t,n,i,o){return new xr(this,t,n,i,o)};xr.fromJSON=function(t,n){return new xr(t,n[0],n[1],n[2])};xr.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};xr.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};xr.prototype._extDbl=function(){var t=this.x.redSqr(),n=this.y.redSqr(),i=this.z.redSqr();i=i.redIAdd(i);var o=this.curve._mulA(t),s=this.x.redAdd(this.y).redSqr().redISub(t).redISub(n),c=o.redAdd(n),u=c.redSub(i),h=o.redSub(n),f=s.redMul(u),p=c.redMul(h),m=s.redMul(h),y=u.redMul(c);return this.curve.point(f,p,y,m)};xr.prototype._projDbl=function(){var t=this.x.redAdd(this.y).redSqr(),n=this.x.redSqr(),i=this.y.redSqr(),o,s,c,u,h,f;if(this.curve.twisted){u=this.curve._mulA(n);var p=u.redAdd(i);this.zOne?(o=t.redSub(n).redSub(i).redMul(p.redSub(this.curve.two)),s=p.redMul(u.redSub(i)),c=p.redSqr().redSub(p).redSub(p)):(h=this.z.redSqr(),f=p.redSub(h).redISub(h),o=t.redSub(n).redISub(i).redMul(f),s=p.redMul(u.redSub(i)),c=p.redMul(f))}else u=n.redAdd(i),h=this.curve._mulC(this.z).redSqr(),f=u.redSub(h).redSub(h),o=this.curve._mulC(t.redISub(u)).redMul(f),s=this.curve._mulC(u).redMul(n.redISub(i)),c=u.redMul(f);return this.curve.point(o,s,c)};xr.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()};xr.prototype._extAdd=function(t){var n=this.y.redSub(this.x).redMul(t.y.redSub(t.x)),i=this.y.redAdd(this.x).redMul(t.y.redAdd(t.x)),o=this.t.redMul(this.curve.dd).redMul(t.t),s=this.z.redMul(t.z.redAdd(t.z)),c=i.redSub(n),u=s.redSub(o),h=s.redAdd(o),f=i.redAdd(n),p=c.redMul(u),m=h.redMul(f),y=c.redMul(f),g=u.redMul(h);return this.curve.point(p,m,g,y)};xr.prototype._projAdd=function(t){var n=this.z.redMul(t.z),i=n.redSqr(),o=this.x.redMul(t.x),s=this.y.redMul(t.y),c=this.curve.d.redMul(o).redMul(s),u=i.redSub(c),h=i.redAdd(c),f=this.x.redAdd(this.y).redMul(t.x.redAdd(t.y)).redISub(o).redISub(s),p=n.redMul(u).redMul(f),m,y;return this.curve.twisted?(m=n.redMul(h).redMul(s.redSub(this.curve._mulA(o))),y=u.redMul(h)):(m=n.redMul(h).redMul(s.redSub(o)),y=this.curve._mulC(u).redMul(h)),this.curve.point(p,m,y)};xr.prototype.add=function(t){return this.isInfinity()?t:t.isInfinity()?this:this.curve.extended?this._extAdd(t):this._projAdd(t)};xr.prototype.mul=function(t){return this._hasDoubles(t)?this.curve._fixedNafMul(this,t):this.curve._wnafMul(this,t)};xr.prototype.mulAdd=function(t,n,i){return this.curve._wnafMulAdd(1,[this,n],[t,i],2,!1)};xr.prototype.jmulAdd=function(t,n,i){return this.curve._wnafMulAdd(1,[this,n],[t,i],2,!0)};xr.prototype.normalize=function(){if(this.zOne)return this;var t=this.z.redInvm();return this.x=this.x.redMul(t),this.y=this.y.redMul(t),this.t&&(this.t=this.t.redMul(t)),this.z=this.curve.one,this.zOne=!0,this};xr.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};xr.prototype.getX=function(){return this.normalize(),this.x.fromRed()};xr.prototype.getY=function(){return this.normalize(),this.y.fromRed()};xr.prototype.eq=function(t){return this===t||this.getX().cmp(t.getX())===0&&this.getY().cmp(t.getY())===0};xr.prototype.eqXToP=function(t){var n=t.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(n)===0)return!0;for(var i=t.clone(),o=this.curve.redN.redMul(this.z);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(n.redIAdd(o),this.x.cmp(n)===0)return!0}};xr.prototype.toP=xr.prototype.normalize;xr.prototype.mixedAdd=xr.prototype.add;(function(a){var t=a;t.base=jy,t.short=l$,t.mont=u$,t.edwards=d$})(yw);var qy={},Yy={},Hi={},p$=Ph,m$=Md.exports;Hi.inherits=m$;function g$(a,t){return(a.charCodeAt(t)&64512)!==55296||t<0||t+1>=a.length?!1:(a.charCodeAt(t+1)&64512)===56320}function v$(a,t){if(Array.isArray(a))return a.slice();if(!a)return[];var n=[];if(typeof a=="string")if(t){if(t==="hex")for(a=a.replace(/[^a-z0-9]+/ig,""),a.length%2!==0&&(a="0"+a),o=0;o<a.length;o+=2)n.push(parseInt(a[o]+a[o+1],16))}else for(var i=0,o=0;o<a.length;o++){var s=a.charCodeAt(o);s<128?n[i++]=s:s<2048?(n[i++]=s>>6|192,n[i++]=s&63|128):g$(a,o)?(s=65536+((s&1023)<<10)+(a.charCodeAt(++o)&1023),n[i++]=s>>18|240,n[i++]=s>>12&63|128,n[i++]=s>>6&63|128,n[i++]=s&63|128):(n[i++]=s>>12|224,n[i++]=s>>6&63|128,n[i++]=s&63|128)}else for(o=0;o<a.length;o++)n[o]=a[o]|0;return n}Hi.toArray=v$;function y$(a){for(var t="",n=0;n<a.length;n++)t+=AP(a[n].toString(16));return t}Hi.toHex=y$;function xP(a){var t=a>>>24|a>>>8&65280|a<<8&16711680|(a&255)<<24;return t>>>0}Hi.htonl=xP;function x$(a,t){for(var n="",i=0;i<a.length;i++){var o=a[i];t==="little"&&(o=xP(o)),n+=bP(o.toString(16))}return n}Hi.toHex32=x$;function AP(a){return a.length===1?"0"+a:a}Hi.zero2=AP;function bP(a){return a.length===7?"0"+a:a.length===6?"00"+a:a.length===5?"000"+a:a.length===4?"0000"+a:a.length===3?"00000"+a:a.length===2?"000000"+a:a.length===1?"0000000"+a:a}Hi.zero8=bP;function A$(a,t,n,i){var o=n-t;p$(o%4===0);for(var s=new Array(o/4),c=0,u=t;c<s.length;c++,u+=4){var h;i==="big"?h=a[u]<<24|a[u+1]<<16|a[u+2]<<8|a[u+3]:h=a[u+3]<<24|a[u+2]<<16|a[u+1]<<8|a[u],s[c]=h>>>0}return s}Hi.join32=A$;function b$(a,t){for(var n=new Array(a.length*4),i=0,o=0;i<a.length;i++,o+=4){var s=a[i];t==="big"?(n[o]=s>>>24,n[o+1]=s>>>16&255,n[o+2]=s>>>8&255,n[o+3]=s&255):(n[o+3]=s>>>24,n[o+2]=s>>>16&255,n[o+1]=s>>>8&255,n[o]=s&255)}return n}Hi.split32=b$;function _$(a,t){return a>>>t|a<<32-t}Hi.rotr32=_$;function w$(a,t){return a<<t|a>>>32-t}Hi.rotl32=w$;function E$(a,t){return a+t>>>0}Hi.sum32=E$;function M$(a,t,n){return a+t+n>>>0}Hi.sum32_3=M$;function S$(a,t,n,i){return a+t+n+i>>>0}Hi.sum32_4=S$;function T$(a,t,n,i,o){return a+t+n+i+o>>>0}Hi.sum32_5=T$;function C$(a,t,n,i){var o=a[t],s=a[t+1],c=i+s>>>0,u=(c<i?1:0)+n+o;a[t]=u>>>0,a[t+1]=c}Hi.sum64=C$;function R$(a,t,n,i){var o=t+i>>>0,s=(o<t?1:0)+a+n;return s>>>0}Hi.sum64_hi=R$;function L$(a,t,n,i){var o=t+i;return o>>>0}Hi.sum64_lo=L$;function P$(a,t,n,i,o,s,c,u){var h=0,f=t;f=f+i>>>0,h+=f<t?1:0,f=f+s>>>0,h+=f<s?1:0,f=f+u>>>0,h+=f<u?1:0;var p=a+n+o+c+h;return p>>>0}Hi.sum64_4_hi=P$;function I$(a,t,n,i,o,s,c,u){var h=t+i+s+u;return h>>>0}Hi.sum64_4_lo=I$;function O$(a,t,n,i,o,s,c,u,h,f){var p=0,m=t;m=m+i>>>0,p+=m<t?1:0,m=m+s>>>0,p+=m<s?1:0,m=m+u>>>0,p+=m<u?1:0,m=m+f>>>0,p+=m<f?1:0;var y=a+n+o+c+h+p;return y>>>0}Hi.sum64_5_hi=O$;function D$(a,t,n,i,o,s,c,u,h,f){var p=t+i+s+u+f;return p>>>0}Hi.sum64_5_lo=D$;function B$(a,t,n){var i=t<<32-n|a>>>n;return i>>>0}Hi.rotr64_hi=B$;function F$(a,t,n){var i=a<<32-n|t>>>n;return i>>>0}Hi.rotr64_lo=F$;function N$(a,t,n){return a>>>n}Hi.shr64_hi=N$;function U$(a,t,n){var i=a<<32-n|t>>>n;return i>>>0}Hi.shr64_lo=U$;var jd={},G3=Hi,k$=Ph;function Qy(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}jd.BlockHash=Qy;Qy.prototype.update=function(t,n){if(t=G3.toArray(t,n),this.pending?this.pending=this.pending.concat(t):this.pending=t,this.pendingTotal+=t.length,this.pending.length>=this._delta8){t=this.pending;var i=t.length%this._delta8;this.pending=t.slice(t.length-i,t.length),this.pending.length===0&&(this.pending=null),t=G3.join32(t,0,t.length-i,this.endian);for(var o=0;o<t.length;o+=this._delta32)this._update(t,o,o+this._delta32)}return this};Qy.prototype.digest=function(t){return this.update(this._pad()),k$(this.pending===null),this._digest(t)};Qy.prototype._pad=function(){var t=this.pendingTotal,n=this._delta8,i=n-(t+this.padLength)%n,o=new Array(i+this.padLength);o[0]=128;for(var s=1;s<i;s++)o[s]=0;if(t<<=3,this.endian==="big"){for(var c=8;c<this.padLength;c++)o[s++]=0;o[s++]=0,o[s++]=0,o[s++]=0,o[s++]=0,o[s++]=t>>>24&255,o[s++]=t>>>16&255,o[s++]=t>>>8&255,o[s++]=t&255}else for(o[s++]=t&255,o[s++]=t>>>8&255,o[s++]=t>>>16&255,o[s++]=t>>>24&255,o[s++]=0,o[s++]=0,o[s++]=0,o[s++]=0,c=8;c<this.padLength;c++)o[s++]=0;return o};var Xd={},cl={},z$=Hi,Ga=z$.rotr32;function H$(a,t,n,i){if(a===0)return _P(t,n,i);if(a===1||a===3)return EP(t,n,i);if(a===2)return wP(t,n,i)}cl.ft_1=H$;function _P(a,t,n){return a&t^~a&n}cl.ch32=_P;function wP(a,t,n){return a&t^a&n^t&n}cl.maj32=wP;function EP(a,t,n){return a^t^n}cl.p32=EP;function G$(a){return Ga(a,2)^Ga(a,13)^Ga(a,22)}cl.s0_256=G$;function V$(a){return Ga(a,6)^Ga(a,11)^Ga(a,25)}cl.s1_256=V$;function W$(a){return Ga(a,7)^Ga(a,18)^a>>>3}cl.g0_256=W$;function j$(a){return Ga(a,17)^Ga(a,19)^a>>>10}cl.g1_256=j$;var Sd=Hi,X$=jd,$$=cl,PA=Sd.rotl32,Hp=Sd.sum32,q$=Sd.sum32_5,Y$=$$.ft_1,MP=X$.BlockHash,Q$=[1518500249,1859775393,2400959708,3395469782];function Ka(){if(!(this instanceof Ka))return new Ka;MP.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}Sd.inherits(Ka,MP);var K$=Ka;Ka.blockSize=512;Ka.outSize=160;Ka.hmacStrength=80;Ka.padLength=64;Ka.prototype._update=function(t,n){for(var i=this.W,o=0;o<16;o++)i[o]=t[n+o];for(;o<i.length;o++)i[o]=PA(i[o-3]^i[o-8]^i[o-14]^i[o-16],1);var s=this.h[0],c=this.h[1],u=this.h[2],h=this.h[3],f=this.h[4];for(o=0;o<i.length;o++){var p=~~(o/20),m=q$(PA(s,5),Y$(p,c,u,h),f,i[o],Q$[p]);f=h,h=u,u=PA(c,30),c=s,s=m}this.h[0]=Hp(this.h[0],s),this.h[1]=Hp(this.h[1],c),this.h[2]=Hp(this.h[2],u),this.h[3]=Hp(this.h[3],h),this.h[4]=Hp(this.h[4],f)};Ka.prototype._digest=function(t){return t==="hex"?Sd.toHex32(this.h,"big"):Sd.split32(this.h,"big")};var Td=Hi,Z$=jd,$d=cl,J$=Ph,ia=Td.sum32,eq=Td.sum32_4,tq=Td.sum32_5,nq=$d.ch32,iq=$d.maj32,rq=$d.s0_256,sq=$d.s1_256,oq=$d.g0_256,aq=$d.g1_256,SP=Z$.BlockHash,lq=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Za(){if(!(this instanceof Za))return new Za;SP.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=lq,this.W=new Array(64)}Td.inherits(Za,SP);var TP=Za;Za.blockSize=512;Za.outSize=256;Za.hmacStrength=192;Za.padLength=64;Za.prototype._update=function(t,n){for(var i=this.W,o=0;o<16;o++)i[o]=t[n+o];for(;o<i.length;o++)i[o]=eq(aq(i[o-2]),i[o-7],oq(i[o-15]),i[o-16]);var s=this.h[0],c=this.h[1],u=this.h[2],h=this.h[3],f=this.h[4],p=this.h[5],m=this.h[6],y=this.h[7];for(J$(this.k.length===i.length),o=0;o<i.length;o++){var g=tq(y,sq(f),nq(f,p,m),this.k[o],i[o]),_=ia(rq(s),iq(s,c,u));y=m,m=p,p=f,f=ia(h,g),h=u,u=c,c=s,s=ia(g,_)}this.h[0]=ia(this.h[0],s),this.h[1]=ia(this.h[1],c),this.h[2]=ia(this.h[2],u),this.h[3]=ia(this.h[3],h),this.h[4]=ia(this.h[4],f),this.h[5]=ia(this.h[5],p),this.h[6]=ia(this.h[6],m),this.h[7]=ia(this.h[7],y)};Za.prototype._digest=function(t){return t==="hex"?Td.toHex32(this.h,"big"):Td.split32(this.h,"big")};var Yb=Hi,CP=TP;function Vl(){if(!(this instanceof Vl))return new Vl;CP.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}Yb.inherits(Vl,CP);var cq=Vl;Vl.blockSize=512;Vl.outSize=224;Vl.hmacStrength=192;Vl.padLength=64;Vl.prototype._digest=function(t){return t==="hex"?Yb.toHex32(this.h.slice(0,7),"big"):Yb.split32(this.h.slice(0,7),"big")};var lo=Hi,uq=jd,hq=Ph,Va=lo.rotr64_hi,Wa=lo.rotr64_lo,RP=lo.shr64_hi,LP=lo.shr64_lo,Ac=lo.sum64,IA=lo.sum64_hi,OA=lo.sum64_lo,fq=lo.sum64_4_hi,dq=lo.sum64_4_lo,pq=lo.sum64_5_hi,mq=lo.sum64_5_lo,PP=uq.BlockHash,gq=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function va(){if(!(this instanceof va))return new va;PP.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=gq,this.W=new Array(160)}lo.inherits(va,PP);var IP=va;va.blockSize=1024;va.outSize=512;va.hmacStrength=192;va.padLength=128;va.prototype._prepareBlock=function(t,n){for(var i=this.W,o=0;o<32;o++)i[o]=t[n+o];for(;o<i.length;o+=2){var s=Tq(i[o-4],i[o-3]),c=Cq(i[o-4],i[o-3]),u=i[o-14],h=i[o-13],f=Mq(i[o-30],i[o-29]),p=Sq(i[o-30],i[o-29]),m=i[o-32],y=i[o-31];i[o]=fq(s,c,u,h,f,p,m,y),i[o+1]=dq(s,c,u,h,f,p,m,y)}};va.prototype._update=function(t,n){this._prepareBlock(t,n);var i=this.W,o=this.h[0],s=this.h[1],c=this.h[2],u=this.h[3],h=this.h[4],f=this.h[5],p=this.h[6],m=this.h[7],y=this.h[8],g=this.h[9],_=this.h[10],x=this.h[11],b=this.h[12],E=this.h[13],T=this.h[14],P=this.h[15];hq(this.k.length===i.length);for(var D=0;D<i.length;D+=2){var F=T,k=P,W=wq(y,g),j=Eq(y,g),J=vq(y,g,_,x,b),de=yq(y,g,_,x,b,E),te=this.k[D],N=this.k[D+1],L=i[D],M=i[D+1],I=pq(F,k,W,j,J,de,te,N,L,M),U=mq(F,k,W,j,J,de,te,N,L,M);F=bq(o,s),k=_q(o,s),W=xq(o,s,c,u,h),j=Aq(o,s,c,u,h,f);var $=IA(F,k,W,j),ee=OA(F,k,W,j);T=b,P=E,b=_,E=x,_=y,x=g,y=IA(p,m,I,U),g=OA(m,m,I,U),p=h,m=f,h=c,f=u,c=o,u=s,o=IA(I,U,$,ee),s=OA(I,U,$,ee)}Ac(this.h,0,o,s),Ac(this.h,2,c,u),Ac(this.h,4,h,f),Ac(this.h,6,p,m),Ac(this.h,8,y,g),Ac(this.h,10,_,x),Ac(this.h,12,b,E),Ac(this.h,14,T,P)};va.prototype._digest=function(t){return t==="hex"?lo.toHex32(this.h,"big"):lo.split32(this.h,"big")};function vq(a,t,n,i,o){var s=a&n^~a&o;return s<0&&(s+=4294967296),s}function yq(a,t,n,i,o,s){var c=t&i^~t&s;return c<0&&(c+=4294967296),c}function xq(a,t,n,i,o){var s=a&n^a&o^n&o;return s<0&&(s+=4294967296),s}function Aq(a,t,n,i,o,s){var c=t&i^t&s^i&s;return c<0&&(c+=4294967296),c}function bq(a,t){var n=Va(a,t,28),i=Va(t,a,2),o=Va(t,a,7),s=n^i^o;return s<0&&(s+=4294967296),s}function _q(a,t){var n=Wa(a,t,28),i=Wa(t,a,2),o=Wa(t,a,7),s=n^i^o;return s<0&&(s+=4294967296),s}function wq(a,t){var n=Va(a,t,14),i=Va(a,t,18),o=Va(t,a,9),s=n^i^o;return s<0&&(s+=4294967296),s}function Eq(a,t){var n=Wa(a,t,14),i=Wa(a,t,18),o=Wa(t,a,9),s=n^i^o;return s<0&&(s+=4294967296),s}function Mq(a,t){var n=Va(a,t,1),i=Va(a,t,8),o=RP(a,t,7),s=n^i^o;return s<0&&(s+=4294967296),s}function Sq(a,t){var n=Wa(a,t,1),i=Wa(a,t,8),o=LP(a,t,7),s=n^i^o;return s<0&&(s+=4294967296),s}function Tq(a,t){var n=Va(a,t,19),i=Va(t,a,29),o=RP(a,t,6),s=n^i^o;return s<0&&(s+=4294967296),s}function Cq(a,t){var n=Wa(a,t,19),i=Wa(t,a,29),o=LP(a,t,6),s=n^i^o;return s<0&&(s+=4294967296),s}var Qb=Hi,OP=IP;function Wl(){if(!(this instanceof Wl))return new Wl;OP.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}Qb.inherits(Wl,OP);var Rq=Wl;Wl.blockSize=1024;Wl.outSize=384;Wl.hmacStrength=192;Wl.padLength=128;Wl.prototype._digest=function(t){return t==="hex"?Qb.toHex32(this.h.slice(0,12),"big"):Qb.split32(this.h.slice(0,12),"big")};Xd.sha1=K$;Xd.sha224=cq;Xd.sha256=TP;Xd.sha384=Rq;Xd.sha512=IP;var DP={},Ah=Hi,Lq=jd,lv=Ah.rotl32,V3=Ah.sum32,Gp=Ah.sum32_3,W3=Ah.sum32_4,BP=Lq.BlockHash;function Ja(){if(!(this instanceof Ja))return new Ja;BP.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}Ah.inherits(Ja,BP);DP.ripemd160=Ja;Ja.blockSize=512;Ja.outSize=160;Ja.hmacStrength=192;Ja.padLength=64;Ja.prototype._update=function(t,n){for(var i=this.h[0],o=this.h[1],s=this.h[2],c=this.h[3],u=this.h[4],h=i,f=o,p=s,m=c,y=u,g=0;g<80;g++){var _=V3(lv(W3(i,j3(g,o,s,c),t[Oq[g]+n],Pq(g)),Bq[g]),u);i=u,u=c,c=lv(s,10),s=o,o=_,_=V3(lv(W3(h,j3(79-g,f,p,m),t[Dq[g]+n],Iq(g)),Fq[g]),y),h=y,y=m,m=lv(p,10),p=f,f=_}_=Gp(this.h[1],s,m),this.h[1]=Gp(this.h[2],c,y),this.h[2]=Gp(this.h[3],u,h),this.h[3]=Gp(this.h[4],i,f),this.h[4]=Gp(this.h[0],o,p),this.h[0]=_};Ja.prototype._digest=function(t){return t==="hex"?Ah.toHex32(this.h,"little"):Ah.split32(this.h,"little")};function j3(a,t,n,i){return a<=15?t^n^i:a<=31?t&n|~t&i:a<=47?(t|~n)^i:a<=63?t&i|n&~i:t^(n|~i)}function Pq(a){return a<=15?0:a<=31?1518500249:a<=47?1859775393:a<=63?2400959708:2840853838}function Iq(a){return a<=15?1352829926:a<=31?1548603684:a<=47?1836072691:a<=63?2053994217:0}var Oq=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],Dq=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],Bq=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],Fq=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],Nq=Hi,Uq=Ph;function Cd(a,t,n){if(!(this instanceof Cd))return new Cd(a,t,n);this.Hash=a,this.blockSize=a.blockSize/8,this.outSize=a.outSize/8,this.inner=null,this.outer=null,this._init(Nq.toArray(t,n))}var kq=Cd;Cd.prototype._init=function(t){t.length>this.blockSize&&(t=new this.Hash().update(t).digest()),Uq(t.length<=this.blockSize);for(var n=t.length;n<this.blockSize;n++)t.push(0);for(n=0;n<t.length;n++)t[n]^=54;for(this.inner=new this.Hash().update(t),n=0;n<t.length;n++)t[n]^=106;this.outer=new this.Hash().update(t)};Cd.prototype.update=function(t,n){return this.inner.update(t,n),this};Cd.prototype.digest=function(t){return this.outer.update(this.inner.digest()),this.outer.digest(t)};(function(a){var t=a;t.utils=Hi,t.common=jd,t.sha=Xd,t.ripemd=DP,t.hmac=kq,t.sha1=t.sha.sha1,t.sha256=t.sha.sha256,t.sha224=t.sha.sha224,t.sha384=t.sha.sha384,t.sha512=t.sha.sha512,t.ripemd160=t.ripemd.ripemd160})(Yy);(function(a){var t=a,n=Yy,i=yw,o=Oo,s=o.assert;function c(f){f.type==="short"?this.curve=new i.short(f):f.type==="edwards"?this.curve=new i.edwards(f):this.curve=new i.mont(f),this.g=this.curve.g,this.n=this.curve.n,this.hash=f.hash,s(this.g.validate(),"Invalid curve"),s(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}t.PresetCurve=c;function u(f,p){Object.defineProperty(t,f,{configurable:!0,enumerable:!0,get:function(){var m=new c(p);return Object.defineProperty(t,f,{configurable:!0,enumerable:!0,value:m}),m}})}u("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:n.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]}),u("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:n.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]}),u("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:n.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]}),u("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:n.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]}),u("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:n.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]}),u("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:n.sha256,gRed:!1,g:["9"]}),u("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:n.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var h;try{h=require("./precomputed/secp256k1")}catch{h=void 0}u("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:n.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",h]})})(qy);var zq=Yy,ch=vw,FP=Ph;function Xc(a){if(!(this instanceof Xc))return new Xc(a);this.hash=a.hash,this.predResist=!!a.predResist,this.outLen=this.hash.outSize,this.minEntropy=a.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var t=ch.toArray(a.entropy,a.entropyEnc||"hex"),n=ch.toArray(a.nonce,a.nonceEnc||"hex"),i=ch.toArray(a.pers,a.persEnc||"hex");FP(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(t,n,i)}var Hq=Xc;Xc.prototype._init=function(t,n,i){var o=t.concat(n).concat(i);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var s=0;s<this.V.length;s++)this.K[s]=0,this.V[s]=1;this._update(o),this._reseed=1,this.reseedInterval=281474976710656};Xc.prototype._hmac=function(){return new zq.hmac(this.hash,this.K)};Xc.prototype._update=function(t){var n=this._hmac().update(this.V).update([0]);t&&(n=n.update(t)),this.K=n.digest(),this.V=this._hmac().update(this.V).digest(),t&&(this.K=this._hmac().update(this.V).update([1]).update(t).digest(),this.V=this._hmac().update(this.V).digest())};Xc.prototype.reseed=function(t,n,i,o){typeof n!="string"&&(o=i,i=n,n=null),t=ch.toArray(t,n),i=ch.toArray(i,o),FP(t.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(t.concat(i||[])),this._reseed=1};Xc.prototype.generate=function(t,n,i,o){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof n!="string"&&(o=i,i=n,n=null),i&&(i=ch.toArray(i,o||"hex"),this._update(i));for(var s=[];s.length<t;)this.V=this._hmac().update(this.V).digest(),s=s.concat(this.V);var c=s.slice(0,t);return this._update(i),this._reseed++,ch.encode(c,n)};var Gq=al.exports,Vq=Oo,Kb=Vq.assert;function Vs(a,t){this.ec=a,this.priv=null,this.pub=null,t.priv&&this._importPrivate(t.priv,t.privEnc),t.pub&&this._importPublic(t.pub,t.pubEnc)}var Wq=Vs;Vs.fromPublic=function(t,n,i){return n instanceof Vs?n:new Vs(t,{pub:n,pubEnc:i})};Vs.fromPrivate=function(t,n,i){return n instanceof Vs?n:new Vs(t,{priv:n,privEnc:i})};Vs.prototype.validate=function(){var t=this.getPublic();return t.isInfinity()?{result:!1,reason:"Invalid public key"}:t.validate()?t.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};Vs.prototype.getPublic=function(t,n){return typeof t=="string"&&(n=t,t=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),n?this.pub.encode(n,t):this.pub};Vs.prototype.getPrivate=function(t){return t==="hex"?this.priv.toString(16,2):this.priv};Vs.prototype._importPrivate=function(t,n){this.priv=new Gq(t,n||16),this.priv=this.priv.umod(this.ec.curve.n)};Vs.prototype._importPublic=function(t,n){if(t.x||t.y){this.ec.curve.type==="mont"?Kb(t.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&Kb(t.x&&t.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(t.x,t.y);return}this.pub=this.ec.curve.decodePoint(t,n)};Vs.prototype.derive=function(t){return t.validate()||Kb(t.validate(),"public point not validated"),t.mul(this.priv).getX()};Vs.prototype.sign=function(t,n,i){return this.ec.sign(t,this,n,i)};Vs.prototype.verify=function(t,n){return this.ec.verify(t,n,this)};Vs.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"};var $v=al.exports,Aw=Oo,jq=Aw.assert;function Ky(a,t){if(a instanceof Ky)return a;this._importDER(a,t)||(jq(a.r&&a.s,"Signature without r or s"),this.r=new $v(a.r,16),this.s=new $v(a.s,16),a.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=a.recoveryParam)}var Xq=Ky;function $q(){this.place=0}function DA(a,t){var n=a[t.place++];if(!(n&128))return n;var i=n&15;if(i===0||i>4)return!1;for(var o=0,s=0,c=t.place;s<i;s++,c++)o<<=8,o|=a[c],o>>>=0;return o<=127?!1:(t.place=c,o)}function X3(a){for(var t=0,n=a.length-1;!a[t]&&!(a[t+1]&128)&&t<n;)t++;return t===0?a:a.slice(t)}Ky.prototype._importDER=function(t,n){t=Aw.toArray(t,n);var i=new $q;if(t[i.place++]!==48)return!1;var o=DA(t,i);if(o===!1||o+i.place!==t.length||t[i.place++]!==2)return!1;var s=DA(t,i);if(s===!1)return!1;var c=t.slice(i.place,s+i.place);if(i.place+=s,t[i.place++]!==2)return!1;var u=DA(t,i);if(u===!1||t.length!==u+i.place)return!1;var h=t.slice(i.place,u+i.place);if(c[0]===0)if(c[1]&128)c=c.slice(1);else return!1;if(h[0]===0)if(h[1]&128)h=h.slice(1);else return!1;return this.r=new $v(c),this.s=new $v(h),this.recoveryParam=null,!0};function BA(a,t){if(t<128){a.push(t);return}var n=1+(Math.log(t)/Math.LN2>>>3);for(a.push(n|128);--n;)a.push(t>>>(n<<3)&255);a.push(t)}Ky.prototype.toDER=function(t){var n=this.r.toArray(),i=this.s.toArray();for(n[0]&128&&(n=[0].concat(n)),i[0]&128&&(i=[0].concat(i)),n=X3(n),i=X3(i);!i[0]&&!(i[1]&128);)i=i.slice(1);var o=[2];BA(o,n.length),o=o.concat(n),o.push(2),BA(o,i.length);var s=o.concat(i),c=[48];return BA(c,s.length),c=c.concat(s),Aw.encode(c,t)};var uh=al.exports,NP=Hq,qq=Oo,FA=qy,Yq=Wy.exports,UP=qq.assert,bw=Wq,Zy=Xq;function Wo(a){if(!(this instanceof Wo))return new Wo(a);typeof a=="string"&&(UP(Object.prototype.hasOwnProperty.call(FA,a),"Unknown curve "+a),a=FA[a]),a instanceof FA.PresetCurve&&(a={curve:a}),this.curve=a.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=a.curve.g,this.g.precompute(a.curve.n.bitLength()+1),this.hash=a.hash||a.curve.hash}var Qq=Wo;Wo.prototype.keyPair=function(t){return new bw(this,t)};Wo.prototype.keyFromPrivate=function(t,n){return bw.fromPrivate(this,t,n)};Wo.prototype.keyFromPublic=function(t,n){return bw.fromPublic(this,t,n)};Wo.prototype.genKeyPair=function(t){t||(t={});for(var n=new NP({hash:this.hash,pers:t.pers,persEnc:t.persEnc||"utf8",entropy:t.entropy||Yq(this.hash.hmacStrength),entropyEnc:t.entropy&&t.entropyEnc||"utf8",nonce:this.n.toArray()}),i=this.n.byteLength(),o=this.n.sub(new uh(2));;){var s=new uh(n.generate(i));if(!(s.cmp(o)>0))return s.iaddn(1),this.keyFromPrivate(s)}};Wo.prototype._truncateToN=function(t,n){var i=t.byteLength()*8-this.n.bitLength();return i>0&&(t=t.ushrn(i)),!n&&t.cmp(this.n)>=0?t.sub(this.n):t};Wo.prototype.sign=function(t,n,i,o){typeof i=="object"&&(o=i,i=null),o||(o={}),n=this.keyFromPrivate(n,i),t=this._truncateToN(new uh(t,16));for(var s=this.n.byteLength(),c=n.getPrivate().toArray("be",s),u=t.toArray("be",s),h=new NP({hash:this.hash,entropy:c,nonce:u,pers:o.pers,persEnc:o.persEnc||"utf8"}),f=this.n.sub(new uh(1)),p=0;;p++){var m=o.k?o.k(p):new uh(h.generate(this.n.byteLength()));if(m=this._truncateToN(m,!0),!(m.cmpn(1)<=0||m.cmp(f)>=0)){var y=this.g.mul(m);if(!y.isInfinity()){var g=y.getX(),_=g.umod(this.n);if(_.cmpn(0)!==0){var x=m.invm(this.n).mul(_.mul(n.getPrivate()).iadd(t));if(x=x.umod(this.n),x.cmpn(0)!==0){var b=(y.getY().isOdd()?1:0)|(g.cmp(_)!==0?2:0);return o.canonical&&x.cmp(this.nh)>0&&(x=this.n.sub(x),b^=1),new Zy({r:_,s:x,recoveryParam:b})}}}}}};Wo.prototype.verify=function(t,n,i,o){t=this._truncateToN(new uh(t,16)),i=this.keyFromPublic(i,o),n=new Zy(n,"hex");var s=n.r,c=n.s;if(s.cmpn(1)<0||s.cmp(this.n)>=0||c.cmpn(1)<0||c.cmp(this.n)>=0)return!1;var u=c.invm(this.n),h=u.mul(t).umod(this.n),f=u.mul(s).umod(this.n),p;return this.curve._maxwellTrick?(p=this.g.jmulAdd(h,i.getPublic(),f),p.isInfinity()?!1:p.eqXToP(s)):(p=this.g.mulAdd(h,i.getPublic(),f),p.isInfinity()?!1:p.getX().umod(this.n).cmp(s)===0)};Wo.prototype.recoverPubKey=function(a,t,n,i){UP((3&n)===n,"The recovery param is more than two bits"),t=new Zy(t,i);var o=this.n,s=new uh(a),c=t.r,u=t.s,h=n&1,f=n>>1;if(c.cmp(this.curve.p.umod(this.curve.n))>=0&&f)throw new Error("Unable to find sencond key candinate");f?c=this.curve.pointFromX(c.add(this.curve.n),h):c=this.curve.pointFromX(c,h);var p=t.r.invm(o),m=o.sub(s).mul(p).umod(o),y=u.mul(p).umod(o);return this.g.mulAdd(m,c,y)};Wo.prototype.getKeyRecoveryParam=function(a,t,n,i){if(t=new Zy(t,i),t.recoveryParam!==null)return t.recoveryParam;for(var o=0;o<4;o++){var s;try{s=this.recoverPubKey(a,t,o)}catch{continue}if(s.eq(n))return o}throw new Error("Unable to find valid recovery factor")};var jm=Oo,kP=jm.assert,$3=jm.parseBytes,qd=jm.cachedProperty;function ps(a,t){this.eddsa=a,this._secret=$3(t.secret),a.isPoint(t.pub)?this._pub=t.pub:this._pubBytes=$3(t.pub)}ps.fromPublic=function(t,n){return n instanceof ps?n:new ps(t,{pub:n})};ps.fromSecret=function(t,n){return n instanceof ps?n:new ps(t,{secret:n})};ps.prototype.secret=function(){return this._secret};qd(ps,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())});qd(ps,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())});qd(ps,"privBytes",function(){var t=this.eddsa,n=this.hash(),i=t.encodingLength-1,o=n.slice(0,t.encodingLength);return o[0]&=248,o[i]&=127,o[i]|=64,o});qd(ps,"priv",function(){return this.eddsa.decodeInt(this.privBytes())});qd(ps,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()});qd(ps,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)});ps.prototype.sign=function(t){return kP(this._secret,"KeyPair can only verify"),this.eddsa.sign(t,this)};ps.prototype.verify=function(t,n){return this.eddsa.verify(t,n,this)};ps.prototype.getSecret=function(t){return kP(this._secret,"KeyPair is public only"),jm.encode(this.secret(),t)};ps.prototype.getPublic=function(t){return jm.encode(this.pubBytes(),t)};var Kq=ps,Zq=al.exports,Jy=Oo,Jq=Jy.assert,e1=Jy.cachedProperty,eY=Jy.parseBytes;function Ih(a,t){this.eddsa=a,typeof t!="object"&&(t=eY(t)),Array.isArray(t)&&(t={R:t.slice(0,a.encodingLength),S:t.slice(a.encodingLength)}),Jq(t.R&&t.S,"Signature without R or S"),a.isPoint(t.R)&&(this._R=t.R),t.S instanceof Zq&&(this._S=t.S),this._Rencoded=Array.isArray(t.R)?t.R:t.Rencoded,this._Sencoded=Array.isArray(t.S)?t.S:t.Sencoded}e1(Ih,"S",function(){return this.eddsa.decodeInt(this.Sencoded())});e1(Ih,"R",function(){return this.eddsa.decodePoint(this.Rencoded())});e1(Ih,"Rencoded",function(){return this.eddsa.encodePoint(this.R())});e1(Ih,"Sencoded",function(){return this.eddsa.encodeInt(this.S())});Ih.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())};Ih.prototype.toHex=function(){return Jy.encode(this.toBytes(),"hex").toUpperCase()};var tY=Ih,nY=Yy,iY=qy,Rd=Oo,rY=Rd.assert,zP=Rd.parseBytes,HP=Kq,q3=tY;function co(a){if(rY(a==="ed25519","only tested with ed25519 so far"),!(this instanceof co))return new co(a);a=iY[a].curve,this.curve=a,this.g=a.g,this.g.precompute(a.n.bitLength()+1),this.pointClass=a.point().constructor,this.encodingLength=Math.ceil(a.n.bitLength()/8),this.hash=nY.sha512}var sY=co;co.prototype.sign=function(t,n){t=zP(t);var i=this.keyFromSecret(n),o=this.hashInt(i.messagePrefix(),t),s=this.g.mul(o),c=this.encodePoint(s),u=this.hashInt(c,i.pubBytes(),t).mul(i.priv()),h=o.add(u).umod(this.curve.n);return this.makeSignature({R:s,S:h,Rencoded:c})};co.prototype.verify=function(t,n,i){t=zP(t),n=this.makeSignature(n);var o=this.keyFromPublic(i),s=this.hashInt(n.Rencoded(),o.pubBytes(),t),c=this.g.mul(n.S()),u=n.R().add(o.pub().mul(s));return u.eq(c)};co.prototype.hashInt=function(){for(var t=this.hash(),n=0;n<arguments.length;n++)t.update(arguments[n]);return Rd.intFromLE(t.digest()).umod(this.curve.n)};co.prototype.keyFromPublic=function(t){return HP.fromPublic(this,t)};co.prototype.keyFromSecret=function(t){return HP.fromSecret(this,t)};co.prototype.makeSignature=function(t){return t instanceof q3?t:new q3(this,t)};co.prototype.encodePoint=function(t){var n=t.getY().toArray("le",this.encodingLength);return n[this.encodingLength-1]|=t.getX().isOdd()?128:0,n};co.prototype.decodePoint=function(t){t=Rd.parseBytes(t);var n=t.length-1,i=t.slice(0,n).concat(t[n]&-129),o=(t[n]&128)!==0,s=Rd.intFromLE(i);return this.curve.pointFromY(s,o)};co.prototype.encodeInt=function(t){return t.toArray("le",this.encodingLength)};co.prototype.decodeInt=function(t){return Rd.intFromLE(t)};co.prototype.isPoint=function(t){return t instanceof this.pointClass};(function(a){var t=a;t.version=r$.version,t.utils=Oo,t.rand=Wy.exports,t.curve=yw,t.curves=qy,t.ec=Qq,t.eddsa=sY})(mP);const oY=mP.ec,aY=new oY("secp256k1"),lY=aY.curve;lY.n.constructor;var cY={exports:{}};/**
 * [js-sha3]{@link https://github.com/emn178/js-sha3}
 *
 * @version 0.8.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2015-2018
 * @license MIT
 */(function(a){(function(){var t="input is invalid type",n="finalize already called",i=typeof window=="object",o=i?window:{};o.JS_SHA3_NO_WINDOW&&(i=!1);var s=!i&&typeof self=="object",c=!o.JS_SHA3_NO_NODE_JS&&typeof process=="object"&&process.versions&&process.versions.node;c?o=Tr:s&&(o=self);var u=!o.JS_SHA3_NO_COMMON_JS&&!0&&a.exports,h=!o.JS_SHA3_NO_ARRAY_BUFFER&&typeof ArrayBuffer!="undefined",f="0123456789abcdef".split(""),p=[31,7936,2031616,520093696],m=[4,1024,262144,67108864],y=[1,256,65536,16777216],g=[6,1536,393216,100663296],_=[0,8,16,24],x=[1,0,32898,0,32906,2147483648,2147516416,2147483648,32907,0,2147483649,0,2147516545,2147483648,32777,2147483648,138,0,136,0,2147516425,0,2147483658,0,2147516555,0,139,2147483648,32905,2147483648,32771,2147483648,32770,2147483648,128,2147483648,32778,0,2147483658,2147483648,2147516545,2147483648,32896,2147483648,2147483649,0,2147516424,2147483648],b=[224,256,384,512],E=[128,256],T=["hex","buffer","arrayBuffer","array","digest"],P={"128":168,"256":136};(o.JS_SHA3_NO_NODE_JS||!Array.isArray)&&(Array.isArray=function(ge){return Object.prototype.toString.call(ge)==="[object Array]"}),h&&(o.JS_SHA3_NO_ARRAY_BUFFER_IS_VIEW||!ArrayBuffer.isView)&&(ArrayBuffer.isView=function(ge){return typeof ge=="object"&&ge.buffer&&ge.buffer.constructor===ArrayBuffer});for(var D=function(ge,me,De){return function(ze){return new Y(ge,me,ge).update(ze)[De]()}},F=function(ge,me,De){return function(ze,tt){return new Y(ge,me,tt).update(ze)[De]()}},k=function(ge,me,De){return function(ze,tt,rt,vt){return M["cshake"+ge].update(ze,tt,rt,vt)[De]()}},W=function(ge,me,De){return function(ze,tt,rt,vt){return M["kmac"+ge].update(ze,tt,rt,vt)[De]()}},j=function(ge,me,De,ze){for(var tt=0;tt<T.length;++tt){var rt=T[tt];ge[rt]=me(De,ze,rt)}return ge},J=function(ge,me){var De=D(ge,me,"hex");return De.create=function(){return new Y(ge,me,ge)},De.update=function(ze){return De.create().update(ze)},j(De,D,ge,me)},de=function(ge,me){var De=F(ge,me,"hex");return De.create=function(ze){return new Y(ge,me,ze)},De.update=function(ze,tt){return De.create(tt).update(ze)},j(De,F,ge,me)},te=function(ge,me){var De=P[ge],ze=k(ge,me,"hex");return ze.create=function(tt,rt,vt){return!rt&&!vt?M["shake"+ge].create(tt):new Y(ge,me,tt).bytepad([rt,vt],De)},ze.update=function(tt,rt,vt,Ye){return ze.create(rt,vt,Ye).update(tt)},j(ze,k,ge,me)},N=function(ge,me){var De=P[ge],ze=W(ge,me,"hex");return ze.create=function(tt,rt,vt){return new we(ge,me,rt).bytepad(["KMAC",vt],De).bytepad([tt],De)},ze.update=function(tt,rt,vt,Ye){return ze.create(tt,vt,Ye).update(rt)},j(ze,W,ge,me)},L=[{name:"keccak",padding:y,bits:b,createMethod:J},{name:"sha3",padding:g,bits:b,createMethod:J},{name:"shake",padding:p,bits:E,createMethod:de},{name:"cshake",padding:m,bits:E,createMethod:te},{name:"kmac",padding:m,bits:E,createMethod:N}],M={},I=[],U=0;U<L.length;++U)for(var $=L[U],ee=$.bits,Q=0;Q<ee.length;++Q){var G=$.name+"_"+ee[Q];if(I.push(G),M[G]=$.createMethod(ee[Q],$.padding),$.name!=="sha3"){var K=$.name+ee[Q];I.push(K),M[K]=M[G]}}function Y(ge,me,De){this.blocks=[],this.s=[],this.padding=me,this.outputBits=De,this.reset=!0,this.finalized=!1,this.block=0,this.start=0,this.blockCount=1600-(ge<<1)>>5,this.byteCount=this.blockCount<<2,this.outputBlocks=De>>5,this.extraBytes=(De&31)>>3;for(var ze=0;ze<50;++ze)this.s[ze]=0}Y.prototype.update=function(ge){if(this.finalized)throw new Error(n);var me,De=typeof ge;if(De!=="string"){if(De==="object"){if(ge===null)throw new Error(t);if(h&&ge.constructor===ArrayBuffer)ge=new Uint8Array(ge);else if(!Array.isArray(ge)&&(!h||!ArrayBuffer.isView(ge)))throw new Error(t)}else throw new Error(t);me=!0}for(var ze=this.blocks,tt=this.byteCount,rt=ge.length,vt=this.blockCount,Ye=0,Pe=this.s,Be,$e;Ye<rt;){if(this.reset)for(this.reset=!1,ze[0]=this.block,Be=1;Be<vt+1;++Be)ze[Be]=0;if(me)for(Be=this.start;Ye<rt&&Be<tt;++Ye)ze[Be>>2]|=ge[Ye]<<_[Be++&3];else for(Be=this.start;Ye<rt&&Be<tt;++Ye)$e=ge.charCodeAt(Ye),$e<128?ze[Be>>2]|=$e<<_[Be++&3]:$e<2048?(ze[Be>>2]|=(192|$e>>6)<<_[Be++&3],ze[Be>>2]|=(128|$e&63)<<_[Be++&3]):$e<55296||$e>=57344?(ze[Be>>2]|=(224|$e>>12)<<_[Be++&3],ze[Be>>2]|=(128|$e>>6&63)<<_[Be++&3],ze[Be>>2]|=(128|$e&63)<<_[Be++&3]):($e=65536+(($e&1023)<<10|ge.charCodeAt(++Ye)&1023),ze[Be>>2]|=(240|$e>>18)<<_[Be++&3],ze[Be>>2]|=(128|$e>>12&63)<<_[Be++&3],ze[Be>>2]|=(128|$e>>6&63)<<_[Be++&3],ze[Be>>2]|=(128|$e&63)<<_[Be++&3]);if(this.lastByteIndex=Be,Be>=tt){for(this.start=Be-tt,this.block=ze[vt],Be=0;Be<vt;++Be)Pe[Be]^=ze[Be];Ke(Pe),this.reset=!0}else this.start=Be}return this},Y.prototype.encode=function(ge,me){var De=ge&255,ze=1,tt=[De];for(ge=ge>>8,De=ge&255;De>0;)tt.unshift(De),ge=ge>>8,De=ge&255,++ze;return me?tt.push(ze):tt.unshift(ze),this.update(tt),tt.length},Y.prototype.encodeString=function(ge){var me,De=typeof ge;if(De!=="string"){if(De==="object"){if(ge===null)throw new Error(t);if(h&&ge.constructor===ArrayBuffer)ge=new Uint8Array(ge);else if(!Array.isArray(ge)&&(!h||!ArrayBuffer.isView(ge)))throw new Error(t)}else throw new Error(t);me=!0}var ze=0,tt=ge.length;if(me)ze=tt;else for(var rt=0;rt<ge.length;++rt){var vt=ge.charCodeAt(rt);vt<128?ze+=1:vt<2048?ze+=2:vt<55296||vt>=57344?ze+=3:(vt=65536+((vt&1023)<<10|ge.charCodeAt(++rt)&1023),ze+=4)}return ze+=this.encode(ze*8),this.update(ge),ze},Y.prototype.bytepad=function(ge,me){for(var De=this.encode(me),ze=0;ze<ge.length;++ze)De+=this.encodeString(ge[ze]);var tt=me-De%me,rt=[];return rt.length=tt,this.update(rt),this},Y.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var ge=this.blocks,me=this.lastByteIndex,De=this.blockCount,ze=this.s;if(ge[me>>2]|=this.padding[me&3],this.lastByteIndex===this.byteCount)for(ge[0]=ge[De],me=1;me<De+1;++me)ge[me]=0;for(ge[De-1]|=2147483648,me=0;me<De;++me)ze[me]^=ge[me];Ke(ze)}},Y.prototype.toString=Y.prototype.hex=function(){this.finalize();for(var ge=this.blockCount,me=this.s,De=this.outputBlocks,ze=this.extraBytes,tt=0,rt=0,vt="",Ye;rt<De;){for(tt=0;tt<ge&&rt<De;++tt,++rt)Ye=me[tt],vt+=f[Ye>>4&15]+f[Ye&15]+f[Ye>>12&15]+f[Ye>>8&15]+f[Ye>>20&15]+f[Ye>>16&15]+f[Ye>>28&15]+f[Ye>>24&15];rt%ge===0&&(Ke(me),tt=0)}return ze&&(Ye=me[tt],vt+=f[Ye>>4&15]+f[Ye&15],ze>1&&(vt+=f[Ye>>12&15]+f[Ye>>8&15]),ze>2&&(vt+=f[Ye>>20&15]+f[Ye>>16&15])),vt},Y.prototype.arrayBuffer=function(){this.finalize();var ge=this.blockCount,me=this.s,De=this.outputBlocks,ze=this.extraBytes,tt=0,rt=0,vt=this.outputBits>>3,Ye;ze?Ye=new ArrayBuffer(De+1<<2):Ye=new ArrayBuffer(vt);for(var Pe=new Uint32Array(Ye);rt<De;){for(tt=0;tt<ge&&rt<De;++tt,++rt)Pe[rt]=me[tt];rt%ge===0&&Ke(me)}return ze&&(Pe[tt]=me[tt],Ye=Ye.slice(0,vt)),Ye},Y.prototype.buffer=Y.prototype.arrayBuffer,Y.prototype.digest=Y.prototype.array=function(){this.finalize();for(var ge=this.blockCount,me=this.s,De=this.outputBlocks,ze=this.extraBytes,tt=0,rt=0,vt=[],Ye,Pe;rt<De;){for(tt=0;tt<ge&&rt<De;++tt,++rt)Ye=rt<<2,Pe=me[tt],vt[Ye]=Pe&255,vt[Ye+1]=Pe>>8&255,vt[Ye+2]=Pe>>16&255,vt[Ye+3]=Pe>>24&255;rt%ge===0&&Ke(me)}return ze&&(Ye=rt<<2,Pe=me[tt],vt[Ye]=Pe&255,ze>1&&(vt[Ye+1]=Pe>>8&255),ze>2&&(vt[Ye+2]=Pe>>16&255)),vt};function we(ge,me,De){Y.call(this,ge,me,De)}we.prototype=new Y,we.prototype.finalize=function(){return this.encode(this.outputBits,!0),Y.prototype.finalize.call(this)};var Ke=function(ge){var me,De,ze,tt,rt,vt,Ye,Pe,Be,$e,Je,We,_e,Ee,Oe,Le,ce,he,ie,V,Z,B,S,R,X,xe,Ie,ye,nt,at,mt,wt,Lt,Ct,ut,St,Tt,gn,An,un,Mn,Cn,wn,zn,ai,xn,Zn,Me,le,be,q,Se,Ge,lt,dt,Re,Ue,Xe,ft,it,xt,Dt,Kt;for(ze=0;ze<48;ze+=2)tt=ge[0]^ge[10]^ge[20]^ge[30]^ge[40],rt=ge[1]^ge[11]^ge[21]^ge[31]^ge[41],vt=ge[2]^ge[12]^ge[22]^ge[32]^ge[42],Ye=ge[3]^ge[13]^ge[23]^ge[33]^ge[43],Pe=ge[4]^ge[14]^ge[24]^ge[34]^ge[44],Be=ge[5]^ge[15]^ge[25]^ge[35]^ge[45],$e=ge[6]^ge[16]^ge[26]^ge[36]^ge[46],Je=ge[7]^ge[17]^ge[27]^ge[37]^ge[47],We=ge[8]^ge[18]^ge[28]^ge[38]^ge[48],_e=ge[9]^ge[19]^ge[29]^ge[39]^ge[49],me=We^(vt<<1|Ye>>>31),De=_e^(Ye<<1|vt>>>31),ge[0]^=me,ge[1]^=De,ge[10]^=me,ge[11]^=De,ge[20]^=me,ge[21]^=De,ge[30]^=me,ge[31]^=De,ge[40]^=me,ge[41]^=De,me=tt^(Pe<<1|Be>>>31),De=rt^(Be<<1|Pe>>>31),ge[2]^=me,ge[3]^=De,ge[12]^=me,ge[13]^=De,ge[22]^=me,ge[23]^=De,ge[32]^=me,ge[33]^=De,ge[42]^=me,ge[43]^=De,me=vt^($e<<1|Je>>>31),De=Ye^(Je<<1|$e>>>31),ge[4]^=me,ge[5]^=De,ge[14]^=me,ge[15]^=De,ge[24]^=me,ge[25]^=De,ge[34]^=me,ge[35]^=De,ge[44]^=me,ge[45]^=De,me=Pe^(We<<1|_e>>>31),De=Be^(_e<<1|We>>>31),ge[6]^=me,ge[7]^=De,ge[16]^=me,ge[17]^=De,ge[26]^=me,ge[27]^=De,ge[36]^=me,ge[37]^=De,ge[46]^=me,ge[47]^=De,me=$e^(tt<<1|rt>>>31),De=Je^(rt<<1|tt>>>31),ge[8]^=me,ge[9]^=De,ge[18]^=me,ge[19]^=De,ge[28]^=me,ge[29]^=De,ge[38]^=me,ge[39]^=De,ge[48]^=me,ge[49]^=De,Ee=ge[0],Oe=ge[1],xn=ge[11]<<4|ge[10]>>>28,Zn=ge[10]<<4|ge[11]>>>28,ye=ge[20]<<3|ge[21]>>>29,nt=ge[21]<<3|ge[20]>>>29,it=ge[31]<<9|ge[30]>>>23,xt=ge[30]<<9|ge[31]>>>23,Cn=ge[40]<<18|ge[41]>>>14,wn=ge[41]<<18|ge[40]>>>14,Ct=ge[2]<<1|ge[3]>>>31,ut=ge[3]<<1|ge[2]>>>31,Le=ge[13]<<12|ge[12]>>>20,ce=ge[12]<<12|ge[13]>>>20,Me=ge[22]<<10|ge[23]>>>22,le=ge[23]<<10|ge[22]>>>22,at=ge[33]<<13|ge[32]>>>19,mt=ge[32]<<13|ge[33]>>>19,Dt=ge[42]<<2|ge[43]>>>30,Kt=ge[43]<<2|ge[42]>>>30,lt=ge[5]<<30|ge[4]>>>2,dt=ge[4]<<30|ge[5]>>>2,St=ge[14]<<6|ge[15]>>>26,Tt=ge[15]<<6|ge[14]>>>26,he=ge[25]<<11|ge[24]>>>21,ie=ge[24]<<11|ge[25]>>>21,be=ge[34]<<15|ge[35]>>>17,q=ge[35]<<15|ge[34]>>>17,wt=ge[45]<<29|ge[44]>>>3,Lt=ge[44]<<29|ge[45]>>>3,R=ge[6]<<28|ge[7]>>>4,X=ge[7]<<28|ge[6]>>>4,Re=ge[17]<<23|ge[16]>>>9,Ue=ge[16]<<23|ge[17]>>>9,gn=ge[26]<<25|ge[27]>>>7,An=ge[27]<<25|ge[26]>>>7,V=ge[36]<<21|ge[37]>>>11,Z=ge[37]<<21|ge[36]>>>11,Se=ge[47]<<24|ge[46]>>>8,Ge=ge[46]<<24|ge[47]>>>8,zn=ge[8]<<27|ge[9]>>>5,ai=ge[9]<<27|ge[8]>>>5,xe=ge[18]<<20|ge[19]>>>12,Ie=ge[19]<<20|ge[18]>>>12,Xe=ge[29]<<7|ge[28]>>>25,ft=ge[28]<<7|ge[29]>>>25,un=ge[38]<<8|ge[39]>>>24,Mn=ge[39]<<8|ge[38]>>>24,B=ge[48]<<14|ge[49]>>>18,S=ge[49]<<14|ge[48]>>>18,ge[0]=Ee^~Le&he,ge[1]=Oe^~ce&ie,ge[10]=R^~xe&ye,ge[11]=X^~Ie&nt,ge[20]=Ct^~St&gn,ge[21]=ut^~Tt&An,ge[30]=zn^~xn&Me,ge[31]=ai^~Zn&le,ge[40]=lt^~Re&Xe,ge[41]=dt^~Ue&ft,ge[2]=Le^~he&V,ge[3]=ce^~ie&Z,ge[12]=xe^~ye&at,ge[13]=Ie^~nt&mt,ge[22]=St^~gn&un,ge[23]=Tt^~An&Mn,ge[32]=xn^~Me&be,ge[33]=Zn^~le&q,ge[42]=Re^~Xe&it,ge[43]=Ue^~ft&xt,ge[4]=he^~V&B,ge[5]=ie^~Z&S,ge[14]=ye^~at&wt,ge[15]=nt^~mt&Lt,ge[24]=gn^~un&Cn,ge[25]=An^~Mn&wn,ge[34]=Me^~be&Se,ge[35]=le^~q&Ge,ge[44]=Xe^~it&Dt,ge[45]=ft^~xt&Kt,ge[6]=V^~B&Ee,ge[7]=Z^~S&Oe,ge[16]=at^~wt&R,ge[17]=mt^~Lt&X,ge[26]=un^~Cn&Ct,ge[27]=Mn^~wn&ut,ge[36]=be^~Se&zn,ge[37]=q^~Ge&ai,ge[46]=it^~Dt&lt,ge[47]=xt^~Kt&dt,ge[8]=B^~Ee&Le,ge[9]=S^~Oe&ce,ge[18]=wt^~R&xe,ge[19]=Lt^~X&Ie,ge[28]=Cn^~Ct&St,ge[29]=wn^~ut&Tt,ge[38]=Se^~zn&xn,ge[39]=Ge^~ai&Zn,ge[48]=Dt^~lt&Re,ge[49]=Kt^~dt&Ue,ge[0]^=x[ze],ge[1]^=x[ze+1]};if(u)a.exports=M;else for(U=0;U<I.length;++U)o[I[U]]=M[I[U]]})()})(cY);const uY=a=>Dr.Buffer.isBuffer(a)?a:a instanceof Uint8Array?Dr.Buffer.from(a.buffer,a.byteOffset,a.byteLength):Dr.Buffer.from(a);var GP={},Gi={},Xm=VP;function VP(a,t){if(!a)throw new Error(t||"Assertion failed")}VP.equal=function(t,n,i){if(t!=n)throw new Error(i||"Assertion failed: "+t+" != "+n)};var Zb={exports:{}};typeof Object.create=="function"?Zb.exports=function(t,n){n&&(t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:Zb.exports=function(t,n){if(n){t.super_=n;var i=function(){};i.prototype=n.prototype,t.prototype=new i,t.prototype.constructor=t}};var hY=Xm,fY=Zb.exports;Gi.inherits=fY;function dY(a,t){return(a.charCodeAt(t)&64512)!==55296||t<0||t+1>=a.length?!1:(a.charCodeAt(t+1)&64512)===56320}function pY(a,t){if(Array.isArray(a))return a.slice();if(!a)return[];var n=[];if(typeof a=="string")if(t){if(t==="hex")for(a=a.replace(/[^a-z0-9]+/ig,""),a.length%2!==0&&(a="0"+a),o=0;o<a.length;o+=2)n.push(parseInt(a[o]+a[o+1],16))}else for(var i=0,o=0;o<a.length;o++){var s=a.charCodeAt(o);s<128?n[i++]=s:s<2048?(n[i++]=s>>6|192,n[i++]=s&63|128):dY(a,o)?(s=65536+((s&1023)<<10)+(a.charCodeAt(++o)&1023),n[i++]=s>>18|240,n[i++]=s>>12&63|128,n[i++]=s>>6&63|128,n[i++]=s&63|128):(n[i++]=s>>12|224,n[i++]=s>>6&63|128,n[i++]=s&63|128)}else for(o=0;o<a.length;o++)n[o]=a[o]|0;return n}Gi.toArray=pY;function mY(a){for(var t="",n=0;n<a.length;n++)t+=jP(a[n].toString(16));return t}Gi.toHex=mY;function WP(a){var t=a>>>24|a>>>8&65280|a<<8&16711680|(a&255)<<24;return t>>>0}Gi.htonl=WP;function gY(a,t){for(var n="",i=0;i<a.length;i++){var o=a[i];t==="little"&&(o=WP(o)),n+=XP(o.toString(16))}return n}Gi.toHex32=gY;function jP(a){return a.length===1?"0"+a:a}Gi.zero2=jP;function XP(a){return a.length===7?"0"+a:a.length===6?"00"+a:a.length===5?"000"+a:a.length===4?"0000"+a:a.length===3?"00000"+a:a.length===2?"000000"+a:a.length===1?"0000000"+a:a}Gi.zero8=XP;function vY(a,t,n,i){var o=n-t;hY(o%4===0);for(var s=new Array(o/4),c=0,u=t;c<s.length;c++,u+=4){var h;i==="big"?h=a[u]<<24|a[u+1]<<16|a[u+2]<<8|a[u+3]:h=a[u+3]<<24|a[u+2]<<16|a[u+1]<<8|a[u],s[c]=h>>>0}return s}Gi.join32=vY;function yY(a,t){for(var n=new Array(a.length*4),i=0,o=0;i<a.length;i++,o+=4){var s=a[i];t==="big"?(n[o]=s>>>24,n[o+1]=s>>>16&255,n[o+2]=s>>>8&255,n[o+3]=s&255):(n[o+3]=s>>>24,n[o+2]=s>>>16&255,n[o+1]=s>>>8&255,n[o]=s&255)}return n}Gi.split32=yY;function xY(a,t){return a>>>t|a<<32-t}Gi.rotr32=xY;function AY(a,t){return a<<t|a>>>32-t}Gi.rotl32=AY;function bY(a,t){return a+t>>>0}Gi.sum32=bY;function _Y(a,t,n){return a+t+n>>>0}Gi.sum32_3=_Y;function wY(a,t,n,i){return a+t+n+i>>>0}Gi.sum32_4=wY;function EY(a,t,n,i,o){return a+t+n+i+o>>>0}Gi.sum32_5=EY;function MY(a,t,n,i){var o=a[t],s=a[t+1],c=i+s>>>0,u=(c<i?1:0)+n+o;a[t]=u>>>0,a[t+1]=c}Gi.sum64=MY;function SY(a,t,n,i){var o=t+i>>>0,s=(o<t?1:0)+a+n;return s>>>0}Gi.sum64_hi=SY;function TY(a,t,n,i){var o=t+i;return o>>>0}Gi.sum64_lo=TY;function CY(a,t,n,i,o,s,c,u){var h=0,f=t;f=f+i>>>0,h+=f<t?1:0,f=f+s>>>0,h+=f<s?1:0,f=f+u>>>0,h+=f<u?1:0;var p=a+n+o+c+h;return p>>>0}Gi.sum64_4_hi=CY;function RY(a,t,n,i,o,s,c,u){var h=t+i+s+u;return h>>>0}Gi.sum64_4_lo=RY;function LY(a,t,n,i,o,s,c,u,h,f){var p=0,m=t;m=m+i>>>0,p+=m<t?1:0,m=m+s>>>0,p+=m<s?1:0,m=m+u>>>0,p+=m<u?1:0,m=m+f>>>0,p+=m<f?1:0;var y=a+n+o+c+h+p;return y>>>0}Gi.sum64_5_hi=LY;function PY(a,t,n,i,o,s,c,u,h,f){var p=t+i+s+u+f;return p>>>0}Gi.sum64_5_lo=PY;function IY(a,t,n){var i=t<<32-n|a>>>n;return i>>>0}Gi.rotr64_hi=IY;function OY(a,t,n){var i=a<<32-n|t>>>n;return i>>>0}Gi.rotr64_lo=OY;function DY(a,t,n){return a>>>n}Gi.shr64_hi=DY;function BY(a,t,n){var i=a<<32-n|t>>>n;return i>>>0}Gi.shr64_lo=BY;var Yd={},Y3=Gi,FY=Xm;function t1(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}Yd.BlockHash=t1;t1.prototype.update=function(t,n){if(t=Y3.toArray(t,n),this.pending?this.pending=this.pending.concat(t):this.pending=t,this.pendingTotal+=t.length,this.pending.length>=this._delta8){t=this.pending;var i=t.length%this._delta8;this.pending=t.slice(t.length-i,t.length),this.pending.length===0&&(this.pending=null),t=Y3.join32(t,0,t.length-i,this.endian);for(var o=0;o<t.length;o+=this._delta32)this._update(t,o,o+this._delta32)}return this};t1.prototype.digest=function(t){return this.update(this._pad()),FY(this.pending===null),this._digest(t)};t1.prototype._pad=function(){var t=this.pendingTotal,n=this._delta8,i=n-(t+this.padLength)%n,o=new Array(i+this.padLength);o[0]=128;for(var s=1;s<i;s++)o[s]=0;if(t<<=3,this.endian==="big"){for(var c=8;c<this.padLength;c++)o[s++]=0;o[s++]=0,o[s++]=0,o[s++]=0,o[s++]=0,o[s++]=t>>>24&255,o[s++]=t>>>16&255,o[s++]=t>>>8&255,o[s++]=t&255}else for(o[s++]=t&255,o[s++]=t>>>8&255,o[s++]=t>>>16&255,o[s++]=t>>>24&255,o[s++]=0,o[s++]=0,o[s++]=0,o[s++]=0,c=8;c<this.padLength;c++)o[s++]=0;return o};var Qd={},ul={},NY=Gi,ja=NY.rotr32;function UY(a,t,n,i){if(a===0)return $P(t,n,i);if(a===1||a===3)return YP(t,n,i);if(a===2)return qP(t,n,i)}ul.ft_1=UY;function $P(a,t,n){return a&t^~a&n}ul.ch32=$P;function qP(a,t,n){return a&t^a&n^t&n}ul.maj32=qP;function YP(a,t,n){return a^t^n}ul.p32=YP;function kY(a){return ja(a,2)^ja(a,13)^ja(a,22)}ul.s0_256=kY;function zY(a){return ja(a,6)^ja(a,11)^ja(a,25)}ul.s1_256=zY;function HY(a){return ja(a,7)^ja(a,18)^a>>>3}ul.g0_256=HY;function GY(a){return ja(a,17)^ja(a,19)^a>>>10}ul.g1_256=GY;var Ld=Gi,VY=Yd,WY=ul,NA=Ld.rotl32,Vp=Ld.sum32,jY=Ld.sum32_5,XY=WY.ft_1,QP=VY.BlockHash,$Y=[1518500249,1859775393,2400959708,3395469782];function el(){if(!(this instanceof el))return new el;QP.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}Ld.inherits(el,QP);var qY=el;el.blockSize=512;el.outSize=160;el.hmacStrength=80;el.padLength=64;el.prototype._update=function(t,n){for(var i=this.W,o=0;o<16;o++)i[o]=t[n+o];for(;o<i.length;o++)i[o]=NA(i[o-3]^i[o-8]^i[o-14]^i[o-16],1);var s=this.h[0],c=this.h[1],u=this.h[2],h=this.h[3],f=this.h[4];for(o=0;o<i.length;o++){var p=~~(o/20),m=jY(NA(s,5),XY(p,c,u,h),f,i[o],$Y[p]);f=h,h=u,u=NA(c,30),c=s,s=m}this.h[0]=Vp(this.h[0],s),this.h[1]=Vp(this.h[1],c),this.h[2]=Vp(this.h[2],u),this.h[3]=Vp(this.h[3],h),this.h[4]=Vp(this.h[4],f)};el.prototype._digest=function(t){return t==="hex"?Ld.toHex32(this.h,"big"):Ld.split32(this.h,"big")};var Pd=Gi,YY=Yd,Kd=ul,QY=Xm,ra=Pd.sum32,KY=Pd.sum32_4,ZY=Pd.sum32_5,JY=Kd.ch32,eQ=Kd.maj32,tQ=Kd.s0_256,nQ=Kd.s1_256,iQ=Kd.g0_256,rQ=Kd.g1_256,KP=YY.BlockHash,sQ=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function tl(){if(!(this instanceof tl))return new tl;KP.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=sQ,this.W=new Array(64)}Pd.inherits(tl,KP);var ZP=tl;tl.blockSize=512;tl.outSize=256;tl.hmacStrength=192;tl.padLength=64;tl.prototype._update=function(t,n){for(var i=this.W,o=0;o<16;o++)i[o]=t[n+o];for(;o<i.length;o++)i[o]=KY(rQ(i[o-2]),i[o-7],iQ(i[o-15]),i[o-16]);var s=this.h[0],c=this.h[1],u=this.h[2],h=this.h[3],f=this.h[4],p=this.h[5],m=this.h[6],y=this.h[7];for(QY(this.k.length===i.length),o=0;o<i.length;o++){var g=ZY(y,nQ(f),JY(f,p,m),this.k[o],i[o]),_=ra(tQ(s),eQ(s,c,u));y=m,m=p,p=f,f=ra(h,g),h=u,u=c,c=s,s=ra(g,_)}this.h[0]=ra(this.h[0],s),this.h[1]=ra(this.h[1],c),this.h[2]=ra(this.h[2],u),this.h[3]=ra(this.h[3],h),this.h[4]=ra(this.h[4],f),this.h[5]=ra(this.h[5],p),this.h[6]=ra(this.h[6],m),this.h[7]=ra(this.h[7],y)};tl.prototype._digest=function(t){return t==="hex"?Pd.toHex32(this.h,"big"):Pd.split32(this.h,"big")};var Jb=Gi,JP=ZP;function jl(){if(!(this instanceof jl))return new jl;JP.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}Jb.inherits(jl,JP);var oQ=jl;jl.blockSize=512;jl.outSize=224;jl.hmacStrength=192;jl.padLength=64;jl.prototype._digest=function(t){return t==="hex"?Jb.toHex32(this.h.slice(0,7),"big"):Jb.split32(this.h.slice(0,7),"big")};var uo=Gi,aQ=Yd,lQ=Xm,Xa=uo.rotr64_hi,$a=uo.rotr64_lo,eI=uo.shr64_hi,tI=uo.shr64_lo,bc=uo.sum64,UA=uo.sum64_hi,kA=uo.sum64_lo,cQ=uo.sum64_4_hi,uQ=uo.sum64_4_lo,hQ=uo.sum64_5_hi,fQ=uo.sum64_5_lo,nI=aQ.BlockHash,dQ=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function ya(){if(!(this instanceof ya))return new ya;nI.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=dQ,this.W=new Array(160)}uo.inherits(ya,nI);var iI=ya;ya.blockSize=1024;ya.outSize=512;ya.hmacStrength=192;ya.padLength=128;ya.prototype._prepareBlock=function(t,n){for(var i=this.W,o=0;o<32;o++)i[o]=t[n+o];for(;o<i.length;o+=2){var s=EQ(i[o-4],i[o-3]),c=MQ(i[o-4],i[o-3]),u=i[o-14],h=i[o-13],f=_Q(i[o-30],i[o-29]),p=wQ(i[o-30],i[o-29]),m=i[o-32],y=i[o-31];i[o]=cQ(s,c,u,h,f,p,m,y),i[o+1]=uQ(s,c,u,h,f,p,m,y)}};ya.prototype._update=function(t,n){this._prepareBlock(t,n);var i=this.W,o=this.h[0],s=this.h[1],c=this.h[2],u=this.h[3],h=this.h[4],f=this.h[5],p=this.h[6],m=this.h[7],y=this.h[8],g=this.h[9],_=this.h[10],x=this.h[11],b=this.h[12],E=this.h[13],T=this.h[14],P=this.h[15];lQ(this.k.length===i.length);for(var D=0;D<i.length;D+=2){var F=T,k=P,W=AQ(y,g),j=bQ(y,g),J=pQ(y,g,_,x,b),de=mQ(y,g,_,x,b,E),te=this.k[D],N=this.k[D+1],L=i[D],M=i[D+1],I=hQ(F,k,W,j,J,de,te,N,L,M),U=fQ(F,k,W,j,J,de,te,N,L,M);F=yQ(o,s),k=xQ(o,s),W=gQ(o,s,c,u,h),j=vQ(o,s,c,u,h,f);var $=UA(F,k,W,j),ee=kA(F,k,W,j);T=b,P=E,b=_,E=x,_=y,x=g,y=UA(p,m,I,U),g=kA(m,m,I,U),p=h,m=f,h=c,f=u,c=o,u=s,o=UA(I,U,$,ee),s=kA(I,U,$,ee)}bc(this.h,0,o,s),bc(this.h,2,c,u),bc(this.h,4,h,f),bc(this.h,6,p,m),bc(this.h,8,y,g),bc(this.h,10,_,x),bc(this.h,12,b,E),bc(this.h,14,T,P)};ya.prototype._digest=function(t){return t==="hex"?uo.toHex32(this.h,"big"):uo.split32(this.h,"big")};function pQ(a,t,n,i,o){var s=a&n^~a&o;return s<0&&(s+=4294967296),s}function mQ(a,t,n,i,o,s){var c=t&i^~t&s;return c<0&&(c+=4294967296),c}function gQ(a,t,n,i,o){var s=a&n^a&o^n&o;return s<0&&(s+=4294967296),s}function vQ(a,t,n,i,o,s){var c=t&i^t&s^i&s;return c<0&&(c+=4294967296),c}function yQ(a,t){var n=Xa(a,t,28),i=Xa(t,a,2),o=Xa(t,a,7),s=n^i^o;return s<0&&(s+=4294967296),s}function xQ(a,t){var n=$a(a,t,28),i=$a(t,a,2),o=$a(t,a,7),s=n^i^o;return s<0&&(s+=4294967296),s}function AQ(a,t){var n=Xa(a,t,14),i=Xa(a,t,18),o=Xa(t,a,9),s=n^i^o;return s<0&&(s+=4294967296),s}function bQ(a,t){var n=$a(a,t,14),i=$a(a,t,18),o=$a(t,a,9),s=n^i^o;return s<0&&(s+=4294967296),s}function _Q(a,t){var n=Xa(a,t,1),i=Xa(a,t,8),o=eI(a,t,7),s=n^i^o;return s<0&&(s+=4294967296),s}function wQ(a,t){var n=$a(a,t,1),i=$a(a,t,8),o=tI(a,t,7),s=n^i^o;return s<0&&(s+=4294967296),s}function EQ(a,t){var n=Xa(a,t,19),i=Xa(t,a,29),o=eI(a,t,6),s=n^i^o;return s<0&&(s+=4294967296),s}function MQ(a,t){var n=$a(a,t,19),i=$a(t,a,29),o=tI(a,t,6),s=n^i^o;return s<0&&(s+=4294967296),s}var e_=Gi,rI=iI;function Xl(){if(!(this instanceof Xl))return new Xl;rI.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}e_.inherits(Xl,rI);var SQ=Xl;Xl.blockSize=1024;Xl.outSize=384;Xl.hmacStrength=192;Xl.padLength=128;Xl.prototype._digest=function(t){return t==="hex"?e_.toHex32(this.h.slice(0,12),"big"):e_.split32(this.h.slice(0,12),"big")};Qd.sha1=qY;Qd.sha224=oQ;Qd.sha256=ZP;Qd.sha384=SQ;Qd.sha512=iI;var sI={},bh=Gi,TQ=Yd,cv=bh.rotl32,Q3=bh.sum32,Wp=bh.sum32_3,K3=bh.sum32_4,oI=TQ.BlockHash;function nl(){if(!(this instanceof nl))return new nl;oI.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}bh.inherits(nl,oI);sI.ripemd160=nl;nl.blockSize=512;nl.outSize=160;nl.hmacStrength=192;nl.padLength=64;nl.prototype._update=function(t,n){for(var i=this.h[0],o=this.h[1],s=this.h[2],c=this.h[3],u=this.h[4],h=i,f=o,p=s,m=c,y=u,g=0;g<80;g++){var _=Q3(cv(K3(i,Z3(g,o,s,c),t[LQ[g]+n],CQ(g)),IQ[g]),u);i=u,u=c,c=cv(s,10),s=o,o=_,_=Q3(cv(K3(h,Z3(79-g,f,p,m),t[PQ[g]+n],RQ(g)),OQ[g]),y),h=y,y=m,m=cv(p,10),p=f,f=_}_=Wp(this.h[1],s,m),this.h[1]=Wp(this.h[2],c,y),this.h[2]=Wp(this.h[3],u,h),this.h[3]=Wp(this.h[4],i,f),this.h[4]=Wp(this.h[0],o,p),this.h[0]=_};nl.prototype._digest=function(t){return t==="hex"?bh.toHex32(this.h,"little"):bh.split32(this.h,"little")};function Z3(a,t,n,i){return a<=15?t^n^i:a<=31?t&n|~t&i:a<=47?(t|~n)^i:a<=63?t&i|n&~i:t^(n|~i)}function CQ(a){return a<=15?0:a<=31?1518500249:a<=47?1859775393:a<=63?2400959708:2840853838}function RQ(a){return a<=15?1352829926:a<=31?1548603684:a<=47?1836072691:a<=63?2053994217:0}var LQ=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],PQ=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],IQ=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],OQ=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],DQ=Gi,BQ=Xm;function Id(a,t,n){if(!(this instanceof Id))return new Id(a,t,n);this.Hash=a,this.blockSize=a.blockSize/8,this.outSize=a.outSize/8,this.inner=null,this.outer=null,this._init(DQ.toArray(t,n))}var FQ=Id;Id.prototype._init=function(t){t.length>this.blockSize&&(t=new this.Hash().update(t).digest()),BQ(t.length<=this.blockSize);for(var n=t.length;n<this.blockSize;n++)t.push(0);for(n=0;n<t.length;n++)t[n]^=54;for(this.inner=new this.Hash().update(t),n=0;n<t.length;n++)t[n]^=106;this.outer=new this.Hash().update(t)};Id.prototype.update=function(t,n){return this.inner.update(t,n),this};Id.prototype.digest=function(t){return this.outer.update(this.inner.digest()),this.outer.digest(t)};(function(a){var t=a;t.utils=Gi,t.common=Yd,t.sha=Qd,t.ripemd=sI,t.hmac=FQ,t.sha1=t.sha.sha1,t.sha256=t.sha.sha256,t.sha224=t.sha.sha224,t.sha384=t.sha.sha384,t.sha512=t.sha.sha512,t.ripemd160=t.ripemd.ripemd160})(GP);var NQ=GP;const UQ="logger/5.6.0";let J3=!1,eT=!1;const wv={debug:1,default:2,info:2,warning:3,error:4,off:5};let tT=wv.default,zA=null;function kQ(){try{const a=[];if(["NFD","NFC","NFKD","NFKC"].forEach(t=>{try{if("test".normalize(t)!=="test")throw new Error("bad normalize")}catch{a.push(t)}}),a.length)throw new Error("missing "+a.join(", "));if(String.fromCharCode(233).normalize("NFD")!==String.fromCharCode(101,769))throw new Error("broken implementation")}catch(a){return a.message}return null}const nT=kQ();var t_;(function(a){a.DEBUG="DEBUG",a.INFO="INFO",a.WARNING="WARNING",a.ERROR="ERROR",a.OFF="OFF"})(t_||(t_={}));var aa;(function(a){a.UNKNOWN_ERROR="UNKNOWN_ERROR",a.NOT_IMPLEMENTED="NOT_IMPLEMENTED",a.UNSUPPORTED_OPERATION="UNSUPPORTED_OPERATION",a.NETWORK_ERROR="NETWORK_ERROR",a.SERVER_ERROR="SERVER_ERROR",a.TIMEOUT="TIMEOUT",a.BUFFER_OVERRUN="BUFFER_OVERRUN",a.NUMERIC_FAULT="NUMERIC_FAULT",a.MISSING_NEW="MISSING_NEW",a.INVALID_ARGUMENT="INVALID_ARGUMENT",a.MISSING_ARGUMENT="MISSING_ARGUMENT",a.UNEXPECTED_ARGUMENT="UNEXPECTED_ARGUMENT",a.CALL_EXCEPTION="CALL_EXCEPTION",a.INSUFFICIENT_FUNDS="INSUFFICIENT_FUNDS",a.NONCE_EXPIRED="NONCE_EXPIRED",a.REPLACEMENT_UNDERPRICED="REPLACEMENT_UNDERPRICED",a.UNPREDICTABLE_GAS_LIMIT="UNPREDICTABLE_GAS_LIMIT",a.TRANSACTION_REPLACED="TRANSACTION_REPLACED"})(aa||(aa={}));const iT="0123456789abcdef";class Sr{constructor(t){Object.defineProperty(this,"version",{enumerable:!0,value:t,writable:!1})}_log(t,n){const i=t.toLowerCase();wv[i]==null&&this.throwArgumentError("invalid log level name","logLevel",t),!(tT>wv[i])&&console.log.apply(console,n)}debug(...t){this._log(Sr.levels.DEBUG,t)}info(...t){this._log(Sr.levels.INFO,t)}warn(...t){this._log(Sr.levels.WARNING,t)}makeError(t,n,i){if(eT)return this.makeError("censored error",n,{});n||(n=Sr.errors.UNKNOWN_ERROR),i||(i={});const o=[];Object.keys(i).forEach(h=>{const f=i[h];try{if(f instanceof Uint8Array){let p="";for(let m=0;m<f.length;m++)p+=iT[f[m]>>4],p+=iT[f[m]&15];o.push(h+"=Uint8Array(0x"+p+")")}else o.push(h+"="+JSON.stringify(f))}catch{o.push(h+"="+JSON.stringify(i[h].toString()))}}),o.push(`code=${n}`),o.push(`version=${this.version}`);const s=t;let c="";switch(n){case aa.NUMERIC_FAULT:{c="NUMERIC_FAULT";const h=t;switch(h){case"overflow":case"underflow":case"division-by-zero":c+="-"+h;break;case"negative-power":case"negative-width":c+="-unsupported";break;case"unbound-bitwise-result":c+="-unbound-result";break}break}case aa.CALL_EXCEPTION:case aa.INSUFFICIENT_FUNDS:case aa.MISSING_NEW:case aa.NONCE_EXPIRED:case aa.REPLACEMENT_UNDERPRICED:case aa.TRANSACTION_REPLACED:case aa.UNPREDICTABLE_GAS_LIMIT:c=n;break}c&&(t+=" [ See: https://links.ethers.org/v5-errors-"+c+" ]"),o.length&&(t+=" ("+o.join(", ")+")");const u=new Error(t);return u.reason=s,u.code=n,Object.keys(i).forEach(function(h){u[h]=i[h]}),u}throwError(t,n,i){throw this.makeError(t,n,i)}throwArgumentError(t,n,i){return this.throwError(t,Sr.errors.INVALID_ARGUMENT,{argument:n,value:i})}assert(t,n,i,o){t||this.throwError(n,i,o)}assertArgument(t,n,i,o){t||this.throwArgumentError(n,i,o)}checkNormalize(t){nT&&this.throwError("platform missing String.prototype.normalize",Sr.errors.UNSUPPORTED_OPERATION,{operation:"String.prototype.normalize",form:nT})}checkSafeUint53(t,n){typeof t=="number"&&(n==null&&(n="value not safe"),(t<0||t>=9007199254740991)&&this.throwError(n,Sr.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"out-of-safe-range",value:t}),t%1&&this.throwError(n,Sr.errors.NUMERIC_FAULT,{operation:"checkSafeInteger",fault:"non-integer",value:t}))}checkArgumentCount(t,n,i){i?i=": "+i:i="",t<n&&this.throwError("missing argument"+i,Sr.errors.MISSING_ARGUMENT,{count:t,expectedCount:n}),t>n&&this.throwError("too many arguments"+i,Sr.errors.UNEXPECTED_ARGUMENT,{count:t,expectedCount:n})}checkNew(t,n){(t===Object||t==null)&&this.throwError("missing new",Sr.errors.MISSING_NEW,{name:n.name})}checkAbstract(t,n){t===n?this.throwError("cannot instantiate abstract class "+JSON.stringify(n.name)+" directly; use a sub-class",Sr.errors.UNSUPPORTED_OPERATION,{name:t.name,operation:"new"}):(t===Object||t==null)&&this.throwError("missing new",Sr.errors.MISSING_NEW,{name:n.name})}static globalLogger(){return zA||(zA=new Sr(UQ)),zA}static setCensorship(t,n){if(!t&&n&&this.globalLogger().throwError("cannot permanently disable censorship",Sr.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"}),J3){if(!t)return;this.globalLogger().throwError("error censorship permanent",Sr.errors.UNSUPPORTED_OPERATION,{operation:"setCensorship"})}eT=!!t,J3=!!n}static setLogLevel(t){const n=wv[t.toLowerCase()];if(n==null){Sr.globalLogger().warn("invalid log level - "+t);return}tT=n}static from(t){return new Sr(t)}}Sr.errors=aa;Sr.levels=t_;const zQ="bytes/5.6.0",HA=new Sr(zQ);function HQ(a){return!!a.toHexString}function Ev(a){return a.slice||(a.slice=function(){const t=Array.prototype.slice.call(arguments);return Ev(new Uint8Array(Array.prototype.slice.apply(a,t)))}),a}function rT(a){return typeof a=="number"&&a==a&&a%1===0}function GQ(a){if(a==null)return!1;if(a.constructor===Uint8Array)return!0;if(typeof a=="string"||!rT(a.length)||a.length<0)return!1;for(let t=0;t<a.length;t++){const n=a[t];if(!rT(n)||n<0||n>=256)return!1}return!0}function VQ(a,t){if(t||(t={}),typeof a=="number"){HA.checkSafeUint53(a,"invalid arrayify value");const n=[];for(;a;)n.unshift(a&255),a=parseInt(String(a/256));return n.length===0&&n.push(0),Ev(new Uint8Array(n))}if(t.allowMissingPrefix&&typeof a=="string"&&a.substring(0,2)!=="0x"&&(a="0x"+a),HQ(a)&&(a=a.toHexString()),WQ(a)){let n=a.substring(2);n.length%2&&(t.hexPad==="left"?n="0x0"+n.substring(2):t.hexPad==="right"?n+="0":HA.throwArgumentError("hex data is odd-length","value",a));const i=[];for(let o=0;o<n.length;o+=2)i.push(parseInt(n.substring(o,o+2),16));return Ev(new Uint8Array(i))}return GQ(a)?Ev(new Uint8Array(a)):HA.throwArgumentError("invalid arrayify value","value",a)}function WQ(a,t){return!(typeof a!="string"||!a.match(/^0x[0-9A-Fa-f]*$/)||t&&a.length!==2+2*t)}const jQ="sha2/5.6.0";new Sr(jQ);function sT(a){return"0x"+NQ.sha256().update(VQ(a)).digest("hex")}class XQ{constructor(t){Object.assign(this,t)}encode(){return Dr.Buffer.from(FL(Mv,this))}static decode(t){return NL(Mv,this,t)}static decodeUnchecked(t){return PL(Mv,this,t)}}const Mv=new Map,$Q=32;function qQ(a){return a._bn!==void 0}class rr extends XQ{constructor(t){if(super({}),this._bn=void 0,qQ(t))this._bn=t._bn;else{if(typeof t=="string"){const n=$b.decode(t);if(n.length!=32)throw new Error("Invalid public key input");this._bn=new _A(n)}else this._bn=new _A(t);if(this._bn.byteLength()>32)throw new Error("Invalid public key input")}}equals(t){return this._bn.eq(t._bn)}toBase58(){return $b.encode(this.toBytes())}toJSON(){return this.toBase58()}toBytes(){return this.toBuffer()}toBuffer(){const t=this._bn.toArrayLike(Dr.Buffer);if(t.length===32)return t;const n=Dr.Buffer.alloc(32);return t.copy(n,32-t.length),n}toString(){return this.toBase58()}static async createWithSeed(t,n,i){const o=Dr.Buffer.concat([t.toBuffer(),Dr.Buffer.from(n),i.toBuffer()]),s=sT(new Uint8Array(o)).slice(2);return new rr(Dr.Buffer.from(s,"hex"))}static createProgramAddressSync(t,n){let i=Dr.Buffer.alloc(0);t.forEach(function(c){if(c.length>$Q)throw new TypeError("Max seed length exceeded");i=Dr.Buffer.concat([i,uY(c)])}),i=Dr.Buffer.concat([i,n.toBuffer(),Dr.Buffer.from("ProgramDerivedAddress")]);let o=sT(new Uint8Array(i)).slice(2),s=new _A(o,16).toArray(void 0,32);if(oT(s))throw new Error("Invalid seeds, address must fall off the curve");return new rr(s)}static async createProgramAddress(t,n){return this.createProgramAddressSync(t,n)}static findProgramAddressSync(t,n){let i=255,o;for(;i!=0;){try{const s=t.concat(Dr.Buffer.from([i]));o=this.createProgramAddressSync(s,n)}catch(s){if(s instanceof TypeError)throw s;i--;continue}return[o,i]}throw new Error("Unable to find a viable program address nonce")}static async findProgramAddress(t,n){return this.findProgramAddressSync(t,n)}static isOnCurve(t){const n=new rr(t);return oT(n.toBytes())==1}}rr.default=new rr("11111111111111111111111111111111");Mv.set(rr,{kind:"struct",fields:[["_bn","u256"]]});let Ni=_j.lowlevel;function oT(a){var t=[Ni.gf(),Ni.gf(),Ni.gf(),Ni.gf()],n=Ni.gf(),i=Ni.gf(),o=Ni.gf(),s=Ni.gf(),c=Ni.gf(),u=Ni.gf(),h=Ni.gf();return Ni.set25519(t[2],YQ),Ni.unpack25519(t[1],a),Ni.S(o,t[1]),Ni.M(s,o,Ni.D),Ni.Z(o,o,t[2]),Ni.A(s,t[2],s),Ni.S(c,s),Ni.S(u,c),Ni.M(h,u,c),Ni.M(n,h,o),Ni.M(n,n,s),Ni.pow2523(n,n),Ni.M(n,n,o),Ni.M(n,n,s),Ni.M(n,n,s),Ni.M(t[0],n,s),Ni.S(i,t[0]),Ni.M(i,i,s),aT(i,o)&&Ni.M(t[0],t[0],QQ),Ni.S(i,t[0]),Ni.M(i,i,s),aT(i,o)?0:1}let YQ=Ni.gf([1]),QQ=Ni.gf([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function aT(a,t){var n=new Uint8Array(32),i=new Uint8Array(32);return Ni.pack25519(n,a),Ni.pack25519(i,t),Ni.crypto_verify_32(n,0,i,0)}new rr("BPFLoader1111111111111111111111111111111111");const KQ=64,dr=(a="publicKey")=>Ed(32,a),Qp=(a="string")=>{const t=Mi([Ri("length"),Ri("lengthPadding"),Ed(om(Ri(),-8),"chars")],a),n=t.decode.bind(t),i=t.encode.bind(t),o=t;return o.decode=(s,c)=>n(s,c).chars.toString(),o.encode=(s,c,u)=>{const h={chars:Dr.Buffer.from(s,"utf8")};return i(h,c,u)},o.alloc=s=>Ri().span+Ri().span+Dr.Buffer.from(s,"utf8").length,o},ZQ=(a="authorized")=>Mi([dr("staker"),dr("withdrawer")],a),JQ=(a="lockup")=>Mi([wo("unixTimestamp"),wo("epoch"),dr("custodian")],a),eK=(a="voteInit")=>Mi([dr("nodePubkey"),dr("authorizedVoter"),dr("authorizedWithdrawer"),Gs("commission")],a);let lT;(function(a){a[a.BLOCKHEIGHT_EXCEEDED=0]="BLOCKHEIGHT_EXCEEDED",a[a.PROCESSED=1]="PROCESSED",a[a.TIMED_OUT=2]="TIMED_OUT"})(lT||(lT={}));Dr.Buffer.alloc(KQ).fill(0);new rr("SysvarC1ock11111111111111111111111111111111");new rr("SysvarEpochSchedu1e111111111111111111111111");new rr("Sysvar1nstructions1111111111111111111111111");new rr("SysvarRecentB1ockHashes11111111111111111111");new rr("SysvarRent111111111111111111111111111111111");new rr("SysvarRewards111111111111111111111111111111");new rr("SysvarS1otHashes111111111111111111111111111");new rr("SysvarS1otHistory11111111111111111111111111");new rr("SysvarStakeHistory1111111111111111111111111");const tK=ks("lamportsPerSignature"),nK=Mi([Ri("version"),Ri("state"),dr("authorizedPubkey"),dr("nonce"),Mi([tK],"feeCalculator")]);nK.span;const iK=a=>{const t=a.decode.bind(a),n=a.encode.bind(a);return{decode:t,encode:n}},rK=a=>t=>{const n=Ed(a,t),{encode:i,decode:o}=iK(n),s=n;return s.decode=(c,u)=>{const h=o(c,u);return eX(Dr.Buffer.from(h))},s.encode=(c,u,h)=>{const f=iX(c,a);return i(f,u,h)},s},n_=rK(8);Object.freeze({Create:{index:0,layout:Mi([Ri("instruction"),wo("lamports"),wo("space"),dr("programId")])},Assign:{index:1,layout:Mi([Ri("instruction"),dr("programId")])},Transfer:{index:2,layout:Mi([Ri("instruction"),n_("lamports")])},CreateWithSeed:{index:3,layout:Mi([Ri("instruction"),dr("base"),Qp("seed"),wo("lamports"),wo("space"),dr("programId")])},AdvanceNonceAccount:{index:4,layout:Mi([Ri("instruction")])},WithdrawNonceAccount:{index:5,layout:Mi([Ri("instruction"),wo("lamports")])},InitializeNonceAccount:{index:6,layout:Mi([Ri("instruction"),dr("authorized")])},AuthorizeNonceAccount:{index:7,layout:Mi([Ri("instruction"),dr("authorized")])},Allocate:{index:8,layout:Mi([Ri("instruction"),wo("space")])},AllocateWithSeed:{index:9,layout:Mi([Ri("instruction"),dr("base"),Qp("seed"),wo("space"),dr("programId")])},AssignWithSeed:{index:10,layout:Mi([Ri("instruction"),dr("base"),Qp("seed"),dr("programId")])},TransferWithSeed:{index:11,layout:Mi([Ri("instruction"),n_("lamports"),Qp("seed"),dr("programId")])},UpgradeNonceAccount:{index:12,layout:Mi([Ri("instruction")])}});new rr("11111111111111111111111111111111");new rr("BPFLoader2111111111111111111111111111111111");Object.freeze({RequestUnits:{index:0,layout:Mi([Gs("instruction"),Ri("units"),Ri("additionalFee")])},RequestHeapFrame:{index:1,layout:Mi([Gs("instruction"),Ri("bytes")])},SetComputeUnitLimit:{index:2,layout:Mi([Gs("instruction"),Ri("units")])},SetComputeUnitPrice:{index:3,layout:Mi([Gs("instruction"),n_("microLamports")])}});new rr("ComputeBudget111111111111111111111111111111");class sK extends Error{constructor(t){super(`Signature ${t} has expired: block height exceeded.`),this.signature=void 0,this.signature=t}}Object.defineProperty(sK.prototype,"name",{value:"TransactionExpiredBlockheightExceededError"});class oK extends Error{constructor(t,n){super(`Transaction was not confirmed in ${n.toFixed(2)} seconds. It is unknown if it succeeded or failed. Check signature ${t} using the Solana Explorer or CLI tools.`),this.signature=void 0,this.signature=t}}Object.defineProperty(oK.prototype,"name",{value:"TransactionExpiredTimeoutError"});const Ws=Vm(mw(rr),jn(),a=>new rr(a)),aI=iP([jn(),hs("base64")]),_w=Vm(mw(Dr.Buffer),aI,a=>Dr.Buffer.from(a[0],"base64"));function lI(a){return Vo([Sn({jsonrpc:hs("2.0"),id:jn(),result:a}),Sn({jsonrpc:hs("2.0"),id:jn(),error:Sn({code:Gm(),message:jn(),data:hr(hX())})})])}const aK=lI(Gm());function ss(a){return Vm(lI(a),aK,t=>"error"in t?t:Ef(wf({},t),{result:Lm(t.result,a)}))}function ba(a){return ss(Sn({context:Sn({slot:tn()}),value:a}))}function n1(a){return Sn({context:Sn({slot:tn()}),value:a})}const lK=Sn({foundation:tn(),foundationTerm:tn(),initial:tn(),taper:tn(),terminal:tn()});ss(gi(wi(Sn({epoch:tn(),effectiveSlot:tn(),amount:tn(),postBalance:tn()}))));const cK=Sn({epoch:tn(),slotIndex:tn(),slotsInEpoch:tn(),absoluteSlot:tn(),blockHeight:hr(tn()),transactionCount:hr(tn())}),uK=Sn({slotsPerEpoch:tn(),leaderScheduleSlotOffset:tn(),warmup:Gl(),firstNormalEpoch:tn(),firstNormalSlot:tn()}),hK=nP(jn(),gi(tn())),Oh=wi(Vo([Sn({}),jn()])),fK=Sn({err:Oh}),dK=hs("receivedSignature");Sn({"solana-core":jn(),"feature-set":hr(tn())});ba(Sn({err:wi(Vo([Sn({}),jn()])),logs:wi(gi(jn())),accounts:hr(wi(gi(wi(Sn({executable:Gl(),owner:jn(),lamports:tn(),data:gi(jn()),rentEpoch:hr(tn())}))))),unitsConsumed:hr(tn())}));ba(Sn({byIdentity:nP(jn(),gi(tn())),range:Sn({firstSlot:tn(),lastSlot:tn()})}));ss(lK);ss(cK);ss(uK);ss(hK);ss(tn());ba(Sn({total:tn(),circulating:tn(),nonCirculating:tn(),nonCirculatingAccounts:gi(Ws)}));const pK=Sn({amount:jn(),uiAmount:wi(tn()),decimals:tn(),uiAmountString:hr(jn())});ba(gi(Sn({address:Ws,amount:jn(),uiAmount:wi(tn()),decimals:tn(),uiAmountString:hr(jn())})));ba(gi(Sn({pubkey:Ws,account:Sn({executable:Gl(),owner:Ws,lamports:tn(),data:_w,rentEpoch:tn()})})));const i_=Sn({program:jn(),parsed:Gm(),space:tn()});ba(gi(Sn({pubkey:Ws,account:Sn({executable:Gl(),owner:Ws,lamports:tn(),data:i_,rentEpoch:tn()})})));ba(gi(Sn({lamports:tn(),address:Ws})));const ww=Sn({executable:Gl(),owner:Ws,lamports:tn(),data:_w,rentEpoch:tn()});Sn({pubkey:Ws,account:ww});const mK=Vm(Vo([mw(Dr.Buffer),i_]),Vo([aI,i_]),a=>Array.isArray(a)?Lm(a,_w):a),gK=Sn({executable:Gl(),owner:Ws,lamports:tn(),data:mK,rentEpoch:tn()});Sn({pubkey:Ws,account:gK});Sn({state:Vo([hs("active"),hs("inactive"),hs("activating"),hs("deactivating")]),active:tn(),inactive:tn()});ss(gi(Sn({signature:jn(),slot:tn(),err:Oh,memo:wi(jn()),blockTime:hr(wi(tn()))})));ss(gi(Sn({signature:jn(),slot:tn(),err:Oh,memo:wi(jn()),blockTime:hr(wi(tn()))})));Sn({subscription:tn(),result:n1(ww)});const vK=Sn({pubkey:Ws,account:ww});Sn({subscription:tn(),result:n1(vK)});const yK=Sn({parent:tn(),slot:tn(),root:tn()});Sn({subscription:tn(),result:yK});const xK=Vo([Sn({type:Vo([hs("firstShredReceived"),hs("completed"),hs("optimisticConfirmation"),hs("root")]),slot:tn(),timestamp:tn()}),Sn({type:hs("createdBank"),parent:tn(),slot:tn(),timestamp:tn()}),Sn({type:hs("frozen"),slot:tn(),timestamp:tn(),stats:Sn({numTransactionEntries:tn(),numSuccessfulTransactions:tn(),numFailedTransactions:tn(),maxTransactionsPerEntry:tn()})}),Sn({type:hs("dead"),slot:tn(),timestamp:tn(),err:jn()})]);Sn({subscription:tn(),result:xK});Sn({subscription:tn(),result:n1(Vo([fK,dK]))});Sn({subscription:tn(),result:tn()});Sn({pubkey:jn(),gossip:wi(jn()),tpu:wi(jn()),rpc:wi(jn()),version:wi(jn())});const cT=Sn({votePubkey:jn(),nodePubkey:jn(),activatedStake:tn(),epochVoteAccount:Gl(),epochCredits:gi(iP([tn(),tn(),tn()])),commission:tn(),lastVote:tn(),rootSlot:wi(tn())});ss(Sn({current:gi(cT),delinquent:gi(cT)}));const AK=Vo([hs("processed"),hs("confirmed"),hs("finalized")]),bK=Sn({slot:tn(),confirmations:wi(tn()),err:Oh,confirmationStatus:hr(AK)});ba(gi(wi(bK)));ss(tn());const Ew=Sn({signatures:gi(jn()),message:Sn({accountKeys:gi(jn()),header:Sn({numRequiredSignatures:tn(),numReadonlySignedAccounts:tn(),numReadonlyUnsignedAccounts:tn()}),instructions:gi(Sn({accounts:gi(tn()),data:jn(),programIdIndex:tn()})),recentBlockhash:jn()})}),cI=Sn({parsed:Gm(),program:jn(),programId:Ws}),uI=Sn({accounts:gi(Ws),data:jn(),programId:Ws}),_K=Vo([uI,cI]),wK=Vo([Sn({parsed:Gm(),program:jn(),programId:jn()}),Sn({accounts:gi(jn()),data:jn(),programId:jn()})]),hI=Vm(_K,wK,a=>"accounts"in a?Lm(a,uI):Lm(a,cI)),EK=Sn({signatures:gi(jn()),message:Sn({accountKeys:gi(Sn({pubkey:Ws,signer:Gl(),writable:Gl()})),instructions:gi(hI),recentBlockhash:jn()})}),qv=Sn({accountIndex:tn(),mint:jn(),owner:hr(jn()),uiTokenAmount:pK}),Mw=Sn({err:Oh,fee:tn(),innerInstructions:hr(wi(gi(Sn({index:tn(),instructions:gi(Sn({accounts:gi(tn()),data:jn(),programIdIndex:tn()}))})))),preBalances:gi(tn()),postBalances:gi(tn()),logMessages:hr(wi(gi(jn()))),preTokenBalances:hr(wi(gi(qv))),postTokenBalances:hr(wi(gi(qv)))}),MK=Sn({err:Oh,fee:tn(),innerInstructions:hr(wi(gi(Sn({index:tn(),instructions:gi(hI)})))),preBalances:gi(tn()),postBalances:gi(tn()),logMessages:hr(wi(gi(jn()))),preTokenBalances:hr(wi(gi(qv))),postTokenBalances:hr(wi(gi(qv)))});ss(wi(Sn({blockhash:jn(),previousBlockhash:jn(),parentSlot:tn(),transactions:gi(Sn({transaction:Ew,meta:wi(Mw)})),rewards:hr(gi(Sn({pubkey:jn(),lamports:tn(),postBalance:wi(tn()),rewardType:wi(jn())}))),blockTime:wi(tn()),blockHeight:wi(tn())})));ss(wi(Sn({blockhash:jn(),previousBlockhash:jn(),parentSlot:tn(),transactions:gi(Sn({transaction:Ew,meta:wi(Mw)})),rewards:hr(gi(Sn({pubkey:jn(),lamports:tn(),postBalance:wi(tn()),rewardType:wi(jn())}))),blockTime:wi(tn())})));ss(wi(Sn({blockhash:jn(),previousBlockhash:jn(),parentSlot:tn(),signatures:gi(jn()),blockTime:wi(tn())})));ss(wi(Sn({slot:tn(),meta:Mw,blockTime:hr(wi(tn())),transaction:Ew})));ss(wi(Sn({slot:tn(),transaction:EK,meta:wi(MK),blockTime:hr(wi(tn()))})));ba(Sn({blockhash:jn(),feeCalculator:Sn({lamportsPerSignature:tn()})}));ba(Sn({blockhash:jn(),lastValidBlockHeight:tn()}));const SK=Sn({slot:tn(),numTransactions:tn(),numSlots:tn(),samplePeriodSecs:tn()});ss(gi(SK));ba(wi(Sn({feeCalculator:Sn({lamportsPerSignature:tn()})})));ss(jn());ss(jn());const TK=Sn({err:Oh,logs:gi(jn()),signature:jn()});Sn({result:n1(TK),subscription:tn()});Mi([Gs("numSignatures"),Gs("padding"),Uo("signatureOffset"),Uo("signatureInstructionIndex"),Uo("publicKeyOffset"),Uo("publicKeyInstructionIndex"),Uo("messageDataOffset"),Uo("messageDataSize"),Uo("messageInstructionIndex")]);new rr("Ed25519SigVerify111111111111111111111111111");new rr("StakeConfig11111111111111111111111111111111");class uT{constructor(t,n,i){this.unixTimestamp=void 0,this.epoch=void 0,this.custodian=void 0,this.unixTimestamp=t,this.epoch=n,this.custodian=i}}uT.default=new uT(0,0,rr.default);Object.freeze({Initialize:{index:0,layout:Mi([Ri("instruction"),ZQ(),JQ()])},Authorize:{index:1,layout:Mi([Ri("instruction"),dr("newAuthorized"),Ri("stakeAuthorizationType")])},Delegate:{index:2,layout:Mi([Ri("instruction")])},Split:{index:3,layout:Mi([Ri("instruction"),wo("lamports")])},Withdraw:{index:4,layout:Mi([Ri("instruction"),wo("lamports")])},Deactivate:{index:5,layout:Mi([Ri("instruction")])},Merge:{index:7,layout:Mi([Ri("instruction")])},AuthorizeWithSeed:{index:8,layout:Mi([Ri("instruction"),dr("newAuthorized"),Ri("stakeAuthorizationType"),Qp("authoritySeed"),dr("authorityOwner")])}});Object.freeze({Staker:{index:0},Withdrawer:{index:1}});new rr("Stake11111111111111111111111111111111111111");Mi([Gs("numSignatures"),Uo("signatureOffset"),Gs("signatureInstructionIndex"),Uo("ethAddressOffset"),Gs("ethAddressInstructionIndex"),Uo("messageDataOffset"),Uo("messageDataSize"),Gs("messageInstructionIndex"),Ed(20,"ethAddress"),Ed(64,"signature"),Gs("recoveryId")]);new rr("KeccakSecp256k11111111111111111111111111111");new rr("Va1idator1nfo111111111111111111111111111111");Sn({name:jn(),website:hr(jn()),details:hr(jn()),keybaseUsername:hr(jn())});new rr("Vote111111111111111111111111111111111111111");Mi([dr("nodePubkey"),dr("authorizedWithdrawer"),Gs("commission"),ks(),Yp(Mi([ks("slot"),Ri("confirmationCount")]),om(Ri(),-8),"votes"),Gs("rootSlotValid"),ks("rootSlot"),ks(),Yp(Mi([ks("epoch"),dr("authorizedVoter")]),om(Ri(),-8),"authorizedVoters"),Mi([Yp(Mi([dr("authorizedPubkey"),ks("epochOfLastAuthorizedSwitch"),ks("targetEpoch")]),32,"buf"),ks("idx"),Gs("isEmpty")],"priorVoters"),ks(),Yp(Mi([ks("epoch"),ks("credits"),ks("prevCredits")]),om(Ri(),-8),"epochCredits"),Mi([ks("slot"),ks("timestamp")],"lastTimestamp")]);Object.freeze({InitializeAccount:{index:0,layout:Mi([Ri("instruction"),eK()])},Authorize:{index:1,layout:Mi([Ri("instruction"),dr("newAuthorized"),Ri("voteAuthorizationType")])},Withdraw:{index:3,layout:Mi([Ri("instruction"),wo("lamports")])}});Object.freeze({Voter:{index:0},Withdrawer:{index:1}});new rr("Vote111111111111111111111111111111111111111");const CK="Phantom";class RK extends GV{constructor(t={}){super(),this.name=CK,this.url="https://phantom.app",this.icon="data:image/svg+xml;base64,PHN2ZyBmaWxsPSJub25lIiBoZWlnaHQ9IjM0IiB3aWR0aD0iMzQiIHhtbG5zPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2ZyI+PGxpbmVhckdyYWRpZW50IGlkPSJhIiB4MT0iLjUiIHgyPSIuNSIgeTE9IjAiIHkyPSIxIj48c3RvcCBvZmZzZXQ9IjAiIHN0b3AtY29sb3I9IiM1MzRiYjEiLz48c3RvcCBvZmZzZXQ9IjEiIHN0b3AtY29sb3I9IiM1NTFiZjkiLz48L2xpbmVhckdyYWRpZW50PjxsaW5lYXJHcmFkaWVudCBpZD0iYiIgeDE9Ii41IiB4Mj0iLjUiIHkxPSIwIiB5Mj0iMSI+PHN0b3Agb2Zmc2V0PSIwIiBzdG9wLWNvbG9yPSIjZmZmIi8+PHN0b3Agb2Zmc2V0PSIxIiBzdG9wLWNvbG9yPSIjZmZmIiBzdG9wLW9wYWNpdHk9Ii44MiIvPjwvbGluZWFyR3JhZGllbnQ+PGNpcmNsZSBjeD0iMTciIGN5PSIxNyIgZmlsbD0idXJsKCNhKSIgcj0iMTciLz48cGF0aCBkPSJtMjkuMTcwMiAxNy4yMDcxaC0yLjk5NjljMC02LjEwNzQtNC45NjgzLTExLjA1ODE3LTExLjA5NzUtMTEuMDU4MTctNi4wNTMyNSAwLTEwLjk3NDYzIDQuODI5NTctMTEuMDk1MDggMTAuODMyMzctLjEyNDYxIDYuMjA1IDUuNzE3NTIgMTEuNTkzMiAxMS45NDUzOCAxMS41OTMyaC43ODM0YzUuNDkwNiAwIDEyLjg0OTctNC4yODI5IDEzLjk5OTUtOS41MDEzLjIxMjMtLjk2MTktLjU1MDItMS44NjYxLTEuNTM4OC0xLjg2NjF6bS0xOC41NDc5LjI3MjFjMCAuODE2Ny0uNjcwMzggMS40ODQ3LTEuNDkwMDEgMS40ODQ3LS44MTk2NCAwLTEuNDg5OTgtLjY2ODMtMS40ODk5OC0xLjQ4NDd2LTIuNDAxOWMwLS44MTY3LjY3MDM0LTEuNDg0NyAxLjQ4OTk4LTEuNDg0Ny44MTk2MyAwIDEuNDkwMDEuNjY4IDEuNDkwMDEgMS40ODQ3em01LjE3MzggMGMwIC44MTY3LS42NzAzIDEuNDg0Ny0xLjQ4OTkgMS40ODQ3LS44MTk3IDAtMS40OS0uNjY4My0xLjQ5LTEuNDg0N3YtMi40MDE5YzAtLjgxNjcuNjcwNi0xLjQ4NDcgMS40OS0xLjQ4NDcuODE5NiAwIDEuNDg5OS42NjggMS40ODk5IDEuNDg0N3oiIGZpbGw9InVybCgjYikiLz48L3N2Zz4K",this._readyState=typeof window=="undefined"||typeof document=="undefined"?fa.Unsupported:fa.NotDetected,this._disconnected=()=>{const n=this._wallet;n&&(n.off("disconnect",this._disconnected),this._wallet=null,this._publicKey=null,this.emit("error",new OV),this.emit("disconnect"))},this._connecting=!1,this._wallet=null,this._publicKey=null,this._readyState!==fa.Unsupported&&zV(()=>{var n;return!((n=window.solana)===null||n===void 0)&&n.isPhantom?(this._readyState=fa.Installed,this.emit("readyStateChange",this._readyState),!0):!1})}get publicKey(){return this._publicKey}get connecting(){return this._connecting}get connected(){var t;return!!(!((t=this._wallet)===null||t===void 0)&&t.isConnected)}get readyState(){return this._readyState}async connect(){try{if(this.connected||this.connecting)return;if(this._readyState!==fa.Installed)throw new _L;this._connecting=!0;const t=window.solana;if(!t.isConnected){const i=t._handleDisconnect;try{await new Promise((o,s)=>{const c=()=>{t.off("connect",c),o()};t._handleDisconnect=(...u)=>(t.off("connect",c),s(new UV),i.apply(t,u)),t.on("connect",c),t.connect().catch(u=>{t.off("connect",c),s(u)})})}catch(o){throw o instanceof no?o:new IV(o==null?void 0:o.message,o)}finally{t._handleDisconnect=i}}if(!t.publicKey)throw new BV;let n;try{n=new rr(t.publicKey.toBytes())}catch(i){throw new FV(i==null?void 0:i.message,i)}t.on("disconnect",this._disconnected),this._wallet=t,this._publicKey=n,this.emit("connect",n)}catch(t){throw this.emit("error",t),t}finally{this._connecting=!1}}async disconnect(){const t=this._wallet;if(t){t.off("disconnect",this._disconnected),this._wallet=null,this._publicKey=null;try{await t.disconnect()}catch(n){this.emit("error",new DV(n==null?void 0:n.message,n))}}this.emit("disconnect")}async sendTransaction(t,n,i={}){try{const s=this._wallet;if(!s)throw new Fl;try{t=await this.prepareTransaction(t,n);const o=i,{signers:c}=o,u=hg(o,["signers"]);c!=null&&c.length&&t.partialSign(...c);const{signature:h}=await s.signAndSendTransaction(t,u);return h}catch(c){throw c instanceof no?c:new wL(c==null?void 0:c.message,c)}}catch(s){throw this.emit("error",s),s}}async signTransaction(t){try{const n=this._wallet;if(!n)throw new Fl;try{return await n.signTransaction(t)||t}catch(i){throw new zb(i==null?void 0:i.message,i)}}catch(n){throw this.emit("error",n),n}}async signAllTransactions(t){try{const n=this._wallet;if(!n)throw new Fl;try{return await n.signAllTransactions(t)||t}catch(i){throw new zb(i==null?void 0:i.message,i)}}catch(n){throw this.emit("error",n),n}}async signMessage(t){try{const n=this._wallet;if(!n)throw new Fl;try{const{signature:i}=await n.signMessage(t);return i}catch(i){throw new NV(i==null?void 0:i.message,i)}}catch(n){throw this.emit("error",n),n}}}const LK={wallets:[new RK],autoConnect:!0},PK=AN(yj);PK.use(ZW,LK).mount("#app");
